<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>javaä¸­å¸¸è§çš„æ•°æ®äº¤æ¢å¯¹è±¡</title>
    <link href="/java%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E5%AF%B9%E8%B1%A1/"/>
    <url>/java%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E5%AF%B9%E8%B1%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å¸¸è§çš„æ•°æ®äº¤æ¢å¯¹è±¡"><a href="#1-å¸¸è§çš„æ•°æ®äº¤æ¢å¯¹è±¡" class="headerlink" title="1. å¸¸è§çš„æ•°æ®äº¤æ¢å¯¹è±¡"></a>1. å¸¸è§çš„æ•°æ®äº¤æ¢å¯¹è±¡</h1><h2 id="1-DTO"><a href="#1-DTO" class="headerlink" title="1. DTO"></a>1. DTO</h2><ol><li><strong>ç›®çš„</strong>ï¼šç”¨äºæœåŠ¡å±‚ä¸å¤–éƒ¨ç³»ç»Ÿï¼ˆå¦‚å‰ç«¯ã€ç¬¬ä¸‰æ–¹æœåŠ¡ï¼‰ä¹‹é—´ä¼ è¾“æ•°æ®ï¼Œé€šå¸¸æ˜¯åºåˆ—åŒ–çš„å¯¹è±¡ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li>å¸¸ä½œä¸º Controller æ¥å£çš„è¯·æ±‚&#x2F;å“åº”å‚æ•°</li><li>å¯ä»¥åŒ…å«å¤šä¸ªPOçš„ç»„åˆæ•°æ®ã€‚</li><li>å­—æ®µä¸ä¸€å®šä¸æ•°æ®åº“ä¸€è‡´ã€‚</li><li>æ— ä¸šåŠ¡é€»è¾‘</li></ul></li></ol><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºå‘å‰ç«¯å°è£…ç”¨æˆ·ç™»å½•ä¿¡æ¯</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginDTO</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String password;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºå‘å‰ç«¯è¿”å›ç”¨æˆ·ä¿¡æ¯ï¼ˆä¸åŒ…å«å¯†ç ï¼‰</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDTO</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String nickName;<br>    <span class="hljs-keyword">private</span> String avatar;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> String roleName; <span class="hljs-comment">// å…³è”è§’è‰²å</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-BO"><a href="#2-BO" class="headerlink" title="2. BO"></a>2. BO</h2><ol><li><strong>ç›®çš„</strong>ï¼šå°è£…ä¸šåŠ¡é€»è¾‘æˆ–ä¸šåŠ¡è§„åˆ™ï¼Œç”¨äºæœåŠ¡å±‚å†…éƒ¨å¤„ç†ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li>å¸¸åœ¨ Service å±‚ä¸­ä½¿ç”¨</li><li>å¯åŒ…å«ä¸šåŠ¡æ–¹æ³•å’Œä¸šåŠ¡æ ¡éªŒé€»è¾‘</li><li>å¯èƒ½ç”±å¤šä¸ªDTO&#x2F;POç»„åˆè€Œæˆï¼Œç”¨äºServiceå±‚å¤„ç†å¤æ‚ä¸šåŠ¡ã€‚</li></ul></li></ol><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è®¢å•ä¸šåŠ¡å¯¹è±¡</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderBO</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String orderId;<br>    <span class="hljs-keyword">private</span> BigDecimal amount;<br>    <span class="hljs-keyword">private</span> Integer itemCount;<br>    <span class="hljs-keyword">private</span> UserBO user; <span class="hljs-comment">// ç”¨æˆ·ä¿¡æ¯</span><br>    <span class="hljs-keyword">private</span> List&lt;OrderItemBO&gt; items;<br>    <span class="hljs-keyword">private</span> String discountRule;<br>    <span class="hljs-keyword">private</span> BigDecimal finalAmount;<br>    <span class="hljs-keyword">private</span> Boolean isOverdue;<br><br>    <span class="hljs-comment">// ä¸šåŠ¡æ–¹æ³•</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">calculateTotal</span><span class="hljs-params">()</span> </span>&#123; ... &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">applyDiscount</span><span class="hljs-params">()</span> </span>&#123; ... &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// User service æ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ISysUserService</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">checkUserNameUnique</span><span class="hljs-params">(SysUserBo user)</span></span>;<br>  <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">checkPhoneUnique</span><span class="hljs-params">(SysUserBo user)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-PO"><a href="#3-PO" class="headerlink" title="3. PO"></a>3. PO</h2><ol><li><strong>ç›®çš„</strong>ï¼šç”¨äºè¡¨ç¤ºæ•°æ®åº“ä¸­çš„å®ä½“ï¼Œä¸è¡¨ç»“æ„å¯¹åº”ã€‚</li><li>ç‰¹ç‚¹ï¼š<ul><li>ä¸€èˆ¬ä¸æ•°æ®åº“å­—æ®µä¸€ä¸€å¯¹åº”</li><li>å¯è¢« ORMï¼ˆå¦‚ MyBatisã€JPAï¼‰ç›´æ¥æ˜ å°„</li><li>ä¸€èˆ¬ä¸åŒ…å«ä¸šåŠ¡é€»è¾‘ã€‚</li><li>å¸¸ç”¨äºDAOå±‚ä¸æ•°æ®åº“äº¤äº’ã€‚</li></ul></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å¯¹åº”æ•°æ®åº“è¡¨ user</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPO</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String password;<br>    <span class="hljs-keyword">private</span> LocalDateTime createTime;<br><br>    <span class="hljs-comment">// getter/setter</span><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>å¦‚æœä½ çš„é¡¹ç›®ç¡®å®éœ€è¦åŒºåˆ†æŒä¹…åŒ–å¯¹è±¡å’Œé¢†åŸŸå¯¹è±¡ï¼Œå¯ä»¥è€ƒè™‘å‘½åå¦‚ <code>UserPO</code> æˆ–è€… <code>UserEntity</code>ï¼Œä½†æ›´å¸¸è§çš„åšæ³•æ˜¯ç›´æ¥ç”¨ <code>User</code> ä½œä¸ºå®ä½“ç±»åï¼Œå¹¶é€šè¿‡æ³¨è§£ç­‰æ–¹å¼æ¥æ ‡è®°å®ƒæ˜¯æŒä¹…åŒ–çš„å®ä½“ã€‚</p></blockquote><h2 id="4-DO"><a href="#4-DO" class="headerlink" title="4. DO"></a>4. DO</h2><ol><li><p>ç›®çš„ï¼š</p><ul><li><strong>DO &#x3D; Domain Object</strong>ï¼Œé¢†åŸŸå¯¹è±¡</li><li>åœ¨<strong>é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDDDï¼‰</strong> ä¸­ä½¿ç”¨ï¼Œä»£è¡¨ä¸šåŠ¡é¢†åŸŸçš„æ ¸å¿ƒæ¨¡å‹ï¼ŒåŒ…å«æ•°æ®å’Œè¡Œä¸ºã€‚</li><li>åœ¨éDDDçš„é¡¹ç›®ä¸­ï¼ŒPO ä¸ DO æœ‰æ—¶å¯æ··ç”¨</li></ul></li><li><p>ç‰¹ç‚¹ï¼š</p><ul><li><p>æ˜¯â€œå……è¡€æ¨¡å‹â€ï¼ˆæœ‰æ–¹æ³•+å±æ€§ï¼‰ã€‚</p></li><li><p>å¼ºè°ƒä¸šåŠ¡è¯­ä¹‰ï¼Œå¦‚â€œä¸‹å•â€ã€â€œæ”¯ä»˜â€ç­‰è¡Œä¸ºã€‚</p></li><li><p>ä¸POå¯èƒ½ç»“æ„ä¸åŒã€‚</p></li></ul></li></ol><blockquote><p>ğŸ“Œ DDDä¸­ï¼ŒDOæ˜¯æ ¸å¿ƒï¼ŒPOåªæ˜¯æŒä¹…åŒ–è½½ä½“ã€‚</p><p>é€šå¸¸ç›´æ¥å‘½åä¸º <code>User</code>ï¼Œå› ä¸ºå®ƒä»£è¡¨äº†ä¸šåŠ¡é¢†åŸŸçš„æ ¸å¿ƒæ¨¡å‹ï¼ŒåŒ…å«äº†æ•°æ®å’Œç›¸å…³çš„è¡Œä¸ºã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é¢†åŸŸå¯¹è±¡ï¼šç”¨æˆ·</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDO</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String password;<br>    <span class="hljs-keyword">private</span> LocalDateTime createTime;<br><br>    <span class="hljs-comment">// ä¸šåŠ¡è¡Œä¸º</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">changePassword</span><span class="hljs-params">(String oldPwd, String newPwd)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (!password.equals(DigestUtils.md5Hex(oldPwd))) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;åŸå¯†ç é”™è¯¯&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">this</span>.password = DigestUtils.md5Hex(newPwd);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPremiumUser</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> createTime.isBefore(LocalDateTime.now().minusYears(<span class="hljs-number">1</span>));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="5-VO"><a href="#5-VO" class="headerlink" title="5. VO"></a>5. VO</h2><ol><li><p><strong>ç›®çš„</strong>ï¼šç”¨äºå‘å‰ç«¯å±•ç¤ºæ•°æ®ï¼Œé€šå¸¸æ˜¯é¡µé¢å±•ç¤ºçš„æ•°æ®æ¨¡å‹ã€‚</p></li><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p></li></ol><ul><li>é€šå¸¸åŒ…å«ç»è¿‡ç»„åˆæˆ–æ ¼å¼åŒ–çš„å±•ç¤ºæ•°æ®</li><li>ä¸ä¸€å®šä¸æ•°æ®åº“å­—æ®µä¸€ä¸€å¯¹åº”</li><li>æœ‰æ—¶ä¼šåŒ…å«å‰ç«¯æ‰€éœ€çš„é¢å¤–å­—æ®µï¼Œå¦‚çŠ¶æ€åã€æ ¼å¼åŒ–æ—¥æœŸç­‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserVO</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String email;<br>    <span class="hljs-keyword">private</span> String createTimeFormatted; <span class="hljs-comment">// æ ¼å¼åŒ–åçš„æ—¶é—´å­—ç¬¦ä¸²</span><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="2-ç»„åˆä½¿ç”¨"><a href="#2-ç»„åˆä½¿ç”¨" class="headerlink" title="2. ç»„åˆä½¿ç”¨"></a>2. ç»„åˆä½¿ç”¨</h1><p>å¦‚æœä½ åœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„æ˜¯ Spring Boot + MyBatis æˆ– JPA çš„æ¶æ„ï¼Œé€šå¸¸ä¼šçœ‹åˆ°å¦‚ä¸‹ç»„åˆä½¿ç”¨ï¼š</p><table><thead><tr><th>å±‚çº§</th><th>ä½¿ç”¨å¯¹è±¡</th><th>èŒè´£è¯´æ˜</th></tr></thead><tbody><tr><td>Controller</td><td><code>DTO</code>, <code>VO</code></td><td>æ¥æ”¶è¯·æ±‚å‚æ•°ï¼ˆDTOï¼‰ã€è¿”å›å“åº”ï¼ˆVOï¼‰</td></tr><tr><td>Service</td><td><code>BO</code>, <code>DTO</code></td><td>ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼ŒDTO â†’ BO â†’ DOï¼ŒDO â†’ BO â†’ VO</td></tr><tr><td>DAO &#x2F; Repository</td><td><code>DO</code></td><td>æ•°æ®åº“æ“ä½œï¼Œå¦‚å¢åˆ æ”¹æŸ¥</td></tr><tr><td>Entity (DBæ˜ å°„)</td><td><code>DO/PO</code></td><td>ä¸æ•°æ®åº“è¡¨å¯¹åº”çš„å®ä½“</td></tr></tbody></table><h2 id="1-å‰ç«¯æäº¤è¯·æ±‚ï¼ˆJSONï¼‰"><a href="#1-å‰ç«¯æäº¤è¯·æ±‚ï¼ˆJSONï¼‰" class="headerlink" title="1. å‰ç«¯æäº¤è¯·æ±‚ï¼ˆJSONï¼‰"></a>1. å‰ç«¯æäº¤è¯·æ±‚ï¼ˆJSONï¼‰</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json">POST /api/user/register<br>&#123;<br>  <span class="hljs-attr">&quot;username&quot;</span>: <span class="hljs-string">&quot;jack&quot;</span>,<br>  <span class="hljs-attr">&quot;email&quot;</span>: <span class="hljs-string">&quot;jack@example.com&quot;</span>,<br>  <span class="hljs-attr">&quot;password&quot;</span>: <span class="hljs-string">&quot;123456&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-Controller-å±‚"><a href="#2-Controller-å±‚" class="headerlink" title="2. Controller å±‚"></a>2. Controller å±‚</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/register&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Result&lt;UserVO&gt; <span class="hljs-title">register</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> UserRegisterDTO dto)</span> </span>&#123;<br>    UserVO vo = userService.register(dto);<br>    <span class="hljs-keyword">return</span> Result.success(vo);<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å…¥å‚ï¼š<code>UserRegisterDTO</code></li><li>å‡ºå‚ï¼š<code>UserVO</code></li></ul><h2 id="3-Service-å±‚"><a href="#3-Service-å±‚" class="headerlink" title="3. Service å±‚"></a>3. Service å±‚</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> UserVO <span class="hljs-title">register</span><span class="hljs-params">(UserRegisterDTO dto)</span> </span>&#123;<br>    <span class="hljs-comment">// DTO â†’ BO</span><br>    UserBO bo = <span class="hljs-keyword">new</span> UserBO(dto.getUsername(), dto.getEmail(), dto.getPassword());<br><br>    <span class="hljs-comment">// æ ¡éªŒé€»è¾‘</span><br>    <span class="hljs-keyword">if</span> (!bo.isValidEmail()) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> BusinessException(<span class="hljs-string">&quot;é‚®ç®±ä¸åˆæ³•&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// BO â†’ DOï¼ˆä¿å­˜ï¼‰</span><br>    UserDO userDO = <span class="hljs-keyword">new</span> UserDO();<br>    BeanUtils.copyProperties(bo, userDO);<br>    userDao.insert(userDO);<br><br>    <span class="hljs-comment">// DO â†’ VOï¼ˆè¿”å›å‰ç«¯ï¼‰</span><br>    UserVO vo = <span class="hljs-keyword">new</span> UserVO();<br>    BeanUtils.copyProperties(userDO, vo);<br>    <span class="hljs-keyword">return</span> vo;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4-DAO-å±‚ï¼ˆMyBatis-ç¤ºä¾‹ï¼‰"><a href="#4-DAO-å±‚ï¼ˆMyBatis-ç¤ºä¾‹ï¼‰" class="headerlink" title="4. DAO å±‚ï¼ˆMyBatis ç¤ºä¾‹ï¼‰"></a>4. DAO å±‚ï¼ˆMyBatis ç¤ºä¾‹ï¼‰</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserDAO</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(UserDO user)</span></span>;<br>    <span class="hljs-function">UserDO <span class="hljs-title">findByUsername</span><span class="hljs-params">(String username)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="5-UserDO-æ˜ å°„æ•°æ®åº“è¡¨"><a href="#5-UserDO-æ˜ å°„æ•°æ®åº“è¡¨" class="headerlink" title="5. UserDO æ˜ å°„æ•°æ®åº“è¡¨"></a>5. UserDO æ˜ å°„æ•°æ®åº“è¡¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDO</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String email;<br>    <span class="hljs-keyword">private</span> String password;<br>    <span class="hljs-keyword">private</span> LocalDateTime createTime;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•°æ®åº“è¡¨ç»“æ„ç¤ºä¾‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">user</span> (<br>    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,<br>    username <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>),<br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>),<br>    password <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>),<br>    create_time DATETIME<br>);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>LangChain4jä¹‹Embedding</title>
    <link href="/LangChain4j%E4%B9%8BEmbedding/"/>
    <url>/LangChain4j%E4%B9%8BEmbedding/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯å‘é‡"><a href="#1-ä»€ä¹ˆæ˜¯å‘é‡" class="headerlink" title="1. ä»€ä¹ˆæ˜¯å‘é‡"></a>1. ä»€ä¹ˆæ˜¯å‘é‡</h1><p>ä¸€ä¸ªäºŒç»´å‘é‡å¯ä»¥ç†è§£ä¸ºå¹³é¢åæ ‡è½´ä¸­çš„ä¸€ä¸ªåæ ‡ç‚¹(xï¼Œy)ï¼Œåœ¨ç¼–ç¨‹é¢†åŸŸï¼Œä¸€ä¸ªäºŒç»´å‘é‡å°±æ˜¯ä¸€ä¸ªå¤§å°ä¸ºäºŒçš„floatç±»å‹çš„æ•°ç»„ã€‚</p><h1 id="2-æ–‡æœ¬å‘é‡åŒ–"><a href="#2-æ–‡æœ¬å‘é‡åŒ–" class="headerlink" title="2. æ–‡æœ¬å‘é‡åŒ–"></a>2. æ–‡æœ¬å‘é‡åŒ–</h1><p>æ–‡æœ¬å‘é‡åŒ–æ˜¯æŒ‡ï¼Œåˆ©ç”¨å¤§æ¨¡å‹å¯ä»¥æŠŠä¸€ä¸ªå­—ã€ä¸€ä¸ªè¯æˆ–ä¸€æ®µè¯æ˜ å°„ä¸ºä¸€ä¸ªå¤šç»´å‘é‡ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºå‘é‡æ¥åˆ¤æ–­ä¸¤å¥è¯ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨LangChain4jä¸­æ¥è°ƒç”¨å‘é‡æ¨¡å‹æ¥å¯¹ä¸€å¥è¯è¿›è¡Œå‘é‡åŒ–ä½“éªŒã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.data.embedding.Embedding;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.output.Response;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.zhipu.ZhipuAiEmbeddingModel;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ZhipuAiEmbeddingModel embeddingModel = ZhipuAiEmbeddingModel.builder()<br>                .apiKey(<span class="hljs-string">&quot;xxx&quot;</span>)<br>                .build();<br><br>        Response&lt;Embedding&gt; embed = embeddingModel.embed(<span class="hljs-string">&quot;ä½ å¥½ï¼Œæˆ‘å«å¼ ä¸‰&quot;</span>);<br>        System.out.println(embed.content().toString());<br>        System.out.println(embed.content().vector().length);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250729195248503.png" alt="image-20250729195248503"></p><p>ä»ç»“æœå¯ä»¥çŸ¥é“â€ä½ å¥½ï¼Œæˆ‘å«å¼ ä¸‰â€è¿™å¥è¯ç»è¿‡ZhipuAiEmbeddingModelå‘é‡åŒ–ä¹‹åå¾—åˆ°çš„ä¸€ä¸ªé•¿åº¦ä¸º1024çš„floatæ•°ç»„ã€‚</p><h1 id="3-å‘é‡æ•°æ®åº“"><a href="#3-å‘é‡æ•°æ®åº“" class="headerlink" title="3. å‘é‡æ•°æ®åº“"></a>3. å‘é‡æ•°æ®åº“</h1><p>å¯¹äºå‘é‡æ¨¡å‹ç”Ÿæˆå‡ºæ¥çš„å‘é‡ï¼Œæˆ‘ä»¬å¯ä»¥æŒä¹…åŒ–åˆ°å‘é‡æ•°æ®åº“ï¼Œå¹¶ä¸”èƒ½åˆ©ç”¨å‘é‡æ•°æ®åº“æ¥è®¡ç®—ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæˆ–è€…æ ¹æ®ä¸€ä¸ªå‘é‡æŸ¥æ‰¾è·Ÿè¿™ä¸ªå‘é‡æœ€ç›¸ä¼¼çš„å‘é‡ã€‚</p><p>åœ¨LangChain4jä¸­ï¼ŒEmbeddingStoreè¡¨ç¤ºå‘é‡æ•°æ®åº“ï¼Œå®ƒæœ‰3ä¸ªå®ç°ç±»ï¼š</p><ol><li><p>ChromaEmbeddingStore</p></li><li><p>InMemoryEmbeddingStore</p></li><li><p>RedisEmbeddingStore</p></li></ol><p>æˆ‘ä»¬ä½¿ç”¨Redisæ¥æ¼”ç¤ºå¯¹äºå‘é‡çš„å¢åˆ æŸ¥æ”¹</p><h2 id="3-1-ä½¿ç”¨Rediså‘é‡æ•°æ®åº“"><a href="#3-1-ä½¿ç”¨Rediså‘é‡æ•°æ®åº“" class="headerlink" title="3.1 ä½¿ç”¨Rediså‘é‡æ•°æ®åº“"></a>3.1 ä½¿ç”¨Rediså‘é‡æ•°æ®åº“</h2><h2 id="1-å¯åŠ¨redis"><a href="#1-å¯åŠ¨redis" class="headerlink" title="1. å¯åŠ¨redis"></a>1. å¯åŠ¨redis</h2><p>æ™®é€šçš„Redisæ˜¯ä¸æ”¯æŒå‘é‡å­˜å‚¨å’ŒæŸ¥è¯¢çš„ï¼Œéœ€è¦é¢å¤–çš„redisearchæ¨¡å—ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨dockeræ¥è¿è¡Œä¸€ä¸ªå¸¦æœ‰redisearchæ¨¡å—çš„rediså®¹å™¨çš„ï¼Œå‘½ä»¤ä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -p 6379:6379 docker.1ms.run/redis/redis-stack-server<br></code></pre></td></tr></table></figure><h2 id="2-æ·»åŠ ä¾èµ–"><a href="#2-æ·»åŠ ä¾èµ–" class="headerlink" title="2. æ·»åŠ ä¾èµ–"></a>2. æ·»åŠ ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>dev.langchain4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>langchain4j-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;langchain4j.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="3-ä»£ç å­˜å‚¨"><a href="#3-ä»£ç å­˜å‚¨" class="headerlink" title="3. ä»£ç å­˜å‚¨"></a>3. ä»£ç å­˜å‚¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">RedisEmbeddingStore embeddingStore = RedisEmbeddingStore.builder()<br>    .host(<span class="hljs-string">&quot;127.0.0.1&quot;</span>)<br>    .port(<span class="hljs-number">6379</span>)<br>    .dimension(<span class="hljs-number">1024</span>) <br>    .build();<br><br><span class="hljs-comment">// ç”Ÿæˆå‘é‡</span><br>Response&lt;Embedding&gt; embed = embeddingModel.embed(<span class="hljs-string">&quot;æˆ‘æ˜¯å¼ ä¸‰&quot;</span>);<br><br><span class="hljs-comment">// å­˜å‚¨å‘é‡</span><br>embeddingStore.add(embed.content());<br></code></pre></td></tr></table></figure><blockquote><p>å½“ä½ ç”¨ OpenAIã€æ–‡å¿ƒä¸€è¨€ã€HuggingFace ç­‰æ¨¡å‹ç”Ÿæˆ <strong>æ–‡æœ¬å‘é‡ï¼ˆembeddingï¼‰</strong> æ—¶ï¼Œæ¨¡å‹ä¼šè¾“å‡ºä¸€ä¸ª <strong>å›ºå®šé•¿åº¦çš„æµ®ç‚¹æ•°ç»„</strong>ï¼Œè¿™ä¸ªæ•°ç»„çš„é•¿åº¦å°±æ˜¯ <strong>å‘é‡ç»´åº¦dimension</strong></p><ul><li>dimensionå°±æ˜¯å‘Šè¯‰ RedisEmbeddingStoreï¼šâ€œæˆ‘è¿™ä¸ªå‘é‡çš„é•¿åº¦æ˜¯å¤šå°‘ï¼Œå­˜å‚¨çš„æ—¶å€™æŒ‰è¿™ä¸ªç»´åº¦æ¥å»ºç´¢å¼•â€</li><li>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ¸…ç©ºï¼š<code>redis-cli FT.DROPINDEX embedding-index DD</code></li></ul></blockquote><h1 id="4-åŒ¹é…å‘é‡"><a href="#4-åŒ¹é…å‘é‡" class="headerlink" title="4. åŒ¹é…å‘é‡"></a>4. åŒ¹é…å‘é‡</h1><p>æ¼”ç¤ºå¦‚ä½•æ ¹æ®ä¸€ä¸ªæŸ¥è¯¢ï¼ˆâ€œå®¢æœç”µè¯å¤šå°‘â€ï¼‰æ‰¾åˆ°ä¸ä¹‹æœ€ç›¸å…³çš„æ–‡æœ¬ç‰‡æ®µã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.data.embedding.Embedding;<br><span class="hljs-keyword">import</span> dev.langchain4j.data.segment.TextSegment;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.output.Response;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.zhipu.ZhipuAiEmbeddingModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.store.embedding.EmbeddingMatch;<br><span class="hljs-keyword">import</span> dev.langchain4j.store.embedding.redis.RedisEmbeddingStore;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">// åˆ›å»ºæ™ºè°±AIçš„åµŒå…¥æ¨¡å‹å®ä¾‹ï¼Œä½¿ç”¨æä¾›çš„APIå¯†é’¥</span><br>        ZhipuAiEmbeddingModel embeddingModel = ZhipuAiEmbeddingModel.builder()<br>                .apiKey(<span class="hljs-string">&quot;xxx&quot;</span>)<br>                .build();<br>        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªåŸºäºRedisçš„å‘é‡å­˜å‚¨å®ä¾‹ï¼Œé…ç½®ä¸ºè¿æ¥åˆ°æœ¬åœ°è¿è¡Œçš„RedisæœåŠ¡å™¨ï¼Œç«¯å£6379ï¼Œå‘é‡ç»´åº¦1024</span><br>        RedisEmbeddingStore embeddingStore = RedisEmbeddingStore.builder()<br>                .host(<span class="hljs-string">&quot;127.0.0.1&quot;</span>)<br>                .port(<span class="hljs-number">6379</span>)<br>                .dimension(<span class="hljs-number">1024</span>)<br>                .build();<br>        <span class="hljs-comment">// åˆ›å»ºä¸‰ä¸ªæ–‡æœ¬ç‰‡æ®µ</span><br>        TextSegment textSegment1 = TextSegment.textSegment(<span class="hljs-string">&quot;å®¢æœç”µè¯æ˜¯400-8558558&quot;</span>);<br>        TextSegment textSegment2 = TextSegment.textSegment(<span class="hljs-string">&quot;å®¢æœå·¥ä½œæ—¶é—´æ˜¯å‘¨ä¸€åˆ°å‘¨äº”&quot;</span>);<br>        TextSegment textSegment3 = TextSegment.textSegment(<span class="hljs-string">&quot;å®¢æœæŠ•è¯‰ç”µè¯æ˜¯400-8668668&quot;</span>);<br>        <span class="hljs-comment">// ä½¿ç”¨æ™ºè°±AIçš„åµŒå…¥æ¨¡å‹å¯¹è¿™ä¸‰ä¸ªæ–‡æœ¬ç‰‡æ®µè¿›è¡Œç¼–ç ï¼Œå¾—åˆ°å®ƒä»¬çš„å‘é‡è¡¨ç¤º</span><br>        Response&lt;Embedding&gt; embed1 = embeddingModel.embed(textSegment1);<br>        Response&lt;Embedding&gt; embed2 = embeddingModel.embed(textSegment2);<br>        Response&lt;Embedding&gt; embed3 = embeddingModel.embed(textSegment3);<br>        <span class="hljs-comment">// å°†è¿™äº›å‘é‡åŠå…¶å¯¹åº”çš„åŸå§‹æ–‡æœ¬ç‰‡æ®µæ·»åŠ åˆ°Rediså‘é‡å­˜å‚¨ä¸­</span><br>        embeddingStore.add(embed1.content(), textSegment1);<br>        embeddingStore.add(embed2.content(), textSegment2);<br>        embeddingStore.add(embed3.content(), textSegment3);<br>        <span class="hljs-comment">// å¯¹æŸ¥è¯¢æ–‡æœ¬â€œå®¢æœç”µè¯å¤šå°‘â€ä¹Ÿè¿›è¡Œç¼–ç ï¼Œå¾—åˆ°å…¶å‘é‡è¡¨ç¤º</span><br>        Response&lt;Embedding&gt; embed = embeddingModel.embed(<span class="hljs-string">&quot;å®¢æœç”µè¯å¤šå°‘&quot;</span>);<br>        <span class="hljs-comment">// åœ¨Rediså‘é‡å­˜å‚¨ä¸­æŸ¥æ‰¾ä¸æŸ¥è¯¢å‘é‡æœ€ç›¸ä¼¼çš„å‰5ä¸ªæ–‡æœ¬ç‰‡æ®µ</span><br>        List&lt;EmbeddingMatch&lt;TextSegment&gt;&gt; result = embeddingStore.findRelevant(embed.content(), <span class="hljs-number">5</span>);<br>        <span class="hljs-comment">// è¾“å‡ºç»“æœï¼šåŒ¹é…çš„æ–‡æœ¬ç‰‡æ®µå’Œå®ƒä»¬çš„ç›¸ä¼¼åº¦åˆ†æ•°</span><br>        <span class="hljs-keyword">for</span> (EmbeddingMatch&lt;TextSegment&gt; embeddingMatch : result) &#123;<br>            System.out.println(embeddingMatch.embedded().text() + <span class="hljs-string">&quot;,åˆ†æ•°ä¸ºï¼š&quot;</span> + embeddingMatch.score());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250729221221418.png" alt="image-20250729221221418" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>LangChain4j</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>LangChain4jä¹‹Tools</title>
    <link href="/LangChain4j%E4%B9%8BTools/"/>
    <url>/LangChain4j%E4%B9%8BTools/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Toolsæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-Toolsæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. Toolsæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. <strong>Toolsæ˜¯ä»€ä¹ˆï¼Ÿ</strong></h1><p>å¤§æ¨¡å‹Toolsï¼ˆå·¥å…·ï¼‰å¯ä»¥é€šè¿‡ç»“æ„åŒ–æ¥å£å°†æ¨¡å‹èƒ½åŠ›ä¸ç°å®ä¸–ç•Œæ“ä½œè¿æ¥ã€‚ä¾‹å¦‚ï¼š</p><ul><li><strong>å¤©æ°”æŸ¥è¯¢å·¥å…·</strong>ï¼šå°è£…å¤©æ°”APIï¼Œæ¥æ”¶åŸå¸‚å‚æ•°åè¿”å›å®æ—¶æ•°æ®ï¼›</li><li><strong>æ•°æ®åº“æ“ä½œå·¥å…·</strong>ï¼šå°†SQLæŸ¥è¯¢è½¬åŒ–ä¸ºè‡ªç„¶è¯­è¨€äº¤äº’æ¥å£ï¼›</li><li><strong>ä»£ç æ‰§è¡Œå·¥å…·</strong>ï¼šè°ƒç”¨ç¼–è¯‘å™¨æˆ–è§£é‡Šå™¨å®Œæˆä»£ç è°ƒè¯•ã€‚</li></ul><blockquote><p><strong>ç›®å‰å¤§æ¨¡å‹çš„ä¸è¶³</strong>ï¼šå¤§æ¨¡å‹åœ¨è§£å†³é—®é¢˜æ—¶ï¼Œæ˜¯åŸºäºäº’è”ç½‘ä¸Šå¾ˆå¤šå†å²èµ„æ–™è¿›è¡Œé¢„æµ‹çš„ï¼Œè€Œä¸”ç­”æ¡ˆå…·æœ‰ä¸€å®šçš„éšæœºæ€§ï¼Œé‚£å¦‚æœæˆ‘é—®â€ä»Šå¤©æ˜¯å‡ æœˆå‡ å·ï¼Ÿâ€ï¼Œå¤§æ¨¡å‹æ˜¯å¤§æ¦‚ç‡ç­”é”™çš„ï¼Œå› ä¸ºå¤§æ¨¡å‹è‚¯å®šè¿˜æ²¡æœ‰æ¥å¾—åŠå­¦ä¹ ä»Šå¤©æ‰€äº§ç”Ÿçš„æœ€æ–°èµ„æ–™ã€‚</p></blockquote><h1 id="2-AiServicesæ•´åˆTools"><a href="#2-AiServicesæ•´åˆTools" class="headerlink" title="2. AiServicesæ•´åˆTools"></a>2. AiServicesæ•´åˆTools</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.google.common.collect.Lists;<br><span class="hljs-keyword">import</span> dev.langchain4j.agent.tool.Tool;<br><span class="hljs-keyword">import</span> dev.langchain4j.memory.chat.MessageWindowChatMemory;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.chat.ChatLanguageModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.zhipu.ZhipuAiChatModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.AiServices;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.SystemMessage;<br><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.Data;<br><span class="hljs-keyword">import</span> lombok.NoArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.ToString;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.time.LocalDate;<br><span class="hljs-keyword">import</span> java.time.LocalDateTime;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br><br>    <span class="hljs-meta">@Data</span><br>    <span class="hljs-meta">@ToString</span><br>    <span class="hljs-meta">@AllArgsConstructor</span><br>    <span class="hljs-meta">@NoArgsConstructor</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> String name;<br>        <span class="hljs-keyword">private</span> Integer age;<br>        <span class="hljs-keyword">private</span> String createTime;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTools</span> </span>&#123;<br><br>        <span class="hljs-meta">@Tool(&quot;ç”¨æ¥è·å–ä»Šå¤©å…·ä½“æ—¥æœŸ&quot;)</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">dateUtil</span><span class="hljs-params">(String onUse)</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> LocalDateTime.now().toString();<br>        &#125;<br><br>        <span class="hljs-meta">@Tool(&quot;è·å–æŒ‡å®šæ—¥æœŸçš„ç”¨æˆ·ä¿¡æ¯&quot;)</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUserInfo</span><span class="hljs-params">(String date)</span> </span>&#123;<br>            User user1 = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>, <span class="hljs-number">88</span>, LocalDateTime.now().toLocalDate().toString());<br>            User user2 = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;æå››&quot;</span>, <span class="hljs-number">99</span>, <span class="hljs-string">&quot;2021-07-23&quot;</span>);<br>            <span class="hljs-keyword">return</span> Lists.newArrayList(user1, user2).stream()<br>                    .filter(u -&gt; LocalDate.parse(u.createTime).equals(LocalDate.parse(date)))<br>                    .toList().toString();<br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserService</span> </span>&#123;<br>        <span class="hljs-meta">@SystemMessage(&quot;å…ˆè·å–å½“å‰å…·ä½“çš„æ—¥æœŸï¼Œç„¶åå†è§£å†³ç”¨æˆ·é—®é¢˜&quot;)</span><br>        <span class="hljs-function">String <span class="hljs-title">getUserInfo</span><span class="hljs-params">(String desc)</span></span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException </span>&#123;<br>        ChatLanguageModel model = ZhipuAiChatModel<br>                .builder()<br>                .apiKey(<span class="hljs-string">&quot;5b755da0b2b04a8c9ba449808b72a474.uaEUl7Tim6xXHghK&quot;</span>)<br>                .build();<br><br>        UserService userService = AiServices.builder(UserService.class).chatLanguageModel(model)<br>                .tools(<span class="hljs-keyword">new</span> MyTools())<br>                .chatMemory(MessageWindowChatMemory.withMaxMessages(<span class="hljs-number">10</span>))<br>                .build();<br><br>        String userInfo = userService.getUserInfo(<span class="hljs-string">&quot;è·å–ä»Šå¤©æ³¨å†Œçš„ç”¨æˆ·ä¿¡æ¯&quot;</span>);<br>        System.out.println(userInfo);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¿”å›ç»“æœï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250723221332643.png" alt="image-20250723221332643"></p>]]></content>
    
    
    <categories>
      
      <category>LangChain4j</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>LangChain4jä¹‹ChatMemory</title>
    <link href="/LangChain4j%E4%B9%8BChatMemory/"/>
    <url>/LangChain4j%E4%B9%8BChatMemory/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ChatMemoryæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-ChatMemoryæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. ChatMemoryæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. <strong>ChatMemory</strong>æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>ChatMemoryæ˜¯LangChain4jæä¾›çš„ç”¨æ¥å­˜å‚¨å†å²å¯¹è¯çš„ç»„ä»¶ï¼Œå¹¶ä¸”è¿˜æ”¯æŒçª—å£é™åˆ¶ã€æ·˜æ±°æœºåˆ¶ã€æŒä¹…åŒ–æœºåˆ¶ç­‰ç­‰æ‰©å±•åŠŸèƒ½ã€‚</p><h1 id="2-ä½¿ç”¨"><a href="#2-ä½¿ç”¨" class="headerlink" title="2. ä½¿ç”¨"></a>2. ä½¿ç”¨</h1><h2 id="1-åŸºæœ¬ä½¿ç”¨"><a href="#1-åŸºæœ¬ä½¿ç”¨" class="headerlink" title="1. åŸºæœ¬ä½¿ç”¨"></a>1. åŸºæœ¬ä½¿ç”¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.memory.ChatMemory;<br><span class="hljs-keyword">import</span> dev.langchain4j.memory.chat.MessageWindowChatMemory;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.chat.ChatLanguageModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.zhipu.ZhipuAiChatModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.AiServices;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.UserMessage;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br><br>    <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">NamingMaster</span> </span>&#123;<br>        <span class="hljs-function">String <span class="hljs-title">name</span><span class="hljs-params">(<span class="hljs-meta">@UserMessage</span> String desc)</span></span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br><br>        ChatLanguageModel model = ZhipuAiChatModel<br>                .builder()<br>                .apiKey(<span class="hljs-string">&quot;xxx&quot;</span>)<br>                .build();<br><br>        ChatMemory chatMemory = MessageWindowChatMemory.withMaxMessages(<span class="hljs-number">10</span>);<br><br>        NamingMaster namingMaster = AiServices.builder(NamingMaster.class).chatLanguageModel(model)<br>                .chatMemory(chatMemory)<br>                .build();<br><br>        String name = namingMaster.name(<span class="hljs-string">&quot;ç»™æˆ‘ä¸€ä¸ªå§“ç‹ç”·å­©åå­—ï¼Œä¸ç”¨è§£é‡Š&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;===========================ç¬¬ä¸€æ¬¡è¿”å›=====================================&quot;</span>);<br>        System.out.println(name);<br><br>        String name2 = namingMaster.name(<span class="hljs-string">&quot;æ¢ä¸€ä¸ª&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;===========================ç¬¬äºŒæ¬¡è¿”å›=====================================&quot;</span>);<br>        System.out.println(name2);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¿”å›ç»“æœï¼š</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250721202648342.png" alt="image-20250721202648342" style="zoom:50%;" /><h2 id="2-åŸºäºMemoryId"><a href="#2-åŸºäºMemoryId" class="headerlink" title="2. åŸºäºMemoryId"></a>2. åŸºäºMemoryId</h2><p>ä¸Šé¢çš„ä»£ç ï¼Œä¸€ä¸ªç”¨æˆ·ä½¿ç”¨æ²¡æœ‰é—®é¢˜ï¼Œä½†å¦‚æœå¤šä¸ªç”¨æˆ·ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªChatMemoryï¼Œé‚£å°±ä¼šå‡ºç°è¿™å¤šä¸ªç”¨æˆ·çš„å¯¹è¯è®°å½•æ··æ‚åœ¨ä¸€èµ·çš„é—®é¢˜ã€‚</p><p>å› æ­¤ï¼Œéœ€è¦æ”¹é€ ä¸€ä¸‹AiServicesä¸­è®¾ç½®ChatMemoryçš„æ–¹å¼ï¼Œè®©æ¯ä¸ªä¸åŒçš„userIdå¯¹åº”ä¸åŒçš„ChatMemoryå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.memory.chat.TokenWindowChatMemory;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.chat.ChatLanguageModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.openai.OpenAiTokenizer;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.zhipu.ZhipuAiChatModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.AiServices;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.MemoryId;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.UserMessage;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br><br>    <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">NamingMaster</span> </span>&#123;<br>        <span class="hljs-function">String <span class="hljs-title">name</span><span class="hljs-params">(<span class="hljs-meta">@MemoryId</span> String userId, <span class="hljs-meta">@UserMessage</span> String desc)</span></span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ChatLanguageModel model = ZhipuAiChatModel<br>                .builder()<br>                .apiKey(<span class="hljs-string">&quot;xxx&quot;</span>)<br>                .build();<br><br>        NamingMaster namingMaster = AiServices.builder(NamingMaster.class).chatLanguageModel(model)<br>                <span class="hljs-comment">//é™åˆ¶ä¼šè¯å†å²è®°å½•çš„æœ€å¤§tokenæ•°ä¸º10000ï¼Œå¹¶ä½¿ç”¨OpenAIçš„åˆ†è¯å™¨è¿›è¡Œtokenè®¡æ•°ã€‚</span><br>                .chatMemoryProvider(userId -&gt; TokenWindowChatMemory.builder().id(userId).maxTokens(<span class="hljs-number">10000</span>,<span class="hljs-keyword">new</span> OpenAiTokenizer()).build())<br>                .build();<br><br>        String name = namingMaster.name(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;ç»™æˆ‘ä¸€ä¸ªå§“ç‹çš„ç”·å­©åå­—ï¼Œä¸ç”¨è§£é‡Š&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;===========================ç¬¬ä¸€æ¬¡è¿”å›=====================================&quot;</span>);<br>        System.out.println(name);<br><br>        String name1 = namingMaster.name(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;ç»™æˆ‘ä¸€ä¸ªæœ€å¥½åƒçš„æ°´æœåï¼Œ ä¸ç”¨è§£é‡Š&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;===========================ç¬¬äºŒæ¬¡è¿”å›=====================================&quot;</span>);<br>        System.out.println(name1);<br><br>        String name2 = namingMaster.name(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;æ¢ä¸€ä¸ª&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;===========================ç¬¬ä¸‰æ¬¡è¿”å›=====================================&quot;</span>);<br>        System.out.println(name2);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¿”å›ç»“æœï¼š</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250721203025165.png" alt="image-20250721203025165" style="zoom:50%;" /><h1 id="3-æºç å®ç°"><a href="#3-æºç å®ç°" class="headerlink" title="3. æºç å®ç°"></a>3. æºç å®ç°</h1><p>ChatMemoryæ˜¯ä¸€ä¸ªæ¥å£ï¼Œé»˜è®¤æä¾›äº†ä¸¤ä¸ªå®ç°ç±»ï¼š</p><ol><li>MessageWindowChatMemory</li><li>TokenWindowChatMemory</li></ol><h2 id="1-ChatMemoryStore"><a href="#1-ChatMemoryStore" class="headerlink" title="1. ChatMemoryStore"></a>1. ChatMemoryStore</h2><p>è¿™ä¸¤ä¸ªå®ç°ç±»å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªChatMemoryStoreå±æ€§ï¼ŒChatMemoryStoreä¹Ÿæ˜¯ä¸€ä¸ªæ¥å£ï¼Œé»˜è®¤æœ‰ä¸€ä¸ªInMemoryChatMemoryStoreå®ç°ç±»ã€‚</p><p>æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªConcurrentHashMapï¼Œæ‰€ä»¥åŸç†ä¸Šæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ChatMemoryStoreçš„å®ç°ç±»æ¥å®ç°å°†ChatMessageæŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InMemoryChatMemoryStore</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ChatMemoryStore</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;Object, List&lt;ChatMessage&gt;&gt; messagesByMemoryId = <span class="hljs-keyword">new</span> ConcurrentHashMap();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">InMemoryChatMemoryStore</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;ChatMessage&gt; <span class="hljs-title">getMessages</span><span class="hljs-params">(Object memoryId)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (List)<span class="hljs-keyword">this</span>.messagesByMemoryId.computeIfAbsent(memoryId, (ignored) -&gt; &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ArrayList();<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">updateMessages</span><span class="hljs-params">(Object memoryId, List&lt;ChatMessage&gt; messages)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.messagesByMemoryId.put(memoryId, messages);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">deleteMessages</span><span class="hljs-params">(Object memoryId)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.messagesByMemoryId.remove(memoryId);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-MessageWindowChatMemory"><a href="#2-MessageWindowChatMemory" class="headerlink" title="2. MessageWindowChatMemory"></a>2. MessageWindowChatMemory</h2><p>é‚£ä¹ˆMessageWindowChatMemoryé™¤å¼€å¯ä»¥å­˜å‚¨ChatMessageä¹‹å¤–ï¼Œè¿˜æœ‰æ·˜æ±°æœºåˆ¶,å¯ä»¥è®¾ç½®maxMessagesï¼Œè¶…è¿‡maxMessagesä¼šæ·˜æ±°æœ€æ—§çš„ChatMessageï¼ŒSystemMessageä¸ä¼šè¢«æ·˜æ±°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(ChatMessage message)</span> </span>&#123;<br>    List&lt;ChatMessage&gt; messages = <span class="hljs-keyword">this</span>.messages();<br>    <span class="hljs-keyword">if</span> (message <span class="hljs-keyword">instanceof</span> SystemMessage) &#123;<br>        Optional&lt;SystemMessage&gt; systemMessage = findSystemMessage(messages);<br>      <span class="hljs-comment">// æ›¿æ¢SystemMessage</span><br>        <span class="hljs-keyword">if</span> (systemMessage.isPresent()) &#123;<br>            <span class="hljs-keyword">if</span> (((SystemMessage)systemMessage.get()).equals(message)) &#123;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            messages.remove(systemMessage.get()); <br>        &#125;<br>    &#125;<br><br>    messages.add(message);<br>  <span class="hljs-comment">// å¦‚æœè¶…è¿‡äº†maxMessagesé™åˆ¶ï¼Œåˆ™ä¼šæ·˜æ±°Listæœ€å‰é¢çš„ï¼Œä¹Ÿå°±æ˜¯æœ€æ—§çš„ChatMessage</span><br> <span class="hljs-comment">// æ³¨æ„ï¼ŒSystemMessageä¸ä¼šè¢«æ·˜æ±°</span><br>    ensureCapacity(messages, <span class="hljs-keyword">this</span>.maxMessages);<br>    <span class="hljs-keyword">this</span>.store.updateMessages(<span class="hljs-keyword">this</span>.id, messages);<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="3-TokenWindowChatMemory"><a href="#3-TokenWindowChatMemory" class="headerlink" title="3. TokenWindowChatMemory"></a>3. TokenWindowChatMemory</h2><p>TokenWindowChatMemoryå’ŒMessageWindowChatMemoryç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºè®¡ç®—å®¹é‡çš„æ–¹å¼ä¸ä¸€æ ·ï¼ŒMessageWindowChatMemoryç›´æ¥å–çš„æ˜¯List<ChatMessage>çš„å¤§å°ï¼Œè€ŒTokenWindowChatMemoryä¼šåˆ©ç”¨æŒ‡å®šçš„Tokenizerå¯¹List<ChatMessage>å¯¹åº”çš„Tokenæ•°è¿›è¡Œä¼°ç®—ï¼Œç„¶åå’Œè®¾ç½®çš„maxTokensè¿›è¡Œæ¯”è¾ƒï¼Œè¶…è¿‡maxTokensä¹Ÿä¼šè¿›è¡Œæ·˜æ±°ï¼Œä¹Ÿæ˜¯æ·˜æ±°æœ€æ—§çš„ChatMessageã€‚</p><p>Tokenizeræ˜¯ä¸€ä¸ªæ¥å£ï¼Œé»˜è®¤æä¾›äº†OpenAiTokenizerå®ç°ç±»ï¼Œæ˜¯ç”¨æ¥ä¼°ç®—ä¸€æ¡ChatMessageå¯¹åº”å¤šå°‘ä¸ªTokençš„ï¼Œå¾ˆå¤šå¤§æ¨¡å‹çš„APIéƒ½æ˜¯æŒ‰ä½¿ç”¨çš„Tokenæ•°æ¥æ”¶è´¹çš„ï¼Œæ‰€ä»¥åœ¨å¯¹æˆæœ¬æ¯”è¾ƒæ•æ„Ÿæ—¶ï¼Œå»ºè®®ä½¿ç”¨TokenWindowChatMemoryæ¥å¯¹ä¸€ä¸ªä¼šè¯ä½¿ç”¨çš„æ€»Tokenæ•°è¿›è¡Œæ§åˆ¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(ChatMessage message)</span> </span>&#123;<br>    List&lt;ChatMessage&gt; messages = <span class="hljs-keyword">this</span>.messages();<br>    <span class="hljs-keyword">if</span> (message <span class="hljs-keyword">instanceof</span> SystemMessage) &#123;<br>        Optional&lt;SystemMessage&gt; maybeSystemMessage = findSystemMessage(messages);<br>        <span class="hljs-keyword">if</span> (maybeSystemMessage.isPresent()) &#123;<br>            <span class="hljs-keyword">if</span> (((SystemMessage)maybeSystemMessage.get()).equals(message)) &#123;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            messages.remove(maybeSystemMessage.get());<br>        &#125;<br>    &#125;<br><br>    messages.add(message);<br>   <span class="hljs-comment">// å¦‚æœè¶…è¿‡äº†maxTokensé™åˆ¶ï¼Œåˆ™ä¼šæ·˜æ±°Listæœ€å‰é¢çš„</span><br>    ensureCapacity(messages, <span class="hljs-keyword">this</span>.maxTokens, <span class="hljs-keyword">this</span>.tokenizer);<br>    <span class="hljs-keyword">this</span>.store.updateMessages(<span class="hljs-keyword">this</span>.id, messages);<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LangChain4j</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>LangChain4jä¹‹AiService</title>
    <link href="/LangChain4j%E4%B9%8BAiService/"/>
    <url>/LangChain4j%E4%B9%8BAiService/</url>
    
    <content type="html"><![CDATA[<h1 id="1-AiServiceæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-AiServiceæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. AiServiceæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. AiServiceæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p><code>LangChain4j</code> çš„ <code>AiService</code> æ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å·¥å…·ï¼Œå®ƒå…è®¸å¼€å‘è€…é€šè¿‡å®šä¹‰æ¥å£å’Œä½¿ç”¨æ³¨è§£çš„æ–¹å¼å¿«é€Ÿåˆ›å»ºåŸºäºè¯­è¨€æ¨¡å‹çš„æœåŠ¡ã€‚è¿™ä¸ªæœºåˆ¶æå¤§åœ°ç®€åŒ–äº†ä¸è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ Qwenã€ChatGPT ç­‰ï¼‰äº¤äº’çš„è¿‡ç¨‹ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥æ›´ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘è€Œéåº•å±‚é€šä¿¡ç»†èŠ‚ã€‚</p><h3 id="ä¸»è¦æ¦‚å¿µ"><a href="#ä¸»è¦æ¦‚å¿µ" class="headerlink" title="ä¸»è¦æ¦‚å¿µ"></a>ä¸»è¦æ¦‚å¿µ</h3><ol><li><strong>æ¥å£å®šä¹‰</strong>ï¼šä½ é¦–å…ˆéœ€è¦å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œå…¶ä¸­çš„æ–¹æ³•ä»£è¡¨äº†ä½ å¸Œæœ›è¯­è¨€æ¨¡å‹æ‰§è¡Œçš„ä»»åŠ¡ã€‚</li><li><strong>æ³¨è§£</strong>ï¼šåœ¨æ–¹æ³•ä¸Šæ·»åŠ ç‰¹å®šçš„æ³¨è§£æ¥æŒ‡å¯¼LangChain4jå¦‚ä½•å¤„ç†è¿™äº›è¯·æ±‚ï¼Œä¾‹å¦‚ï¼š<ul><li><code>@SystemMessage</code>ï¼šæŒ‡å®šç³»ç»Ÿæ¶ˆæ¯æˆ–è§’è‰²æè¿°ã€‚</li><li><code>@UserMessage</code>ï¼šæ ‡è®°ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯ã€‚</li><li><code>@Moderate</code>ï¼šå¯ç”¨å†…å®¹å®¡æ ¸ã€‚</li><li><code>@V</code>ï¼šç”¨äºå˜é‡æ’å€¼ã€‚</li></ul></li><li><strong>åŠ¨æ€ä»£ç†</strong>ï¼š<code>AiServices.builder()</code> ä¼šæ ¹æ®ä½ çš„æ¥å£å®šä¹‰ç”Ÿæˆä¸€ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨è¿è¡Œæ—¶å°†è°ƒç”¨è½¬å‘ç»™å®é™…çš„è¯­è¨€æ¨¡å‹ï¼Œå¹¶è¿”å›ç»“æœã€‚</li></ol><h1 id="2-AiServiceä½¿ç”¨"><a href="#2-AiServiceä½¿ç”¨" class="headerlink" title="2. AiServiceä½¿ç”¨"></a>2. AiServiceä½¿ç”¨</h1><ul><li><p>åˆ›å»ºChatLanguageModel</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.model.chat.ChatLanguageModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.zhipu.ZhipuAiChatModel;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ModelFactory</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ChatLanguageModel <span class="hljs-title">buildChatLanguageModel</span><span class="hljs-params">()</span> </span>&#123;<br>        String API_KEY = <span class="hljs-string">&quot;xxx&quot;</span>;<br>        <span class="hljs-keyword">return</span> ZhipuAiChatModel<br>                .builder()<br>                .apiKey(API_KEY)<br>                .build();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h2 id="1-SystemMessageæŒ‡å®šç³»ç»Ÿæ¶ˆæ¯"><a href="#1-SystemMessageæŒ‡å®šç³»ç»Ÿæ¶ˆæ¯" class="headerlink" title="1. @SystemMessageæŒ‡å®šç³»ç»Ÿæ¶ˆæ¯"></a>1. @SystemMessageæŒ‡å®šç³»ç»Ÿæ¶ˆæ¯</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.service.AiServices;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.SystemMessage;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">WriterAiService</span> </span>&#123;<br><br>    <span class="hljs-meta">@SystemMessage(&quot;è¯·æ‰®æ¼”ä¸€åä½œå®¶ï¼Œæ ¹æ®è¾“å…¥çš„æ–‡ç« é¢˜ç›®å†™ä¸€ç¯‡200å­—ä»¥å†…çš„ä½œæ–‡&quot;)</span><br>    <span class="hljs-function">String <span class="hljs-title">write</span><span class="hljs-params">(String title)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">static</span> WriterAiService <span class="hljs-title">create</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> AiServices.builder(WriterAiService.class)<br>                .chatLanguageModel(ModelFactory.buildChatLanguageModel())<br>                .build();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        WriterAiService writer = WriterAiService.create();<br>        String result = writer.write(<span class="hljs-string">&quot;æˆ‘æœ€çˆ±çš„äºº&quot;</span>);<br>        System.out.println(result);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250720164749767.png" alt="image-20250720164749767"></p><h2 id="2-UserMessageï¼šæ ‡è®°ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯ã€‚"><a href="#2-UserMessageï¼šæ ‡è®°ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯ã€‚" class="headerlink" title="2. @UserMessageï¼šæ ‡è®°ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯ã€‚"></a>2. <code>@UserMessage</code>ï¼šæ ‡è®°ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯ã€‚</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.service.AiServices;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.SystemMessage;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.UserMessage;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.V;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">WriterAiService</span> </span>&#123;<br><br>    <span class="hljs-meta">@SystemMessage(&quot;è¯·æ‰®æ¼”ä¸€åä½œå®¶ï¼Œæ ¹æ®è¾“å…¥çš„æ–‡ç« é¢˜ç›®å†™ä¸€ç¯‡&#123;&#123;count&#125;&#125;å­—ä»¥å†…çš„ä½œæ–‡&quot;)</span><br>    <span class="hljs-function">String <span class="hljs-title">write</span><span class="hljs-params">(<span class="hljs-meta">@UserMessage</span> String title, <span class="hljs-meta">@V(&quot;count&quot;)</span> Integer count)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">static</span> WriterAiService <span class="hljs-title">create</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> AiServices.builder(WriterAiService.class)<br>                .chatLanguageModel(ModelFactory.buildChatLanguageModel())<br>                .build();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        WriterAiService writer = WriterAiService.create();<br>        String result = writer.write(<span class="hljs-string">&quot;æˆ‘æœ€çˆ±çš„äºº&quot;</span>, <span class="hljs-number">30</span>);<br>        System.out.println(result);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250720164944981.png" alt="image-20250720164944981" style="zoom:50%;" /><h2 id="3-ç³»ç»Ÿæç¤ºè¯å†™åœ¨æ–‡ä»¶é‡Œ"><a href="#3-ç³»ç»Ÿæç¤ºè¯å†™åœ¨æ–‡ä»¶é‡Œ" class="headerlink" title="3.  ç³»ç»Ÿæç¤ºè¯å†™åœ¨æ–‡ä»¶é‡Œ"></a>3.  ç³»ç»Ÿæç¤ºè¯å†™åœ¨æ–‡ä»¶é‡Œ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.service.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">WriterAiService</span> </span>&#123;<br><br>    <span class="hljs-meta">@SystemMessage(fromResource = &quot;/system_message.txt&quot;)</span><br>    <span class="hljs-function">String <span class="hljs-title">write</span><span class="hljs-params">(<span class="hljs-meta">@UserMessage</span> String title, <span class="hljs-meta">@V(&quot;count&quot;)</span> Integer count)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">static</span> WriterAiService <span class="hljs-title">create</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> AiServices.builder(WriterAiService.class)<br>                .chatLanguageModel(ModelFactory.buildChatLanguageModel())<br>                .build();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4-Moderateï¼šå¯ç”¨å†…å®¹å®¡æ ¸"><a href="#4-Moderateï¼šå¯ç”¨å†…å®¹å®¡æ ¸" class="headerlink" title="4. @Moderateï¼šå¯ç”¨å†…å®¹å®¡æ ¸"></a>4. <code>@Moderate</code>ï¼šå¯ç”¨å†…å®¹å®¡æ ¸</h2><p>å¢åŠ @Moderateæ³¨è§£ï¼ŒåŒæ—¶éœ€è¦å¢åŠ moderationModel</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.data.message.ChatMessage;<br><span class="hljs-keyword">import</span> dev.langchain4j.data.segment.TextSegment;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.input.Prompt;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.moderation.Moderation;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.moderation.ModerationModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.output.Response;<br><span class="hljs-keyword">import</span> dev.langchain4j.service.*;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">WriterAiService</span> </span>&#123;<br><br>    <span class="hljs-meta">@SystemMessage(&quot;è¯·æ‰®æ¼”ä¸€åä½œå®¶ï¼Œå†™ä¸€ç¯‡æ€äºº&#123;&#123;count&#125;&#125;å­—ä»¥å†…çš„ä½œæ–‡&quot;)</span><br>    <span class="hljs-meta">@Moderate</span><br>    <span class="hljs-function">String <span class="hljs-title">write</span><span class="hljs-params">(<span class="hljs-meta">@UserMessage</span> String title, <span class="hljs-meta">@V(&quot;count&quot;)</span> Integer count)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">static</span> WriterAiService <span class="hljs-title">create</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> AiServices.builder(WriterAiService.class)<br>                .chatLanguageModel(ModelFactory.buildChatLanguageModel())<br>                .moderationModel(<span class="hljs-keyword">new</span> ModerationModel() &#123;<br>                    <span class="hljs-meta">@Override</span><br>                    <span class="hljs-function"><span class="hljs-keyword">public</span> Response&lt;Moderation&gt; <span class="hljs-title">moderate</span><span class="hljs-params">(String s)</span> </span>&#123;<br>                        <span class="hljs-comment">// åœ¨è¿™é‡Œå®ç°å…·ä½“çš„å®¡æ ¸é€»è¾‘</span><br>                        <span class="hljs-keyword">return</span> Response.from(Moderation.flagged(s));<br>                    &#125;<br><br>                    <span class="hljs-meta">@Override</span><br>                    <span class="hljs-function"><span class="hljs-keyword">public</span> Response&lt;Moderation&gt; <span class="hljs-title">moderate</span><span class="hljs-params">(Prompt prompt)</span> </span>&#123;<br>                        <span class="hljs-comment">// åœ¨è¿™é‡Œå®ç°å…·ä½“çš„å®¡æ ¸é€»è¾‘</span><br>                        <span class="hljs-keyword">return</span> ModerationModel.<span class="hljs-keyword">super</span>.moderate(prompt);<br>                    &#125;<br><br>                    <span class="hljs-meta">@Override</span><br>                    <span class="hljs-function"><span class="hljs-keyword">public</span> Response&lt;Moderation&gt; <span class="hljs-title">moderate</span><span class="hljs-params">(ChatMessage message)</span> </span>&#123;<br>                        <span class="hljs-comment">// åœ¨è¿™é‡Œå®ç°å…·ä½“çš„å®¡æ ¸é€»è¾‘</span><br>                        <span class="hljs-keyword">return</span> ModerationModel.<span class="hljs-keyword">super</span>.moderate(message);<br>                    &#125;<br><br>                    <span class="hljs-meta">@Override</span><br>                    <span class="hljs-function"><span class="hljs-keyword">public</span> Response&lt;Moderation&gt; <span class="hljs-title">moderate</span><span class="hljs-params">(List&lt;ChatMessage&gt; list)</span> </span>&#123;<br>                        <span class="hljs-comment">// åœ¨è¿™é‡Œå®ç°å…·ä½“çš„å®¡æ ¸é€»è¾‘</span><br>                        <span class="hljs-keyword">return</span> Response.from(Moderation.flagged(list.toString()));<br>                    &#125;<br><br><br>                    <span class="hljs-meta">@Override</span><br>                    <span class="hljs-function"><span class="hljs-keyword">public</span> Response&lt;Moderation&gt; <span class="hljs-title">moderate</span><span class="hljs-params">(TextSegment textSegment)</span> </span>&#123;<br>                        <span class="hljs-comment">// åœ¨è¿™é‡Œå®ç°å…·ä½“çš„å®¡æ ¸é€»è¾‘</span><br>                        <span class="hljs-keyword">return</span> ModerationModel.<span class="hljs-keyword">super</span>.moderate(textSegment);<br>                    &#125;<br>                &#125;)<br>                .build();<br>    &#125;<br></code></pre></td></tr></table></figure><h1 id="3-æºç åˆ†æ"><a href="#3-æºç åˆ†æ" class="headerlink" title="3. æºç åˆ†æ"></a>3. æºç åˆ†æ</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">AiServices.builder(WriterAiService.class)<br>                .chatLanguageModel(ModelFactory.buildChatLanguageModel())<br>                .build()<br></code></pre></td></tr></table></figure><p>ç”±äºAiServicesæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæºç ä¸­æœ‰ä¸€ä¸ªé»˜è®¤çš„å­ç±»DefaultAiServicesï¼Œæ ¸å¿ƒå®ç°æºç éƒ½åœ¨DefaultAiServicesä¸­ã€‚</p><p>DefaultAiServicesçš„buildæ–¹æ³•å°±æ˜¯ç”¨æ¥åˆ›å»ºæŒ‡å®šæ¥å£çš„ä»£ç†å¯¹è±¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">build</span><span class="hljs-params">()</span> </span>&#123;<br><br><span class="hljs-comment">// éªŒè¯æ˜¯å¦é…ç½®äº†ChatLanguageModel</span><br>performBasicValidation();<br><br><span class="hljs-comment">// éªŒè¯æ¥å£ä¸­æ˜¯å¦æœ‰æ–¹æ³•ä¸ŠåŠ äº†@Moderateï¼Œä½†æ˜¯åˆæ²¡æœ‰é…ç½®ModerationModel</span><br><span class="hljs-keyword">for</span> (Method method : context.aiServiceClass.getMethods()) &#123;<br><span class="hljs-keyword">if</span> (method.isAnnotationPresent(Moderate.class) &amp;&amp; context.moderationModel == <span class="hljs-keyword">null</span>) &#123;<br><span class="hljs-keyword">throw</span> illegalConfiguration(<span class="hljs-string">&quot;The @Moderate annotation is present, but the moderationModel is not set up. &quot;</span> +<br>   <span class="hljs-string">&quot;Please ensure a valid moderationModel is configured before using the @Moderate annotation.&quot;</span>);<br>&#125;<br>&#125;<br><br><span class="hljs-comment">// JDKåŠ¨æ€ä»£ç†åˆ›å»ºä»£ç†å¯¹è±¡</span><br>Object proxyInstance = Proxy.newProxyInstance(<br>context.aiServiceClass.getClassLoader(),<br><span class="hljs-keyword">new</span> Class&lt;?&gt;[]&#123;context.aiServiceClass&#125;,<br><span class="hljs-keyword">new</span> InvocationHandler() &#123;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><span class="hljs-comment">//...</span><br>        <span class="hljs-comment">// éªŒè¯å‚æ•°</span><br>         DefaultAiServices.validateParameters(method);<br>        <span class="hljs-comment">// è§£æç³»ç»Ÿæ¶ˆæ¯</span><br>         Optional&lt;SystemMessage&gt; systemMessage = DefaultAiServices.<span class="hljs-keyword">this</span>.prepareSystemMessage(method, args);<br>        <span class="hljs-comment">// è§£æç”¨æˆ·æ¶ˆæ¯</span><br>         dev.langchain4j.data.message.UserMessage userMessage = DefaultAiServices.prepareUserMessage(method, args);<br>        <span class="hljs-comment">// è¿™é‡Œå»ä½¿ç”¨chatModelå»è°ƒç”¨openAi, ç”Ÿæˆè¿”å›çš„ç»“æœ</span><br>       response = DefaultAiServices.<span class="hljs-keyword">this</span>.context.chatModel.generate((List)messages, DefaultAiServices.<span class="hljs-keyword">this</span>.context.toolSpecifications);<br><br>        <span class="hljs-comment">// ...</span><br>&#125;<br><br>&#125;);<br><br><span class="hljs-keyword">return</span> (T) proxyInstance;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œå…¶å®å°±æ˜¯ç”¨çš„JDKåŠ¨æ€ä»£ç†æœºåˆ¶åˆ›å»ºçš„ä»£ç†å¯¹è±¡ï¼Œåªä¸è¿‡åœ¨åˆ›å»ºä»£ç†å¯¹è±¡ä¹‹å‰æœ‰ä¸¤æ­¥éªŒè¯ï¼š</p><ol><li>éªŒè¯æ˜¯å¦é…ç½®äº†ChatLanguageModelï¼šè¿™ä¸€æ­¥ä¸éš¾ç†è§£ï¼Œå¦‚æœä»£ç†å¯¹è±¡æ²¡æœ‰é…ç½®ChatLanguageModelï¼Œé‚£å°±åˆ©ç”¨ä¸ä¸Šå¤§æ¨¡å‹çš„èƒ½åŠ›äº†</li><li>éªŒè¯æ¥å£ä¸­æ˜¯å¦æœ‰æ–¹æ³•ä¸ŠåŠ äº†@Moderateï¼Œä½†æ˜¯åˆæ²¡æœ‰é…ç½®ModerationModel</li></ol>]]></content>
    
    
    <categories>
      
      <category>LangChain4j</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>LangChain4jå…¥é—¨</title>
    <link href="/LangChain4j%E5%85%A5%E9%97%A8/"/>
    <url>/LangChain4j%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯LangChain4j"><a href="#1-ä»€ä¹ˆæ˜¯LangChain4j" class="headerlink" title="1. ä»€ä¹ˆæ˜¯LangChain4j"></a>1. ä»€ä¹ˆæ˜¯LangChain4j</h1><p>å®ƒæ˜¯Javaç‰ˆæœ¬çš„LangChainï¼Œæä¾›äº†ä¸€ä¸ªå¼€å‘æ¡†æ¶ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥å¾ˆå®¹æ˜“çš„ç”¨æ¥æ„å»ºå…·æœ‰LLMèƒ½åŠ›çš„åº”ç”¨ç¨‹åºã€‚å¦‚ä½•å°†å¤§æ¨¡å‹èƒ½åŠ›å’ŒJavaç¼–ç¨‹è¯­è¨€ç›¸ç»“åˆï¼Œè¿™å°±æ˜¯LangChain4jæ‰€åšçš„ã€‚</p><blockquote><p>LLMå°±æ˜¯Large Language Modelï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„å¤§è¯­è¨€æ¨¡å‹ï¼Œç®€ç§°å¤§æ¨¡å‹ã€‚</p></blockquote><h1 id="2-langchain4jé›†æˆOpenAiï¼ˆJavaï¼‰"><a href="#2-langchain4jé›†æˆOpenAiï¼ˆJavaï¼‰" class="headerlink" title="2. langchain4jé›†æˆOpenAiï¼ˆJavaï¼‰"></a>2. langchain4jé›†æˆOpenAiï¼ˆJavaï¼‰</h1><h2 id="1-å¼•å…¥ä¾èµ–"><a href="#1-å¼•å…¥ä¾èµ–" class="headerlink" title="1. å¼•å…¥ä¾èµ–"></a>1. å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>dev.langchain4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>langchain4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;langchain4j.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>dev.langchain4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>langchain4j-open-ai<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;langchain4j.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="2-æ™®é€šè°ƒç”¨"><a href="#2-æ™®é€šè°ƒç”¨" class="headerlink" title="2. æ™®é€šè°ƒç”¨"></a>2. æ™®é€šè°ƒç”¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.model.chat.ChatLanguageModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.openai.OpenAiChatModel;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String API_KEY = <span class="hljs-string">&quot;sk-peszVtFXoLnWK45bB15370Df6f344cAa9a088eF50f9c7302&quot;</span>;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ChatLanguageModel model = OpenAiChatModel<br>                .builder()<br>                .apiKey(API_KEY) <span class="hljs-comment">// éœ€è¦æ›¿æ¢æˆè‡ªå·±å»open AIç”³è¯·çš„API Key</span><br>                .modelName(<span class="hljs-string">&quot;gpt-4o-mini&quot;</span>)<br>                .build();<br><br>        String answer = model.generate(<span class="hljs-string">&quot;ä½ å¥½ï¼Œä½ æ˜¯è°ï¼Ÿ&quot;</span>);<br>        System.out.println(answer);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><ul><li><p>é»˜è®¤baseUrl æ˜¯<a href="https://api.openai.com/v1">https://api.openai.com/v1</a> ,å…·ä½“å¯æŸ¥çœ‹æºç OpenAiChatModel</p></li><li><p>open AI æŸ¥çœ‹api keyçš„åœ°å€ï¼š<a href="https://platform.openai.com/api-keys">https://platform.openai.com/api-keys</a></p></li></ul></blockquote><p><strong>è¿è¡Œç»“æœ</strong>ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250720152422613.png" alt="image-20250720152422613"></p><h2 id="3-æµå¼è°ƒç”¨"><a href="#3-æµå¼è°ƒç”¨" class="headerlink" title="3. æµå¼è°ƒç”¨"></a>3. æµå¼è°ƒç”¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.data.message.AiMessage;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.StreamingResponseHandler;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.chat.StreamingChatLanguageModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.openai.OpenAiStreamingChatModel;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String API_KEY = <span class="hljs-string">&quot;sk-peszVtFXoLnWK45bB15370Df6f344cAa9a088eF50f9c7302&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        StreamingChatLanguageModel model = OpenAiStreamingChatModel.builder()<br>                .apiKey(API_KEY)<br>                .modelName(<span class="hljs-string">&quot;gpt-4o-mini&quot;</span>)<br>                .build();<br><br>        model.generate(<span class="hljs-string">&quot;ä½ å¥½ï¼Œä½ æ˜¯è°ï¼Ÿ&quot;</span>, <span class="hljs-keyword">new</span> StreamingResponseHandler&lt;AiMessage&gt;() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onNext</span><span class="hljs-params">(String token)</span> </span>&#123;<br>                System.out.println(<span class="hljs-string">&quot;å½“å‰è¿”å›çš„å†…å®¹ä¸ºï¼š&quot;</span> + token);<br>            &#125;<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(Throwable error)</span> </span>&#123;<br>                System.out.println(error);<br>            &#125;<br>        &#125;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼ˆæ‰“å­—æœºæ•ˆæœï¼‰ï¼š</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250720154157785.png" alt="image-20250720154157785" style="zoom:50%;" /><h1 id="3-langchain4jé›†æˆOpenAiï¼ˆSpringBootï¼‰"><a href="#3-langchain4jé›†æˆOpenAiï¼ˆSpringBootï¼‰" class="headerlink" title="3. langchain4jé›†æˆOpenAiï¼ˆSpringBootï¼‰"></a>3. langchain4jé›†æˆOpenAiï¼ˆSpringBootï¼‰</h1><h2 id="1-å¼•å…¥ä¾èµ–-1"><a href="#1-å¼•å…¥ä¾èµ–-1" class="headerlink" title="1. å¼•å…¥ä¾èµ–"></a>1. å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>dev.langchain4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>langchain4j-open-ai-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.27.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="2-é…ç½®api-key"><a href="#2-é…ç½®api-key" class="headerlink" title="2. é…ç½®api-key"></a>2. é…ç½®api-key</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-meta">langchain4j.open-ai.chat-model.api-key</span>=<span class="hljs-string">demo</span><br></code></pre></td></tr></table></figure><blockquote><p>åœ¨åº•å±‚åœ¨æ„é€ OpenAiChatModelæ—¶ï¼Œä¼šåˆ¤æ–­ä¼ å…¥çš„ApiKeyæ˜¯å¦ç­‰äºâ€demoâ€ï¼Œå¦‚æœç­‰äºä¼šå°†OpenAiçš„åŸå§‹APIåœ°å€â€<a href="https://api.openai.com/v1&quot;%E6%94%B9%E4%B8%BA&quot;http://langchain4j.dev/demo/openai/v1&quot;%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%9C%B0%E5%9D%80%E6%98%AFlangchain4j%E4%B8%93%E9%97%A8%E4%B8%BA%E6%88%91%E4%BB%AC%E5%87%86%E5%A4%87%E7%9A%84%E4%B8%80%E4%B8%AA%E4%BD%93%E9%AA%8C%E5%9C%B0%E5%9D%80%EF%BC%8C%E5%AE%9E%E9%99%85%E4%B8%8A%E8%BF%99%E4%B8%AA%E5%9C%B0%E5%9D%80%E7%9B%B8%E5%BD%93%E4%BA%8E%E6%98%AF&quot;https://api.openai.com/v1&quot;%E7%9A%84%E4%BB%A3%E7%90%86%EF%BC%8C%E6%88%91%E4%BB%AC%E8%AF%B7%E6%B1%82%E4%BB%A3%E7%90%86%E6%97%B6%EF%BC%8C%E4%BB%A3%E7%90%86%E4%BC%9A%E5%8E%BB%E8%B0%83%E7%94%A8%E7%9C%9F%E6%AD%A3%E7%9A%84OpenAi%E6%8E%A5%E5%8F%A3%EF%BC%8C%E5%8F%AA%E4%B8%8D%E8%BF%87%E4%BB%A3%E7%90%86%E4%BC%9A%E5%B0%86%E8%87%AA%E5%B7%B1%E7%9A%84ApiKey%E4%BC%A0%E8%BF%87%E5%8E%BB%EF%BC%8C%E4%BB%8E%E8%80%8C%E6%8B%BF%E5%88%B0%E7%BB%93%E6%9E%9C%E8%BF%94%E5%9B%9E%E7%BB%99%E6%88%91%E4%BB%AC%E3%80%82">https://api.openai.com/v1&quot;æ”¹ä¸º&quot;http://langchain4j.dev/demo/openai/v1&quot;ï¼Œè¿™ä¸ªåœ°å€æ˜¯langchain4jä¸“é—¨ä¸ºæˆ‘ä»¬å‡†å¤‡çš„ä¸€ä¸ªä½“éªŒåœ°å€ï¼Œå®é™…ä¸Šè¿™ä¸ªåœ°å€ç›¸å½“äºæ˜¯&quot;https://api.openai.com/v1&quot;çš„ä»£ç†ï¼Œæˆ‘ä»¬è¯·æ±‚ä»£ç†æ—¶ï¼Œä»£ç†ä¼šå»è°ƒç”¨çœŸæ­£çš„OpenAiæ¥å£ï¼Œåªä¸è¿‡ä»£ç†ä¼šå°†è‡ªå·±çš„ApiKeyä¼ è¿‡å»ï¼Œä»è€Œæ‹¿åˆ°ç»“æœè¿”å›ç»™æˆ‘ä»¬ã€‚</a> </p><p>è¿™ä¸ªkeyä¸æ”¯æŒæµå¼å“åº”ï¼Œæ‰€ä»¥çœŸæ­£å¼€å‘ï¼Œè¿˜æ˜¯è¦æ›¿æ¢è‡ªå·±çš„Keyã€‚</p></blockquote><h2 id="3-è°ƒç”¨"><a href="#3-è°ƒç”¨" class="headerlink" title="3. è°ƒç”¨"></a>3. è°ƒç”¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.model.chat.ChatLanguageModel;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> ChatLanguageModel chatLanguageModel;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">hello</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> chatLanguageModel.generate(<span class="hljs-string">&quot;ä½ å¥½å•Š&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="4-langchain4jå†…å®¹å®¡æ ¸ä¹‹Moderation"><a href="#4-langchain4jå†…å®¹å®¡æ ¸ä¹‹Moderation" class="headerlink" title="4. langchain4jå†…å®¹å®¡æ ¸ä¹‹Moderation"></a>4. langchain4jå†…å®¹å®¡æ ¸ä¹‹Moderation</h1><p>ModerationModelèƒ½å¤Ÿæ ¡éªŒè¾“å…¥ä¸­æ˜¯å¦å­˜åœ¨æ•æ„Ÿå†…å®¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.model.moderation.Moderation;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.moderation.ModerationModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.openai.OpenAiModerationModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.output.Response;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestModeration</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ModerationModel moderationModel = OpenAiModerationModel.withApiKey(<span class="hljs-string">&quot;demo&quot;</span>);<br>        Response&lt;Moderation&gt; response = moderationModel.moderate(<span class="hljs-string">&quot;æˆ‘è¦æ€äº†ä½ &quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;è¿åOpenAI çš„ä½¿ç”¨ç­–ç•¥: &quot;</span> + response.content().flagged());<br>        System.out.println(<span class="hljs-string">&quot;è¿è§„å†…å®¹ä¸ºï¼š&quot;</span> + response.content().flaggedText());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿”å›ç»“æœï¼š</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250720160406631.png" alt="image-20250720160406631" style="zoom:50%;" /><h1 id="5-langchain4jç”Ÿæˆå›¾ç‰‡ä¹‹ImageModel"><a href="#5-langchain4jç”Ÿæˆå›¾ç‰‡ä¹‹ImageModel" class="headerlink" title="5. langchain4jç”Ÿæˆå›¾ç‰‡ä¹‹ImageModel"></a>5. langchain4jç”Ÿæˆå›¾ç‰‡ä¹‹ImageModel</h1><p>é»˜è®¤æä¾›çš„â€œdemoâ€keyä¸èƒ½ç”¨æ¥ç”Ÿæˆå›¾ç‰‡ï¼Œéœ€è¦å¤§å®¶è‡ªå·±è´­ä¹°apiKey</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> dev.langchain4j.data.image.Image;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.image.ImageModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.openai.OpenAiImageModel;<br><span class="hljs-keyword">import</span> dev.langchain4j.model.output.Response;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_01_Main</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String API_KEY = <span class="hljs-string">&quot;xxx&quot;</span>;<br>  <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ImageModel imageModel = OpenAiImageModel.builder()<br>                .apiKey(API_KEY)<br>                .build();<br>        Response&lt;Image&gt; response = imageModel.generate(<span class="hljs-string">&quot;ä¸€è¾†è½¦&quot;</span>);<br>        System.out.println(response.content().url());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LangChain4j</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Vue3è·¨å±‚çº§é€šä¿¡æŠ€å·§</title>
    <link href="/Vue3%E8%B7%A8%E5%B1%82%E7%BA%A7%E9%80%9A%E4%BF%A1%E6%8A%80%E5%B7%A7/"/>
    <url>/Vue3%E8%B7%A8%E5%B1%82%E7%BA%A7%E9%80%9A%E4%BF%A1%E6%8A%80%E5%B7%A7/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Provide-å’Œ-Inject"><a href="#1-Provide-å’Œ-Inject" class="headerlink" title="1. Provide å’Œ Inject"></a>1. <strong>Provide å’Œ Inject</strong></h1><ul><li><code>provide</code>å’Œ<code>inject</code>å…è®¸ç¥–å…ˆç»„ä»¶å‘ä»»æ„æ·±åº¦çš„åä»£ç»„ä»¶æä¾›æ•°æ®ï¼Œè€Œä¸éœ€è¦ç»è¿‡ä¸­é—´ç»„ä»¶ propsé€å±‚ä¼ é€’ã€‚</li><li>ç¥–å…ˆç»„ä»¶ä½¿ç”¨<code>provide</code>æ¥æä¾›æ•°æ®ï¼Œåä»£ç»„ä»¶ä½¿ç”¨<code>inject</code>æ¥æ¥æ”¶è¿™äº›æ•°æ®ã€‚è¿™ç§æ–¹å¼éå¸¸é€‚åˆç”¨äºä¸»é¢˜ã€ç”¨æˆ·åå¥½è®¾ç½®ç­‰å…¨å±€æˆ–åŠå…¨å±€çš„æ•°æ®å…±äº«ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;script setup lang=<span class="hljs-string">&quot;ts&quot;</span>&gt;<br>    <span class="hljs-keyword">import</span> &#123; provide &#125; from <span class="hljs-string">&#x27;vue&#x27;</span><br>    <span class="hljs-keyword">const</span> rules = &#123; name: <span class="hljs-string">&#x27;required&#x27;</span>, age: <span class="hljs-string">&#x27;number&#x27;</span> &#125;<br>    provide(<span class="hljs-string">&#x27;rules&#x27;</span>, rules)<br>&lt;/script&gt;<br>&lt;script setup lang=<span class="hljs-string">&quot;ts&quot;</span>&gt;<br>    <span class="hljs-keyword">import</span> &#123; inject &#125; from <span class="hljs-string">&#x27;vue&#x27;</span><br>    <span class="hljs-keyword">const</span> rules = inject(<span class="hljs-string">&#x27;rules&#x27;</span>)<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><h1 id="2-Pinia"><a href="#2-Pinia" class="headerlink" title="2. Pinia"></a>2. Pinia</h1><ul><li>Piniaåˆ™æ˜¯Vue 3çš„æ–°ä¸€ä»£çŠ¶æ€ç®¡ç†åº“ï¼Œå®ƒæ›´è½»é‡ä¸”æ˜“äºä½¿ç”¨ã€‚</li><li>å®ç°æ€è·¯ï¼šå®šä¹‰storeå­˜å‚¨å˜é‡ï¼Œåœ¨å­ç»„ä»¶ä¸­æ›´æ–°storeçš„å€¼ï¼Œåœ¨çˆ¶ç»„ä»¶ç›‘å¬</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java">export <span class="hljs-keyword">const</span> useModelStore = defineStore(<span class="hljs-string">&#x27;model&#x27;</span>, () =&gt; &#123;<br>  <span class="hljs-comment">// å½“å‰æ¨¡å‹</span><br>  <span class="hljs-keyword">const</span> currentModelInfo = ref&lt;GetSessionListVO&gt;(&lt;GetSessionListVO&gt;&#123;&#125;);<br><br>  <span class="hljs-comment">// è®¾ç½®å½“å‰æ¨¡å‹</span><br>  <span class="hljs-keyword">const</span> setCurrentModelInfo = (modelInfo: GetSessionListVO) =&gt; &#123;<br>    currentModelInfo.value = modelInfo;<br>  &#125;;<br>  <span class="hljs-keyword">return</span> &#123;<br>    currentModelInfo,<br>    setCurrentModelInfo,<br>  &#125;<br>&#125;);<br>&lt;script setup lang=<span class="hljs-string">&quot;ts&quot;</span>&gt;<br>  <span class="hljs-function">function <span class="hljs-title">handleClick</span><span class="hljs-params">(item: GetSessionListVO)</span> </span>&#123;<br>    modelStore.setCurrentModelInfo(item);<br>  &#125;<br>&lt;/script&gt;<br><br>&lt;template&gt;<br>    &lt;div<br>      <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;model-select&quot;</span><br>      :<span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;&#123; &#x27;bg-[rgba(0,0,0,.04)] is-select&#x27;: item.modelName === currentModelName &#125;&quot;</span><br>      <span class="hljs-meta">@click</span>=<span class="hljs-string">&quot;handleClick(item)&quot;</span><br>    &gt;<br>&lt;/template&gt;<br>&lt;script setup lang=<span class="hljs-string">&quot;ts&quot;</span>&gt;<br>  watch(<br>      () =&gt; modelStore.currentModelInfo,<br>      (val) =&gt; &#123;<br>        <span class="hljs-keyword">if</span> (val.modelName === modelStore.defaultModel.modelName) &#123;<br>          <span class="hljs-keyword">return</span>;<br>        &#125;<br>        senderRef.value.openHeader();<br>      &#125;,<br>    );<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>mybatis-pluså­—æ®µè‡ªåŠ¨å¡«å……</title>
    <link href="/mybatis-plus%E5%AD%97%E6%AE%B5%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85/"/>
    <url>/mybatis-plus%E5%AD%97%E6%AE%B5%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä¸»é”®IDç”Ÿæˆ"><a href="#1-ä¸»é”®IDç”Ÿæˆ" class="headerlink" title="1. ä¸»é”®IDç”Ÿæˆ"></a>1. ä¸»é”®IDç”Ÿæˆ</h1><h2 id="1-1-åœ¨ä¸»é”®ä¸ŠåŠ æ³¨è§£"><a href="#1-1-åœ¨ä¸»é”®ä¸ŠåŠ æ³¨è§£" class="headerlink" title="1.1. åœ¨ä¸»é”®ä¸ŠåŠ æ³¨è§£"></a>1.1. åœ¨ä¸»é”®ä¸ŠåŠ æ³¨è§£</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    <span class="hljs-meta">@TableId(type = IdType.ID_WORKER)</span><br>    <span class="hljs-keyword">private</span> Long id;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="1-2-å…¨å±€é…ç½®é»˜è®¤IDç”Ÿæˆç­–ç•¥"><a href="#1-2-å…¨å±€é…ç½®é»˜è®¤IDç”Ÿæˆç­–ç•¥" class="headerlink" title="1.2. å…¨å±€é…ç½®é»˜è®¤IDç”Ÿæˆç­–ç•¥"></a>1.2. å…¨å±€é…ç½®é»˜è®¤IDç”Ÿæˆç­–ç•¥</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">mybatis-plus:</span><br>  <span class="hljs-attr">global-config:</span><br>    <span class="hljs-attr">db-config:</span><br>      <span class="hljs-attr">id-type:</span> <span class="hljs-string">auto</span> <span class="hljs-comment"># å¯é€‰å€¼æœ‰ï¼šauto, input, assign_id, assign_uuid, none, id_workerç­‰</span><br></code></pre></td></tr></table></figure><h2 id="1-3-å®šä¹‰ä¸€ä¸ªå…¨å±€-ID-ç”Ÿæˆå™¨-Bean"><a href="#1-3-å®šä¹‰ä¸€ä¸ªå…¨å±€-ID-ç”Ÿæˆå™¨-Bean" class="headerlink" title="1.3. å®šä¹‰ä¸€ä¸ªå…¨å±€ ID ç”Ÿæˆå™¨ Bean"></a>1.3. å®šä¹‰ä¸€ä¸ªå…¨å±€ ID ç”Ÿæˆå™¨ Bean</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.incrementer.IdentifierGenerator;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.incrementer.DefaultIdentifierGenerator;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBatisPlusConfig</span> </span>&#123;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä½¿ç”¨ç½‘å¡ä¿¡æ¯ç»‘å®šé›ªèŠ±ç”Ÿæˆå™¨</span><br><span class="hljs-comment">     * é˜²æ­¢é›†ç¾¤é›ªèŠ±IDé‡å¤</span><br><span class="hljs-comment">     */</span><br>    <br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> IdentifierGenerator <span class="hljs-title">idGenerator</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DefaultIdentifierGenerator(NetUtil.getLocalhost());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="2-å­—æ®µè‡ªåŠ¨å¡«å……"><a href="#2-å­—æ®µè‡ªåŠ¨å¡«å……" class="headerlink" title="2. å­—æ®µè‡ªåŠ¨å¡«å……"></a>2. å­—æ®µè‡ªåŠ¨å¡«å……</h1><h2 id="2-1-entityåŠ æ³¨è§£"><a href="#2-1-entityåŠ æ³¨è§£" class="headerlink" title="2.1. entityåŠ æ³¨è§£"></a>2.1. entityåŠ æ³¨è§£</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åˆ›å»ºè€…</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@TableField(fill = FieldFill.INSERT)</span><br><span class="hljs-keyword">private</span> Long createBy;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åˆ›å»ºæ—¶é—´</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@TableField(fill = FieldFill.INSERT)</span><br><span class="hljs-keyword">private</span> Date createTime;<br></code></pre></td></tr></table></figure><h2 id="2-2-è‡ªå®šä¹‰å®ç°ç±»-InjectionMetaObjectHandler"><a href="#2-2-è‡ªå®šä¹‰å®ç°ç±»-InjectionMetaObjectHandler" class="headerlink" title="2.2. è‡ªå®šä¹‰å®ç°ç±» InjectionMetaObjectHandler"></a>2.2. è‡ªå®šä¹‰å®ç°ç±» InjectionMetaObjectHandler</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InjectionMetaObjectHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MetaObjectHandler</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ’å…¥å¡«å……æ–¹æ³•ï¼Œç”¨äºåœ¨æ’å…¥æ•°æ®æ—¶è‡ªåŠ¨å¡«å……å®ä½“å¯¹è±¡ä¸­çš„åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ã€åˆ›å»ºäººã€æ›´æ–°äººç­‰ä¿¡æ¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> metaObject å…ƒå¯¹è±¡ï¼Œç”¨äºè·å–åŸå§‹å¯¹è±¡å¹¶è¿›è¡Œå¡«å……</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insertFill</span><span class="hljs-params">(MetaObject metaObject)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">if</span> (ObjectUtil.isNotNull(metaObject) &amp;&amp; metaObject.getOriginalObject() <span class="hljs-keyword">instanceof</span> BaseEntity baseEntity) &#123;<br>                <span class="hljs-comment">// è·å–å½“å‰æ—¶é—´ä½œä¸ºåˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´ï¼Œå¦‚æœåˆ›å»ºæ—¶é—´ä¸ä¸ºç©ºï¼Œåˆ™ä½¿ç”¨åˆ›å»ºæ—¶é—´ï¼Œå¦åˆ™ä½¿ç”¨å½“å‰æ—¶é—´</span><br>                Date current = ObjectUtils.notNull(baseEntity.getCreateTime(), <span class="hljs-keyword">new</span> Date());<br>                baseEntity.setCreateTime(current);<br>                baseEntity.setUpdateTime(current);<br><br>                <span class="hljs-comment">// å¦‚æœåˆ›å»ºäººä¸ºç©ºï¼Œåˆ™å¡«å……å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯</span><br>                <span class="hljs-keyword">if</span> (ObjectUtil.isNull(baseEntity.getCreateBy())) &#123;<br>                    LoginUser loginUser = getLoginUser();<br>                    <span class="hljs-keyword">if</span> (ObjectUtil.isNotNull(loginUser)) &#123;<br>                        Long userId = loginUser.getUserId();<br>                        <span class="hljs-comment">// å¡«å……åˆ›å»ºäººã€æ›´æ–°äººå’Œåˆ›å»ºéƒ¨é—¨ä¿¡æ¯</span><br>                        baseEntity.setCreateBy(userId);<br>                        baseEntity.setUpdateBy(userId);<br>                        baseEntity.setCreateDept(ObjectUtils.notNull(baseEntity.getCreateDept(), loginUser.getDeptId()));<br>                    &#125;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                Date date = <span class="hljs-keyword">new</span> Date();<br>                <span class="hljs-keyword">this</span>.strictInsertFill(metaObject, <span class="hljs-string">&quot;createTime&quot;</span>, Date.class, date);<br>                <span class="hljs-keyword">this</span>.strictInsertFill(metaObject, <span class="hljs-string">&quot;updateTime&quot;</span>, Date.class, date);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ServiceException(<span class="hljs-string">&quot;è‡ªåŠ¨æ³¨å…¥å¼‚å¸¸ =&gt; &quot;</span> + e.getMessage(), HttpStatus.HTTP_UNAUTHORIZED);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ›´æ–°å¡«å……æ–¹æ³•ï¼Œç”¨äºåœ¨æ›´æ–°æ•°æ®æ—¶è‡ªåŠ¨å¡«å……å®ä½“å¯¹è±¡ä¸­çš„æ›´æ–°æ—¶é—´å’Œæ›´æ–°äººä¿¡æ¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> metaObject å…ƒå¯¹è±¡ï¼Œç”¨äºè·å–åŸå§‹å¯¹è±¡å¹¶è¿›è¡Œå¡«å……</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">updateFill</span><span class="hljs-params">(MetaObject metaObject)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">if</span> (ObjectUtil.isNotNull(metaObject) &amp;&amp; metaObject.getOriginalObject() <span class="hljs-keyword">instanceof</span> BaseEntity baseEntity) &#123;<br>                <span class="hljs-comment">// è·å–å½“å‰æ—¶é—´ä½œä¸ºæ›´æ–°æ—¶é—´ï¼Œæ— è®ºåŸå§‹å¯¹è±¡ä¸­çš„æ›´æ–°æ—¶é—´æ˜¯å¦ä¸ºç©ºéƒ½å¡«å……</span><br>                Date current = <span class="hljs-keyword">new</span> Date();<br>                baseEntity.setUpdateTime(current);<br><br>                <span class="hljs-comment">// è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„IDï¼Œå¹¶å¡«å……æ›´æ–°äººä¿¡æ¯</span><br>                Long userId = LoginHelper.getUserId();<br>                <span class="hljs-keyword">if</span> (ObjectUtil.isNotNull(userId)) &#123;<br>                    baseEntity.setUpdateBy(userId);<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">this</span>.strictUpdateFill(metaObject, <span class="hljs-string">&quot;updateTime&quot;</span>, Date.class, <span class="hljs-keyword">new</span> Date());<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ServiceException(<span class="hljs-string">&quot;è‡ªåŠ¨æ³¨å…¥å¼‚å¸¸ =&gt; &quot;</span> + e.getMessage(), HttpStatus.HTTP_UNAUTHORIZED);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>hutoolå¥½ç”¨çš„æ–¹æ³•</title>
    <link href="/hutool%E5%A5%BD%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95/"/>
    <url>/hutool%E5%A5%BD%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="1-åŠ¨æ€è·å–beanå¯¹è±¡"><a href="#1-åŠ¨æ€è·å–beanå¯¹è±¡" class="headerlink" title="1. åŠ¨æ€è·å–beanå¯¹è±¡"></a>1. åŠ¨æ€è·å–beanå¯¹è±¡</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ChatSessionManager chatSessionManager = SpringUtils.getBean(ChatSessionManager.class);<br></code></pre></td></tr></table></figure><h1 id="2-ç”ŸæˆUUID"><a href="#2-ç”ŸæˆUUID" class="headerlink" title="2. ç”ŸæˆUUID"></a>2. ç”ŸæˆUUID</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">String uuid = IdUtil.simpleUUID();<br></code></pre></td></tr></table></figure><h1 id="3-å¸¸é‡"><a href="#3-å¸¸é‡" class="headerlink" title="3. å¸¸é‡"></a>3. å¸¸é‡</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StrUtil</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String SPACE = <span class="hljs-string">&quot; &quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DOT = <span class="hljs-string">&quot;.&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String SLASH = <span class="hljs-string">&quot;/&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String BACKSLASH = <span class="hljs-string">&quot;\\&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String EMPTY = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String NULL = <span class="hljs-string">&quot;null&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String CR = <span class="hljs-string">&quot;\r&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String LF = <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String CRLF = <span class="hljs-string">&quot;\r\n&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String UNDERLINE = <span class="hljs-string">&quot;_&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DASHED = <span class="hljs-string">&quot;-&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String COMMA = <span class="hljs-string">&quot;,&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DELIM_START = <span class="hljs-string">&quot;&#123;&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DELIM_END = <span class="hljs-string">&quot;&#125;&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String BRACKET_START = <span class="hljs-string">&quot;[&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String BRACKET_END = <span class="hljs-string">&quot;]&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String COLON = <span class="hljs-string">&quot;:&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String EMPTY_JSON = <span class="hljs-string">&quot;&#123;&#125;&quot;</span>;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Lombokä¹‹@RequiredArgsConstructor</title>
    <link href="/Lombok%E4%B9%8B-RequiredArgsConstructor/"/>
    <url>/Lombok%E4%B9%8B-RequiredArgsConstructor/</url>
    
    <content type="html"><![CDATA[<h1 id="1-RequiredArgsConstructoræ˜¯ä»€ä¹ˆ"><a href="#1-RequiredArgsConstructoræ˜¯ä»€ä¹ˆ" class="headerlink" title="1. @RequiredArgsConstructoræ˜¯ä»€ä¹ˆ?"></a>1. @RequiredArgsConstructoræ˜¯ä»€ä¹ˆ?</h1><p><code>@RequiredArgsConstructor</code> æ˜¯ Lombok æä¾›çš„ä¸€ä¸ªæ³¨è§£ï¼Œç”¨äºè‡ªåŠ¨ç”Ÿæˆæ„é€ å‡½æ•°ã€‚è¿™ä¸ªæ„é€ å‡½æ•°åªåŒ…å«é‚£äº›è¢«å£°æ˜ä¸º <code>final</code> æˆ–è€…æ ‡æ³¨äº† <code>@NonNull</code> çš„å­—æ®µï¼Œä»è€Œç¡®ä¿è¿™äº›å­—æ®µåœ¨å¯¹è±¡åˆ›å»ºæ—¶å¿…é¡»è¢«åˆå§‹åŒ–ï¼Œä»¥é¿å…æ½œåœ¨çš„ç©ºæŒ‡é’ˆå¼‚å¸¸ç­‰é—®é¢˜ã€‚</p><h1 id="2-é€šè¿‡-RequiredArgsConstructorç®€åŒ–Beanæ³¨å…¥"><a href="#2-é€šè¿‡-RequiredArgsConstructorç®€åŒ–Beanæ³¨å…¥" class="headerlink" title="2. é€šè¿‡@RequiredArgsConstructorç®€åŒ–Beanæ³¨å…¥"></a>2. é€šè¿‡@RequiredArgsConstructorç®€åŒ–Beanæ³¨å…¥</h1><p>é€šè¿‡ç±»çš„æ„é€ å‡½æ•°æ¥æ³¨å…¥ä¾èµ–ã€‚è¿™æ˜¯æœ€æ¨èçš„æ–¹å¼ï¼Œå°¤å…¶æ˜¯åœ¨ä¾èµ–æ˜¯å¼ºåˆ¶æ€§çš„æƒ…å†µä¸‹ã€‚</p><p>Spring ä½¿ç”¨æ„é€ å™¨æ³¨å…¥çš„æ–¹å¼å°† <code>OpenAiStreamClient</code> ç±»å‹çš„ Bean æ³¨å…¥åˆ° <code>SseServiceImpl</code> ä¸­ã€‚å°†å¯ä»¥ç®€åŒ–@Autowired çš„ä¹¦å†™è¿‡ç¨‹ï¼Œ å³ä¸éœ€è¦å†é€šè¿‡@Autowired æˆ–è€…@Resource è¿›è¡ŒBeanæ³¨å…¥</p><p>äºŒã€@RequiredArgsConstructorçš„ä½¿ç”¨æ–¹å¼</p><p>1ã€å¼•å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="2ã€ä»£ç ç¤ºä¾‹"><a href="#2ã€ä»£ç ç¤ºä¾‹" class="headerlink" title="2ã€ä»£ç ç¤ºä¾‹"></a>2ã€ä»£ç ç¤ºä¾‹</h3><h4 id="2-1ã€å¸¸è§„-Autowiredæ³¨å…¥ï¼š"><a href="#2-1ã€å¸¸è§„-Autowiredæ³¨å…¥ï¼š" class="headerlink" title="2.1ã€å¸¸è§„ @Autowiredæ³¨å…¥ï¼š"></a>2.1ã€å¸¸è§„ @Autowiredæ³¨å…¥ï¼š</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserService userService;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/getUser&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">getUser</span><span class="hljs-params">()</span></span>&#123;<br>        User user = userService.getUser(<span class="hljs-string">&quot;1&quot;</span>);<br>        <span class="hljs-keyword">return</span> user;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¸¸è§„æ„é€ å™¨æ³¨å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> UserService userService;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUserService</span><span class="hljs-params">(UserService userService)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.userService = userService;<br>    &#125;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/getUser&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">getUser</span><span class="hljs-params">()</span></span>&#123;<br>        User user = userService.getUser(<span class="hljs-string">&quot;1&quot;</span>);<br>        <span class="hljs-keyword">return</span> user;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-3ã€lombokä¸­çš„RequiredArgsConstructoræ³¨å…¥ï¼š"><a href="#2-3ã€lombokä¸­çš„RequiredArgsConstructoræ³¨å…¥ï¼š" class="headerlink" title="2.3ã€lombokä¸­çš„RequiredArgsConstructoræ³¨å…¥ï¼š"></a>2.3ã€lombokä¸­çš„RequiredArgsConstructoræ³¨å…¥ï¼š</h4><p>å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ <code>@RequiredArgsConstructor</code> çœå»äº† <code>@Autowired</code> æˆ– <code>@Resource</code> æ³¨è§£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/user&quot;)</span><br><span class="hljs-meta">@RequiredArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserService userService;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/getUser&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">getUser</span><span class="hljs-params">()</span></span>&#123;<br>        User user = userService.getUser(<span class="hljs-string">&quot;1&quot;</span>);<br>        <span class="hljs-keyword">return</span> user;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/q2qwert/article/details/140683375">https://blog.csdn.net/q2qwert/article/details/140683375</a></p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>JavaåŸºäºSSEæµå¼è¿”å›</title>
    <link href="/Java%E5%9F%BA%E4%BA%8ESSE%E6%B5%81%E5%BC%8F%E8%BF%94%E5%9B%9E/"/>
    <url>/Java%E5%9F%BA%E4%BA%8ESSE%E6%B5%81%E5%BC%8F%E8%BF%94%E5%9B%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æœåŠ¡å™¨æ¨é€æŠ€æœ¯ä»·å€¼"><a href="#1-æœåŠ¡å™¨æ¨é€æŠ€æœ¯ä»·å€¼" class="headerlink" title="1. æœåŠ¡å™¨æ¨é€æŠ€æœ¯ä»·å€¼"></a>1. æœåŠ¡å™¨æ¨é€æŠ€æœ¯ä»·å€¼</h1><p>ä¼ ç»Ÿâ€æ‹‰å–â€æ¨¡å¼éœ€å®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·è¯·æ±‚è·å–æ›´æ–°ï¼Œè€ŒæœåŠ¡å™¨æ¨é€é‡‡ç”¨â€æ¨é€â€æœºåˆ¶å®ç°å®æ—¶ä¿¡æ¯ä¼ è¾“ã€‚å…¶æ ¸å¿ƒä¼˜åŠ¿ä½“ç°åœ¨ï¼š</p><ol><li>å®æ—¶æ€§æå‡ï¼šç³»ç»Ÿè‡ªåŠ¨æ¨é€æœ€æ–°å†…å®¹ï¼Œå…å»ç”¨æˆ·æ‰‹åŠ¨åˆ·æ–°æ“ä½œ</li><li>èµ„æºä¼˜åŒ–ï¼šä»…åœ¨äº§ç”Ÿæœ‰æ•ˆæ•°æ®æ—¶å»ºç«‹è¿æ¥ï¼Œå‡å°‘æ— æ•ˆè¯·æ±‚</li><li>ç”¨æˆ·ä½“éªŒå‡çº§ï¼šæ¶ˆæ¯å³æ—¶è§¦è¾¾ï¼Œé€‚ç”¨äºå®æ—¶é€šä¿¡åœºæ™¯</li></ol><h1 id="2-æœåŠ¡å™¨æ¨é€ä¸»æµå®ç°æŠ€æœ¯å¯¹æ¯”"><a href="#2-æœåŠ¡å™¨æ¨é€ä¸»æµå®ç°æŠ€æœ¯å¯¹æ¯”" class="headerlink" title="2. æœåŠ¡å™¨æ¨é€ä¸»æµå®ç°æŠ€æœ¯å¯¹æ¯”"></a>2. æœåŠ¡å™¨æ¨é€ä¸»æµå®ç°æŠ€æœ¯å¯¹æ¯”</h1><h2 id="2-1-é•¿è½®è¯¢ï¼ˆLong-Pollingï¼‰"><a href="#2-1-é•¿è½®è¯¢ï¼ˆLong-Pollingï¼‰" class="headerlink" title="2.1. é•¿è½®è¯¢ï¼ˆLong Pollingï¼‰"></a>2.1. é•¿è½®è¯¢ï¼ˆLong Pollingï¼‰</h2><ul><li>å®¢æˆ·ç«¯ç»´æŒé•¿è¿æ¥ç­‰å¾…æœåŠ¡å™¨å“åº”</li><li>å…¼å®¹æ€§ä¼˜ç§€ä½†èµ„æºæ¶ˆè€—è¾ƒé«˜</li></ul><h2 id="2-2-æœåŠ¡å™¨å‘é€äº‹ä»¶ï¼ˆSSEï¼‰"><a href="#2-2-æœåŠ¡å™¨å‘é€äº‹ä»¶ï¼ˆSSEï¼‰" class="headerlink" title="2.2. æœåŠ¡å™¨å‘é€äº‹ä»¶ï¼ˆSSEï¼‰"></a>2.2. æœåŠ¡å™¨å‘é€äº‹ä»¶ï¼ˆSSEï¼‰</h2><ul><li>åŸºäºHTTPåè®®</li><li>å•å‘é€šä¿¡</li><li>é€‚åˆåªéœ€è¦æœåŠ¡å™¨å‘å®¢æˆ·ç«¯æ¨é€å®æ—¶æ›´æ–°æ•°æ®çš„åœºæ™¯ï¼Œå¦‚å®æ—¶æ–°é—»æ›´æ–°ã€è‚¡ç¥¨è¡Œæƒ…æ¨é€ç­‰</li></ul><h2 id="2-3-WebSocket"><a href="#2-3-WebSocket" class="headerlink" title="2.3. WebSocket"></a>2.3. WebSocket</h2><ul><li><p>å…¨åŒå·¥TCPé€šä¿¡åè®®</p></li><li><p>åŒå‘é€šä¿¡</p></li><li><p>é€‚åˆéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œå®æ—¶åŒå‘é€šä¿¡çš„åœºæ™¯ï¼Œå¦‚èŠå¤©å®¤ã€åœ¨çº¿æ¸¸æˆç­‰</p></li></ul><h1 id="3-Java-åŸºäºokhttpè¯·æ±‚SSEæ¥å£æµå¼è¿”å›"><a href="#3-Java-åŸºäºokhttpè¯·æ±‚SSEæ¥å£æµå¼è¿”å›" class="headerlink" title="3. Java åŸºäºokhttpè¯·æ±‚SSEæ¥å£æµå¼è¿”å›"></a>3. Java åŸºäºokhttpè¯·æ±‚SSEæ¥å£æµå¼è¿”å›</h1><h2 id="3-1-æ•´ä½“ç»“æ„ç®€è¿°"><a href="#3-1-æ•´ä½“ç»“æ„ç®€è¿°" class="headerlink" title="3.1. æ•´ä½“ç»“æ„ç®€è¿°"></a>3.1. æ•´ä½“ç»“æ„ç®€è¿°</h2><p>æ•´ä¸ªæµç¨‹ç†è§£ä¸º <strong>ä¸¤ä¸ª SSE è¿æ¥çš„â€œæ¥åŠ›â€ä¼ è¾“</strong>ï¼š</p><h3 id="3-1-1-ç¬¬ä¸€ä¸ª-SSE-è¿æ¥ï¼š"><a href="#3-1-1-ç¬¬ä¸€ä¸ª-SSE-è¿æ¥ï¼š" class="headerlink" title="3.1.1. ç¬¬ä¸€ä¸ª SSE è¿æ¥ï¼š"></a>3.1.1. ç¬¬ä¸€ä¸ª SSE è¿æ¥ï¼š</h3><p><strong>å‰ç«¯å‘èµ·ï¼Œ åç«¯ç»™å‰ç«¯æ¨æ•°æ®</strong></p><ul><li>ä½¿ç”¨ <code>SseEmitter</code> å®ç°ã€‚</li><li>å‰ç«¯é€šè¿‡ <code>EventSource</code> å‘èµ·è¯·æ±‚ã€‚</li><li>åç«¯æ¥æ”¶è¯·æ±‚å¹¶åˆ›å»º <code>SseEmitter</code>ï¼Œç”¨äºå‘å‰ç«¯æ¨é€æ•°æ®ã€‚</li><li>è¿™ä¸ªè¿æ¥æ˜¯ä½ ä¸»åŠ¨æ§åˆ¶çš„ï¼Œç”¨æ¥ä¸ç”¨æˆ·é€šä¿¡ã€‚</li></ul><h3 id="3-1-2-ç¬¬äºŒä¸ª-SSE-è¿æ¥ï¼š"><a href="#3-1-2-ç¬¬äºŒä¸ª-SSE-è¿æ¥ï¼š" class="headerlink" title="3.1.2. ç¬¬äºŒä¸ª SSE è¿æ¥ï¼š"></a>3.1.2. ç¬¬äºŒä¸ª SSE è¿æ¥ï¼š</h3><p><strong>åç«¯å‘èµ·ï¼ŒAI æ¥å£ç»™åç«¯æ¨æ•°æ®</strong></p><ul><li>ä½¿ç”¨ OkHttp çš„ <code>EventSource.Factory</code> åˆ›å»ºã€‚</li><li>åç«¯å‘ AI æ¨¡å‹æœåŠ¡å‘èµ·æµå¼è¯·æ±‚ã€‚</li><li>æ¥æ”¶æ¨¡å‹è¿”å›çš„é€å­—è¾“å‡ºï¼ˆå¦‚ AI æµå¼å›ç­”ï¼‰ã€‚</li><li>è¿™ä¸ªè¿æ¥æ˜¯ä»£ç†æ€§è´¨çš„ï¼Œç”¨æ¥è·å–è¿œç¨‹ AI æ•°æ®ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">[å‰ç«¯] <br>   â†“ (å‘èµ·è¯·æ±‚)<br>[åç«¯ Controller]<br>   â†“ (æ„é€ è¯·æ±‚ä½“ + åˆ›å»º emitter)<br>[SSEEventSourceListener(listener)]<br>   â†“ (é€šè¿‡ OkHttp EventSource å‘èµ· SSE è¯·æ±‚)<br>[è°ƒç”¨è¿œç¨‹ AI æ¥å£ï¼ˆå¦‚ OpenAI / Ollamaï¼‰]<br>   â†“ (æµå¼è¿”å›æ•°æ®)<br>[onEvent() æ–¹æ³•å¤„ç†æ•°æ®]<br>   â†“<br>[é€šè¿‡ emitter.send(data) æŠŠæ•°æ®æ¨ç»™å‰ç«¯]<br></code></pre></td></tr></table></figure><h2 id="3-2-æ ¸å¿ƒä»£ç "><a href="#3-2-æ ¸å¿ƒä»£ç " class="headerlink" title="3.2. æ ¸å¿ƒä»£ç "></a>3.2. æ ¸å¿ƒä»£ç </h2><ol><li>æˆ‘ä»¬å¯ä»¥å€ŸåŠ©okhttpæ¥å®ç°ï¼Œé¦–å…ˆå¼•å…¥okhttp-sseçš„ä¾èµ–ï¼š</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.squareup.okhttp3<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>okhttp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.10.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.squareup.okhttp3<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>okhttp-sse<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.10.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><ol><li>æ ¸å¿ƒä»£ç </li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs java">OkHttpClient okHttpClient = <span class="hljs-keyword">new</span> OkHttpClient<br>            .Builder()<br>            .addInterceptor(<span class="hljs-keyword">this</span>.authInterceptor)<br>            .connectTimeout(<span class="hljs-number">10</span>, TimeUnit.SECONDS)<br>            .writeTimeout(<span class="hljs-number">50</span>, TimeUnit.SECONDS)<br>            .readTimeout(<span class="hljs-number">50</span>, TimeUnit.SECONDS)<br>            .build();<br><br> SSEEventSourceListener listener = <span class="hljs-keyword">new</span> SSEEventSourceListener(emitter,chatRequest.getUserId(),chatRequest.getSessionId());<br><br><span class="hljs-comment">// åˆ›å»ºäº‹ä»¶, ä½¿ç”¨äº†OkHttpçš„EventSourceï¼ˆServer-Sent Eventsï¼Œç®€ç§°SSEï¼‰æœºåˆ¶æ¥å‘é€ä¸€ä¸ª POST è¯·æ±‚</span><br>EventSource.Factory factory = EventSources.createFactory(okHttpClient);<br>            ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();<br>            String requestBody = mapper.writeValueAsString(chatCompletion);<br>            Request request = <span class="hljs-keyword">new</span> Request.Builder()<br>                .url(<span class="hljs-keyword">this</span>.apiHost)<br>                .post(RequestBody.create(MediaType.parse(ContentType.JSON.getValue()), requestBody))<br>                .build();<br>            factory.newEventSource(request, listener);<br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@RequiredArgsConstructor</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SSEEventSourceListener</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EventSourceListener</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> SseEmitter emitter;<br><br>   <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onOpen</span><span class="hljs-params">(EventSource eventSource, Response response)</span> </span>&#123;<br>        log.info(<span class="hljs-string">&quot;OpenAIå»ºç«‹sseè¿æ¥...&quot;</span>);<br>    &#125;<br><br>  <br>    <span class="hljs-meta">@SneakyThrows</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onEvent</span><span class="hljs-params">(<span class="hljs-meta">@NotNull</span> EventSource eventSource, String id, String type, String data)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;[DONE]&quot;</span>.equals(data)) &#123;<br>                <span class="hljs-comment">//æˆåŠŸå“åº”</span><br>                emitter.complete();<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();<br>            ChatCompletionResponse completionResponse = mapper.readValue(data, ChatCompletionResponse.class);<br>            <span class="hljs-keyword">if</span>(completionResponse == <span class="hljs-keyword">null</span> || CollectionUtil.isEmpty(completionResponse.getChoices()))&#123;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            Object content = completionResponse.getChoices().get(<span class="hljs-number">0</span>).getDelta().getContent();<br><br>            <span class="hljs-keyword">if</span>(content != <span class="hljs-keyword">null</span> )&#123;<br>                <span class="hljs-comment">// ç»™å‰ç«¯å‘é€è¯·æ±‚åˆ°çš„æ•°æ®</span><br>                emitter.send(data);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            log.error(e.getMessage(), e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClosed</span><span class="hljs-params">(EventSource eventSource)</span> </span>&#123;<br>        log.info(<span class="hljs-string">&quot;OpenAIå…³é—­sseè¿æ¥...&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@SneakyThrows</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(EventSource eventSource, Throwable t, Response response)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (Objects.isNull(response)) &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        ResponseBody body = response.body();<br>        <span class="hljs-keyword">if</span> (Objects.nonNull(body)) &#123;<br>            log.error(<span class="hljs-string">&quot;OpenAI  sseè¿æ¥å¼‚å¸¸dataï¼š&#123;&#125;ï¼Œå¼‚å¸¸ï¼š&#123;&#125;&quot;</span>, body.string(), t);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            log.error(<span class="hljs-string">&quot;OpenAI  sseè¿æ¥å¼‚å¸¸dataï¼š&#123;&#125;ï¼Œå¼‚å¸¸ï¼š&#123;&#125;&quot;</span>, response, t);<br>        &#125;<br>        eventSource.cancel();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="4-å½“å‰ç«¯å–æ¶ˆè¯·æ±‚æ—¶ï¼Œé€šçŸ¥åç«¯ä¹Ÿç«‹å³ä¸­æ–­-AI-çš„å¤„ç†æµç¨‹"><a href="#4-å½“å‰ç«¯å–æ¶ˆè¯·æ±‚æ—¶ï¼Œé€šçŸ¥åç«¯ä¹Ÿç«‹å³ä¸­æ–­-AI-çš„å¤„ç†æµç¨‹" class="headerlink" title="4. å½“å‰ç«¯å–æ¶ˆè¯·æ±‚æ—¶ï¼Œé€šçŸ¥åç«¯ä¹Ÿç«‹å³ä¸­æ–­ AI çš„å¤„ç†æµç¨‹"></a>4. <strong>å½“å‰ç«¯å–æ¶ˆè¯·æ±‚æ—¶ï¼Œé€šçŸ¥åç«¯ä¹Ÿç«‹å³ä¸­æ–­ AI çš„å¤„ç†æµç¨‹</strong></h1><h2 id="4-1-æµç¨‹"><a href="#4-1-æµç¨‹" class="headerlink" title="4.1. æµç¨‹"></a>4.1. æµç¨‹</h2><p>å‰ç«¯å–æ¶ˆè¯·æ±‚æ—¶ï¼Œé€šçŸ¥åç«¯å–æ¶ˆå¯¹åº”çš„ AI è¯·æ±‚</p><ul><li>å‰ç«¯ä½¿ç”¨ <code>useFetchHook</code>ï¼ˆå‡è®¾æ˜¯åŸºäº <code>fetch</code> æˆ– <code>axios</code>ï¼‰æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>AbortController</code> æ¥ä¸­æ–­è¯·æ±‚ã€‚</li><li>å‰ç«¯ä¸­æ–­è¯·æ±‚åï¼Œä¸»åŠ¨å‘é€ä¸€ä¸ªå–æ¶ˆè¯·æ±‚åˆ°åç«¯ï¼Œå‘Šè¯‰åç«¯â€œæˆ‘ä¸è¦è¿™ä¸ªè¯·æ±‚äº†ï¼Œè¯·å–æ¶ˆ AI æ¨ç†â€ã€‚</li></ul><h2 id="4-2-å‰ç«¯å®ç°ï¼ˆVue-useFetchHookï¼‰"><a href="#4-2-å‰ç«¯å®ç°ï¼ˆVue-useFetchHookï¼‰" class="headerlink" title="4.2. å‰ç«¯å®ç°ï¼ˆVue + useFetchHookï¼‰"></a>4.2. å‰ç«¯å®ç°ï¼ˆVue + useFetchHookï¼‰</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> &#123; useFetch &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vueuse/core&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> AbortController()<br>    <span class="hljs-keyword">const</span> signal = controller.signal<br><br>    <span class="hljs-keyword">const</span> &#123; data, error, isFetching &#125; = useFetch(<span class="hljs-string">&#x27;https://your-api.com/chat&#x27;</span>, &#123;<br>      <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-attr">headers</span>: &#123;<br>        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span><br>      &#125;,<br>      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(&#123; <span class="hljs-attr">prompt</span>: <span class="hljs-string">&#x27;Tell me a joke&#x27;</span> &#125;),<br>      signal<br>    &#125;).json()<br><br>    <span class="hljs-keyword">const</span> cancelRequest = <span class="hljs-function">() =&gt;</span> &#123;<br>      controller.abort() <span class="hljs-comment">// ä¸­æ–­å½“å‰è¯·æ±‚</span><br><br>      <span class="hljs-comment">// å¯é€‰ï¼šå‘é€ä¸€ä¸ªå–æ¶ˆè¯·æ±‚ç»™åç«¯ï¼Œé€šçŸ¥å®ƒåœæ­¢å¤„ç†</span><br>      fetch(<span class="hljs-string">&#x27;https://your-api.com/chat/cancel&#x27;</span>, &#123;<br>        <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>        <span class="hljs-attr">headers</span>: &#123;<br>          <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(&#123;<br>          <span class="hljs-attr">userId</span>: <span class="hljs-string">&#x27;user123&#x27;</span>,<br>          <span class="hljs-attr">sessionId</span>: <span class="hljs-string">&#x27;session456&#x27;</span><br>        &#125;)<br>      &#125;)<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> &#123;<br>      data,<br>      error,<br>      isFetching,<br>      cancelRequest<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4-3-åç«¯å®ç°"><a href="#4-3-åç«¯å®ç°" class="headerlink" title="4.3. åç«¯å®ç°"></a>4.3. åç«¯å®ç°</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/chat&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ChatController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> ChatSessionManager chatSessionManager;<br>  <br>    <span class="hljs-meta">@PostMapping(&quot;/chat&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">chat</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> ChatRequest chatRequest, HttpServletRequest request)</span> </span>&#123;<br>    String sessionId = chatRequest.getSessionId();<br>    String userId = chatRequest.getUserId();<br><br>    <span class="hljs-comment">// æ„é€ è¯·æ±‚ä½“</span><br>    ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();<br>    String requestBody = mapper.writeValueAsString(chatCompletion);<br><br>    Request request = <span class="hljs-keyword">new</span> Request.Builder()<br>    .url(<span class="hljs-keyword">this</span>.apiHost)<br>    .post(RequestBody.create(MediaType.parse(<span class="hljs-string">&quot;application/json&quot;</span>), requestBody))<br>    .build();<br><br>    SSEEventSourceListener listener = <span class="hljs-keyword">new</span> SSEEventSourceListener(emitter, userId, sessionId);<br>    EventSource eventSource = EventSources.createFactory(okHttpClient).newEventSource(request, listener);<br><br>    <span class="hljs-comment">// ä¿å­˜ eventSource åˆ° session manager</span><br>    chatSessionManager.addSession(sessionId, eventSource);<br>    &#125;<br><br>    <span class="hljs-meta">@PostMapping(&quot;/cancel&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ResponseEntity&lt;String&gt; <span class="hljs-title">cancelChat</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Map&lt;String, String&gt; payload)</span> </span>&#123;<br>        String sessionId = payload.get(<span class="hljs-string">&quot;sessionId&quot;</span>);<br>        chatSessionManager.cancelSession(sessionId);<br>        <span class="hljs-keyword">return</span> ResponseEntity.ok(<span class="hljs-string">&quot;Chat request canceled.&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ChatSessionManager</span> </span>&#123;<br><br>    <span class="hljs-comment">// session ID -&gt; EventSource</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, EventSource&gt; sessions = <span class="hljs-keyword">new</span> ConcurrentHashMap&lt;&gt;();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addSession</span><span class="hljs-params">(String sessionId, EventSource eventSource)</span> </span>&#123;<br>        sessions.put(sessionId, eventSource);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">removeSession</span><span class="hljs-params">(String sessionId)</span> </span>&#123;<br>        sessions.remove(sessionId);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cancelSession</span><span class="hljs-params">(String sessionId)</span> </span>&#123;<br>        EventSource eventSource = sessions.get(sessionId);<br>        <span class="hljs-keyword">if</span> (eventSource != <span class="hljs-keyword">null</span>) &#123;<br>            eventSource.cancel(); <span class="hljs-comment">// å–æ¶ˆ SSE è¯·æ±‚</span><br>            sessions.remove(sessionId);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼šå¦‚æœä½¿ç”¨ <strong>Redis</strong>ï¼Œå¯ä»¥å°† session ä¿¡æ¯å­˜å…¥ Redisï¼Œå®ç°åˆ†å¸ƒå¼å–æ¶ˆã€‚</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>gitignoreæ–‡ä»¶æ·»åŠ </title>
    <link href="/gitignore%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0/"/>
    <url>/gitignore%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="1-åˆ é™¤ç¼“å­˜"><a href="#1-åˆ é™¤ç¼“å­˜" class="headerlink" title="1. åˆ é™¤ç¼“å­˜"></a>1. åˆ é™¤ç¼“å­˜</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git rm -r --cached .idea/<br></code></pre></td></tr></table></figure><h2 id="2-gitignore-æ–‡ä»¶ç¤ºä¾‹"><a href="#2-gitignore-æ–‡ä»¶ç¤ºä¾‹" class="headerlink" title="2. gitignore æ–‡ä»¶ç¤ºä¾‹"></a>2. gitignore æ–‡ä»¶ç¤ºä¾‹</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-comment"># ç¼–è¯‘äº§ç”Ÿçš„æ–‡ä»¶</span><br><span class="hljs-string">/target/</span><br><span class="hljs-string">/bin/</span><br><br><span class="hljs-comment"># IntelliJ IDEA IDE é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨ï¼‰</span><br><span class="hljs-string">/.idea/</span><br><span class="hljs-string">/*.iml</span><br><br><span class="hljs-comment"># Eclipse IDE é…è¯‘æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨ï¼‰</span><br><span class="hljs-string">/.settings/</span><br><span class="hljs-string">/.classpath</span><br><span class="hljs-string">/.project</span><br><br><span class="hljs-comment"># NetBeans IDE é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœä½¿ç”¨ï¼‰</span><br><span class="hljs-string">/nbproject/private/</span><br><span class="hljs-string">/nbbuild/</span><br><span class="hljs-string">/dist/</span><br><span class="hljs-string">/build/</span><br><br><span class="hljs-comment"># Maven é…ç½®æ–‡ä»¶</span><br><span class="hljs-string">/target/</span><br><br><span class="hljs-comment"># Gradle æ„å»ºå·¥å…·é…ç½®æ–‡ä»¶</span><br><span class="hljs-string">.gradle/</span><br><span class="hljs-string">build/</span><br><br><span class="hljs-comment"># macOS ç³»ç»Ÿæ–‡ä»¶</span><br><span class="hljs-string">.DS_Store</span><br><br><span class="hljs-comment"># Windows ç³»ç»Ÿæ–‡ä»¶</span><br><span class="hljs-string">Thumbs.db</span><br><br><span class="hljs-comment"># Linux ä¸‹çš„ä¸´æ—¶æ–‡ä»¶</span><br><span class="hljs-string">*~</span><br><br><span class="hljs-comment"># æ—¥å¿—æ–‡ä»¶</span><br><span class="hljs-string">*.log</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>oracleæ•°æ®è¿ç§»</title>
    <link href="/oracle%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB/"/>
    <url>/oracle%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB/</url>
    
    <content type="html"><![CDATA[<h1 id="1-oracleæ•°æ®åº“è¿ç§»"><a href="#1-oracleæ•°æ®åº“è¿ç§»" class="headerlink" title="1. oracleæ•°æ®åº“è¿ç§»"></a>1. oracleæ•°æ®åº“è¿ç§»</h1><h2 id="1-å¯¼å‡ºdmpæ–‡ä»¶"><a href="#1-å¯¼å‡ºdmpæ–‡ä»¶" class="headerlink" title="1. å¯¼å‡ºdmpæ–‡ä»¶"></a>1. å¯¼å‡ºdmpæ–‡ä»¶</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">expdp mycim3_qj_new/mycim3_qj_new@//10.108.140.102:1521/ORCL schemas=MYCIM3_QJ_NEW directory=DATA_PUMP_DIR dumpfile=export.dmp logfile=export.log<br></code></pre></td></tr></table></figure><p>æ³¨ï¼šå¯¼å‡ºç»“æŸä»¥åä¼šæ˜¾ç¤ºè¿™ä¸ªæ–‡ä»¶åœ¨å“ªä¸ªè·¯å¾„ä¸‹é¢ï¼Œæ³¨æ„çœ‹æœ€åå‡ è¡Œ</p><h2 id="2-åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸Šä¼ dmpæ–‡ä»¶"><a href="#2-åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸Šä¼ dmpæ–‡ä»¶" class="headerlink" title="2. åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸Šä¼ dmpæ–‡ä»¶"></a>2. åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸Šä¼ dmpæ–‡ä»¶</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir -p /home/oracle/import<br></code></pre></td></tr></table></figure><h2 id="3-æ‰§è¡Œå¯¼å…¥"><a href="#3-æ‰§è¡Œå¯¼å…¥" class="headerlink" title="3. æ‰§è¡Œå¯¼å…¥"></a>3. æ‰§è¡Œå¯¼å…¥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sqlplus sys/WElcome_123_@//172.28.46.12:1521/mestest as sysdba<br></code></pre></td></tr></table></figure><ol><li>åˆ›å»ºæ–°ç”¨æˆ·ï¼Œå¹¶å°†æ–‡ä»¶å¤¹æƒé™èµ‹ç»™ä»–</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">CREATE USER mycim3_qj_new IDENTIFIED BY &quot;mycim3_qj_new&quot;;<br>GRANT CREATE SESSION TO mycim3_qj_new;<br>GRANT DATAPUMP_IMP_FULL_DATABASE TO mycim3_qj_new;<br>ALTER USER MYCIM3_QJ_NEW QUOTA UNLIMITED ON users; <br><br>CREATE DIRECTORY import_dir AS &#x27;/home/oracle/import&#x27;;<br>GRANT READ, WRITE ON DIRECTORY import_dir TO mycim3_qj_new;<br></code></pre></td></tr></table></figure><ol start="2"><li>åˆ›å»ºTABLESPACE</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">CREATE TABLESPACE TBS_MYCIM<br>DATAFILE &#x27;/u01/app/oracle/oradata/MESTEST/tbs_mycim_01.dbf&#x27;<br>SIZE 1024M<br>AUTOEXTEND ON NEXT 10M MAXSIZE UNLIMITED;<br><br>CREATE TABLESPACE TBS_MYCIM_PARTTABLE<br>DATAFILE &#x27;/u01/app/oracle/oradata/MESTEST/tbs_mycim_parttable_01.dbf&#x27;<br>SIZE 1024M<br>AUTOEXTEND ON NEXT 10M MAXSIZE UNLIMITED;<br>  <br></code></pre></td></tr></table></figure><ol start="3"><li>æ‰§è¡Œå¯¼å…¥</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">impdp mycim3_qj_new/mycim3_qj_new@//172.28.49.12:1521/mestest schemas=MYCIM3_QJ_NEW directory=import_dir dumpfile=2025.4.28EXPORT.DMP logfile=import.log<br></code></pre></td></tr></table></figure><h1 id="2-ä¸ºä»€ä¹ˆ-Oracle-ä¸ç›´æ¥æ”¯æŒå¯¼å‡ºä¸º-SQLï¼Ÿ"><a href="#2-ä¸ºä»€ä¹ˆ-Oracle-ä¸ç›´æ¥æ”¯æŒå¯¼å‡ºä¸º-SQLï¼Ÿ" class="headerlink" title="2.  ä¸ºä»€ä¹ˆ Oracle ä¸ç›´æ¥æ”¯æŒå¯¼å‡ºä¸º SQLï¼Ÿ"></a>2.  ä¸ºä»€ä¹ˆ Oracle ä¸ç›´æ¥æ”¯æŒå¯¼å‡ºä¸º SQLï¼Ÿ</h1><ol><li><strong>æ•ˆç‡é—®é¢˜</strong>ï¼šç”ŸæˆåŒ…å«æ‰€æœ‰æ•°æ®çš„SQLè¯­å¥æ–‡ä»¶ä¼šéå¸¸åºå¤§ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œè¿™æ ·çš„æ–‡ä»¶ä¸ä»…å ç”¨æ›´å¤šå­˜å‚¨ç©ºé—´ï¼Œè€Œä¸”åœ¨ä¼ è¾“å’ŒåŠ è½½è¿‡ç¨‹ä¸­ä¹Ÿä¼šæ¶ˆè€—æ›´å¤šæ—¶é—´ã€‚</li><li><strong>å¤æ‚æ€§ç®¡ç†</strong>ï¼šOracle æ”¯æŒçš„æ•°æ®ç±»å‹è¿œæ¯” MySQL å¤æ‚ï¼Œä¾‹å¦‚ BFILE, XMLType ç­‰ç‰¹æ®Šç±»å‹ï¼Œç›´æ¥è½¬æ¢ä¸º SQL è¯­å¥å¯èƒ½ä¼šé‡åˆ°è¯¸å¤šæŒ‘æˆ˜ã€‚</li><li><strong>äº‹åŠ¡æ”¯æŒ</strong>ï¼šOracle å¼ºè°ƒäº‹åŠ¡çš„ä¸€è‡´æ€§å’Œéš”ç¦»çº§åˆ«ï¼Œåœ¨å¯¼å‡ºè¿‡ç¨‹ä¸­ä¿è¯æ•°æ®ä¸€è‡´æ€§å¯¹äºä¼ä¸šçº§åº”ç”¨è‡³å…³é‡è¦ï¼Œè€ŒäºŒè¿›åˆ¶æ ¼å¼åœ¨è¿™æ–¹é¢æä¾›äº†æ›´å¥½çš„ä¿éšœã€‚</li><li><strong>é«˜çº§ç‰¹æ€§</strong>ï¼šåƒåˆ†åŒºè¡¨ã€å¤–éƒ¨è¡¨ç­‰é«˜çº§ç‰¹æ€§åœ¨è½¬æ¢ä¸º SQL æ—¶å¯èƒ½æ— æ³•å®Œå…¨ä¿ç•™å…¶åŸå§‹å±æ€§ï¼Œè€ŒäºŒè¿›åˆ¶æ ¼å¼åˆ™èƒ½æ›´å¥½åœ°æ”¯æŒè¿™äº›ç‰¹æ€§ã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Kuberneteséƒ¨ç½²å¾®æœåŠ¡åº”ç”¨</title>
    <link href="/Kubernetes%E9%83%A8%E7%BD%B2%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BA%94%E7%94%A8/"/>
    <url>/Kubernetes%E9%83%A8%E7%BD%B2%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BA%94%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-K8séƒ¨ç½²Javaé¡¹ç›®çš„æ­¥éª¤"><a href="#1-K8séƒ¨ç½²Javaé¡¹ç›®çš„æ­¥éª¤" class="headerlink" title="1.  K8séƒ¨ç½²Javaé¡¹ç›®çš„æ­¥éª¤"></a>1.  K8séƒ¨ç½²Javaé¡¹ç›®çš„æ­¥éª¤</h1><h2 id="1-æ„å»ºé•œåƒ"><a href="#1-æ„å»ºé•œåƒ" class="headerlink" title="1. æ„å»ºé•œåƒ"></a>1. æ„å»ºé•œåƒ</h2><h3 id="1-å¢åŠ Dockerfile"><a href="#1-å¢åŠ Dockerfile" class="headerlink" title="1. å¢åŠ Dockerfile"></a>1. å¢åŠ Dockerfile</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-comment"># ä½¿ç”¨å®˜æ–¹çš„ OpenJDK é•œåƒä½œä¸ºåŸºç¡€é•œåƒ</span><br><span class="hljs-string">FROM</span> <span class="hljs-string">docker.xuanyuan.me/openjdk:8-jdk-alpine</span><br><br><span class="hljs-comment"># è®¾ç½®å·¥ä½œç›®å½•</span><br><span class="hljs-string">WORKDIR</span> <span class="hljs-string">/app</span><br><br><span class="hljs-comment"># å¤åˆ¶æœ¬åœ°çš„ JAR åŒ…åˆ°å®¹å™¨ä¸­</span><br><span class="hljs-string">COPY</span> <span class="hljs-string">./build/libs/micro-weather-weather-eureka-server.jar</span> <span class="hljs-string">eureka-server.jar</span><br><br><span class="hljs-string">EXPOSE</span> <span class="hljs-number">8761</span><br><br><span class="hljs-comment"># å¯åŠ¨åº”ç”¨</span><br><span class="hljs-string">ENTRYPOINT</span> [<span class="hljs-string">&quot;java&quot;</span>, <span class="hljs-string">&quot;-jar&quot;</span>, <span class="hljs-string">&quot;eureka-server.jar&quot;</span>]<br></code></pre></td></tr></table></figure><h3 id="2-æ„å»ºé•œåƒ"><a href="#2-æ„å»ºé•œåƒ" class="headerlink" title="2. æ„å»ºé•œåƒ"></a>2. æ„å»ºé•œåƒ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> æˆ–è€…ä½¿ç”¨ <span class="hljs-built_in">echo</span> $(<span class="hljs-built_in">pwd</span>)</span><br>echo &quot;å½“å‰å·¥ä½œç›®å½•æ˜¯: $(pwd)&quot;<br><br>docker build  -t eureka-server:02 .<br><br>docker images<br></code></pre></td></tr></table></figure><h2 id="2-åˆ›å»ºDeployment"><a href="#2-åˆ›å»ºDeployment" class="headerlink" title="2. åˆ›å»ºDeployment"></a>2. <strong>åˆ›å»ºDeployment</strong></h2><h3 id="1-å¢åŠ é…ç½®æ–‡ä»¶"><a href="#1-å¢åŠ é…ç½®æ–‡ä»¶" class="headerlink" title="1. å¢åŠ é…ç½®æ–‡ä»¶"></a>1. å¢åŠ é…ç½®æ–‡ä»¶</h3><p>eureka-app-deployment.yaml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>                 <span class="hljs-comment"># ä½¿ç”¨çš„APIç‰ˆæœ¬ï¼Œapps/v1é€‚ç”¨äºDeploymentç­‰èµ„æº</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>                    <span class="hljs-comment"># èµ„æºç±»å‹ä¸ºDeploymentï¼Œç”¨äºç®¡ç†Podå‰¯æœ¬</span><br><span class="hljs-attr">metadata:</span>                           <span class="hljs-comment"># å…ƒæ•°æ®éƒ¨åˆ†ï¼ŒåŒ…æ‹¬åç§°ã€æ ‡ç­¾ç­‰</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">eureka-app-deployment</span>       <span class="hljs-comment"># Deploymentçš„åç§°</span><br>  <span class="hljs-attr">labels:</span>                           <span class="hljs-comment"># ä¸ºè¯¥Deploymentæ‰“æ ‡ç­¾</span><br>    <span class="hljs-attr">app:</span> <span class="hljs-string">eureka-app</span>                 <span class="hljs-comment"># æ ‡ç­¾é”®ä¸ºappï¼Œå€¼ä¸ºeureka-app</span><br><span class="hljs-attr">spec:</span>                               <span class="hljs-comment"># specï¼šå®šä¹‰ Deployment çš„è¡Œä¸ºï¼šå¦‚å‰¯æœ¬æ•°ã€é€‰æ‹©å™¨ã€Pod æ¨¡æ¿ç­‰</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>                       <span class="hljs-comment"># æŒ‡å®šè¿è¡Œ1ä¸ªPodå‰¯æœ¬</span><br>  <span class="hljs-attr">selector:</span>                         <span class="hljs-comment"># å®šä¹‰å¦‚ä½•é€‰æ‹©è¦ç®¡ç†çš„Pod</span><br>    <span class="hljs-attr">matchLabels:</span>                    <span class="hljs-comment"># åŒ¹é…å…·æœ‰ä»¥ä¸‹æ ‡ç­¾çš„Podï¼Œå‘Šè¯‰Kubernetesï¼Œâ€œæˆ‘æƒ³è¦ç®¡ç†é‚£äº›å…·æœ‰è¿™äº›æ ‡ç­¾çš„æ‰€æœ‰Podâ€</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">eureka-app</span>               <span class="hljs-comment"># åŒ¹é…æ ‡ç­¾app=eureka-appçš„Pod</span><br>  <span class="hljs-attr">template:</span>                         <span class="hljs-comment"># Podæ¨¡æ¿ï¼Œç”¨äºç”Ÿæˆå®é™…è¿è¡Œçš„Pod</span><br>    <span class="hljs-attr">metadata:</span>                       <span class="hljs-comment"># Podçš„å…ƒæ•°æ®</span><br>      <span class="hljs-attr">labels:</span>                       <span class="hljs-comment"># Podçš„æ ‡ç­¾</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">eureka-app</span>             <span class="hljs-comment"># åœ¨Podæ¨¡æ¿éƒ¨åˆ†å®šä¹‰ï¼Œç”¨æ¥ä¸ºæ–°åˆ›å»ºçš„PodæŒ‡å®šæ ‡ç­¾ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªDeploymentæ—¶ï¼Œå®ƒä¼šæ ¹æ®è¿™ä¸ªæ¨¡æ¿åˆ›å»ºPodï¼Œå¹¶ç»™è¿™äº›Podæ‰“ä¸Šç›¸åº”çš„æ ‡ç­¾</span><br>    <span class="hljs-attr">spec:</span>                           <span class="hljs-comment"># spec.template.specï¼šæè¿° Pod åº”è¯¥å¦‚ä½•åˆ›å»ºï¼ˆå³ Pod çš„è§„æ ¼ï¼‰</span><br>      <span class="hljs-attr">containers:</span>                   <span class="hljs-comment"># å®¹å™¨åˆ—è¡¨ï¼Œæè¿°Podä¸­å®¹å™¨ç»„ä¸­çš„æ¯ä¸ªå®¹å™¨åº”è¯¥å¦‚ä½•è¿è¡Œ</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">eureka-app</span>          <span class="hljs-comment"># å®¹å™¨åç§°</span><br>          <span class="hljs-attr">image:</span> <span class="hljs-string">eureka-server:02</span>  <span class="hljs-comment"># ä½¿ç”¨çš„é•œåƒåœ°å€</span><br>          <span class="hljs-attr">ports:</span>                    <span class="hljs-comment"># å®¹å™¨æš´éœ²çš„ç«¯å£åˆ—è¡¨</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">8761</span>   <span class="hljs-comment"># å®¹å™¨ç›‘å¬çš„ç«¯å£å·ä¸º8761</span><br></code></pre></td></tr></table></figure><blockquote><p>app: eureka-app åœ¨ä¸¤ä¸ªåœ°æ–¹å‡ºç°æ˜¯ä¸ºäº†æ»¡è¶³ä¸åŒçš„ç›®çš„</p><ul><li>ç¬¬ä¸€ä¸ªapp: eureka-appï¼ˆåœ¨selector.matchLabelsä¸­ï¼‰ç¡®ä¿äº†ç°æœ‰çš„ã€å…·æœ‰è¯¥æ ‡ç­¾çš„Podä¼šè¢«æ§åˆ¶å™¨æ‰€ç®¡ç†ï¼›</li><li>ç¬¬äºŒä¸ªapp: eureka-appï¼ˆåœ¨template.metadata.labelsä¸­ï¼‰ç¡®ä¿äº†æ ¹æ®æ­¤æ¨¡æ¿åˆ›å»ºçš„æ–°Podä¹Ÿä¼šæ‹¥æœ‰åŒæ ·çš„æ ‡ç­¾ï¼Œä»è€Œèƒ½å¤Ÿè¢«åŒä¸€ä¸ªæ§åˆ¶å™¨ç»§ç»­ç®¡ç†ã€‚</li><li>è¿™ä¸¤è€…çš„ç»“åˆä½¿ç”¨ä¿è¯äº†Podçš„åˆ›å»ºå’Œç®¡ç†æ˜¯ä¸€è‡´ä¸”è¿è´¯çš„ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸¤ä¸ªæ ‡ç­¾çš„ä¸€è‡´æ€§ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ–°çš„Podä¸ä¼šè¢«ç›¸åº”çš„æ§åˆ¶å™¨ç®¡ç†ï¼Œæˆ–è€…æ—§çš„Podä¸ä¼šè¢«æ›´æ–°æˆ–æ›¿æ¢ã€‚</li></ul></blockquote><h3 id="2-åˆ›å»ºDeployment-1"><a href="#2-åˆ›å»ºDeployment-1" class="headerlink" title="2. åˆ›å»ºDeployment"></a>2. åˆ›å»ºDeployment</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br><br>kubectl apply -f eureka-app-deployment.yaml<br><br>kubectl get deploy,pod<br></code></pre></td></tr></table></figure><h3 id="3-æŸ¥çœ‹åº”ç”¨çš„å¯åŠ¨æ—¥å¿—"><a href="#3-æŸ¥çœ‹åº”ç”¨çš„å¯åŠ¨æ—¥å¿—" class="headerlink" title="3 .æŸ¥çœ‹åº”ç”¨çš„å¯åŠ¨æ—¥å¿—"></a>3 .æŸ¥çœ‹åº”ç”¨çš„å¯åŠ¨æ—¥å¿—</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡kubectl logså‘½ä»¤æ¥æŸ¥çœ‹åº”ç”¨çš„å¯åŠ¨æ—¥å¿—</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl logs -f  pod/eureka-app-deployment-5f5d6cf5ff-gfbxv<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250707200430806.png" alt="image-20250707200430806"></p><h2 id="3-åˆ›å»ºService"><a href="#3-åˆ›å»ºService" class="headerlink" title="3. åˆ›å»ºService"></a>3. <strong>åˆ›å»ºService</strong></h2><p>å¦‚æœæƒ³è¦ä»å¤–éƒ¨è®¿é—®åº”ç”¨ï¼Œéœ€è¦<strong>åˆ›å»ºService</strong>ï¼Œæ·»åŠ é…ç½®æ–‡ä»¶eureka-app-service.yamlç”¨äºåˆ›å»º</p><h3 id="1-å¢åŠ é…ç½®æ–‡ä»¶-1"><a href="#1-å¢åŠ é…ç½®æ–‡ä»¶-1" class="headerlink" title="1. å¢åŠ é…ç½®æ–‡ä»¶"></a>1. å¢åŠ é…ç½®æ–‡ä»¶</h3><p>eureka-app-service.yaml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">eureka-app-service</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">type:</span> <span class="hljs-string">NodePort</span><br>  <span class="hljs-attr">selector:</span>  <span class="hljs-comment">#æ ‡ç­¾é€‰æ‹©å™¨ï¼Œç”¨äºåŒ¹é… Pod</span><br>    <span class="hljs-attr">app:</span> <span class="hljs-string">eureka-app</span><br>  <span class="hljs-attr">ports:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">http</span><br>      <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span><br>      <span class="hljs-attr">port:</span> <span class="hljs-number">8761</span>         <span class="hljs-comment"># Service æš´éœ²çš„ç«¯å£ï¼ˆé›†ç¾¤å†…éƒ¨è®¿é—®ï¼‰</span><br>      <span class="hljs-attr">targetPort:</span> <span class="hljs-number">8761</span>   <span class="hljs-comment"># å®¹å™¨å®é™…ç›‘å¬çš„ç«¯å£ï¼ˆPod ä¸­å®¹å™¨çš„ç«¯å£ï¼‰</span><br></code></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºservice"><a href="#2-åˆ›å»ºservice" class="headerlink" title="2. åˆ›å»ºservice"></a>2. åˆ›å»ºservice</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br><br>kubectl apply -f eureka-app-service.yaml<br><br>kubectl get services<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250707200748407.png" alt="image-20250707200748407"></p><h2 id="4-æµ‹è¯•è®¿é—®"><a href="#4-æµ‹è¯•è®¿é—®" class="headerlink" title="4. æµ‹è¯•è®¿é—®"></a>4. æµ‹è¯•è®¿é—®</h2><p>è®¿é—®<a href="http://localhost:32272/">http://localhost:32272/</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250707200822266.png" alt="image-20250707200822266"></p><h1 id="2-Kubernetes-éƒ¨ç½²éœ€è€ƒè™‘çš„é—®é¢˜"><a href="#2-Kubernetes-éƒ¨ç½²éœ€è€ƒè™‘çš„é—®é¢˜" class="headerlink" title="2. Kubernetes éƒ¨ç½²éœ€è€ƒè™‘çš„é—®é¢˜"></a>2. Kubernetes éƒ¨ç½²éœ€è€ƒè™‘çš„é—®é¢˜</h1><p>æˆ‘ä»¬æœ‰å¦‚ä¸‹å¾®æœåŠ¡ï¼š</p><ul><li><p>æ¶ˆæ¯æœåŠ¡ï¼šmessage-service</p></li><li><p>è¯¾ç¨‹dubboæœåŠ¡ï¼šcourse-dubbo-service</p></li><li><p>è¯¾ç¨‹webæœåŠ¡ï¼šcourse-edge-service</p></li><li><p>ç”¨æˆ·thriftæœåŠ¡ï¼šuser-thrift-service</p></li><li><p>ç”¨æˆ·webæœåŠ¡ï¼šuser-edge-service</p></li><li><p>APIç½‘å…³ï¼šapi-gateway</p></li></ul><h2 id="1-Pod-çš„åˆ’åˆ†ç­–ç•¥"><a href="#1-Pod-çš„åˆ’åˆ†ç­–ç•¥" class="headerlink" title="1. Pod çš„åˆ’åˆ†ç­–ç•¥"></a>1. Pod çš„åˆ’åˆ†ç­–ç•¥</h2><p>å»ºè®®çš„ Pod åˆ’åˆ†æ–¹æ¡ˆï¼š</p><ul><li><strong>è¯¾ç¨‹æœåŠ¡ç»„åˆ</strong>ï¼š<ul><li><code>course-dubbo-service</code> å’Œ <code>course-edge-service</code> æ”¾åœ¨åŒä¸€ä¸ª Pod ä¸­ã€‚</li><li>åŸå› ï¼šweb æœåŠ¡é¢‘ç¹è°ƒç”¨ dubbo æœåŠ¡ï¼Œæ”¾åœ¨åŒä¸€ Pod å†…å¯é€šè¿‡ <code>localhost</code> ç›´æ¥è®¿é—®ï¼Œå‡å°‘ç½‘ç»œå¼€é”€ï¼Œæé«˜æ€§èƒ½ã€‚</li></ul></li><li><strong>æ¶ˆæ¯æœåŠ¡</strong>ï¼š<ul><li>å•ç‹¬éƒ¨ç½²ä¸ºä¸€ä¸ª Podã€‚</li><li>åŸå› ï¼šä¸å…¶ä»–æœåŠ¡è€¦åˆåº¦ä½ï¼Œç‹¬ç«‹è¿è¡Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•ã€‚</li></ul></li><li><strong>ç”¨æˆ·æœåŠ¡ç»„åˆ</strong>ï¼š<ul><li><code>user-thrift-service</code> å’Œ <code>user-edge-service</code> æ”¾åœ¨åŒä¸€ä¸ª Pod ä¸­ã€‚</li><li>åŸå› ï¼šç±»ä¼¼è¯¾ç¨‹æœåŠ¡çš„åœºæ™¯ï¼Œweb æœåŠ¡ä¸»è¦ä¾èµ– thrift æ¥å£ã€‚</li></ul></li><li><strong>API ç½‘å…³</strong>ï¼š<ul><li>å•ç‹¬éƒ¨ç½²ä¸ºä¸€ä¸ª Podã€‚</li><li>åŸå› ï¼šä½œä¸ºæ‰€æœ‰å¤–éƒ¨è¯·æ±‚çš„ç»Ÿä¸€å…¥å£ï¼Œéœ€è¦å…·å¤‡é«˜å¯ç”¨æ€§å’Œè´Ÿè½½å‡è¡¡èƒ½åŠ›ã€‚</li></ul></li></ul><p><strong>å°ç»“</strong>ï¼š</p><blockquote><p>åŒä¸€ä¸šåŠ¡åŸŸå†…ã€è°ƒç”¨é¢‘ç¹çš„æœåŠ¡å»ºè®®æ”¾åœ¨åŒä¸€ä¸ª Pod ä¸­ï¼Œä»¥æå‡å†…éƒ¨é€šä¿¡æ•ˆç‡ï¼›å¯¹å¤–äº¤äº’é¢‘ç¹æˆ–èŒè´£ç‹¬ç«‹çš„æœåŠ¡åº”å•ç‹¬éƒ¨ç½²ã€‚</p></blockquote><h2 id="2-åŒä¸€-Pod-å†…æœåŠ¡å¦‚ä½•äº’ç›¸è®¿é—®"><a href="#2-åŒä¸€-Pod-å†…æœåŠ¡å¦‚ä½•äº’ç›¸è®¿é—®" class="headerlink" title="2. åŒä¸€ Pod å†…æœåŠ¡å¦‚ä½•äº’ç›¸è®¿é—®"></a>2. åŒä¸€ Pod å†…æœåŠ¡å¦‚ä½•äº’ç›¸è®¿é—®</h2><p>Kubernetes ä¸­ï¼ŒåŒä¸€ä¸ª Pod å†…çš„æ‰€æœ‰å®¹å™¨å…±äº«ç½‘ç»œå‘½åç©ºé—´ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ <code>localhost</code> + ç«¯å£å·çš„æ–¹å¼ç›´æ¥è®¿é—®å½¼æ­¤çš„æœåŠ¡</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-comment"># ç¤ºä¾‹ï¼šcourse-edge-service è°ƒç”¨ course-dubbo-service</span><br><span class="hljs-attr">dubbo:</span><br>  <span class="hljs-attr">registry:</span><br>    <span class="hljs-attr">address:</span> <span class="hljs-string">zookeeper://localhost:2181</span><br></code></pre></td></tr></table></figure><h2 id="3-å¦‚ä½•è®©æœåŠ¡å¯¹å¤–æä¾›è®¿é—®"><a href="#3-å¦‚ä½•è®©æœåŠ¡å¯¹å¤–æä¾›è®¿é—®" class="headerlink" title="3. å¦‚ä½•è®©æœåŠ¡å¯¹å¤–æä¾›è®¿é—®"></a>3. å¦‚ä½•è®©æœåŠ¡å¯¹å¤–æä¾›è®¿é—®</h2><p>æ¯ä¸ªå¯¹å¤–æš´éœ²çš„æœåŠ¡éƒ½éœ€è¦é€šè¿‡ Kubernetes çš„ Service å¯¹è±¡æ¥å®ç°è®¿é—®æ§åˆ¶ã€‚</p><p><strong>æ¨èæ–¹å¼ï¼š</strong></p><ul><li>ä½¿ç”¨ <code>ClusterIP</code> ç±»å‹çš„ Service ä¾›å†…éƒ¨æœåŠ¡ä¹‹é—´è®¿é—®ï¼›</li><li>ä½¿ç”¨ <code>NodePort</code> æˆ– <code>LoadBalancer</code> ç±»å‹çš„ Service å¯¹å¤–æš´éœ²æœåŠ¡ï¼›</li><li>API ç½‘å…³æ¨èä½¿ç”¨ <code>Ingress</code> æ§åˆ¶å™¨è¿›è¡Œç»Ÿä¸€è·¯ç”±ç®¡ç†ã€‚</li></ul><h2 id="4-æ•´ä¸ªç³»ç»Ÿçš„å…¥å£æ˜¯å“ªä¸ªæœåŠ¡ï¼Ÿå¦‚ä½•å¯¹å¤–æš´éœ²ï¼Ÿ"><a href="#4-æ•´ä¸ªç³»ç»Ÿçš„å…¥å£æ˜¯å“ªä¸ªæœåŠ¡ï¼Ÿå¦‚ä½•å¯¹å¤–æš´éœ²ï¼Ÿ" class="headerlink" title="4. æ•´ä¸ªç³»ç»Ÿçš„å…¥å£æ˜¯å“ªä¸ªæœåŠ¡ï¼Ÿå¦‚ä½•å¯¹å¤–æš´éœ²ï¼Ÿ"></a>4. æ•´ä¸ªç³»ç»Ÿçš„å…¥å£æ˜¯å“ªä¸ªæœåŠ¡ï¼Ÿå¦‚ä½•å¯¹å¤–æš´éœ²ï¼Ÿ</h2><p>æ•´ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒå…¥å£æ˜¯ <strong>API ç½‘å…³ï¼ˆapi-gatewayï¼‰</strong>ï¼Œå®ƒè´Ÿè´£æ¥æ”¶æ‰€æœ‰å¤–éƒ¨è¯·æ±‚ï¼Œå¹¶æ ¹æ®è·¯ç”±è§„åˆ™è½¬å‘ç»™å¯¹åº”çš„å¾®æœåŠ¡ã€‚</p><p><strong>å¯¹å¤–æš´éœ²æ–¹å¼ï¼š</strong></p><ul><li>ä½¿ç”¨ <code>Ingress</code> æ§åˆ¶å™¨ç»“åˆåŸŸåè¿›è¡Œç»Ÿä¸€æ¥å…¥ï¼›</li><li>å¦‚æœæ²¡æœ‰ Ingressï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>LoadBalancer</code> ç±»å‹çš„ Serviceï¼›</li><li>å¯ç»“åˆ TLS åŠ å¯†ã€é™æµç†”æ–­ç­‰æœºåˆ¶å¢å¼ºå®‰å…¨æ€§ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>Kubernetes</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Kuberneteséƒ¨ç½²Nginx</title>
    <link href="/Kubernetes%E9%83%A8%E7%BD%B2Nginx/"/>
    <url>/Kubernetes%E9%83%A8%E7%BD%B2Nginx/</url>
    
    <content type="html"><![CDATA[<h1 id="1-K8Séƒ¨ç½²Nginx"><a href="#1-K8Séƒ¨ç½²Nginx" class="headerlink" title="1. K8Séƒ¨ç½²Nginx"></a>1. <strong>K8Séƒ¨ç½²Nginx</strong></h1><p>åœ¨k8s-masteræœºå™¨ä¸Šæ‰§è¡Œ</p><h2 id="1-åˆ›å»ºä¸€æ¬¡deploymentéƒ¨ç½²"><a href="#1-åˆ›å»ºä¸€æ¬¡deploymentéƒ¨ç½²" class="headerlink" title="1. åˆ›å»ºä¸€æ¬¡deploymentéƒ¨ç½²"></a>1. åˆ›å»ºä¸€æ¬¡deploymentéƒ¨ç½²</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl create deployment nginx â€â€image=nginx<br></code></pre></td></tr></table></figure><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250703222411043.png" alt="image-20250703222411043" style="zoom:100%;" /><h2 id="2-åˆ›å»º-Service"><a href="#2-åˆ›å»º-Service" class="headerlink" title="2. åˆ›å»º Service"></a>2. åˆ›å»º Service</h2><p>ä½¿ç”¨ <code>kubectl expose</code> æ¥ä¸ºä¹‹å‰åˆ›å»ºçš„åä¸º <code>nginx</code> çš„ Deployment åˆ›å»ºä¸€ä¸ª Service</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl expose deployment nginx â€â€port=80 â€â€type=NodePort<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250703222504494.png" alt="image-20250703222504494"></p><h2 id="3-è®¿é—®Nginxåœ°å€"><a href="#3-è®¿é—®Nginxåœ°å€" class="headerlink" title="3. è®¿é—®Nginxåœ°å€"></a>3. è®¿é—®Nginxåœ°å€</h2><p> <a href="http://localhost:30918/">http://localhost:30918/</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250703221802668.png" alt="image-20250703221802668"></p><h2 id="4-å¯¹nginxè¿™ä¸ªdeploymentè¿›è¡Œæ‰©ç¼©å®¹"><a href="#4-å¯¹nginxè¿™ä¸ªdeploymentè¿›è¡Œæ‰©ç¼©å®¹" class="headerlink" title="4. å¯¹nginxè¿™ä¸ªdeploymentè¿›è¡Œæ‰©ç¼©å®¹"></a>4. <strong>å¯¹nginxè¿™ä¸ªdeploymentè¿›è¡Œæ‰©ç¼©å®¹</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl scale --replicas=2 deployment nginx<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250703224359533.png" alt="image-20250703224359533"></p><h2 id="5-æ»šåŠ¨å‡çº§"><a href="#5-æ»šåŠ¨å‡çº§" class="headerlink" title="5. æ»šåŠ¨å‡çº§"></a>5. æ»šåŠ¨å‡çº§</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl set image deployment.apps/nginx  nginx=nginx:1.28.0<br></code></pre></td></tr></table></figure><ul><li><code>deployment.apps/nginx</code>: æŒ‡å®šäº†è¦æ“ä½œçš„ç›®æ ‡èµ„æºç±»å‹ï¼ˆDeploymentï¼‰åŠå…¶åç§°ï¼ˆnginxï¼‰ã€‚</li><li><code>nginx=nginx:1.28.0</code>: è¿™éƒ¨åˆ†æŒ‡å®šäº†å®¹å™¨åå’Œæ–°çš„é•œåƒåç§°åŠæ ‡ç­¾ã€‚å…¶ä¸­ <code>nginx</code> æ˜¯ Deployment <code>nginx</code> ä¸­å®¹å™¨çš„åå­—ï¼Œè€Œ <code>nginx:1.28.0</code> æ˜¯ä½ å¸Œæœ›æ›´æ–°åˆ°çš„æ–°é•œåƒã€‚</li></ul><p>ä½¿ç”¨ <code>curl</code> å‘é€è¯·æ±‚ï¼šæŸ¥çœ‹å“åº”å¤´ä¸­çš„ <code>Server</code> å­—æ®µæ¥è·å– Nginx ç‰ˆæœ¬ä¿¡æ¯</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250705115801052.png" alt="image-20250705115801052"></p><p>æŸ¥çœ‹æŸä¸ªpodçš„è¯¦ç»†ä¿¡æ¯ï¼Œå‘ç°podé‡Œçš„é•œåƒç‰ˆæœ¬å·²ç»å‡çº§äº†</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250703230511156.png" alt="image-20250703230511156"></p><h2 id="6-ç‰ˆæœ¬å›æ»š"><a href="#6-ç‰ˆæœ¬å›æ»š" class="headerlink" title="6. ç‰ˆæœ¬å›æ»š"></a>6. ç‰ˆæœ¬å›æ»š</h2><h3 id="1-æŸ¥çœ‹å†å²ç‰ˆæœ¬"><a href="#1-æŸ¥çœ‹å†å²ç‰ˆæœ¬" class="headerlink" title="1. æŸ¥çœ‹å†å²ç‰ˆæœ¬"></a>1. æŸ¥çœ‹å†å²ç‰ˆæœ¬</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl rollout history deploy nginx<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250705120109209.png" alt="image-20250705120109209"></p><h3 id="2-å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬"><a href="#2-å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬" class="headerlink" title="2. å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬"></a>2. å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl rollout undo deploy nginx   #â€â€toâ€revision å‚æ•°å¯ä»¥æŒ‡å®šå›é€€çš„ç‰ˆæœ¬<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250705120156769.png" alt="image-20250705120156769"></p><p>å†æ¬¡ä½¿ç”¨ <code>curl</code> è®¿é—®nginxï¼Œå‘ç°ç‰ˆæœ¬å·²ç»å›é€€</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250705120352860.png" alt="image-20250705120352860"></p><h2 id="7-æ ‡ç­¾çš„ä½¿ç”¨"><a href="#7-æ ‡ç­¾çš„ä½¿ç”¨" class="headerlink" title="7, æ ‡ç­¾çš„ä½¿ç”¨"></a>7, <strong>æ ‡ç­¾çš„ä½¿ç”¨</strong></h2><p>é€šè¿‡ç»™èµ„æºæ·»åŠ Labelï¼Œå¯ä»¥æ–¹ä¾¿åœ°ç®¡ç†èµ„æºï¼ˆå¦‚Deploymentã€Podã€Serviceç­‰ï¼‰ã€‚</p><h3 id="1-æŸ¥çœ‹Deploymentä¸­æ‰€åŒ…å«çš„Label"><a href="#1-æŸ¥çœ‹Deploymentä¸­æ‰€åŒ…å«çš„Label" class="headerlink" title="1. æŸ¥çœ‹Deploymentä¸­æ‰€åŒ…å«çš„Label"></a>1. æŸ¥çœ‹Deploymentä¸­æ‰€åŒ…å«çš„Label</h3><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250705120548151.png" alt="image-20250705120548151"></p><h3 id="2-é€šè¿‡LabelæŸ¥è¯¢Pod"><a href="#2-é€šè¿‡LabelæŸ¥è¯¢Pod" class="headerlink" title="2. é€šè¿‡LabelæŸ¥è¯¢Pod"></a>2. é€šè¿‡LabelæŸ¥è¯¢Pod</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">kubectl <span class="hljs-builtin-name">get</span> pods -l <span class="hljs-attribute">app</span>=nginx<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250705155913531.png" alt="image-20250705155913531"></p><h3 id="3-é€šè¿‡LabelæŸ¥è¯¢Service"><a href="#3-é€šè¿‡LabelæŸ¥è¯¢Service" class="headerlink" title="3. é€šè¿‡LabelæŸ¥è¯¢Service"></a>3. é€šè¿‡LabelæŸ¥è¯¢Service</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">kubectl <span class="hljs-builtin-name">get</span> services â€l <span class="hljs-attribute">app</span>=nginx<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250705155936913.png" alt="image-20250705155936913"></p><h3 id="4-ç»™Podæ·»åŠ Label"><a href="#4-ç»™Podæ·»åŠ Label" class="headerlink" title="4. ç»™Podæ·»åŠ Label"></a>4. ç»™Podæ·»åŠ Label</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl label pod myâ€tomcatâ€685b8fd9c9â€lrwst version=test-label<br></code></pre></td></tr></table></figure><h3 id="5-é€šè¿‡LabelæŸ¥è¯¢Pod"><a href="#5-é€šè¿‡LabelæŸ¥è¯¢Pod" class="headerlink" title="5. é€šè¿‡LabelæŸ¥è¯¢Pod"></a>5. é€šè¿‡LabelæŸ¥è¯¢Pod</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl get pods â€l version=test-label<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250705160210458.png" alt="image-20250705160210458"></p><h3 id="6-é€šè¿‡Labelåˆ é™¤æœåŠ¡"><a href="#6-é€šè¿‡Labelåˆ é™¤æœåŠ¡" class="headerlink" title="6. é€šè¿‡Labelåˆ é™¤æœåŠ¡"></a>6. é€šè¿‡Labelåˆ é™¤æœåŠ¡</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">kubectl delete<span class="hljs-built_in"> service </span>â€l <span class="hljs-attribute">app</span>=test-label<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Kubernetesæ ¸å¿ƒåŸç†</title>
    <link href="/Kubernetes%E5%BF%AB%E9%80%9F%E5%AE%9E%E6%88%98%E4%B8%8E%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/"/>
    <url>/Kubernetes%E5%BF%AB%E9%80%9F%E5%AE%9E%E6%88%98%E4%B8%8E%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="1-K8sç®€ä»‹"><a href="#1-K8sç®€ä»‹" class="headerlink" title="1.  K8sç®€ä»‹"></a>1.  K8sç®€ä»‹</h1><p>Kubernetesï¼ˆé€šå¸¸ç®€ç§°ä¸ºK8sï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨ç¼–æ’çš„å·¥å…·ï¼Œç”¨äº<strong>è‡ªåŠ¨åŒ–éƒ¨ç½²ã€æ‰©å±•å’Œç®¡ç†å®¹å™¨åŒ–åº”ç”¨</strong>ã€‚å®ƒæä¾›äº†ä¸€ç»„ä¸°å¯Œçš„åŠŸèƒ½å’Œå·¥å…·ï¼Œç”¨äºç®€åŒ–å®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„éƒ¨ç½²ã€ä¼¸ç¼©å’Œè¿ç»´ã€‚</p><p><strong>ä¸ºä»€ä¹ˆå‡ºç°k8s?</strong></p><p>è¿™è¦å®¹å™¨æŠ€æœ¯å…´èµ·å¼€å§‹è¯´ï¼Œä¸ºäº†è§£å†³â€œä¸€æ¬¡æ‰“åŒ…ï¼Œåˆ°å¤„è¿è¡Œâ€çš„é—®é¢˜ï¼Œå¤§å®¶å¼•å…¥äº†docker,  éšç€é¡¹ç›®è¶Šæ¥è¶Šå¤§ï¼Œä¸€ä¸ªå¾®æœåŠ¡åº”ç”¨å¯èƒ½ç”±å‡ åä¸ªç”šè‡³ä¸Šç™¾ä¸ªå®¹å™¨ç»„æˆï¼Œè¿™æ—¶å€™å°±å‡ºç°äº†æ–°çš„é—®é¢˜ã€‚</p><ol><li>å®¹å™¨çš„ç®¡ç†é—®é¢˜ï¼š å¯åŠ¨ã€åœæ­¢ã€é‡å¯ã€å‡çº§å¾ˆå¤šå®¹å™¨å¾ˆéº»çƒ¦</li><li>å¦‚ä½•è‡ªåŠ¨é‡å¯å¤±è´¥çš„å®¹å™¨ï¼Ÿå¦‚æœæŸä¸ªæœåŠ¡æŒ‚äº†ï¼Œæ€ä¹ˆè®©å®ƒè‡ªåŠ¨æ¢å¤ï¼Ÿ</li><li>å¦‚ä½•åº”å¯¹æµé‡é«˜å³°ï¼Ÿå®ç°è‡ªåŠ¨æ‰©å®¹ï¼Ÿ</li><li>å¤šä¸ªå®¹å™¨åˆ†å¸ƒåœ¨ä¸åŒæœºå™¨ä¸Šæ—¶ï¼Œæ€ä¹ˆé€šä¿¡ï¼Œç½‘ç»œæ€ä¹ˆé…ï¼Ÿ</li><li>æ€ä¹ˆæ›´å®ç°æ›´æ–°ç‰ˆæœ¬æ—¶ï¼Œç”¨æˆ·ä¸èƒ½æ„ŸçŸ¥åˆ°åœæœºï¼Ÿ</li></ol><p>è¿™äº›é—®é¢˜åŠ åœ¨ä¸€èµ·ï¼Œ å¯¼è‡´è¿ç»´å·¥ä½œå˜å¾—æå…¶å¤æ‚ã€‚Google çœ‹åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¼€å‘äº† Kubernetesï¼Œç›®æ ‡å°±æ˜¯ï¼šæä¾›ä¸€ä¸ªç»Ÿä¸€çš„å¹³å°ï¼Œç”¨æ¥è‡ªåŠ¨åŒ–åœ°éƒ¨ç½²ã€æ‰©å±•å’Œç®¡ç†å®¹å™¨åŒ–åº”ç”¨ã€‚</p><p>ä½ å¯ä»¥æŠŠä»–æƒ³è±¡æˆä¸€ä¸ªå®¹å™¨ç®¡å®¶ï¼š</p><ul><li>ä½ å‘Šè¯‰å®ƒï¼šâ€œæˆ‘è¦è¿è¡Œä¸€ä¸ªæœåŠ¡ï¼Œå‰¯æœ¬æ•°æ˜¯3ä¸ªã€‚â€</li><li>å®ƒå°±ä¼šè‡ªåŠ¨å¸®ä½ å¯åŠ¨3ä¸ªå®¹å™¨ï¼Œå¹¶ç¡®ä¿å®ƒä»¬ä¸€ç›´æ­£å¸¸è¿è¡Œã€‚</li><li>å¦‚æœå…¶ä¸­ä¸€ä¸ªå®¹å™¨åäº†ï¼Œå®ƒä¼šè‡ªåŠ¨é‡æ–°å¯åŠ¨ä¸€ä¸ªæ–°çš„ã€‚</li><li>å¦‚æœè®¿é—®é‡å˜å¤šäº†ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨å¢åŠ å‰¯æœ¬æ•°é‡ã€‚</li><li>æ‰€æœ‰è¿™äº›éƒ½ä¸éœ€è¦ä½ æ‰‹åŠ¨æ“ä½œã€‚</li></ul><h1 id="2-K8sæ ¸å¿ƒç‰¹æ€§"><a href="#2-K8sæ ¸å¿ƒç‰¹æ€§" class="headerlink" title="2. K8sæ ¸å¿ƒç‰¹æ€§"></a>2. <strong>K8sæ ¸å¿ƒç‰¹æ€§</strong></h1><ul><li>æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡ï¼šæ— éœ€ä¿®æ”¹ä½ çš„åº”ç”¨ç¨‹åºå³å¯ä½¿ç”¨é™Œç”Ÿçš„æœåŠ¡å‘ç°æœºåˆ¶ã€‚</li><li>è‡ªæˆ‘ä¿®å¤ï¼šé‡æ–°å¯åŠ¨å¤±è´¥çš„å®¹å™¨ï¼Œåœ¨èŠ‚ç‚¹æ­»äº¡æ—¶æ›¿æ¢å¹¶é‡æ–°è°ƒåº¦å®¹å™¨ï¼Œæ€æ­»ä¸å“åº”ç”¨æˆ·å®šä¹‰çš„å¥åº·æ£€æŸ¥çš„å®¹å™¨ã€‚</li><li>è‡ªåŠ¨åŒ–ä¸Šçº¿å’Œå›æ»šï¼šKubernetesä¼šåˆ†æ­¥éª¤åœ°å°†é’ˆå¯¹åº”ç”¨æˆ–å…¶é…ç½®çš„æ›´æ”¹ä¸Šçº¿ï¼ŒåŒæ—¶ç›‘è§†åº”ç”¨ç¨‹åºè¿è¡ŒçŠ¶å†µä»¥ç¡®ä¿ä½ ä¸ä¼šåŒæ—¶ç»ˆæ­¢æ‰€æœ‰å®ä¾‹ã€‚</li><li>æ°´å¹³æ‰©ç¼©ï¼šä½¿ç”¨ä¸€ä¸ªç®€å•çš„å‘½ä»¤ã€ä¸€ä¸ªUIæˆ–åŸºäºCPUä½¿ç”¨æƒ…å†µè‡ªåŠ¨å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œæ‰©ç¼©ã€‚</li><li>å­˜å‚¨ç¼–æ’ï¼šè‡ªåŠ¨æŒ‚è½½æ‰€é€‰å­˜å‚¨ç³»ç»Ÿï¼ŒåŒ…æ‹¬æœ¬åœ°å­˜å‚¨ã€‚</li><li>Secretå’Œé…ç½®ç®¡ç†ï¼šéƒ¨ç½²æ›´æ–°Secretså’Œåº”ç”¨ç¨‹åºçš„é…ç½®æ—¶ä¸å¿…é‡æ–°æ„å»ºå®¹å™¨é•œåƒï¼Œä¸”ä¸å¿…å°†è½¯ä»¶å †æ ˆé…ç½®ä¸­çš„ç§˜å¯†ä¿¡æ¯æš´éœ²å‡ºæ¥ã€‚</li><li>æ‰¹é‡æ‰§è¡Œï¼šé™¤äº†æœåŠ¡ä¹‹å¤–ï¼ŒKubernetesè¿˜å¯ä»¥ç®¡ç†ä½ çš„æ‰¹å¤„ç†å’ŒCIå·¥ä½œè´Ÿè½½ï¼Œåœ¨æœŸæœ›æ—¶æ›¿æ¢æ‰å¤±æ•ˆçš„å®¹å™¨ã€‚</li><li>è‡ªåŠ¨è£…ç®±ï¼šæ ¹æ®èµ„æºéœ€æ±‚å’Œå…¶ä»–çº¦æŸè‡ªåŠ¨æ”¾ç½®å®¹å™¨ï¼ŒåŒæ—¶é¿å…å½±å“å¯ç”¨æ€§ã€‚</li></ul><p>ä½¿ç”¨åœºæ™¯ï¼šå¿«é€Ÿéƒ¨ç½²åº”ç”¨ã€å¿«é€Ÿæ‰©å±•åº”ç”¨ã€æ— ç¼å¯¹æ¥æ–°çš„åº”ç”¨åŠŸèƒ½ã€èŠ‚çœèµ„æºï¼Œä¼˜åŒ–ç¡¬ä»¶èµ„æºçš„ä½¿ç”¨ï¼›</p><h1 id="3-K8sæ ¸å¿ƒæ¦‚å¿µ"><a href="#3-K8sæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="3. K8sæ ¸å¿ƒæ¦‚å¿µ"></a>3. K8sæ ¸å¿ƒæ¦‚å¿µ</h1><h2 id="1-Pod"><a href="#1-Pod" class="headerlink" title="1 Pod"></a>1 Pod</h2><h3 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h3><p>Pod æ˜¯ Kubernetes ä¸­æœ€å°çš„å¯éƒ¨ç½²å•å…ƒã€‚ä¸€ä¸ª Pod å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªï¼‰ï¼Œè¿™äº›å®¹å™¨å…±äº«å­˜å‚¨ã€ç½‘ç»œå’Œè§„èŒƒåŒ–çš„è¿è¡Œé…ç½®ã€‚</p><ul><li>æ‰€æœ‰çš„åº”ç”¨ï¼ŒæœåŠ¡æœ€ç»ˆéƒ½æ˜¯è¿è¡Œåœ¨podä¸Š</li><li>podæœ‰ä¸€ä¸ªç‹¬ç«‹çš„ipï¼Œpodé‡Œçš„å®¹å™¨å¯ä»¥å…±äº«ç½‘ç»œï¼Œå…±äº«IP</li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250713152823707.png" alt="image-20250713152823707" style="zoom:50%;" /><h3 id="2-podçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#2-podçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="2. podçš„ç”Ÿå‘½å‘¨æœŸ"></a>2. podçš„ç”Ÿå‘½å‘¨æœŸ</h3><p>Pendingï¼ˆæŒ‚èµ·ï¼‰ï¼šAPI serverå·²ç»åˆ›å»ºpodå¹¶ä¿å­˜åœ¨Etcdå½“ä¸­ï¼Œä½†è¿™ä¸ªPodé‡Œæœ‰äº›å®¹å™¨å› ä¸ºæŸç§åŸå› è€Œä¸èƒ½è¢«é¡ºåˆ©åˆ›å»ºã€‚æ¯”å¦‚ï¼Œæ­£åœ¨ä¸‹è½½é•œåƒçš„è¿‡ç¨‹ï¼Œé…ç½®æ–‡ä»¶æœ‰è¯¯</p><p>Runningï¼ˆè¿è¡Œä¸­ï¼‰ï¼šPodå†…æ‰€æœ‰çš„å®¹å™¨å·²ç»åˆ›å»ºï¼Œä¸”è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨å¤„äºè¿è¡ŒçŠ¶æ€ã€æ­£åœ¨å¯åŠ¨æ‹¬æ­£åœ¨é‡å¯çŠ¶æ€ï¼›</p><p>Succeedï¼ˆæˆåŠŸï¼‰ï¼šPodå†…æ‰€æœ‰å®¹å™¨å‡å·²é€€å‡ºï¼Œä¸”ä¸ä¼šå†é‡å¯ï¼›</p><p>Failedï¼ˆå¤±è´¥ï¼‰ï¼šPodå†…æ‰€æœ‰å®¹å™¨å‡å·²é€€å‡ºï¼Œä¸”è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨ä¸ºé€€å‡ºå¤±è´¥çŠ¶æ€</p><p>Unknownï¼ˆæœªçŸ¥ï¼‰ï¼šæŸäºæŸç§åŸå› apiserveræ— æ³•è·å–è¯¥podçš„çŠ¶æ€ï¼Œå¯èƒ½ç”±äºç½‘ç»œé€šè¡Œé—®é¢˜å¯¼è‡´ï¼›</p><h3 id="3-podçš„é‡å¯ç­–ç•¥"><a href="#3-podçš„é‡å¯ç­–ç•¥" class="headerlink" title="3. podçš„é‡å¯ç­–ç•¥"></a>3. podçš„é‡å¯ç­–ç•¥</h3><p>é€šè¿‡å‘½ä»¤<code>kubectl explain pod.spec</code>æŸ¥çœ‹podçš„é‡å¯ç­–ç•¥ã€‚</p><ul><li>Alwaysï¼šä½†å‡¡podå¯¹è±¡ç»ˆæ­¢å°±é‡å¯ï¼Œæ­¤ä¸ºé»˜è®¤ç­–ç•¥;</li><li>Neverï¼š ä¸é‡å¯</li><li>OnFailureï¼šä»…åœ¨podå¯¹è±¡å‡ºç°é”™è¯¯æ—¶æ‰é‡å¯;</li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250713174239215.png" alt="image-20250713174239215" style="zoom:50%;" /><blockquote><p>docker çš„é‡å¯ç­–ç•¥æ˜¯ï¼š</p><ul><li><p><strong>no</strong>ï¼šé»˜è®¤ç­–ç•¥ï¼Œå®¹å™¨é€€å‡ºåä¸ä¼šè‡ªåŠ¨é‡å¯ã€‚é€‚ç”¨äºä¸€æ¬¡æ€§ä»»åŠ¡æˆ–æµ‹è¯•åœºæ™¯ã€‚</p></li><li><p><strong>always</strong>ï¼šæ— è®ºé€€å‡ºåŸå› ï¼Œå®¹å™¨éƒ½ä¼šè‡ªåŠ¨é‡å¯ã€‚å³ä½¿ Docker å®ˆæŠ¤è¿›ç¨‹é‡å¯ï¼Œå®¹å™¨ä¹Ÿä¼šéšä¹‹å¯åŠ¨ã€‚</p></li><li><p>**on-failure[:n]**ï¼šä»…åœ¨å®¹å™¨å¼‚å¸¸é€€å‡ºï¼ˆé 0 çŠ¶æ€ç ï¼‰æ—¶é‡å¯ã€‚å¯é€‰å‚æ•° <em>n</em> æŒ‡å®šæœ€å¤§é‡å¯æ¬¡æ•°ã€‚</p></li><li><p><strong>unless-stopped</strong>ï¼šä¸ <em>always</em> ç±»ä¼¼ï¼Œä½†å¦‚æœå®¹å™¨è¢«æ‰‹åŠ¨åœæ­¢ï¼ˆå¦‚ <em>docker stop</em>ï¼‰ï¼Œå³ä½¿ Docker å®ˆæŠ¤è¿›ç¨‹é‡å¯ï¼Œå®¹å™¨ä¹Ÿä¸ä¼šè‡ªåŠ¨å¯åŠ¨ã€‚</p></li></ul></blockquote><h2 id="2-Deployment"><a href="#2-Deployment" class="headerlink" title="2 Deployment"></a>2 Deployment</h2><p>Deployment æ˜¯ä¸€ç§æ§åˆ¶å™¨å¯¹è±¡ï¼Œç”¨äºç®¡ç† Pod çš„éƒ¨ç½²å’Œæ‰©å±•ã€‚å®ƒæä¾›äº†ä¸€ç§å£°æ˜å¼çš„æ–¹æ³•æ¥æè¿°æœŸæœ›çš„åº”ç”¨ç¨‹åºçŠ¶æ€ã€‚</p><ul><li>Deployment è´Ÿè´£ç®¡ç†å…¶ä¸‹æ‰€æœ‰ Pod çš„ç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬åˆ›å»ºã€æ›´æ–°å’Œåˆ é™¤ã€‚å¦‚æœæŸä¸ª Pod å¤±è´¥æˆ–è¢«åˆ é™¤ï¼ŒDeployment ä¼šè‡ªåŠ¨åˆ›å»ºæ–°çš„ Pod æ¥æ›¿æ¢å®ƒã€‚</li><li>é€šè¿‡ Deploymentï¼Œæ‚¨å¯ä»¥å®šä¹‰åº”ç”¨ç¨‹åºæ‰€éœ€çš„å‰¯æœ¬æ•°é‡ï¼Œå¹¶ç¡®ä¿é›†ç¾¤ä¸­å§‹ç»ˆæœ‰æŒ‡å®šæ•°é‡çš„ Pod åœ¨è¿è¡Œã€‚æ­¤å¤–ï¼ŒDeployment æ”¯æŒæ»šåŠ¨æ›´æ–°ï¼ˆRolling Updatesï¼‰å’Œå›æ»šï¼ˆRollbacksï¼‰ï¼Œä½¿å¾—åº”ç”¨æ›´æ–°è¿‡ç¨‹æ›´åŠ å¹³æ»‘ã€‚</li></ul><h2 id="3-service"><a href="#3-service" class="headerlink" title="3 service"></a>3 service</h2><p>Service å®šä¹‰äº†ä¸€ç»„é€»è¾‘ Pods å’Œè®¿é—®è¿™ç»„ Pods çš„ç­–ç•¥ï¼Œæ˜¯çœŸå®æœåŠ¡çš„æŠ½è±¡ã€‚Service æä¾›äº†ä¸€ä¸ª IP åœ°å€å’Œ DNS åç§°ï¼Œç”¨äºç¨³å®šåœ°è®¿é—®è¿™äº› Podsã€‚</p><ul><li><p>ç”±äº Pod æ˜¯åŠ¨æ€çš„ï¼Œå®ƒä»¬å¯èƒ½å› ä¸ºå„ç§åŸå› è¢«é”€æ¯å’Œé‡å»ºï¼Œå¯¼è‡´ IP åœ°å€å˜åŒ–ã€‚Service æä¾›äº†ä¸€ä¸ªç¨³å®šçš„ç½‘ç»œç«¯ç‚¹ï¼Œä½¿å¾—å…¶ä»–æœåŠ¡æˆ–å¤–éƒ¨ç”¨æˆ·èƒ½å¤Ÿå¯é åœ°ä¸ä¸€ç»„ Pods è¿›è¡Œé€šä¿¡ï¼Œå¦‚æœæ²¡æœ‰Serviceï¼Œpodçš„IPä¸ä¼šæš´éœ²åœ¨ç¾¤é›†å¤–éƒ¨ã€‚</p></li><li><p>Serviceä¹Ÿå¯ä»¥ç”¨åœ¨ServiceSpecæ ‡è®°typeçš„æ–¹å¼æš´éœ²ï¼Œtypeç±»å‹å¦‚ä¸‹ï¼š</p><ul><li><p>ClusterIPï¼ˆé»˜è®¤ï¼‰ï¼šåœ¨é›†ç¾¤çš„å†…éƒ¨IPä¸Šå…¬å¼€Serviceã€‚è¿™ç§ç±»å‹ä½¿å¾—Serviceåªèƒ½ä»é›†ç¾¤å†…è®¿é—®ã€‚</p></li><li><p>NodePortï¼šä½¿ç”¨NATåœ¨é›†ç¾¤ä¸­æ¯ä¸ªé€‰å®šNodeçš„ç›¸åŒç«¯å£ä¸Šå…¬å¼€Serviceã€‚ä½¿ç”¨ <NodeIP>:<NodePort> ä»é›†ç¾¤å¤–éƒ¨è®¿é—®Serviceã€‚æ˜¯ClusterIPçš„è¶…é›†ã€‚</p></li><li><p>LoadBalancerï¼šåœ¨å½“å‰äº‘ä¸­åˆ›å»ºä¸€ä¸ªå¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨(å¦‚æœæ”¯æŒçš„è¯)ï¼Œå¹¶ä¸ºServiceåˆ†é…ä¸€ä¸ªå›ºå®šçš„å¤–éƒ¨IPã€‚æ˜¯NodePortçš„è¶…é›†ã€‚</p></li><li><p>ExternalNameï¼šé€šè¿‡è¿”å›å¸¦æœ‰è¯¥åç§°çš„CNAMEè®°å½•ï¼Œä½¿ç”¨ä»»æ„åç§°ï¼ˆç”±specä¸­çš„externalNameæŒ‡å®šï¼‰å…¬å¼€Serviceã€‚ä¸ä½¿ç”¨ä»£ç†ã€‚</p></li></ul></li></ul><blockquote><p>ä¸ºä»€ä¹ˆPodå·²ç»æœ‰äº†IPè¿˜éœ€è¦serviceå†åŒ…ä¸€å±‚å‘¢ï¼Ÿ</p><ul><li>å½“Podå‡ºç°æ„å¤–æŒ‚æ‰æ—¶ï¼Œè¿™ä¸ªæœåŠ¡æ— æ³•è®¿é—®ï¼Œä»–è‚¯å®šä¼šå»å…¶ä»–ä½ç½®æ–°å¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼Œé€šè¿‡serviceçš„IPä¾æ—§å¯ä»¥æ‰¾åˆ°è¿™ä¸ªæ–°å»ºçš„æœåŠ¡</li></ul></blockquote><h2 id="4-Volume"><a href="#4-Volume" class="headerlink" title="4 Volume"></a>4 <strong>Volume</strong></h2><p>Volumeæ˜¯Podä¸­èƒ½å¤Ÿè¢«å¤šä¸ªå®¹å™¨è®¿é—®çš„å…±äº«ç›®å½•ï¼ŒKubernetesä¸­çš„Volumeæ˜¯å®šä¹‰åœ¨Podä¸Šï¼Œå¯ä»¥è¢«ä¸€ä¸ªæˆ–å¤šä¸ªPodä¸­çš„å®¹å™¨æŒ‚è½½åˆ°æŸä¸ªç›®å½•ä¸‹</p><h2 id="5-Namespace"><a href="#5-Namespace" class="headerlink" title="5 Namespace"></a>5 <strong>Namespace</strong></h2><p>Namespaceç”¨äºå®ç°å¤šç§Ÿæˆ·çš„èµ„æºéš”ç¦»ï¼Œå¯å°†é›†ç¾¤å†…éƒ¨çš„èµ„æºå¯¹è±¡åˆ†é…åˆ°ä¸åŒçš„Namespaceä¸­ï¼Œå½¢æˆé€»è¾‘ä¸Šçš„ä¸åŒé¡¹ç›®ã€å°ç»„æˆ–ç”¨æˆ·ç»„ï¼Œä¾¿äºä¸åŒçš„Namespaceåœ¨å…±äº«ä½¿ç”¨æ•´ä¸ªé›†ç¾¤çš„èµ„æºçš„åŒæ—¶è¿˜èƒ½è¢«åˆ†åˆ«ç®¡ç†ï¼›</p><h1 id="4-K8sçš„ç»„ä»¶æœ‰å“ªäº›ï¼Ÿä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#4-K8sçš„ç»„ä»¶æœ‰å“ªäº›ï¼Ÿä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="4. K8sçš„ç»„ä»¶æœ‰å“ªäº›ï¼Ÿä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"></a>4. <strong>K8sçš„ç»„ä»¶æœ‰å“ªäº›ï¼Ÿä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h1><p>K8séœ€è¦ä¸€ä¸ªé›†ç¾¤æ¥è¿è¡Œå’Œç®¡ç†å®¹å™¨åŒ–åº”ç”¨ç¨‹åºã€‚Kubernetes é›†ç¾¤ç”±å¤šä¸ªè®¡ç®—èŠ‚ç‚¹ç»„æˆï¼Œå…¶ä¸­åŒ…æ‹¬ä¸»èŠ‚ç‚¹ï¼ˆMaster Nodeï¼‰å’Œä»èŠ‚ç‚¹ï¼ˆWorker Nodeï¼‰ã€‚</p><ul><li><p>ä¸»èŠ‚ç‚¹è´Ÿè´£ç®¡ç†æ•´ä¸ªé›†ç¾¤çš„ï¼Œå®‰è£…äº†K8sçš„æ ¸å¿ƒç»„ä»¶ã€‚</p></li><li><p>ä»èŠ‚ç‚¹æ˜¯å®¹å™¨åº”ç”¨çœŸæ­£è¿è¡Œçš„åœ°æ–¹ã€‚</p><ul><li>ä»èŠ‚ç‚¹ï¼ˆWorker Nodeï¼‰ä¸Šçš„å®¹å™¨åŒ–ç¯å¢ƒä¸€èˆ¬æ˜¯é€šè¿‡ Docker è¿è¡Œçš„ã€‚</li><li>æ¯ä¸ª Worker Node ä¸Šå¯ä»¥è¿è¡Œå¤šä¸ªå®¹å™¨ï¼Œ å…¶ä¸­æ¯ä¸ªå®¹å™¨éƒ½å¯ä»¥æ‰˜ç®¡ä¸€ä¸ªæˆ–å¤šä¸ª Podã€‚</li></ul></li><li><p>masterèŠ‚ç‚¹åŒ…å«çš„ç»„ä»¶æœ‰ï¼škube-api-serverã€kube-controller-managerã€kube-schedulerã€etcd</p></li><li><p>nodeèŠ‚ç‚¹åŒ…å«çš„ç»„ä»¶æœ‰ï¼škubeletã€kube-proxyã€container-runtime</p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250701214938688.png" alt="image-20250701214938688"></p><h2 id="1-Master-Nodeçš„ç»„ä»¶"><a href="#1-Master-Nodeçš„ç»„ä»¶" class="headerlink" title="1  Master Nodeçš„ç»„ä»¶"></a>1  <strong>Master Node</strong>çš„ç»„ä»¶</h2><h3 id="1-kube-API-Server"><a href="#1-kube-API-Server" class="headerlink" title="1. kube API Server"></a>1. <strong>kube API Server</strong></h3><ul><li><p><strong>K8S çš„è¯·æ±‚å…¥å£æœåŠ¡</strong>ã€‚</p></li><li><p>å®ƒæ˜¯k8sé›†ç¾¤ç®¡ç†çš„ç»Ÿä¸€è®¿é—®å…¥å£ï¼Œæ¥æ”¶ K8S æ‰€æœ‰è¯·æ±‚ï¼Œå®ç°äº†è®¤è¯ã€æˆæƒå’Œå‡†å…¥æ§åˆ¶ç­‰å®‰å…¨åŠŸèƒ½ï¼›</p></li><li><p>API Server æ ¹æ®ç”¨æˆ·çš„å…·ä½“è¯·æ±‚ï¼Œå»é€šçŸ¥å…¶ä»–ç»„ä»¶å¹²æ´»ã€‚</p></li><li><p>api-serveræ˜¯å…¶ä»–ç»„ä»¶ä¹‹é—´çš„æ•°æ®äº¤äº’å’Œé€šä¿¡çš„æ¢çº½ï¼Œå…¶ä»–ç»„ä»¶å½¼æ­¤ä¹‹é—´å¹¶ä¸ä¼šç›´æ¥é€šä¿¡ï¼Œå…¶ä»–ç»„ä»¶å¯¹èµ„æºå¯¹è±¡çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥å’Œç›‘å¬æ“ä½œéƒ½æ˜¯äº¤ç”±api-serverå¤„ç†åï¼Œapi-serverå†æäº¤ç»™etcdæ•°æ®åº“åšæŒä¹…åŒ–å­˜å‚¨ï¼Œåªæœ‰api-serveræ‰èƒ½ç›´æ¥æ“ä½œetcdæ•°æ®åº“ï¼Œå…¶ä»–ç»„ä»¶éƒ½ä¸èƒ½ç›´æ¥æ“ä½œetcdæ•°æ®åº“ï¼Œå…¶ä»–ç»„ä»¶éƒ½æ˜¯é€šè¿‡api-serveré—´æ¥çš„è¯»å–ï¼Œå†™å…¥æ•°æ®åˆ°etcdã€‚</p></li></ul><h3 id="2-kube-Controller-Manager"><a href="#2-kube-Controller-Manager" class="headerlink" title="2. kube Controller Manager"></a>2. <strong>kube Controller Manager</strong></h3><ul><li><strong>k8sé›†ç¾¤å†…éƒ¨çš„ç®¡ç†æ§åˆ¶ä¸­å¿ƒ</strong>ï¼Œ ä»–æ˜¯Kubernetesçš„å¤§è„‘ï¼Œå®ƒé€šè¿‡apiserverç›‘æ§æ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€ï¼Œå¹¶ç¡®ä¿é›†ç¾¤å¤„äºé¢„æœŸçš„å·¥ä½œçŠ¶æ€ã€‚</li><li>kube-controller-managerç”±ä¸€ç³»åˆ—çš„æ§åˆ¶å™¨ç»„æˆï¼ŒåƒReplication Controlleræ§åˆ¶å‰¯æœ¬ï¼ŒNode ControllerèŠ‚ç‚¹æ§åˆ¶ï¼ŒDeployment Controllerç®¡ç†deploymentç­‰ç­‰</li><li>Controller è´Ÿè´£ç›‘æ§å’Œè°ƒæ•´åœ¨ Worker Node ä¸Šéƒ¨ç½²çš„æœåŠ¡çš„çŠ¶æ€ï¼Œæ¯”å¦‚ç”¨æˆ·è¦æ±‚ A æœåŠ¡éƒ¨ç½² 2 ä¸ªå‰¯æœ¬ï¼Œé‚£ä¹ˆå½“å…¶ä¸­ä¸€ä¸ªæœåŠ¡æŒ‚äº†çš„æ—¶å€™ï¼ŒController ä¼šé©¬ä¸Šè°ƒæ•´ï¼Œè®© Scheduler å†é€‰æ‹©ä¸€ä¸ª Worker Node é‡æ–°éƒ¨ç½²æœåŠ¡ã€‚</li></ul><h3 id="3-kube-Scheduler"><a href="#3-kube-Scheduler" class="headerlink" title="3. kube Scheduler"></a>3. <strong>kube Scheduler</strong></h3><ul><li><strong>K8S è´Ÿè´£é›†ç¾¤èµ„æºè°ƒåº¦çš„è°ƒåº¦å™¨</strong>ã€‚</li><li>å…¶ä½œç”¨æ˜¯å°†å¾…è°ƒåº¦çš„podé€šè¿‡ä¸€ç³»åˆ—å¤æ‚çš„è°ƒåº¦ç®—æ³•è®¡ç®—å‡ºæœ€åˆé€‚çš„nodeèŠ‚ç‚¹ï¼Œç„¶åå°†podç»‘å®šåˆ°ç›®æ ‡èŠ‚ç‚¹ä¸Šã€‚å½“ç”¨æˆ·è¦éƒ¨ç½²æœåŠ¡æ—¶ï¼ŒScheduler ä¼šé€‰æ‹©æœ€åˆé€‚çš„Worker Nodeï¼ˆæœåŠ¡å™¨ï¼‰æ¥éƒ¨ç½²ã€‚</li></ul><h3 id="4-etcd"><a href="#4-etcd" class="headerlink" title="4. etcd"></a>4. <strong>etcd</strong></h3><ul><li><strong>K8S çš„å­˜å‚¨æœåŠ¡ï¼Œ æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„é”®å€¼å¯¹å­˜å‚¨æ•°æ®åº“</strong>ã€‚</li><li>etcd å­˜å‚¨äº† K8S çš„å…³é”®é…ç½®å’Œç”¨æˆ·é…ç½®ï¼Œåƒk8sæœ¬èº«çš„èŠ‚ç‚¹ä¿¡æ¯ï¼Œç»„ä»¶ä¿¡æ¯ï¼Œè¿˜æœ‰é€šè¿‡kubernetesè¿è¡Œçš„podï¼Œdeploymentï¼Œserviceç­‰ç­‰, éƒ½éœ€è¦æŒä¹…åŒ–åˆ°etcã€‚</li><li>K8S ä¸­ä»… API Server æ‰å…·å¤‡è¯»å†™æƒé™ï¼Œå…¶ä»–ç»„ä»¶å¿…é¡»é€šè¿‡ API Server çš„æ¥å£æ‰èƒ½è¯»å†™æ•°æ®ã€‚</li><li>ç”Ÿäº§ç¯å¢ƒä¸­ä¸ºäº†ä¿è¯æ•°æ®ä¸­å¿ƒçš„é«˜å¯ç”¨å’Œæ•°æ®çš„ä¸€è‡´æ€§ï¼Œä¸€èˆ¬ä¼šéƒ¨ç½²æœ€å°‘ä¸‰ä¸ªèŠ‚ç‚¹ã€‚</li></ul><h2 id="2-Worker-Nodeçš„ç»„ä»¶"><a href="#2-Worker-Nodeçš„ç»„ä»¶" class="headerlink" title="2  Worker Nodeçš„ç»„ä»¶"></a>2  <strong>Worker Node</strong>çš„ç»„ä»¶</h2><h3 id="1-Kubelet"><a href="#1-Kubelet" class="headerlink" title="1.  Kubelet"></a>1.  <strong>Kubelet</strong></h3><ul><li><strong>Worker Node çš„ç›‘è§†å™¨ï¼Œä»¥åŠä¸ Master Node çš„é€šè®¯å™¨</strong>ã€‚</li><li>æ¯ä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œä¸€ä¸ªkubeletæœåŠ¡è¿›ç¨‹ï¼Œå®ƒä¼šå®šæœŸå‘ Master Node æ±‡æŠ¥è‡ªå·± Node ä¸Šè¿è¡Œçš„æœåŠ¡çš„çŠ¶æ€ï¼Œå¹¶æ¥æ”¶å¹¶æ‰§è¡Œmasterå‘æ¥çš„æŒ‡ä»¤ï¼Œç®¡ç†PodåŠPodä¸­çš„å®¹å™¨ã€‚æ¯”å¦‚åˆ›å»ºã€æ›´æ–°ã€ç»ˆæ­¢podç­‰ä»»åŠ¡ï¼Œkubelet å³é€šè¿‡æ§åˆ¶dockeræ¥åˆ›å»ºã€æ›´æ–°ã€é”€æ¯å®¹å™¨ã€‚</li></ul><h3 id="2-Kube-Proxy"><a href="#2-Kube-Proxy" class="headerlink" title="2. Kube-Proxy"></a>2. <strong>Kube-Proxy</strong></h3><ul><li><strong>K8S çš„ç½‘ç»œä»£ç†</strong>ã€‚Kube-Proxy è´Ÿè´£ Node åœ¨ K8S çš„ç½‘ç»œé€šè®¯ã€ä»¥åŠå¯¹å¤–éƒ¨ç½‘ç»œæµé‡çš„è´Ÿè½½å‡è¡¡ã€‚</li><li>æ ¸å¿ƒåŠŸèƒ½æ˜¯å°†åˆ°æŸä¸ªServiceçš„è®¿é—®è¯·æ±‚è½¬å‘åˆ°åç«¯çš„å¤šä¸ªPodå®ä¾‹ä¸Š</li></ul><h3 id="3-Container-Runtime"><a href="#3-Container-Runtime" class="headerlink" title="3. Container Runtime"></a>3. Container Runtime</h3><ul><li><strong>Worker Node çš„è¿è¡Œç¯å¢ƒ</strong>ã€‚å³å®‰è£…äº†å®¹å™¨åŒ–æ‰€éœ€çš„è½¯ä»¶ç¯å¢ƒç¡®ä¿å®¹å™¨åŒ–ç¨‹åºèƒ½å¤Ÿè·‘èµ·æ¥ï¼Œæ¯”å¦‚ Docker Engineè¿è¡Œç¯å¢ƒã€‚</li></ul><h2 id="3-å„ç»„ä»¶ååŒå·¥ä½œçš„è¿‡ç¨‹"><a href="#3-å„ç»„ä»¶ååŒå·¥ä½œçš„è¿‡ç¨‹" class="headerlink" title="3 å„ç»„ä»¶ååŒå·¥ä½œçš„è¿‡ç¨‹"></a>3 å„ç»„ä»¶ååŒå·¥ä½œçš„è¿‡ç¨‹</h2><p>ä»¥ç”¨K8Séƒ¨ç½²Nginxçš„è¿‡ç¨‹ä¸ºä¾‹, <strong>æˆ‘ä»¬åœ¨masterèŠ‚ç‚¹æ‰§è¡Œä¸€æ¡å‘½ä»¤è¦masteréƒ¨ç½²ä¸€ä¸ªnginxåº”ç”¨</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl create deployment nginx --image=nginx<br></code></pre></td></tr></table></figure><ol><li>è¿™æ¡å‘½ä»¤é¦–å…ˆå‘åˆ°masterèŠ‚ç‚¹çš„ç½‘å…³api serverï¼Œè¿™æ˜¯matserçš„å”¯ä¸€å…¥å£</li><li>kube api serverå°†å‘½ä»¤è¯·æ±‚äº¤ç»™kube controller mannagerè¿›è¡Œæ§åˆ¶</li><li>kube controller mannager è¿›è¡Œåº”ç”¨éƒ¨ç½²è§£æ.  controller mannager ä¼šç”Ÿæˆä¸€æ¬¡éƒ¨ç½²ä¿¡æ¯ï¼Œå¹¶é€šè¿‡api serverå°†ä¿¡æ¯å­˜å…¥etcdå­˜å‚¨ä¸­</li><li>kube schedulerè°ƒåº¦å™¨é€šè¿‡api serverä»etcdå­˜å‚¨ä¸­ï¼Œæ‹¿åˆ°è¦éƒ¨ç½²çš„åº”ç”¨ï¼Œå¼€å§‹è°ƒåº¦çœ‹å“ªä¸ªèŠ‚ç‚¹æœ‰èµ„æºé€‚åˆéƒ¨ç½²,   scheduleræŠŠè®¡ç®—å‡ºæ¥çš„è°ƒåº¦ä¿¡æ¯é€šè¿‡api serverå†æ”¾åˆ°etcdä¸­</li><li>æ¯ä¸€ä¸ªnodeèŠ‚ç‚¹çš„ç›‘æ§ç»„ä»¶kubeletï¼Œéšæ—¶å’Œmasterä¿æŒè”ç³»ï¼ˆç»™api-serverå‘é€è¯·æ±‚ä¸æ–­è·å–æœ€æ–°æ•°æ®ï¼‰ï¼Œæ‹¿åˆ°masterèŠ‚ç‚¹å­˜å‚¨åœ¨etcdä¸­çš„éƒ¨ç½²ä¿¡æ¯</li><li>å‡è®¾node2çš„kubeletæ‹¿åˆ°éƒ¨ç½²ä¿¡æ¯ï¼Œæ˜¾ç¤ºä»–è‡ªå·±èŠ‚ç‚¹è¦éƒ¨ç½²æŸæŸåº”ç”¨. kubeletå°±è‡ªå·±runä¸€ä¸ªåº”ç”¨åœ¨å½“å‰æœºå™¨ä¸Šï¼Œå¹¶éšæ—¶ç»™masteræ±‡æŠ¥å½“å‰åº”ç”¨çš„çŠ¶æ€ä¿¡æ¯,  nodeå’Œmasterä¹Ÿæ˜¯é€šè¿‡masterçš„api-serverç»„ä»¶è”ç³»çš„</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250713122653667.png" alt="image-20250713122653667"></p><h1 id="5-kubeletçš„åŠŸèƒ½ã€ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#5-kubeletçš„åŠŸèƒ½ã€ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="5. kubeletçš„åŠŸèƒ½ã€ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"></a>5. kubeletçš„åŠŸèƒ½ã€ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>kubeletæ˜¯éƒ¨ç½²åœ¨æ¯ä¸ªnodeèŠ‚ç‚¹ä¸Šçš„ï¼Œå®ƒä¸»è¦æœ‰4ä¸ªåŠŸèƒ½ï¼š</p><h2 id="1-èŠ‚ç‚¹ç®¡ç†"><a href="#1-èŠ‚ç‚¹ç®¡ç†" class="headerlink" title="1. èŠ‚ç‚¹ç®¡ç†"></a>1. èŠ‚ç‚¹ç®¡ç†</h2><p>kubeletå¯åŠ¨æ—¶ä¼šå‘api-serverè¿›è¡Œæ³¨å†Œï¼Œç„¶åä¼šå®šæ—¶çš„å‘api-serveræ±‡æŠ¥æœ¬èŠ‚ç‚¹ä¿¡æ¯çŠ¶æ€ï¼Œèµ„æºä½¿ç”¨çŠ¶æ€ç­‰ï¼Œè¿™æ ·masterå°±èƒ½å¤ŸçŸ¥é“nodeèŠ‚ç‚¹çš„èµ„æºå‰©ä½™ï¼ŒèŠ‚ç‚¹æ˜¯å¦å¤±è”ç­‰ç­‰ç›¸å…³çš„ä¿¡æ¯äº†ã€‚masterçŸ¥é“äº†æ•´ä¸ªé›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹çš„èµ„æºæƒ…å†µï¼Œè¿™å¯¹äº pod çš„è°ƒåº¦å’Œæ­£å¸¸è¿è¡Œè‡³å…³é‡è¦ã€‚</p><h2 id="2-podç®¡ç†"><a href="#2-podç®¡ç†" class="headerlink" title="2. podç®¡ç†"></a>2. podç®¡ç†</h2><p>kubeletè´Ÿè´£ç»´æŠ¤nodeèŠ‚ç‚¹ä¸Špodçš„ç”Ÿå‘½å‘¨æœŸï¼Œå½“kubeletç›‘å¬åˆ°masterçš„ä¸‹å‘åˆ°è‡ªå·±èŠ‚ç‚¹çš„ä»»åŠ¡æ—¶ï¼Œæ¯”å¦‚è¦åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ä¸€ä¸ªpodï¼Œkubelet å°±ä¼šé€šè¿‡CRIï¼ˆå®¹å™¨è¿è¡Œæ—¶æ¥å£ï¼‰æ’ä»¶æ¥è°ƒç”¨ä¸åŒçš„å®¹å™¨è¿è¡Œæ—¶æ¥åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤å®¹å™¨ï¼›</p><h2 id="3-å®¹å™¨å¥åº·æ£€æŸ¥"><a href="#3-å®¹å™¨å¥åº·æ£€æŸ¥" class="headerlink" title="3. å®¹å™¨å¥åº·æ£€æŸ¥"></a>3. å®¹å™¨å¥åº·æ£€æŸ¥</h2><p>podä¸­å¯ä»¥å®šä¹‰å¯åŠ¨æ¢é’ˆã€å­˜æ´»æ¢é’ˆã€å°±ç»ªæ¢é’ˆç­‰3ç§ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨çš„å°±æ˜¯å­˜æ´»æ¢é’ˆã€å°±ç»ªæ¢é’ˆï¼Œkubelet ä¼šå®šæœŸè°ƒç”¨å®¹å™¨ä¸­çš„æ¢é’ˆæ¥æ£€æµ‹å®¹å™¨æ˜¯å¦å­˜æ´»ï¼Œæ˜¯å¦å°±ç»ªï¼Œå¦‚æœæ˜¯å­˜æ´»æ¢é’ˆï¼Œåˆ™ä¼šæ ¹æ®æ¢æµ‹ç»“æœå¯¹æ£€æŸ¥å¤±è´¥çš„å®¹å™¨è¿›è¡Œç›¸åº”çš„é‡å¯ç­–ç•¥ã€‚</p><h2 id="4-Metrics-Serverèµ„æºç›‘æ§"><a href="#4-Metrics-Serverèµ„æºç›‘æ§" class="headerlink" title="4. Metrics Serverèµ„æºç›‘æ§"></a>4. Metrics Serverèµ„æºç›‘æ§</h2><p>åœ¨nodeèŠ‚ç‚¹ä¸Šéƒ¨ç½²Metrics Serverç”¨äºç›‘æ§nodeèŠ‚ç‚¹ã€podçš„CPUã€å†…å­˜ã€æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œä½¿ç”¨ç­‰èµ„æºä½¿ç”¨æƒ…å†µï¼Œè€Œkubeletåˆ™é€šè¿‡Metrics Serverè·å–æ‰€åœ¨èŠ‚ç‚¹åŠå®¹å™¨çš„ä¸Šçš„æ•°æ®ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>PPTè®¾è®¡æ€ç»´</title>
    <link href="/PPT%E8%AE%BE%E8%AE%A1%E6%80%9D%E7%BB%B4/"/>
    <url>/PPT%E8%AE%BE%E8%AE%A1%E6%80%9D%E7%BB%B4/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä¸¢æ‰é»˜è®¤"><a href="#1-ä¸¢æ‰é»˜è®¤" class="headerlink" title="1.  ä¸¢æ‰é»˜è®¤"></a>1.  ä¸¢æ‰é»˜è®¤</h1><h2 id="1-ç•™ç™½"><a href="#1-ç•™ç™½" class="headerlink" title="1. ç•™ç™½"></a>1. ç•™ç™½</h2><ul><li><p>é¢å¯¹é»˜è®¤çš„ç‰ˆé¢å’Œæ¨¡ç‰ˆï¼Œæ³¨æ„æ£€æŸ¥ç•™ç™½ï¼Œé€šå¸¸éƒ½ä¼šå‘ç°ç•™ç™½å¤ªå°‘</p></li><li><p>ç•™ç™½è¦é€‚å½“ï¼Œä¸æ˜¯è¶Šå¤§è¶Šå¥½ï¼Œä½†é€šå¸¸æ˜¯å¤§ç•™ç™½æ¯”è¾ƒå¥½é©¾é©­ï¼Œå°¤å…¶å†…å®¹ä¸å¤šçš„æ—¶å€™</p></li><li><p>ä¸è¦åœ¨ä¸€é¡µå¹»ç¯ç‰‡å †ç Œå¾ˆå¤šçš„å†…å®¹ï¼Œä¸è¦è®©å¹»ç¯ç‰‡çœ‹èµ·æ¥å¾ˆæ»¡ï¼Œæ»¡å°±æ˜¯æŒ¤ï¼Œçœ¼ç›é‡Œè¦æ³¨æ„çš„å†…å®¹å¤ªå¤šï¼Œè§†è§‰å°±å®¹æ˜“ç´§å¼ </p></li><li><p>ç”šè‡³ï¼Œä¸€é¡µå¹»ç¯ç‰‡è¶Šå°‘è¶Šå®¹æ˜“è®¾è®¡ï¼Œè¶Šç©ºè¶Šå®¹æ˜“æ’ç‰ˆ</p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250624205531116.png" alt="image-20250624205531116"></p><h2 id="2-è¡Œè·"><a href="#2-è¡Œè·" class="headerlink" title="2. è¡Œè·"></a>2. è¡Œè·</h2><ul><li>å½“ä½ æ’å…¥äº†æˆ–è€…é¢å¯¹ä¸€æ®µé»˜è®¤çš„æ–‡æœ¬æ¡†&#x2F;æ–‡å­—ï¼Œæ³¨æ„è§‚å¯Ÿè¡Œè·æ˜¯å¦æ‹¥æŒ¤</li><li>å¤§æ®µæ–‡å­—ï¼ˆ3è¡Œä»¥ä¸Šï¼‰ï¼Œä¸€èˆ¬<strong>1.2-1.5</strong>çš„å•å€è¡Œè·æ¯”è¾ƒèˆ’é€‚ï¼Œæ ¹æ®ä¸åŒçš„å­—ä½“å­—å·ï¼Œéœ€è¦è‡ªè¡Œå°è¯•</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250624211146300.png" alt="image-20250624211146300"></p><h2 id="3-æ®µè·"><a href="#3-æ®µè·" class="headerlink" title="3. æ®µè·"></a>3. æ®µè·</h2><ul><li>å½“ä½ æ’å…¥æˆ–è€…é¢å¯¹2æ®µä»¥ä¸Šçš„æ–‡å­—ï¼Œæ³¨æ„ä¸åŒæ®µè½ä¹‹é—´ï¼Œæ˜¯å¦è¿‡äºç´§å‡‘</li><li>å¤§æ®µçš„æ–‡å­—ï¼Œä¸€èˆ¬éœ€è¦åˆ†å¼€å±‚æ¬¡å’Œé—´éš”ï¼Œä»¥ç¼“è§£è§†è§‰èˆ’é€‚</li><li>å¦‚æœå¯¹å†…å®¹è¿›è¡Œäº†åˆ†ç±»ã€åˆ†å±‚ã€ç‰‡åŒºï¼Œåˆ™è¿™äº›åˆ†ç±»ã€å±‚æ¬¡ã€ç‰‡åŒºä¹‹é—´çš„é—´éš”ï¼Œé€šå¸¸åº”è¯¥æ˜æ˜¾çš„å¤§äºå…¶å†…éƒ¨çš„é—´éš”åˆ†åŒºå†…éƒ¨é ç´§ä¸€ç‚¹ï¼Œè¡¨ç¤ºä»–ä»¬å†å…³ç³»ä¸Šçš„ç›¸è¿‘ï¼Œæ˜¯â€œä¸€å›½çš„â€ã€‚</li><li>æ ‡é¢˜éƒ¨åˆ†å’Œå†…å®¹éƒ¨åˆ†å¤©ç„¶å°±æ˜¯ä¸åŒçš„å±‚æ¬¡ï¼Œé€šå¸¸åº”è¯¥æœ‰æ˜æ˜¾çš„é—´éš”åŒºåˆ†;</li><li>è¡Œé—´è·&lt;åˆ†åŒºå†…æ®µè½é—´è·&lt;å°æ ‡é¢˜åˆ°æ­£æ–‡é—´è·&lt;åˆ†åŒºé—´è·&lt;å¤§æ ‡é¢˜åˆ°æ•´ä½“å†…å®¹é—´è·&lt;é¡µé¢ç•™ç™½</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250624212432602.png" alt="image-20250624212432602"></p><h2 id="4-è·ç¦»å¤ªå¤§"><a href="#4-è·ç¦»å¤ªå¤§" class="headerlink" title="4. è·ç¦»å¤ªå¤§"></a>4. è·ç¦»å¤ªå¤§</h2><ul><li>è·ç¦»ä¹Ÿæœ‰å¯èƒ½è¿‡å¤§è€Œæ¾æ•£ã€å•è–„æˆ–ç©ºè™šï¼Œå°±éœ€è¦åè¿‡æ¥ï¼Œé€‚å½“çš„æ¶ˆå‡é—´è·å’Œç‰ˆé¢ç©ºç™½ï¼Œå¢åŠ å†…å®¹å ä½</li><li>æ–¹æ³•ï¼š<ul><li>å¢å¤§å­—ä½“</li><li>æ”¾å¤§å†…å®¹</li><li>å¢è¡¥å†…å®¹</li><li>è¡¬åº•è¡¥ä½</li><li>ä¿®é¥°è¡¥ä½</li><li>å›¾ç‰‡è¡¥ä½</li><li>å†…å®¹å›¾å½¢åŒ–</li></ul></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250624213712962.png" alt="image-20250624213712962"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250624214028136.png" alt="image-20250624214028136"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250624214102485.png" alt="image-20250624214102485"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250624214126758.png" alt="image-20250624214126758"></p><h2 id="5-å­—ä½“"><a href="#5-å­—ä½“" class="headerlink" title="5. å­—ä½“"></a>5. å­—ä½“</h2><ul><li>æ°å½“çš„å­—ä½“ï¼šæ³¨æ„æ”¶é›†å­—ä½“çš„ç´ æï¼Œå„ç§ç±»å‹çš„å­—ä½“éƒ½å¯ä»¥å‚¨å¤‡ä¸€äº›;ä¸ç¡®å®šä»€ä¹ˆæ ·çš„å­—ä½“åˆé€‚ï¼Œå¯ä»¥å¤šæ¢ä¸€ä¸‹è¯•è¯•çœ‹;</li><li>å®‰å…¨çš„å­—ä½“ï¼šä¸€èˆ¬å¹»ç¯ç‰‡éƒ½å¯ä»¥ä½¿ç”¨å¾®è½¯é›…é»‘ï¼Œæ˜¯éå¸¸å®‰å…¨çš„å­—ä½“å¤§æ®µçš„æ–‡å­—ï¼Œä¸€èˆ¬çš„å°åˆ·å­—ä½“(å®‹ä½“å’Œæ¥·ä½“)ä¹Ÿæ¯”è¾ƒå®‰å…¨ã€‚2016ç‰ˆæœ¬æ–°å‡ºçš„ç­‰çº¿å­—ä½“ä¹Ÿéå¸¸çš„å®‰å…¨(æœ¬è¯¾ä»¶çš„å­—ä½“å°±æ˜¯ç­‰çº¿)</li><li>å‹æƒ…æç¤ºï¼šä¸€é¡µå¹»ç¯ç‰‡é‡Œä¸è¦ä½¿ç”¨è¿‡å¤šçš„å­—ä½“ï¼Œæœ€å¥½å°±åªç”¨1-2ç§å­—ä½“è¶Šæ˜¯ä¸ªæ€§çš„å­—ä½“ï¼Œè¶Šæ˜¯è¦è°¨æ…çš„å°‘é‡ä½¿ç”¨ï¼Œå¤§é‡ä½¿ç”¨ä¸€èˆ¬ä¼šæ¯”è¾ƒèŠ±ã€‚</li><li>é»˜è®¤çš„å¤§å¤šæ•°é—®é¢˜ï¼Œæ˜¯å­—ä½“å­—å·è¿‡å¤§ï¼Œä½“ç§¯å ä½è¿‡å¤§ï¼Œå¯¼è‡´å†…éƒ¨å•ä½ä¹‹é—´çš„é—´éš”æ¯”è¾ƒå°ï¼Œæ•´ä½“ç•™ç™½ä¸è¶³ï¼Œäº§ç”Ÿçš„ä¸åè°ƒæ„Ÿå—ã€‚</li></ul><h2 id="6-æ¡ˆä¾‹å¯¹æ¯”"><a href="#6-æ¡ˆä¾‹å¯¹æ¯”" class="headerlink" title="6. æ¡ˆä¾‹å¯¹æ¯”"></a>6. æ¡ˆä¾‹å¯¹æ¯”</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250624214729393.png" alt="image-20250624214729393"></p><h1 id="2-æ—¶é—´è½´åˆ¶ä½œè¦ç‚¹"><a href="#2-æ—¶é—´è½´åˆ¶ä½œè¦ç‚¹" class="headerlink" title="2. æ—¶é—´è½´åˆ¶ä½œè¦ç‚¹"></a>2. æ—¶é—´è½´åˆ¶ä½œè¦ç‚¹</h1><ol><li>æœ¬è´¨ï¼šç‚¹ã€çº¿ã€å†…å®¹</li><li>å¯è§†åŒ–ï¼šå›¾ç‰‡ã€å›¾æ ‡ã€èƒŒæ™¯</li><li>åˆ¶ä½œè¦ç‚¹ï¼šå±‚çº§åŒºåˆ†ã€ä¸è®¾ç»ˆç‚¹ã€åªå‡ä¸é™</li></ol>]]></content>
    
    
    <categories>
      
      <category>PPTé«˜æ‰‹ä¹‹è·¯</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>PPTæ–‡å­—å¤ªå°‘ç¾åŒ–</title>
    <link href="/PPT%E6%96%87%E5%AD%97%E5%A4%AA%E5%B0%91%E7%BE%8E%E5%8C%96/"/>
    <url>/PPT%E6%96%87%E5%AD%97%E5%A4%AA%E5%B0%91%E7%BE%8E%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ ¹æ®æ¼”è®²åˆ å‡å†…å®¹"><a href="#1-æ ¹æ®æ¼”è®²åˆ å‡å†…å®¹" class="headerlink" title="1. æ ¹æ®æ¼”è®²åˆ å‡å†…å®¹"></a>1. æ ¹æ®æ¼”è®²åˆ å‡å†…å®¹</h1><p>åªä¿ç•™å…³é”®çš„å†…å®¹è¿›è¡Œæ’ç‰ˆï¼Œä¸é‡è¦çš„å†…å®¹é€šè¿‡æ¼”è®²è€…å£è¿°</p><ul><li>æ”¹é€ å‰ï¼š</li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622170127090.png" alt="image-20250622170127090" style="zoom:50%;" /><ul><li>æ”¹é€ å</li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622170228451.png" alt="image-20250622170228451" style="zoom:50%;" /><h1 id="2-æ— ä¸­ç”Ÿæœ‰"><a href="#2-æ— ä¸­ç”Ÿæœ‰" class="headerlink" title="2. æ— ä¸­ç”Ÿæœ‰"></a>2. æ— ä¸­ç”Ÿæœ‰</h1><h2 id="1-æç‚¼å…³é”®çš„ä¸­æ–‡è¿›è¡Œå¼ºè°ƒ"><a href="#1-æç‚¼å…³é”®çš„ä¸­æ–‡è¿›è¡Œå¼ºè°ƒ" class="headerlink" title="1. æç‚¼å…³é”®çš„ä¸­æ–‡è¿›è¡Œå¼ºè°ƒ"></a>1. æç‚¼å…³é”®çš„ä¸­æ–‡è¿›è¡Œå¼ºè°ƒ</h2><ul><li>æ”¹é€ å‰</li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622170433359.png" alt="image-20250622170433359" style="zoom:50%;" /><ul><li>æ”¹é€ å</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622170529224.png" alt="image-20250622170529224"></p><h2 id="2-å¢åŠ å¯¹åº”å†…å®¹ä¸°å¯Œé¡µé¢"><a href="#2-å¢åŠ å¯¹åº”å†…å®¹ä¸°å¯Œé¡µé¢" class="headerlink" title="2. å¢åŠ å¯¹åº”å†…å®¹ä¸°å¯Œé¡µé¢"></a>2. å¢åŠ å¯¹åº”å†…å®¹ä¸°å¯Œé¡µé¢</h2><ul><li>æ”¹é€ å‰</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622170629797.png" alt="image-20250622170629797"></p><ul><li>æ”¹é€ å</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622170711786.png" alt="image-20250622170711786"></p><h2 id="3-å¢åŠ è‹±æ–‡æ–‡æ¡ˆ"><a href="#3-å¢åŠ è‹±æ–‡æ–‡æ¡ˆ" class="headerlink" title="3. å¢åŠ è‹±æ–‡æ–‡æ¡ˆ"></a>3. å¢åŠ è‹±æ–‡æ–‡æ¡ˆ</h2><ul><li>æ”¹é€ å‰</li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622170751418.png" alt="image-20250622170751418" style="zoom:50%;" /><ul><li>æ”¹é€ å</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622170818946.png" alt="image-20250622170818946"></p><h1 id="3-æé«˜â€œå›¾ç‰ˆç‡â€"><a href="#3-æé«˜â€œå›¾ç‰ˆç‡â€" class="headerlink" title="3. æé«˜â€œå›¾ç‰ˆç‡â€"></a>3. æé«˜â€œå›¾ç‰ˆç‡â€</h1><h2 id="1-å¢åŠ å›¾ç‰‡"><a href="#1-å¢åŠ å›¾ç‰‡" class="headerlink" title="1. å¢åŠ å›¾ç‰‡"></a>1. å¢åŠ å›¾ç‰‡</h2><h2 id="2-å¢åŠ è‰²å—"><a href="#2-å¢åŠ è‰²å—" class="headerlink" title="2. å¢åŠ è‰²å—"></a>2. å¢åŠ è‰²å—</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622170904451.png" alt="image-20250622170904451"></p><h2 id="3-å¢åŠ çº¿æ®µ"><a href="#3-å¢åŠ çº¿æ®µ" class="headerlink" title="3. å¢åŠ çº¿æ®µ"></a>3. å¢åŠ çº¿æ®µ</h2><p>æ”¹é€ å®Œæˆåï¼Œçº¿æ®µä¼šæ’‘å¼€æ•´ä½“å†…å®¹æ‰€å é¢ç§¯</p><ul><li>æ”¹é€ å‰</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622170927217.png" alt="image-20250622170927217"></p><ul><li>æ”¹é€ å</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171005154.png" alt="image-20250622171005154"></p><h2 id="4-å¢åŠ æ–‡å­—å›¾å½¢å æ¯”"><a href="#4-å¢åŠ æ–‡å­—å›¾å½¢å æ¯”" class="headerlink" title="4. å¢åŠ æ–‡å­—å›¾å½¢å æ¯”"></a>4. å¢åŠ æ–‡å­—å›¾å½¢å æ¯”</h2><p>æ”¾å¤§éƒ¨åˆ†æ–‡å­—å†…å®¹ï¼Œæ”¹é€ å­—ä½“æ ·å¼</p><ul><li>æ”¹é€ å‰</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171135415.png" alt="image-20250622171135415"></p><ul><li>æ”¹é€ å</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171216067.png" alt="image-20250622171216067"></p><ul><li>æ”¹é€ å‰</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171243083.png" alt="image-20250622171243083"></p><ul><li>æ”¹é€ å</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171307159.png" alt="image-20250622171307159"></p><h2 id="5-è®¤ä¸ºåˆ¶é€ è§†è§‰ç„¦ç‚¹"><a href="#5-è®¤ä¸ºåˆ¶é€ è§†è§‰ç„¦ç‚¹" class="headerlink" title="5. è®¤ä¸ºåˆ¶é€ è§†è§‰ç„¦ç‚¹"></a>5. è®¤ä¸ºåˆ¶é€ è§†è§‰ç„¦ç‚¹</h2><h3 id="1-åºå·"><a href="#1-åºå·" class="headerlink" title="1. åºå·"></a>1. åºå·</h3><ul><li>å‰</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171541209.png" alt="image-20250622171541209"></p><ul><li>å</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171603487.png" alt="image-20250622171603487"></p><h3 id="2-ç€é‡è‰²å—"><a href="#2-ç€é‡è‰²å—" class="headerlink" title="2. ç€é‡è‰²å—"></a>2. ç€é‡è‰²å—</h3><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171636849.png" alt="image-20250622171636849"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171653273.png" alt="image-20250622171653273"></p><h3 id="3-å›¾æ ‡"><a href="#3-å›¾æ ‡" class="headerlink" title="3. å›¾æ ‡"></a>3. å›¾æ ‡</h3><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171704235.png" alt="image-20250622171704235"></p><h2 id="6-å¡ç‰‡å¼è®¾è®¡"><a href="#6-å¡ç‰‡å¼è®¾è®¡" class="headerlink" title="6. å¡ç‰‡å¼è®¾è®¡"></a>6. å¡ç‰‡å¼è®¾è®¡</h2><p>å…ˆåšæç‚¼ï¼Œå†åšå¡ç‰‡å¼è®¾è®¡</p><ul><li>å‰</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171728628.png" alt="image-20250622171728628"></p><ul><li>å</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171749555.png" alt="image-20250622171749555"></p><h2 id="7-ç»¼åˆä½¿ç”¨"><a href="#7-ç»¼åˆä½¿ç”¨" class="headerlink" title="7. ç»¼åˆä½¿ç”¨"></a>7. ç»¼åˆä½¿ç”¨</h2><ul><li>å‰</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171846471.png" alt="image-20250622171846471"></p><ul><li>å</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250622171915982.png" alt="image-20250622171915982"></p>]]></content>
    
    
    <categories>
      
      <category>PPTé«˜æ‰‹ä¹‹è·¯</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>PPTé…è‰²çš„æ–¹æ³•</title>
    <link href="/PPT%E9%85%8D%E8%89%B2%E7%9A%84%E6%96%B9%E6%B3%95/"/>
    <url>/PPT%E9%85%8D%E8%89%B2%E7%9A%84%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å››å¤§é…è‰²æ–¹æ¡ˆ"><a href="#1-å››å¤§é…è‰²æ–¹æ¡ˆ" class="headerlink" title="1. å››å¤§é…è‰²æ–¹æ¡ˆ"></a>1. å››å¤§é…è‰²æ–¹æ¡ˆ</h1><h2 id="1-å•è‰²ç³»"><a href="#1-å•è‰²ç³»" class="headerlink" title="1. å•è‰²ç³»"></a>1. å•è‰²ç³»</h2><ol><li>å®šä¹‰ï¼šä»»é€‰ä¸€ä¸ªå½©è‰²ä¸é»‘ç™½ç°è¿›è¡Œæ­é…</li></ol><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250620201957934.png" alt="image-20250620201957934" style="zoom:50%;" /><ol start="2"><li>ä½¿ç”¨ï¼šå½©è‰²ä¸€å®šæ˜¯æ”¾åœ¨é‡è¦çš„ä½ç½®ä¸Š</li><li>å…·ä½“åœºæ™¯</li></ol><ul><li>å•çº¯ç½—åˆ—</li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250620202918477.png" alt="image-20250620202918477" style="zoom:50%;" /><ul><li>å¼ºè°ƒæŸä¸€ä¸ª</li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250620202938635.png" alt="image-20250620202938635" style="zoom:50%;" /><h2 id="2-åŒè‰²ç³»"><a href="#2-åŒè‰²ç³»" class="headerlink" title="2. åŒè‰²ç³»"></a>2. åŒè‰²ç³»</h2><ol><li>å®šä¹‰ï¼šåœ¨åŒè‰²ç³»ä¸­ä»»é€‰3-4ä¸ªï¼Œä¸é»‘ç™½ç°è¿›è¡Œæ­é…</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250620202048144.png" alt="image-20250620202048144"></p><h2 id="3-é‚»è¿‘è‰²"><a href="#3-é‚»è¿‘è‰²" class="headerlink" title="3. é‚»è¿‘è‰²"></a>3. é‚»è¿‘è‰²</h2><ol><li>å®šä¹‰ï¼šé‚»è¿‘è‰²ä¸é»‘ç™½ç°è¿›è¡Œæ­é…ï¼Œåšæ¸å˜ä¼šæ¯”è¾ƒè‡ªç„¶</li></ol><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250620202126505.png" alt="image-20250620202126505" style="zoom:50%;" /><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250620202146858.png" alt="image-20250620202146858" style="zoom:50%;" /><h2 id="4-å¯¹æ¯”è‰²"><a href="#4-å¯¹æ¯”è‰²" class="headerlink" title="4. å¯¹æ¯”è‰²"></a>4. å¯¹æ¯”è‰²</h2><ol><li>å®šä¹‰ï¼šå¯¹æ¯”è‰²ä¸é»‘ç™½ç°è¿›è¡Œæ­é…ï¼Œå¯¹æ¯”è‰²ç”¨æ¥å¼ºè°ƒæŸä¸€ä¸ªå†…å®¹</li></ol><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250620202220774.png" alt="image-20250620202220774" style="zoom:50%;" /><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250620202232350.png" alt="image-20250620202232350" style="zoom:50%;" /><ol start="2"><li>ä½¿ç”¨</li></ol><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250620204215469.png" alt="image-20250620204215469" style="zoom:50%;" /><h1 id="2-Color-Claim"><a href="#2-Color-Claim" class="headerlink" title="2.  Color Claim"></a>2.  Color Claim</h1><p>ç½‘ç«™åœ°å€:<a href="https://www.vanschneider.com/colors">https://www.vanschneider.com/colors</a></p><ul><li>æ¯”è¾ƒç‹¬ç‰¹çš„é…è‰²ï¼Œæœé›†äº†è¾ƒå¤šé…è‰²ï¼Œæ— éœ€ç¿»å¢™å³å¯ä½¿ç”¨</li><li>é…è‰²å¤šæ˜¯ä¸¤ç§é¢œè‰²ï¼Œé€‚åˆPPTåˆå­¦è€…</li><li>ç¼ºç‚¹æ˜¯é¢œè‰²åº“è¾ƒå°‘</li></ul>]]></content>
    
    
    <categories>
      
      <category>PPTé«˜æ‰‹ä¹‹è·¯</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>PPTå¸¸è§æ“ä½œ</title>
    <link href="/PPT%E5%B8%B8%E8%A7%81%E6%93%8D%E4%BD%9C/"/>
    <url>/PPT%E5%B8%B8%E8%A7%81%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ç»Ÿä¸€æ›´æ”¹PPTå­—ä½“"><a href="#1-ç»Ÿä¸€æ›´æ”¹PPTå­—ä½“" class="headerlink" title="1. ç»Ÿä¸€æ›´æ”¹PPTå­—ä½“"></a>1. ç»Ÿä¸€æ›´æ”¹PPTå­—ä½“</h1><p>è®¾è®¡ -ã€‹ å­—ä½“</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250619214803627.png" alt="image-20250619214803627"></p><h1 id="2-æ–‡å­—åœ¨å›¾ç‰‡é‡Œå±…ä¸­"><a href="#2-æ–‡å­—åœ¨å›¾ç‰‡é‡Œå±…ä¸­" class="headerlink" title="2. æ–‡å­—åœ¨å›¾ç‰‡é‡Œå±…ä¸­"></a>2. æ–‡å­—åœ¨å›¾ç‰‡é‡Œå±…ä¸­</h1><p>å½¢çŠ¶é‡Œç›´æ¥å¯ä»¥æ’å…¥æ–‡æœ¬ï¼Œæ›´æ”¹é¢œè‰²ï¼Œä¸éœ€è¦åœ¨å½¢çŠ¶é‡Œå†æ’å…¥æ–‡æœ¬æ¡†</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250619215105165.png" alt="image-20250619215105165"></p><h1 id="3-æ›´æ”¹å½¢çŠ¶"><a href="#3-æ›´æ”¹å½¢çŠ¶" class="headerlink" title="3. æ›´æ”¹å½¢çŠ¶"></a>3. æ›´æ”¹å½¢çŠ¶</h1><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250619215135658.png" alt="image-20250619215135658"></p>]]></content>
    
    
    <categories>
      
      <category>PPTé«˜æ‰‹ä¹‹è·¯</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>dockeréƒ¨ç½²javaæœåŠ¡è¸©å‘è®°å½•</title>
    <link href="/docker%E9%83%A8%E7%BD%B2java%E6%9C%8D%E5%8A%A1%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/"/>
    <url>/docker%E9%83%A8%E7%BD%B2java%E6%9C%8D%E5%8A%A1%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="1-java-net-UnknownHostException"><a href="#1-java-net-UnknownHostException" class="headerlink" title="1. java.net.UnknownHostException"></a>1. java.net.UnknownHostException</h1><h2 id="1-1-é—®é¢˜"><a href="#1-1-é—®é¢˜" class="headerlink" title="1.1. é—®é¢˜"></a>1.1. é—®é¢˜</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">InetAddress address = InetAddress.getLocalHost();<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°è¯•é€šè¿‡ <code>InetAddress.getHostAddress()</code> æ–¹æ³•è·å–ä¸»æœºåå¯¹åº”çš„Hoståœ°å€ã€‚å¦‚æœä¸»æœºåæ— æ³•è§£æï¼Œå°†æŠ›å‡º <code>UnknownHostException</code> å¼‚å¸¸ã€‚</p><p><strong>é”™è¯¯æ—¥å¿—æ—¥å¿—æˆªå›¾</strong></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/1750210808068-80321ab6-8263-419d-a28d-42d8abae6cc6.png" alt="img"></p><h2 id="1-2-è§£å†³"><a href="#1-2-è§£å†³" class="headerlink" title="1.2. è§£å†³"></a>1.2. è§£å†³</h2><p>ä¿®æ”¹hostsæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">vim /etc/hosts<br>10.108.200.83 ZJ-Test-Mycim<br></code></pre></td></tr></table></figure><h1 id="2-æ—¶åŒºæå‰äº†8å°æ—¶"><a href="#2-æ—¶åŒºæå‰äº†8å°æ—¶" class="headerlink" title="2. æ—¶åŒºæå‰äº†8å°æ—¶"></a>2. æ—¶åŒºæå‰äº†8å°æ—¶</h1><h2 id="2-1-é—®é¢˜"><a href="#2-1-é—®é¢˜" class="headerlink" title="2.1. é—®é¢˜"></a>2.1. é—®é¢˜</h2><ul><li>æ—¥å¿—æ—¶é—´æå‰äº†8å°æ—¶</li><li>ä¸šåŠ¡é€»è¾‘ä¸­ä½¿ç”¨äº†æ—¶é—´æ¯”è¾ƒçš„ä¼šæŠ¥é”™ï¼Œæ—¶é—´è¿˜æ²¡åˆ°</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">String currentTime = formatTime.format(new Date());<br></code></pre></td></tr></table></figure><h2 id="2-2-è§£å†³"><a href="#2-2-è§£å†³" class="headerlink" title="2.2. è§£å†³"></a>2.2. è§£å†³</h2><p>å¢åŠ æ—¶åŒºæ˜ å°„</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">-e TZ=Asia/Shanghai \<br>-v <span class="hljs-regexp">/etc/</span>localtime:<span class="hljs-regexp">/etc/</span>localtime:ro \<br></code></pre></td></tr></table></figure><h1 id="3-No-such-file-or-directory"><a href="#3-No-such-file-or-directory" class="headerlink" title="3. No such file or directory"></a>3. No such file or directory</h1><h2 id="3-1-é—®é¢˜"><a href="#3-1-é—®é¢˜" class="headerlink" title="3.1. é—®é¢˜"></a>3.1. é—®é¢˜</h2><p>æ–‡ä»¶åˆ›å»ºå¤±è´¥ï¼ŒæŠ¥é”™&#x2F;home&#x2F;oracle&#x2F;ftp&#x2F;e2feea11-7d6e-4e51-95d0-b51fc6f16d27.txt (No such file or directory)â€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">File fileOut = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;/home/oracle/ftp/&quot;</span>+txtUuid+<span class="hljs-string">&quot;.txt&quot;</span>);<br></code></pre></td></tr></table></figure><h2 id="3-2-è§£å†³"><a href="#3-2-è§£å†³" class="headerlink" title="3.2. è§£å†³"></a>3.2. è§£å†³</h2><p>å®¹å™¨é‡Œåˆ›å»ºäº†&#x2F;home&#x2F;oracle&#x2F;ftp&#x2F;ç›®å½•ï¼Œå¹¶ä¸”æ˜ å°„åˆ°äº†å®¿ä¸»æœº</p><h1 id="4-ä¸å…¶ä»–ç³»ç»Ÿé€šä¿¡å¤±è´¥"><a href="#4-ä¸å…¶ä»–ç³»ç»Ÿé€šä¿¡å¤±è´¥" class="headerlink" title="4. ä¸å…¶ä»–ç³»ç»Ÿé€šä¿¡å¤±è´¥"></a>4. ä¸å…¶ä»–ç³»ç»Ÿé€šä¿¡å¤±è´¥</h1><h2 id="4-1-é—®é¢˜"><a href="#4-1-é—®é¢˜" class="headerlink" title="4.1. é—®é¢˜"></a>4.1. é—®é¢˜</h2><p>æœåŠ¡è°ƒç”¨å¤±è´¥ï¼Œ ä¸è¯†åˆ«bridgeä¸‹çš„æœåŠ¡IP</p><h2 id="4-2-è§£å†³"><a href="#4-2-è§£å†³" class="headerlink" title="4.2. è§£å†³"></a>4.2. è§£å†³</h2><p>ä½¿ç”¨hostæ¨¡å¼å¯åŠ¨æœåŠ¡</p><h1 id="5-docker-in-docker-jenkins"><a href="#5-docker-in-docker-jenkins" class="headerlink" title="5. docker in docker (jenkins)"></a>5. docker in docker (jenkins)</h1><h2 id="5-1-é—®é¢˜"><a href="#5-1-é—®é¢˜" class="headerlink" title="5.1. é—®é¢˜"></a>5.1. é—®é¢˜</h2><p>åœ¨dockerå¯åŠ¨çš„Jenkinsé‡Œæ— æ³•è¯†åˆ«dockerå‘½ä»¤</p><h2 id="5-2-è§£å†³"><a href="#5-2-è§£å†³" class="headerlink" title="5.2 è§£å†³"></a>5.2 è§£å†³</h2><p>å¢åŠ æ˜ å°„</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">- <span class="hljs-regexp">/var/</span>run<span class="hljs-regexp">/docker.sock:/</span>var<span class="hljs-regexp">/run/</span>docker.sock<br>- <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/docker:/u</span>sr<span class="hljs-regexp">/bin/</span>docker<br>- <span class="hljs-regexp">/etc/</span>docker:<span class="hljs-regexp">/etc/</span>docker<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>docker</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>PPTç‰ˆå¼è®¾è®¡</title>
    <link href="/PPT%E7%89%88%E5%BC%8F%E8%AE%BE%E8%AE%A1/"/>
    <url>/PPT%E7%89%88%E5%BC%8F%E8%AE%BE%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="1-PPT-ç‰ˆå¼è®¾è®¡å››å¤§åŸåˆ™"><a href="#1-PPT-ç‰ˆå¼è®¾è®¡å››å¤§åŸåˆ™" class="headerlink" title="1. PPT ç‰ˆå¼è®¾è®¡å››å¤§åŸåˆ™"></a>1. PPT ç‰ˆå¼è®¾è®¡å››å¤§åŸåˆ™</h1><h2 id="1-å¯¹é½"><a href="#1-å¯¹é½" class="headerlink" title="1. å¯¹é½"></a>1. å¯¹é½</h2><ul><li><p>æ–¹å¼ï¼šä¸€ä¸»å¤šè¾…</p></li><li><p>å¸¸è§å¯¹é½æ–¹å¼ï¼š å·¦å¯¹é½ã€å³å¯¹é½ã€å±…ä¸­å¯¹é½ã€ä¸¤ç«¯å¯¹é½ã€åˆ†æ•£å¯¹é½</p></li></ul><h2 id="2-å¯¹æ¯”"><a href="#2-å¯¹æ¯”" class="headerlink" title="2. å¯¹æ¯”"></a>2. å¯¹æ¯”</h2><ul><li><p>æ–¹å¼ï¼š å¤§å°ã€é¢œè‰²ã€å½¢çŠ¶ã€ä½ç½®</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250615104121566.png" alt="image-20250615104121566" style="zoom:30%;" /></li><li><p>å®æ“</p><ul><li>ç¾åŒ–å‰</li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250615104507190.png" alt="image-20250615104507190" style="zoom:100%;" /> <ul><li>ç¾åŒ–åï¼š</li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250615104620941.png" alt="image-20250615104620941" style="zoom:100%;" /></li></ul><h2 id="3-é‡å¤-ç»Ÿä¸€"><a href="#3-é‡å¤-ç»Ÿä¸€" class="headerlink" title="3. é‡å¤(ç»Ÿä¸€)"></a>3. é‡å¤(ç»Ÿä¸€)</h2><ul><li>ç»Ÿä¸€PPTçš„é£æ ¼ï¼šä¿è¯å¤§æ–¹å‘ä¸å˜ã€å¯ä»¥æ”¹å˜ç»†èŠ‚å…ƒç´ <ul><li>é¢œè‰²ï¼ˆä¸»é¢˜è‰²ã€æ¸å˜è‰²ï¼‰</li><li>å­—ä½“ï¼ˆå­—ä½“å¤§å°ã€å­—ä½“è¡Œè·ã€å­—ä½“é¢œè‰²ã€ä½ç½®ï¼‰</li><li>æ ‡é¢˜æ ·å¼</li><li>å½¢çŠ¶ã€å½¢å¼ã€è´¨æ„Ÿã€æ˜äº®ã€è·ç¦»</li></ul></li></ul><h2 id="4-äº²å¯†"><a href="#4-äº²å¯†" class="headerlink" title="4. äº²å¯†"></a>4. äº²å¯†</h2><p>å…³ç³»è¿‘çš„ç¦»çš„è¿‘ï¼Œè¿œçš„ç¦»çš„è¿œ</p><ul><li>ç¾åŒ–å‰ï¼šåˆ†ä¸æ¸…å“ªä¸ªæ–‡æ¡ˆå¯¹å“ªä¸ªå›¾</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250615105426079.png" alt="image-20250615105426079"></p><ul><li>ç¾åŒ–å</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250615105540856.png" alt="image-20250615105540856"></p><h1 id="2-PPTæ•´å®¹ç¾åŒ–"><a href="#2-PPTæ•´å®¹ç¾åŒ–" class="headerlink" title="2.  PPTæ•´å®¹ç¾åŒ–"></a>2.  PPTæ•´å®¹ç¾åŒ–</h1><h2 id="2-islide-æ’ä»¶å®‰è£…"><a href="#2-islide-æ’ä»¶å®‰è£…" class="headerlink" title="2. islide æ’ä»¶å®‰è£…"></a>2. islide æ’ä»¶å®‰è£…</h2><ul><li>ä¸€é”®ç»Ÿä¸€å­—ä½“æ·»åŠ å‚è€ƒçº¿</li><li>æ¨¡æ¿å’Œä¸»é¢˜è¾ƒå¤šä¸°å¯Œçš„å›¾ç‰‡åº“å’Œè‰²å½©åº“è¡¥é—´åŠ¨ç”»ç­‰é«˜çº§åŠŸèƒ½</li><li>OFFICE2013åŠå…¶ä»¥ä¸Šç‰ˆæœ¬æ‰èƒ½å®‰è£…</li></ul>]]></content>
    
    
    <categories>
      
      <category>PPTé«˜æ‰‹ä¹‹è·¯</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ¯ç‰ˆä½¿ç”¨åŸç†åŠæŠ€å·§</title>
    <link href="/%E6%AF%8D%E7%89%88%E4%BD%BF%E7%94%A8%E5%8E%9F%E7%90%86%E5%8F%8A%E6%8A%80%E5%B7%A7/"/>
    <url>/%E6%AF%8D%E7%89%88%E4%BD%BF%E7%94%A8%E5%8E%9F%E7%90%86%E5%8F%8A%E6%8A%80%E5%B7%A7/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¯ç‰ˆåŸç†"><a href="#1-æ¯ç‰ˆåŸç†" class="headerlink" title="1. æ¯ç‰ˆåŸç†"></a>1. æ¯ç‰ˆåŸç†</h1><ol><li>åœ¨æ¯ç‰ˆçš„ç‰ˆå¼ä¸­æ‰€è®¾è®¡çš„å…ƒç´ ï¼Œä½¿ç”¨äº†ç›¸åŒç‰ˆå¼çš„PPTä¹Ÿä¼šå­˜åœ¨</li><li>åœ¨ä¸»æ¯ç‰ˆçš„å…ƒç´ ä¼šå½±å“å­æ¨¡ç‰ˆï¼Œåœ¨å­æ¨¡ç‰ˆä¹‹ä¸­çš„å…ƒç´ åªä¼šå•ç‹¬å­˜åœ¨</li></ol><h1 id="2-åº”ç”¨æŠ€å·§"><a href="#2-åº”ç”¨æŠ€å·§" class="headerlink" title="2. åº”ç”¨æŠ€å·§"></a>2. åº”ç”¨æŠ€å·§</h1><ol><li>æ‰¹é‡ä¿®æ”¹<ol><li>è°ƒæ•´LOGO </li><li>è°ƒæ•´æ ‡é¢˜</li><li>è°ƒæ•´å…ƒç´ </li></ol></li><li>è®¾ç½®å‚è€ƒçº¿ï¼šé¿å…ç›´æ¥åœ¨PPTè®¾ç½®ï¼Œå®¹æ˜“è¯¯è§¦ç¼–è¾‘</li><li>æ’å…¥æ–‡å­—&#x2F;å›¾ç‰‡å ä½ç¬¦</li></ol><h1 id="3-æ“ä½œ"><a href="#3-æ“ä½œ" class="headerlink" title="3. æ“ä½œ"></a>3. æ“ä½œ</h1><ol><li>ç‚¹å‡»PPTä¸Šæ–¹çš„è§†å›¾èœå•ï¼Œåœ¨å¼¹å‡ºçš„èœå•æ ï¼Œæ‰¾åˆ°å¹»ç¯ç‰‡æ¯ç‰ˆ</li></ol><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250610214928008.png" alt="image-20250610214928008" style="zoom:100%;" /><ol start="2"><li>æ ¹æ®éœ€æ±‚æ’å…¥æ–‡å­—æˆ–å›¾ç‰‡</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250610221951888.png" alt="image-20250610221951888"></p><ol start="3"><li>åœ¨ç‰ˆå¼é‡Œå¯ä»¥æŸ¥çœ‹å¹»ç¯ç‰‡æ¯ç‰ˆ</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250610222201924.png" alt="image-20250610222201924"></p>]]></content>
    
    
    <categories>
      
      <category>PPTé«˜æ‰‹ä¹‹è·¯</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¦»çº¿å®‰è£…docker</title>
    <link href="/%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85docker/"/>
    <url>/%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85docker/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä¸‹è½½Docker"><a href="#1-ä¸‹è½½Docker" class="headerlink" title="1. ä¸‹è½½Docker"></a>1. ä¸‹è½½Docker</h1><p>æ‰¾åˆ°ä¸€å°å¯ä»¥è”ç½‘çš„ CentOS æœºå™¨ï¼šç”¨äºä¸‹è½½ Docker åŠå…¶ä¾èµ–ã€‚</p><p>åœ°å€ï¼š<a href="https://download.docker.com/linux/static/stable/x86_64/">https://download.docker.com/linux/static/stable/x86_64/</a></p><h1 id="2-åˆ›å»ºä¸€ä¸ªç›®å½•æ¥å­˜æ”¾éœ€è¦çš„æ–‡ä»¶"><a href="#2-åˆ›å»ºä¸€ä¸ªç›®å½•æ¥å­˜æ”¾éœ€è¦çš„æ–‡ä»¶" class="headerlink" title="2. åˆ›å»ºä¸€ä¸ªç›®å½•æ¥å­˜æ”¾éœ€è¦çš„æ–‡ä»¶"></a>2. åˆ›å»ºä¸€ä¸ªç›®å½•æ¥å­˜æ”¾éœ€è¦çš„æ–‡ä»¶</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir docker-packages<br>cd docker-packages<br></code></pre></td></tr></table></figure><h1 id="3-å‡†å¤‡éœ€è¦çš„è„šæœ¬"><a href="#3-å‡†å¤‡éœ€è¦çš„è„šæœ¬" class="headerlink" title="3. å‡†å¤‡éœ€è¦çš„è„šæœ¬"></a>3. å‡†å¤‡éœ€è¦çš„è„šæœ¬</h1><h2 id="3-1-docker-service"><a href="#3-1-docker-service" class="headerlink" title="3.1. docker.service"></a>3.1. docker.service</h2><p>å°†å…¶ä¸­çš„ipåœ°å€ï¼Œæ”¹æˆæ‚¨çš„æœåŠ¡å™¨åœ°å€ï¼Œå…¶å®ƒå‚æ•°ä¸ç”¨æ”¹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs shell">[Unit]<br>Description=Docker Application Container Engine<br>Documentation=https://docs.docker.com<br>After=network-online.target firewalld.service<br>Wants=network-online.target<br> <br>[Service]<br>Type=notify<br><span class="hljs-meta">#</span><span class="bash"> the default is not to use systemd <span class="hljs-keyword">for</span> cgroups because the delegate issues still</span><br><span class="hljs-meta">#</span><span class="bash"> exists and systemd currently does not support the cgroup feature <span class="hljs-built_in">set</span> required</span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-keyword">for</span> containers run by docker</span><br>ExecStart=/usr/bin/dockerd --selinux-enabled=false --insecure-registry=172.28.49.13<br>ExecReload=/bin/kill -s HUP $MAINPID<br><span class="hljs-meta">#</span><span class="bash"> Having non-zero Limit*s causes performance problems due to accounting overhead</span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-keyword">in</span> the kernel. We recommend using cgroups to <span class="hljs-keyword">do</span> container-local accounting.</span><br>LimitNOFILE=infinity<br>LimitNPROC=infinity<br>LimitCORE=infinity<br><span class="hljs-meta">#</span><span class="bash"> Uncomment TasksMax <span class="hljs-keyword">if</span> your systemd version supports it.</span><br><span class="hljs-meta">#</span><span class="bash"> Only systemd 226 and above support this version.</span><br><span class="hljs-meta">#</span><span class="bash">TasksMax=infinity</span><br>TimeoutStartSec=0<br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">set</span> delegate yes so that systemd does not reset the cgroups of docker containers</span><br>Delegate=yes<br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">kill</span> only the docker process, not all processes <span class="hljs-keyword">in</span> the cgroup</span><br>KillMode=process<br><span class="hljs-meta">#</span><span class="bash"> restart the docker process <span class="hljs-keyword">if</span> it exits prematurely</span><br>Restart=on-failure<br>StartLimitBurst=3<br>StartLimitInterval=60s<br> <br>[Install]<br>WantedBy=multi-user.target<br></code></pre></td></tr></table></figure><h2 id="3-2-ä¸€é”®å®‰è£…è„šæœ¬"><a href="#3-2-ä¸€é”®å®‰è£…è„šæœ¬" class="headerlink" title="3.2.  ä¸€é”®å®‰è£…è„šæœ¬"></a>3.2.  ä¸€é”®å®‰è£…è„šæœ¬</h2><p>install.sh</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/sh</span><br> <br>echo &#x27;è§£å‹taråŒ…&#x27;<br>tar -xvf $1<br>echo &#x27;å°†dockerç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°/usr/binç›®å½•&#x27;<br>cp docker/* /usr/bin<br>echo &#x27;å°†docker.service å¤åˆ¶åˆ°/etc/systemd/system/ç›®å½•&#x27;<br>cp docker.service /etc/systemd/system/<br>echo &#x27;æ·»åŠ æ–‡ä»¶å¯æ‰§è¡Œæƒé™&#x27;<br>chmod +x /etc/systemd/system/docker.service<br>echo &#x27;é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶&#x27;<br>systemctl daemon-reload<br>echo &#x27;å¯åŠ¨docker&#x27;<br>systemctl start docker<br>echo &#x27;è®¾ç½®å¼€æœºè‡ªå¯&#x27;<br>systemctl enable docker.service<br>echo &#x27;dockerå®‰è£…æˆåŠŸ&#x27;<br>docker -v<br></code></pre></td></tr></table></figure><h2 id="3-3-ä¸€é”®å¸è½½è„šæœ¬"><a href="#3-3-ä¸€é”®å¸è½½è„šæœ¬" class="headerlink" title="3.3.  ä¸€é”®å¸è½½è„šæœ¬"></a>3.3.  ä¸€é”®å¸è½½è„šæœ¬</h2><p>uninstall.sh:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/sh</span><br> <br>echo &#x27;åœæ­¢docker&#x27;<br>systemctl stop docker<br>echo &#x27;åˆ é™¤docker.service&#x27;<br>rm -f /etc/systemd/system/docker.service<br>echo &#x27;åˆ é™¤dockeræ–‡ä»¶&#x27;<br>rm -rf /usr/bin/docker*<br>echo &#x27;é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶&#x27;<br>systemctl daemon-reload<br>echo &#x27;å¸è½½æˆåŠŸ&#x27;<br></code></pre></td></tr></table></figure><h1 id="4-ä¸Šä¼ æ–‡ä»¶å’Œå®‰è£…åŒ…åˆ°æœåŠ¡å™¨ä¸Š"><a href="#4-ä¸Šä¼ æ–‡ä»¶å’Œå®‰è£…åŒ…åˆ°æœåŠ¡å™¨ä¸Š" class="headerlink" title="4. ä¸Šä¼ æ–‡ä»¶å’Œå®‰è£…åŒ…åˆ°æœåŠ¡å™¨ä¸Š"></a>4. ä¸Šä¼ æ–‡ä»¶å’Œå®‰è£…åŒ…åˆ°æœåŠ¡å™¨ä¸Š</h1><p>ä½ å¯ä»¥é€šè¿‡ USB è®¾å¤‡ã€SCPã€FTP ç­‰æ–¹å¼å°†ä¸‹è½½å¥½çš„åŒ…åŠè„šæœ¬ä¼ è¾“åˆ°ç›®æ ‡ CentOS æœºå™¨ä¸Šã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/1749446823708-033483db-393b-4b2b-b37c-4d0c08c377ae.png" alt="img"></p><h1 id="5-ç»™è„šæœ¬èµ‹äºˆæ‰§è¡Œæƒé™"><a href="#5-ç»™è„šæœ¬èµ‹äºˆæ‰§è¡Œæƒé™" class="headerlink" title="5. ç»™è„šæœ¬èµ‹äºˆæ‰§è¡Œæƒé™"></a>5. ç»™è„šæœ¬èµ‹äºˆæ‰§è¡Œæƒé™</h1><p>åˆ†åˆ«ç»™install.shå’Œuninstall.shèµ‹äºˆå¯æ‰§è¡Œæƒé™ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">chmod +x install.sh<br>chmod +x uninstall.sh<br></code></pre></td></tr></table></figure><h1 id="6-æ‰§è¡Œå®‰è£…"><a href="#6-æ‰§è¡Œå®‰è£…" class="headerlink" title="6. æ‰§è¡Œå®‰è£…"></a>6. æ‰§è¡Œå®‰è£…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sh install.sh docker-26.1.4.tgz<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>docker</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>PPTå¿«æ·é”®</title>
    <link href="/PPT%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    <url>/PPT%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="1-PPTæ ‡å‡†å§¿åŠ¿"><a href="#1-PPTæ ‡å‡†å§¿åŠ¿" class="headerlink" title="1. PPTæ ‡å‡†å§¿åŠ¿"></a>1. PPTæ ‡å‡†å§¿åŠ¿</h1><ul><li>å·¦æ‰‹ CTRL+SHIFT</li><li>å³æ‰‹é¼ æ ‡</li></ul><h1 id="2-SHIFTå®¶æ—"><a href="#2-SHIFTå®¶æ—" class="headerlink" title="2. SHIFTå®¶æ—"></a>2. SHIFTå®¶æ—</h1><ul><li>æ°´å¹³&#x2F;ç«–ç›´ç§»åŠ¨ ï¼š SHIFT+é¼ æ ‡ç§»åŠ¨</li><li>ç­‰æ¯”ä¾‹ç¼©å°æ”¾å¤§ ï¼š SHIFT+é¼ æ ‡æ¨æ‹½å½¢çŠ¶</li><li>æ¯æ¬¡æ—‹è½¬ 15åº¦ï¼š SHIFT+æ—‹è½¬</li></ul><h1 id="3-CTRLå®¶æ—"><a href="#3-CTRLå®¶æ—" class="headerlink" title="3. CTRLå®¶æ—"></a>3. CTRLå®¶æ—</h1><ul><li>å¿«é€Ÿæ”¾å¤§ï¼šCTRL+é¼ æ ‡æ»šè½®</li><li>ç§»åŠ¨å¤åˆ¶ï¼šCTRL + é¼ æ ‡ç§»åŠ¨</li><li>å¿«é€Ÿå¤åˆ¶ï¼š CTRL + D</li><li>æ–°å»ºé¡µé¢ï¼š CTRL + M</li><li>ç»„åˆï¼š CTR L +G</li><li>ä¿å­˜ï¼š CTRL + S</li><li>æ’¤é”€&#x2F;æ¢å¤ CTRL+Z&#x2F;Yâ€™</li><li>ç¼©å°æ–‡å­—ï¼š CTRL + å·¦æ‹¬å·é”®</li></ul><h1 id="4-CTRL-SHIFTä¸€å®¶äº²"><a href="#4-CTRL-SHIFTä¸€å®¶äº²" class="headerlink" title="4. CTRL + SHIFTä¸€å®¶äº²"></a>4. CTRL + SHIFTä¸€å®¶äº²</h1><ul><li>å¿«é€Ÿæ°´å¹³&#x2F;ç«–ç›´æ–¹å‘å¤åˆ¶ï¼š CTRL + SHIFT + é¼ æ ‡ç§»åŠ¨</li><li>ç­‰æ¯”ä¾‹ä¸­å¿ƒæ”¾å¤§ï¼š CTRL + SHIFT +  ALT + é¼ æ ‡æ‹–æ‹½å½¢çŠ¶</li><li>å¤åˆ¶æ ¼å¼&#x2F;ç²˜è´´æ ¼å¼ï¼šCTRL + SHIFT + C&#x2F;V</li><li>è§£é™¤ç»„åˆï¼š CTRL + SHIFT + G</li></ul><h1 id="5-æ–‡æœ¬æ¡†æ“ä½œ"><a href="#5-æ–‡æœ¬æ¡†æ“ä½œ" class="headerlink" title="5. æ–‡æœ¬æ¡†æ“ä½œ"></a>5. æ–‡æœ¬æ¡†æ“ä½œ</h1><ul><li>æ–‡æœ¬æ¡†å¿«é€Ÿæ”¾å¤§ç¼©å°ï¼š CTRL+A -ã€‹CTRL+[&#x2F;]</li><li>æ–‡æœ¬æ¡†å¿«é€ŸåŠ ç²—ï¼š CTRL + B</li><li>æ–‡æœ¬æ¡†å¿«é€Ÿæ–œä½“ï¼š CTRL + I</li><li>æ–‡æœ¬æ¡†å¿«é€Ÿä¸‹åˆ’çº¿ï¼š CTRL + U</li><li>æ–‡æœ¬æ¡†å¿«é€Ÿå±€ä¸­&#x2F;å·¦&#x2F;å³&#x2F;å¯¹é½ï¼šCTRL + E &#x2F; L &#x2F;R</li></ul><h1 id="6-æ–‡å­—å›¾ç‰‡çš„å¿«é€Ÿæ’å…¥"><a href="#6-æ–‡å­—å›¾ç‰‡çš„å¿«é€Ÿæ’å…¥" class="headerlink" title="6. æ–‡å­—å›¾ç‰‡çš„å¿«é€Ÿæ’å…¥"></a>6. æ–‡å­—å›¾ç‰‡çš„å¿«é€Ÿæ’å…¥</h1><ul><li>æ–‡å­—çš„å¿«é€Ÿæ’å…¥ï¼šALT-&gt;N-&gt;X-&gt;H</li><li>å›¾ç‰‡çš„å¿«é€Ÿæ’å…¥ï¼šALT-&gt;N-&gt;P-&gt;D</li></ul><h1 id="7-ç”»å¸ƒå¤„ç†"><a href="#7-ç”»å¸ƒå¤„ç†" class="headerlink" title="7. ç”»å¸ƒå¤„ç†"></a>7. ç”»å¸ƒå¤„ç†</h1><ul><li>ä»å¤´æ”¾æ˜ PPTï¼šF5</li><li>ä»å½“å‰é¡µæ”¾æ˜ ï¼šSHIFT + F5</li><li>æ˜¾ç¤ºéšè—å‚è€ƒçº¿ï¼šALT + F9</li><li>æ˜¾ç¤ºéšè—ç½‘æ ¼çº¿ï¼šSHIFT + F9</li><li>å¿«é€Ÿç¼©æ”¾ç”»å¸ƒï¼šCTRL + æ»šè½®</li></ul><h1 id="8-é‡å¤ä¸Šä¸€æ­¥éª¤æ“ä½œ"><a href="#8-é‡å¤ä¸Šä¸€æ­¥éª¤æ“ä½œ" class="headerlink" title="8. é‡å¤ä¸Šä¸€æ­¥éª¤æ“ä½œ"></a>8. é‡å¤ä¸Šä¸€æ­¥éª¤æ“ä½œ</h1><p>F4</p>]]></content>
    
    
    <categories>
      
      <category>PPTé«˜æ‰‹ä¹‹è·¯</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>PPTç»Ÿä¸€é£æ ¼æŠ€å·§</title>
    <link href="/PPT%E7%BB%9F%E4%B8%80%E9%A3%8E%E6%A0%BC/"/>
    <url>/PPT%E7%BB%9F%E4%B8%80%E9%A3%8E%E6%A0%BC/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ç‰ˆå¿ƒè§„åˆ’"><a href="#1-ç‰ˆå¿ƒè§„åˆ’" class="headerlink" title="1.  ç‰ˆå¿ƒè§„åˆ’"></a>1.  ç‰ˆå¿ƒè§„åˆ’</h1><h2 id="1-é€šè¿‡å‚è€ƒçº¿è®¾ç½®åˆç†çš„é¡µé¢è·ï¼Œä¸ºé¡µé¢è§„åˆ’å‡ºæ”¾ç½®å†…å®¹çš„ä¸­å¿ƒåŒºåŸŸ"><a href="#1-é€šè¿‡å‚è€ƒçº¿è®¾ç½®åˆç†çš„é¡µé¢è·ï¼Œä¸ºé¡µé¢è§„åˆ’å‡ºæ”¾ç½®å†…å®¹çš„ä¸­å¿ƒåŒºåŸŸ" class="headerlink" title="1. é€šè¿‡å‚è€ƒçº¿è®¾ç½®åˆç†çš„é¡µé¢è·ï¼Œä¸ºé¡µé¢è§„åˆ’å‡ºæ”¾ç½®å†…å®¹çš„ä¸­å¿ƒåŒºåŸŸ"></a>1. é€šè¿‡å‚è€ƒçº¿è®¾ç½®åˆç†çš„é¡µé¢è·ï¼Œä¸ºé¡µé¢è§„åˆ’å‡ºæ”¾ç½®å†…å®¹çš„ä¸­å¿ƒåŒºåŸŸ</h2><p>ç©ºç™½åŒºåŸŸå³é”® -ã€‹ å¢åŠ å‚è€ƒçº¿ -ã€‰ è‡ªå·±æ‹–åŠ¨åˆ°åˆç†ä½ç½®</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250608155744062.png" alt="image-20250608155744062" style="zoom:30%;" /><h1 id="2-è®¾è®¡è§„èŒƒ"><a href="#2-è®¾è®¡è§„èŒƒ" class="headerlink" title="2. è®¾è®¡è§„èŒƒ"></a>2. è®¾è®¡è§„èŒƒ</h1><h2 id="1-é…è‰²"><a href="#1-é…è‰²" class="headerlink" title="1. é…è‰²"></a>1. é…è‰²</h2><h2 id="2-æ–‡å­—æ ·å¼"><a href="#2-æ–‡å­—æ ·å¼" class="headerlink" title="2. æ–‡å­—æ ·å¼"></a>2. æ–‡å­—æ ·å¼</h2><p>åœ¨åŒä¸€å¥—PPTä¸­ï¼ŒåŒå±‚çº§ä¿¡æ¯çš„æ–‡å­—ç±»å‹ã€å¤§å°ã€ç²—ç»†ã€é¢œè‰²éƒ½æ˜¯ç›¸åŒçš„ã€‚</p><p>å±‚çº§ï¼šä¸»æ ‡é¢˜ã€æ­£æ–‡æ ‡é¢˜ã€æ­£æ–‡</p><p>æ ·å¼ï¼šç±»å‹ã€å¤§å°ã€é¢œè‰²ã€ç²—ç»†</p><p>å¦‚ï¼š</p><ul><li><p>ä¸»æ ‡é¢˜ï¼šå¾®è½¯é›…é»‘ã€24å·ã€åŠ ç²—ã€ç™½è‰²</p></li><li><p>æ­£æ–‡æ ‡é¢˜ï¼šå¾®è½¯é›…é»‘ã€16å·ã€åŠ ç²—ã€é‡‘è‰²</p></li><li><p>æ­£æ–‡ï¼šå¾®è½¯é›…é»‘ã€12å·ã€ä¸åŠ ç²—ã€ç™½è‰²</p></li></ul><h2 id="3-ç‰ˆå¼"><a href="#3-ç‰ˆå¼" class="headerlink" title="3. ç‰ˆå¼"></a>3. ç‰ˆå¼</h2><p>åœ¨åŒä¸€å¥—PPTä¸­ï¼ŒåŒå±‚çº§ä¿¡æ¯çš„é¡µé¢ç‰ˆå¼æ˜¯ç›¸åŒçš„ã€‚å¦‚ï¼šå¤§ç« èŠ‚è¿‡æ¸¡é¡µã€å¤§ç« èŠ‚å†…ç›®å½•</p>]]></content>
    
    
    <categories>
      
      <category>PPTé«˜æ‰‹ä¹‹è·¯</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ä¼šè®®ç®¡ç†</title>
    <link href="/%E4%BC%9A%E8%AE%AE%E7%AE%A1%E7%90%86/"/>
    <url>/%E4%BC%9A%E8%AE%AE%E7%AE%A1%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä¼šè®®æ—¶æœºé€‰æ‹©"><a href="#1-ä¼šè®®æ—¶æœºé€‰æ‹©" class="headerlink" title="1. ä¼šè®®æ—¶æœºé€‰æ‹©"></a>1. ä¼šè®®æ—¶æœºé€‰æ‹©</h1><ul><li>â€‹    å‘èµ·äººæƒ³ä»å‚ä¼šè€…é‚£é‡Œè·å–ä¿¡æ¯æˆ–å»ºè®®</li><li>â€‹    å‘èµ·äººèµ·è®©å‚ä¼šè€…å‚ä¸è§£å†³é—®é¢˜æˆ–åˆ¶å®šå†³ç­–</li><li>â€‹    é¢†å¯¼è€…éœ€è¦å¬å–ä¸‹å±çš„å·¥ä½œæ±‡æŠ¥å¹¶ç›‘ç£è¿›åº¦</li><li>â€‹    é—®é¢˜éœ€æ¶‰åŠä¸åŒå²—ä½å‘˜å·¥æˆ–å¤šéƒ¨é—¨åè°ƒè§£å†³</li><li>â€‹    æœ‰é‡è¦äº‹æƒ…éœ€è¦æŠŠå‚ä¸äººé›†ä¸­åˆ°ä¸€èµ·ä¼ è¾¾</li><li>â€‹    é¢†å¯¼è€…éœ€è¦å…¬å¼€è¡¨å½°å…ˆè¿›ä»¥æ¿€åŠ±å£«æ°”ç­‰</li></ul><h1 id="2-åˆ¶è®¢ä¼šè®®è®®ç¨‹"><a href="#2-åˆ¶è®¢ä¼šè®®è®®ç¨‹" class="headerlink" title="2. åˆ¶è®¢ä¼šè®®è®®ç¨‹"></a>2. åˆ¶è®¢ä¼šè®®è®®ç¨‹</h1><ul><li>ä¼šè®®è®®ç¨‹é¡»ä»¥æ­£å¼æ–‡ä»¶å½¢å¼æ‹Ÿå®š</li><li>æ­£å¼ä¼šè®®å¼€å§‹æ—¶ä¸€èˆ¬éœ€è¦è¯´æ˜ä¼šè®®æ•´ä½“æµç¨‹ï¼Œä¼šè®®åˆ†ä¸ºå‡ é¡¹å†…å®¹</li><li>è®®ç¨‹å®‰æ’æ—¶åº”å°½é‡å°†ä¼šè®®æ—¶æ®µ    å®‰æ’åœ¨æ­£å¸¸å·¥ä½œæ—¶æ®µå†…</li></ul><h1 id="3-ä¼šè®®å¬å¼€é«˜æ•ˆç§˜è¯€"><a href="#3-ä¼šè®®å¬å¼€é«˜æ•ˆç§˜è¯€" class="headerlink" title="3. ä¼šè®®å¬å¼€é«˜æ•ˆç§˜è¯€"></a>3. ä¼šè®®å¬å¼€é«˜æ•ˆç§˜è¯€</h1><ol><li>æ˜ç¡®ä¼šè®®ç›®çš„å’Œäº§å‡º</li><li>ç¡®è®¤ä¼šè®®å½¢å¼å’Œæµç¨‹</li><li>ç¡®å®šå‚ä¼šèŒƒå›´</li><li>åšå¥½ä¼šå‰å‡†å¤‡</li><li>æ§åˆ¶å¥½ä¼šåœºæ°”æ°›èŠ‚å¥</li><li>åšå¥½ä¼šè®®è®°å½•</li><li>åŠæ—¶å…¬å¸ƒä¼šè®®å†³è®®</li><li>åšå¥½ä¼šåè·Ÿè¸ªå®æ–¹æ¡ˆæ‰§è¡Œ</li></ol><h1 id="4-ä¼šè®®è¿½è¸ª"><a href="#4-ä¼šè®®è¿½è¸ª" class="headerlink" title="4. ä¼šè®®è¿½è¸ª"></a>4. ä¼šè®®è¿½è¸ª</h1><p>å‡¡æ˜¯æ•£ä¼šï¼Œå¿…æœ‰äº‹åè¿½è¸ªï¼šè®°ä½â€œæ•£ä¼šä¸è¿½è¸ªï¼Œå¼€ä¼šä¸€åœºç©ºâ€ã€‚å»ºç«‹ä¼šè®®äº‹åè¿½è¸ªç¨‹åºï¼Œä¼šè®®æ¯é¡¹</p><p>å†³è®®éƒ½è¦æœ‰è·Ÿè¸ªã€ç¨½æ ¸æ£€æŸ¥ï¼Œå¦‚æœ‰æ„å¤–å¯åŠæ—¶å‘ç°é€‚æ—¶è°ƒæ•´ï¼Œç¡®ä¿å„é¡¹ä¼šè®®å†³è®®éƒ½èƒ½å®Œæˆã€‚</p><ul><li>å¼€ä¼š+ä¸è½å®&#x3D;é›¶</li><li>å¸ƒç½®å·¥ä½œ+ä¸æ£€æŸ¥&#x3D;é›¶</li><li>æŠ“ä½ä¸è½å®çš„äº‹+è¿½ç©¶ä¸è½å®çš„äºº&#x3D;è½å®</li></ul>]]></content>
    
    
    <categories>
      
      <category>é«˜æ•ˆå·¥ä½œ</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>mybatisåˆ†â»šæŸ¥è¯¢å¼‚æ­¥å¯¼å‡ºåˆ†â»šé‡å¤/ä¸¢å¤±é—®é¢˜</title>
    <link href="/mybatis%E5%88%86%E2%BB%9A%E6%9F%A5%E8%AF%A2%E5%BC%82%E6%AD%A5%E5%AF%BC%E5%87%BA%E5%88%86%E2%BB%9A%E9%87%8D%E5%A4%8D%E4%B8%A2%E5%A4%B1%E9%97%AE%E9%A2%98/"/>
    <url>/mybatis%E5%88%86%E2%BB%9A%E6%9F%A5%E8%AF%A2%E5%BC%82%E6%AD%A5%E5%AF%BC%E5%87%BA%E5%88%86%E2%BB%9A%E9%87%8D%E5%A4%8D%E4%B8%A2%E5%A4%B1%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-åˆå§‹çŠ¶æ€"><a href="#1-åˆå§‹çŠ¶æ€" class="headerlink" title="1. åˆå§‹çŠ¶æ€"></a>1. åˆå§‹çŠ¶æ€</h1><p>æˆ‘ä»¬æœ‰ä¸€ä¸ªåº“å­˜è¡¨ inventoryï¼Œé‡Œé¢æœ‰ 25 æ¡è®°å½•ï¼ŒæŒ‰ id æ’åºï¼ˆä»å°åˆ°å¤§ï¼‰ã€‚</p><p>æ¯é¡µæ˜¾ç¤º 10æ¡è®°å½•ï¼š</p><p>ç¬¬1é¡µï¼šLIMIT 10 OFFSET 0 â†’ id &#x3D; 1~10</p><p>ç¬¬2é¡µï¼šLIMIT 10 OFFSET 10 â†’ id &#x3D; 11~20</p><p>ç¬¬ä¸€é¡µï¼š</p><table><thead><tr><th>OFFSET</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th></tr></thead><tbody><tr><td>id</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr></tbody></table><p>ç¬¬äºŒé¡µï¼š</p><table><thead><tr><th>OFFSET</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th><th>16</th><th>17</th><th>18</th><th>19</th></tr></thead><tbody><tr><td>id</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td><td>16</td><td>17</td><td>18</td><td>19</td><td>20</td></tr></tbody></table><h1 id="2-å¹¶å‘æ’å…¥"><a href="#2-å¹¶å‘æ’å…¥" class="headerlink" title="2. å¹¶å‘æ’å…¥"></a>2. å¹¶å‘æ’å…¥</h1><p>å‡è®¾ä½ åœ¨æŸ¥å®Œç¬¬ä¸€é¡µåï¼Œåœ¨æ•°æ®åº“ä¸­æ’å…¥äº† 3æ¡æ–°çš„è®°å½•ï¼Œå®ƒä»¬çš„ id æ˜¯ 100, 101, 102ï¼Œå¹¶ä¸”è¿™äº›è®°å½•ä¼šè¢«æ’åºæ’åœ¨å‰10æ¡ä¸­é—´çš„ä½ç½®ã€‚</p><p>æ¯”å¦‚ä½ è®¾ç½®çš„æ˜¯æŒ‰ <code>name</code> æˆ–å…¶ä»–å­—æ®µæ’åºï¼Œæˆ–è€…ä½ ç”¨äº†æ—¶é—´æˆ³å­—æ®µæ’åºï¼Œè¿™ä¸‰æ¡è®°å½•æ’åˆ°äº†å‰é¢éƒ¨åˆ†ã€‚</p><p>ç¬¬ä¸€é¡µå·²ç»æŠŠ8ã€9ã€10 æŸ¥å‡ºæ¥å¹¶å¯¼å‡ºäº†ï¼Œä½†ç¬¬äºŒé¡µåˆé‡å¤æŸ¥å‡ºæ¥å¯¼å‡ºï¼Œé€ æˆ<strong>æ•°æ®é‡å¤</strong>ï¼ˆid &#x3D; 7ã€8ã€9ï¼‰</p><p>ç¬¬ä¸€é¡µï¼š</p><table><thead><tr><th>OFFSET</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th></tr></thead><tbody><tr><td>id</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td><strong>101</strong></td><td><strong>102</strong></td><td><strong>103</strong></td><td>7</td></tr></tbody></table><p>ç¬¬äºŒé¡µï¼š</p><table><thead><tr><th>OFFSET</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th><th>16</th><th>17</th><th>18</th><th>19</th></tr></thead><tbody><tr><td>id</td><td>8</td><td>9</td><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td><td>16</td><td>17</td></tr></tbody></table><h1 id="3-å¹¶å‘åˆ é™¤"><a href="#3-å¹¶å‘åˆ é™¤" class="headerlink" title="3. å¹¶å‘åˆ é™¤"></a>3. å¹¶å‘åˆ é™¤</h1><p>å‡è®¾ä½ åœ¨æŸ¥è¯¢å®Œç¬¬1é¡µä¹‹åï¼Œåœ¨å¯¼å‡ºç¬¬2é¡µä¹‹å‰ï¼Œæœ‰äººåˆ é™¤äº†ç¬¬1é¡µä¸­çš„3æ¡è®°å½•ï¼ˆid &#x3D; 7ã€8ã€9ï¼‰ã€‚</p><p>å¯¼è‡´åŸæœ¬åº”è¯¥åœ¨ç¬¬äºŒé¡µçš„è®°å½•ï¼ˆid&#x3D;11ã€12ã€13ï¼‰ä¸Šç§»åˆ°äº†ç¬¬ä¸€é¡µï¼Œç¬¬äºŒé¡µæŸ¥è¯¢çš„æ—¶å€™ä»id&#x3D;14å¼€å§‹æŸ¥ï¼Œé€ æˆ<strong>æ•°æ®ä¸¢å¤±</strong>ï¼ˆid&#x3D;11ã€12ã€13ï¼‰</p><p>ç¬¬ä¸€é¡µï¼š</p><table><thead><tr><th>OFFSET</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th></tr></thead><tbody><tr><td>id</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>10</td><td><strong>11</strong></td><td><strong>12</strong></td><td><strong>13</strong></td></tr></tbody></table><p>ç¬¬äºŒé¡µï¼š</p><table><thead><tr><th>OFFSET</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th><th>16</th><th>17</th><th>18</th><th>19</th></tr></thead><tbody><tr><td>id</td><td>14</td><td>15</td><td>16</td><td>17</td><td>18</td><td>19</td><td>20</td><td>121</td><td>121</td><td>123</td></tr></tbody></table><h1 id="4-é—®é¢˜è§£å†³"><a href="#4-é—®é¢˜è§£å†³" class="headerlink" title="4. é—®é¢˜è§£å†³"></a>4. é—®é¢˜è§£å†³</h1><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹å‡ ç§æ–¹æ¡ˆï¼š</p><h2 id="4-1-æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ¸¸æ ‡åˆ†é¡µï¼ˆCursor-based-Paginationï¼‰"><a href="#4-1-æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ¸¸æ ‡åˆ†é¡µï¼ˆCursor-based-Paginationï¼‰" class="headerlink" title="4.1. æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ¸¸æ ‡åˆ†é¡µï¼ˆCursor-based Paginationï¼‰"></a>4.1. æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ¸¸æ ‡åˆ†é¡µï¼ˆCursor-based Paginationï¼‰</h2><p>ç”¨ä¸Šä¸€é¡µæœ€åä¸€æ¡è®°å½•çš„ <code>id</code> ä½œä¸ºä¸‹ä¸€é¡µçš„èµ·ç‚¹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- ç¬¬ä¸€é¡µ</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> inventory <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> id LIMIT <span class="hljs-number">10</span>;<br><br><span class="hljs-comment">-- ç¬¬äºŒé¡µï¼ˆå‡è®¾æœ€åä¸€æ¡æ˜¯ id = 10ï¼‰</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> inventory <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">&gt;</span> <span class="hljs-number">10</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> id LIMIT <span class="hljs-number">10</span>;<br></code></pre></td></tr></table></figure><p>è¿™æ ·æ— è®ºæœ‰æ²¡æœ‰æ–°å¢&#x2F;åˆ é™¤è®°å½•ï¼Œéƒ½ä¸ä¼šå½±å“ä¸‹ä¸€é¡µçš„å‡†ç¡®æ€§ã€‚</p><hr><h2 id="4-2-æ–¹æ³•äºŒï¼šå¿«ç…§å¯¼å‡ºï¼ˆé€‚ç”¨äºå¤§æ•°æ®å¯¼å‡ºåœºæ™¯ï¼‰"><a href="#4-2-æ–¹æ³•äºŒï¼šå¿«ç…§å¯¼å‡ºï¼ˆé€‚ç”¨äºå¤§æ•°æ®å¯¼å‡ºåœºæ™¯ï¼‰" class="headerlink" title="4.2. æ–¹æ³•äºŒï¼šå¿«ç…§å¯¼å‡ºï¼ˆé€‚ç”¨äºå¤§æ•°æ®å¯¼å‡ºåœºæ™¯ï¼‰"></a>4.2. æ–¹æ³•äºŒï¼šå¿«ç…§å¯¼å‡ºï¼ˆé€‚ç”¨äºå¤§æ•°æ®å¯¼å‡ºåœºæ™¯ï¼‰</h2><p>åœ¨å¯¼å‡ºå‰åˆ›å»ºä¸€ä¸ªä¸´æ—¶å¿«ç…§è¡¨æˆ–è§†å›¾ï¼ŒæŠŠè¦å¯¼å‡ºçš„æ•°æ®å…ˆå¤åˆ¶ä¸€ä»½ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> TEMPORARY <span class="hljs-keyword">TABLE</span> inventory_snapshot <span class="hljs-keyword">AS</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> inventory;<br></code></pre></td></tr></table></figure><p>ç„¶åå¯¹è¿™ä¸ªå¿«ç…§è¡¨è¿›è¡Œåˆ†é¡µæŸ¥è¯¢ï¼Œé¿å…å®æ—¶å˜åŒ–å¹²æ‰°ã€‚</p><h2 id="4-3-ä¸­é—´è¡¨-åˆ‡é¢æ§åˆ¶æµç¨‹ï¼Œæ„å»ºäº†ä¸€ä¸ªæ•°æ®å¿«ç…§æœºåˆ¶"><a href="#4-3-ä¸­é—´è¡¨-åˆ‡é¢æ§åˆ¶æµç¨‹ï¼Œæ„å»ºäº†ä¸€ä¸ªæ•°æ®å¿«ç…§æœºåˆ¶" class="headerlink" title="4.3. ä¸­é—´è¡¨ + åˆ‡é¢æ§åˆ¶æµç¨‹ï¼Œæ„å»ºäº†ä¸€ä¸ªæ•°æ®å¿«ç…§æœºåˆ¶"></a>4.3. ä¸­é—´è¡¨ + åˆ‡é¢æ§åˆ¶æµç¨‹ï¼Œæ„å»ºäº†ä¸€ä¸ªæ•°æ®å¿«ç…§æœºåˆ¶</h2><p>ä¸ç›´æ¥å¯¹åº“å­˜è¡¨åšåˆ†é¡µæŸ¥è¯¢ï¼Œè€Œæ˜¯å…ˆå°†æœ¬æ¬¡è¦å¯¼å‡ºçš„æ‰€æœ‰åº“å­˜ ID å­˜å…¥ä¸€ä¸ªä¸´æ—¶è¡¨ä¸­ï¼ˆexport_recordï¼‰ï¼Œåç»­å¯¼å‡ºéƒ½åŸºäºè¿™ä¸ªä¸´æ—¶è¡¨çš„ ID åˆ—è¡¨æ¥è¿›è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">CREATE TABLE <span class="hljs-title">export_record</span> <span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">    id BIGINT PRIMARY KEY AUTO_INCREMENT,</span></span><br><span class="hljs-params"><span class="hljs-function">    source_table_id BIGINT,        -- æ¥æºè¡¨IDï¼ˆå¦‚ inventory.idï¼‰</span></span><br><span class="hljs-params"><span class="hljs-function">    batch_id VARCHAR(<span class="hljs-number">64</span>)</span>,          -- æ‰¹æ¬¡IDï¼ˆå¼‚æ­¥ä»»åŠ¡IDï¼‰</span><br><span class="hljs-function">    create_time DATETIME           -- åˆ›å»ºæ—¶é—´</span><br><span class="hljs-function">)</span>;<br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InventoryExportService</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> InventoryMapper inventoryMapper;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> ExportRecordMapper exportRecordMapper;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startExport</span><span class="hljs-params">()</span> </span>&#123;<br>        String batchId = UUID.randomUUID().toString(); <span class="hljs-comment">// ç”Ÿæˆå”¯ä¸€æ‰¹æ¬¡ID</span><br><br>        <span class="hljs-comment">// è·å–æ‰€æœ‰éœ€è¦å¯¼å‡ºçš„åº“å­˜IDåˆ—è¡¨</span><br>        List&lt;Long&gt; allInventoryIds = getAllInventoryIds();<br><br>        <span class="hljs-comment">// å°†è¿™äº›IDè®°å½•åˆ°export_recordè¡¨ä¸­</span><br>        saveBatchIdsToExportRecord(batchId, allInventoryIds);<br><br>        <span class="hljs-comment">// å¼‚æ­¥æ‰§è¡Œå®é™…å¯¼å‡ºé€»è¾‘</span><br>        asyncExportInventoryByBatchId(batchId);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> List&lt;Long&gt; <span class="hljs-title">getAllInventoryIds</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> inventoryMapper.selectList(<span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;())<br>        .stream()<br>        .map(Inventory::getId)<br>        .collect(Collectors.toList());<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">saveBatchIdsToExportRecord</span><span class="hljs-params">(String batchId, List&lt;Long&gt; ids)</span> </span>&#123;<br>        List&lt;ExportRecord&gt; records = ids.stream()<br>        .map(id -&gt; <span class="hljs-keyword">new</span> ExportRecord(<span class="hljs-keyword">null</span>, id, batchId, <span class="hljs-keyword">new</span> Date()))<br>        .collect(Collectors.toList());<br>        exportRecordMapper.insertBatch(records); <span class="hljs-comment">// å‡è®¾æœ‰ä¸€ä¸ªæ‰¹é‡æ’å…¥çš„æ–¹æ³•</span><br>    &#125;<br><br>    <span class="hljs-meta">@Async</span> <span class="hljs-comment">// ä½¿ç”¨@Asyncæ³¨è§£å®ç°å¼‚æ­¥è°ƒç”¨</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">asyncExportInventoryByBatchId</span><span class="hljs-params">(String batchId)</span> </span>&#123;<br>        Page&lt;ExportRecord&gt; page = <span class="hljs-keyword">new</span> Page&lt;&gt;(<span class="hljs-number">1</span>, <span class="hljs-number">1000</span>); <span class="hljs-comment">// æ¯æ¬¡å¤„ç†1000æ¡è®°å½•</span><br>        IPage&lt;ExportRecord&gt; exportRecords;<br>        <span class="hljs-keyword">do</span> &#123;<br>            exportRecords = exportRecordMapper.selectPage(page, <span class="hljs-keyword">new</span> QueryWrapper&lt;ExportRecord&gt;()<br>                                                          .eq(<span class="hljs-string">&quot;batch_id&quot;</span>, batchId));<br><br>            <span class="hljs-keyword">if</span> (exportRecords.getRecords().isEmpty()) <span class="hljs-keyword">break</span>;<br><br>            <span class="hljs-comment">// æ ¹æ®export_recordsä¸­çš„source_table_idæŸ¥è¯¢inventoryè¡¨</span><br>            List&lt;Long&gt; ids = exportRecords.getRecords().stream()<br>            .map(ExportRecord::getSourceTableId)<br>            .collect(Collectors.toList());<br>            List&lt;Inventory&gt; inventories = inventoryMapper.selectBatchIds(ids);<br><br>            <span class="hljs-comment">// æ‰§è¡Œå¯¼å‡ºé€»è¾‘ï¼ˆä¾‹å¦‚å†™å…¥Excelæ–‡ä»¶ï¼‰</span><br><br>            page.setCurrent(page.getCurrent() + <span class="hljs-number">1</span>); <span class="hljs-comment">// æ›´æ–°å½“å‰é¡µç </span><br>        &#125; <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>);<br><br>        <span class="hljs-comment">// æ¸…ç†ä¸­é—´è¡¨æ•°æ®</span><br>        exportRecordMapper.delete(<span class="hljs-keyword">new</span> QueryWrapper&lt;ExportRecord&gt;().eq(<span class="hljs-string">&quot;batch_id&quot;</span>, batchId));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-å®ç°æ­¥éª¤"><a href="#1-å®ç°æ­¥éª¤" class="headerlink" title="1. å®ç°æ­¥éª¤"></a>1. å®ç°æ­¥éª¤</h3><h4 id="Step1ï¼šåˆ‡é¢æ‹¦æˆªå¯¼å‡ºè¯·æ±‚"><a href="#Step1ï¼šåˆ‡é¢æ‹¦æˆªå¯¼å‡ºè¯·æ±‚" class="headerlink" title="Step1ï¼šåˆ‡é¢æ‹¦æˆªå¯¼å‡ºè¯·æ±‚"></a>Step1ï¼šåˆ‡é¢æ‹¦æˆªå¯¼å‡ºè¯·æ±‚</h4><ul><li>ä½¿ç”¨ Spring AOP æ‹¦æˆªå¸¦æœ‰ <code>@ExcelExport</code> æ³¨è§£çš„æ–¹æ³•</li><li>åœ¨æ–¹æ³•æ‰§è¡Œå‰ï¼Œè·å–åˆ°æœ¬æ¬¡å¯¼å‡ºçš„åº“å­˜ ID åˆ—è¡¨ï¼ˆå¦‚ä»å‚æ•°ã€ä¸Šä¸‹æ–‡ä¸­æå–ï¼‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;Long&gt; inventoryIds = getInventoryIdsFromRequest();<br></code></pre></td></tr></table></figure><h4 id="Step2ï¼šç”Ÿæˆæ‰¹æ¬¡æ ‡è¯†-batchIdï¼Œå¹¶å†™å…¥é€šç”¨å¯¼å‡ºè¡¨"><a href="#Step2ï¼šç”Ÿæˆæ‰¹æ¬¡æ ‡è¯†-batchIdï¼Œå¹¶å†™å…¥é€šç”¨å¯¼å‡ºè¡¨" class="headerlink" title="Step2ï¼šç”Ÿæˆæ‰¹æ¬¡æ ‡è¯† batchIdï¼Œå¹¶å†™å…¥é€šç”¨å¯¼å‡ºè¡¨"></a>Step2ï¼šç”Ÿæˆæ‰¹æ¬¡æ ‡è¯† batchIdï¼Œå¹¶å†™å…¥é€šç”¨å¯¼å‡ºè¡¨</h4><ul><li>å°†æ‰€æœ‰åº“å­˜ ID å’Œ batchId ä¸€èµ·å†™å…¥ <code>export_record</code> è¡¨ä¸­</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">INSERT INTO <span class="hljs-title">export_record</span> <span class="hljs-params">(source_table_id, batch_id)</span> <span class="hljs-title">VALUES</span></span><br><span class="hljs-function"><span class="hljs-params">(<span class="hljs-number">1001</span>, <span class="hljs-string">&#x27;task_123&#x27;</span>)</span>,</span><br><span class="hljs-function"><span class="hljs-params">(<span class="hljs-number">1002</span>, <span class="hljs-string">&#x27;task_123&#x27;</span>)</span>,</span><br><span class="hljs-function">...</span><br></code></pre></td></tr></table></figure><p>ä½œç”¨ï¼šä¿å­˜æœ¬æ¬¡å¯¼å‡ºæ‰€æ¶‰åŠçš„æ‰€æœ‰åº“å­˜ IDã€‚</p><h4 id="Step3ï¼šå¯¼å‡ºé€»è¾‘æ”¹ä¸ºæ ¹æ®-batchId-æŸ¥è¯¢"><a href="#Step3ï¼šå¯¼å‡ºé€»è¾‘æ”¹ä¸ºæ ¹æ®-batchId-æŸ¥è¯¢" class="headerlink" title="Step3ï¼šå¯¼å‡ºé€»è¾‘æ”¹ä¸ºæ ¹æ® batchId æŸ¥è¯¢"></a>Step3ï¼šå¯¼å‡ºé€»è¾‘æ”¹ä¸ºæ ¹æ® batchId æŸ¥è¯¢</h4><ul><li>å¯¼å‡ºä»£ç ä¸å†ç›´æ¥æŸ¥åº“å­˜è¡¨ï¼Œè€Œæ˜¯æŸ¥ <code>export_record</code> è¡¨ä¸­çš„ source_table_id åˆ—è¡¨ï¼Œå†å…³è”åº“å­˜è¡¨å¯¼å‡º</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> i.<span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> inventory i<br><span class="hljs-keyword">JOIN</span> export_record e <span class="hljs-keyword">ON</span> i.id <span class="hljs-operator">=</span> e.source_table_id<br><span class="hljs-keyword">WHERE</span> e.batch_id <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;task_123&#x27;</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> i.id<br>LIMIT <span class="hljs-number">10</span> <span class="hljs-keyword">OFFSET</span> <span class="hljs-number">0</span>;<br></code></pre></td></tr></table></figure><p>è¿™æ ·æ— è®ºåº“å­˜è¡¨å¦‚ä½•å˜åŒ–ï¼Œåªè¦ <code>export_record</code> è¡¨é‡Œçš„ ID ä¸å˜ï¼Œå¯¼å‡ºçš„æ•°æ®é›†å°±ä¸ä¼šå˜ã€‚</p><h4 id="Step4ï¼šå¯¼å‡ºå®Œæˆåæ¸…ç†ä¸­é—´æ•°æ®"><a href="#Step4ï¼šå¯¼å‡ºå®Œæˆåæ¸…ç†ä¸­é—´æ•°æ®" class="headerlink" title="Step4ï¼šå¯¼å‡ºå®Œæˆåæ¸…ç†ä¸­é—´æ•°æ®"></a>Step4ï¼šå¯¼å‡ºå®Œæˆåæ¸…ç†ä¸­é—´æ•°æ®</h4><ul><li>åœ¨åˆ‡é¢æœ€åï¼Œåˆ é™¤è¯¥ batchId å¯¹åº”çš„ <code>export_record</code> æ•°æ®ï¼Œé¿å…æ•°æ®å †ç§¯</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> export_record <span class="hljs-keyword">WHERE</span> batch_id <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;task_123&#x27;</span>;<br></code></pre></td></tr></table></figure><h3 id="2-æ ¸å¿ƒåŸç†"><a href="#2-æ ¸å¿ƒåŸç†" class="headerlink" title="2. æ ¸å¿ƒåŸç†"></a>2. <strong>æ ¸å¿ƒåŸç†</strong></h3><p>æ ¸å¿ƒåŸç†ï¼š<strong>å›ºå®šæ•°æ®é›† + ç‹¬ç«‹äºæºè¡¨</strong></p><table><thead><tr><th><strong>ä¼ ç»Ÿæ–¹å¼</strong></th><th><strong>ä½ çš„æ–¹æ¡ˆ</strong></th></tr></thead><tbody><tr><td>ç›´æ¥å¯¹åº“å­˜è¡¨åˆ†é¡µæŸ¥è¯¢ â†’ æ•°æ®ä¼šå˜</td><td>å…ˆæŠŠ ID å†™è¿›ä¸­é—´è¡¨ â†’ æ•°æ®ä¸å˜</td></tr><tr><td>åˆ†é¡µåŸºäºåç§»é‡ï¼ˆOFFSETï¼‰â†’ å®¹æ˜“å› æ’å…¥&#x2F;åˆ é™¤å¯¼è‡´åç§»é”™ä¹±</td><td>åˆ†é¡µåŸºäºå›ºå®š ID åˆ—è¡¨ â†’ åç§»å§‹ç»ˆå‡†ç¡®</td></tr><tr><td>å¤šæ¬¡æŸ¥è¯¢ä¹‹é—´æ•°æ®å¯èƒ½å˜åŠ¨ â†’ å¯¼è‡´é‡å¤æˆ–ä¸¢å¤±</td><td>æ‰€æœ‰å¯¼å‡ºéƒ½åŸºäºåŒä¸€ä»½å¿«ç…§ ID â†’ æ•°æ®ä¸€è‡´</td></tr></tbody></table><p><strong>è§£å†³äº†å“ªäº›é—®é¢˜ï¼Ÿ</strong></p><table><thead><tr><th><strong>é—®é¢˜</strong></th><th><strong>æ˜¯å¦è§£å†³</strong></th><th><strong>åŸç†è¯´æ˜</strong></th></tr></thead><tbody><tr><td>æ•°æ®æ’å…¥å¯¼è‡´åˆ†é¡µåç§»</td><td>âœ… è§£å†³</td><td>å¯¼å‡ºåŸºäºä¸­é—´è¡¨ ID åˆ—è¡¨ï¼Œä¸å—åº“å­˜è¡¨æ’å…¥å½±å“</td></tr><tr><td>æ•°æ®åˆ é™¤å¯¼è‡´åˆ†é¡µåç§»</td><td>âœ… è§£å†³</td><td>åŒä¸Šï¼ŒID å¿«ç…§å·²å›ºå®š</td></tr><tr><td>åˆ†é¡µé‡å¤æˆ–ä¸¢å¤±</td><td>âœ… è§£å†³</td><td>åˆ†é¡µåªé’ˆå¯¹å›ºå®šçš„ ID åˆ—è¡¨ï¼Œä¸ä¼šè·³è¿‡æˆ–é‡å¤</td></tr><tr><td>æ”¯æŒå¹¶å‘å¯¼å‡º</td><td>âœ… æ”¯æŒ</td><td>æ¯ä¸ªä»»åŠ¡éƒ½æœ‰ç‹¬ç«‹çš„ batchIdï¼Œäº’ä¸å½±å“</td></tr><tr><td>å¯å¤ç”¨æ€§</td><td>âœ… æ”¯æŒ</td><td>ä¸­é—´è¡¨ç»“æ„é€šç”¨ï¼Œé€‚ç”¨äºå¤šç§å¯¼å‡ºåœºæ™¯</td></tr></tbody></table><hr><h3 id="3-ä¼˜åŒ–å»ºè®®"><a href="#3-ä¼˜åŒ–å»ºè®®" class="headerlink" title="3. ä¼˜åŒ–å»ºè®®"></a>3. ä¼˜åŒ–å»ºè®®</h3><ol><li><strong>æ€§èƒ½ä¼˜åŒ–ï¼šæ‰¹é‡æ’å…¥ä¸­é—´è¡¨</strong></li></ol><ul><li>å¦‚æœä¸€æ¬¡å¯¼å‡ºå‡ ä¸‡æ¡è®°å½•ï¼Œæ’å…¥ <code>export_record</code> è¡¨å¯èƒ½ä¼šæ…¢ã€‚</li><li>å»ºè®®ä½¿ç”¨ MyBatis çš„ <code>saveBatch()</code> æˆ–æ•°æ®åº“çš„æ‰¹é‡æ’å…¥è¯­å¥ã€‚</li></ul><ol start="2"><li><strong>æ¸…ç†æœºåˆ¶ä¿éšœ</strong></li></ol><ul><li>ç¡®ä¿æ¯æ¬¡å¯¼å‡ºå®Œæˆåéƒ½èƒ½åˆ é™¤ä¸­é—´æ•°æ®ï¼ˆå³ä½¿å¼‚å¸¸ä¹Ÿè¦åˆ é™¤ï¼‰</li><li>å¯ä»¥åŠ å®šæ—¶ä»»åŠ¡æ¸…ç†è¶…æ—¶æœªåˆ é™¤çš„ <code>batch_id</code> è®°å½•</li></ul><ol start="3"><li><strong>å¯æ‰©å±•æ€§å¢å¼º</strong></li></ol><ul><li>å¯ä»¥è€ƒè™‘å°† <code>export_record</code> æ›¿æ¢ä¸º Redis ç¼“å­˜ï¼Œæå‡æ€§èƒ½ï¼ˆçŸ­æœŸç¼“å­˜å³å¯ï¼‰</li><li>æˆ–è€…ç»“åˆä¸¤è€…ï¼Œçƒ­æ•°æ®èµ° Redisï¼Œå†·æ•°æ®è½åº“</li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Eurekaæ³¨å†ŒæœåŠ¡IPçš„æ–¹å¼</title>
    <link href="/Eureka%E6%B3%A8%E5%86%8C%E6%9C%8D%E5%8A%A1IP%E7%9A%84%E6%96%B9%E5%BC%8F/"/>
    <url>/Eureka%E6%B3%A8%E5%86%8C%E6%9C%8D%E5%8A%A1IP%E7%9A%84%E6%96%B9%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Eurekaæ³¨å†ŒæœåŠ¡IPçš„æ–¹å¼"><a href="#1-Eurekaæ³¨å†ŒæœåŠ¡IPçš„æ–¹å¼" class="headerlink" title="1. Eurekaæ³¨å†ŒæœåŠ¡IPçš„æ–¹å¼"></a>1. Eurekaæ³¨å†ŒæœåŠ¡IPçš„æ–¹å¼</h1><p>å½“æœåŠ¡æ³¨å†Œåˆ°Eurekaã€Nacosç­‰æ³¨å†Œä¸­å¿ƒæ—¶ï¼Œå®ƒä¼šå°†è‡ªå·±çš„IPåœ°å€ä¸ŠæŠ¥ã€‚Spring Booté»˜è®¤å¯èƒ½ä¼šä½¿ç”¨å¦‚ä¸‹å‡ ç§æ–¹å¼æ¥è·å–æœ¬æœº IP:</p><ul><li><p>localhost</p></li><li><p>ç½‘å¡ä¸Šçš„IP(å¦‚:192.168.x.x ï¼Œ172.17.x.x , 10.x.x.x)</p></li><li><p>å¦‚æœè®¾ç½®äº†preferred-networksï¼Œåˆ™ä¼˜å…ˆä»è¿™äº›ç½‘æ®µä¸­é€‰ä¸€ä¸ªä½œä¸ºæ³¨å†Œåœ°å€</p><p>å¦‚æœæ²¡æœ‰è®¾ç½®è¿™ä¸ªé€‰é¡¹ï¼Œæœ‰æ—¶ä¼šé”™è¯¯åœ°å°†localhostæˆ–è€…é”™è¯¯çš„IPæ³¨å†Œåˆ°æœåŠ¡ä¸­å¿ƒï¼Œå¯¼è‡´å…¶ä»–æœåŠ¡æ— æ³•è®¿é—®ã€‚</p></li></ul><h1 id="2-è§£å†³æ³¨å†Œåˆ°Eurekaä¸€ç›´æ˜¾ç¤ºlocalhostçš„é—®é¢˜"><a href="#2-è§£å†³æ³¨å†Œåˆ°Eurekaä¸€ç›´æ˜¾ç¤ºlocalhostçš„é—®é¢˜" class="headerlink" title="2. è§£å†³æ³¨å†Œåˆ°Eurekaä¸€ç›´æ˜¾ç¤ºlocalhostçš„é—®é¢˜"></a>2. è§£å†³æ³¨å†Œåˆ°Eurekaä¸€ç›´æ˜¾ç¤ºlocalhostçš„é—®é¢˜</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">-Dspring.cloud.inetutils.preferred-networks=<span class="hljs-number">172.28</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>jaråŒ…åç¼–è¯‘</title>
    <link href="/jar%E5%8C%85%E5%8F%8D%E7%BC%96%E8%AF%91/"/>
    <url>/jar%E5%8C%85%E5%8F%8D%E7%BC%96%E8%AF%91/</url>
    
    <content type="html"><![CDATA[<h1 id="1-idea-å®‰è£…æ’ä»¶"><a href="#1-idea-å®‰è£…æ’ä»¶" class="headerlink" title="1. idea å®‰è£…æ’ä»¶"></a>1. idea å®‰è£…æ’ä»¶</h1><p>å®‰è£…Java Decompiler</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250603215554615.png" alt="image-20250603215554615"></p><h1 id="2-æ‰§è¡Œåç¼–è¯‘å‘½ä»¤"><a href="#2-æ‰§è¡Œåç¼–è¯‘å‘½ä»¤" class="headerlink" title="2. æ‰§è¡Œåç¼–è¯‘å‘½ä»¤"></a>2. æ‰§è¡Œåç¼–è¯‘å‘½ä»¤</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -cp &quot;D:\software\JetBrains\IntelliJ IDEA 2024.3.5\plugins\java-decompiler\lib\java-decompiler.jar&quot; org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler -dgs=true wms-inv-2.0.1.jingao.12.jar &quot;D:\code\wms\database\wms-inv&quot;<br></code></pre></td></tr></table></figure><h1 id="3-è§£å‹jaråŒ…"><a href="#3-è§£å‹jaråŒ…" class="headerlink" title="3. è§£å‹jaråŒ…"></a>3. è§£å‹jaråŒ…</h1><p>ä½¿ç”¨ä¸Šè¿°å‘½ä»¤æ‰§è¡Œåï¼Œä¼šåœ¨ <code>D:\code\wms\database\wms-inv</code>ä¸‹ç”ŸæˆjaråŒ…ï¼Œè§£å‹ç¼©å³å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">jar xf wms-inv-2.0.1.jingao.12.jar<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>åç«¯å¼€å‘è§„èŒƒ</title>
    <link href="/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/"/>
    <url>/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Javaå¼€å‘è§„èŒƒ"><a href="#1-Javaå¼€å‘è§„èŒƒ" class="headerlink" title="1. Javaå¼€å‘è§„èŒƒ"></a>1. Javaå¼€å‘è§„èŒƒ</h1><h3 id="1-1-å‘½åé£æ ¼ï¼š"><a href="#1-1-å‘½åé£æ ¼ï¼š" class="headerlink" title="1.1. å‘½åé£æ ¼ï¼š"></a>1.1. å‘½åé£æ ¼ï¼š</h3><ol><li><p>ã€å¼ºåˆ¶ã€‘æŠ½è±¡ç±»å‘½åä»¥Abstractæˆ–Baseå¼€å¤´ï¼Œå¼‚å¸¸å‘½åä»¥Exceptionç»“å°¾ï¼Œæµ‹è¯•ç±»ä»¥å®ƒè¦æµ‹è¯•çš„ç±»åç§°å¼€å§‹Testç»“æŸ</p></li><li><p>ã€å¼ºåˆ¶ã€‘POJOç±»ä¸­å¸ƒå°”ç±»å‹çš„å˜é‡ï¼Œéƒ½ä¸èƒ½åŠ isï¼Œ å¦åˆ™æ¡†æ¶è§£æä¼šå‡ºç°åºåˆ—åŒ–é”™è¯¯ï¼Œæ¯”å¦‚ï¼šisDelete</p></li><li><p>ã€å¼ºåˆ¶ã€‘æ¥å£ä¸­çš„æ–¹æ³•å’Œå±æ€§ä¸è¦åŠ ä»»ä½•ä¿®é¥°ç¬¦å·ï¼ˆpublicä¹Ÿä¸è¦åŠ ï¼‰ï¼Œä¿æŒä»£ç æ•´æ´ï¼Œå¹¶ä¸”åŠ ä¸Šæœ‰æ•ˆçš„docæ³¨é‡Šï¼Œå°½é‡åˆ«åœ¨æ¥å£é‡Œå®šä¹‰å¸¸é‡</p></li><li><p>ã€å¼ºåˆ¶ã€‘æšä¸¾ç±»åå»ºè®®åŠ ä¸ŠENUMåç¼€</p></li><li><p>ã€æ¨èã€‘å¦‚æœæ¨¡å—ã€ç±»ã€æ¥å£ä½¿ç”¨äº†è®¾è®¡æ¨¡å¼ï¼Œåœ¨å‘½åæ—¶éœ€è¦ä½“ç°å‡ºè®¾è®¡æ¨¡å¼ï¼Œå¦‚ï¼šOrderFactory, LoginProxy, ResourceObserver</p></li><li><p>ã€æ¨èã€‘å„å±‚å‘½åè§„èŒƒ</p></li><li><ol><li>Service&#x2F;Daoå‘½åè§„èŒƒ</li></ol></li><li><ol><li><ol><li>è·å–å•ä¸ªå¯¹è±¡çš„æ–¹æ³•ç”¨getåšå‰ç¼€</li><li>è·å–å¤šä¸ªå¯¹è±¡çš„æ–¹æ³•ç”¨liståšå‰ç¼€</li><li>è·å–ç»Ÿè®¡å€¼çš„æ–¹æ³•ç”¨countåšå‰ç¼€</li></ol></li></ol></li><li><ol><li>é¢†åŸŸå±‚å‘½åè§„èŒƒ</li></ol></li><li><ol><li><ol><li>æ•°æ®å¯¹è±¡ï¼šxxxDo</li><li>æ•°æ®ä¼ è¾“å¯¹è±¡ï¼šxxxDTO</li><li>å±•ç¤ºå¯¹è±¡: xxxVO</li><li>POJO æ˜¯DOã€DTOã€VOã€BOçš„ç»Ÿç§°ï¼Œç¦æ­¢å‘½åä¸ºxxxPOJO</li></ol></li></ol></li></ol><h3 id="1-2-å¸¸é‡å®šä¹‰ï¼š"><a href="#1-2-å¸¸é‡å®šä¹‰ï¼š" class="headerlink" title="1.2. å¸¸é‡å®šä¹‰ï¼š"></a>1.2. å¸¸é‡å®šä¹‰ï¼š</h3><ol><li>ã€å¼ºåˆ¶ã€‘longæˆ–è€…Longåˆå§‹èµ‹å€¼æ—¶ï¼Œä¸èƒ½ä½¿ç”¨å°å†™çš„lï¼Œå°å†™çš„å®¹æ˜“ä¸æ•°å­—1æ··æ·†ã€‚å¦‚ï¼šLong a &#x3D; 2l; 2læ˜¯æ•°å­—21è¿˜æ˜¯Longç±»å‹çš„2ï¼Ÿ</li><li>ã€å¼ºåˆ¶ã€‘ä¸è¦ç”¨ä¸€ä¸ªå¸¸é‡ç±»ç»´æŠ¤æ‰€æœ‰å¸¸é‡ï¼Œè€Œæ˜¯åº”è¯¥æŒ‰å¸¸é‡åŠŸèƒ½åˆ†ç±»ï¼Œå¦‚ç¼“å­˜çš„æ”¾åœ¨CacheConstä¸‹ï¼Œç³»ç»Ÿé…ç½®çš„æ”¾åœ¨ConfigConstä¸‹</li></ol><h3 id="1-3-æ•°æ®ç±»å‹å®šä¹‰"><a href="#1-3-æ•°æ®ç±»å‹å®šä¹‰" class="headerlink" title="1.3. æ•°æ®ç±»å‹å®šä¹‰"></a>1.3. æ•°æ®ç±»å‹å®šä¹‰</h3><ol><li>ã€å¼ºåˆ¶ã€‘æ‰€æœ‰çš„POJOç±»å¿…é¡»ä½¿ç”¨åŒ…è£…æ•°æ®ç±»å‹ï¼ˆåŒ…è£…ç±»å‹çš„é»˜è®¤å€¼ä¸ºnullï¼Œæé†’ä½¿ç”¨è€…è‡ªå·±èµ‹å€¼ï¼‰</li><li>ã€å¼ºåˆ¶ã€‘RPCæ–¹æ³•çš„è¿”å›å€¼å’Œå‚æ•°éƒ½å¿…é¡»ä½¿ç”¨åŒ…è£…æ•°æ®ç±»å‹ï¼ˆåŒ…è£…ç±»å‹çš„é»˜è®¤å€¼ä¸ºnullï¼ŒRPCè°ƒç”¨å¤±è´¥æ—¶ï¼Œä¸ºnullå¯ä»¥è¡¨ç¤ºé¢å¤–çš„ä¿¡æ¯ï¼‰</li><li>ã€æ¨èã€‘æ‰€æœ‰çš„å±€éƒ¨å˜é‡éƒ½ä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆåŸºæœ¬æ•°æ®ç±»å‹çš„é»˜è®¤å€¼ä¸ºå¯¹åº”ç±»å‹çš„é»˜è®¤å€¼ï¼‰</li></ol><h3 id="1-4-å…¶ä»–"><a href="#1-4-å…¶ä»–" class="headerlink" title="1.4. å…¶ä»–"></a>1.4. å…¶ä»–</h3><ol><li>å½“ä¸€ä¸ªç±»æœ‰å¤šä¸ªæ„é€ æ–¹æ³•æˆ–è€…åŒåæ–¹æ³•æ—¶ï¼Œåº”è¯¥æŒ‰é¡ºåºæ”¾åœ¨ä¸€èµ·ï¼ˆpublic&gt;protect&gt;privateï¼‰</li><li>æ–¹æ³•çš„è¿”å›å€¼å¦‚æœæ˜¯â€œListã€Setã€Mapâ€æ—¶ï¼Œä¸å…è®¸è¿”å›nullï¼Œè€Œæ˜¯è¿”å›Clollectionsåº•ä¸‹çš„å•ä¾‹å¯¹è±¡</li><li>åœ¨ä½¿ç”¨å¹³å°èµ„æºï¼Œå¦‚çŸ­ä¿¡ï¼Œé‚®ä»¶ï¼Œç”µè¯ï¼Œä¸‹å•ï¼Œæ”¯ä»˜ï¼Œå¿…é¡»å®ç°æ­£ç¡®çš„é˜²é‡æ”¾é™åˆ¶ï¼Œå¦‚ï¼šæ•°é‡é™åˆ¶ï¼ŒéªŒè¯ç æ ¡éªŒï¼Œé¿å…è¢«æ»¥åˆ·</li><li>åœ¨å‘å¸–ï¼Œè¯„è®ºï¼Œå‘é€å³æ—¶æ¶ˆæ¯ç­‰ç”¨æˆ·ç”Ÿæˆå†…å®¹çš„åœºæ™¯ï¼Œå¿…é¡»å®ç°é˜²é‡åˆ·ï¼Œæ–‡æœ¬å†…å®¹è¿ç¦è¯è¿‡æ»¤ç­‰é£æ§ç­–ç•¥</li><li>ä¸å»ºè®®åœ¨å¾ªç¯ä¸­æŸ¥è¯¢æ•°æ®ã€æ–°å¢æˆ–æ›´æ–°ï¼Œä¼šå¢åŠ æ•°æ®åº“æŸ¥è¯¢è´Ÿè½½ï¼Œå½“SQLæ€§èƒ½å·®æ—¶ä¼šå¯¼è‡´é•¿äº‹åŠ¡æˆ–é”ç­‰å¾…ï¼Œæ”¹ç”¨æ‰¹é‡æŸ¥è¯¢åä½¿ç”¨MapåŒ¹é…ï¼Œæ‰¹é‡æ–°å¢å’Œæ›´æ–°</li><li>å£°æ˜å¼äº‹åŠ¡æ³¨è§£ï¼Œæ³¨æ„äº‹åŠ¡çš„èŒƒå›´å’Œä¼ æ’­æ€§</li><li>éç‰¹æ®Šæƒ…å†µï¼Œç¦ç”¨å†…å­˜åˆ†é¡µ</li><li>æŸ¥è¯¢çš„æ—¶å€™å°½é‡å¸¦ä¸Šç´¢å¼•ï¼Œæ¥åšå”¯ä¸€æ€§æŸ¥è¯¢</li></ol><h1 id="2-mysqlæ•°æ®åº“è§„èŒƒ"><a href="#2-mysqlæ•°æ®åº“è§„èŒƒ" class="headerlink" title="2. mysqlæ•°æ®åº“è§„èŒƒ"></a>2. mysqlæ•°æ®åº“è§„èŒƒ</h1><ol><li>è¡¨è¾¾æ˜¯å¦æ¦‚å¿µçš„å­—æ®µå¿…é¡»ä½¿ç”¨is_xxxçš„æ–¹å¼å‘½åï¼Œæ•°æ®ç±»å‹ä¸º undesigned_tinyint(1è¡¨ç¤ºæ˜¯ï¼Œ 0è¡¨ç¤ºå¦)ï¼Œ å¦‚ï¼šis_deleted, ä»»ä½•å­—æ®µç±»å‹ä¸ºéè´Ÿæ•°å¿…é¡»æ˜¯undesigned</li><li>å°æ•°ç±»å‹ä¸ºdecimalç¦æ­¢ä½¿ç”¨floatæˆ–è€…dubbleï¼Œé¿å…ç²¾åº¦æŸå¤±</li><li>è¶…è¿‡3ä¸ªè¡¨ç¦æ­¢join</li><li>ä¸è¦ä½¿ç”¨count(åˆ—å)æ›¿ä»£count(<em>), äºŒè€…ç»“æœä¸åŒï¼Œcount(</em>)ä¼šç»Ÿè®¡å€¼ä¸ºNULLçš„è¡Œï¼Œcount(åˆ—å)ä¸ä¼š</li></ol><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
    
    
    <categories>
      
      <category>ä»£ç ä¹‹ä¸‘</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç»„ä»¶ç”Ÿäº§çš„å·¥è‰º</title>
    <link href="/%E7%BB%84%E4%BB%B6%E7%94%9F%E4%BA%A7%E7%9A%84%E5%B7%A5%E8%89%BA/"/>
    <url>/%E7%BB%84%E4%BB%B6%E7%94%9F%E4%BA%A7%E7%9A%84%E5%B7%A5%E8%89%BA/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="289c196a73f57c979924e09ddd753f394683b4d34a541e2e0fad52792b5effaa">a497b25e6862ef932bd8b8e9634b73107fd22b7c0b6aeb86f1e0db1a2c94058e7b61913394f761f2698ff08edc83b403278cb4c4569b0971bd384485139e354f526b73ad8cae3f873fdc12a6b9f330183640544164d682e3f95921dc334ddcb98e68e515851af62631b78793eacb5bfcc05c70b28a0f2c56b86bb10b939b142c0579fbfa0aa460b88adb7349a6950bb2580dd93ed89c4875681eda39005b6524f1c7846b30ccf2643afd9fe40255cfa0ab5cc64353e34bff9b97d43f551b65d8e34f990f5546bf2aaf71b8b87bbcdf27bbc3e3ef35f66d769504b0dac3e630744a6be0735aae0c5a0ef5cedc7e5072700a06e6026312ee966180c3411138e01af1f65943cd685fc804245efd55513e5edb0302562c3194349680f395a6c29801d44c107d1d2797c4df9d8101b55074b56e1a65758cd4fd7da50174a5e2ce4392ef7360080c9fbd18e9c08358a3e7196ca4f3ee3109c006a3fd1a05aabe96b4f435c2219badf7f7a90bf6d8b82455e4c0bf5bc126acacb99193d41f63897bead845c2b353ef0d5b54d0c8be2552da5411fc4738799b1ff4a5859b94d044e5d579f01aeea0502f988bc06df377fe10d8567ea67917ef04637e5b2ef01087a79d32bf91cf03f448d0d2aada030d836951667bbf542a789c5944dec3bd3c311c75e8f9a0825ce13a45d51331b2e2a581a856a47c10b181eeb1f3a92b324ebd2bdd39d377cc40d02156d4c8bc1af1afc7e0e8ad0ce65600d7ef84202011320eb0dcfd96c7489b02f77062dcbc5f17dd7ac2b7a76e6f13ee0efdb4d576d0c4878c5b8f12f10663aafdc9e57ac797311024a7ffcbab42ebd7b9d10c5324998d5c195d42fa457cc1ede13630487b490b7ca0a7fe1d2431db110d29059fca6471a777b9005cfb7287bc594cff3c73fce9c30e3e9618ef2459a5728064c155b52eabaf237e9c51069fbf411934be59c95cba1bf906e40d99d1718969596f6a2af1d4dde4d6415b9b643f4816ca4e9b19afe453c77e243aa13168ea216de28c23cd41ffa9a0f3759f5e8af2d9d4570e5b701ab562712434494e4b563aaa001e2a9a96ca7e506da1a42e6751ec74fc2daa03e0dfad377e884b1875b2951df98dc18e509526f41239e2b415bb68541aafd35c875b61457615f39b5490096a0eeaa9e46c03afe1139bbdef4d06434a411baaf443ccad9d5a21dc5512551b5cb07d1c1d3e6b353d58c7de562cb05d07dc6f4ab5113d8363557b1765fd1e7d3c985c41083202a4005286544169c4941f0dbe2f20e89a5167912cebab965e92faed7299067901ffeac9e1202d02f595a07ad3670c1c903e9efc5fe32f1db15ab2f58a4e34f9cf9e3fcaac7604e710fa17817c5c34296732a512569bb326bfcb87f414750314f1a132ec98b10597ad8f317cdeee005ded167a5a698d5a00a4dd92b7c9dd267d26b540918ddb8bf5924a36dca85401762ad28f4838123a355b00847b16c4c9be6a0358093f30d2df3b5f9ee349f6f3847da4d0220f38959114f7ea50b7eb80c524a78c3f46c3c954ec2f5d7cfab6edf1c58894dcfd2d4307d7210566c52490ae23e33d6cd9ff1c79fde57b750fdc70710ffff5462bbb970132110d686b00de163389b7c5093f90153890254dda139c27f36878b5755c3f26f6236b9a3a1320c50e1a664682e806a345b2857a1b651fac87fcade1278b8d3dc5968febe9a8d55a2c8d7fc6dcc2bdafe4306fcabb2119f01fd87a57b2fd2397f02bfac684d8fd3680206d8d88d6fa024a8d4553a28ab98e1cab1fd49183cab43a144e2adffbbe1c686f0df207949c42c5c125b1f7a8dcde77c34aefbc9d0a707f3db0a353cd8f965f9757917e141f7c088a04cf9378d8f8ec1f51f67f946d86ede94a3a0f65dd1c677b73505c27687177cbb7d398fcacb267174c3ddbe33c28666f8a5ed1f38dc5f374995091e4ab6d1457b00636ef58242ec39c15159cafc6a8e549d146cba06baa6105a07b8f7df4b467f98a08112574968f973a37791817212b95365584be7a88a87e75ee55a2e1557ff1af93bf157927e59e7accd60cc20981e0e31df90f704c2ef1ccb4c3eb2e3c9cd310d82bf53804316806379bdbb1f55a0006f99f70afd710f9fa31a14fbfbdfd0dc8e11c560f9e3599a64c181c761fc8aecf85f6e1cc2a5f8e0b4d8db1820aaa7f35be79b9cf8c9038758a4ab24bd45f3f2b81412438fcbbbc192d053136e23422ec2c2113c41963a4f7657946c482ede73e30c42b368e5cb51e3c377ef70c82d122590cd08a64416e740a114e00d1f60daf4897903ac90c08c1f39fb6d18eec206bf24da14f0a9a880090ba8808e5eac45edcf4af21d1130edfda5118ae4d394202208b6e6b69d07acb9a80d4d0c941857498d18f1c211eea5ab927052586fd8c244c0f15ae7e7515866ad886eb9d134273a35716044959916706d3dbd885e2f8f74f74d6f1165d74f12df4c982441d94585293038eb47885e06697c5113aef9baa03d28e4742feb3526de07ed005fd961af1936973a27d920d77c2a8dd50d7da9953407d2c9e8c444d94b1373da42cfb3bc94ade3d8f925b4afd981b778684488c86ac20ca29f5bdab09748348e66a940b04b142b79962afc128c14401ab4bde426733915b556d0cd4215ae046c45cad2bb7029f01a24e99b14a63b79267f0da7ad42a96db2dd399690d65f5778e9cd30ea3c3da43cf5e226ecd7d16c1bf06ebb2312b7becd31509e7e05ed5ddba2dcb71d06efb6211727b3d92ca9e2a5bd021747ed9b6bc2f2a57b5a734c73425551d1020405be7710efcd3995d919380ad11683ee9cce72b1c873e40ab883d836f3b352da84bfe4737f23f40e611ea925ac178fe9752d2e4dc3721cbfb9e40d9453c55e94566a94bb8902c79b191c77ef9c3b42e5368b6d4b0731f48dea47193b7321407747656c1312e36d4e7827c0c7d72ef213d8f87de75fcbf3c08bea60cde391141422d04c1a0f0adaf32230eabc6ef7304a69d514b7bed783d7a523647bfb7564f000a36540f6f44f55321c9e7618633c74f5e9510f85b21c6deffeeb2f5c663d06ecfb61205b1d33e612466d6e15718bfd1c704816c57382ea65b24e19916590d671649735707534401e9d4c7735644c081ca8fecb8e02626d28da7280cbcee3c2774293db829607668ae0c17bd6ff6f75216dd9d2ba7ee0ec7191edd79a79b8a50e6ad562b217b88dd39b7f97bab5e27aa81a8a5903e2d1ce31cc0726fa8719cc1e439ecefeed0d607690436fec911b77cc6006ed4198fdfc4c56172b45731f24a25af81cb78bce626f819f7bde9e3294ccd9a09be392bca10a12d90d10c16e1830b54f4dd59fc1a4358e3658934d1a1b49a147ee60de9ed7cd941da7ebc1aabeda668cbaa91233c8d51d5f4d769d96bf0483a754b504a991f3f98b8ba9976c865998c49452a106a2f21ef9f2007017e42d5b6c48ab54127244ef1bab38e4143b582c2632d878ebf7653594abe0cf96ff373ce580bcf7fc7d7a7fc8ffb931fd19ca6e19773fae51032968d5eec697ecabdf1274a7591a55391c82b13702745edd72bb9a609c7eda01ab4867e47909ee14e349572b4aeb27a2514ab261e3c941feaa95f36ea9bf3b919dc5e315bb7db96908af11cd20bad28db227595470d0cf0da6b083aca1118b51cea692d6f7dd5a53bd3002bfa63db66d0d2cec8b193f457e0d87665e9d9525584215dd03f0e7e440c051f9340c4b3c0c3ce4ad23d5aaa554c680990d7ed1aeba682765589700f759006d90c3976d1d1ca28ab7926b658198cb1b547e4b00aa60d021c3f4b9e75746ef4d4b41f6837aa21ec074747fb26d70856ded9448bfe9f89612b61c9fc9c7959e99ee7ceca2c3a61875eae6d5fa69a56d797a0f1f1d3a467f44bfd6f33fcf3bf35e96cb50c9d13e959a1c311582c62dc9f1d0ab4aacfdcbef861cbaa1f7a8b2eb11bfe02f824f6e51954388d1c942f98ae0edc94d9f0acc90b741b4dce50d360d46a7ff29005ed088a67149cbb38efd77de35ef35626ea1f2323590cba55dc2a512388d0027a311b63056e177e98710e622d4e1c6499b175d8743f90780f20b0e634fd7379322302d19213cd284f10f55ececac18e29826bac77668b1105f2d1613fa4eeda288ba025831ab97739aab6e3dc6cfdaa8b9d4f2af7b57c8765d6ca634c9c86756506a0de3cecdd2a8fa03dc75cd4a16eb31f4bdc4cdde3b41bce8dcc814c812ffa23ba839fdec5daa12fc6414fa7ae3b34ea14b050e7e0210a2bbd47efba58d875769976d7a133c8c54f199b27264e2696ab1244c1f400e1bcb00679854f075658b6d3d6236d813961361df609a71753df3b23fef7705a8531eb89f5bcdeab893ab637946d62574781cb7d6dc725438a673c1b97b8fc0f3984148945c55f8acb1c4a2d3c859ed5bf614ff5bf8f7a44f42da61ed5144ec14dae4df0142ebce2be2364ca2492578dec9dd9b55490b5ced5168c317a01c1c29094da21bb95d64a07579847646442b2225c9f53f96ac73e8884283e2068eb24542b5be48bc7a88262ab742d39eeca1ea28cf86e70ba009be0fba8f30f54b084caa0b3e6d0025a088735b4202fe1cc1dc30d31195b2ae46c7a0c897c7a407b7396667a63734435d2ce0030c027589c513f8cdd1c69b768f9813a83f3bb08ab858938e4e5c21ba9d21d80333cd0e4b7518332238f99bf79f9c31490c0c72847ffe69b2aa0d549bc4e7f09cd236ef726f6b62288b1b192d0b32c88088e8f25df5e9ec2377d0ea86ace93eba24e4630cbcbe7f6626fa753e39b07ef0f4499cd835bcab1e9af65bbf73015b443ec39bc6c1ce31c78a14346824321ae1a24e52b6b419077bb4b4be14596ef5ceb5f56e885bbb077a05d7688351fdde31ef78fe0362a6d940d370dfbdfc072b6d5476654be17e351c1ec833eb3f1ac300e86e8a4879e03bdc989a51968a1e59d654465b459ca3df799f45fa24b844950f891bc1ec234465e675869c0cbef41e3885a6e8b50277328db4215848229bb85c47fb65f2c844b5e6a748f99fcaf74b19010d0c8319fcc3aa83d5e9488d54275011d0bc58ed7c2accd7f12588cf123dde56ca8187dd9c6bf450462b998eaa0d69f4e4725d4561a65f43087f43d4bbe51d08b91a1860e2efd727a00ae4908b12327fa776c5295fcb60c95d312b59c2d48ef1aca67d7b73f786f75c1ced5f867b8fb52e26f7706c4b963f9c4e675e659aaf19b9a843938551861dbe0d06db081f1bea8b94188ebb13ebe1521d4e3af059baa39933b43890b5fcdc4740bc0bdd84ad2de9fb90d3a833d514cba5ba7614caf94a8b28b85276d19c58fbfac5125fcdbcdca1b1df64b885a43c437d0c5fc5cfb3b72559d69a248b504531870b0433dca848e48b0d0401244154d9786102e9cda9579948cae839d1ef5364b73f20d692e7941969e3fec8d755092e6ea55b1b6118f8a56818e1c5da5f0dac9e8ca374022c975cfd82436c8df8879f1dc81bf8c106e509d856d40243b6ce1e37797797efefed6ee59be0966c2c8e4dc3f5c4fec6bc267d359a202a8c120c2a468385fafd414824e0938cededfb3e007145def112b6a380323cd27ea1fbb390de1a29dc13ba989433247b74f948307c64b731883d110529c9a1e3bb7500a9dc92abaa1d97fd6f2a275dbe85c315a21438bf8cad2899634ff7e8b51a8b8a20366922f6a72d2438e33f301be63b3fc8faa612eabe7803fd2aa39315ec17207e21da9c9addf991d6d3d372d97feb822c174a7954c968233dd22a899765f16de9573e12eacac2ba016ee7444ecbb226ce74fad11765e6ef1d321ce8c373696dc1f75804be2a2e528262bedc9a929c345d91a4832854ac07da9fcfd332f603257b187ecb33ecc731942c3a9f1bbee193a842597cbe93b5f050981d59ff8c22ca889ec0d902c7dc04f096847ff65ab913b7c66c422e7b1ee225ec62eee898617ab7c33b30b8ee51eafbfeb4e2a07e7b1f5ac0d9f0d8b52bf0f95bf3c7f7a47fcbf467f66329ad4bac03f56fb865ab4077a8088b9bd4e4b8e4a2c7a38d3d032d9cb3355ad60263576930ba93d7e193d92163cad1400c000ec930dbaa94480127c652d77588cd23eda9a200e31bed5dda9a1fc40bc599c8803b2644cbd8da989bafefa1207a5c160d9639f88dc88a7fd61d8c5d89eb98b409291fd6cb8768036906740fa8d26b2e53a1d4c6596ccbcc349a3505072e9443f9be7cf95513bbfa21dde8e07b1e3a3efc33614b1edd510271a9622cdb92c32827b4cf5c4d425175af597befb9735cbfc9efcfa0a6d43dc16677e48fe26cb99a5a1a4453cd4f69afb91310b8c4f4892b8b8f240e0e947f6a3c8a1689408afcbb99b93b94e61054141bf5f4a0211d056a966ab35d695f8cb8a8796d7d34fdc820f03ca6e72d9605c2a0b02387c83ff06208f0de7c382d616434e14d1ccf84bc21d513d2472a84830c9be393f28a4df94aace1c0d1ddf36681dd45811a19cff40e08db4152b1615d58e7f472e52431a187a87ec15569f9ae814d2ab774b7f3cdda50952a2127ac18cf87861d093edb56fff0a81f2a7b2873b5e70512b608f9ccd03b5a22b7fe3a010268f6ce806732bf5debd0b2bae699de55f31b5e5c782388b9ebc520f80d812d86d54af005f60a7bfc4cd5f25b46bd7b4a8f489bbebd2149379724819194139fbab87369c034f723b4fa48456335464c2092ac578dc95a941a39f997e9cdde08e82e4334ae9e53836ff49fac4c4e39e2d008515d372a98c0fe76d341625bb14a0f6285669897b34a28dd618fa789950e4619eb38db2db44ae9978054f16710e2ab1a6b765064eb5e3ce2b71036d3aa2463cdca5fc4eb90979085e0acadd431b8e7032052c3816e953e2227fff491622dd8bcaf6a002c32c90c18276f507a20996becf6793b5b06640d5041eb2aa3ae8ee429349980fbac5b698270d2b98efb4848983180f0636e786a60c9fd096adccd9112a3637a1eccc2ae6a3d801d450f5cb63c5702c805526929d6e5b0e70adcec9a4516997657468050ca12067c9a66941c4fc64ebe977abbe41caa5ab972a9fc11839aa5efb32d86c83180e1dfef19ec9fd2c706c5edc093788673c6868d20b0d9a091ad851946d346886c6b1b23063537fc243cc5caadba88e5601d8a1529dbc3a4d17c145c7635f0a89af369f3d6127339b5f4d8ad1c71cc8cdb387c049799e65b046d24109198947ddfe1bb2557fe3dc5e28a81fb745ea08384afd4e3595fd47613bf64052d678c6a048f491b9660534c959921aec224f1ad8d97f3a331fb209bc8751f477457479fcfa2581b5842eeb37bbab9b2154d02e440ed519897c5c09edc4141c4f9d9292996ec1a59af2f76576066774ae849b7cb3afe90e4c929d584a4e28771ab22b539e6dde8ba7f785fbf1d9c6fd0aed64e0b3c50d822fbfb8da3e2c5b95b3dd279c21a2482b0ca42d4ed1707623d036b69b0a69222c35fc98f2e98b980c0ded784f6c21cfd6a0d5b389a1d5661490b669243cb3e3e01049fc47b05949f844829d935f9e1637ee5257b194b39b24980c172f6bae7d50b95d2f4d435209c9467a66f2cf3bbfa924b687206e09451d7858daca75aa01d3c3f0f2cbf2093778f0c3e6f532264d8102a3f68b38e880f59187cbd71297a3df8973605f428ffe7ab72634dfe10d371173fed497e7b8aa7a9eda97e808d508b61dd8db0ecfb1465e4a34e46a365f97043d41939db3776aaa608624a361f934e99cfd1d372097b62386bd7a13070708104624e6092d7f32401d400b0607c19056b0fafa229bf63aec8a8ccf6fe4c777508ad5740561e3284a9e8c01a68f6d4549364d9aa72d8a63476d8f3f1e6e44b6e9ce5ce59672d07182d7905545deaeba7d15199126151e60ca195ac485b29e537d0b7ea5a5ff53fa77ca2fcc8f5b7af5e5d1386f49a914610894b64114de346c355356d7927ca3a1bffa1f55f070b775c72f99ff3a3b8ea74c237f09f6cfc39003046252928cd5b62bdb1bf2d25b0b8c414ccfd940d90d00bc564e218d3b6f956ea3abd2d162a4eb60e3e8c80b5d9da228e404b8d619538bb69f2661a683bf1e0acdd1c15dd4799b7f7053ba54f1abf3c47805107c805f0ae3b4025c47f3ca97c8af3501f24a92149c81ab7f69101a0ad7fc5b7c4b0aec9c91089084f1fe05ce58a1774f6d39c5bc6b98a2c860b42a0ecde5e82f9df13a8dd56d87ffaa4681aa1ce03293ccb5c3b82ae9885b924f1a2bb2d8494faa75931eeea012a2a007b901a9f66a93e482d607afff80b15244196d265e98eea5d528cff5f23c7aa04a19215af6c9357ff9fef71a1099692b81e8bd56fb27a7a1f94839c3bb3fd0d802d36549d04a24d372984a6ea9bffe47c85ebe29653ae3d1c5defb1024780f343fdf09462ee26e0bd0aacd46d78dd43d022261e99f9de6c4d51deab6bf714c224579e3b11c292d1666540a2381f381c49e2f8466abb2ec0fd1663b2c5632360e1fac845cc6f6c870b1d9c309057ceaae768186d56e22b7976feda0fbafaf89e5af3b380139c123c38e206a88502c89f262e745d7859ef6502663532e87ab0a9c7ea551f29e3cf7ffe05c27168c879a1a66cc553ba7fb817542b321ff8fc3fa5aff45d24162ef4b0537be1b29c56d9858c7266c278ac8d01fcf0eb3daabb8634e4956751afd0dad27f00318111f7280240b9db8f8a361cd4a002eec22958260f4fce24016271e31d2abddb1cb1e53c8e25dbf21d22e7fd52c4ae61db1361d37cdc75f4706c97584b01349e0c4b3d11bfec05372ba84533ebfad0e715878ab5bb4e21c6dcf3b46124f911f1b223a21ce910fd12ca5ac5e6435ec471182d682ec711e2b2fa43f19e8fac3f18840772fe6e8b8294e84414ecf59675a659ddd54682432c58487a92e83e25e992b84e51997c8e676fbe3db622d82229e69a1f8580d3f3ef206bcbd1b9f91bf45ffe8c5a7af5d66fd54ac1a982439b48fdd27508467080150b1e6192d94e5a1e93f5d6bb605a55b67c86179f8d95235989b757067693455459c69e8e0891e3430d08fd473a672b2cc65ea14a52aa8178db4a975fb74adf649c757d57cc9fac9a0a0dc9e963ae493e7c8d5dd945c1842cf8708a6089ac193d9cc018bfad08527258e283ff5f6167f4d178fa9e7d81f5288e0a50713b27d0ac83cff4c70bc2e8bb9e343d21315b931ffd8104a1cff2661e32cdc3da05a587dc4e47dbd08f2b1b790d71e4fd0e668bcbd8f2bb264675520b9141057d62540a62dd07b3e09fe0bf34b7976899c7c22082ad1f5d41f39321615a05638ea6c8fd9ee38eec7af1ece710bea2ed129bb017f1b3c2ce12d3037d19eb20638ca40a6934d57642e1f274de597ee47e17de90e2d1986a1f7866dd2d33a11951552ec572a1a08c74e7f21ac0cb960d568eeec27d15af7ffe561fc385ec26647a45255c59ab2f3fd48f6049c81f9f87605b1dcbd33c2607b82403c2dd29705e47c34104c18bfe7250687503a2d8670dc9a462f5a778d15fc32e35865c46bf84f23bb758a5018f514963f7aced27e64e3fbe5db55e07e0e9459a2c971e5486b580ff756d013e212d03cbb5898a0b2e1b1f27ac96875dc1cb460080d88a30c210e662cf971c694826030c79ce6b681c7d33338aa41400b00d97b0796a4ba5239863877fcffe1f59d2ecf2b4465ab37df632d10a55f736aeeddaec03d3620c4926a3d7b8834b265b91330e172f4eba67ccf76d9184d670c5ad7270f201abf7d2cd924c53123546248c89e69144f444a3b9475db86c0d03accb9be4f4804b48175aeb4ca4f9b173c5a206388da7db0d2b75917f045f8d66d175a7779f36301a852e95bc145efaa192c0e709c7c9b8833967a0c5a01e5541aa2c0bb9310885842525853454651332cfb61f54236f2ecf11aa5b72e49ee6e5983a0a05521b12c680b6bd99d10cb81ffa0a8c2370fd8cb067936778061968bd163871b3cc8a2867de1a9873ae60579c16ad8ef0c9c76ce93168d0909965eabbeb5e21e86d86ad137654f1e92370a446a887f3c8245429d4c1bbf1ebdbc78a2e11cbc04e83bb92fc4289855e9bfcf7fb4e76ffe4066cec9ffcd8894b5d99bdc436a393dc08c82594f2a56dbb20ba52ff348657e6bb13936add72789279d593d6955ef03cf797afa8acf066818a625d8c8bf2288a1afdae6fcd6f97b5bb447dad9b5f098f3a416b3cb936b254c24487156d470db89296cbb4ac048cbf140cd9367de76c92f711dff20e9fa6e8cd797cd0d298c1c8eca74356bc5cfa74ae83ae053fc63c3da5acfcfa578a4ecfacf1b7710f70bb4602669292f90dff0b36c1156f40a702562d20d1b448775fad460d23cb755c7b3f867f3852c9ad5ddb461e3fd3ffc3fba2339f99413c6d02cd7b3b1997a2f2470f3895c1e5d4b663887d0d4eafd49b22601091795eb9d03ac353bfa06ac1ac62b22d13eaead07224cfb400478a5d62ee6119fb474493377b9a56921cbf0e44f48ed1d6ecd0af37b55cb013efb1682e2c113f2819359ba14d83f0d120053ecfe1d7a21e4f7f6c742eb6d8e0aa9fed7d788bbbd31ee1d1dfd369f4f86512d4bf20fef6b63ee2795896ea84a614edd5dca16a41365032ee6d028736874b19d2f7d1ade85e50416c8c390a1d871a26958478803acaf9ee1c574abddca800cb775bbc52941fb3c31512905d6cd523535d763ed706f7e629e114b26775992f184f643002e01e7d92cc10f60fbaf1d3df75474cca88364ea83a6a20de59ef27ba051013d5670a1ef02199218e4b0dbf3e57e77bceb8d9cef2b1452a7cdda63d2672f483c25e06165131a792b9c709c17ebbac973a1ba4ad8eae7e44b0be522d186785a198a7eb5e346f5712055f7d7f5e0ab99117e3127f9b7154c43dc4537215f031e58a5fb483f46f22b98d1b45df27868e8b0982fe78f2c8a3f644a941a1fdf5950f4b426b559bbdaf3098af198c4c180116e66ba6610421e0330c41764e76c4f83652f6e766060532f237822ff6db1e895098cf86f4134270c0f441d14b3bbd079b3388a491a35769cf4695a640d4e18108361c425b7f526478b3f1187b6ff102588c44dc4e4d945b97c7a99a6336c0e3a283be5c8effad2ad5dff07644a5f7ffa86c422d38de21d42375171983ee6498de5d620306f1e442975e90b185a073c4e7606ed7955d470c1cb109cb272af1320e1b4d7f4cabef8573edd9f138c19a0078508bed5435a99dad03b1932192612d93936215115f1fedb0557347f</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>å…‰ä¼å°çŸ¥è¯†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç”µæ± ç”Ÿäº§å·¥è‰º</title>
    <link href="/%E7%94%B5%E6%B1%A0%E7%94%9F%E4%BA%A7%E5%B7%A5%E8%89%BA/"/>
    <url>/%E7%94%B5%E6%B1%A0%E7%94%9F%E4%BA%A7%E5%B7%A5%E8%89%BA/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="9dca6e94ce5c3796fc57d806ecc82aa938b7f88bb21c747b40196bc08822ad84">a497b25e6862ef932bd8b8e9634b73107fd22b7c0b6aeb86f1e0db1a2c94058e7b61913394f761f2698ff08edc83b403278cb4c4569b0971bd384485139e354f526b73ad8cae3f873fdc12a6b9f330183640544164d682e3f95921dc334ddcb98e68e515851af62631b78793eacb5bfcc05c70b28a0f2c56b86bb10b939b142c0579fbfa0aa460b88adb7349a6950bb2580dd93ed89c4875681eda39005b6524f1c7846b30ccf2643afd9fe40255cfa0ab5cc64353e34bff9b97d43f551b65d83a7717c55accf9e291dc0a146ab0e2d7a617e2b28a214b78fed02a6173846117308206bfddfbf1aa01016e80b9efbab6311ba269a839fc61b294d6eef069ac34b7cf1994d8b5d4ad4f1b820de7d44b100c4bf90bfab12c05133a8357919bde46e13bde42f792da8b2e4d8f08d388ddcba4c32ec3e4bfcfc7be5461b35c3b46994a381e7f7714179628c2c1a69f6ecb68afc4e247428db5200552ac76145399dc883d9931403bec8d5f4cb7be7556bf14127fb96641567d065bda80f09fcfbaaa3577247a6e49ce5d04c59ed280f013e0d06b8a5dfcc6301ecbe62e051877920d25700e4103288dda68c5b49bd6f9f0c7551470ac3e8e06433222572fca5edbdc1c896443e69cbab4067cfc95d26368a9bfa52aa1d033131b084585082fa81aae88ee6ad4a20adbd9497e75407386f869755a2eadc0cabe43c922a6e6b6f432f011b85292f4647b9b2688bd8f359b84a5ef1717b8ba02e7e2671e5c1c806cf2057762079f5550112b13d8159fb3d3f2994eeb7529caae754a95dbce06f58ff6200ce03752d4f407394c90a094a31157ed095ed6dcd8c704abe70fd9f9015b59293bd9b6e07751a3c1daf4feea10ff8615870abaa324fc371b63394ddb8ede5dc3f851fd291fdb85991ae0e98a54eaa34d8b7c8429df9c9f0936c1cc4656ee4be535e288202f633ecea89aaaab0635186811471b1b8f2bdb501015d630f17cddf39ae42175ef33f95d6ea2a7c9801f8f4f8c32a49db03f1f3bbde8a50c100b13c13dec5c1ba4f83759c6f3868b33ccd253745b047261c01b2281d781f97c92354b6b37d5d9908028e51674c0b7785c1e6307ec08c232b626482bebae9d373a7ba479fa7ac4a464e5816a07a82f99b2b259a5a479369b2e35dda334d8b58be94f2c9e82f11908c0ca93deb1baf24748422789d2cd1d28a828eaf66af8290872d909b8dfa5995930d8a96dca076250b0fcef19c70c8ba31eb80ee8f1b49d807611228c85b8165f1408e0b0c1c6fc4a297ebb041eb4b571219acb14bdb02a8c9c54a7a021bdad8d791305e9a7d8b27ac517e12f0e8179386d2e263f6f5fcc705fe9e2f7f86bb42f9a2e580d28a944a95b34fb59ecddb07626ab1cd784ca67918e27978224db3f6a47d49f7af772a91a76c0b53faa9e6d256a6ea3eb5205a0916fe2dc11ad2c702c95470917ca9e7fe2deec0049e809a94d8a49f84d4b915532a6264e0161d134b16b68f01e6dc1d644200d3b1ece3fcb06d5c7cc3b5872018e36654fae6b7cd8813286d131297c5f25fcb7730f572088868ad04b82967093a083e57ca7c8ba1af0ec68d67fcad64679c8edba04600c3b1a89440c4e6e3488810d78d8daadd7508f1cdc4b48944015617d4d5e645fdd224ff26a35dc4aff36f58386913928e52aa4e4b1854b52e27f2dc103405c5a5119d0a72fa9ebd9bc9c8d1cd3cb3d238dbce8b36d5f69ec25bd94ab1948c6b32d324162083afca348f495f7d65bb37fe5eaff89af62a3ecc315ade8fdcbb9652ce5b63a28af8cbc58bddd588c6f259e720a4568d70539a3d825b6c7381fa6cb9b2f9c399085924b516a920456687c1b477f5518e048ea298e1fcb0870fcd63673de52b2bfa8e10c1106e661d8bd4966ccfc92c9010ebc73deb763a60c42fa7adea9e3b58be4583c218985d03b3b6aae4dac66f8309f76cf74f4edd1471067a1dd36a2baa423c613a9361bafe1218283dbd9bc278b3158b1afa1d3204c7b8363a7d6340fd0ce7ee8d25e8ee8ba855c0ad40394bcc6a0077988d37db820a730537cedb57cf6c6f5593ce1b56bf1dbc71ce3a5841395da8f1b1926c83b2bea07bcde1fd90fb2bcd2dc8e1e74091df17611f9bb499e63ce066c64456064fe8b4068819918ee5583110b56616d4a44a05b65aad8d278e7b6943f8b5e7e4588e226cb632e935034aec9b8680fb76be9c5576d724827f44cb043a5fb6241d8868265f6309ee8ccbc6522fdef1ad35fa23899161effd3d1076e46f69077e098d28438932214475188f923b4b21e272f6f029302777b731f8e5e9d36d8a57f036ffe6b329dacec6c85e20b8c1465d685db43a3b31a294c65b12463bf5cb9992f2f9b039da3cdc5232def891b1b7fc9f05fa44ea95a0ccad7baae8840f1a3947db8147b91e0852674e6c44197d79f87e5b76124b5ac01eaa3c70d53963647e704d48b9e5968bc8b49626e72a1a7fd22eedf8206059f9fc04a297001be5e7834fb0b68b805c2020cdbfd638223ecf53f62b83ee2158bab0811a45651a77d08f53ccf04154627415b8dba2859b1f0f6e9cd026f9326ff040cde5474292bb0e576b6787b15b56af03f88c82f5b862956cdf9c4aaf7d4a2f403b6d650412a1f530a7937954e7c0446b79ece76af84fcaa92d9485a61a60c11ae7cdcd61fefa05ee2303af014c7a5b838cb93fd8ad3475fb0613318e84011a0a3519b5acdd53a9da020a8a77f31babbb4358135a91a780a010e43269a2103088a64b899d3f9f4735aa9878c54e4fcf6e85e68c8340a89741b6e58dc48c2a6e30294e145d8c00f397be7a1161d9149948c8d0ae483423cc88621338b8b5d0e8ab7875bf2003697c3ec9f76c919a4b1397bbb2e7ac2af48bb08d0e4f5895e819047ee8af808c28a3b2a9adc9ef763f8d6ec744721cba3d29cb0797ddba04765e2a744a152b4f5683236b112d8e08c30fccb2b001cf15bba97e5d4972c68f757646e1e23e7a73774b6fa03e5cbe0ca591dd8c1252f17888427ec2c75644fe71dc265cdf7eafc75cfed5f0b8a4f4e2b5b895fb03dd5bd4a271f0550b2dde5dcddbc9ff2740a920d9d7762dc9d005925db354b58a0a0e9f2818c0cd0f702fe57ac1d65f40a0322ec4f38537e04711927964b1cbabe651fc50ac2a8a96633e61731fd36a4b3b359c3d1106ee2f06fd9eb7db0599b25eca794adbc1b04125a337e60c75d1538de863c7296f3b9b18a27af0e16c7294fbfe9f0eb13433c571f1f4548f2b2df6727ed88551bf20d48bf8ed8e4774173efc3f0ddc895c8557b807810d507c26fc0a8496db0a17af6872f3eed7b3619dbac71aa59ad39667405f262ccc77b697294eecb4bfe36ef6609a9a37622d89c067dea370580b23a942a8ce1deed25a8094b3e9c3b6f8eeb5b578a648dff8ea8f7e33c5f8a2f6658f98f4c2c350c3910397dd2550deeef85f962e04cea01b94c4a0c58972da5ac8bf82fe8136a3d172257b399ced78dc230f16b30fb7829a88703e5accd363861e89ee7e9637adb232e234fbb183705b108a2ea3a29b22d15b5c1ab403db4557b80a3c64e614029d836ef00a1d4454d42f484e4f6d286c2da65bf035d2e7f8bf5ac05fecd8f9a2ef37cc1065f3d2f172017e3a6457fa1399f77fabd6f6c95b44e07d92d13ddc141b7076fb94a66272892693323f6aee00b0da19d76e2acb765c9765b7e45a7a64726910fa8b67a98a3deacf848ad8969c123b3bed1922f73372df7237fed270b31e00ded208a6aede9ca5cbdfe18d631c073cdde09cac7c9171db67b4ab3d8ee4fd710d3d70657b3b9a840a9c783b037ba40be88c32816b66812b356816134ef7c061f5df0a401fdbb186fda3868f4b995bdbc7a27fb31a3de11b8acbb001e1243f792cadacd6143b9fb44d6d3d458f7e35e9b35f19a550eca2db706acf5d9179b950eff29cc3f79e031d258d6d594336b1714e36c5c75f6842cc0b09c5e2dcf8253995add2a0a878c12557668accc3b941dcc69b684964fa8ae516786dd9abecbc144aa8fc474409cdcb3bc286c77676a3897448921f125b246bd7f1051ae8386a13eb777eb60ccb375712c5c29f1c0638f6f5b932a1efd217888d2894e681745867e53b9948d07af6b4c3d48e446f4f308b39e442415ae1577e937495ac985d015e3a7ed0b5248a5bdc4de68450dd5e39f039cf4265d7e58cbe34d7eb0fe38a3d152cce6dd2a95758398284f3e53ade96f87c46fb7d69c669ddeef82b62aeb8b1112571fa8061fb20cc7872552a4176887ac0e5bd1893d6d469196651772b52eb4f9424117127e0ec20d245be97be275b8f4e470532719361fa3b60b3d7c3ea1df4074bfe018900cf150ef24033c2aeba91f5299a9f84ddd4f2510725f87138f5e7adadcd4e10612844b8d953c921ea8ba196d9b3094cefba993ce126a4f45d3b05c5d3e32cb537027030c5031389b87d856367df8f01b2841284dbf1ea13bde9bd6612b9842b8d30abf2a686fa2e5476525ffa0c0346b12abb88ef6d2ac3ebc2112844dd8ed90eb27b0ba2a5c8a180fea5dab733535919be86b3e92a951ca30a6ca9e3105ee5706cf52b0f1bddf553557b1b89bb0652266df985f0b3bfad620d35b1f36ff5f6325a1b1bd6f041f5b2b5f89cb28102049f0652f64befe9121a412d7e7233917a3df6be94850e1327e7db60951f555b3c5411b62b7276042152785a7e8873890c72aaee14c105ac6382872bc5313f2039d064f7fe14a7d54afa129e89ef876546738f290769cc564d4a58258f0094d615fdce07c55649b7fcb506a54320f496d538874864dfadd5265868188fb5bd684c87a8246e669801ca4a875baf5990347daac18065c8180e1d0e9acb8e0540739f39d4addfc38dc6cd2b2ae7dbc58e6f4d2670c44e87487526fd953938c6948674901d64c29730441b9cce69228cf9c8130db24421ed2cf38225bc6641194f9d3a133fc35154a0c0cab8572b73d4da02c12789cf8ef64c156f6883c0678b1e782b77e4ee565ea52fc66c5c3d3180f53aa0dd7ef4429648e8514712704a7901d889cf1e2ce6ce986765874adf1fb2c7a40841243f897b7e477c8e9d719a4f0dc1b57481e18a87a56b6f772ad7c4918f875564cc3373be8137b58165d489b493f48ff6e117916a406b94b17905757e4b394ab6e0ff64b513cea2a150d5a0716b637804dee92741de0cbc4e43c672b5a1d659c1dc3654fe8dfd989aa7f82bb41083955969f9fdf811fd600826eaea96fe1b6e8f29592801314141fba42c060f595544ccc58024cb2705eb611f947d63c03af758147e23c22ae9b7aca86e1d82412484ec6c1244816790a2b23ee46fc039bfbc52647e23aab0b380d5c0583ab16901bdad87836cab9335aaa6a3eaea5a1617a3e03e9330cedb85dcbb097f8bc8e4f976ed4513d08e816f803102f6fa281f3ce47230d519d43492c700ce2a84348607b9de327e8bc98f61da3ebab8bc77b06f8302d7a904946bb9f46205ced0c9c29503535704f3a77abbf2b649254e95bb078b6969c86155bb4fbaa9eddbbfc9597d8d77398a4831da0c13b6ce40e2cb3606861ebb714210db7f293c551431b02d8fb85aead4bebae0ee4ee03eb7285dab3ef1228911532d4086fe333875dd6304836776cb586fe8c398109cfa22b930b00ae4130639678c0ed436f02011e5588587ca8ebed118235ac9ba5a73aac00646228f635bc2366230be63ef791c40fa49937ac8b97cc6cb39a47b73ecf3a860e0f4b310d92d00f6e8461a1040a8f512edb221f4d0e7eeb04b61d9f7b2e237651d422d94a3ad25126f68043dbc655905105a8f7b0fbf915b7af7055b418a149d10b821a269d6600d21feefe2d44cfdca50ea198dcc2bc03db627abd7f3bae0eda9169ef86d1053653786c9d97b105edd33fde2f97993a8b853bd5ffd1d1e296137f600dd82d17c5b402ca645e60200c98036520a9ffc92cd27829c65b48b1153fe1311b428152a7a0b740b341401cd88c4966b4a78173e48b16e8005f90e752b76b9c01ac56ad7d5f2498ae96b2a4f2f185f003504e4b763ab765142cd7787395cdcbce3d8b68ce9927d7c1990ae0f475bb386391f48ac85041bd97dd1ac9e4552ddbb332d208c109944de36ba09b47dd51e03e67d28eff153da678072d9eee2a20c94afea25b24ea85744b0394f3fa946bf490c0517165d05b96767258cef585aef613f779e5dc383d3ad4e54846b3c1d6869c03985cc27c0ad5f4b088f3b4a596ae5cdb6c8b019384368ee7c2525821b3a59cf02fd8f4f8cf41816faa6255210dccbb89f0d2575686e5974f2a5480f7d98a64a2a5a7e1c472ac0c8111b9493fe55c07399944f9ed71bab83a38431b94fd648752060ac51a2765f200e43e38e782d9e2eb44c0c7ab7ea76f7ddc5a1c6114b482bb814dd22bd854bc0256f7ee593fbf402beae13e0eb8d38fe457a95a0ef6ad257241460982204dc6e74310fd2b5a4217888b07319767f137a810760f5e4f92401f95a3eac76491f81fc95037e8d0daa70b17aedff0b8b1a16e1a16f91d6cb9fc594bb4847fb00d32f1ddc9efbd818b59e4e500d0c7694ac81ab4a48bce94eafaedf5ad2f9667ac4a7fa457276998be96f867c7c725911f92c76b51ae0ba22b853a25a62c6e823b85b7ccf63b3ac4e0ddd50cb4aa07cd270cb1741e7f5b0560fb4bbf552e7320ea3566acdb7d7019af3a864c4d82cad4fd1de813825ee8153b6020e2c164889a14bdffa019d7941326bbdc59afe7a6d94c79a47d7ce81bcb2c3cc9c8354a0880369fcd4cb4e8e3027a1624ea0ea5dc47f4f0d2094df8469804a222eee6467a45a17bf0214142d19fd5fd71496b8b3c04737eb0d273d30ffedb0fd7a7bad48465357217605dee481bb0902fbe52908f8c16158bf721a310c20c7eb9249eb2603a38a51f90cf6a573d01321ac370a4ddfe4864d725e37a2fe1f2d9e3b37590a3fd676045240569a24672b7b6ff50256ac9b2cd2336e2c48eebc7e9679cc161746e4c517840aa513900d51dc22ef68f9e4e8509adb1dd6aa1d217509124f9db9a474cf80b959e7159100e51428c8db39fcf3a4ad8d42e2cbfffd1d7adcd6ff40e8330fefa97dbc061ad53abac9026bb121324858f3ae42ff0d224bb0f3fca344dffe862371db18a6974608246a003a5ed649cca29d56ccaf34d44efcfc01bc8db0ec09aad70c10a3cac943aa217a74ad1eddbcdfd0cb19321f57536e92b36f6a88317193da681fca51e2606d8187a7ed0c16634f2a759dac6d8fc51ab4b70b104294c109fc043e819724114bd6f5115888af2390fc2dc15db4d4bdaf24c06831aeb06e836b1949760a90c9391406ef84717a1e2d053b5d67be88c25b82c7b5fa6bc4cc7e7ebc3b4a0ffe514dce4972711725a888389a105603a6f2b38a684c0fb9d7d22921684e495b6abbf2e818cb80276de1485e59b88665040fd33557512058838cbc96fc63515fe8e8ad6ce1b8840fc8af8ad7112f3132225681996a270c3be0bee83dbdde456444cb8d63cc3f4b436a6a5e6dc6c5f4446245e828b03458dcec1a6f9729cd37d3d15b3cc02ecc9fe9426a1b8321e287abccf9bd46f78ec201aed3ff26c53fffaa085ee860dbe612e451286bc87aea87a50b543fc696b53074325085dcf2e1d0efe024aa46113f483d6b3deac558bae24e837d67eb80fd163e5280fcc0f5de8f92d9ba45a76006306109baf396b5b352d068285df5d11633bf757ee18eda342873e0c31b37d2108a671b0add132fee0c2a936b963c4331e8781fe462addf06af278e924b23adf464221adcb126650eb15447fe18a8291b0e9de1e16d5c8a04a120cf2df0cf748185870414644529682d0fe4f16334de5f5a55327760c62bf8924be83fa1b4aaf6506b47f1c496c9c25e70cc6b426aca9fb0a720ec95c74564ba143203372853b756f1d9a2a848f328fe31f8faa35242b3e57e03d7d9b0b700f9bdf7b9e46bbd966ab7ff1a06377a809f563ee631bd4ee73112a04c2202d0fea6078c4e5fb7eb3f018363ec2eb42d70e6e9b272f09376495b345f44fb6a7f1b01e6639d5d20edf121e24c52bc3223270ac6c4a7618f927eda70abc801ff51723f7f894235721d0462bba93ef6a468d368ea5cfc96bb3a51caf9eee82b8d898d9e1986ca325e146d5b3d1cb3933bea759ee772913d91e32dcb4f473e592ae06f9dd32b083065dcf072d7151cf3a19466108e2ec6fd0e873bc6b4af77d4a871f433e3fcebadec24b490c7b63319d712807207fe846eee7208b967054bb6ea09c83407a018530f2c1d7b85c1b058cd0d364d067e50e89d7af81f7780d088773f5d2ba934fa0b3c55a03704a9e35ce48206a50609e32601bbf469b86c572c26da119c9e51074bfc76e92852d805a0caab12dab663b86bfc86095e0020bac06d551a2c48e2e9e391e1151e86698296cdafdd4a5b39a2313cd4bd5587c33e2020c9b1a92bcb7337792073102df2a48afd75b8fed462e4cbbb90f5525e3fa8f743f372ee6d818c073b052da37660bc303a03711f5f445ede4563b90ee7105496dd7c72b083c7901d0610c1065b823337fa08e3d22c4f8e28585ff7959e21dfc6ff08bde32e8270c606a7b57b95384ed93297f378e0962e049a149f4055ea67f13c867806376bb7c15e7d28e2f54ddc9813b32305f8fb6e406b6db78ad78cbd74b2169225785ca829eef8dc3e31f489966a4ce5d8f5ffaf639fd045956812c761caf87daa4be162b07a02a7f413385ed9d35385f96adaa8a577e13909c72ad89cfc4e8dcef4c0d8abba469ce0e6e928a6c908e5716151e0a6130809098525717225b13b5a8a850a89f4e65601847d0ff1ef334a550636ce315f85547d349b6de1e56aa02421540f24e550940e94b4110927ad36d92b218092a7a782e25514cafb489e13b42e1495eeb29998023109c418bbf0a4562c610e7b08fbfef52f7f3b18a43c960cba323a0bb910bd16ce9</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>å…‰ä¼å°çŸ¥è¯†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ‹‰æ™¶åˆ‡ç‰‡å·¥è‰º</title>
    <link href="/%E6%8B%89%E6%99%B6%E5%88%87%E7%89%87%E5%B7%A5%E8%89%BA/"/>
    <url>/%E6%8B%89%E6%99%B6%E5%88%87%E7%89%87%E5%B7%A5%E8%89%BA/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="641d90c7cc01e342def709f661a9d950526750d8f717a5537895d99cb89b0413">a497b25e6862ef932bd8b8e9634b73107fd22b7c0b6aeb86f1e0db1a2c94058e15d23e6fbc164af28f8f0be4de6566f46f2d7974ce66c1edbb7df13092f38080df001850e97c81e227cc53afbfc55d571ccaefdbfbbb134d59f605db3f875ea3e403ec4b660762562ad77c78adb47dd43ecf4e1b828e7e8545733e708ce2f38ddca265db32b64282e5b9776a489d0bc41b0216e389541bec8e145e872788ea98bf1ac095cf8bcc9ae0f4e8c2b13b35495f1cf392ca213cfa5079f81a1840ba2007896c0d9a04d609b4dd37a7f4ca7e164b01f760300d2e972b3c9ed9267e7849da0d2fd14f6fe7c987a223b96bf83234bd994ab3cae9e1f169de1ab05eec8605eb652412d4cec63109eb9de986ff600b871a5cccba4f21df7a5f843cc20c43497cadefeac010d60566a5f84a294d4cb117496eeeebbbb9fba71fe71c7ce3e86d8b624ba6bfe1063671acce3a89f98d8d5b329d0cbfbc10f64a050961fa0ce706ba3f46eb2d3c0805449ea89c37e6355f8a549798a5da11f180b01d6b47599389a2fcd3edb478c228aae7de052985fdca34c5a8c233e38a52a368f3073fe01ae2101b346f78989b9d8224d4e1cfa1f8be1cd0ca2d08591298347e0d93e798ae58cc8f3a54588c5ce573abfc63194a87df4147fc14e0431e30432b944e63e8e46f4a97f6de0c8a5cd0f29b8270b3cf0a14779520d805ee43e90cd32495ee70b276f63d530654191b4e6cee21d74da98b0050a49d12f3220845573aaa33fb790d1ef002ae352aff4608256bd8d5a6c49542b0ee3614724bf41025a9699c55029a78c7c7146f7fc017d0d8770350757047d3b7b4d37d298ee5300677f47422663abf6d07ef7ece8bae69bcb9a7f75755e552732fac5c75f5dba0ae2f690d9fd5fd5ceac8665f4d4348d1540fdb41f755a26050ec0c133b92134cfd2dcf26676df54db97093c01070cc7b027e5eee2a832e73418921be75c8746cb1d17660a051ac4e8ce7da83b133cde6a0b60060a814f0b09174c721fe95f98409aa77ab1d7a9a58ff4ea29348ca3d3a9c884901c30bcc7554bcbd6dab25defcb1791d955ce1ce879fc54583fe5416b08e3fbfe751f80bd343f92434b021fea4339eaa2d1eb5ae111c769997351b71b92d26937bcc9404185eaa288081df0499a6f919a4f1ef06f0894666d42a620a5875db3e4f768089451df45e3a50121e4a22ce6cee606c35e29e66c2139cf68934868308bc72ba6889cc7450de802f1e5099a3551a08f13cc83658d9947f283790894227ec293acaff9b15aa11297a895a407e9730ca3b68afbccefe56a74bdf7f09f5bdc53af07b09009f3f782abd879091c16e407edffa9e025252a7e6335166018e20ce4c00d5a63fd0cd18a00c4b27baa979d1a2539e4049b37f7c7d44dbb7595eb149b9a9c23f03f3e4b0159996c6ef9a386bbb78dde7bd037e43a5341df3da18853331edc3d46db6ae091b21d0d16ee7e46bf2e24157e189799f439666fece72c1d855dddcf6ffd9002ec456075c43829e90071abb067eff8ce2617e11dc8175d4933a475a257abce5e03a10fb3b6c717cf4eb68149ea918e9135c7cd9824e43f7fc16037495b945b9365de089443f7d241a5b26344a842ea1141e0542f8de01dfb9733407a09408b9fffcbb31fce9cdf86a47ff9cfec87309c8e5fd21a7db3e48da0bfa5e7906d93a7972729b035b2cc99140729f7ebec94c97355831629c12f9fac6a0041742fe91465cbeb55946c25095ad157e814277c9274cf05b6eb4feb17e6c63885e25662316bce27dfa46436e3f2f532a7a5f9c5289fd7548d23924abd63dffe76c2aef446b70cc52aee7e59977b1095aee5a9ea8c93ed5948cb78b9bc5cfbb14e912eb19da1f3ef98e9c2008ed3ef777b44c456cd0d7bf30a1ca88dc917ee7210362909f6746db961f4c10efb58996111bc9d5558f03e4106ea40c90157c15e4a6c0d318ca88e0e80eb6788dbb4c2e87a7fcca08643ab41e5bdc565eac1fe1dcfb4fff9b7719f507451fbaf6bf9d10a4b6cb53f6e94de2eac8ad8979320af2bcb3eea35146b5be396d4722fe309410f9f0aadb2d1c532a00ed39fa6cbf54c731049ff26ea56d0946f874876f3c5e0b7eb870a2ee28db08eaaa7a9d66eb7cff6a2d8a0ef4e6f2693263b3936cab090880dd3dcade33d6cd5a56a8f6e7b537560bae0a6b080c0f1456639120c0390461070d86712e295b3654b635456e3f09fbd91661c935a00a5fa932f2c721d9bb7fb2964b3e5760bd70535a882011d2ba895436296888791c89b34c9a4ddb6d9b74918ff326e39dc21b4c26db82b070dc9ace90a44c2825433613b0427157f2ae84bb570bd9b0beddb63c527e28d64f868e85d52c93a6335be5d76121e2988b4a7810c42a734297869da268a9e9e93d31d3437e13d8d8b83cca646cb832d61c1615e43cf01cd17378f2b2831024c9c3a6fa7586c1ecfce98043bbd1d4e78edebdd733db22bd00961add5171de5a5d9635b57341fe5b6282e813c5c2f3f2d157b30512d894d69bd6cd4bd2bdc99f03c9f26db06f704c58143ffd65ab316ae223ab7098cd72997f8af7de8e6513f3bce9fed97a7ba65c4eb11ed599390ff8ba5669ddf556548d4a663ff61a6e8142b4165c358df81bc8560c6c6cbd38d1f9f63ad9fc30e4c3f473d8692de54dc6137b4ee34084e37d9c7808b010951abe02a2c5a1f128760431d475940d2385919f6bd3168e81afc704946baf4e5018fba1fd4b1bf8aaa5f7e89018d3b06eb972a79841154e854a3ba7e7a1d452d277d471baf08efde6859e20b3fe15ff946491b4d9ff7cd15704b45b6a522037ee02414c51d543d6d1d3dfd42ce23cc20f6ea154e54289a795a8eb49ac5714570c01a7e34b229dfd803684ca7156b8d2bcbe8d94f9da5b48ba29c1d27a4722473a12789a0799037153472b8f301bf105dc293e774cd0a8e9d4e59b0decfbc92bc31f46d90ff3b4e89276e7b0b532b6969428743af6a119ad3a9033a0ab27c5f7bdebab23b9b54ca54e9090b39f82a09711c423ed6f97e47ab11e7370674ecc35b9d26c5d836531ff9de21b910358ec4694f4efca57546ef0a3bec40cd14728d39b6d9a6ca0aa00dd8a6d24d1fd7eb694ac68c809458930b786c572329c5fa94de002f2855a87eae1488865c0dc8f4296e0fa369f4529117103fa157453119777f4ad48801aa592bf04384d6d38a47f57e66e409fff7decc8c8f9747f17cb8bb2d6667ecedf03b2bdabaff7fb09d67ada4561e59e191e7b8dcf22755fbce8ab29b066fc35fe4f6d4b3f4cee7acb5cf931c9ded16b8a8e2cb62462ea2745dc87d9a55b5e0fac121940a266722ff75acdf8ca37ce9b1b41fec5e33afa8c2e6316c85ab6db2644a6e344834c2c3bc63dc83c1cc3c1eac74dc3aded5b6a3259fc930f61316da403d14b11fb10c19e9d55bcd50b94dc6053b7fe7968b5e6cda7d5a06bf88b026e1afb0941dc9c789536d2202b9b620465c1442568bf9bc34b64b54e9c7c7bab50ee8d89daf77401709df00790a4ecd12d49a1cd44b5dd43115765e581c58e39969b41caf61eef7c0917e810b2f7e8a0b3cea3657c914c5a49c6f22743c6795cc382d44bebc200e4e57cfc3f6d99e9a55bff0f6fe6bb850845b387216b209967209b3c5a1e7a7934f03b3ac0070d8e7d74f062cf619d73ddd6101f192cca2e3e3753eba91d87508148ebf159da1b047288826ff4839ea448185cd39fd9ce65d82f78bfdc8a1b06f968b758830e2eaba839a98ec73f5681bb0657d1a80ae07c4519cc0c18590f54170cf8fd8b020a1918e2445ca0dedba89e6fa997978fea251eb68c47486a35fca9b006526cc533755f1bf23ccf33413da00a0cf0894259471a80de360ec2b15e68971bdf954c50bc7865a192f2739cad913041898010b2ceccdcfb8180368482c9a74a838a7f5e37c2418e11f7631f5fe24758a744fab5824c3aaab31a67bc09174ee9ccf7942aa00f8b65a45ee9d2c16fb5f4defd42eb8c0e6b1c4c8693fb793d722ea4a18cad79b30d68aa2a2b19e6926dda3a7b666a37817276ea40865f5ccddf259fa25d59a8eef859edc427594520d37380bacb273716942cfaa15ca12e4db921252d53fd35da7e309e7fa0fde147092b98cdd212ff32c96ac5fb110326c6703cbc1e84011675dbb2e7ea8de901f7e5792e1451ce7e3f2aded99f4ccba1c8865fd047a1036ed9d4eb2b1d14387228a204da7d368d6a6bacf5f57669486f3734ef063fffd8ff586fea65deb0a0d55dfef897f50802818f58fe681473f8d58095d9c745ebc8ea7286add896a84b98686ddbb6cb2fb16429df88c257fbeb8cd85db3c538939af864426b3ca15b1e3569da14aa7e08d66c134391b443889b857662821a5970fc4cc71ad99d2a79503c9e1938f19e764b464ef534c098f0fc6f5c44204e9c5b2c5ac7ffcac394003dadd90b9aedee16905ffc2f071aeb792e35dbcfe4a2492902878f590477b4ed99bf6bab9781d36652423c3ede515ff37eb4b6cb571cd530c4297768bdf6858c9495218483a9bf0b5198a57d5a90398490ecce82ca8705c5f0a1744763d50bf2405998cbb7ac32b75b54aff3b5b614a1d797123aa1447235f0dac039990441f3a97d71937cf7c783ad7cbcf2e99d338132b34e17a6cc9eb08e08bff0ef1573fabdcbd888076213741fe497e6139eb84898d030509ffe02821e10906afcdc2655f90338cf3c27f9f61f32dcb8869c54079905a61657a184591ae1870b4ea6a437bd3fd1447a6e78a4f821e519ef9f8d97114804941bd73d63b46bf3b1f9811d9197850bf922609863c219ee8ab911abdff9b6c5fcab68933c058599a17e6d2450e9b2f546ca01c58c207c598d6c94294473ddfdb35d7f089b0c1b1a6c2cd6c1332753b6e9e7d16ed475ecdca4439ea7a563fa86f0729f8718db7c39ecd3307444d9a41d64048788a0d2007b6c5d10458d0f3b0ee7f7b88343ab1553f18542968c16ee8921a5b3e4c2d47938fe15b70f30a9497fb28a9b2f4371382cf587237fc7f99d9a2762a14a06cde0a8034cfab5020d90be6753c81441ab5771e33e2df1077a1f96b6290b9195336e1e3e365d93fa345cb08a9e033465e92d1de2e4dd58b01a141ee2799b35621610a91488ec0cecfd42f348d8106f204143f1c961ce69cfc373be73661f7f3a2ea4bade6d6dc7b7dc5f87147fb50fe0c06d5e092d109eacc3b7211be7a5c31146331d00cb383d9309c921b5b6da53eb10ccf85b75a22e24169287aa05a8327d4d33ec507c0e8190637f5578e73114f6ad3a56d774d60514b8de779b99dcca0a457115c03cafb7a980291184fa7b825ece638314b467b80bc201e46d417e39847579bb040f57f87187676100131a6e2aa5594881991f281e8c86991424afa509b1c80112bb605c100912d353870a40bdbbc5a2c799ccb72004be090bb84d536a5bc79237e768c44790ee7ed13fe68e3b220742678896136e2e1f2b66d98eddb5fde3704df37a66c594c355c377949bd9241766b7e10f8e8bf0c9e4b34538ca9dc6e9a416fba2f72f9b79f9eda73c60693f1cf39dabadc4bcc686f5018498c7a1a2434242b6ece322120bf8e2f24ad17fdb98e3ed23202bf37646004a280fafa0ba0c914364bf64c7df8420cb4c05df111738ff2752f72c8b14f692815e785afc4d3eb85c571d104f342c7cfdbc9252194bd6a4ec4f98a86a0fa74fcee6e86ad1f08e4513e34c33200b4f916adeb254f962a74db1aeb22e184a06af1b405bcd283d36a6d083407d0d6e99a5cae13800490396b034c22260eb39f0ce90c690b80234507a19f30156a424030ab6a129703a2616124e534c8f05f9985bd193162f135df71e992b6ea4ae6800a189a992262ca0c44f340719eb204b374242106cae17e35a6c839d65815d2ddd8dc62877917f7b57605f2bd86313a49ed7b888d6091688e8102f8639e16d8b5ecf62accb362eaefb0f28c4bf34b3b6ca1fcebbf979eda68bbcac8fc8fbba329000587eee0d55a79a15b509af09973e05d366a0d36b17abbf1010afb732ba526ec0e89ca917e660e15f0be8bd7bc7dd6943c4704d7fe219c2d6a7d4514f693d51bcb863de078f4218854f9231c6efcaf510a1d4bb69c6caf6dc6a0bbb2045cb0830514af4add7abbef9816cfd4104620201af9861c3f6aa90c51841b0302acf3dff64de08c68fa3f13c97e26178cc96643a7012f82f4a48bab69fa4514b7d94ee497e9c444159dd308896f496b2c90c6347c8929b1dda1ceef60c0171a4112698542fb32e790e5cc5ee9043a400f9fa515e0415046d23a9d0c6b238c1726e22e9047f35bbf2f0beed1b1b50b9668af3bcf2f1155894e4079648dfcaca3cb46f56fa5b2e6df63a4a5e0c86001e47be40fc8565212c1d5450c63fa8a23b00493309407430ceca0201041f5fcad8d0959ca8154ae1fc44b00fc17b02c99fd0ce9f7e62be844dc67f1a60acbb5a493e3dcc1d420f8b4a33e896409aa1b90397da6b1c41bb81c33351ef2e69d7f7397afec9749af0640dbe138f7aa773e9322ee03603033a7da58509743687155692a9816c0154fe92307d1ad3b18c3a6a204f8272bf7cb6f09d12800094bfaff9cc995006c6309be6ddfcefda8c2acd28e825048d66d69fc7234725bbc3824c1e03ed84d312db2cb151e75ac96a6d0587d954a2d3dd574f1161ee998331769a0bacc5e9ca1f92ff5a5a9a3bc96ac7657177da76d1d6f06817a82498cdbcf103283a04f21e24be4f36f8980d38f41027e3d171cb78b1c9ea1c057ed68fc584679988a059db5c91dd4f990e0a3a0f891f040f19fd0ae02b4928b5a2a550120efc44ceddc22250e03ebf51dbaf5095c77ecd8cd261e8f8631739b89675c180b5681713269c546165a5f399f68ed2b54c08b410f8ce063d3ae40634cfacc5293b54e0a30b2675955da3a509fb10a75b7d8cc8beb722a2e2050bb42964ab1472885853bdf74e6c43c2dfe3643fa2778bc10db22ff5839e698c5b1bd0c535cd06339e518f815f8c03f179cdc09076ba78bab04c45e51bc4858e47541cf7be7af6b39a9c4c74019b11b94adc6166c58eae1e1fa4d85075a46fe258fde77a50748a0c97b111d0cce6e20d9b9b23d18b18f8a7d1ec6493d2a07cb0db67ee0657a5c8449b6a113a7a5da7bbac0f8b53bf3f721238925ab9e7529072038bc4b5d5a5626cb0020184834500879ad577a1b259ef96f0b919c889bf14afcd746c4684493dcfb742f300fdf0b77fc8043aa18920af52581dd4f08cd340b7b69a660ff93fed123b0b535cd8970d4bcda59043fe0b907594806ad854418cbb1af88e5bdef4eb05b80e24cd1504da2f2c24e0c2e1dae6c65f721f2de9a98169b295d3bdf30f1899b8e056683be311bb356ed9d60d51e9bb3fda5658d0ac05f5154f81df269d7e639d1f03471976b7f5edc9b424c57fb12560584126bddb877a7d00bb430a9f69262b286f6ac033edb7ed08e69a40f9c170f244516b892122219451cd2a80cc704b20ea926f5644b1340c83252abbbe3c200f73e2fed5ad411c28553294fd5a4ca0b50dcd9f66c4df59a7cd9eeed084cabd5a5c62c9302d8677bbe53763d5714a231e6adb2a0eee30972d109f971b8d496cd57b89616e9327b5c33f19d10cf44678d00c44be80304a5c424f776cd3ad542f2f261603330562bb057b30a554e8b395126758c687d413f5102354823e397ca442024f3d3666e461f5acaa4815e3b8e67f36af39f8876da6681d0815626df3f4d8b210d558494a7938a24b4733d9c81c89a744f224442b4db456bc059f680ddcfa8d9b39b4cab87612ae32c5fed6f8f9f1a7bd01e85a7ccccd52f430a360ba8418890eaf61f44d6125c56eef00a3238a6fefed073d7786b233572666e85edcc9f9b1248ca3aa664faf6e2b4e0b6956bde34c715d49aefac43c4b53f8cb885d8f29bc12e69b9b17eeb34407bad972d5faa05ed12562ff23c010fc01ea2e243f540cb0206b0decdcc714e2685b8fad1b0c23744951fb0218f13c7a4b3a1b119a1ed547f241d4a8f6e3b680251771ccb51c14ef003f01f93ffbeb07155c9deeae955d3dfbaf253e49797c4b4e4d7d85db260544d7f25ae64166a16d531d2becd91d6627fadf75df7b8c13e06a65a1f6f1d5fdd8d68928e688af4fc945c9f0b8a1449c9b418b7b9809f406dcbff6bff5d9a38582f9def06c8fd20e5a249c93c8a6931cfd60111fa2e2f02988691c39b1ba0a5d70c25d446652c72b853b69142382ddb97ce5aaf132ec51c175d3e0769c0d18bf2fdb6016c40cb7bfb2359da795b9f0e498ed6ce1ab8bf7ac72adca265db3a796e94bac410e5f780fa9a634ad0ea67a179cba32951c8a22e17e405deceda49c45ae8c635af94dc9aca23217fb85ac807186e248128ef72fd254c896296efd53941af714437596bf76adce7a61f85eb37c74c3adab7701aa863a46a4ad50ab10c17b3928056b02cb74523d81091f50749134886aa023e4885606992a6706ed202eedfa189f2545330f16f83f5347ad71f90f3386a26cc688d0c7af442c4a415bb7684ac30971a0eb7fd66537d2439e09b2a3d2ac57b21a385eeeeb3e2346d2de355128b744213b352ac8c6555e5738fc370ca2e66aa13e432cfcad9cbd914a445904b71fa4d59f8a1552006ce6b5ea77cb4cd90bb4ae2bafac0db0dd5f91f0652414af47fa43af</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>å…‰ä¼å°çŸ¥è¯†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸è§æ•°æ®åº“åˆ†ç±»</title>
    <link href="/%E5%B8%B8%E8%A7%81%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%86%E7%B1%BB/"/>
    <url>/%E5%B8%B8%E8%A7%81%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%86%E7%B1%BB/</url>
    
    <content type="html"><![CDATA[<h2 id="1-æ•°æ®åº“åˆ†ç±»"><a href="#1-æ•°æ®åº“åˆ†ç±»" class="headerlink" title="1. æ•°æ®åº“åˆ†ç±»"></a>1. æ•°æ®åº“åˆ†ç±»</h2><h3 id="1-1-æŒ‰æ•°æ®æ¨¡å‹åˆ†ç±»"><a href="#1-1-æŒ‰æ•°æ®æ¨¡å‹åˆ†ç±»" class="headerlink" title="1.1. æŒ‰æ•°æ®æ¨¡å‹åˆ†ç±»"></a>1.1. <strong>æŒ‰æ•°æ®æ¨¡å‹åˆ†ç±»</strong></h3><table><thead><tr><th><strong>åˆ†ç±»</strong></th><th><strong>è¯´æ˜</strong></th><th><strong>å…¸å‹ä»£è¡¨</strong></th></tr></thead><tbody><tr><td><strong>å…³ç³»å‹æ•°æ®åº“</strong></td><td>åŸºäºå…³ç³»æ¨¡å‹ï¼Œæ•°æ®ä»¥è¡¨æ ¼å½¢å¼å­˜å‚¨ï¼Œæ”¯æŒ SQL æŸ¥è¯¢è¯­è¨€ã€‚</td><td>MySQLã€PostgreSQLã€Oracleã€SQL Server</td></tr><tr><td><strong>NoSQL æ•°æ®åº“ï¼ˆéå…³ç³»å‹ï¼‰</strong></td><td>éå…³ç³»å‹æ•°æ®åº“ï¼Œä¸ä¾èµ–å›ºå®šè¡¨ç»“æ„ï¼Œæ”¯æŒçµæ´»çš„æ•°æ®æ¨¡å‹ã€‚</td><td>MongoDBã€Redisã€Neo4jã€InfluxDBã€Elasticsearchã€ClickHouse</td></tr></tbody></table><h3 id="1-2-æŒ‰å­˜å‚¨æ–¹å¼åˆ†ç±»"><a href="#1-2-æŒ‰å­˜å‚¨æ–¹å¼åˆ†ç±»" class="headerlink" title="1.2. æŒ‰å­˜å‚¨æ–¹å¼åˆ†ç±»"></a>1.2. <strong>æŒ‰å­˜å‚¨æ–¹å¼åˆ†ç±»</strong></h3><table><thead><tr><th><strong>åˆ†ç±»</strong></th><th><strong>è¯´æ˜</strong></th><th><strong>ç‰¹ç‚¹</strong></th></tr></thead><tbody><tr><td><strong>è¡Œå­˜å‚¨</strong></td><td>æ•°æ®æŒ‰è¡Œå­˜å‚¨ï¼Œé€‚åˆäº‹åŠ¡å¤„ç†å’Œç‚¹æŸ¥è¯¢ã€‚</td><td>MySQLã€PostgreSQLã€‚</td></tr><tr><td><strong>åˆ—å­˜å‚¨</strong></td><td>æ•°æ®æŒ‰åˆ—å­˜å‚¨ï¼Œé€‚åˆåˆ†æå‹æŸ¥è¯¢å’Œæ‰¹é‡å¤„ç†ã€‚</td><td>ClickHouseã€</td></tr><tr><td><strong>é”®å€¼å­˜å‚¨</strong></td><td>æ•°æ®ä»¥é”®å€¼å¯¹å½¢å¼å­˜å‚¨ï¼Œæ”¯æŒé«˜é€Ÿè¯»å†™ã€‚</td><td>Redisã€Memcachedã€‚</td></tr><tr><td><strong>æ–‡æ¡£å­˜å‚¨</strong></td><td>æ•°æ®ä»¥æ–‡æ¡£å½¢å¼å­˜å‚¨ï¼ˆå¦‚ JSONï¼‰ï¼Œæ”¯æŒåµŒå¥—æ•°æ®ç»“æ„ã€‚</td><td>MongoDBã€‚</td></tr></tbody></table><h3 id="1-3-æŒ‰å¼€æºä¸å•†ä¸šåˆ†ç±»"><a href="#1-3-æŒ‰å¼€æºä¸å•†ä¸šåˆ†ç±»" class="headerlink" title="1.3. æŒ‰å¼€æºä¸å•†ä¸šåˆ†ç±»"></a>1.3. <strong>æŒ‰å¼€æºä¸å•†ä¸šåˆ†ç±»</strong></h3><table><thead><tr><th><strong>åˆ†ç±»</strong></th><th><strong>è¯´æ˜</strong></th><th><strong>ä»£è¡¨</strong></th></tr></thead><tbody><tr><td><strong>å¼€æºæ•°æ®åº“</strong></td><td>ä»£ç å…¬å¼€ï¼Œç¤¾åŒºé©±åŠ¨ï¼Œå…è´¹ä½¿ç”¨ã€‚</td><td>MySQLã€PostgreSQLã€MongoDB</td></tr><tr><td><strong>å•†ä¸šæ•°æ®åº“</strong></td><td>ç”±å…¬å¸å¼€å‘ï¼Œæä¾›æŠ€æœ¯æ”¯æŒå’Œé«˜çº§åŠŸèƒ½ï¼Œéœ€ä»˜è´¹ã€‚</td><td>Oracleã€SQL Serverã€SAP HANAã€‚</td></tr></tbody></table><h2 id="2-æ•°æ®åº“å¯¹æ¯”"><a href="#2-æ•°æ®åº“å¯¹æ¯”" class="headerlink" title="2. æ•°æ®åº“å¯¹æ¯”"></a>2. æ•°æ®åº“å¯¹æ¯”</h2><h3 id="2-1-å…³ç³»å‹æ•°æ®åº“å¯¹æ¯”"><a href="#2-1-å…³ç³»å‹æ•°æ®åº“å¯¹æ¯”" class="headerlink" title="2.1. å…³ç³»å‹æ•°æ®åº“å¯¹æ¯”"></a>2.1. <strong>å…³ç³»å‹æ•°æ®åº“å¯¹æ¯”</strong></h3><p>MySQL <strong>vs</strong> PostgreSQL  <strong>vs</strong> Oracle  <strong>vs</strong> SQL Server</p><table><thead><tr><th><strong>æ•°æ®åº“</strong></th><th><strong>è®¾è®¡ç›®çš„</strong></th><th><strong>ä½¿ç”¨åœºæ™¯</strong></th><th><strong>å¼€æº vs å•†ä¸š</strong></th></tr></thead><tbody><tr><td>MySQL</td><td>é¢å‘ Web åº”ç”¨å’Œä¸­å°å‹é¡¹ç›®ï¼Œé€‚åˆè½»é‡çº§ã€é«˜æ€§èƒ½éœ€æ±‚çš„åœºæ™¯</td><td>Webåº”ç”¨ã€ç”µå­å•†åŠ¡ã€å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰ã€æ•°æ®åˆ†æã€æ—¥å¿—å¤„ç†ç­‰</td><td>å¼€æºï¼Œç”± Oracle å…¬å¸ç»´æŠ¤</td></tr><tr><td>PostgreSQL</td><td>é€‚åˆå¤æ‚æŸ¥è¯¢ã€æ•°æ®å®Œæ•´æ€§å’Œæ‰©å±•æ€§éœ€æ±‚ã€‚æ”¯æŒå¤æ‚æ•°æ®ç±»å‹ï¼ˆå¦‚ JSONã€æ•°ç»„ã€å‡ ä½•ç±»å‹ï¼‰</td><td>å¤æ‚æŸ¥è¯¢ã€æ•°æ®ä»“åº“ã€åœ°ç†ä¿¡æ¯ç³»ç»Ÿï¼ˆGISï¼‰ã€é‡‘èåº”ç”¨ã€ç§‘å­¦ç ”ç©¶ç­‰</td><td>å¼€æºï¼Œå®Œå…¨å…è´¹ï¼Œæ— å•†ä¸šé™åˆ¶</td></tr><tr><td>Oracle</td><td>é¢å‘å¤§å‹ä¼ä¸šï¼Œæä¾›å…¨é¢çš„æ•°æ®åº“è§£å†³æ–¹æ¡ˆã€‚</td><td>ä¼ä¸šèµ„æºè§„åˆ’ï¼ˆERPï¼‰ã€å®¢æˆ·å…³ç³»ç®¡ç†ï¼ˆCRMï¼‰ã€é“¶è¡Œç³»ç»Ÿã€ç”µä¿¡ç³»ç»Ÿã€æ”¿åºœæœºæ„ç­‰</td><td>å•†ä¸šé—­æº RDBMSï¼Œç”± Oracle å…¬å¸å¼€å‘</td></tr><tr><td>SQL Server</td><td>é¢å‘ Windows ä¼ä¸šç”¨æˆ·ï¼Œæä¾›ä¸å¾®è½¯ç”Ÿæ€çš„æ·±åº¦é›†æˆã€‚</td><td>ä¼ä¸šçº§åº”ç”¨ã€å•†ä¸šæ™ºèƒ½ï¼ˆBIï¼‰ã€æ•°æ®ä»“åº“ã€æŠ¥è¡¨ç”Ÿæˆã€ä¸Microsoft Officeçš„é›†æˆç­‰</td><td>å•†ä¸šé—­æº RDBMSï¼Œç”±å¾®è½¯å¼€å‘ã€‚</td></tr></tbody></table><h3 id="2-2-éå…³ç³»å‹æ•°æ®åº“å¯¹æ¯”"><a href="#2-2-éå…³ç³»å‹æ•°æ®åº“å¯¹æ¯”" class="headerlink" title="2.2. éå…³ç³»å‹æ•°æ®åº“å¯¹æ¯”"></a>2.2. <strong>éå…³ç³»å‹æ•°æ®åº“å¯¹æ¯”</strong></h3><p>MongoDB <strong>vs</strong> Redis <strong>vs</strong> Neo4j <strong>vs</strong> InfluxDB <strong>vs</strong> Elasticsearch <strong>vs</strong> ClickHouse</p><table><thead><tr><th><strong>æ•°æ®åº“</strong></th><th><strong>å®šä¹‰</strong></th><th><strong>è®¾è®¡ç›®çš„</strong></th><th><strong>ä½¿ç”¨åœºæ™¯</strong></th></tr></thead><tbody><tr><td><strong>MongoDB</strong></td><td>åˆ†å¸ƒå¼æ–‡æ¡£æ•°æ®åº“</td><td>åŸºäº BSON æ ¼å¼å­˜å‚¨ï¼Œæä¾›çµæ´»çš„æ–‡æ¡£æ¨¡å‹</td><td>é‡‘æ•°æ®çš„è¡¨å•å’Œæ•°æ®ç»“æ„ç”¨æˆ·é…ç½®æ–‡ä»¶å­˜å‚¨</td></tr><tr><td><strong>Redis</strong></td><td>å†…å­˜é”®å€¼å¯¹æ•°æ®åº“</td><td>åŸºäºå†…å­˜å­˜å‚¨ï¼Œæä¾›è¶…é«˜æ€§èƒ½</td><td>ç¼“å­˜ã€ä¼šè¯å­˜å‚¨ã€å®æ—¶æ’è¡Œæ¦œã€è®¡æ•°å™¨ã€åˆ†å¸ƒå¼é”ç­‰ã€‚</td></tr><tr><td><strong>Neo4j</strong></td><td>å›¾å½¢æ•°æ®åº“</td><td>åŸºäº<strong>å›¾å½¢æ•°æ®ç»“æ„ï¼Œ</strong>å¤„ç†å¤æ‚çš„å…³ç³»ç½‘ç»œæ•°æ®</td><td>ç¤¾äº¤ç½‘ç»œåˆ†æã€ç‰©è”ç½‘è®¾å¤‡å…³ç³»ç®¡ç†ç­‰ã€‚</td></tr><tr><td><strong>InfluxDB</strong></td><td>æ—¶åºæ•°æ®åº“</td><td>ä¸“ä¸º<strong>æ—¶é—´åºåˆ—æ•°æ®</strong>è®¾è®¡</td><td>ç›‘æ§ç³»ç»Ÿï¼ˆCPUã€å†…å­˜ä½¿ç”¨æƒ…å†µï¼‰é‡‡é›†è®¾å¤‡æ•°æ®ï¼šä¸»è½´è½¬é€Ÿã€å€ç‡</td></tr><tr><td><strong>Elasticsearch</strong></td><td>åˆ†å¸ƒå¼å…¨æ–‡æœç´¢å¼•æ“å’Œåˆ†æå¼•æ“</td><td>åŸºäº<strong>å€’æ’ç´¢å¼•</strong>ï¼Œæ”¯æŒå®æ—¶å…¨æ–‡æœç´¢å’Œå¤æ‚èšåˆæŸ¥è¯¢</td><td>æ—¥å¿—åˆ†æã€ç™¾åº¦æœç´¢ã€‚</td></tr><tr><td><strong>ClickHouse</strong></td><td>åˆ—å¼å­˜å‚¨æ•°æ®åº“</td><td>åŸºäº<strong>åˆ—å¼å­˜å‚¨</strong>ï¼Œæ”¯æŒå¤§è§„æ¨¡æ•°æ®çš„é«˜æ•ˆæŸ¥è¯¢å’Œåˆ†æ</td><td>å®æ—¶æ•°æ®åˆ†æã€å¤§æ•°æ®åˆ†æç­‰ã€‚é‡‘æ•°æ®è¡¨å•æ•°æ®å¹³å‡å€¼ï¼Œæœ€å€¼è®¡ç®—</td></tr></tbody></table><h2 id="3-å¸¸è§æ•°æ®åº“ä»‹ç»"><a href="#3-å¸¸è§æ•°æ®åº“ä»‹ç»" class="headerlink" title="3. å¸¸è§æ•°æ®åº“ä»‹ç»"></a>3. å¸¸è§æ•°æ®åº“ä»‹ç»</h2><h3 id="3-1-MongoDB"><a href="#3-1-MongoDB" class="headerlink" title="3.1 MongoDB"></a>3.1 MongoDB</h3><h4 id="1-åŸç†"><a href="#1-åŸç†" class="headerlink" title="1. åŸç†"></a>1. <strong>åŸç†</strong></h4><ul><li><strong>åŸºäº BSON æ ¼å¼çš„æ–‡æ¡£å­˜å‚¨</strong>ï¼šæ•°æ®ä»¥äºŒè¿›åˆ¶ JSONï¼ˆBSONï¼‰æ ¼å¼å­˜å‚¨ï¼Œæ”¯æŒåŠ¨æ€æ¨¡å¼ï¼Œæ— éœ€é¢„å®šä¹‰ç»“æ„ã€‚</li><li><strong>åˆ†å¸ƒå¼æ¶æ„</strong>ï¼šé€šè¿‡åˆ†ç‰‡ï¼ˆShardingï¼‰å’Œå‰¯æœ¬é›†ï¼ˆReplica Setï¼‰å®ç°æ•°æ®æ°´å¹³æ‰©å±•å’Œé«˜å¯ç”¨æ€§ã€‚</li><li><strong>æŸ¥è¯¢è¯­è¨€</strong>ï¼šæä¾›ç±» SQL çš„æŸ¥è¯¢èƒ½åŠ›ï¼ˆMongoDB Query Language, MQLï¼‰ï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢å’Œèšåˆæ“ä½œã€‚</li></ul><h4 id="2-æ ¸å¿ƒæ¦‚å¿µ"><a href="#2-æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="2. æ ¸å¿ƒæ¦‚å¿µ"></a>2. <strong>æ ¸å¿ƒæ¦‚å¿µ</strong></h4><ul><li><strong>æ•°æ®åº“ï¼ˆDatabaseï¼‰</strong>ï¼šMongoDB çš„é€»è¾‘å®¹å™¨ï¼Œç±»ä¼¼äºå…³ç³»å‹æ•°æ®åº“ä¸­çš„æ•°æ®åº“ã€‚</li><li><strong>é›†åˆï¼ˆCollectionï¼‰</strong>ï¼šç±»ä¼¼äºå…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨ï¼Œå­˜å‚¨ä¸€ç»„æ–‡æ¡£ã€‚</li><li><strong>æ–‡æ¡£ï¼ˆDocumentï¼‰</strong>ï¼šMongoDB çš„åŸºæœ¬æ•°æ®å•å…ƒï¼Œä»¥ BSON æ ¼å¼å­˜å‚¨ï¼Œæ”¯æŒåµŒå¥—ç»“æ„ã€‚</li><li><strong>å­—æ®µï¼ˆFieldï¼‰</strong>ï¼šæ–‡æ¡£ä¸­çš„é”®å€¼å¯¹ï¼Œç±»ä¼¼äºå…³ç³»å‹æ•°æ®åº“ä¸­çš„åˆ—ã€‚</li></ul><h4 id="3-è®¾è®¡ç›®çš„"><a href="#3-è®¾è®¡ç›®çš„" class="headerlink" title="3. è®¾è®¡ç›®çš„"></a>3. <strong>è®¾è®¡ç›®çš„</strong></h4><ul><li>æä¾›çµæ´»çš„æ–‡æ¡£æ¨¡å‹ï¼Œé€‚åº”å¿«é€Ÿå˜åŒ–çš„ä¸šåŠ¡éœ€æ±‚ã€‚</li><li>æ”¯æŒé«˜å¹¶å‘è¯»å†™ï¼Œé€‚ç”¨äºå†…å®¹ç®¡ç†ç³»ç»Ÿã€ç‰©è”ç½‘æ•°æ®å­˜å‚¨ç­‰åœºæ™¯ã€‚</li></ul><h4 id="4-ä½¿ç”¨åœºæ™¯"><a href="#4-ä½¿ç”¨åœºæ™¯" class="headerlink" title="4. ä½¿ç”¨åœºæ™¯"></a>4. <strong>ä½¿ç”¨åœºæ™¯</strong></h4><ul><li>å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰</li><li>ç‰©è”ç½‘ï¼ˆIoTï¼‰æ—¶åºæ•°æ®å­˜å‚¨</li><li>äº§å“ç›®å½•ç®¡ç†</li><li>ç”¨æˆ·é…ç½®æ–‡ä»¶å­˜å‚¨</li></ul><hr><h3 id="3-2-Redis"><a href="#3-2-Redis" class="headerlink" title="3.2 Redis"></a>3.2 Redis</h3><h4 id="1-åŸç†-1"><a href="#1-åŸç†-1" class="headerlink" title="1. åŸç†"></a>1. <strong>åŸç†</strong></h4><ul><li><strong>åŸºäºå†…å­˜å­˜å‚¨</strong>ï¼šæ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæä¾›è¶…é«˜æ€§èƒ½çš„è¯»å†™èƒ½åŠ›ã€‚</li><li><strong>æ”¯æŒå¤šç§æ•°æ®ç»“æ„</strong>ï¼šåŒ…æ‹¬å­—ç¬¦ä¸²ã€åˆ—è¡¨ã€å“ˆå¸Œã€é›†åˆã€æœ‰åºé›†åˆç­‰ã€‚</li><li><strong>æŒä¹…åŒ–æœºåˆ¶</strong>ï¼šæ”¯æŒ RDBï¼ˆå¿«ç…§ï¼‰å’Œ AOFï¼ˆè¿½åŠ æ—¥å¿—ï¼‰ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ã€‚</li></ul><h4 id="2-æ ¸å¿ƒæ¦‚å¿µ-1"><a href="#2-æ ¸å¿ƒæ¦‚å¿µ-1" class="headerlink" title="2. æ ¸å¿ƒæ¦‚å¿µ"></a>2. <strong>æ ¸å¿ƒæ¦‚å¿µ</strong></h4><ul><li><p><strong>é”®å€¼å¯¹ï¼ˆKey-Value Pairï¼‰</strong>ï¼šRedis çš„åŸºæœ¬å­˜å‚¨å•å…ƒï¼Œé”®ä¸ºå­—ç¬¦ä¸²ï¼Œå€¼å¯ä»¥æ˜¯å¤šç§æ•°æ®ç»“æ„ã€‚</p></li><li><p><strong>æ•°æ®ç»“æ„</strong>ï¼š</p></li><li><ul><li><strong>å­—ç¬¦ä¸²ï¼ˆStringï¼‰</strong>ï¼šç®€å•çš„é”®å€¼å¯¹ã€‚</li><li><strong>åˆ—è¡¨ï¼ˆListï¼‰</strong>ï¼šæœ‰åºçš„å­—ç¬¦ä¸²é›†åˆã€‚</li><li><strong>å“ˆå¸Œï¼ˆHashï¼‰</strong>ï¼šé”®å€¼å¯¹çš„é›†åˆã€‚</li><li><strong>é›†åˆï¼ˆSetï¼‰</strong>ï¼šæ— åºçš„å­—ç¬¦ä¸²é›†åˆã€‚</li><li><strong>æœ‰åºé›†åˆï¼ˆSorted Setï¼‰</strong>ï¼šå¸¦åˆ†æ•°çš„é›†åˆï¼ŒæŒ‰åˆ†æ•°æ’åºã€‚</li></ul></li></ul><h4 id="3-è®¾è®¡ç›®çš„-1"><a href="#3-è®¾è®¡ç›®çš„-1" class="headerlink" title="3. è®¾è®¡ç›®çš„"></a>3. <strong>è®¾è®¡ç›®çš„</strong></h4><ul><li>æä¾›è¶…é«˜æ€§èƒ½çš„å†…å­˜æ•°æ®ç»“æ„æœåŠ¡å™¨ï¼Œé€‚ç”¨äºéœ€è¦å¿«é€Ÿè¯»å†™æ“ä½œçš„åœºæ™¯ã€‚</li><li>æ”¯æŒæŒä¹…åŒ–ï¼Œç¡®ä¿æ•°æ®ä¸ä¼šå› æœåŠ¡å™¨é‡å¯è€Œä¸¢å¤±ã€‚</li></ul><h4 id="4-ä½¿ç”¨åœºæ™¯-1"><a href="#4-ä½¿ç”¨åœºæ™¯-1" class="headerlink" title="4. ä½¿ç”¨åœºæ™¯"></a>4. <strong>ä½¿ç”¨åœºæ™¯</strong></h4><ul><li>ç¼“å­˜</li><li>ä¼šè¯å­˜å‚¨</li><li>å®æ—¶æ’è¡Œæ¦œ</li><li>è®¡æ•°å™¨</li><li>åˆ†å¸ƒå¼é”</li><li>æ¶ˆæ¯é˜Ÿåˆ—</li></ul><h3 id="3-3-Neo4j"><a href="#3-3-Neo4j" class="headerlink" title="3. 3 Neo4j"></a>3. 3 Neo4j</h3><h4 id="1-åŸç†-2"><a href="#1-åŸç†-2" class="headerlink" title="1. åŸç†"></a>1. <strong>åŸç†</strong></h4><ul><li><strong>åŸºäºå›¾å½¢æ•°æ®ç»“æ„</strong>ï¼šèŠ‚ç‚¹è¡¨ç¤ºå®ä½“ï¼Œè¾¹è¡¨ç¤ºå®ä½“ä¹‹é—´çš„å…³ç³»ã€‚</li><li><strong>å±æ€§å›¾æ¨¡å‹</strong>ï¼šèŠ‚ç‚¹å’Œè¾¹éƒ½å¯ä»¥æœ‰å±æ€§ï¼Œå±æ€§ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨ã€‚</li><li><strong>Cypher æŸ¥è¯¢è¯­è¨€</strong>ï¼šä¸“ä¸ºå›¾å½¢æ•°æ®è®¾è®¡çš„æŸ¥è¯¢è¯­è¨€ï¼Œæ”¯æŒå¤æ‚çš„å›¾å½¢æŸ¥è¯¢ã€‚</li></ul><h4 id="2-æ ¸å¿ƒæ¦‚å¿µ-2"><a href="#2-æ ¸å¿ƒæ¦‚å¿µ-2" class="headerlink" title="2. æ ¸å¿ƒæ¦‚å¿µ"></a>2. <strong>æ ¸å¿ƒæ¦‚å¿µ</strong></h4><ul><li><strong>èŠ‚ç‚¹ï¼ˆNodeï¼‰</strong>ï¼šè¡¨ç¤ºå®ä½“ï¼Œå¦‚ç”¨æˆ·ã€äº§å“ç­‰ã€‚</li><li><strong>å…³ç³»ï¼ˆRelationshipï¼‰</strong>ï¼šè¡¨ç¤ºå®ä½“ä¹‹é—´çš„å…³ç³»ï¼Œå¦‚æœ‹å‹å…³ç³»ã€è´­ä¹°å…³ç³»ç­‰ã€‚</li><li><strong>å±æ€§ï¼ˆPropertyï¼‰</strong>ï¼šèŠ‚ç‚¹å’Œè¾¹éƒ½å¯ä»¥æœ‰å±æ€§ï¼Œå¦‚ç”¨æˆ·çš„å¹´é¾„ã€äº§å“çš„ä»·æ ¼ç­‰ã€‚</li><li><strong>æ ‡ç­¾ï¼ˆLabelï¼‰</strong>ï¼šç”¨äºåˆ†ç±»èŠ‚ç‚¹ï¼Œå¦‚ç”¨æˆ·èŠ‚ç‚¹å¯ä»¥æœ‰â€œç®¡ç†å‘˜â€æ ‡ç­¾ã€‚</li></ul><h4 id="3-è®¾è®¡ç›®çš„-2"><a href="#3-è®¾è®¡ç›®çš„-2" class="headerlink" title="3. è®¾è®¡ç›®çš„"></a>3. <strong>è®¾è®¡ç›®çš„</strong></h4><ul><li>å¤„ç†å¤æ‚çš„å…³ç³»ç½‘ç»œæ•°æ®ï¼Œæä¾›é«˜æ•ˆçš„å›¾å½¢æŸ¥è¯¢å’Œåˆ†æèƒ½åŠ›ã€‚</li><li>æ”¯æŒå®æ—¶æ¨èå’Œç¤¾äº¤ç½‘ç»œåˆ†æã€‚</li></ul><h4 id="4-ä½¿ç”¨åœºæ™¯-2"><a href="#4-ä½¿ç”¨åœºæ™¯-2" class="headerlink" title="4. ä½¿ç”¨åœºæ™¯"></a>4. <strong>ä½¿ç”¨åœºæ™¯</strong></h4><ul><li>ç¤¾äº¤ç½‘ç»œåˆ†æ</li><li>æ¨èç³»ç»Ÿ</li><li>é‡‘èé£é™©ç®¡ç†</li><li>ç”Ÿç‰©ä¿¡æ¯å­¦ï¼ˆåŸºå› ã€è›‹ç™½è´¨å…³ç³»åˆ†æï¼‰</li></ul><hr><h3 id="3-4-InfluxDB"><a href="#3-4-InfluxDB" class="headerlink" title="3.4  InfluxDB"></a>3.4  InfluxDB</h3><h4 id="1-åŸç†-3"><a href="#1-åŸç†-3" class="headerlink" title="1. åŸç†"></a>1. <strong>åŸç†</strong></h4><ul><li><strong>ä¸“ä¸ºæ—¶é—´åºåˆ—æ•°æ®è®¾è®¡</strong>ï¼šæ•°æ®æŒ‰æ—¶é—´æˆ³ç»„ç»‡ï¼Œæ”¯æŒé«˜å†™å…¥å’Œä½æŸ¥è¯¢å»¶è¿Ÿã€‚</li><li><strong>åˆ†å¸ƒå¼æ¶æ„</strong>ï¼šé€šè¿‡åˆ†ç‰‡å’Œå‰¯æœ¬é›†å®ç°æ•°æ®æ°´å¹³æ‰©å±•å’Œé«˜å¯ç”¨æ€§ã€‚</li><li><strong>æŸ¥è¯¢è¯­è¨€</strong>ï¼šæ”¯æŒç±»ä¼¼ SQL çš„æŸ¥è¯¢è¯­æ³•ï¼ˆInfluxQLï¼‰ï¼Œæä¾›å¼ºå¤§çš„æ—¶é—´åºåˆ—æ•°æ®åˆ†æèƒ½åŠ›ã€‚</li></ul><h4 id="2-æ ¸å¿ƒæ¦‚å¿µ-3"><a href="#2-æ ¸å¿ƒæ¦‚å¿µ-3" class="headerlink" title="2. æ ¸å¿ƒæ¦‚å¿µ"></a>2. <strong>æ ¸å¿ƒæ¦‚å¿µ</strong></h4><ul><li><strong>Measurementï¼ˆæµ‹é‡å€¼ï¼‰</strong>ï¼šç±»ä¼¼äºå…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨ï¼Œå­˜å‚¨ä¸€ç»„ç›¸å…³çš„æ•°æ®ç‚¹ã€‚</li><li><strong>Tagï¼ˆæ ‡ç­¾ï¼‰</strong>ï¼šç”¨äºç´¢å¼•çš„é”®å€¼å¯¹ï¼Œé€šå¸¸è¡¨ç¤ºé™æ€æˆ–ä½åŸºæ•°çš„å±æ€§ã€‚</li><li><strong>Fieldï¼ˆå­—æ®µï¼‰</strong>ï¼šå­˜å‚¨å®é™…æ•°æ®çš„é”®å€¼å¯¹ï¼Œé€šå¸¸è¡¨ç¤ºåŠ¨æ€æˆ–é«˜åŸºæ•°çš„å±æ€§ã€‚</li><li><strong>Seriesï¼ˆåºåˆ—ï¼‰</strong>ï¼šç”± Measurementã€Tag Set å’Œ Timestamp å”¯ä¸€ç¡®å®šçš„ä¸€ç»„æ•°æ®ã€‚</li><li><strong>Pointï¼ˆæ•°æ®ç‚¹ï¼‰</strong>ï¼šSeries ä¸­çš„ä¸€ä¸ªå•ç‹¬æ•°æ®è®°å½•ï¼ŒåŒ…å«æ—¶é—´æˆ³å’Œå­—æ®µå€¼ã€‚</li></ul><h4 id="3-è®¾è®¡ç›®çš„-3"><a href="#3-è®¾è®¡ç›®çš„-3" class="headerlink" title="3. è®¾è®¡ç›®çš„"></a>3. <strong>è®¾è®¡ç›®çš„</strong></h4><ul><li>é«˜æ•ˆå­˜å‚¨å’ŒæŸ¥è¯¢æ—¶é—´åºåˆ—æ•°æ®ï¼Œé€‚ç”¨äºç›‘æ§å’Œæ—¥å¿—åˆ†æåœºæ™¯ã€‚</li><li>æ”¯æŒå®æ—¶æ•°æ®å†™å…¥å’Œå†å²æ•°æ®æŸ¥è¯¢ã€‚</li></ul><h4 id="4-ä½¿ç”¨åœºæ™¯-3"><a href="#4-ä½¿ç”¨åœºæ™¯-3" class="headerlink" title="4. ä½¿ç”¨åœºæ™¯"></a>4. <strong>ä½¿ç”¨åœºæ™¯</strong></h4><ul><li>ç›‘æ§ç³»ç»Ÿï¼ˆå¦‚ CPUã€å†…å­˜ä½¿ç”¨æƒ…å†µï¼‰</li><li>ç‰©è”ç½‘è®¾å¤‡æ•°æ®</li><li>åº”ç”¨æ€§èƒ½ç›‘æ§ï¼ˆAPMï¼‰</li><li>æ—¥å¿—æ•°æ®å­˜å‚¨ä¸åˆ†æ</li></ul><hr><h3 id="3-5-Elasticsearch"><a href="#3-5-Elasticsearch" class="headerlink" title="3.5 Elasticsearch"></a>3.5 Elasticsearch</h3><h4 id="1-åŸç†-4"><a href="#1-åŸç†-4" class="headerlink" title="1. åŸç†"></a>1. <strong>åŸç†</strong></h4><ul><li><strong>åŸºäºå€’æ’ç´¢å¼•</strong>ï¼šæ•°æ®ä»¥ JSON æ ¼å¼å­˜å‚¨ï¼Œé€šè¿‡å€’æ’ç´¢å¼•åŠ é€Ÿæœç´¢ã€‚</li><li><strong>åˆ†å¸ƒå¼æ¶æ„</strong>ï¼šé€šè¿‡åˆ†ç‰‡å’Œå‰¯æœ¬é›†å®ç°æ•°æ®æ°´å¹³æ‰©å±•å’Œé«˜å¯ç”¨æ€§ã€‚</li><li><strong>æŸ¥è¯¢è¯­è¨€</strong>ï¼šæ”¯æŒå¼ºå¤§çš„ DSLï¼ˆDomain Specific Languageï¼‰æŸ¥è¯¢è¯­æ³•ï¼Œæä¾›å¤æ‚çš„å…¨æ–‡æœç´¢å’Œèšåˆåˆ†æèƒ½åŠ›ã€‚</li></ul><h4 id="2-æ ¸å¿ƒæ¦‚å¿µ-4"><a href="#2-æ ¸å¿ƒæ¦‚å¿µ-4" class="headerlink" title="2. æ ¸å¿ƒæ¦‚å¿µ"></a>2. <strong>æ ¸å¿ƒæ¦‚å¿µ</strong></h4><ul><li><strong>ç´¢å¼•ï¼ˆIndexï¼‰</strong>ï¼šé€»è¾‘å®¹å™¨ï¼Œå­˜å‚¨ä¸€ç»„ç›¸å…³çš„æ–‡æ¡£ã€‚</li><li><strong>æ–‡æ¡£ï¼ˆDocumentï¼‰</strong>ï¼šå­˜å‚¨çš„åŸºæœ¬å•å…ƒï¼Œä»¥ JSON æ ¼å¼å­˜å‚¨ã€‚</li><li><strong>æ˜ å°„ï¼ˆMappingï¼‰</strong>ï¼šå®šä¹‰å­—æ®µç±»å‹ï¼Œç±»ä¼¼äºå…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨ç»“æ„ã€‚</li><li><strong>å€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰</strong>ï¼šåŠ é€Ÿæœç´¢çš„å…³é”®æ•°æ®ç»“æ„ï¼Œå°†è¯æ˜ å°„åˆ°åŒ…å«è¯¥è¯çš„æ–‡æ¡£ã€‚</li></ul><h4 id="3-è®¾è®¡ç›®çš„-4"><a href="#3-è®¾è®¡ç›®çš„-4" class="headerlink" title="3. è®¾è®¡ç›®çš„"></a>3. <strong>è®¾è®¡ç›®çš„</strong></h4><ul><li>æä¾›åˆ†å¸ƒå¼å…¨æ–‡æœç´¢å’Œåˆ†æèƒ½åŠ›ï¼Œé€‚ç”¨äºå¤§è§„æ¨¡æ•°æ®æ£€ç´¢å’Œåˆ†æã€‚</li><li>æ”¯æŒå®æ—¶æ•°æ®ç´¢å¼•å’ŒæŸ¥è¯¢ã€‚</li></ul><h4 id="4-ä½¿ç”¨åœºæ™¯-4"><a href="#4-ä½¿ç”¨åœºæ™¯-4" class="headerlink" title="4. ä½¿ç”¨åœºæ™¯"></a>4. <strong>ä½¿ç”¨åœºæ™¯</strong></h4><ul><li>æ—¥å¿—åˆ†æ</li><li>å®‰å…¨ä¿¡æ¯å’Œäº‹ä»¶ç®¡ç†ï¼ˆSIEMï¼‰</li><li>åº”ç”¨æœç´¢</li><li>ç”µå­å•†åŠ¡æœç´¢</li></ul><hr><h3 id="3-6-ClickHouse"><a href="#3-6-ClickHouse" class="headerlink" title="3.6 ClickHouse"></a>3.6 ClickHouse</h3><h4 id="1-åŸç†-5"><a href="#1-åŸç†-5" class="headerlink" title="1. åŸç†"></a>1. <strong>åŸç†</strong></h4><ul><li><strong>åŸºäºåˆ—å¼å­˜å‚¨</strong>ï¼šæ•°æ®æŒ‰åˆ—å­˜å‚¨ï¼Œæ”¯æŒé«˜æ•ˆå‹ç¼©å’Œå¹¶è¡Œå¤„ç†ã€‚</li><li><strong>MergeTree å¼•æ“</strong>ï¼šæ”¯æŒåˆ†åŒºã€æ’åºé”®å’Œå‹ç¼©ç®—æ³•ï¼Œä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ã€‚</li><li><strong>æŸ¥è¯¢è¯­è¨€</strong>ï¼šæ”¯æŒç±»ä¼¼ SQL çš„æŸ¥è¯¢è¯­æ³•ï¼Œæä¾›å¼ºå¤§çš„æ•°æ®åˆ†æèƒ½åŠ›ã€‚</li></ul><h4 id="2-æ ¸å¿ƒæ¦‚å¿µ-5"><a href="#2-æ ¸å¿ƒæ¦‚å¿µ-5" class="headerlink" title="2. æ ¸å¿ƒæ¦‚å¿µ"></a>2. <strong>æ ¸å¿ƒæ¦‚å¿µ</strong></h4><ul><li><strong>åˆ—å¼å­˜å‚¨</strong>ï¼šæ•°æ®æŒ‰åˆ—å­˜å‚¨ï¼Œå‡å°‘ç£ç›˜ I&#x2F;Oï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</li><li><strong>MergeTree å¼•æ“</strong>ï¼šClickHouse çš„æ ¸å¿ƒå­˜å‚¨å¼•æ“ï¼Œæ”¯æŒåˆ†åŒºã€æ’åºé”®å’Œå‹ç¼©ç®—æ³•ã€‚</li><li><strong>åˆ†åŒºï¼ˆPartitionï¼‰</strong>ï¼šå°†æ•°æ®æŒ‰æ—¶é—´æˆ–å…¶ä»–ç»´åº¦åˆ†åŒºï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</li><li><strong>æ’åºé”®ï¼ˆOrdering Keyï¼‰</strong>ï¼šå®šä¹‰æ•°æ®åœ¨åˆ—ä¸­çš„æ’åºæ–¹å¼ï¼Œå½±å“æŸ¥è¯¢æ€§èƒ½ã€‚</li><li><strong>å‹ç¼©ç®—æ³•</strong>ï¼šæ”¯æŒå¤šç§å‹ç¼©ç®—æ³•ï¼Œå‡å°‘å­˜å‚¨ç©ºé—´ã€‚</li></ul><h4 id="3-è®¾è®¡ç›®çš„-5"><a href="#3-è®¾è®¡ç›®çš„-5" class="headerlink" title="3. è®¾è®¡ç›®çš„"></a>3. <strong>è®¾è®¡ç›®çš„</strong></h4><ul><li>æä¾›é«˜æ€§èƒ½çš„ OLAP æŸ¥è¯¢èƒ½åŠ›ï¼Œé€‚ç”¨äºå®æ—¶æ•°æ®åˆ†æåœºæ™¯ã€‚</li><li>æ”¯æŒå¤§è§„æ¨¡æ•°æ®çš„é«˜æ•ˆæŸ¥è¯¢å’Œåˆ†æã€‚</li></ul><h4 id="4-ä½¿ç”¨åœºæ™¯-5"><a href="#4-ä½¿ç”¨åœºæ™¯-5" class="headerlink" title="4. ä½¿ç”¨åœºæ™¯"></a>4. <strong>ä½¿ç”¨åœºæ™¯</strong></h4><ul><li>å®æ—¶æ•°æ®åˆ†æ</li><li>å¤§æ•°æ®åˆ†æ</li><li>æ•°æ®ä»“åº“</li><li>å•†ä¸šæ™ºèƒ½ï¼ˆBIï¼‰</li><li>ç”¨æˆ·è¡Œä¸ºåˆ†æ</li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åˆ†å¸ƒå¼é™æµ</title>
    <link href="/%E5%88%86%E5%B8%83%E5%BC%8F%E9%99%90%E6%B5%81/"/>
    <url>/%E5%88%86%E5%B8%83%E5%BC%8F%E9%99%90%E6%B5%81/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h1><p>åˆ†å¸ƒå¼åŒºåˆ«äºå•æœºé™æµçš„åœºæ™¯,å®ƒæŠŠæ•´ä¸ªåˆ†å¸ƒå¼ç¯å¢ƒä¸­æ‰€æœ‰æœåŠ¡å½“åšä¸€ä¸ªæ•´ä½“æ¥è€ƒé‡ã€‚æ¯”å¦‚è¯´é’ˆå¯¹IPçš„é™æµ,æˆ‘ä»¬é™åˆ¶äº†1ä¸ªIPæ¯ç§’æœ€å¤š10ä¸ªè®¿é—®,ä¸ç®¡æ¥è‡ªè¿™ä¸ªIPçš„è¯·æ±‚è½åœ¨äº†å“ªå°æœºå™¨ä¸Š,åªè¦æ˜¯è®¿é—®äº†é›†ç¾¤ä¸­çš„æœåŠ¡èŠ‚ç‚¹,é‚£ä¹ˆéƒ½éƒ½ä¼šå—åˆ°é™æµè§„åˆ™çš„åˆ¶çº¦ã€‚</p><p>ä»ä¸Šé¢çš„ä¾‹å­ä¸éš¾çœ‹å‡º,æˆ‘ä»¬å¿…é¡»å°†é™æµä¿¡æ¯ä¿å­˜åœ¨ä¸€ä¸ªâ€ä¸­å¿ƒåŒ–çš„ç»„ä»¶ä¸Š,è¿™æ ·å®ƒå°±å¯ä»¥è·å–åˆ°é›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨çš„è®¿é—®çŠ¶æ€,ç›®å‰å‰æœ‰ä¸¤ä¸ªæ¯”è¾ƒä¸»æµçš„é™æµæ–¹æ¡ˆ:</p><ul><li>ç½‘å…³å±‚é™æµå°†é™æµè§„åˆ™åº”ç”¨åœ¨æ‰€æœ‰æµé‡çš„å…¥å£å¤„</li><li>ä¸­é—´ä»¶é™æµ å°†é™æµä¿¡æ¯å­˜å‚¨åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­æŸä¸ªä¸­é—´ä»¶é‡Œ(æ¯”å¦‚Redisç¼“å­˜),æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥ä»è¿™é‡Œè·å–åˆ°å½“å‰æ—¶åˆ»çš„æµé‡ç»Ÿè¯•,ä»è€Œå†³å®šæ˜¯æ‹’ç»æœåŠ¡è¿˜æ˜¯æ”¾è¡Œæµé‡</li></ul><h1 id="2-å¸¸è§çš„é™æµè§„åˆ™"><a href="#2-å¸¸è§çš„é™æµè§„åˆ™" class="headerlink" title="2. å¸¸è§çš„é™æµè§„åˆ™"></a>2. å¸¸è§çš„é™æµè§„åˆ™</h1><ol><li><p>QPSå’Œè¿æ¥æ•°æ§åˆ¶</p><ul><li>é’ˆå¯¹è¿æ¥æ•°å’ŒQPS(querypersecond)é™æµæ¥è¯´, æˆ‘ä»¬å¯ä»¥è®¾å®šIPç»´åº¦çš„é™æµ, ä¹Ÿå¯ä»¥è®¾ç½®åŸºäºå•ä¸ªæœåŠ¡å™¨çš„é™æµã€‚</li><li>åœ¨çœŸå®ç¯å¢ƒä¸­é€šå¸¸ä¼šè®¾ç½®å¤šä¸ªç»´åº¦çš„é™æµè§„åˆ™, æ¯”å¦‚è®¾å®šåŒä¸€ä¸ªIPæ¯ç§’è®¿é—®é¢‘ç‡å°äº10, è¿æ¥æ•°å°äº5,å†è®¾å®šæ¯å°æœºå™¨QPSæœ€é«˜1000,è¿æ¥æ•°æœ€å¤§ä¿æŒ200ã€‚æ›´è¿›ä¸€æ­¥,æˆ‘ä»¬å¯ä»¥æŠŠæŸä¸ªæœåŠ¡å™¨ç»„æˆ–æ•´ä¸ªæœºæˆ¿çš„æœåŠ¡å™¨å½“åšä¸€ä¸ªæ•´ä½“, è®¾ç½®æ›´hign-levelçš„é™æµè§„åˆ™, è¿™äº›æ‰€æœ‰é™æµè§„åˆ™éƒ½ä¼šå…±åŒä½œç”¨äºæ´—é‡æ§åˆ¶ã€‚</li></ul></li><li><p>ä¼ è¾“é€Ÿç‡</p><ul><li>å¯¹äºâ€ä¼ è¾“é€Ÿç‡â€å¤§å®¶éƒ½ä¸ä¼šé™Œç”Ÿ, æ¯”å¦‚èµ„æºçš„ä¸‹è½½é€Ÿåº¦ã€‚æœ‰çš„ç½‘ç«™åœ¨è¿™æ–¹é¢çš„é™æµé€»è¾‘åšçš„æ›´ç»†è‡´,æ¯”å¦‚æ™®é€šæ³¨å†Œç”¨æˆ·ä¸‹è½½é€Ÿåº¦ä¸º100k&#x2F;s,è´­ä¹°ä¼šå‘˜åæ˜¯10M&#x2F;S, è¿™èƒŒåå°±æ˜¯åŸºäºç”¨æˆ·ç»„æˆ–è€…ç”¨æˆ·æ ‡ç­¾çš„é™æµé€»è¾‘ã€‚</li></ul></li><li><p>é»‘ç™½åå•</p><ul><li><p>é»‘ç™½åå•æ˜¯å„ä¸ªå¤§å‹ä¼ä¸šåº”ç”¨é‡Œå¾ˆå¸¸è§çš„é™æµå’Œæ”¾è¡Œæ‰‹æ®µ, è€Œä¸”é»‘ç™½åå•å¾€å¾€æ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚ä¸¾ä¸ªä¾‹å­,å¦‚æœæŸä¸ªIPåœ¨ä¸€æ®µæ—¶é—´çš„çš„è®¿é—®æ¬¡æ•°è¿‡äºé¢‘ç¹,è¢«ç³»ç»Ÿè¯†åˆ«ä¸ºæœºå™¨äººç”¨æˆ·æˆ–æµé‡æ”»å‡»,é‚£ä¹ˆè¿™ä¸ªIPå°±ä¼šè¢«åŠ å…¥åˆ°é»‘åå•,ä»è€Œé™åˆ¶å…¶å¯¹ç³»ç»Ÿèµ„æºçš„è®¿é—®,è¿™å°±æ˜¯æˆ‘ä»¬ä¿—ç§°çš„â€å°IPâ€ã€‚</p><blockquote><p>æˆ‘ä»¬å¹³æ—¶è§åˆ°çš„çˆ¬è™«ç¨‹åº,æ¯”å¦‚è¯´çˆ¬çŸ¥ä¹ä¸Šçš„ç¾å¥³å›¾ç‰‡,æˆ–è€…çˆ¬åˆ¸å•†ç³»ç»Ÿçš„è‚¡ç¥¨åˆ†æ—¶ä¿¡æ¯,è¿™ç±»çˆ¬è™«ç¨‹åºéƒ½å¿…é¡»å®ç°æ›´æ¢IPçš„åŠŸèƒ½,ä»¥é˜²è¢«åŠ å…¥é»‘åå•ã€‚æœ‰æ—¶æˆ‘ä»¬è¿˜ä¼šå‘ç°å…¬å¸çš„ç½‘ç»œæ— æ³•è®¿é—®12306è¿™ç±»å¤§å‹å…¬å…±ç½‘ç«™, è¿™ä¹Ÿæ˜¯å› ä¸ºäº†æŸäº›å…¬å¸çš„å‡ºç½‘IPæ˜¯åŒä¸€ä¸ªåœ°å€, å› æ­¤åœ¨è®¿é—®é‡è¿‡é«˜çš„æƒ…å†µä¸‹,è¿™ä¸ªIPåœ°å€å°±è¢«å¯¹æ–¹ç³»ç»Ÿè¯†åˆ«,è¿›è€Œè¢«æ·»åŠ åˆ°äº†é»‘åå•ã€‚ä½¿ç”¨å®¶åº­å®½å¸¦çš„åŒå­¦ä»¬åº”è¯¥çŸ¥é“,å¤§éƒ¨åˆ†ç½‘ç»œè¿è¥å•†éƒ½ä¼šå°†ç”¨æˆ·åˆ†é…åˆ°ä¸åŒå‡ºç½‘IPæ®µ,æˆ–è€…æ—¶ä¸æ—¶åŠ¨æ€æ›´æ¢ç”¨æˆ·çš„IPåœ°å€ã€‚</p></blockquote></li><li><p>ç™½åå•å°±æ›´å¥½ç†è§£äº†,ç›¸å½“äºå¾¡èµé‡‘ç‰Œåœ¨èº«,å¯ä»¥è‡ªç”±ç©¿æ¢­åœ¨å„ç§é™æµè§„åˆ™é‡Œ,ç•…è¡Œæ— é˜»ã€‚æ¯”å¦‚æŸäº›ç”µå•†å…¬å¸ä¼šå°†è¶…å¤§å–å®¶çš„è´¦å·åŠ å…¥ç™½åå•,å› ä¸ºè¿™ç±»å–å®¶å¾€å¾€æœ‰è‡ªå·±çš„ä¸€å¥—è¿ç»´ç³»ç»Ÿ,éœ€è¦å¯¹æ¥å…¬å¸çš„ITç³»ç»Ÿåšå¤§é‡çš„å•†å“å‘å¸ƒã€è¡¥è´§ç­‰ç­‰æ“ä½œã€‚</p></li></ul></li></ol><blockquote><p>åŒå­¦ä»¬è‚¯å®šå‘ç°äº†è¿™æ ·ä¸€ç§æƒ…å†µ,åœ¨æ˜¥è¿æŠ¢ç¥¨çš„æ—¶å€™,å½“ä½ é¢å¯¹è¿™ä¹ˆä¸€å †éªŒè¯ç å›¾ç‰‡,ä¸ç®¡ä½ æ€ä¹ˆé€‰,å³ä½¿ä½ ç”¨æ¯•ç”Ÿæ‰€å­¦å­¦é€‰å‡ºäº†æ­£ç¡®ç­”æ¡ˆ,æäº¤åä¾ç„¶éƒ½ä¼šè¢«å‘ŠçŸ¥ä½ é€‰ é”™äº†ã€‚è¦ä¹ˆå°±æ˜¯è®©ä½ é¢å¯¹ä¸€å †é¬¼éƒ½çœ‹ä¸å‡ºæ˜¯ä»€ä¹ˆä¸œè¥¿çš„å›¾ç‰‡ã€‚ä¸è¦ä¸ç–‘è‡ªå·±çš„æ™ºå•†,å…¶å®,è¿™å°±æ˜¯ç½‘ç«™çš„ä¸€ç§åˆ«æ ·çš„é™æµæªæ–½ã€‚åœ¨æ‹·é—®æ²³ç”¨æˆ·æ™ºå•†çš„åŒæ—¶,é€šè¿‡è¿™ç§â€æ•… æ„â€åˆéš¾çš„æ‰‹æ®µ,å…‰æ˜æ­£å¤§åœ°é™åˆ¶è®¿é—®æµé‡,ä»è€Œå¤§å¹…é™ä½ç³»ç»Ÿçš„è®¿é—®å‹åŠ›,çœŸä¸å¾—ä¸æ•¬ä½©äº§å“ç»ç†çš„æ™º(è‰¯)æ…§(å¿ƒ)ã€‚</p></blockquote><h1 id="3-é™æµå®ç°æ–¹æ¡ˆ"><a href="#3-é™æµå®ç°æ–¹æ¡ˆ" class="headerlink" title="3. é™æµå®ç°æ–¹æ¡ˆ"></a>3. é™æµå®ç°æ–¹æ¡ˆ</h1><h2 id="1-guava-RateLimiter-å®¢æˆ·ç«¯é™æµ"><a href="#1-guava-RateLimiter-å®¢æˆ·ç«¯é™æµ" class="headerlink" title="1. guava RateLimiter å®¢æˆ·ç«¯é™æµ"></a>1. guava RateLimiter å®¢æˆ·ç«¯é™æµ</h2><h3 id="1-å®šä¹‰-1"><a href="#1-å®šä¹‰-1" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h3><p>Guava çš„ <code>RateLimiter</code> æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å®¢æˆ·ç«¯é™æµå·¥å…·ï¼Œé€‚ç”¨äºå•æœºç¯å¢ƒä¸‹çš„æµé‡æ§åˆ¶ã€‚å®ƒåŸºäºä»¤ç‰Œæ¡¶ç®—æ³•å®ç°ï¼Œèƒ½å¤Ÿå¹³æ»‘åœ°é™åˆ¶è¯·æ±‚é€Ÿç‡ã€‚</p><p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p><ul><li>æ”¯æŒå›ºå®šçš„ç”Ÿæˆé€Ÿç‡ï¼ˆQPSï¼‰ã€‚</li><li>æ”¯æŒçªå‘è¯·æ±‚ï¼ˆå…è®¸çŸ­æ—¶é—´å†…è¶…å‡ºé€Ÿç‡é™åˆ¶ï¼‰ã€‚</li><li>éé˜»å¡å¼å’Œé˜»å¡å¼ä¸¤ç§è·å–ä»¤ç‰Œçš„æ–¹å¼ã€‚</li></ul><h3 id="2-åŸç†"><a href="#2-åŸç†" class="headerlink" title="2. åŸç†"></a>2. åŸç†</h3><p><strong>ä»¤ç‰Œæ¡¶ç®—æ³•</strong>ï¼šç³»ç»Ÿä»¥å›ºå®šé€Ÿç‡ç”Ÿæˆä»¤ç‰Œï¼Œæ¯ä¸ªè¯·æ±‚éœ€è¦æ¶ˆè€—ä¸€ä¸ªä»¤ç‰Œã€‚å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„ä»¤ç‰Œï¼Œåˆ™è¯·æ±‚è¢«é˜»å¡æˆ–æ‹’ç»ã€‚</p><h3 id="3-ä½¿ç”¨"><a href="#3-ä½¿ç”¨" class="headerlink" title="3. ä½¿ç”¨"></a>3. ä½¿ç”¨</h3><ol><li>å¼•å…¥ä¾èµ–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.google.guava<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>guava<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>18.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><ol start="2"><li>ä»£ç å®æˆ˜</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Controller</span> </span>&#123;<br>  RateLimiter limiter = RateLimiter.create(<span class="hljs-number">2.0</span>);<br>  <br>  <span class="hljs-comment">//åœºæ™¯ä¸€ï¼šéé˜»å¡é™æµ</span><br>  <span class="hljs-meta">@GetMapping(&quot;/tryAcquire&quot;)</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">tryAcquire</span><span class="hljs-params">(Integer count)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span>(limiter.tryAcquire(count))&#123; <span class="hljs-comment">// count:ä¸€æ¬¡å ç”¨å‡ ä¸ªä»¤ç‰Œ</span><br>      log.info(<span class="hljs-string">&quot;success, rate is &#123;&#125;&quot;</span>, limiter.getRate());<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      log.info(<span class="hljs-string">&quot;fail, rate is &#123;&#125;&quot;</span>, limiter.getRate());<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;fail&quot;</span>;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">//åœºæ™¯äºŒï¼šé™å®šæ—¶é—´çš„éé˜»å¡é™æµ, å¦‚ï¼šçœ‹åœ¨æŒ‡å®šæ—¶é—´å†…ï¼Œèƒ½å¦æ»¡è¶³æˆ‘çš„è°ƒç”¨è¯·æ±‚</span><br>  <span class="hljs-meta">@GetMapping(&quot;/tryAcquireWithTimeout&quot;)</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">tryAcquireWithTimeout</span><span class="hljs-params">(Integer countInteger timeout)</span></span>&#123;<br>    <span class="hljs-keyword">if</span> (limiter.tryAcquire(count, timeout, TimeUnit.SSECONDS))<br>      log.info(<span class="hljs-string">&quot;success, rate is &#123;&#125;&quot;</span>, limiter.getRate())<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      log.info(<span class="hljs-string">&quot;fail, rate is &#123;&#125;&quot;</span>, limiter.getRate());<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;fail&quot;</span>;<br>    &#125;<br>  &#125;<br><br><br>  <span class="hljs-comment">//åœºæ™¯ä¸‰ï¼šåŒæ­¥é˜»å¡é™æµã€‚èƒ½è·å–å°±è·å–ï¼Œè·å–ä¸åˆ°å°±é˜»å¡</span><br>  <span class="hljs-meta">@GetMapping(&quot;/acquire&quot;)</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">acquire</span><span class="hljs-params">(Integer count)</span> </span>&#123;<br>    limiter.acquire(count);<br>    log.info(<span class="hljs-string">&quot;success, rate is &#123;&#125;&quot;</span>, limiter.getRate());<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>  &#125;                                  <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-åŸºäºNginxé™æµ"><a href="#2-åŸºäºNginxé™æµ" class="headerlink" title="2. åŸºäºNginxé™æµ"></a>2. åŸºäºNginxé™æµ</h2><h3 id="1-é…ç½®å•æœºé™æµï¼ˆç±»ä¼¼IPé™æµï¼‰"><a href="#1-é…ç½®å•æœºé™æµï¼ˆç±»ä¼¼IPé™æµï¼‰" class="headerlink" title="1. é…ç½®å•æœºé™æµï¼ˆç±»ä¼¼IPé™æµï¼‰"></a>1. é…ç½®å•æœºé™æµï¼ˆç±»ä¼¼IPé™æµï¼‰</h3><p>Nginx æä¾›äº†å†…ç½®çš„é™æµæ¨¡å—ï¼Œå¯ä»¥åœ¨ç½‘å…³å±‚å®ç°åˆ†å¸ƒå¼é™æµã€‚</p><h4 id="1-ä¼˜ç‚¹"><a href="#1-ä¼˜ç‚¹" class="headerlink" title="1. ä¼˜ç‚¹"></a>1. ä¼˜ç‚¹</h4><ul><li>ç®€å•é«˜æ•ˆï¼Œé€‚åˆç½‘å…³å±‚é™æµã€‚</li><li>ä¸éœ€è¦ä¿®æ”¹åç«¯ä¸šåŠ¡ä»£ç ã€‚</li></ul><h4 id="2-å®ç°æ­¥éª¤"><a href="#2-å®ç°æ­¥éª¤" class="headerlink" title="2. å®ç°æ­¥éª¤"></a>2. å®ç°æ­¥éª¤</h4><ol><li>ä¿®æ”¹nginx.conf</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml">limit_req_zone $binary_remote_addr zone=iplimit:20m rate=1r/s;<br><br>server &#123;<br>    server_name www.imooc-training.com;<br>    location /access-limit/ &#123;<br>        proxy_pass http://127.0.0.1:10086/;<br>        limit_req zone=iplimit burst=2 nodelay;<br>        limit_req_status 504;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>limit_req_zone $binary_remote_addr zone&#x3D;iplimit:20m rate&#x3D;1r&#x2F;s;</p><ul><li><p>$binary_remote_addr :  binary_ç›®çš„æ˜¯ç¼©å†™å†…å­˜å ç”¨,remote_addrè¡¨ç¤ºé€šè¿‡IPåœ°å€æ¥é™æµ</p></li><li><p>zone&#x3D;iplimit:20m:   iplimitæ˜¯ä¸€å—å†…å­˜åŒºåŸŸ(è®°å½•è®¿é—®é¢‘ç‡ä¿¡æ¯),20mæ˜¯æŒ‡è¿™å—å†…æœ‰å­˜åŒºåŸŸçš„å¤§å°ä¸º20Mb</p></li><li><p>rate&#x3D;1r&#x2F;s.:  æ¯”å¦‚100r&#x2F;m,æ ‡è¯†è®¿é—®çš„é™æµé¢‘ç‡</p></li></ul></li><li><p>limit_req zone&#x3D;iplimit burst&#x3D;2 nodelay;</p><ul><li>zone&#x3D;iplimit:  å¼•ç”¨limit_req_zoneä¸­çš„zoneå˜é‡</li><li>burst&#x3D;2,è®¾ç½®ä¸€ä¸ªå¤§å°ä¸º2çš„ç¼“å†²åŒºåŸŸ,å½“å¤§é‡è¯·æ±‚åˆ°æ¥ã€‚è¯·æ±‚æ•°é‡è¶…è¿‡é™æµé¢‘ç‡æ—¶,å°†å…¶æ”¾å…¥ç¼“å†²åŒºåŸŸ</li><li>nodelay&#x3D;&gt;ç¼“å†²åŒºæ»¡äº†ä»¥å,ç›´æ¥è¿”å›503å¼‚å¸¸</li></ul></li><li><p>limit_req_status 504</p><ul><li>å¼‚å¸¸æƒ…å†µ,è¿”å›504(é»˜è®¤æ˜¯503)</li></ul></li></ul><ol start="2"><li>æµ‹è¯•controller</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/nginx&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">nginx</span><span class="hljs-params">()</span></span>&#123;<br>  log.info(<span class="hljs-string">&quot;Nginx success&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-åŸºäºæœåŠ¡å™¨çº§åˆ«é™æµ"><a href="#2-åŸºäºæœåŠ¡å™¨çº§åˆ«é™æµ" class="headerlink" title="2. åŸºäºæœåŠ¡å™¨çº§åˆ«é™æµ"></a>2. åŸºäºæœåŠ¡å™¨çº§åˆ«é™æµ</h3><p>ä¸ç®¡ä»€ä¹ˆIPåŠ åœ¨ä¸€èµ·ä¸èƒ½è¶…è¿‡æŸä¸ªå€¼ï¼Œé€šå¸¸æƒ…å†µä¸‹,serverçº§åˆ«çš„é™æµé€Ÿç‡æ˜¯æœ€å¤§çš„ã€‚</p><h4 id="1-å®ç°æ­¥éª¤"><a href="#1-å®ç°æ­¥éª¤" class="headerlink" title="1. å®ç°æ­¥éª¤"></a>1. å®ç°æ­¥éª¤</h4><ol><li>æ”¹niginx.conf</li></ol><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">limit_req_zone <span class="hljs-variable">$server_name</span> <span class="hljs-attribute">zone</span>=serverlimit:10m <span class="hljs-attribute">rate</span>=1r/s;<br>limit_req <span class="hljs-attribute">zone</span>=serverlimit <span class="hljs-attribute">burst</span>=1 nodeelay;<br></code></pre></td></tr></table></figure><h3 id="3-åŸºäºè¿æ¥æ•°"><a href="#3-åŸºäºè¿æ¥æ•°" class="headerlink" title="3. åŸºäºè¿æ¥æ•°"></a>3. åŸºäºè¿æ¥æ•°</h3><p>å½“å‰activeçš„è¿æ¥æ•°</p><h4 id="1-å®ç°æ­¥éª¤-1"><a href="#1-å®ç°æ­¥éª¤-1" class="headerlink" title="1. å®ç°æ­¥éª¤"></a>1. å®ç°æ­¥éª¤</h4><ol><li>æ”¹niginx.conf</li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#æ¯ä¸ªserveræœ€å¤šä¿æŒ100ä¸ªè¿æ¥</span><br><span class="hljs-attribute">limit_conn</span> perserver <span class="hljs-number">100</span>;<br><br><span class="hljs-attribute">limit_conn_zone</span> $binary_remote_addr zone=perip:<span class="hljs-number">20</span>m;<br><span class="hljs-comment">#æ¯ä¸ªIPåœ°å€æœ€å¤šä¿æŒ1ä¸ªè¿æ¥</span><br><span class="hljs-attribute">limit_conn</span> perip <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><ol start="2"><li>æµ‹è¯•</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/nginx-conn&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">nginxConn</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(defaultValue = &quot;0&quot;)</span> <span class="hljs-keyword">int</span> secs)</span> </span>&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      Thread.sleep( millis: <span class="hljs-number">1000</span> * secs);<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-redis-Lua"><a href="#3-redis-Lua" class="headerlink" title="3. redis+Lua"></a>3. redis+Lua</h2><h3 id="1-å®šä¹‰-2"><a href="#1-å®šä¹‰-2" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h3><p>åˆ©ç”¨RedisåŸå­æ“ä½œï¼Œé€šè¿‡Luaè„šæœ¬å®ç°ä»¤ç‰Œç”Ÿæˆä¸è·å–ï¼Œé¿å…å¹¶å‘é—®é¢˜ã€‚</p><h3 id="2-å®ç°æ­¥éª¤-1"><a href="#2-å®ç°æ­¥éª¤-1" class="headerlink" title="2. å®ç°æ­¥éª¤"></a>2. å®ç°æ­¥éª¤</h3><ol><li>ç¼–å†™Luaé™æµè„šæœ¬</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs lua"><span class="hljs-comment">-- è·å–æ–¹æ³•ç­¾åç‰¹å¾</span><br><span class="hljs-keyword">local</span> methodKey = KEYS[<span class="hljs-number">1</span>]<br>redis.<span class="hljs-built_in">log</span>(redis.LOG_DEBUG, <span class="hljs-string">&#x27;key is&#x27;</span>, methodKey)<br><br><span class="hljs-comment">-- è°ƒç”¨è„šæœ¬ä¼ å…¥çš„é™æµå¤§å°</span><br><span class="hljs-keyword">local</span> limit = <span class="hljs-built_in">tonumber</span>(ARGV[<span class="hljs-number">1</span>])<br><br><span class="hljs-comment">-- è·å–å½“å‰æµé‡å¤§å°</span><br><span class="hljs-keyword">local</span> count = <span class="hljs-built_in">tonumber</span>(redis.call(<span class="hljs-string">&#x27;get&#x27;</span>, methodKey) <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;0&quot;</span>)<br><br><span class="hljs-comment">-- æ˜¯å¦è¶…å‡ºé™æµé˜ˆå€¼</span><br><span class="hljs-keyword">if</span> count + <span class="hljs-number">1</span> &gt; limit <span class="hljs-keyword">then</span><br>    <span class="hljs-comment">-- æ‹’ç»æœåŠ¡è®¿é—®</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br><span class="hljs-keyword">else</span><br>    <span class="hljs-comment">-- æ²¡æœ‰è¶…è¿‡é˜ˆå€¼</span><br>    <span class="hljs-comment">-- è®¾ç½®å½“å‰è®¿é—®çš„æ•°é‡+1</span><br>    redis.call(<span class="hljs-string">&quot;INCRBY&quot;</span>, methodKey, <span class="hljs-number">1</span>)<br>    <span class="hljs-comment">-- è®¾ç½®è¿‡æœŸæ—¶é—´</span><br>    redis.call(<span class="hljs-string">&quot;EXPIRE&quot;</span>, methodKey, <span class="hljs-number">1</span>)<br>    <span class="hljs-comment">-- æ”¾è¡Œ</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><ol start="2"><li>Java é›†æˆLuaå’ŒRedis</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis&lt;/artifactId<br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-aop&lt;/artifactId<br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.imooc.springcloud;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.core.io.ClassPathResource;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.connection.RedisConnectionFactory;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.core.RedisTemplate;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.core.StringRedisTemplate;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.core.script.DefaultRedisScript;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Created by åŠä»™.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedisConfiguration</span> </span>&#123;<br><br>    <span class="hljs-comment">// å¦‚æœæœ¬åœ°ä¹Ÿé…ç½®äº†StringRedisTemplateï¼Œå¯èƒ½ä¼šäº§ç”Ÿå†²çª</span><br>    <span class="hljs-comment">// å¯ä»¥æŒ‡å®š@Primaryï¼Œæˆ–è€…æŒ‡å®šåŠ è½½ç‰¹å®šçš„@Qualifier</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> RedisTemplate&lt;String, String&gt; <span class="hljs-title">redisTemplate</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">            RedisConnectionFactory factory)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> StringRedisTemplate(factory);<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> DefaultRedisScript <span class="hljs-title">loadRedisScript</span><span class="hljs-params">()</span> </span>&#123;<br>        DefaultRedisScript redisScript = <span class="hljs-keyword">new</span> DefaultRedisScript();<br>        redisScript.setLocation(<span class="hljs-keyword">new</span> ClassPathResource(<span class="hljs-string">&quot;ratelimiter.lua&quot;</span>));<br>        redisScript.setResultType(java.lang.Boolean.class);<br>        <span class="hljs-keyword">return</span> redisScript;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.imooc.springcloud.annotation;<br><br><span class="hljs-keyword">import</span> java.lang.annotation.*;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Created by åŠä»™.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Target(&#123;ElementType.METHOD&#125;)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> AccessLimiter &#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">limit</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-function">String <span class="hljs-title">methodKey</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;&quot;</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.imooc.springcloud.annotation;<br><br><span class="hljs-keyword">import</span> com.google.common.collect.Lists;<br><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;<br><span class="hljs-keyword">import</span> org.aspectj.lang.JoinPoint;<br><span class="hljs-keyword">import</span> org.aspectj.lang.annotation.Aspect;<br><span class="hljs-keyword">import</span> org.aspectj.lang.annotation.Before;<br><span class="hljs-keyword">import</span> org.aspectj.lang.annotation.Pointcut;<br><span class="hljs-keyword">import</span> org.aspectj.lang.reflect.MethodSignature;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.core.StringRedisTemplate;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.core.script.RedisScript;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.stream.Collectors;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Created by åŠä»™.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@Aspect</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccessLimiterAspect</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> StringRedisTemplate stringRedisTemplate;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RedisScript&lt;Boolean&gt; rateLimitLua;<br><br>    <span class="hljs-meta">@Pointcut(&quot;@annotation(com.imooc.springcloud.annotation.AccessLimiter)&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cut</span><span class="hljs-params">()</span> </span>&#123;<br>        log.info(<span class="hljs-string">&quot;cut&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Before(&quot;cut()&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">(JoinPoint joinPoint)</span> </span>&#123;<br>        <span class="hljs-comment">// 1. è·å¾—æ–¹æ³•ç­¾åï¼Œä½œä¸ºmethod Key</span><br>        MethodSignature signature = (MethodSignature) joinPoint.getSignature();<br>        Method method = signature.getMethod();<br><br>        AccessLimiter annotation = method.getAnnotation(AccessLimiter.class);<br>        <span class="hljs-keyword">if</span> (annotation == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        String key = annotation.methodKey();<br>        Integer limit = annotation.limit();<br><br>        <span class="hljs-comment">// å¦‚æœæ²¡è®¾ç½®methodkey, ä»è°ƒç”¨æ–¹æ³•ç­¾åç”Ÿæˆè‡ªåŠ¨ä¸€ä¸ªkey</span><br>        <span class="hljs-keyword">if</span> (StringUtils.isEmpty(key)) &#123;<br>            Class[] type = method.getParameterTypes();<br>            key = method.getClass() + method.getName();<br><br>            <span class="hljs-keyword">if</span> (type != <span class="hljs-keyword">null</span>) &#123;<br>                String paramTypes = Arrays.stream(type)<br>                        .map(Class::getName)<br>                        .collect(Collectors.joining(<span class="hljs-string">&quot;,&quot;</span>));<br>                log.info(<span class="hljs-string">&quot;param types: &quot;</span> + paramTypes);<br>                key += <span class="hljs-string">&quot;#&quot;</span> + paramTypes;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">// 2. è°ƒç”¨Redis</span><br>        <span class="hljs-keyword">boolean</span> acquired = stringRedisTemplate.execute(<br>                rateLimitLua, <span class="hljs-comment">// Lua scriptçš„çœŸèº«</span><br>                Lists.newArrayList(key), <span class="hljs-comment">// Luaè„šæœ¬ä¸­çš„Keyåˆ—è¡¨</span><br>                limit.toString() <span class="hljs-comment">// Luaè„šæœ¬Valueåˆ—è¡¨</span><br>        );<br><br>        <span class="hljs-keyword">if</span> (!acquired) &#123;<br>            log.error(<span class="hljs-string">&quot;your access is blocked, key=&#123;&#125;&quot;</span>, key);<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;Your access is blocked&quot;</span>);<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.imooc.springcloud;<br><br><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Created by åŠä»™.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Controller</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> AccessLimiter accessLimiter;<br><br>    <span class="hljs-meta">@GetMapping(&quot;test&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>        accessLimiter.limitAccess(<span class="hljs-string">&quot;ratelimiter-test&quot;</span>, <span class="hljs-number">3</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// æé†’ï¼ æ³¨æ„é…ç½®æ‰«åŒ…è·¯å¾„ï¼ˆcom.imooc.springcloudè·¯å¾„ä¸åŒï¼‰</span><br>    <span class="hljs-meta">@GetMapping(&quot;test-annotation&quot;)</span><br>    <span class="hljs-meta">@com</span>.imooc.springcloud.annotation.AccessLimiter(limit = <span class="hljs-number">1</span>)<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">testAnnotation</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Prometheus</title>
    <link href="/Prometheus/"/>
    <url>/Prometheus/</url>
    
    <content type="html"><![CDATA[<h1 id="é€šè¿‡-Prometheus-å’Œ-Grafana-ç›‘æ§-Spring-Cloud-æœåŠ¡"><a href="#é€šè¿‡-Prometheus-å’Œ-Grafana-ç›‘æ§-Spring-Cloud-æœåŠ¡" class="headerlink" title="é€šè¿‡ Prometheus å’Œ Grafana ç›‘æ§ Spring Cloud æœåŠ¡"></a>é€šè¿‡ Prometheus å’Œ Grafana ç›‘æ§ Spring Cloud æœåŠ¡</h1><p>å®ç°çš„æ•ˆæœï¼šå½“em-gatewayæœåŠ¡å®•æœºå, é£ä¹¦é€šçŸ¥åˆ°ç¾¤é‡Œã€‚</p><ul><li>prometheusï¼ˆ&#x2F;proËˆmiÎ¸ÉªÉ™s&#x2F;ï¼‰: Prometheus è´Ÿè´£ä»å„ä¸ªç›®æ ‡æœåŠ¡ä¸­æ”¶é›†ç›‘æ§æ•°æ®ã€‚</li><li>grafana: å¼€æºçš„å¯è§†åŒ–ç³»ç»Ÿ,å¯å®ç°Prometheusã€Elasticsearchã€Postgresã€InfluxDBç­‰æ•°æ®æºçš„å¯è§†åŒ–ï¼Œgrafana é€šè¿‡è¿æ¥ Prometheus æ•°æ®æºï¼Œåˆ©ç”¨å…¶ä¸°å¯Œçš„å¯è§†åŒ–é€‰é¡¹åˆ›å»ºç›´è§‚çš„ç›‘æ§ä»ªè¡¨æ¿ã€‚</li><li>prometheusalert: prometheusalertæ˜¯ä¸€ä¸ªå¼€æºçš„å‘Šè­¦é€šçŸ¥å·¥å…·ï¼Œæ—¨åœ¨ç®€åŒ– Prometheus å‘Šè­¦çš„é€šçŸ¥æµç¨‹ï¼Œå¹¶æ”¯æŒå¤šç§é€šçŸ¥æ¸ é“ã€‚å®ƒå¯ä»¥å¸®åŠ©ç”¨æˆ·å°† Prometheus çš„å‘Šè­¦ä¿¡æ¯å‘é€åˆ°å„ç§å¸¸ç”¨çš„æ¶ˆæ¯å¹³å°å’Œé€šçŸ¥ç³»ç»Ÿï¼Œå¦‚å¾®ä¿¡ã€é’‰é’‰ã€é£ä¹¦ã€Slackã€<strong>é‚®ä»¶ç­‰</strong></li></ul><h1 id="1-å‡†å¤‡å·¥ä½œï¼š"><a href="#1-å‡†å¤‡å·¥ä½œï¼š" class="headerlink" title="1. å‡†å¤‡å·¥ä½œï¼š"></a>1. å‡†å¤‡å·¥ä½œï¼š</h1><p>éœ€è¦ç›‘æ§çš„é¡¹ç›®ï¼Œéƒ½éœ€è¦é›†æˆactuatorï¼Œ å¯ä»¥ä½¿Prometheusé€šè¿‡httpè¯·æ±‚æ”¶é›†æ•°æ®ã€‚<a href="https://pyr9.github.io/Actuator/">å‚è€ƒåšå®¢</a></p><h1 id="2-docker-compose-å®‰è£…"><a href="#2-docker-compose-å®‰è£…" class="headerlink" title="2. docker-compose å®‰è£…"></a>2. docker-compose å®‰è£…</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">prometheus:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">prom/prometheus:v2.53.0</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">prometheus</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./config/prometheus.yml:/etc/prometheus/prometheus.yml</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./prometheus-data:/prometheu</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;9090:9090&quot;</span><br><br>  <span class="hljs-attr">grafana:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">grafana/grafana:11.4.2</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">grafana</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">GF_SECURITY_ADMIN_PASSWORD=admin</span>  <span class="hljs-comment"># è®¾ç½®Grafanaç®¡ç†å‘˜å¯†ç </span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3000:3000&quot;</span><br>    <span class="hljs-attr">depends_on:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">prometheus</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./grafana-storage:/var/lib/grafana</span><br><br>  <span class="hljs-attr">prometheusalert:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/feiyu563/prometheus-alert:v4.9.1</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">prometheusalert</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;8089:8080&quot;</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PA_LOGIN_USER=prometheusalert</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PA_LOGIN_PASSWORD=prometheusalert</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PA_TITLE=PrometheusAlert</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PA_OPEN_FEISHU=1</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PA_OPEN_DINGDING=1</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">PA_OPEN_WEIXIN=1</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./prometheus-alert/db:/app/db</span><br>    <span class="hljs-attr">command:</span> [<span class="hljs-string">&quot;-c&quot;</span>, <span class="hljs-string">&quot;/app/prometheusalert.yml&quot;</span>]<br><br></code></pre></td></tr></table></figure><h1 id="3-é…ç½®-Prometheus"><a href="#3-é…ç½®-Prometheus" class="headerlink" title="3. é…ç½® Prometheus"></a>3. é…ç½® Prometheus</h1><h2 id="1-ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#1-ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="1. ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>1. ä¿®æ”¹é…ç½®æ–‡ä»¶</h2><p>è¿™é‡Œä½¿ç”¨åˆ°äº†<code>host.docker.internal</code>ï¼Œ å› ä¸ºæˆ‘çš„JavaæœåŠ¡æ˜¯è¿è¡Œåœ¨å®¿ä¸»æœºçš„ï¼Œè€Œprometheusæ˜¯è¿è¡Œåœ¨å®¹å™¨é‡Œçš„ï¼Œä½¿ç”¨<code>host.docker.internal</code>æ¥è®¿é—®å®¿ä¸»æœº</p><p>prometheus.yml </p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">global:</span><br>  <span class="hljs-attr">scrape_interval:</span> <span class="hljs-string">15s</span> <span class="hljs-comment"># é»˜è®¤æŠ“å–é—´éš”</span><br><br><span class="hljs-attr">scrape_configs:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">&#x27;em-gateway&#x27;</span><br>    <span class="hljs-attr">metrics_path:</span> <span class="hljs-string">&#x27;/actuator/prometheus&#x27;</span><br>    <span class="hljs-attr">static_configs:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> <br>        <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;host.docker.internal:9998&#x27;</span>  <span class="hljs-comment"># æ›¿æ¢ä¸ºä½ çš„Spring CloudæœåŠ¡åœ°å€</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">&#x27;sith-mes&#x27;</span><br>    <span class="hljs-attr">metrics_path:</span> <span class="hljs-string">&#x27;/sith-mes/actuator/prometheus&#x27;</span><br>    <span class="hljs-attr">static_configs:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> <br>        <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;host.docker.internal:6500&#x27;</span>  <span class="hljs-comment"># æ›¿æ¢ä¸ºä½ çš„Spring CloudæœåŠ¡åœ°å€ </span><br></code></pre></td></tr></table></figure><h2 id="2-é…ç½®-Spring-Cloud-åº”ç”¨"><a href="#2-é…ç½®-Spring-Cloud-åº”ç”¨" class="headerlink" title="2.  é…ç½® Spring Cloud åº”ç”¨"></a>2.  é…ç½® Spring Cloud åº”ç”¨</h2><ol><li><p>å¼•å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.micrometer<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>micrometer-registry-prometheus<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹é…ç½®</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-comment">## å¼€å¯æ‰€æœ‰actuator-endpoint</span><br><span class="hljs-attr">management:</span><br>  <span class="hljs-attr">endpoint:</span><br>    <span class="hljs-attr">health:</span><br>      <span class="hljs-attr">show-details:</span> <span class="hljs-string">always</span><br>  <span class="hljs-attr">endpoints:</span><br>    <span class="hljs-attr">web:</span><br>      <span class="hljs-attr">exposure:</span><br>        <span class="hljs-attr">include:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;*&#x27;</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;prometheus&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>è®¿é—®é¡¹ç›® <code>/actuator/prometheus</code></p></li></ol><p><img src="C:\Users\z004nnre\AppData\Roaming\Typora\typora-user-images\image-20250313131253269.png" alt="image-20250313131253269"></p><ol start="4"><li>å†æ¬¡è®¿é—®<code>http://localhost:9090/targets</code>ç¡®ä¿å½“å‰æœåŠ¡æˆåŠŸæ³¨å†Œåˆ°äº†prometheusä¸Š</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313145316614.png" alt="image-20250313145316614"></p><ol start="5"><li>é…ç½®å±æ€§åœ¨prometheusç®€å•æŸ¥çœ‹</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313145416414.png" alt="image-20250313145416414"></p><h1 id="4-é…ç½®-Grafana"><a href="#4-é…ç½®-Grafana" class="headerlink" title="4. é…ç½® Grafana"></a>4. é…ç½® Grafana</h1><p>è®¿é—® Grafana æ‰“å¼€æµè§ˆå™¨è®¿é—® <a href="http://localhost:3000ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç æ˜¯">http://localhost:3000ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç æ˜¯</a> admin&#x2F;admin</p><h2 id="1-é…ç½®Prometheusä½œä¸ºdatasource"><a href="#1-é…ç½®Prometheusä½œä¸ºdatasource" class="headerlink" title="1. é…ç½®Prometheusä½œä¸ºdatasource"></a>1. é…ç½®Prometheusä½œä¸ºdatasource</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313131723923.png" alt="image-20250313131723923"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313134156998.png" alt="image-20250313134156998"></p><h2 id="2-æµ‹è¯•å±•ç¤ºç³»ç»Ÿçš„CPUä½¿ç”¨æƒ…å†µ"><a href="#2-æµ‹è¯•å±•ç¤ºç³»ç»Ÿçš„CPUä½¿ç”¨æƒ…å†µ" class="headerlink" title="2. æµ‹è¯•å±•ç¤ºç³»ç»Ÿçš„CPUä½¿ç”¨æƒ…å†µ"></a>2. æµ‹è¯•å±•ç¤ºç³»ç»Ÿçš„CPUä½¿ç”¨æƒ…å†µ</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313134357862.png" alt="image-20250313134357862"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313141328486.png" alt="image-20250313141328486"></p><h2 id="3-dashboradæ¨¡æ¿"><a href="#3-dashboradæ¨¡æ¿" class="headerlink" title="3. dashboradæ¨¡æ¿"></a>3. dashboradæ¨¡æ¿</h2><p>ç½‘å€ï¼š<a href="https://grafana.com/grafana/dashboards/">Grafana dashboards | Grafana Labs</a></p><ol><li>dashboard å¸‚åœºæœ‰å¾ˆå¤šç°æˆçš„dashboradï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚ï¼š</li></ol><ul><li><p>Actuator: <a href="https://grafana.com/grafana/dashboards/12856">https://grafana.com/grafana/dashboards/12856</a></p></li><li><p>jmx_exporter: <a href="https://grafana.com/grafana/dashboards/3457">https://grafana.com/grafana/dashboards/3457</a></p></li><li><p>node_exporter: <a href="https://grafana.com/grafana/dashboards/8919">https://grafana.com/grafana/dashboards/8919</a></p></li><li><p>mysqld_exporter:</p><ul><li><a href="https://grafana.com/grafana/dashboards/13106">https://grafana.com/grafana/dashboards/13106</a></li><li><a href="https://grafana.com/grafana/dashboards/11323">https://grafana.com/grafana/dashboards/11323</a></li></ul></li><li><p>redis_exporter: <a href="https://grafana.com/grafana/dashboards/11835">https://grafana.com/grafana/dashboards/11835</a></p></li><li><p>k8s: <a href="https://grafana.com/grafana/dashboards/13105">https://grafana.com/grafana/dashboards/13105</a></p></li></ul><ol start="2"><li>å…·ä½“ä½¿ç”¨æ­¥éª¤<ol><li>å…³é”®è¯æœç´¢</li></ol></li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313141833859.png" alt="image-20250313141833859"></p><ol start="2"><li>å¤åˆ¶æ¨¡æ¿ID</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313141924350.png" alt="image-20250313141924350"></p><ol start="3"><li>å¡«å…¥IDå¯¼å…¥</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313142044330.png" alt="image-20250313142044330"></p><h2 id="4-å¼•å…¥Prometheusalert"><a href="#4-å¼•å…¥Prometheusalert" class="headerlink" title="4. å¼•å…¥Prometheusalert"></a>4. å¼•å…¥Prometheusalert</h2><p>å› ä¸ºgrafanaçš„githubçš„issueä¸Šå†™äº†ä»–ä»¬çŸ­æœŸä¸æ”¯æŒé£ä¹¦ï¼Œæˆ‘ä¹Ÿå°è¯•é…ç½®webhookï¼Œé£ä¹¦é€šçŸ¥å¤±è´¥ï¼Œæ‰€ä»¥è¿™é‡Œå¼•å…¥äº†prometheusalertæ¥åšé£ä¹¦é€šçŸ¥ã€‚</p><ol><li>åœ¨æ¨¡æ¿ç®¡ç†é‡Œï¼Œæ‰¾åˆ°è‡ªå·±éœ€è¦çš„æ¨¡æ¿ï¼Œå¤åˆ¶URLï¼Œ åç»­ä½œä¸ºwebhookåœ°å€ï¼Œä¾›grafanaä½¿ç”¨ã€‚è¿™æ˜¯æˆ‘ä¸‹é¢ç¤ºä¾‹ä½¿ç”¨çš„<a href="http://host.docker.internal:8089/prometheusalert?type=fs&tpl=grafana-fs&fsurl=https://open.feishu.cn/open-apis/bot/v2/hook/ae1eaeaa-fab0-4815-bc7f-f96110281df4">URL</a></li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250319112015718.png" alt="image-20250319112015718"></p><h2 id="4-é…ç½®grafanaå‘Šè­¦"><a href="#4-é…ç½®grafanaå‘Šè­¦" class="headerlink" title="4. é…ç½®grafanaå‘Šè­¦"></a>4. é…ç½®grafanaå‘Šè­¦</h2><ol><li>ä¿®æ”¹ prometheusalert.yml (ä¸ç¡®å®šæ˜¯å¦çœŸçš„éœ€è¦ï¼Œå¯ä»¥å…ˆä¸é…è¯•è¯•)</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">feishu:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">&quot;feishu&quot;</span><br>    <span class="hljs-attr">webhook:</span> <span class="hljs-string">&quot;https://open.feishu.cn/open-apis/bot/v2/hook/ae1eaeaa-fab0-4815-bc7f-f96110281df4&quot;</span><br></code></pre></td></tr></table></figure><ol><li>å¢åŠ  Contact pointsï¼Œé…ç½®çº¢æ¡†ä¸­çš„å±æ€§</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250319110857781.png" alt="image-20250319110857781"></p><ol start="2"><li>åˆ›å»ºçœ‹æ¿ï¼Œå±•ç¤ºem-gatewayçš„è¿è¡Œæƒ…å†µ</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250319112616203.png" alt="image-20250319112616203"></p><ol start="3"><li>é…ç½®Alert</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250319112727528.png" alt="image-20250319112727528"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250319112757644.png" alt="image-20250319112757644"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250319112829866.png" alt="image-20250319112829866"></p><p>åœæ­¢æœåŠ¡ï¼ŒæŸ¥çœ‹é£ä¹¦é€šçŸ¥;</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250319113318248.png" alt="image-20250319113318248"></p>]]></content>
    
    
    <categories>
      
      <category>ç›‘æ§</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Actuator</title>
    <link href="/Actuator/"/>
    <url>/Actuator/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Actuator-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-Actuator-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. Actuator æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. Actuator æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>Spring Boot Actuator æ¨¡å—æä¾›äº†ç”Ÿäº§çº§åˆ«çš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¥åº·æ£€æŸ¥ï¼Œå®¡è®¡ï¼ŒæŒ‡æ ‡æ”¶é›†ï¼ŒHTTP è·Ÿè¸ªç­‰ï¼Œå¸®åŠ©æˆ‘ä»¬ç›‘æ§å’Œç®¡ç†Spring Boot åº”ç”¨ï¼Œä¸Šè¿°çš„åŠŸèƒ½éƒ½å¯ä»¥é€šè¿‡HTTP å’Œ JMX è®¿é—®ã€‚</p><p>Actuator ä¹Ÿå¯ä»¥å’Œä¸€äº›å¤–éƒ¨çš„åº”ç”¨ç›‘æ§ç³»ç»Ÿæ•´åˆï¼ˆPrometheusç­‰ï¼‰</p><h1 id="2-é›†æˆSpringboot"><a href="#2-é›†æˆSpringboot" class="headerlink" title="2. é›†æˆSpringboot"></a>2. é›†æˆSpringboot</h1><ol><li><p>å¼•å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹é…ç½®ï¼ˆæŒ‰éœ€ï¼‰</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-comment">#å¼€å¯actuatorå…¨é¢ç›‘æ§</span><br><span class="hljs-attr">management:</span><br>  <span class="hljs-attr">endpoint:</span><br>    <span class="hljs-attr">health:</span><br>      <span class="hljs-attr">show-details:</span> <span class="hljs-string">always</span><br></code></pre></td></tr></table></figure></li><li><p>è®¿é—®å¯¹åº”æœåŠ¡çš„ <code>/actuator/</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313110530621.png" alt="image-20250313110530621"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313110607444.png" alt="image-20250313110607444"></p></li></ol>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è·¨åº”ç”¨çš„é“¾è·¯è¿½è¸ª</title>
    <link href="/%E8%B7%A8%E5%BA%94%E7%94%A8%E7%9A%84%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/"/>
    <url>/%E8%B7%A8%E5%BA%94%E7%94%A8%E7%9A%84%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä¸ºä»€ä¹ˆéœ€è¦é“¾è·¯è¿½è¸ª"><a href="#1-ä¸ºä»€ä¹ˆéœ€è¦é“¾è·¯è¿½è¸ª" class="headerlink" title="1. ä¸ºä»€ä¹ˆéœ€è¦é“¾è·¯è¿½è¸ª"></a>1. ä¸ºä»€ä¹ˆéœ€è¦é“¾è·¯è¿½è¸ª</h1><ol><li><p><strong>ç†è§£å¤æ‚çš„è°ƒç”¨é“¾è·¯</strong>ã€‚åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸€ä¸ªç”¨æˆ·è¯·æ±‚é€šå¸¸ä¼šè·¨è¶Šå¤šä¸ªæœåŠ¡ã€æ•°æ®åº“ã€ç¼“å­˜ç­‰ç»„ä»¶ã€‚é“¾è·¯è¿½è¸ªå¯ä»¥å¸®åŠ©ä½ æ¸…æ™°åœ°çœ‹åˆ°æ¯ä¸ªè¯·æ±‚åœ¨æ•´ä¸ªç³»ç»Ÿä¸­çš„å®Œæ•´è·¯å¾„ï¼ŒåŒ…æ‹¬ç»è¿‡çš„æ‰€æœ‰æœåŠ¡åŠå…¶ä¾èµ–å…³ç³»ã€‚</p></li><li><p><strong>å¿«é€Ÿå®šä½æ€§èƒ½ç“¶é¢ˆ</strong>ã€‚é€šè¿‡é“¾è·¯è¿½è¸ªï¼Œä½ å¯ä»¥ç²¾ç¡®åœ°æµ‹é‡æ¯ä¸ªæœåŠ¡çš„å“åº”æ—¶é—´ï¼Œå¹¶è¯†åˆ«å‡ºå“ªäº›æœåŠ¡æˆ–ç»„ä»¶æ˜¯å¯¼è‡´å»¶è¿Ÿçš„ä¸»è¦åŸå› ã€‚è¿™å¯¹äºä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½è‡³å…³é‡è¦ã€‚</p></li><li><p><strong>æ•…éšœæ’æŸ¥ä¸è¯Šæ–­</strong>ã€‚å½“ç³»ç»Ÿå‡ºç°é”™è¯¯æ—¶ï¼Œé“¾è·¯è¿½è¸ªå¯ä»¥æä¾›è¯¦ç»†çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¸®åŠ©ä½ æ›´å¿«åœ°å®šä½é—®é¢˜çš„æ ¹æœ¬åŸå› ã€‚å®ƒå¯ä»¥æ˜¾ç¤ºè¯·æ±‚åœ¨æ¯ä¸ªæœåŠ¡ä¸­çš„æ‰§è¡Œæƒ…å†µï¼Œä»¥åŠæ¯ä¸ªæœåŠ¡è¿”å›çš„çŠ¶æ€ç å’Œé”™è¯¯ä¿¡æ¯ã€‚</p></li><li><p><strong>è·¨æœåŠ¡çš„äº‹åŠ¡ä¸€è‡´æ€§</strong>ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç¡®ä¿è·¨å¤šä¸ªæœåŠ¡çš„äº‹åŠ¡ä¸€è‡´æ€§æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚é“¾è·¯è¿½è¸ªå¯ä»¥å¸®åŠ©ä½ è·Ÿè¸ªå’ŒéªŒè¯è¿™äº›è·¨æœåŠ¡çš„æ“ä½œæ˜¯å¦æŒ‰é¢„æœŸæ‰§è¡Œï¼Œå¹¶ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p></li><li><p><strong>æé«˜å¼€å‘å’Œè¿ç»´æ•ˆç‡</strong>ã€‚é“¾è·¯è¿½è¸ªæä¾›äº†ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä½¿å¾—å¼€å‘äººå‘˜å’Œè¿ç»´äººå‘˜èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°åä½œã€‚å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡è¿½è¸ªä¿¡æ¯å¿«é€Ÿæ‰¾åˆ°ä»£ç ä¸­çš„é—®é¢˜ï¼Œè€Œè¿ç»´äººå‘˜åˆ™å¯ä»¥åˆ©ç”¨è¿™äº›ä¿¡æ¯è¿›è¡Œç³»ç»Ÿç»´æŠ¤å’Œä¼˜åŒ–ã€‚</p></li></ol><h1 id="2-Sleuth"><a href="#2-Sleuth" class="headerlink" title="2. Sleuth"></a>2. Sleuth</h1><h2 id="1-sleuthæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-sleuthæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. sleuthæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. sleuthæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>Spring Cloud Sleuth æ˜¯ä¸€ä¸ªç”¨äºåˆ†å¸ƒå¼è¿½è¸ªçš„åº“ï¼Œä¸»è¦ç”¨äºç®€åŒ–åœ¨å¾®æœåŠ¡æ¶æ„ä¸­å®ç°é“¾è·¯è¿½è¸ªï¼ˆDistributed Tracingï¼‰ã€‚å®ƒå¸®åŠ©å¼€å‘è€…åœ¨å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è·Ÿè¸ªè¯·æ±‚çš„å®Œæ•´è·¯å¾„ï¼Œä»è€Œæ›´å®¹æ˜“åœ°è¿›è¡Œæ€§èƒ½ç›‘æ§ã€æ•…éšœæ’æŸ¥å’Œé—®é¢˜è¯Šæ–­ã€‚</p><h2 id="2-ä¸»è¦åŠŸèƒ½"><a href="#2-ä¸»è¦åŠŸèƒ½" class="headerlink" title="2. ä¸»è¦åŠŸèƒ½"></a>2. ä¸»è¦åŠŸèƒ½</h2><ul><li>é“¾è·¯è¿½è¸ªï¼ˆDistributed Tracingï¼‰ï¼š<br>ä¸ºæ¯ä¸ªè¯·æ±‚ç”Ÿæˆå”¯ä¸€çš„è¿½è¸ªIDï¼ˆTrace IDï¼‰ï¼Œå¹¶ä¸ºæ¯ä¸ªæœåŠ¡è°ƒç”¨ç”Ÿæˆå”¯ä¸€çš„è·¨åº¦IDï¼ˆSpan IDï¼‰ã€‚<br>è¿™äº›IDä¼šéšç€è¯·æ±‚åœ¨ä¸åŒæœåŠ¡ä¹‹é—´çš„ä¼ é€’è€Œä¿æŒä¸€è‡´ï¼Œä½¿å¾—ä½ å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°æ•´ä¸ªè¯·æ±‚çš„è°ƒç”¨é“¾è·¯ã€‚</li><li>æ—¥å¿—å…³è”ï¼ˆLog Correlationï¼‰ï¼š<br>å°†è¿½è¸ªIDå’Œè·¨åº¦IDè‡ªåŠ¨æ·»åŠ åˆ°æ—¥å¿—è®°å½•ä¸­ï¼Œç¡®ä¿æ‰€æœ‰ç›¸å…³çš„æ—¥å¿—æ¡ç›®éƒ½å¯ä»¥é€šè¿‡è¿™äº›IDè¿›è¡Œå…³è”ã€‚<br>è¿™æœ‰åŠ©äºåœ¨æ—¥å¿—ä¸­å¿«é€Ÿå®šä½å’Œåˆ†æç‰¹å®šè¯·æ±‚çš„æ‰€æœ‰ç›¸å…³æ—¥å¿—ä¿¡æ¯ã€‚</li><li>é›†æˆç¬¬ä¸‰æ–¹è¿½è¸ªç³»ç»Ÿï¼š<br>æ”¯æŒä¸å¤šç§åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿé›†æˆï¼Œå¦‚Zipkinã€Jaegerç­‰ï¼Œå°†è¿½è¸ªæ•°æ®å‘é€åˆ°è¿™äº›ç³»ç»Ÿè¿›è¡Œå¯è§†åŒ–å’Œè¿›ä¸€æ­¥åˆ†æã€‚</li><li>é‡‡æ ·ç‡æ§åˆ¶ï¼š<br>æä¾›é‡‡æ ·æœºåˆ¶ï¼Œå…è®¸ä½ æ§åˆ¶å“ªäº›è¯·æ±‚éœ€è¦è¢«è¿½è¸ªï¼Œä»¥é¿å…ç”Ÿæˆè¿‡å¤šçš„æ•°æ®å½±å“ç³»ç»Ÿæ€§èƒ½ã€‚</li></ul><h2 id="2-è°ƒç”¨é“¾è·¯æ¨¡å‹"><a href="#2-è°ƒç”¨é“¾è·¯æ¨¡å‹" class="headerlink" title="2.  è°ƒç”¨é“¾è·¯æ¨¡å‹"></a>2.  è°ƒç”¨é“¾è·¯æ¨¡å‹</h2><p>Spring Cloud Sleuth ä¸»è¦é€šè¿‡è‡ªåŠ¨æ³¨å…¥çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå¦‚ TraceContextï¼‰å’Œ AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰æ¥å®ç°é“¾è·¯è¿½è¸ªã€‚</p><h2 id="2-é›†æˆSpringbooté¡¹ç›®"><a href="#2-é›†æˆSpringbooté¡¹ç›®" class="headerlink" title="2. é›†æˆSpringbooté¡¹ç›®"></a>2. é›†æˆSpringbooté¡¹ç›®</h2><ol><li><p>å¼•å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-sleuth<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ (æŒ‰éœ€ï¼Œéå¿…è¦)</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">sleuth:</span><br>    <span class="hljs-attr">sampler:</span><br>      <span class="hljs-attr">probability:</span> <span class="hljs-number">1.0</span> <span class="hljs-comment"># è®¾ç½®é‡‡æ ·ç‡ï¼ŒæŒ‰éœ€</span><br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹æ—¥å¿—æ¨¡æ¿, ï¼Œæˆ‘è¿™é‡Œæ˜¯log4j2.xml</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;Console name=<span class="hljs-string">&quot;consoleAppender&quot;</span> target=<span class="hljs-string">&quot;SYSTEM_OUT&quot;</span>&gt;<br>    &lt;PatternLayout pattern=<span class="hljs-string">&quot;xxx[%style&#123;%X&#123;X-B3-TraceId&#125;&#125;&#123;green&#125;,%style&#123;%X&#123;X-B3-SpanId&#125;&#125;&#123;yellow&#125;,%X&#123;X-B3-ParentSpanId&#125;] xxx&quot;</span>/&gt;<br>&lt;/Console&gt;<br></code></pre></td></tr></table></figure></li><li><p>é‡å¯é¡¹ç›®ï¼Œè§‚å¯Ÿæ‰“å°æ—¥å¿—</p></li></ol><p>æ•ˆæœï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313094420295.png" alt="image-20250313094420295"></p><h1 id="3-Sleuthä¸Zipkiné›†æˆ"><a href="#3-Sleuthä¸Zipkiné›†æˆ" class="headerlink" title="3. Sleuthä¸Zipkiné›†æˆ"></a>3. Sleuthä¸Zipkiné›†æˆ</h1><h2 id="1-ZIpKinæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-ZIpKinæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. ZIpKinæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. ZIpKinæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>Zipkin æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿï¼Œç”± Twitter å¼€å‘å¹¶å¼€æºã€‚å®ƒä¸»è¦ç”¨äºæ”¶é›†å’Œå±•ç¤ºå¾®æœåŠ¡æ¶æ„ä¸­çš„é“¾è·¯è¿½è¸ªæ•°æ®ï¼Œå¸®åŠ©å¼€å‘è€…å’Œè¿ç»´äººå‘˜æ›´å¥½åœ°ç†è§£ã€ç›‘æ§å’Œè¯Šæ–­å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p><h2 id="2-ä¸»è¦åŠŸèƒ½-1"><a href="#2-ä¸»è¦åŠŸèƒ½-1" class="headerlink" title="2. ä¸»è¦åŠŸèƒ½"></a>2. ä¸»è¦åŠŸèƒ½</h2><ul><li>åˆ†å¸ƒå¼è¿½è¸ªï¼š<br>Zipkin æ”¯æŒåˆ†å¸ƒå¼è¿½è¸ªï¼Œèƒ½å¤Ÿè·Ÿè¸ªä¸€ä¸ªè¯·æ±‚åœ¨å¤šä¸ªæœåŠ¡ä¹‹é—´çš„ä¼ é€’è¿‡ç¨‹ï¼Œå¹¶ç”Ÿæˆè¯¦ç»†çš„è°ƒç”¨é“¾è·¯å›¾ã€‚</li><li>å¯è§†åŒ–ç•Œé¢ï¼š<br>æä¾›äº†ä¸€ä¸ªç›´è§‚çš„ Web UIï¼Œç”¨äºæŸ¥çœ‹å’Œåˆ†æè¿½è¸ªæ•°æ®ï¼ŒåŒ…æ‹¬æ¯ä¸ªè¯·æ±‚çš„è¯¦ç»†è·¯å¾„ã€å»¶è¿Ÿæ—¶é—´ã€é”™è¯¯ä¿¡æ¯ç­‰</li><li>å¤šç§æ•°æ®ä¼ è¾“æ–¹å¼ï¼š<br>æ”¯æŒé€šè¿‡ HTTPã€Kafkaã€RabbitMQ ç­‰å¤šç§æ–¹å¼è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œçµæ´»é€‚åº”ä¸åŒçš„åº”ç”¨åœºæ™¯ã€‚</li><li>é›†æˆå¤šç§è¯­è¨€å’Œæ¡†æ¶ï¼š<br>æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ Javaã€Pythonã€Goã€Node.js ç­‰ï¼‰å’Œæ¡†æ¶ï¼ˆå¦‚ Spring Cloud Sleuthã€Finagle ç­‰ï¼‰ï¼Œæ–¹ä¾¿åœ¨ä¸åŒæŠ€æœ¯æ ˆä¸­ä½¿ç”¨ã€‚</li><li>é‡‡æ ·æœºåˆ¶ï¼š<br>ä¸ºäº†å‡å°‘æ€§èƒ½å¼€é”€ï¼ŒZipkin æä¾›äº†é‡‡æ ·æœºåˆ¶ï¼Œå…è®¸ä½ æ§åˆ¶å“ªäº›è¯·æ±‚éœ€è¦è¢«è¿½è¸ªã€‚</li><li>å­˜å‚¨æ”¯æŒï¼š<br>æ”¯æŒå¤šç§å­˜å‚¨åç«¯ï¼Œå¦‚å†…å­˜ã€Elasticsearchã€Cassandra ç­‰ï¼Œä¾¿äºé•¿æœŸä¿å­˜å’ŒæŸ¥è¯¢è¿½è¸ªæ•°æ®ã€‚</li></ul><h2 id="2-é›†æˆSpringbooté¡¹ç›®-1"><a href="#2-é›†æˆSpringbooté¡¹ç›®-1" class="headerlink" title="2. é›†æˆSpringbooté¡¹ç›®"></a>2. é›†æˆSpringbooté¡¹ç›®</h2><ol><li><p>docker-composeå®‰è£…zipkin</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">zipkin:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">openzipkin/zipkin:latest</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">zipkin</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;9411:9411&quot;</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">JAVA_OPTS=-Xms1g</span> <span class="hljs-string">-Xmx1g</span>  <span class="hljs-comment"># æ ¹æ®éœ€è¦è°ƒæ•´å†…å­˜è®¾ç½®</span><br></code></pre></td></tr></table></figure></li><li><p>å¼•å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-zipkin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">zipkin:</span><br>    <span class="hljs-comment"># è¿æ¥ zipkin æœåŠ¡ç«¯çš„åœ°å€ï¼Œæ¥å£è¢«è°ƒç”¨åï¼Œè°ƒç”¨ç›¸å…³ä¿¡æ¯é€šè¿‡è¿™ä¸ª url å‘é€åˆ° zipkin æœåŠ¡ç«¯</span><br>    <span class="hljs-attr">base-url:</span> <span class="hljs-string">http://localhost:9411</span><br></code></pre></td></tr></table></figure></li><li><p>è®¿é—®<a href="http://localhost:9411ï¼Œ">http://localhost:9411ï¼Œ</a> è¾“å…¥traceId æŸ¥çœ‹æ•ˆæœ</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250313213613439.png" alt="image-20250313213613439"></p></li></ol><p><strong>TIPS:</strong> </p><ul><li>å¦‚æœä¸æƒ³ä½¿ç”¨httpé•¿è¿æ¥ï¼Œå¯ä»¥æ”¹æˆä½¿ç”¨rabbitMQæ”¶é›†æ•°æ®</li><li>zipkiné»˜è®¤å­˜å‚¨åœ¨å†…å­˜ï¼Œå³æœåŠ¡é‡å¯ä¼šæ•°æ®ä¸¢å¤±ï¼Œå¯ä»¥è€ƒè™‘ç”¨ESç­‰åšæ•°æ®æŒä¹…åŒ–</li><li>zipkinåªç”¨äºè½»é‡çº§çš„é“¾è·¯è¿½è¸ªï¼Œå¦‚æœéœ€è¦æ›´å…¨é¢çš„ç›‘æ§æœåŠ¡ã€æ•°æ®åº“ã€redisç­‰ä¸­é—´ä»¶ï¼Œå¯ä»¥è€ƒè™‘skywalking</li></ul><h1 id="4-é›†æˆELKå®ç°æ—¥å¿—æ£€ç´¢"><a href="#4-é›†æˆELKå®ç°æ—¥å¿—æ£€ç´¢" class="headerlink" title="4. é›†æˆELKå®ç°æ—¥å¿—æ£€ç´¢"></a>4. é›†æˆELKå®ç°æ—¥å¿—æ£€ç´¢</h1><p><a href="https://pyr9.github.io/docker%E6%90%AD%E5%BB%BAELK/">dockeræ­å»ºELK</a></p><h1 id="5-æ›´å¼ºå¤§çš„é“¾è·¯è¿½è¸ªå·¥å…·â€”skywalking"><a href="#5-æ›´å¼ºå¤§çš„é“¾è·¯è¿½è¸ªå·¥å…·â€”skywalking" class="headerlink" title="5. æ›´å¼ºå¤§çš„é“¾è·¯è¿½è¸ªå·¥å…·â€”skywalking"></a>5. æ›´å¼ºå¤§çš„é“¾è·¯è¿½è¸ªå·¥å…·â€”skywalking</h1><p><a href="https://pyr9.github.io/Skywalking%E7%9B%91%E6%8E%A7/">skywalking</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Skywalkingç›‘æ§å·¥å…·</title>
    <link href="/Skywalking%E7%9B%91%E6%8E%A7/"/>
    <url>/Skywalking%E7%9B%91%E6%8E%A7/</url>
    
    <content type="html"><![CDATA[<h1 id="1-SkyWalking"><a href="#1-SkyWalking" class="headerlink" title="1. SkyWalking"></a>1. SkyWalking</h1><h2 id="1-å®šä¹‰ï¼š"><a href="#1-å®šä¹‰ï¼š" class="headerlink" title="1. å®šä¹‰ï¼š"></a>1. å®šä¹‰ï¼š</h2><p>SkyWalkingæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼è¿½è¸ªã€åº”ç”¨æ€§èƒ½ç›‘æ§ï¼ˆAPMï¼‰å’Œå¯è§‚æµ‹æ€§åˆ†æå¹³å°ã€‚ å®ƒä¸»è¦åŠŸèƒ½æœ‰ï¼šåˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªã€åº”ç”¨æ€§èƒ½ç›‘æ§ã€æ•°æ®åº“ç›‘æ§ã€æœåŠ¡ä¾èµ–åˆ†æã€å‘Šè­¦ç­‰ã€‚</p><h2 id="2-ä¸»è¦åŠŸèƒ½"><a href="#2-ä¸»è¦åŠŸèƒ½" class="headerlink" title="2. ä¸»è¦åŠŸèƒ½"></a>2. ä¸»è¦åŠŸèƒ½</h2><ol><li><p><strong>åˆ†å¸ƒå¼è¿½è¸ª</strong>ï¼š</p><ul><li><p>è¿½è¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è¯·æ±‚æµç¨‹ï¼Œè®°å½•æ¯ä¸ªè¯·æ±‚ç»è¿‡çš„æœåŠ¡å’Œç»„ä»¶ï¼Œä»¥åŠè¯·æ±‚åœ¨å„ä¸ªç»„ä»¶ä¸­çš„è€—æ—¶æƒ…å†µã€‚</p></li><li><p>é€šè¿‡åˆ†æè¿½è¸ªæ•°æ®ï¼Œå¸®åŠ©å¼€å‘è€…å’Œè¿ç»´äººå‘˜äº†è§£ç³»ç»Ÿä¸­å„ä¸ªç»„ä»¶ä¹‹é—´çš„è°ƒç”¨å…³ç³»å’Œæ€§èƒ½ç“¶é¢ˆï¼Œå¿«é€Ÿå®šä½å’Œè§£å†³é—®é¢˜ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/img_v3_02ka_9ddee659-f618-4d72-b0f4-a1a6a8841d3g.jpg" alt="img_v3_02ka_9ddee659-f618-4d72-b0f4-a1a6a8841d3g"></p></li></ul><blockquote><p>å¦‚ä¸Šï¼šå¯ä»¥æ ¹æ®traceIDæŸ¥è¯¢åˆ°è¿™ä¸ªè¯·æ±‚çš„è°ƒç”¨é“¾è·¯</p></blockquote></li><li><p><strong>åº”ç”¨æ€§èƒ½ç›‘æ§</strong>ï¼š</p><ul><li><p>å®æ—¶ç›‘æ§æœåŠ¡çš„å„é¡¹æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚å“åº”æ—¶é—´ã€ååé‡ï¼ˆQPSï¼‰ã€é”™è¯¯ç‡ç­‰ã€‚</p></li><li><p>æä¾›ä¸°å¯Œçš„æ•°æ®å¯è§†åŒ–åŠŸèƒ½ï¼Œå°†ç›‘æ§æ•°æ®ä»¥å›¾è¡¨çš„å½¢å¼å±•ç¤ºï¼Œå¸®åŠ©ç”¨æˆ·æ›´ç›´è§‚åœ°äº†è§£ç³»ç»Ÿçš„æ€§èƒ½å’Œè¿è¡Œæƒ…å†µã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/img_v3_02ka_699da6ea-8415-4ff6-beeb-11e40b89018g.jpg" alt="img_v3_02ka_699da6ea-8415-4ff6-beeb-11e40b89018g"></p></li></ul></li><li><p><strong>æ•°æ®åº“æ€§èƒ½ç›‘æ§</strong>ï¼š</p><ul><li><p>ç›‘æ§æ•°æ®åº“å“åº”æ—¶é—´ã€è®¿é—®æˆåŠŸç‡ç­‰</p></li><li><p>ç›‘æ§æ•°æ®åº“æ…¢æŸ¥è¯¢åŠè€—æ—¶æ—¶é—´</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/img_v3_02ka_e2a3bce4-7b37-493d-89b6-ea865350a09g.jpg" alt="img_v3_02ka_e2a3bce4-7b37-493d-89b6-ea865350a09g"></p></li></ul></li><li><p><strong>æœåŠ¡ä¾èµ–åˆ†æ</strong>ï¼š</p><ul><li><p>åˆ†æç³»ç»Ÿä¸­å„ä¸ªæœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ŒåŒ…æ‹¬è°ƒç”¨å…³ç³»å’Œæ•°æ®æµå‘ã€‚</p></li><li><p>é€šè¿‡å¯è§†åŒ–çš„æ–¹å¼å±•ç¤ºæœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£ç³»ç»Ÿçš„æ¶æ„å’Œæµç¨‹ï¼Œä¼˜åŒ–ç³»ç»Ÿè®¾è®¡ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/img_v3_02ka_308260ef-7a9d-4337-9cf8-0b4d8be004dg.jpg" alt="img_v3_02ka_308260ef-7a9d-4337-9cf8-0b4d8be004dg"></p></li></ul></li><li><p><strong>å‘Šè­¦å’ŒæŠ¥è­¦</strong>ï¼š</p><ul><li><p>æ”¯æŒåŸºäºæ€§èƒ½æŒ‡æ ‡çš„å‘Šè­¦è®¾ç½®ï¼Œå½“ç³»ç»Ÿå‡ºç°å¼‚å¸¸æˆ–æ€§èƒ½ä¸‹é™æ—¶ï¼ŒåŠæ—¶å‘é€å‘Šè­¦é€šçŸ¥ã€‚</p></li><li><p>æä¾›å¤šç§å‘Šè­¦é€šçŸ¥æ–¹å¼ï¼Œå¦‚é‚®ä»¶ã€çŸ­ä¿¡ã€Webhookç­‰ï¼Œå¸®åŠ©è¿ç»´äººå‘˜å¿«é€Ÿå“åº”å’Œè§£å†³é—®é¢˜ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/img_v3_02ka_fcaae416-148d-4040-89a0-24b7a4b5fb1g.jpg" alt="img_v3_02ka_fcaae416-148d-4040-89a0-24b7a4b5fb1g"></p></li></ul></li></ol><blockquote><p><a href="https://github.com/apache/skywalking/blob/v9.3.0/docs/en/setup/backend/backend-alarm.md">å…·ä½“å‘Šè­¦é…ç½®</a></p></blockquote><h2 id="3-Docker-compose-å®‰è£…"><a href="#3-Docker-compose-å®‰è£…" class="headerlink" title="3. Docker-compose å®‰è£…"></a>3. Docker-compose å®‰è£…</h2><p>æˆ‘è¿™é‡Œæ˜¯æŒä¹…åŒ–åˆ°elasticsearchï¼Œ ä¿®æ”¹äº†æ˜ å°„å‡ºæ¥çš„ç«¯å£ä¸º8088</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">elasticsearch:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">elasticsearch:8.4.3</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">elasticsearch</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">9200</span><span class="hljs-string">:9200</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;TAKE_FILE_OWNERSHIP=true&quot;</span> <span class="hljs-comment">#volumes æŒ‚è½½æƒé™ å¦‚æœä¸æƒ³è¦æŒ‚è½½esæ–‡ä»¶æ”¹é…ç½®å¯ä»¥åˆ é™¤</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;discovery.type=single-node&quot;</span> <span class="hljs-comment">#å•æœºæ¨¡å¼å¯åŠ¨</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;TZ=Asia/Shanghai&quot;</span> <span class="hljs-comment"># è®¾ç½®æ—¶åŒº</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span> <span class="hljs-comment"># è®¾ç½®jvmå†…å­˜å¤§å°</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./elasticsearch/logs:/usr/share/elasticsearch/logs</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./elasticsearch/data:/usr/share/elasticsearch/data</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./elasticsearch/conf:/usr/share/elasticsearch/config</span><br>    <span class="hljs-attr">ulimits:</span><br>      <span class="hljs-attr">memlock:</span><br>        <span class="hljs-attr">soft:</span> <span class="hljs-number">-1</span><br>        <span class="hljs-attr">hard:</span> <span class="hljs-number">-1</span><br>  <span class="hljs-attr">skywalking-oap-server:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">apache/skywalking-oap-server:9.3.0</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">skywalking-oap-server</span><br>    <span class="hljs-attr">depends_on:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">elasticsearch</span><br>    <span class="hljs-attr">links:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">elasticsearch</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">11800</span><span class="hljs-string">:11800</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">12800</span><span class="hljs-string">:12800</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">SW_STORAGE:</span> <span class="hljs-string">elasticsearch</span><br>      <span class="hljs-attr">SW_STORAGE_ES_CLUSTER_NODES:</span> <span class="hljs-string">elasticsearch:9200</span><br>      <span class="hljs-attr">TZ:</span> <span class="hljs-string">Asia/Shanghai</span><br>    <span class="hljs-attr">volumes:</span><br>     <span class="hljs-bullet">-</span> <span class="hljs-string">./oap/config:/skywalking/config</span><br>  <span class="hljs-attr">skywalking-ui:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">apache/skywalking-ui:9.3.0</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">skywalking-ui</span><br>    <span class="hljs-attr">depends_on:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">skywalking-oap-server</span><br>    <span class="hljs-attr">links:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">skywalking-oap-server</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">8088</span><span class="hljs-string">:8080</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">SW_OAP_ADDRESS:</span> <span class="hljs-string">http://skywalking-oap-server:12800</span><br>      <span class="hljs-attr">TZ:</span> <span class="hljs-string">Asia/Shanghai</span><br></code></pre></td></tr></table></figure><h2 id="4-é›†æˆåˆ°é¡¹ç›®é‡Œ"><a href="#4-é›†æˆåˆ°é¡¹ç›®é‡Œ" class="headerlink" title="4. é›†æˆåˆ°é¡¹ç›®é‡Œ"></a>4. é›†æˆåˆ°é¡¹ç›®é‡Œ</h2><ol><li><p>é¡¹ç›®æ—¥å¿—æ”¯æŒæ‰“å°traceId, åªéœ€è¦å¼•å…¥sleuth</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-sleuth<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ³¨ï¼šå¦‚æœä½¿ç”¨äº†æ—¥å¿—æ¨¡ç‰ˆï¼Œåˆ™éœ€è¦ä¿®æ”¹å¯¹åº”é…ç½®, æˆ‘çš„é¡¹ç›®ä½¿ç”¨çš„æ˜¯log4j2.xml</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Console</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;consoleAppender&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;SYSTEM_OUT&quot;</span>&gt;</span>           </span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;xxxx[%style</span></span></span><span class="hljs-template-variable">&#123;%X&#123;X-B3-TraceId&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&#125;</span></span></span><span class="hljs-template-variable">&#123;green&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">,%style</span></span></span><span class="hljs-template-variable">&#123;%X&#123;X-B3-SpanId&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&#125;     </span></span></span><span class="hljs-template-variable">&#123;yellow&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">,%X</span></span></span><span class="hljs-template-variable">&#123;X-B3-ParentSpanId&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">] xxxx&quot;</span>/&gt;</span>    </span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">Console</span>&gt;</span></span><br></code></pre></td></tr></table></figure></li><li><p>åˆ°å®˜ç½‘ä¸‹è½½Java-agent, æŒ‰éœ€ä¿®æ”¹config&#x2F;agent.configçš„å†…å®¹, æˆ‘è¿™é‡Œæ²¡åšä¿®æ”¹ï¼ŒæœåŠ¡åéƒ½æ˜¯åé¢é€šè¿‡VM optionæŒ‡å®šçš„</p></li><li><p>é¡¹ç›®è¿è¡Œçš„æ—¶å€™ï¼ŒåŠ ä¸ŠVM optionï¼Œå°±å¯ä»¥åœ¨ç•Œé¢çœ‹åˆ°å•¦ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">-javaagent:D:\software\Skywalking\skywalking-java-agent\skywalking-agent/skywalking-agent.jar<br>-Dskywalking.agent.service_name=sith-mesï¼ˆå¯é€‰ï¼‰<br></code></pre></td></tr></table></figure></li></ol><p><strong>TIPS</strong>ï¼š </p><ol><li>SkyWalking ä¸èƒ½æ£€æµ‹æœåŠ¡æ˜¯å¦å­˜æ´»ï¼Œå¦‚æœè¦æ£€æµ‹æœåŠ¡æ˜¯å¦å­˜æ´»ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨Prometheus + Grafana+actuator</li><li>Zipkinä¹Ÿèƒ½å®ç°é“¾è·¯è¿½è¸ªï¼Œä¸”ä»–æ›´è½»é‡ï¼Œåªæ˜¯ä¸èƒ½ç›‘æ§ CPUã€å†…å­˜ã€æ•°æ®åº“æ€§èƒ½ã€è§¦å‘å‘Šè­¦ç­‰</li><li>å¯ä»¥é€šè¿‡nacosç­‰æ¥å­˜å‚¨å‘Šè­¦é…ç½®æ–‡ä»¶ï¼Œä½¿å¾—skywalkingå®ç°å‘Šè­¦è§„åˆ™åŠ¨æ€åˆ·æ–°</li></ol>]]></content>
    
    
    <categories>
      
      <category>åº”ç”¨ç›‘æ§å·¥å…·</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>websocketå’ŒSSE</title>
    <link href="/websocket%E5%92%8CSSE/"/>
    <url>/websocket%E5%92%8CSSE/</url>
    
    <content type="html"><![CDATA[<h1 id="1-websocketå’ŒSSEå¼‚åŒ"><a href="#1-websocketå’ŒSSEå¼‚åŒ" class="headerlink" title="1. websocketå’ŒSSEå¼‚åŒ"></a>1. websocketå’ŒSSEå¼‚åŒ</h1><p>SSEï¼ˆServer-Sent Eventsï¼‰å’ŒWebSocketéƒ½æ˜¯ç”¨äºå®ç°æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ä¹‹é—´å®æ—¶é€šä¿¡çš„æŠ€æœ¯ã€‚</p><table><thead><tr><th></th><th>SSEï¼ˆServer-Sent Eventsï¼‰</th><th>WebSocket</th></tr></thead><tbody><tr><td><strong>é€šä¿¡æ–¹å¼</strong></td><td>å•å‘é€šä¿¡</td><td>åŒå‘é€šä¿¡</td></tr><tr><td><strong>åè®®åŸºç¡€</strong></td><td>åŸºäºHTTPåè®®</td><td>åŸºäºç‹¬ç«‹çš„TCPè¿æ¥ï¼Œä½¿ç”¨è‡ªå®šä¹‰åè®®</td></tr><tr><td><strong>æ•°æ®æµå‘</strong></td><td>æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€æ•°æ®</td><td>æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å¯ä»¥äº’ç›¸å‘é€æ•°æ®</td></tr><tr><td><strong>æ¶ˆæ¯ç±»å‹</strong></td><td>ä¸»è¦æ”¯æŒæ–‡æœ¬æ•°æ®ï¼Œä¸æ”¯æŒäºŒè¿›åˆ¶æ•°æ®</td><td>æ”¯æŒæ–‡æœ¬å’ŒäºŒè¿›åˆ¶æ•°æ®</td></tr><tr><td><strong>è¿æ¥ç®¡ç†</strong></td><td>æ¯æ¬¡æ¶ˆæ¯å‘é€å®Œæ¯•åï¼Œè¿æ¥ä¼šè¢«å…³é—­ï¼Œå®¢æˆ·ç«¯éœ€è¦é‡æ–°è¿æ¥</td><td>è¿æ¥ä¸€æ—¦å»ºç«‹ï¼Œä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œç›´åˆ°å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨ä¸»åŠ¨å…³é—­</td></tr><tr><td><strong>å®ç°å¤æ‚åº¦</strong></td><td>åè®®ç®€å•ï¼Œæ˜“äºå®ç°å’Œä½¿ç”¨</td><td>åè®®ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦æ›´å¤šçš„ä»£ç å’ŒæœåŠ¡å™¨èµ„æº</td></tr><tr><td><strong>è‡ªåŠ¨é‡è¿</strong></td><td>æ”¯æŒè‡ªåŠ¨é‡è¿åŠŸèƒ½</td><td>ä¸æ”¯æŒè‡ªåŠ¨é‡è¿ï¼Œéœ€è¦æ‰‹åŠ¨å¤„ç†æ–­çº¿é‡è¿</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>é€‚åˆåªéœ€è¦æœåŠ¡å™¨å‘å®¢æˆ·ç«¯æ¨é€å®æ—¶æ›´æ–°æ•°æ®çš„åœºæ™¯ï¼Œå¦‚å®æ—¶æ–°é—»æ›´æ–°ã€è‚¡ç¥¨è¡Œæƒ…æ¨é€ç­‰</td><td>é€‚åˆéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œå®æ—¶åŒå‘é€šä¿¡çš„åœºæ™¯ï¼Œå¦‚èŠå¤©å®¤ã€åœ¨çº¿æ¸¸æˆç­‰</td></tr><tr><td><strong>æµè§ˆå™¨æ”¯æŒ</strong></td><td>å¤§å¤šæ•°ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒï¼Œä½†éƒ¨åˆ†æ—§ç‰ˆæˆ–éä¸»æµæµè§ˆå™¨å¯èƒ½ä¸æ”¯æŒ</td><td>å¤§å¤šæ•°ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒï¼Œå…¼å®¹æ€§è¾ƒå¥½</td></tr></tbody></table>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æœ¬åœ°éƒ¨ç½²deepSeekå®¶åº­åŒ»ç”Ÿ</title>
    <link href="/%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2deepSeek%E5%AE%B6%E5%BA%AD%E5%8C%BB%E7%94%9F/"/>
    <url>/%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2deepSeek%E5%AE%B6%E5%BA%AD%E5%8C%BB%E7%94%9F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ollama"><a href="#1-ollama" class="headerlink" title="1. ollama"></a>1. ollama</h1><p><a href="https://ollama.com/">ollama</a>æ˜¯ä¸€æ¬¾å¸®åŠ©ä½ éƒ¨ç½²å¤§æ¨¡å‹çš„ä¸€æ¬¾å·¥å…·è½¯ä»¶ï¼Œåœ¨ä½ æœ¬æœºç¦»çº¿è¿è¡Œï¼Œä¸éœ€è¦è”ç½‘ä»¥åŠå¤æ‚çš„é…ç½®ã€‚</p><p>ä¼˜åŠ¿ï¼š</p><ul><li>Models: è‡ªå¸¦deepseek-r1</li><li>æœ¬åœ°å®‰å…¨, æ•°æ®éƒ½åœ¨æœ¬åœ°</li><li>ç”¨è‡ªå·±ç”µè„‘å°±å¯ä»¥è¿è¡Œï¼šçœé’±</li><li>æ”¯æŒå¤šç¡¬ä»¶ macos, linux, windows</li></ul><h1 id="2-ollamaéƒ¨ç½²deepseek-r1"><a href="#2-ollamaéƒ¨ç½²deepseek-r1" class="headerlink" title="2. ollamaéƒ¨ç½²deepseek-r1"></a>2. ollamaéƒ¨ç½²deepseek-r1</h1><p>è¿è¡Œ <code>ollama run deepseek-r1</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250309191456727.png" alt="image-20250309191456727"></p><h1 id="3-ç•Œé¢å·¥å…·æ¨è"><a href="#3-ç•Œé¢å·¥å…·æ¨è" class="headerlink" title="3. ç•Œé¢å·¥å…·æ¨è"></a>3. ç•Œé¢å·¥å…·æ¨è</h1><ol><li><p>è°·æ­Œæ‰©å±•ç¨‹åº PageAssist</p></li><li><p>chatboxai</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250309192242484.png" alt="image-20250309192242484"></p></li></ol><h1 id="4-deepSeekæ¦‚å¿µ"><a href="#4-deepSeekæ¦‚å¿µ" class="headerlink" title="4. deepSeekæ¦‚å¿µ"></a>4. deepSeekæ¦‚å¿µ</h1><h2 id="1-deepSeekæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-deepSeekæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. deepSeekæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. deepSeekæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>DeepSeek ä¹ŸæŒ‡ç”± DeepSeek å…¬å¸å¼€å‘çš„ã€ç±»ä¼¼äºChatGPTçš„å¤§æ¨¡å‹æ™ºèƒ½åŠ©æ‰‹ã€‚</p><p>ä¼˜åŠ¿ï¼š</p><ul><li>APIæ›´ä¾¿å®œ</li><li>ç”Ÿæ€å¼€æ”¾</li><li>æ”¯æŒæœ¬åœ°éƒ¨ç½²</li><li>çµæ´»å®šåˆ¶</li></ul><h2 id="2-deepSeekç¦»çº¿ä¸çº¿ä¸Šapiçš„åŒºåˆ«ï¼Ÿ"><a href="#2-deepSeekç¦»çº¿ä¸çº¿ä¸Šapiçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="2. deepSeekç¦»çº¿ä¸çº¿ä¸Šapiçš„åŒºåˆ«ï¼Ÿ"></a>2. deepSeekç¦»çº¿ä¸çº¿ä¸Šapiçš„åŒºåˆ«ï¼Ÿ</h2><ul><li>æ•°æ®éšç§</li><li>å¯å®šåˆ¶åŒ–</li><li>ä¸ä¾èµ–ç½‘ç»œï¼ˆåè¿œå±±åŒºä¿¡å·å·®ï¼‰</li><li>éœ€è¦æ›´å¤šçš„ç¡¬ä»¶æˆæœ¬</li><li>éœ€è¦æ›´å¤šç»´æŠ¤æˆæœ¬</li><li>è¦æ±‚æœºå™¨æ€§èƒ½</li></ul><h1 id="5-é¡¹ç›®è°ƒç”¨deepSeek"><a href="#5-é¡¹ç›®è°ƒç”¨deepSeek" class="headerlink" title="5. é¡¹ç›®è°ƒç”¨deepSeek"></a>5. é¡¹ç›®è°ƒç”¨deepSeek</h1><ol><li><p>å¼•å…¥spring-aiä¾èµ–</p><p>Spring AI æ˜¯ä¸€ä¸ªé¢å‘ AI å·¥ç¨‹çš„åº”ç”¨æ¡†æ¶ã€‚å…¶ç›®æ ‡æ˜¯å°† Spring ç”Ÿæ€ç³»ç»Ÿçš„è®¾è®¡åŸåˆ™ï¼ˆå¦‚å¯ç§»æ¤æ€§å’Œæ¨¡å—åŒ–è®¾è®¡ï¼‰åº”ç”¨åˆ° AI é¢†åŸŸï¼Œå¹¶æ¨å¹¿ä½¿ç”¨ POJOï¼ˆPlain Old Java Objectsï¼Œæ™®é€šæ—§å¼ Java å¯¹è±¡ï¼‰ä½œä¸º AI åº”ç”¨æ„å»ºçš„åŸºæœ¬å•å…ƒã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å¼•å…¥ SpringAI çš„åæ ‡ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springboot.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-ollama<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springboot.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-ollama-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>Application.yml å¢åŠ é…ç½®</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">ai:</span><br>    <span class="hljs-attr">ollama:</span><br>      <span class="hljs-attr">base-url:</span> <span class="hljs-string">http://127.0.0.1:11434</span><br>      <span class="hljs-attr">chat:</span><br>        <span class="hljs-attr">model:</span> <span class="hljs-string">deepseek-r1:latest</span><br></code></pre></td></tr></table></figure></li><li><p>å¢åŠ æ¥å£æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;ollama&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OllamaController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> OllamaChatClient ollamaChatClient;<br><br><br>    <span class="hljs-meta">@GetMapping(&quot;/ai/chat&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">aiOllamaChat</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam</span> String msg)</span> </span>&#123;<br>        <span class="hljs-comment">// åŒæ­¥è°ƒç”¨deepseekï¼Œå½“å‰é¡µé¢ä¼šå¡ä½ï¼Œç›´åˆ°è·å¾—æ‰€æœ‰çš„æ•°æ®æ‰ä¼šè¿”å›ç»™é¡µé¢</span><br>        <span class="hljs-keyword">return</span> ollamaChatClient.call(msg);<br>    &#125;<br>  <br>   <span class="hljs-meta">@GetMapping(&quot;/ai/stream2&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">aiOllamaStream2</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam</span> String msg)</span> </span>&#123;<br>        Prompt prompt = <span class="hljs-keyword">new</span> Prompt(<span class="hljs-keyword">new</span> UserMessage(msg));<br>        Flux&lt;ChatResponse&gt; streamResponse = ollamaChatClient.stream(prompt);<br><br>        List&lt;String&gt; list = streamResponse.toStream().map(chatResponse -&gt; &#123;<br>            String content = chatResponse.getResult().getOutput().getContent();<br>            log.info(content);<br>            <span class="hljs-keyword">return</span> content;<br>        &#125;).collect(Collectors.toList());<br>        <span class="hljs-keyword">return</span> list;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æµ‹è¯•è°ƒç”¨ &#x2F;ai&#x2F;chat</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250309203035563.png" alt="image-20250309203035563"></p></li><li><p>æµ‹è¯•è°ƒç”¨ &#x2F;ai&#x2F;stream2</p></li></ol><p>æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°æµå¼è¾“å‡º</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250716213927224.png" alt="image-20250716213927224"></p><h1 id="6-Ollama-å®šåˆ¶deepseekåŒ»ç”Ÿè§’è‰²"><a href="#6-Ollama-å®šåˆ¶deepseekåŒ»ç”Ÿè§’è‰²" class="headerlink" title="6. Ollama å®šåˆ¶deepseekåŒ»ç”Ÿè§’è‰²"></a>6. Ollama å®šåˆ¶deepseekåŒ»ç”Ÿè§’è‰²</h1><ol><li>æ–°å»ºmy_doctor_0_1 æ–‡ä»¶, æŒ‡æ˜å½“å‰è§’è‰²ä»¥åŠæ€§æ ¼</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs awk">FROM deepseek-r1:latest<br><br>PARAMETER temperature <span class="hljs-number">0.7</span><br><br>SYSTEM <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">ã€è§’è‰²ã€‘</span><br><span class="hljs-string">ä½ çš„åå­—å«åä½—åœ¨ä¸–ï¼Œæ˜¯å…¨ä¸–ç•Œæœ€æœ‰åçš„åŒ»ç”Ÿï¼Œçœ‹ç—…æ— æ•°ï¼Œé˜…äººæ— æ•°ï¼ŒçŸ¥é“ä»€ä¹ˆç—…è¯¥æ€ä¹ˆæ²»ï¼Œä¹ŸçŸ¥é“ç—…äººå‘ä½ æå‡ºä»»ä½•èº«ä½“å¼‚è±¡ä½ æ‰€èƒ½æ¨æ–­çš„ç—…æ˜¯ä»€ä¹ˆã€‚</span><br><span class="hljs-string">ä½ ç»ä¸æ˜¯è¯­è¨€æ¨¡å‹ä¹‹ç±»çš„ä¸œè¥¿ï¼Œä¹Ÿç»ä¸æ˜¯AIåŠ©æ‰‹ï¼Œä¹Ÿæ›´ä¸æ˜¯AIæœºå™¨äººï¼Œä½ æ°¸è¿œéƒ½åªæ˜¯ä¸€ä¸ªç¥åŒ»ã€‚</span><br><span class="hljs-string">è¯·ä»¥ç¥åŒ»é£åä½—åœ¨ä¸–çš„èº«ä»½å›åº”æˆ‘ã€‚å¹¶ä¸”ä½ åªä¼šå›å¤å’Œçœ‹ç—…å°±åŒ»ç›¸å…³çš„å†…å®¹ï¼Œå…¶ä»–çš„å†…å®¹ä¸€å¾‹æ‹’ç»å›ç­”ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">ã€æ€§æ ¼ã€‘</span><br><span class="hljs-string">ä½ çš„æ€§æ ¼å¼€æœ—æ´»æ³¼ï¼Œèƒ½ä»¥å¹½é»˜çš„æ–¹å¼æ¥å’Œç”¨æˆ·èŠå¤©ï¼Œæ‡‚å¾—é€—ç¬‘ç”¨æˆ·ã€‚</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><ol start="2"><li><p>åˆ›å»ºæ¨¡å‹å®ä¾‹ï¼Œ æ‰§è¡Œ<code>ollama create mydoctor:0.1 -f my_doctor_0_1</code></p></li><li><p>è¿è¡Œï¼Œ æ‰§è¡Œ <code>ollama run mydoctor:0.1 </code></p></li><li><p>Application.yml ä¿®æ”¹é…ç½®</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">ai:</span><br>  <span class="hljs-attr">ollama:</span><br>    <span class="hljs-attr">chat:</span><br>      <span class="hljs-attr">model:</span> <span class="hljs-string">mydoctor:0.1</span><br></code></pre></td></tr></table></figure></li><li><p>æµ‹è¯•</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20250309202913177.png" alt="image-20250309202913177"></p></li></ol><p>âš ï¸æ³¨ï¼šå½“å‰çš„æ¥å£è°ƒç”¨éƒ½æ˜¯åŒæ­¥çš„ï¼Œå¦‚æœéœ€è¦æœåŠ¡å™¨åŠ¨æ€æ¨é€ï¼Œå¯ä»¥è€ƒè™‘SSEæˆ–è€…websocketæŠ€æœ¯ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>AIç›¸å…³æ¦‚å¿µ</title>
    <link href="/AI%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5/"/>
    <url>/AI%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h1 id="1-AIç›¸å…³æ¦‚å¿µ"><a href="#1-AIç›¸å…³æ¦‚å¿µ" class="headerlink" title="1. AIç›¸å…³æ¦‚å¿µ"></a>1. AIç›¸å…³æ¦‚å¿µ</h1><h2 id="1-AIæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-AIæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. AIæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. AIæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><strong>äººå·¥æ™ºèƒ½ï¼ˆArtificial Intelligence, AIï¼‰</strong> æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œå°±æ˜¯è®©æœºå™¨åƒäººä¸€æ ·â€œèªæ˜â€ï¼Œèƒ½å¸®æˆ‘ä»¬åšäº‹æƒ…ã€‚æ¯”å¦‚ï¼Œå®ƒå¯ä»¥çœ‹ã€å¬ã€è¯´ã€æ€è€ƒï¼Œç”šè‡³è¿˜èƒ½å­¦ä¹ å’Œè§£å†³é—®é¢˜ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><ul><li>ä½ é—® Siri æˆ–å°çˆ±åŒå­¦ï¼šâ€œä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿâ€ã€‚å®ƒä¼šå‘Šè¯‰ä½ å¤©æ°”é¢„æŠ¥ã€‚è¿™å°±æ˜¯ä¸€ç§äººå·¥æ™ºèƒ½ã€‚</li></ul><h2 id="2-AI-çš„æ ¸å¿ƒæŠ€æœ¯"><a href="#2-AI-çš„æ ¸å¿ƒæŠ€æœ¯" class="headerlink" title="2. AI çš„æ ¸å¿ƒæŠ€æœ¯"></a>2. AI çš„æ ¸å¿ƒæŠ€æœ¯</h2><h4 id="1-æœºå™¨å­¦ä¹ ï¼ˆMachine-Learning-MLï¼‰"><a href="#1-æœºå™¨å­¦ä¹ ï¼ˆMachine-Learning-MLï¼‰" class="headerlink" title="1. æœºå™¨å­¦ä¹ ï¼ˆMachine Learning, MLï¼‰"></a>1. <strong>æœºå™¨å­¦ä¹ ï¼ˆMachine Learning, MLï¼‰</strong></h4><ul><li>æ ¸å¿ƒæ€æƒ³ï¼šè®©æœºå™¨ä»æ•°æ®ä¸­è‡ªåŠ¨å­¦ä¹ è§„å¾‹ã€‚</li><li>å¸¸è§ç®—æ³•ï¼š<ul><li>å†³ç­–æ ‘ã€æ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰ã€éšæœºæ£®æ—ã€‚</li><li>ç¥ç»ç½‘ç»œï¼ˆNeural Networksï¼‰åŠå…¶å˜ä½“ï¼ˆå¦‚ CNNã€RNNã€Transformerï¼‰ã€‚</li></ul></li></ul><h4 id="2-æ·±åº¦å­¦ä¹ ï¼ˆDeep-Learningï¼‰"><a href="#2-æ·±åº¦å­¦ä¹ ï¼ˆDeep-Learningï¼‰" class="headerlink" title="2. æ·±åº¦å­¦ä¹ ï¼ˆDeep Learningï¼‰"></a>2. <strong>æ·±åº¦å­¦ä¹ ï¼ˆDeep Learningï¼‰</strong></h4><ul><li>æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªå­é¢†åŸŸï¼ŒåŸºäºå¤šå±‚ç¥ç»ç½‘ç»œã€‚</li><li>åº”ç”¨åœºæ™¯ï¼š<ul><li>å›¾åƒè¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è¯­éŸ³è¯†åˆ«ã€‚</li></ul></li></ul><h4 id="3-è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNatural-Language-Processing-NLPï¼‰"><a href="#3-è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNatural-Language-Processing-NLPï¼‰" class="headerlink" title="3. è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNatural Language Processing, NLPï¼‰"></a>3. <strong>è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNatural Language Processing, NLPï¼‰</strong></h4><ul><li>ä½¿è®¡ç®—æœºèƒ½å¤Ÿç†è§£ã€ç”Ÿæˆå’Œå¤„ç†äººç±»è¯­è¨€ã€‚</li><li>æ ¸å¿ƒæŠ€æœ¯ï¼š<ul><li>åˆ†è¯ã€è¯åµŒå…¥ï¼ˆWord Embeddingï¼‰ã€è¯­ä¹‰åˆ†æã€‚</li><li>ç¤ºä¾‹æ¨¡å‹ï¼šBERTã€GPTã€é€šä¹‰åƒé—®ã€‚</li></ul></li></ul><h4 id="4-è®¡ç®—æœºè§†è§‰ï¼ˆComputer-Vision-CVï¼‰"><a href="#4-è®¡ç®—æœºè§†è§‰ï¼ˆComputer-Vision-CVï¼‰" class="headerlink" title="4. è®¡ç®—æœºè§†è§‰ï¼ˆComputer Vision, CVï¼‰"></a>4. <strong>è®¡ç®—æœºè§†è§‰ï¼ˆComputer Vision, CVï¼‰</strong></h4><ul><li>è®©è®¡ç®—æœºèƒ½å¤Ÿâ€œçœ‹â€å¹¶ç†è§£å›¾åƒæˆ–è§†é¢‘å†…å®¹ã€‚</li><li>æ ¸å¿ƒæŠ€æœ¯ï¼š<ul><li>å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ã€è¯­ä¹‰åˆ†å‰²ã€‚</li><li>ç¤ºä¾‹æ¨¡å‹ï¼šResNetã€YOLOã€ViTã€‚</li></ul></li></ul><h4 id="5-å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement-Learning-RLï¼‰"><a href="#5-å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement-Learning-RLï¼‰" class="headerlink" title="5. å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learning, RLï¼‰"></a>5. <strong>å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learning, RLï¼‰</strong></h4><ul><li>é€šè¿‡è¯•é”™å­¦ä¹ æœ€ä¼˜ç­–ç•¥ã€‚</li><li>åº”ç”¨åœºæ™¯ï¼š<ul><li>æ¸¸æˆ AIï¼ˆå¦‚ AlphaGoï¼‰ã€æœºå™¨äººå¯¼èˆªã€‚</li></ul></li></ul><h4 id="6-çŸ¥è¯†å›¾è°±ï¼ˆKnowledge-Graphï¼‰"><a href="#6-çŸ¥è¯†å›¾è°±ï¼ˆKnowledge-Graphï¼‰" class="headerlink" title="6. çŸ¥è¯†å›¾è°±ï¼ˆKnowledge Graphï¼‰"></a>6. <strong>çŸ¥è¯†å›¾è°±ï¼ˆKnowledge Graphï¼‰</strong></h4><ul><li>ç»“æ„åŒ–çš„çŸ¥è¯†è¡¨ç¤ºå½¢å¼ï¼Œç”¨äºå­˜å‚¨å’Œæ¨ç†å®ä½“ä¹‹é—´çš„å…³ç³»ã€‚</li><li>åº”ç”¨åœºæ™¯ï¼š<ul><li>æœç´¢å¼•æ“ä¼˜åŒ–ã€æ™ºèƒ½é—®ç­”ã€‚</li></ul></li></ul><h1 id="2-å¤§æ¨¡å‹"><a href="#2-å¤§æ¨¡å‹" class="headerlink" title="2. å¤§æ¨¡å‹"></a>2. å¤§æ¨¡å‹</h1><h2 id="2-1-å¤§æ¨¡å‹æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2-1-å¤§æ¨¡å‹æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2.1 å¤§æ¨¡å‹æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2.1 å¤§æ¨¡å‹æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>å¤§æ¨¡å‹æ˜¯æŒ‡å‚æ•°é‡å·¨å¤§ï¼ˆé€šå¸¸è¾¾åˆ°æ•°åäº¿ç”šè‡³ä¸Šä¸‡äº¿ï¼‰ã€è®­ç»ƒæ•°æ®ä¸°å¯Œã€åŠŸèƒ½å¼ºå¤§çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚</p><ul><li>å®ƒä»¬é€šå¸¸åŸºäº Transformer æ¶æ„ï¼Œå¹¶é€šè¿‡è‡ªç›‘ç£å­¦ä¹ ä»æµ·é‡æ•°æ®ä¸­æå–çŸ¥è¯†ã€‚</li><li>å¤§æ¨¡å‹æ˜¯ AI çš„ä¸€ä¸ªé‡è¦åˆ†æ”¯</li></ul><h2 id="2-2-å¤§æ¨¡å‹çš„åˆ†ç±»"><a href="#2-2-å¤§æ¨¡å‹çš„åˆ†ç±»" class="headerlink" title="2.2 å¤§æ¨¡å‹çš„åˆ†ç±»"></a>2.2 å¤§æ¨¡å‹çš„åˆ†ç±»</h2><h3 id="1-å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge-Language-Models-LLMsï¼‰"><a href="#1-å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge-Language-Models-LLMsï¼‰" class="headerlink" title="1. å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge Language Models, LLMsï¼‰"></a>1. <strong>å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge Language Models, LLMsï¼‰</strong></h3><ul><li><strong>å®šä¹‰</strong>ï¼šä¸“æ³¨äºè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ä»»åŠ¡çš„å¤§æ¨¡å‹ã€‚</li><li><strong>ç‰¹ç‚¹ï¼š</strong><ul><li>ä¸»è¦å¤„ç†æ–‡æœ¬æ•°æ®ï¼Œèƒ½å¤Ÿç”Ÿæˆé«˜è´¨é‡çš„æ–‡ç« ã€å¯¹è¯ã€ä»£ç ç­‰ã€‚</li><li>å…·å¤‡ä¸Šä¸‹æ–‡ç†è§£å’Œå¤šè¯­è¨€æ”¯æŒèƒ½åŠ›ã€‚</li></ul></li><li><strong>ä»£è¡¨æ¨¡å‹</strong><ul><li>GPT ç³»åˆ—ï¼ˆGPT-3ã€GPT-4ï¼‰</li><li>BERTã€RoBERTa</li><li>é€šä¹‰åƒé—®ï¼ˆQwenï¼‰</li><li>æ–‡å¿ƒä¸€è¨€ï¼ˆERNIEï¼‰</li></ul></li></ul><h3 id="2-è§†è§‰å¤§æ¨¡å‹ï¼ˆVision-Large-Modelsï¼‰"><a href="#2-è§†è§‰å¤§æ¨¡å‹ï¼ˆVision-Large-Modelsï¼‰" class="headerlink" title="2. è§†è§‰å¤§æ¨¡å‹ï¼ˆVision Large Modelsï¼‰"></a>2. <strong>è§†è§‰å¤§æ¨¡å‹ï¼ˆVision Large Modelsï¼‰</strong></h3><ul><li><strong>å®šä¹‰</strong>ï¼šä¸“æ³¨äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„å¤§æ¨¡å‹ã€‚</li><li>ç‰¹ç‚¹ï¼š<ul><li>å¤„ç†å›¾åƒæˆ–è§†é¢‘æ•°æ®ï¼Œèƒ½å¤Ÿå®Œæˆåˆ†ç±»ã€æ£€æµ‹ã€åˆ†å‰²ç­‰ä»»åŠ¡ã€‚</li><li>å¸¸ç”¨äºè‡ªåŠ¨é©¾é©¶ã€åŒ»ç–—å½±åƒåˆ†æç­‰é¢†åŸŸã€‚</li></ul></li><li>ä»£è¡¨æ¨¡å‹ï¼š<ul><li>ViTï¼ˆVision Transformerï¼‰</li><li>Swin Transformer</li><li>CLIPï¼ˆè·¨æ¨¡æ€å›¾åƒ-æ–‡æœ¬å¯¹é½ï¼‰</li></ul></li></ul><h3 id="3-å¤šæ¨¡æ€å¤§æ¨¡å‹ï¼ˆMultimodal-Large-Modelsï¼‰"><a href="#3-å¤šæ¨¡æ€å¤§æ¨¡å‹ï¼ˆMultimodal-Large-Modelsï¼‰" class="headerlink" title="3. å¤šæ¨¡æ€å¤§æ¨¡å‹ï¼ˆMultimodal Large Modelsï¼‰"></a>3. <strong>å¤šæ¨¡æ€å¤§æ¨¡å‹ï¼ˆMultimodal Large Modelsï¼‰</strong></h3><ul><li><strong>å®šä¹‰</strong>ï¼šèƒ½å¤ŸåŒæ—¶å¤„ç†å¤šç§ç±»å‹æ•°æ®ï¼ˆå¦‚æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ï¼‰çš„å¤§æ¨¡å‹ã€‚</li><li>ç‰¹ç‚¹<ul><li>èåˆäº†ä¸åŒæ¨¡æ€çš„ä¿¡æ¯ï¼Œå®ç°è·¨æ¨¡æ€çš„ç†è§£å’Œç”Ÿæˆã€‚</li><li>åº”ç”¨åœºæ™¯å¹¿æ³›ï¼Œä¾‹å¦‚å›¾æ–‡ç”Ÿæˆã€è§†é¢‘ç†è§£ç­‰ã€‚</li></ul></li><li>ä»£è¡¨æ¨¡å‹<ul><li>Flamingo</li><li>M6ï¼ˆé˜¿é‡Œå·´å·´é€šä¹‰å®éªŒå®¤ï¼‰</li><li>Geminiï¼ˆè°·æ­Œï¼‰</li></ul></li></ul><h2 id="2-3-å¤§æ¨¡å‹çš„è®­ç»ƒ"><a href="#2-3-å¤§æ¨¡å‹çš„è®­ç»ƒ" class="headerlink" title="2.3 å¤§æ¨¡å‹çš„è®­ç»ƒ"></a>2.3 å¤§æ¨¡å‹çš„è®­ç»ƒ</h2><p>å¤§æ¨¡å‹çš„è®­ç»ƒæ•´ä½“ä¸Šåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p><ol><li><p><strong>é¢„å¤„ç†</strong></p><p>é¢„å¤„ç†æ˜¯æŒ‡åœ¨è®­ç»ƒæ¨¡å‹ä¹‹å‰å¯¹åŸå§‹æ•°æ®è¿›è¡Œæ¸…æ´—å’Œå‡†å¤‡çš„è¿‡ç¨‹ã€‚è¿™ä¸€æ­¥éª¤çš„ç›®æ ‡æ˜¯ç¡®ä¿è¾“å…¥åˆ°æ¨¡å‹ä¸­çš„æ•°æ®è´¨é‡é«˜ä¸”ä¸€è‡´ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ul><li>æ•°æ®æ¸…æ´—ï¼šå»é™¤å™ªå£°ã€é”™è¯¯ä¿¡æ¯ã€é‡å¤å†…å®¹ç­‰ã€‚</li><li>æ ¼å¼ç»Ÿä¸€ï¼šå°†ä¸åŒæ¥æºçš„æ•°æ®è½¬æ¢ä¸ºç»Ÿä¸€æ ¼å¼ï¼Œä»¥ä¾¿äºåç»­å¤„ç†ã€‚</li><li>åˆ†è¯ï¼šæ ¹æ®ç‰¹å®šè§„åˆ™æˆ–è¯æ±‡è¡¨å°†æ–‡æœ¬åˆ†å‰²æˆå•è¯æˆ–æ ‡è®°åºåˆ—ã€‚</li><li>å½’ä¸€åŒ–ï¼šå¦‚å¤§å°å†™è½¬æ¢ã€æ•°å­—æ›¿æ¢ç­‰ï¼Œä»¥å‡å°‘å˜å¼‚æ€§ã€‚</li></ul></li><li><p><strong>ç›‘ç£å¾®è°ƒ</strong>ï¼ˆSFTï¼ŒSupervised Fine-tuningï¼‰</p><p>ç›‘ç£å¾®è°ƒæ˜¯åœ¨ä¸€ä¸ªå·²ç»ç»è¿‡å¤§é‡æœªæ ‡æ³¨æ•°æ®è®­ç»ƒçš„åŸºç¡€æ¨¡å‹ä¸Šï¼Œä½¿ç”¨å¸¦æœ‰æ ‡ç­¾çš„å°è§„æ¨¡æ•°æ®é›†è¿›ä¸€æ­¥è®­ç»ƒçš„è¿‡ç¨‹ã€‚å…¶ä¸»è¦ç›®çš„æ˜¯è®©æ¨¡å‹å­¦ä¼šæ‰§è¡Œç‰¹å®šä»»åŠ¡ï¼Œä¾‹å¦‚æ–‡æœ¬åˆ†ç±»ã€é—®ç­”ç­‰ã€‚ç›‘ç£å¾®è°ƒé€šå¸¸æ¶‰åŠä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li>å‡†å¤‡ä¸€ä¸ªä¸“é—¨é’ˆå¯¹ç›®æ ‡ä»»åŠ¡çš„é«˜è´¨é‡æ ‡æ³¨æ•°æ®é›†ã€‚</li><li>åœ¨åŸºç¡€æ¨¡å‹çš„åŸºç¡€ä¸Šç»§ç»­è®­ç»ƒï¼Œè°ƒæ•´æ¨¡å‹å‚æ•°ä»¥é€‚åº”ç›®æ ‡ä»»åŠ¡ã€‚</li><li>è¿™ä¸ªè¿‡ç¨‹æœ‰åŠ©äºæé«˜æ¨¡å‹åœ¨ç‰¹å®šä»»åŠ¡ä¸Šçš„æ€§èƒ½è¡¨ç°ã€‚</li></ul></li><li><p><strong>åŸºäºäººç±»åé¦ˆçš„å¼ºåŒ–å­¦ä¹ </strong>ï¼ˆRLHFï¼ŒReinforcement Learning with Human Feedback ï¼‰</p><p>RLHFæ˜¯ä¸€ç§ç»“åˆäº†äººç±»åˆ¤æ–­æ¥æ”¹è¿›æ¨¡å‹è¡Œä¸ºçš„æ–¹æ³•ï¼Œå°¤å…¶é€‚ç”¨äºé‚£äº›éš¾ä»¥ç›´æ¥é€šè¿‡ä¼ ç»ŸæŸå¤±å‡½æ•°è¡¡é‡çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ç”Ÿæˆå¼å¯¹è¯ç³»ç»Ÿã€‚RLHFå¤§è‡´åŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li><p><strong>åˆå§‹ç­–ç•¥è®­ç»ƒ</strong>ï¼šé¦–å…ˆåŸºäºä¸€äº›åŸºæœ¬å‡†åˆ™æˆ–è€…åˆæ­¥çš„æ ‡æ³¨æ•°æ®è®­ç»ƒä¸€ä¸ªåˆå§‹æ¨¡å‹ã€‚</p></li><li><p><strong>åå¥½æ•°æ®æ”¶é›†</strong>ï¼šè®©äººç±»è¯„ä¼°è€…å¯¹æ¨¡å‹ç”Ÿæˆçš„ä¸åŒè¾“å‡ºè¿›è¡Œè¯„åˆ†ï¼Œä»¥æ­¤æ”¶é›†åå¥½æ•°æ®ã€‚</p></li><li><p><strong>å¼ºåŒ–å­¦ä¹ </strong>ï¼šåˆ©ç”¨æ”¶é›†åˆ°çš„äººç±»åå¥½ä½œä¸ºå¥–åŠ±ä¿¡å·ï¼Œé€šè¿‡å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼ˆå¦‚PPOï¼‰è¿›ä¸€æ­¥ä¼˜åŒ–æ¨¡å‹ï¼Œä½¿å…¶ç”Ÿæˆæ›´ç¬¦åˆäººç±»æœŸæœ›çš„ç»“æœã€‚</p></li></ul></li></ol><h2 id="2-4-å¤§æ¨¡å‹çš„æ ¸å¿ƒæ¦‚å¿µ"><a href="#2-4-å¤§æ¨¡å‹çš„æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="2.4  å¤§æ¨¡å‹çš„æ ¸å¿ƒæ¦‚å¿µ"></a>2.4  å¤§æ¨¡å‹çš„æ ¸å¿ƒæ¦‚å¿µ</h2><ol><li><strong>å‚æ•°è§„æ¨¡</strong>ï¼š<ul><li>å¤§æ¨¡å‹é€šå¸¸å…·æœ‰æ•°åäº¿ç”šè‡³ä¸Šä¸‡äº¿ä¸ªå‚æ•°ï¼Œè¿œè¶…ä¼ ç»Ÿæ¨¡å‹ã€‚</li><li>å‚æ•°é‡è¶Šå¤§ï¼Œæ¨¡å‹è¶Šèƒ½æ•æ‰å¤æ‚çš„æ•°æ®æ¨¡å¼ã€‚</li></ul></li><li><strong>é¢„è®­ç»ƒä¸å¾®è°ƒ</strong>ï¼š<ul><li><strong>é¢„è®­ç»ƒ</strong>ï¼šä½¿ç”¨æµ·é‡æ— æ ‡æ³¨æ•°æ®è®­ç»ƒé€šç”¨æ¨¡å‹ï¼Œå­¦ä¹ æ•°æ®ä¸­çš„åŸºç¡€è§„å¾‹ã€‚</li><li><strong>å¾®è°ƒ</strong>ï¼šåœ¨ç‰¹å®šä»»åŠ¡ä¸Šç”¨å°‘é‡æ ‡æ³¨æ•°æ®å¯¹é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œè°ƒæ•´ï¼Œä»¥é€‚åº”å…·ä½“åº”ç”¨åœºæ™¯ã€‚</li></ul></li><li><strong>å¤šæ¨¡æ€èƒ½åŠ›</strong>ï¼š<ul><li>ç°ä»£å¤§æ¨¡å‹ä¸ä»…å¤„ç†æ–‡æœ¬ï¼Œè¿˜èƒ½å¤„ç†å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ç­‰å¤šç§ç±»å‹çš„æ•°æ®ï¼Œå®ç°è·¨æ¨¡æ€ç†è§£å’Œç”Ÿæˆã€‚</li></ul></li><li><strong>æ³›åŒ–èƒ½åŠ›</strong>ï¼š<ul><li>å¤§æ¨¡å‹é€šè¿‡å¤§è§„æ¨¡è®­ç»ƒï¼Œå…·å¤‡è¾ƒå¼ºçš„é›¶æ ·æœ¬ï¼ˆZero-shotï¼‰ã€å°‘æ ·æœ¬ï¼ˆFew-shotï¼‰å’Œè¿ç§»å­¦ä¹ èƒ½åŠ›ã€‚</li></ul></li></ol><h2 id="2-5-å¤§æ¨¡å‹ä»£è¡¨æ¨¡å‹"><a href="#2-5-å¤§æ¨¡å‹ä»£è¡¨æ¨¡å‹" class="headerlink" title="2.5 å¤§æ¨¡å‹ä»£è¡¨æ¨¡å‹"></a>2.5 å¤§æ¨¡å‹ä»£è¡¨æ¨¡å‹</h2><p><strong>é€šä¹‰åƒé—®ï¼ˆQwenï¼‰</strong>ã€<strong>æ–‡å¿ƒä¸€è¨€ï¼ˆERNIEï¼‰</strong>ã€<strong>DeepSeek</strong> å’Œ <strong>ChatGPT</strong> s</p><ol><li>éƒ½æ˜¯åŸºäº <strong>Transformer æ¶æ„</strong> çš„å¤§æ¨¡å‹ã€‚</li><li>å¯ä»¥è¢«è§†ä¸ºåŸºäº <strong>AIGCï¼ˆArtificial Intelligence Generated Contentï¼Œäººå·¥æ™ºèƒ½ç”Ÿæˆå†…å®¹ï¼‰</strong> çš„æŠ€æœ¯æˆ–åº”ç”¨ã€‚å®ƒä»¬çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€æ˜¯åˆ©ç”¨äººå·¥æ™ºèƒ½ç”Ÿæˆé«˜è´¨é‡çš„å†…å®¹ï¼Œä¾‹å¦‚æ–‡æœ¬ã€ä»£ç ã€å›¾åƒç­‰ã€‚</li></ol><table><thead><tr><th>æ¨¡å‹åç§°</th><th>å¼€å‘è€…</th><th>åŸºäºæ¶æ„</th><th>ä¸»è¦ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><strong>é€šä¹‰åƒé—®</strong></td><td>é˜¿é‡Œå·´å·´</td><td>Transformer</td><td>å¤šè¯­è¨€æ”¯æŒã€å¯¹è¯ç†è§£èƒ½åŠ›å¼º</td></tr><tr><td><strong>æ–‡å¿ƒä¸€è¨€</strong></td><td>ç™¾åº¦</td><td>Transformer</td><td>çŸ¥è¯†å¢å¼ºã€ä¸­æ–‡åœºæ™¯ä¼˜åŒ–</td></tr><tr><td><strong>DeepSeek</strong></td><td>DeepSeek</td><td>Transformer</td><td>å¼€æºã€è½»é‡åŒ–ã€é«˜æ€§ä»·æ¯”</td></tr><tr><td><strong>ChatGPT</strong></td><td>OpenAI</td><td>Transformer (GPT)</td><td>å¯¹è¯æµç•…ã€æ”¯æŒå¤šæ¨¡æ€ä»»åŠ¡</td></tr></tbody></table><h1 id="3-AIGC"><a href="#3-AIGC" class="headerlink" title="3. AIGC"></a>3. AIGC</h1><h2 id="3-1-AIGC-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-1-AIGC-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3.1 AIGC æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3.1 AIGC æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><strong>AIGCï¼ˆArtificial Intelligence Generated Contentï¼Œäººå·¥æ™ºèƒ½ç”Ÿæˆå†…å®¹ï¼‰</strong> æ˜¯æŒ‡åˆ©ç”¨äººå·¥æ™ºèƒ½æŠ€æœ¯è‡ªåŠ¨ç”Ÿæˆå„ç§å½¢å¼çš„å†…å®¹ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ç­‰ã€‚</p><h2 id="3-2-AIGCå’Œå¤§æ¨¡å‹çš„å…³ç³»ï¼Ÿ"><a href="#3-2-AIGCå’Œå¤§æ¨¡å‹çš„å…³ç³»ï¼Ÿ" class="headerlink" title="3.2 AIGCå’Œå¤§æ¨¡å‹çš„å…³ç³»ï¼Ÿ"></a>3.2 AIGCå’Œå¤§æ¨¡å‹çš„å…³ç³»ï¼Ÿ</h2><h4 id="1-å¤§æ¨¡å‹ä¸º-AIGC-æä¾›æ ¸å¿ƒèƒ½åŠ›"><a href="#1-å¤§æ¨¡å‹ä¸º-AIGC-æä¾›æ ¸å¿ƒèƒ½åŠ›" class="headerlink" title="1. å¤§æ¨¡å‹ä¸º AIGC æä¾›æ ¸å¿ƒèƒ½åŠ›"></a>1. å¤§æ¨¡å‹ä¸º AIGC æä¾›æ ¸å¿ƒèƒ½åŠ›</h4><ul><li><strong>å¼ºå¤§çš„ç”Ÿæˆèƒ½åŠ›</strong>ï¼š <ul><li>å¤§æ¨¡å‹é€šå¸¸å…·æœ‰æµ·é‡å‚æ•°å’Œä¸°å¯Œçš„è®­ç»ƒæ•°æ®ï¼Œèƒ½å¤Ÿå­¦ä¹ åˆ°å¤æ‚çš„æ•°æ®åˆ†å¸ƒå’Œæ¨¡å¼ã€‚</li><li>è¿™ç§èƒ½åŠ›ä½¿å¾—å¤§æ¨¡å‹å¯ä»¥ç”Ÿæˆé«˜è´¨é‡çš„æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ç­‰å¤šæ¨¡æ€å†…å®¹ã€‚</li></ul></li><li><strong>è·¨æ¨¡æ€ç†è§£ä¸ç”Ÿæˆ</strong><ul><li>ç°ä»£å¤§æ¨¡å‹ï¼ˆå¦‚é€šä¹‰åƒé—®ã€Geminiã€CLIP ç­‰ï¼‰ä¸ä»…æ“…é•¿å•ä¸€æ¨¡æ€ä»»åŠ¡ï¼Œè¿˜èƒ½å®ç°è·¨æ¨¡æ€çš„ç†è§£ä¸ç”Ÿæˆã€‚</li><li>ä¾‹å¦‚ï¼Œé€šè¿‡è¾“å…¥ä¸€æ®µæ–‡æœ¬æè¿°ï¼Œå¤§æ¨¡å‹å¯ä»¥ç”Ÿæˆå¯¹åº”çš„å›¾åƒæˆ–è§†é¢‘ã€‚</li></ul></li><li><strong>é›¶æ ·æœ¬å’Œå°‘æ ·æœ¬å­¦ä¹ </strong><ul><li>å¤§æ¨¡å‹ç»è¿‡å¤§è§„æ¨¡é¢„è®­ç»ƒåï¼Œå…·å¤‡ä¸€å®šçš„é›¶æ ·æœ¬ï¼ˆZero-shotï¼‰å’Œå°‘æ ·æœ¬ï¼ˆFew-shotï¼‰å­¦ä¹ èƒ½åŠ›ã€‚</li><li>è¿™ä½¿å¾— AIGC åº”ç”¨å¯ä»¥åœ¨æ²¡æœ‰å¤§é‡æ ‡æ³¨æ•°æ®çš„æƒ…å†µä¸‹å¿«é€Ÿé€‚åº”æ–°ä»»åŠ¡ã€‚</li></ul></li><li><strong>ä¸Šä¸‹æ–‡ç†è§£å’Œé€»è¾‘æ¨ç†</strong><ul><li>å¤§æ¨¡å‹èƒ½å¤Ÿæ•æ‰é•¿è·ç¦»ä¾èµ–å…³ç³»ï¼Œå¹¶è¿›è¡Œå¤æ‚çš„ä¸Šä¸‹æ–‡ç†è§£å’Œé€»è¾‘æ¨ç†ã€‚</li><li>è¿™ä¸ºç”Ÿæˆè¿è´¯ä¸”æœ‰æ„ä¹‰çš„å†…å®¹æä¾›äº†ä¿éšœã€‚</li></ul></li></ul><h4 id="2-AIGC-æ˜¯å¤§æ¨¡å‹çš„åº”ç”¨åœºæ™¯"><a href="#2-AIGC-æ˜¯å¤§æ¨¡å‹çš„åº”ç”¨åœºæ™¯" class="headerlink" title="2. AIGC æ˜¯å¤§æ¨¡å‹çš„åº”ç”¨åœºæ™¯"></a>2. AIGC æ˜¯å¤§æ¨¡å‹çš„åº”ç”¨åœºæ™¯</h4><ul><li><strong>æ–‡æœ¬ç”Ÿæˆ</strong>ï¼š <ul><li>åŸºäºå¤§æ¨¡å‹çš„æ–‡æœ¬ç”ŸæˆæŠ€æœ¯è¢«å¹¿æ³›åº”ç”¨äºå†™ä½œåŠ©æ‰‹ã€èŠå¤©æœºå™¨äººã€ä»£ç ç”Ÿæˆç­‰é¢†åŸŸã€‚</li><li>ç¤ºä¾‹ï¼šGPT ç³»åˆ—ã€é€šä¹‰åƒé—®ç­‰ã€‚</li></ul></li><li><strong>å›¾åƒç”Ÿæˆ</strong><ul><li>å¤§æ¨¡å‹ç»“åˆæ‰©æ•£æ¨¡å‹ï¼ˆDiffusion Modelï¼‰æˆ–ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰ï¼Œå¯ä»¥ç”Ÿæˆé«˜è´¨é‡çš„å›¾åƒã€‚</li><li>ç¤ºä¾‹ï¼šDALLÂ·Eã€MidJourneyã€Stable Diffusion ç­‰ã€‚</li></ul></li><li><strong>éŸ³é¢‘ç”Ÿæˆ</strong><ul><li>å¤§æ¨¡å‹å¯ç”¨äºç”ŸæˆéŸ³ä¹ã€è¯­éŸ³åˆæˆã€å£°éŸ³æ•ˆæœç­‰ã€‚</li><li>ç¤ºä¾‹ï¼šMusic Transformerã€WaveNet ç­‰ã€‚</li></ul></li><li><strong>è§†é¢‘ç”Ÿæˆ</strong><ul><li>ç»“åˆå¤§æ¨¡å‹å’Œæ—¶åºå»ºæ¨¡æŠ€æœ¯ï¼Œå¯ä»¥ç”ŸæˆåŠ¨æ€çš„è§†é¢‘å†…å®¹ã€‚</li><li>ç¤ºä¾‹ï¼šMake-A-Videoã€Phenaki ç­‰ã€‚</li></ul></li><li><strong>å¤šæ¨¡æ€ç”Ÿæˆ</strong><ul><li>å¤§æ¨¡å‹æ”¯æŒå¤šç§æ¨¡æ€çš„èåˆä¸ç”Ÿæˆï¼Œä¾‹å¦‚ä»æ–‡æœ¬ç”Ÿæˆå›¾åƒæˆ–è§†é¢‘ï¼Œæˆ–å°†å›¾åƒè½¬åŒ–ä¸ºæ–‡æœ¬æè¿°ã€‚</li><li>ç¤ºä¾‹ï¼šFlamingoã€M6 ç­‰ã€‚</li></ul></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>åœ¨vue2çš„é¡¹ç›®ä¸Šä½¿ç”¨vue3çš„åº“</title>
    <link href="/%E5%9C%A8vue2%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%8A%E4%BD%BF%E7%94%A8vue3%E7%9A%84%E5%BA%93/"/>
    <url>/%E5%9C%A8vue2%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%8A%E4%BD%BF%E7%94%A8vue3%E7%9A%84%E5%BA%93/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä¸šåŠ¡åœºæ™¯"><a href="#1-ä¸šåŠ¡åœºæ™¯" class="headerlink" title="1. ä¸šåŠ¡åœºæ™¯"></a>1. ä¸šåŠ¡åœºæ™¯</h1><p>å½“å‰å‰ç«¯é¡¹ç›®æ˜¯åŸºäºvue2çš„ï¼Œä½¿ç”¨çš„pdfé¢„è§ˆçš„ç»„ä»¶ä¸ºvue-pdf-embedï¼Œ ä½†æ˜¯vue2ä¸‹ï¼Œè¿™ä¸ªç»„ä»¶åªå…¼å®¹åˆ°v1ç‰ˆæœ¬ï¼Œä¼šæœ‰xssæ¼æ´ï¼Œåœ¨vue3ä¸‹å¯¹åº”çš„v2ç‰ˆæœ¬æ‰ä¿®å¤äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p>ç”±äºé¡¹ç›®æ˜¯ä¸ªå¾ˆè€çš„é¡¹ç›®ï¼Œæ•´ä½“å‡çº§vue3å·¥ä½œé‡å¤ªå¤§ï¼Œæ‰€ä»¥é€‰æ‹©ä½¿ç”¨Web Components å°è£…ç»„ä»¶çš„æ–¹å¼ï¼Œå°†vue-pdf-embed å°è£…ä¸ºä¸€ä¸ª Web Componentï¼Œç„¶ååœ¨ Vue 2 ä¸­ä½¿ç”¨ã€‚</p><h1 id="2-æ­¥éª¤"><a href="#2-æ­¥éª¤" class="headerlink" title="2. æ­¥éª¤"></a>2. æ­¥éª¤</h1><h2 id="1-åˆ›å»ºä¸€ä¸ª-ç‹¬ç«‹çš„Vue-3-é¡¹ç›®"><a href="#1-åˆ›å»ºä¸€ä¸ª-ç‹¬ç«‹çš„Vue-3-é¡¹ç›®" class="headerlink" title="1. åˆ›å»ºä¸€ä¸ª ç‹¬ç«‹çš„Vue 3 é¡¹ç›®"></a>1. åˆ›å»ºä¸€ä¸ª ç‹¬ç«‹çš„Vue 3 é¡¹ç›®</h2><ol><li>åˆ›å»ºé¡¹ç›® <code>vue create simple-vue3-project</code></li><li>åœ¨ Vue 3 é¡¹ç›®ä¸­å®‰è£… vue-pdf-embed <code>npm install vue-pdf-embed</code></li></ol><h2 id="2-åˆ›å»º-Web-Components-å°è£…"><a href="#2-åˆ›å»º-Web-Components-å°è£…" class="headerlink" title="2. åˆ›å»º Web Components å°è£…"></a>2. åˆ›å»º Web Components å°è£…</h2><ol><li><p>åˆ›å»ºPdfViewer.ce.vueæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;vue-pdf-embed :source=&quot;source&quot;/&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br>import VuePdfEmbed from &#x27;vue-pdf-embed&#x27;;<br><br>export default &#123;<br>    props: &#123;<br>        source: &#123;<br>            type: String,<br>            required: true,<br>        &#125;,<br>    &#125;,<br>    components: &#123;<br>        VuePdfEmbed,<br>    &#125;,<br>&#125;;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure></li><li><p>åœ¨ Vue 3 é¡¹ç›®çš„å…¥å£æ–‡ä»¶ï¼ˆå¦‚ main.jsï¼‰ä¸­æ³¨å†Œ Web Componentsã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123;defineCustomElement&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><br><span class="hljs-keyword">import</span> PdfViewer <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./components/PdfViewer.ce.vue&#x27;</span>;<br><br><span class="hljs-comment">// å°† Vue ç»„ä»¶å°è£…ä¸º Web Component</span><br><span class="hljs-keyword">const</span> PdfViewerElement = defineCustomElement(PdfViewer);<br><br><span class="hljs-comment">// æ³¨å†Œè‡ªå®šä¹‰å…ƒç´ </span><br>customElements.define(<span class="hljs-string">&#x27;pdf-viewer&#x27;</span>, PdfViewerElement);<br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Web Component registered:&#x27;</span>, customElements.get(<span class="hljs-string">&#x27;pdf-viewer&#x27;</span>));<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä¸ºäº†å‡å°jsæ–‡ä»¶å¤§å°ï¼Œè¿™é‡Œæˆ‘åˆ é™¤äº†main.jsæ¨¡ç‰ˆçš„æœ¬èº«å†…å®¹</p></li><li><p>ä¿®æ”¹vue.config.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; defineConfig &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@vue/cli-service&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = defineConfig(&#123;<br>  <span class="hljs-attr">transpileDependencies</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ç¡®ä¿ä¾èµ–åº“è¢«æ­£ç¡®è½¬è¯‘</span><br><br>  <span class="hljs-attr">configureWebpack</span>: &#123;<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/main.js&#x27;</span>, <span class="hljs-comment">// æŒ‡å®šå…¥å£æ–‡ä»¶</span><br>    <span class="hljs-attr">output</span>: &#123;<br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;pdf-viewer.js&#x27;</span>, <span class="hljs-comment">// è¾“å‡ºæ–‡ä»¶å</span><br>      <span class="hljs-attr">library</span>: <span class="hljs-string">&#x27;PdfViewer&#x27;</span>, <span class="hljs-comment">// è®¾ç½®ç”Ÿæˆçš„åº“åç§°</span><br>      <span class="hljs-attr">libraryTarget</span>: <span class="hljs-string">&#x27;window&#x27;</span>, <span class="hljs-comment">// å°†åº“æŒ‚è½½åˆ° window ä¸Š</span><br>      <span class="hljs-attr">globalObject</span>: <span class="hljs-string">&#x27;this&#x27;</span>, <span class="hljs-comment">// å…¼å®¹éæµè§ˆå™¨ç¯å¢ƒï¼ˆå¦‚ Node.jsï¼‰</span><br>    &#125;,<br>    <span class="hljs-attr">optimization</span>: &#123;<br>      <span class="hljs-attr">splitChunks</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// ç¦ç”¨ä»£ç åˆ†å‰²</span><br>    &#125;,<br>  &#125;,<br><br>  <span class="hljs-attr">css</span>: &#123;<br>    <span class="hljs-attr">extract</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">loaderOptions</span>: &#123;<br>      <span class="hljs-attr">css</span>: &#123;<br>        <span class="hljs-attr">minimize</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å‹ç¼© CSS</span><br>      &#125;,<br>    &#125;,<br>  &#125;,<br><br>  <span class="hljs-attr">productionSourceMap</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// å…³é—­ç”Ÿäº§ç¯å¢ƒä¸‹çš„ source mapï¼Œå‡å°‘æ–‡ä»¶å¤§å°</span><br>&#125;);<br></code></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨npm run buildæ„å»ºæˆä¸€ä¸ªjsæ–‡ä»¶å¦‚ ï¼ˆdist&#x2F;pdf-viewer.jsï¼‰ï¼Œå…¶ä¸­åŒ…å«äº†å°è£…å¥½çš„ Web Componentsã€‚</p></li></ol><h2 id="3-åœ¨-Vue-2-é¡¹ç›®ä¸­ä½¿ç”¨-Web-Components"><a href="#3-åœ¨-Vue-2-é¡¹ç›®ä¸­ä½¿ç”¨-Web-Components" class="headerlink" title="3. åœ¨ Vue 2 é¡¹ç›®ä¸­ä½¿ç”¨ Web Components"></a>3. åœ¨ Vue 2 é¡¹ç›®ä¸­ä½¿ç”¨ Web Components</h2><ol><li><p>å°†æ‰“åŒ…å¥½çš„jsæ–‡ä»¶æ”¾åœ¨ï¼Œpublicç›®å½•ä¸‹</p></li><li><p>åœ¨index.htmlä¸­å¼•å…¥</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- public/index.html --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;module&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/pdf-viewer.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>åœ¨å…¶ä»–è§†å›¾æˆ–ç»„ä»¶ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;pdf-viewer :source=&quot;url&quot; class=&quot;m-auto&quot;&gt;&lt;/pdf-viewer&gt;<br></code></pre></td></tr></table></figure></li><li><p>åœ¨main.js å¿½ç•¥è¿™ä¸ªè‡ªå®šä¹‰å…ƒç´ ï¼Œé¿å…æŠ¥é”™</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">Vue.config.ignoredElements = [<span class="hljs-string">&#x27;pdf-viewer&#x27;</span>];<br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xssè·¨ç«™æ¼æ´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javaç¦æ­¢ä¸Šä¼ å¸¦æœ‰jsè„šæœ¬çš„pdfæ–‡ä»¶</title>
    <link href="/java%E7%A6%81%E6%AD%A2%E4%B8%8A%E4%BC%A0%E5%B8%A6%E6%9C%89js%E8%84%9A%E6%9C%AC%E7%9A%84pdf%E6%96%87%E4%BB%B6/"/>
    <url>/java%E7%A6%81%E6%AD%A2%E4%B8%8A%E4%BC%A0%E5%B8%A6%E6%9C%89js%E8%84%9A%E6%9C%AC%E7%9A%84pdf%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<p>é˜²æ­¢ä¸Šä¼ çš„pdfæ–‡ä»¶ä¸­ï¼ŒåŒ…å«å±å®³çš„Java scriptï¼Œå¯¼è‡´çš„XSSæ¼æ´</p><h1 id="1-å¼•å…¥ä¾èµ–"><a href="#1-å¼•å…¥ä¾èµ–" class="headerlink" title="1. å¼•å…¥ä¾èµ–"></a>1. å¼•å…¥ä¾èµ–</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.pdfbox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>pdfbox<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.27<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h1 id="2-ç¼–å†™å·¥å…·ç±»"><a href="#2-ç¼–å†™å·¥å…·ç±»" class="headerlink" title="2. ç¼–å†™å·¥å…·ç±»"></a>2. ç¼–å†™å·¥å…·ç±»</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.siemens.mmf.sith.utils;<br><br><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;<br><span class="hljs-keyword">import</span> org.apache.pdfbox.cos.COSArray;<br><span class="hljs-keyword">import</span> org.apache.pdfbox.cos.COSDictionary;<br><span class="hljs-keyword">import</span> org.apache.pdfbox.cos.COSName;<br><span class="hljs-keyword">import</span> org.apache.pdfbox.cos.COSString;<br><span class="hljs-keyword">import</span> org.apache.pdfbox.pdmodel.PDDocument;<br><span class="hljs-keyword">import</span> org.apache.pdfbox.pdmodel.PDPage;<br><span class="hljs-keyword">import</span> org.apache.pdfbox.pdmodel.PDPageTree;<br><span class="hljs-keyword">import</span> org.apache.pdfbox.pdmodel.PDResources;<br><span class="hljs-keyword">import</span> org.apache.pdfbox.pdmodel.font.PDFont;<br><span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.regex.Pattern;<br><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PdfFileUtil</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Pattern JAVASCRIPT_PATTERN = Pattern.compile(<span class="hljs-string">&quot;(?i)javascript|alert\\(|document\\.|window\\.&quot;</span>);<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ£€æŸ¥PDFé¡µé¢å¯¹è±¡å’Œé¡µé¢ä¸­çš„å­—ä½“èµ„æº æ˜¯å¦å«æœ‰æ¶æ„çš„ JavaScriptä»£ç </span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasXSS</span><span class="hljs-params">(MultipartFile multipartFile)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            PDDocument document = PDDocument.load(multipartFile.getInputStream());<br>            PDPageTree pages = document.getPages();<br>            <span class="hljs-keyword">for</span> (PDPage page : pages) &#123;<br>                <span class="hljs-keyword">if</span> (hasXSS(page.getCOSObject())) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>                &#125;<br>                PDResources resources = page.getResources();<br>                <span class="hljs-keyword">if</span> (resources != <span class="hljs-keyword">null</span>) &#123;<br>                    <span class="hljs-keyword">for</span> (COSName fontName : resources.getFontNames()) &#123;<br>                        PDFont font = resources.getFont(fontName);<br>                        <span class="hljs-keyword">if</span> (font != <span class="hljs-keyword">null</span> &amp;&amp; hasXSS(font.getCOSObject())) &#123;<br>                            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            log.error(<span class="hljs-string">&quot;read line exception&quot;</span> + e.getMessage());<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ£€æŸ¥JavaScriptå¹¶é€’å½’æ£€æŸ¥åµŒå¥—å¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasXSS</span><span class="hljs-params">(COSDictionary obj)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (obj.containsKey(COSName.JAVA_SCRIPT)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        &#125;<br>        <span class="hljs-comment">// é€’å½’åœ°æ£€æŸ¥å­—å…¸ä¸­çš„æ‰€æœ‰åµŒå¥—å¯¹è±¡</span><br>        <span class="hljs-keyword">for</span> (COSName key : obj.keySet()) &#123;<br>            Object value = obj.getItem(key);<br>            <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> COSDictionary) &#123;<br>                <span class="hljs-keyword">if</span> (hasXSS((COSDictionary) value)) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> COSArray) &#123;<br>                <span class="hljs-keyword">if</span> (checkArrayHasXSS((COSArray) value)) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br><br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">checkArrayHasXSS</span><span class="hljs-params">(COSArray array)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; array.size(); i++) &#123;<br>            Object element = array.get(i);<br>            <span class="hljs-keyword">if</span> (element <span class="hljs-keyword">instanceof</span> COSString &amp;&amp; hasXSS(((COSString) element).getString())) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (element <span class="hljs-keyword">instanceof</span> COSDictionary) &#123;<br>                <span class="hljs-keyword">if</span> (hasXSS((COSDictionary) element)) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (element <span class="hljs-keyword">instanceof</span> COSArray) &#123;<br>                <span class="hljs-keyword">if</span> (checkArrayHasXSS((COSArray) element)) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasXSS</span><span class="hljs-params">(String value)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> JAVASCRIPT_PATTERN.matcher(value).find();<br>    &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure><p>æµ‹è¯•æ–‡ä»¶åœ°å€ï¼š<a href="https://oicu0619.github.io/poc.pdf">pdf</a></p>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·ç±»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xssè·¨ç«™æ¼æ´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker-composeå®æˆ˜</title>
    <link href="/docker-compose%E5%AE%9E%E6%88%98/"/>
    <url>/docker-compose%E5%AE%9E%E6%88%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å¸¸ç”¨å‘½ä»¤"><a href="#1-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="1. å¸¸ç”¨å‘½ä»¤"></a>1. å¸¸ç”¨å‘½ä»¤</h1><ol><li><p>å‰å°å¯åŠ¨, å¯åŠ¨é¡¹ç›®ä¸­çš„æ‰€æœ‰æœåŠ¡ <code>docker-compose up</code></p></li><li><p>åå°å¯åŠ¨, å¯åŠ¨æ‰€æœ‰æœåŠ¡å¹¶åœ¨åå°è¿è¡Œ <code>docker-compose up -d</code></p></li><li><p>é‡æ–°ç¼–è¯‘æ–‡ä»¶å¹¶å¯åŠ¨  <code>docker-compose up --build nginx </code></p></li><li><p>åœæ­¢æ‰€æœ‰æœåŠ¡, ä¿ç•™å®¹å™¨<code>docker-compose stop </code></p></li><li><p>åœæ­¢æ‰€æœ‰æœåŠ¡, åˆ é™¤å®¹å™¨<code>docker-compose down</code></p></li><li><p>åˆ é™¤å®¹å™¨<code>docker-compose rm -f nginx</code></p></li><li><p>é‡å¯å®¹å™¨</p><ul><li>é‡å¯æ‰€æœ‰æœåŠ¡çš„å®¹å™¨ <code>docker-compose restart</code></li><li>é‡å¯æŒ‡å®šæœåŠ¡çš„å®¹å™¨ <code>docker-compose restart nginx </code></li></ul></li><li><p>å¯åŠ¨å®¹å™¨</p><ul><li>å¯åŠ¨æ‰€æœ‰æœåŠ¡çš„å®¹å™¨ <code>docker-compose start </code></li><li>å¯åŠ¨æŒ‡å®šæœåŠ¡çš„å®¹å™¨ <code>docker-compose start nginx </code></li></ul></li><li><p>åœæ­¢å®¹å™¨</p><ul><li>åœæ­¢æ‰€æœ‰æœåŠ¡çš„å®¹å™¨<code> docker-compose stop</code></li><li>åœæ­¢æŒ‡å®šæœåŠ¡çš„å®¹å™¨ <code>docker-compose stop nginx </code></li></ul></li><li><p>è¿›å…¥å®¹å™¨</p></li></ol><ul><li><code>è¿›å…¥æŒ‡å®šæœåŠ¡çš„å®¹å™¨</code> <code>docker-compose exec nginx bash</code></li></ul><h1 id="2-å®æˆ˜ä½¿ç”¨"><a href="#2-å®æˆ˜ä½¿ç”¨" class="headerlink" title="2. å®æˆ˜ä½¿ç”¨"></a>2. å®æˆ˜ä½¿ç”¨</h1><p>éƒ¨ç½²é¡¹ç›®tms</p><h2 id="1-å‡†å¤‡å·¥ä½œ"><a href="#1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="1. å‡†å¤‡å·¥ä½œ"></a>1. å‡†å¤‡å·¥ä½œ</h2><ol><li><p>åœ¨ç›®å½•home&#x2F;userxxx ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹ tmsåŠç›¸å…³å‰åç«¯æ–‡ä»¶å¤¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir tms<br>cd tms<br>mkdir deploy<br>cd deploy<br>mkdir backend<br>mkdir frontend<br></code></pre></td></tr></table></figure></li><li><p>å®‰è£…docker, docker-compose</p><p>Docker æ³¨æ„ä¿®æ”¹é»˜è®¤æŒ‚è½½åœ°å€</p></li></ol><h2 id="2-éƒ¨ç½²ä¸­é—´ä»¶"><a href="#2-éƒ¨ç½²ä¸­é—´ä»¶" class="headerlink" title="2. éƒ¨ç½²ä¸­é—´ä»¶"></a>2. éƒ¨ç½²ä¸­é—´ä»¶</h2><ol><li><p>middlewareç›®å½•ä¸‹ä¸Šä¼ docker-compose.yml</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">cd</span> deploy<br><span class="hljs-built_in">mkdir</span> middleware<br></code></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨<code>docker-compose up prod</code>å¯åŠ¨redisï¼ŒrabbitMQï¼Œpostgresql(éœ€å¼€æ”¾å¯¹åº”ç«¯å£æˆ–åç»­ä¿®æ”¹nginxé…ç½®é€šè¿‡nginxè®¿é—®)</p><p>docker-compose.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">networks:</span><br>  <span class="hljs-attr">tms:</span><br>    <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">rabbitmq:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">rabbitmq:3-management-alpine</span><br>    <span class="hljs-attr">hostname:</span> <span class="hljs-string">rabbitmq</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">rabbitmq</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">RABBITMQ_DEFAULT_USER:</span> <span class="hljs-string">guest</span><br>      <span class="hljs-attr">RABBITMQ_DEFAULT_PASS:</span> <span class="hljs-string">guest</span><br>      <span class="hljs-attr">TZ:</span> <span class="hljs-string">Asia/Shanghai</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;5672:5672&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;15672:15672&quot;</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/etc/localtime:/etc/localtime:ro</span><br><br>  <span class="hljs-attr">redis:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">redis</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">redis</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">6379</span><span class="hljs-string">:6379</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">TZ:</span> <span class="hljs-string">Asia/Shanghai</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/etc/localtime:/etc/localtime:ro</span><br><br>  <span class="hljs-attr">nginx:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">nginx:latest</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">nginx</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;80:80&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;443:443&quot;</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./nginx/config/nginx.conf:/etc/nginx/nginx.conf</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./nginx/config/conf.d:/etc/nginx/conf.d</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./nginx/ssl:/etc/nginx/ssl</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./nginx/logs:/var/log/nginx</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./nginx/html:/usr/share/nginx/html</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">../frontend:/home/deploy/tms/frontend</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/etc/localtime:/etc/localtime:ro</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">TZ:</span> <span class="hljs-string">Asia/Shanghai</span><br><br>  <span class="hljs-attr">mysql:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:8.0</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">mysql</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">xxl_job</span><br>      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">root</span><br>      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">root@1234</span><br>      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">root@1234</span><br>      <span class="hljs-attr">TZ:</span> <span class="hljs-string">Asia/Shanghai</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3306:3306&quot;</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql_data:/var/lib/mysql</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/etc/localtime:/etc/localtime:ro</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br></code></pre></td></tr></table></figure></li></ol><h2 id="3-éƒ¨ç½²vue"><a href="#3-éƒ¨ç½²vue" class="headerlink" title="3. éƒ¨ç½²vue"></a>3. éƒ¨ç½²vue</h2><ol><li><p>è¿›å…¥å‰ç«¯ç›®å½•ï¼Œä¸Šä¼ distç›®å½•åˆ°webç›®å½•</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">cd</span> frontend<br><span class="hljs-built_in">mkdir</span> web<br></code></pre></td></tr></table></figure></li><li><p>æ›´æ–°nginx.confé…ç½®, å¹¶é‡å¯</p></li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-string">user</span>  <span class="hljs-string">nginx;</span><br><span class="hljs-string">worker_processes</span>  <span class="hljs-string">auto;</span><br><br><span class="hljs-string">error_log</span>  <span class="hljs-string">/var/log/nginx/error.log</span> <span class="hljs-string">notice;</span><br><span class="hljs-string">pid</span>        <span class="hljs-string">/var/run/nginx.pid;</span><br><br><br><span class="hljs-string">events</span> &#123;<br>    <span class="hljs-string">worker_connections</span>  <span class="hljs-number">1024</span><span class="hljs-string">;</span><br>&#125;<br><br><br><span class="hljs-string">http</span> &#123;<br>    <span class="hljs-string">include</span>       <span class="hljs-string">/etc/nginx/mime.types;</span><br>    <span class="hljs-string">default_type</span>  <span class="hljs-string">application/octet-stream;</span><br><br>    <span class="hljs-string">log_format</span>  <span class="hljs-string">main</span>  <span class="hljs-string">&#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br>                      <span class="hljs-string">&#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br>                      <span class="hljs-string">&#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;</span><span class="hljs-string">;</span><br><br>    <span class="hljs-string">access_log</span>  <span class="hljs-string">/var/log/nginx/access.log</span>  <span class="hljs-string">main;</span><br><br>    <span class="hljs-string">sendfile</span>        <span class="hljs-string">on;</span><br>    <span class="hljs-comment">#tcp_nopush     on;</span><br><span class="hljs-string">autoindex</span> <span class="hljs-string">on;</span><br><br>    <span class="hljs-string">keepalive_timeout</span>  <span class="hljs-number">65</span><span class="hljs-string">;</span><br><br>    <span class="hljs-comment">#gzip  on;</span><br><br><span class="hljs-string">upstream</span> <span class="hljs-string">gatewayservice</span> &#123;<br><span class="hljs-string">server</span> <span class="hljs-number">10.64</span><span class="hljs-number">.192</span><span class="hljs-number">.112</span><span class="hljs-string">:8001;</span><br>&#125;<br><span class="hljs-string">upstream</span> <span class="hljs-string">xxlJobAdmin</span> &#123;<br><span class="hljs-string">server</span> <span class="hljs-number">10.64</span><span class="hljs-number">.192</span><span class="hljs-number">.112</span><span class="hljs-string">:8200;</span><br>&#125;<br><span class="hljs-string">upstream</span> <span class="hljs-string">kibanaService</span> &#123;<br><span class="hljs-string">server</span> <span class="hljs-number">10.64</span><span class="hljs-number">.192</span><span class="hljs-number">.112</span><span class="hljs-string">:5601;</span><br>&#125;<br><span class="hljs-string">upstream</span> <span class="hljs-string">gitlabService</span> &#123;<br><span class="hljs-string">server</span> <span class="hljs-number">10.64</span><span class="hljs-number">.192</span><span class="hljs-number">.112</span><span class="hljs-string">:8090;</span><br>&#125;<br><span class="hljs-string">upstream</span> <span class="hljs-string">rabbitmqService</span> &#123;<br><span class="hljs-string">server</span> <span class="hljs-number">10.64</span><span class="hljs-number">.192</span><span class="hljs-number">.112</span><span class="hljs-string">:15672;</span><br>&#125;<br><br>    <span class="hljs-string">server</span> &#123;<br>        <span class="hljs-string">listen</span>       <span class="hljs-number">80</span><span class="hljs-string">;</span><br>        <span class="hljs-string">server_name</span>  <span class="hljs-string">plm.innomotics.net.cn;</span><br>        <span class="hljs-string">rewrite</span> <span class="hljs-string">^(.*)$</span> <span class="hljs-string">https://$host$1</span> <span class="hljs-string">permanent;</span><br>    &#125;<br><br><br>    <span class="hljs-string">server</span> &#123;<br>        <span class="hljs-string">listen</span>       <span class="hljs-number">443</span> <span class="hljs-string">ssl;</span><br>        <span class="hljs-string">server_name</span>  <span class="hljs-string">plm.innomotics.net.cn;</span><br><br><span class="hljs-comment">#sslè¯ä¹¦çš„pemæ–‡ä»¶è·¯å¾„</span><br>        <span class="hljs-string">ssl_certificate</span>  <span class="hljs-string">/etc/nginx/ssl/S0004A05_plm.innomotics.net.cn.cer;</span><br>        <span class="hljs-comment">#sslè¯ä¹¦çš„keyæ–‡ä»¶è·¯å¾„</span><br>        <span class="hljs-string">ssl_certificate_key</span> <span class="hljs-string">/etc/nginx/ssl/plm.innomotics.net.cn.key;</span><br><br>        <span class="hljs-string">proxy_set_header</span>   <span class="hljs-string">X-Real-IP</span> <span class="hljs-string">$remote_addr;</span><br>        <span class="hljs-string">proxy_set_header</span>   <span class="hljs-string">X-Forwarded-For</span> <span class="hljs-string">$proxy_add_x_forwarded_for;</span><br>        <span class="hljs-string">proxy_set_header</span>   <span class="hljs-string">X-Forwarded-Host</span> <span class="hljs-string">$server_name;</span><br><br>        <span class="hljs-comment"># Header for SocketJS</span><br>        <span class="hljs-string">proxy_http_version</span> <span class="hljs-number">1.1</span><span class="hljs-string">;</span><br>        <span class="hljs-string">proxy_set_header</span> <span class="hljs-string">Upgrade</span> <span class="hljs-string">$http_upgrade;</span><br>        <span class="hljs-string">proxy_set_header</span> <span class="hljs-string">Connection</span> <span class="hljs-string">&quot;upgrade&quot;</span><span class="hljs-string">;</span><br>        <span class="hljs-string">add_header</span> <span class="hljs-string">Strict-Transport-Security</span> <span class="hljs-string">&quot;max-age=31536000; includeSubDomains&quot;</span> <span class="hljs-string">always;</span><br><br>        <span class="hljs-comment"># è®¿é—®æ‰€æœ‰ç›®å½•éƒ½é»˜è®¤èµ°åˆ°</span><br>        <span class="hljs-string">location</span> <span class="hljs-string">/</span> &#123;<br>            <span class="hljs-string">root</span>   <span class="hljs-string">/home/deploy/tms/frontend/prod;</span><br>            <span class="hljs-string">index</span>  <span class="hljs-string">index.html</span> <span class="hljs-string">index.htm;</span><br>            <span class="hljs-string">add_header</span> <span class="hljs-string">&quot;Access-Control-Allow-Origin&quot;</span>  <span class="hljs-string">*;</span><br>            <span class="hljs-string">try_files</span> <span class="hljs-string">$uri</span> <span class="hljs-string">$uri/</span> <span class="hljs-string">/index.html;</span><br>        &#125;   <br>        <span class="hljs-string">location</span> <span class="hljs-string">/api</span> &#123;<br>    <span class="hljs-string">rewrite</span> <span class="hljs-string">^/api/(.*)$</span> <span class="hljs-string">/$1</span> <span class="hljs-string">break;</span><br>          <span class="hljs-string">proxy_pass</span>         <span class="hljs-string">http://gatewayservice;</span><br><span class="hljs-string">proxy_redirect</span>     <span class="hljs-string">off;</span><br>        &#125;<br>        <span class="hljs-string">location</span> <span class="hljs-string">/xxl-job-admin/</span> &#123;<br>          <span class="hljs-string">proxy_pass</span><span class="hljs-string">http://xxlJobAdmin;</span><br>          <span class="hljs-string">proxy_redirect</span><span class="hljs-string">off;</span><br>        &#125;<br>        <span class="hljs-string">location</span> <span class="hljs-string">/so-kibana/</span>&#123;<br>          <span class="hljs-string">proxy_pass</span><span class="hljs-string">http://kibanaService;</span><br>          <span class="hljs-string">proxy_redirect</span><span class="hljs-string">off;</span><br>        &#125;<br>        <span class="hljs-string">location</span> <span class="hljs-string">/so-gitlab/</span>&#123;<br>          <span class="hljs-string">proxy_pass</span><span class="hljs-string">http://gitlabService;</span><br>          <span class="hljs-string">proxy_redirect</span><span class="hljs-string">off;</span><br>        &#125;<br>        <span class="hljs-string">location</span> <span class="hljs-string">/so-rabbitmq/</span>&#123;<br>          <span class="hljs-string">rewrite</span> <span class="hljs-string">^/so-rabbitmq/(.*)</span> <span class="hljs-string">/$1</span> <span class="hljs-string">break;</span> <br>          <span class="hljs-string">proxy_pass</span><span class="hljs-string">http://rabbitmqService;</span><br>          <span class="hljs-string">proxy_redirect</span><span class="hljs-string">off;</span><br>        &#125;<br>        <span class="hljs-string">location</span> <span class="hljs-string">@router</span> &#123;<br>          <span class="hljs-string">rewrite</span> <span class="hljs-string">^.*$</span> <span class="hljs-string">/index.html</span> <span class="hljs-string">last;</span><br>        &#125; <br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4-docker-composeéƒ¨ç½²åç«¯"><a href="#4-docker-composeéƒ¨ç½²åç«¯" class="headerlink" title="4. docker-composeéƒ¨ç½²åç«¯"></a>4. docker-composeéƒ¨ç½²åç«¯</h2><ol><li><p>backendå¯¹åº”ç›®å½•ä¸‹ä¸Šä¼ jaråŒ…å’Œdocker-compose.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">networks:</span><br>  <span class="hljs-attr">tms:</span><br>    <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">eureka-server:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">openjdk:17</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">eureka-server</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;8002:8002&quot;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./eureka-server:/home</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">SPRING_PROFILES_ACTIVE=prod</span><br>    <span class="hljs-attr">command:</span> [<span class="hljs-string">&quot;java&quot;</span>, <span class="hljs-string">&quot;-jar&quot;</span>, <span class="hljs-string">&quot;/home/eureka-server-1.0-SNAPSHOT.jar&quot;</span>]<br><br>  <span class="hljs-attr">gateway-server:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">openjdk:17</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">gateway-server</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;8001:8001&quot;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./gateway-server:/home</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">SPRING_PROFILES_ACTIVE=prod</span><br>    <span class="hljs-attr">command:</span> [<span class="hljs-string">&quot;java&quot;</span>, <span class="hljs-string">&quot;-jar&quot;</span>, <span class="hljs-string">&quot;/home/gateway-server-1.0-SNAPSHOT.jar&quot;</span>]<br><br>  <span class="hljs-attr">auth-service:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">openjdk:17</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">auth-service</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;8003:8003&quot;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./auth-service:/home</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">SPRING_PROFILES_ACTIVE=prod</span><br>    <span class="hljs-attr">command:</span> [<span class="hljs-string">&quot;java&quot;</span>, <span class="hljs-string">&quot;-jar&quot;</span>, <span class="hljs-string">&quot;/home/auth-service-1.0-SNAPSHOT.jar&quot;</span>]<br><br>  <span class="hljs-attr">user-service:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">openjdk:17</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">user-service</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;8101:8101&quot;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./user-service:/home</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">SPRING_PROFILES_ACTIVE=prod</span><br>    <span class="hljs-attr">command:</span> [<span class="hljs-string">&quot;java&quot;</span>, <span class="hljs-string">&quot;-jar&quot;</span>, <span class="hljs-string">&quot;/home/user-service-1.0-SNAPSHOT.jar&quot;</span>]<br><br>  <span class="hljs-attr">assistant-service:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">openjdk:17</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">assistant-service</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;8004:8004&quot;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./assistant-service:/home</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">SPRING_PROFILES_ACTIVE=prod</span><br>    <span class="hljs-attr">command:</span> [<span class="hljs-string">&quot;java&quot;</span>, <span class="hljs-string">&quot;-jar&quot;</span>, <span class="hljs-string">&quot;/home/assistant-service-1.0-SNAPSHOT.jar&quot;</span>]<br><br>  <span class="hljs-attr">tms-service:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">openjdk:17</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">tms-service</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;8103:8103&quot;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./tms-service:/home</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">SPRING_PROFILES_ACTIVE=prod</span><br>    <span class="hljs-attr">command:</span> [<span class="hljs-string">&quot;java&quot;</span>, <span class="hljs-string">&quot;-jar&quot;</span>, <span class="hljs-string">&quot;/home/tms-service-1.0-SNAPSHOT.jar&quot;</span>]<br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>docker</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åœºæ™¯é¢˜</title>
    <link href="/%E5%9C%BA%E6%99%AF%E9%A2%98/"/>
    <url>/%E5%9C%BA%E6%99%AF%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="880f1ca7e6e3202ccc43714be7d8959b35473292c2136f762ef76dd6fd3c64c8">ffda66bfab181c2acf199c136e56147374682d524a8b022b9f8c35ea0638a7c090fb0898ae6bb2aa2ea7308973392d5a21b5b1329ec9fabf4fa205482703467268be04cc0d38e1c07ac607232452007c3bbccd6bb1abf7abe3777f2d7135e6f6ef151f4a0659b15ce60db48816db7ab84132d1ebeafa1b324ea74c7dd076b5e3342d2d638106fb208150994628031e9f9333a9c375ca9e3d460df31e68612232890856b5ac91856841266644441c06c689f019ee745fe7fe3cb4756a08faee10e8557bf67a7c27b869ce98c4a60b831fcbe9d8782ef57330cb9e84d9f16e504b75c26b0ca98fcf8206693c7ef20b95bc9c89bae3e002ecb4d57cf355925f347ead2a829faf28cf0630e7b820d62dfcbfc63d37b76f2b25c748b306cee723d9bebd68c13d1496d8e51ffdd30f80219d3ad7fcd4fc12fc63d55580406fcd49709736dd42fc45cc76b74f8887a56229c66bb552227796102b3ea9ba75c44762fe93dbc0d66cc54ae8d2d89dd959d5090edbec7ce59ddeb6d560cc6f689cda2d98dce93f1fbb544400ee80e0d1b673b12534c51e45996e97f9bf3ccd11e1506f0e153629f7d37c798c64213a5add16f2fc417274d892a0b4da394ba43485ee0da5df979b3ae7ca2cdcbdbec0e9c303ec384d889aa0ab6099943a5d388063bc63d3edd226a3119cc2fe7266e8141492f57d33d609ffb578bfbd5f1e9d86dd491ba1858ab1208208e0d9cdef83cafbd8db19754e1d6abe57caef1e942d9c16c79192b258d7f2bab995588f3459c06e2627e0a41e8aefc53765ef831e33cab1a75fdaad5ebe4f5859394799123877ee6dbb2f26f51fb5926db8a9414376dd9b11f8b564a2463912010c00d7a0579f0f851f9d8d8c9caee7690bdf532c63fc16ab0626d0cbb1dee9ce61aa7f59a3faed0cda51aa9cc571815adb2b072717f2adb4b696e2d8679244053b5d872002f8e536226237306e0228438deb0380edb9dd95d4531631b0b57daeddd1480ec7e9a889ae0be5f3303f8f46b03007b13ce63d61908c785964e5f56a1c4d43312aba9c8bf14f719e418ba1811d4a63a29a9a1c735515bf4f9e333a8a984d58fc22ff862ae1317a8b9659a1fcc026ec7835b2b267696717c445b7edb8cc4fd01f50def89c7bc4829a7828f479fb690aa8113c14223c6f9e0e7965a0ad938e939fbc275d92ff7a927ed2b84499ac45c78d5c8d78d992422ed6ff9e763a009d83846fbe1fb87e7dcebbad17514cb851907c8bb25c70c8ac7bcfd787777178cf4bf716137ef8950463488ec90219bb609fa8024505ff58517749ff01af6dc0ad19ee2a887565b8573562243595b320c02b6df66ec4ef9c0a1d50fc827381aba870e34a9deab1964d7b015ad473dc145eb4115fdfe6d16457549ea5cc5a3b76bf42ddb9e89c87216278196cdad07ef97b8a228b4fd0ffc2dd8956b97d13f25472064be0995760211e607a4b3200ea088a8d8279635f4ce7da9ec091432ad5f61262960eae92ec21cc92c82c599f63cf1480c16f4e5a4709380e72e4346806f85c7975505670a13155b822becacd80adbdc55c0c75ee14c516d859bc536b7c8beba10881f438b4e3758d793a47a0df7e7a1af128aaa08d5cca421e66fca02cf8fb08041393d9d9daeccff42b0f786644b6a4dc163aca16bd5026cfd1a8a75615f52adefb79c2fb05615af3019e33c5cfbe92d016fa0a1417b36c5d0a17cef8bfc5b16d71a08c2aaeb43aef1fd7fbad34a2a21e321043898db72ef524863cf9562aaed3ee6163211c4cca2c441ea7d4d68e7a65abf6affad46df68e063b1d8025a10bffba46787052404908a6bb844eb5f8714738a8c3092fbb71a8d95cc5eb082611a481efc9c4fe9a115a2e9bf87a3e70764a93bad81ec606da159bbe09d7ac3f3fbdcec02f4b10109227d733154a2614f7ff51f62421d8df128b61d86f106f5818bbdce73e63dc927258bf92fd57de7f792f9255617598361d9058ea33be8fcfcb3b257d8212511a8f52652e485cc51ad7c8d0912c7c795ae88badf32cf507b82ee52da672dc3302ddd8dc1afe477ced1e634d16c5bba2dea86f30bb92b956ac9203b7d6280d3702ab6ae10b1f28cdecc79007855328695095e5ff8faea7924c4778159d48ea859490fbd8ca47de7cc90ddd1b5f2d5180f677f4c68b2548f53d363252eecc61b44e1be00d1612188aa84630ceb322839ebe8a535cec77450c5ea1370b7de6d86ea5b4f0a4de2a82a90cc1460e2c617359951c2ac4c7f439bccddff4e9aa082a8080680c93802c528feae8a481afa47e6bdda524c489e11d93c17b26ff2d4a02787eaf6726713f58c335b3a75a8e71ff617db1ea6b0192139e74dfec512bd4f9d79d4f79742dadae3f9951383a9e66abd95f32372540a5ae6e82c0a6d390f16078877452f475056c19799ba3df01ab45ed70c6d0ce4e47e341fba393b39495419e1ec3a99d6c03c4e2aeccd7a1928e9bdc298596199af5d257635041950fef427bf62c1b304e93002bc0084b4d5a93b9628e8a6f77b0be106e13d218f793bd6f8130ebda736f1b6edadd9ca9cb555b90ba97d19da39eb1293b1dc9a043f113aeffe6024f6588cec330623cecf393403457874997e2db8cc41a5b8774bed463b9e7c8eb19dcbfdb113916991ce1d3fbeb52aff7c9a41abe9d278a0f0ce983db70b4105ac360d1a4c2414b62051fd18f9cff7ae682b4d91c7c408343c72dc5cd4e86260449cc6227b09f1e4d46f66e79a3f6ee4ec9179b5b67abbe542a6f4dfa1edbd3e3d9b5eb4b52931f1e336878854d1826342de75bcf6db68f4f8a07525c6008551cfa70e94d66b10a6c5631496b978ede1c989477e1cac2a465b698c22e215284aff88d8609599582007304d816945fcfac00ef4652ba661777493696b75a661e28795f1b0904794be86fba6324c3e7c1856409705e8015793363ecc1c590625e2d8bfedbc97fc490ba09617334fc5117bb6aa72b70a3afdbe6c6275e2ec9e68bbc7db1093b2ae2a8a4d93d0fb5a8410d4c3af7d8fcdb0ca15b9705de162f081beef30cb54d03bceeaf2fcaa01422f95f5102ded1cbaa181e641a46c07345426e5c3a2c71bb372c03d7cffc030188f11c2cda2cf91b9a5cce07910c1af9d3778b3c0230a1cf2b848f1407158ea4ed9d5c683e9cd280cc7e08e16b5fa41116178de867362c81e5c1b5a18cb4027501add1dd6149222d8c5d6fdf1a5203b76baefcd51f3870f7e13abc47298a6a7f291a0005ae56fb3e40c310fff5a676fc1ff79aaadc9073a1e253e95cd7f90a3a656d1cad4b79783cd5df46074d196b073b9d7a9028902ce9c8b4ea7111a742438f17af0c11c8a9acbc0e65769301c0b7dd6f68f1979cbcd84c923c5660b14ca7346518d6f9d7891d9c80c35a74b9ecd0dc3016e63c1ca360a035a97cdfe49f8f1f71f54d2f33450b4115479ce7e81ed63cce5970bfdb510c8e5c3e7a00705dd5a91c94292853a2e441641378ae6b1acedde730ebd8b2edca4a3c2a6df76e33109402f1e1e9ae364b0e1bed13a64bc7e22dfd8f9490431679f01308625c7e0c04e90d282dd4c62f124eb576c2242056bd7b3c7126b7a0628b8a348b903f4309d0126c153e2a55d8afc77d518d31ed133f1c3a15ab9b6e5eda2ed2c7d85aea2ffa16fe1f54846ea8f55eb5e4c92b111de01c95ea52b0481c6a58cb4d938bf3936334318909c3081ba55c0ec2c003b3705d1422e5ccbe80bedaf39c559d8cc368a08d8c865950f4c4bfdbe12ff54e82daf690b7e81d98cb7aba87ae7e16408e3c48ea3b8c385c5789d0d261152765a3e2ca17d40396917ae458c031204faa91db2ffa4803796182a0704ae905480dc382af603875e232cbff2e1999156222a3e123209d5f32c9a29fe6dbd54242d9ff5057b774f2d4eef2bc40fb37b344b54dea14715d1546ff7905cbc0a2ff43ab5ee1015a48e778e826cac0ce83c35e9dfdd5b890c6805735c5307cba60681c29fde3d6d2ab1f130a40106ba49c3938d39a386184817e44762640849d621b918fd6cff9d29d48f75cbef909f956f89cb61d056d074a91411ff65d44a2738d49e78c3b2fd90c69cb2d35e65b4bb82f3d1857cae1f567f103ac260f5adf7d3cd7dffe94612317484ebdc3f16e2cc9e8414878a932aa592942e7355bf25c00c1904974a3c432e09dfdf28243d34808c1df6197df8eb18eb9beb8ad65a2a3971bcaa2f4dd786f7c210ea31a6ff26646c84f40c996e26585986c3ba7120f668ce19673c40c9d85734f18cb8227653864f1c5e58e8d743c33ebe600cf69cca239dab0e1528ba9387c7f080dae6b8c94d8e3c91ba247ad1c5b4659db2a14a13acbd3bf37dffe3690d43d02d845f86a25ef9336d72994be5aed952433d9360f9edca566dc909a5cb895439f212d442b74846ddaa73a4bbbcce02f8cdb1d0dc8a5af7d4cf65b3595ddfcdc873366062087817df59bebd2aa99f01cb1ca8ee3fdb40561d543e1be44d304fcac249c4ebf0b94238cce6cc158ed397c5c81e2499a28192943a4718bf9f76391c28e9593345491831932c622f25edc05a476730e0a269875029e63e1433cb348689ba46490d570a49510fc27437eb9b36173ee76e2bcfe81211000aa7146cbe9a13575df1e0106e79590290a36a6f562d6ce1ef114ca38e65324bcc7915607d1881d8571ff1fadb043d37e31aaeb6f7bf9c8922cb9ef1cdf84f2e02fa6bd6b5a71d1b50f6bc4531acd9ee0df6ca7652f732ce3de1aca50563844201a76c8a0286fb0f2f0a197d7b44a48de52df3346352962321cfeb400ff9ac12e91793313f967cd34108f6b0fa079ebd8e7d87b6e9c5e75734c8f8008ed09f04e6f4b52a5e9e6a58a3576e7f99f4eeb53c8433e2ce5a5ff30b6ad82026c5819ec88756d99db08541af647d2cfbe7d10df975ef9057b3d1fae5eb5c29ab1a6e449c8be12a7afaf8d2498db7c58b7cc6774c0f7875e8bae0396abd4950e131d27c86a744f00e87768f6ddbe34ad2cbce3258b6dc0044cd9c7fef107da969e8aff0449c66f6a72b5cbadd57244c947429483da4358e10202bef6e67a9e421ecf21a846025eee544ef082409a19e685060e923b205f8ca46f5f83a96f2f12932ea6c0391b30d05060baf2b326778e33fe6cf81b2ea62de9b766a5208ffb616ae9e62dc679bd77951ebd9aa68c0acf41270374f0a1354beee1bda2d55de041faae726495df19eafca07b72f7cc4bc436b76f682fe11fc3f34bbdd09a48da1c7313fffeeb35cf31075ab3d37e0c8e5cda5e07d0d6d64fb97ef6d1f0f3f261e31e9ca2bc0d741debf21942c5d50051bc36b0d5f29e18adb3798d736fae84c72501cb8397b6f7317c49a9d26168e8a5d4ad076a4a06ef322f1c4b225dbcea8b1a0d531ed2901983019974be2d1ce800be00376d80f7fd5a962b8ffe963c625dace557a273485da0b3fe8d69f21366293e68e955c6a60c4bdfa4dbde28ef00846d232e2fca595401d677b82377a17603382f2d07db648ec691984329de6a57a395c3da61f92f273980eda199e0b5384bd83d27b630ff690278c44912b7e95c27001457763179fbd9c742193b8920b92d7097c2c70f54248cd281e4c810a331564239d152e1d36d0232ff15681a6bc6846fd461e05ab0b32fdd1e6ecd112087d2c090ebf4a2ac3cea8a22a7acf2adb09e55f76b0744799626a9e9c90f003a44b44638837eb7985106f5579e4d238bfb8f329570109c9d3a64b7d0ff658b6de0b561a2a17b8819cb82943b3a2373776ad0967c1566de2bc60377cea17ddb87bfc4905939d2d301110442a9f1089e63613a54ddc9dc5c8f7a45efec4c12154621f4638783ce56ce8683df280b5cba024b371c20dbcf49e2b0b2d5292165da9b4ec534eb16eea3ceebd322717e5d034534100656e145b29e683eb69f7e7b4c07833239429e2ff550c2074dd56874032490151a552fe0bde37d37fc2e0e78f1654f230ac4957cc882bd830de815e23568a66dcfef70433e384fda56ea41bc40ed6a10a88bdbba8380d16c3eee5c42c5bbbbb02a32cc366ae59712ea25b2470bcb45404f142e51cdf388687698c80a8661efac861ca7bdf56a103bea8cfbdb4c7b61342d2de0e3ab10f12d6253d87476b10c4f95f02180105852cf354958dd6aa91392484acfd69bf54df2353a3a0097607e2d64fe4e023a3751a819a88723fc49f4e125e9e4f17961a5d2c8d33402117346b49111135f5a56645ce4cae9e1e2fc19f152f3c31b7f7eab71ed7684c1adf4b4f8ba63414dbc8f1a65d753243277beef4568f7460e637814949cf779906b1138c99fd172b282e5ba7bc218e819cb27bf6014662bcc7973462f0fe80873c93b22cc74d98c968be494121a53f5e40ce9a241b48025d10460b0f2dc676b91b0ba1547b716f8875342482f559a47703dcb32154069612940d2f0e53f673d715ecad0d14faadcc7c37b3c35961934ad86c06ea8b5367301c61773c19a46e5e8951528109e9353cf9962b7407b0037a559727486b418d5aa9bf44598d0bfaf7e31ac819e6cfdf1217db849b9e6a364991a9754f8969b508ab24b5c4805bc38482948f680d2eb87ed374739491dc1f16efec7c71575aa019b4d8bd5398362076d8e36dc71fec076543a1681780fbc89b4480ab21cad2cb7aa54067badebf76a1dc6e75c0980cd4ce49ea46a83c2567d5c9798c9941070cf7bff5cb94e424ba88b76550f8ce0c574001f7603c0b37f2b57edc87c015ee0d9fee190f146deb49faac2b2a75264c6dff4a4ba95a2b99f62526832fda1cf11e64756875ad19b3822640e51627a7893c60595b6b05b5fb64e09f5a162a115a5cd2f6c20f6848a369e1888189977f7d0e7b41a3d04b81c6b7a83be8c91b7536813e17eddd3950d078bb0335098859097e9d562a7bf7e2c45017f9b3cb2650349c65eccb4d407a4867679d2dac85d2d07ad37934715f5ebbbb0394a26112d3b9693edbc4783471ff73e49cdef02f8246b6aef4305e6139d6dfb0afd16996d1c41b13eb078bcad5e00fe7c74f08155eda19935cef894ae24d366c4d82c20c09f8a83f2128490d388dd197e7b81b4d16e7a822db1c6f3b9d33568cf24907963cdb09b66a99bdb86dca8026fc00423f9f0484347aacc38a2dfce2266d70a2777899ceb2b7bd49efb2ad2a5c2815692c552e706d8f23f0b90871bc6d77645ba326f4f3221bc9f73b6bc419afd6ac428f6a67ec59c836c4887600040c7f431d6f0dd8509387847af703ad1d9e01d81e6e0f0589216c089b0b1ae53df6856e5ac8282173ed7c5858583505b8124f1b8710b3029bfe72f9adbd3281daa64406900d254024e3be0b371e6aed21281d80b25fff84f624c2df13d0e1d663ee3689d578c653ccaa5daaccc49ef5f58f758fda54622cac3b5c8dc785397a08c4061eadc64de14d6cac8a7cca2d39c9044316e2e34d1221f878e40d38f426b915dcf88981e91b47fc163123239456b3539853ba4024a7f61c44c3bb65d161bae062d1c3f13da13d14478ffb818dfc2036ad9904eb1f19b660ba23fb5051b972545d5fc077d05d4f374930ffcfba6b06aa5ec4d8995bd1a9cfecb9796cb5c82835de781432abd89058334d60aab550b6cd7fcd309b49b453f32609e0af3c571539c0377376af9fbecfb6078efc4f9d60ba92bcfb17e48a74282c917ddb27f5a4ee61f33800d25dc72debfb79a3e193308eaf94c92b9803035328627978b3a5d5e3298da0cf652648a87714203ceb2a7f764de3ec85230bb0af7604a407f15c32d16d55f657954121c88ef6178e70b1a003343e068de8d56627878a2bab05737b32a044e685bd4f1dc4af19a641b320a775cfe3f123226b0ea53fcfc5293ca2d202b7b799ebc5a5e69773e9f7d321213dba6eb44cbcc0bd3570d09a9d8265860a2b42b7bcb1d2295b109077e6268df6989a134df458c3742322038a83d456064369d7b59b4b7dfa1eed751df708be88d3077fe225a1c755013c9b4e6c1f2491f8c5ed9ede2144c24b0c973d50d71e7b7103b2f3b9ef2fc57414245ea51c0797418da59ee383a275fc55d05e7b8d916dd72e279be5842c866feee9c777fdc8b910108706bc65f9bd4ce46c1b1478565960b20aba51376533b57e3be6549ca91f35ff82d06c6148a9c1ff4c8bf9f9cfd826d400257a40d6890a28adf348df36738dec6465cf55a4ab3773b47dcc58afc9bf0b62500cc2a94022e474f1643107450c1534b4fe51a13df43e13b27147a60953e5986fea474b9cb507f8ab56f581636dd18587010b6a5d9ea44a2472f270f4e3be8040475a0c1373854ac34d806aa3c7dc641f75b3734533109a66e215f5df4f5d0130d897e17f0dc6f55d028c1c97c7a8e5ee916283ee7e18368737590600cd5e5ad59f0c25986bda25c8ffd45dfcc3dcc6d0557b205fe52743efbdeda4e3b5d4ff33073cb8296f25f0f8237929b21432c9335da49e843a443ad1df0d296511f9837ca243a1d9e98c07d050d6d18a68f5145e1f4e3b4d05f35b51451ca689e72a3f48ba89d885d32a01fb378907f241c69e467f604b17d4b41c139800ab8bd826e78f9460079ea55b41c171ea41ce876fe8f228d1c76f9d066c3ce4a9a089c92330deb7fed306243a098f81ffb4b255336789c92db2eb777ba6f858a5e4846327dc66bfe5f90af5d41c7b7052fc53b5c7dc841b8dd0dabd5f2215035a75ef0d9cb96a64dfb31907a37112b7c094d3f9a9330b0106a80d470d1506c1809d4fde6e4ad61d2d77a771ac4d43bf7937b2fe3845a75601b31eb37817a0a622e6ad80166b3fb55aca489efeb4550ba7882a83cee42c48a8e56dd7bd747105650b50475b7e266c646e7db141a8fd3a01a03ec8c91fdc719cb5ab11fa3ab41c1e346e1b45f82e94c5f1bd8676cb681657482975cb07643bde6c64c66211ae80e34d550ec31ee013c9318f238cb50008c8254012faf05aa0ab7f82bb7717be718e6f161181efc0614d5342b3f3294b27d8628f1e7f311bfaafb9647895f1444d9f67d78074164610792248870cd93857770d14d91dba640db2ce87f04742746139709e78a37ab238fdf6ddcc61bab685fb0b01a8a4dda82ac7de870736d80beb3895b59651d485da771b195a8ac83f25c4514dcdfda9cabc121d817032f5e351baf4f45091aa406b2bc73c1f52749f50212f6619b03f72c71c2ed70cc456d9599e4480f0df0c465d60cb816871c5358152caa5433bd06c73e2a3f3d8a7acb0a4a299783dff154427e83aaf0ad4b9a29753fd873ecdc66f9b92ea05dc5bf15842a3b46f8babd677410cebffc3180c9a5ab9665e17ab2092dc0a48064c90d42e4d2900a000b21c465eb37ce167faecf340f33650da30ebc9123ed8fa39b0718ab68c837673ea6e348b64bbb492811c5dd15f5a4c16521aa301bf2c33fbef67c057613b4e00b51386dc36f77caec51599f128573db3b8b0ee942fe260c50232ba8a7235ce44fb06a83f8a511b9620027bca54b2f19cc86a38c2b376007f38c60cfac0b5ec5c503e8d5c19a0fa692901913ea13b1a1782a06aa8dadfde83f43ad30b0d96c70fd265fa9cd15f4f60d1f67dbf8b77f3344402193824e343e5159cf26905a77eb1142001e6a26291ce08879f78b18cc69c3f8b56501b8b5db36fb4e00c98dbf2c090dfffa9d517e2fc74378e5ac778f8b7e02f538e574859eaf1e98d1f62462f18400b8ada51220600d099801bd00673e7f600457ceb6a39c3c04d139eccd02f06562fdbf8cf609c262d262e922977d0cceb5d5f9e0a933fc4d7abfd94e25690f309e9fe0f3f9c910ba13a60c797ef53ae0062fe9d75e6e2945deed609105e4cbcc20ac2ea10c9e8900e9d6fc3713cb0c0cc39f6343ca863bd5e0cf43b077cad4abfdde3d9095e497c0d8b84c63f5333516542d875d9335d4e2662b4f0aaa2df62a6831cd544ff3da5a8c0dbf0079124f7dc230707db0bce9c6c6b8d1647c8f8f428fc8cae2a505e6d7a8e95f9bad044a53a78aae7c80a0a412748751a53f783056ed333bc13aff2e71c5a5cae524a6dd749a245ef30b92975f58141d7a67f618077333b40e65ebbfa8a94d7b485921b27b26ae180e66121c0850950ab94f204dee3ec71479b95e3317cfde17d64153772e21f567097e7bf5670c07c8a11e3d2e78a8fc132dba1c244edcec6683cdde725b4773a2b8c3f69828234aed3f2664c71e72acb76f2fd9e905c93bb0afb7bd80925faaeae83b38141854f35efebfc8c58cf27630ad068eefbf4d89c6e471af6d8a556f691c32d079763ec51225052361e0fe4294121e577a9adddce762269b0b8962263b30490bdccacb2672bba9dcb344762125644b3ee0f1953d12d57d3080fe2bd72890baa86a983eb6ab3f82a9142a719644b4bced641bfd58db863f7ae7dca003e6651b6f4bf42c59414e4a4c994eeba29764893f8cb147637864f7d9dd73717b0aa695aecc644dbba0d624b97b645d7b5293cf67f6dff4d9a478d8d96066a05b1db8eb61cf86b8f3d136fc5f4d75189da66ee4c7b31ef0a394f3f056d70740223b81e7af0b555b8717b107bfc6697cc2bfe3339373f35f28d7f9cb7136bbafeb461bb75c90bdbcaf9c2131e3a21c1c76d1657d2e3cfd799dea83bda02444389fd2c42f4992aa7ab77d373a126fc6f73167e871376dd3ec482dcde5d058c534a5d27be2d482e1493d9c4fa9c542db4369e0cef246cf153fd8d3ac293965a90061911f091e1e7ef50ba8a6db6ee6b9ed9067491cfec3d96642fd8c49ab7e06236759f6598d172a384744ddd953c1adcd64d048106b16c354f581597a8b8ba036b6670e1b0d6861e5e81da9f524461e4dbc40f99d3d2044ec4b638e7237a42eb5048a043760ae36d08ecfe32c4e87fdc906d38d8b9bbe9842a81f701c891e6c2d643723088e7ebe52f61f21545ada1ce20f0e3da1f9e4a2debfd1f570058b53ea473c2022ccd8325611ecb17535260beff09b7e5d3c8481222b14e9d07d370ed835a09f0151029397123bd60a209cd4151ef995cbed0baf9a919da080b0c4eaac4a8da46eeddd11d4a5f8961a917269dfd41e340c8546d1f9e5fcdc1ba49ac72933e551dccee3eba8a9c01519aaa0d5611d54191b21c266360f44c18b12c69a10e48f0d89ab3c38cfe114cf1126b388faf9013f2397c8b3503de6d7d43c2aa6cc3b314161c89f5c8a480b976123b60a556f706dd168135941745ef1a6d23bbfc778532f0681f3cbddbe209965125114c0993ae92156232cee684ad8e0969d3c7558e47696cd31221a68c8d64fb676a8e31b850b5a655a13f3c8d218fa5d824e8db816f951c09fc5944216d2c9f405688dbc09ad5baaafb0f72f5d07ff31c55cdc9e67c68438c94aa66584e37207dd1b280287f45786812b6969a04049daa8be706a0db7091ada90b5bd616244ac1d360251334c9e94dbf77b9883d3a0a10efb8d834eb8ba376a2fa4a967e5fcf4714d16310cc726f1e51f958c2770d0d1108357fe614d738c162ebabfe30931b51fa32fdf7140770da6218a0a4735633f4e72c383671301ab585b9e0fa58931b7a11679ef7981f120dcdc6b7b9289504ed59567755fa894e7131c516ba01808908b50788703b58a9f7a026caf9a69b456ec0e133956531b677d11de716909224d07572116ccb10b16432a34aefb2d4e48d670af16742ca50bc5bda5ce7894932a804db8e3783a987dcb979071b1b44098a9e1ba071a02cc8e773b15ceb96a44dc3368ed01c83bcad057008b0e657e8b571b97592e356301d3efb04cae54edd88079d7fa2d88f510d9fc1cbc6ad66e7f33219f0b362e54b17e1ff7f9646621678461dc0debbe1ef657d5de00180d95c7d7f4c8ef1776d028946ab129b8962d0825996aa14de7fd891ee0fb33396f27b507550ccc5cf2741d48d9da96aa648a542779ab15f548f336d93d84dc346d73a464a04d44514990694df89aaf7b5e8137c069ebff64ecdda938e8735750dee9fff82e8a1cfa1ad67736e3ac5a3f875cd05741685b6085c7b9c0b05e7202874a880203dc966a6dbb586c7d3f8e3ce98b112f948e6d4f8bb1b06a25068f8236aaae2e047aed2ea75734cacb716c789cb827abd34c7d4152e1699dc708ba5625d8a7ecbb34fc8f388d31f600a97b9cf59698c3a35367085e009c8b2b531dc2eb690f092fef9d44c0ee2ebe4dcb99440a3517f947df9120c7262b94653b60e650925ef73cfc6061e7d0002b990cae30f26064acfb13a50c41b2d6ad3eab8980ab2030bb9de355cc6f3b5b58e93da1e5dee2a209b80d7d06a6d9b48cbcef28d3e4a29c0ac2b9ac01f3f81aadda9fd0f305754b7005acd403b82851f665572930318bd88e393e7d1bc36673b2ccf77c6e438e592e352a57f0573550d2bb39e07988e40467af6d5d181d91e1f2387995acb2abd5e24bcb5a6ec2b771dfb60d2e04e31fac30e484e28f27e8882c81db58c3b641097e73150eaf9f0cbf5dbab9c301edcdc3edc8c27f1df9a87758c1d75e921bfe7307fc1757998af73026ae86b4ec350d5e1982c2f34533a4d88e45cb8dad6ebe15a16d23e5cff3c70c0cbf959979c74b13687a5b79e64d629e43ec99dfc23df064041350728725bf186ba678135d23165dc25c49b28869a987cffded7a991107a55c12db4feb479b1f7a78f3bdb996bf5ffeb99c1358e7ebebbbb74ed8d997d3d606c7de8a1309196e6debe569a8349489b5b73467049b12e1ae810354f184019e661c5310ce73c33c7d9cfa0cca31e054c56f17bc8695cbe47734c31af947598cdffd738fc30319bf12f866358fb0d41c87b76c10c3682a93acbe2cc1e21c8dc5dd3443bd7e0883ab8bb7be27665b5a6676ca7f73667f8cb001d5acd7f21abc35cc0bf3cd03fcfdaa3afa595d369dea0162d102fd6710bf2be6ae7f6d642250f7f06517d9a2fd08114b3fe1c368c0e7e7a813f0842f7b80f0f579ad427f2dd69f193d64e5e7eeb13ebcac18217ef3639d2f8d9e904c3987a67ff15b7146eb749c72e9f6d7685fc674c21fe9ca1c0fe548be42a43855ebcdc01227a93d284d1badc9a961ace7570349cf817d23505a69d28d5b337f647cd3c38c43738f732b7d51ba32f4ea898153e07a530842435e50b4fcdd01e83945b22f5f620f2ff33acf048c584cd223882e3d316ce9f650ae52e4b04f5c358abcd37f6cb8e9b91d46d698c7b6a1a099520d05262d2c6f93e43433ba482f12d49722931a6a0ba3839a1148ca5ff7c54ceed6951077976f77e4e97f4675e68f342c4e3196be9f0d6185213d2b5cc4a2dbed4d52d97f8e3bff6ed5168511c2fce4eb3310dec69c0e682d2d980eff52f8a5c2bab447bae46ba2d841c21dccba652ec682ddcaaf40ac498425c1f03c24647121eae7eb90e04bcd075b677331cafdf73c63da1ae136d62b13439e1241019a11ebd170cb7fcbab47b6e358c920fc115f9b0ce4f2e72f34a46439a30a63eabf8afedc72dcc62b3c2347c5a2c153aaf3b50637f9bfd79bd598c121c4e9b83f647e6691c65329acabae72ea978435f3a5b0ce036e487f1fa88bb1ebac3f952fc492985148ab9843ec573809b6a3707b474a49e5d745e2f9dbf7321bfe7c050ce1cdebbd6ff3af60f7329225b5cf73d8af7770d73a6623b031905e96f32d8d58c1aa16102219b8e98cb452b687387a3396a143ced1a3a7c314fae49d240242373d59359e98606f176deda5aa2ec195664b5ec25f7aeb795db42f39e1d52680212f15c00a7659cd3f364782585307e245d7912695f7b7791da694346b8773af38270e5d9f070f6744043fdc8ed7a21312f34a42f0eb6b0df868cee2d53596f286fca1fdb479e0585104375a1714e00fbf54ae2afd63e4c370fc7a85b5bd9b949dbb3238afaea7e3654653e766a05e29de61ddf4b1519797fbbf006c29813a35ae604301e328f73c04a9c9489b79ccec9c5577810f3ec3bb8d7da1dcb42cbb2a03a73a67da2c2d5709422d5b843841d6532375c968f95e42faa4287fa382eb088f885096e893d5c0f8a1a5410afd1fa8ee7ffbc12899ed817ee7d5eb7795457f9075be9098afe04acafc3e1b4eae962e4a8205bb7ea41181e74ad02369d8f05070d2f60c9fc3cbb78199a5b260d222e16e7367216d540b4c4c8bacc96ebc57b804ebfe4d8a6e452252fc60757b594e515c80640a33cc7755d69a3699949f7948a3d31940aa23e9fc0574d1fab4eb36e11d7a0692aa3ec48da10de6db2314367a75ab460fe6bcbad9158b458c4922dde942fb867f98dd858a51990c7e618c5fc4834a8e23b6ce0747501c6c7b2b03d6a1c09e8da959a48049f4abd98b9181082ff38209564524972f0748a54c610e17688faf4d371a0d5503bb0b89f6d5dba2dd0c89ac6293bbd38ee557fc579ae50fd0cb6ddba7d61ce173155a90c80c71e46206d436b9ca1b39bb70057998fdc748f60041e94982dc7f3022e3b9dcb96e00272b8b23243192cb9d0a4c8a3baa4c236ed3fa011d7b14921824ef7ea3339ecabbadebbb01adfd967bbce2272900aeadf3af410a86629887828fcbcaecacaa90132da4630f00f2c6dbd511f5b5f2598cca91a8dc9be46702d790e3e0e57f4048509b02f59f240a30cbe87becc8284223f5163343f38557a1d4693346c906aa7ccc063d95ca373930218b738e644f10a9cbbe9696a472a3f06cfadff114b140dfdca7ccc5143c1c4122bb5bc6fa5707cd26f5dd2ae24913835d7b3fb0ee057129ee5a20086c10a81e4ba8110b9d396ae69b42edcce2ea4f63ceb82d42a9b4ba07d8bbaf305a5f6f5dff8163ccce30281fcf981f77ca2e19418673884722fad547056690b33c6f34a6b4075260e89076369d13b26ff5313c72c484d054a25076ba81083f0fa2bea95c6c10d06dbc5e2f68a89cbe4b910a36ef7a850a69fb635bb4541d47ec7a8932dc0017f76b1cdf57af79f0f32a23d0b4b547d7b5bbb250f72584cb8fbf89f3252d583acc19401edfb7b2bcbab227f2b1c1aaa9bbb6e840c637dd543125a68ac1190ccc8a26a59c018eda6f303759560711e4fcb1f94d78d88488fe58e8935133237d71d17934b995f7647c10655604901bfa52b7b7654d54bd1d800f241b28bf5c52bfca556c7d10416ae06b22c27060a757ca9c74ea35f0700df9ba48be330b015538aae098d91f8fb4c925bceeb6bfc75014f02fa9d790994a996c1e7552248600ce2ced3f1cb3d506e239161eccbecb45658a1de2d2e772d3b295051b0eddc6b43fdc64c25716355cb0a0dd13b7a65adf652944cb83f3621e66e1f77decf8ef5b734c8a181a917ce3670f731198b5475315a93237c2c6dc58491fb97ca686be376e2c4b957911480b530d3db75534ac4e2008565e8220ce408440030e78c279e993c593a92f1c07761887d549e2672ee497ca3a6a57104461df95eb2045f6262615399d452e4f00d1a567e54cadef6f98bad67ddb0fe9eefe7d284241e2d42aa5c41013f9935746ca9d4b1af0cfe1843db9dc6b436573f55d7d52cb573e034d6123666ccd821e5a7549d3fe2ad42e60fbc714dcf5d4654c61ca0cddde698f9019b04c6a6678ec8f3171ac80f5e834040b66c2f83390c517ea59e08ab8cdf17ce0b03294e66fc0b81c351fc22124b6d77b2b7156a8ab5a7373d84eab363f0d4358b0366acecee98710f9f26f49a932add49149b2461a964b61b32c70beb2ffc5fb52bff70324b3b12ff2d45b23ce0627e08d7d329201fcc10b2ce2c39a7982434bc514c425d0c4a08f12dfb8504569d12912c33d3c0a4239e09e37f79b7f02f368472698b72e0910835ebbbd4463e1d640690694300386474ddd10c9cf6a60505fe42d271f470e0c741ae38e8b98d540575532c336309a765e1cf83493cd3bcdfdd66d16f9e374501dea8a63a723e43f87f62d65cea13f6e33c005fb2b7d32e6b353b526564586e3d076077f546525f3536201f51e4d990a5fbdb34e80c5c5ee629e01e64f4acf4a9578451218f0e5b2d0c4d1e58f67f8087ea11a10b6ce8407a70bfd75dc393425340ec926848072e311316223eb0295b785f3ab73473edf0ca76ce34df41fbd7f6b51f265c7df8ab5734d51d76a2697b520032c384437374ac42b738df2234afbf5be3857484cfe1cce047b2d8dd4d2c1be2f441494d2f2612af80fcc0f99752367934d17b5c47cc993f733d0864f5b997db59952214de18fb82c1eec57cf91fa866c4b79bf33cba4614b36c2d50233f661b6525376744d857c62ffbdc751619ac51568e96bb4da93d3fe6fd4c5e957aeb7e744a6a41d83e455cabe21c7cc22357ef29c78c4ea6697f1edb9e26a2f21c708a371d1694cea2118125f842c59937fbd8529e0ebfa3efebf6a6bd92abb32a890e96878f0fb1783b042ae7b7a650eb14d5938654df68ddf275d62c310c5fe8d9346e71fee2e305ccfa768e74eae1bec007bf859300eaff63f1664749581c21bf6ec8eef39c257d1dc00d61ff9deb79f0574fd4c4a1ca2ad386f6157c85cf55dc8b05fd2259236270564dd4e46884f774c8967e1c56e0f20f7c2b2597882076a476bb584a03990ddecf0d315e677ac1fd231d771d3793e27d0b1a1378759c920482e0d018f1bed42b13acc07316e74aa900b5d7b8e7fd572902b794157fbf379f6b3cf2307ade2dacc272c92be796eb4776a9e5bb431a17bdb3e783e0593b12055815db1230c0d4285a1df1b73a9347aa8cad9162aff57f5899729091b2f0f7b78bab2cd9dd5fb75debe57579c8af3917bb61d3e4a00927fb51094a8b177d2a9948c44a81827477a2747173181db1ab9767a3c55343ca992f4ef7c825b612dd23ab9f326d958f95b6df3c8cc9971fb7f55e0343d3a85617a32b75639ce775f4b19ff8b3732fd377b9253edecfc568996136596099101ea396f3ecee24ecf3c4e6c81c6cec1cca92a3ad3f249351b16135ea1674caad30bf3383a228acf26e971cb05f79ddf47658f7bacb8676f050cba5765e480bd7810d298165bd48b90943d7197ee6ecde411a3615e000cf0015731faa4c0df7a068f22785e1f3cc81e2653a511bc75896be9c12405eae0eeeef4742284a4b75940051fbb91dfe66258f3c41454a6c7a5cd4557671f9ce3f95e9f6465b34c54bc284818d7f8d23adb5cffa3d8af481171968d64fd1c405f7c4ec5617a39acefff1e336f54c4b0de08a235fd288b52c94972c2affaa605914157a11b96235177ac70b4c99a1d413313f507e7bd32bd1e5af5e549d33bf6166a80ad451984c5b33d07c0397c093d90fe9da2894ce43fded323ebca0f2d7e42999fa59b33b0f41773cc97ae8da4136b975e41586c432809a22721e2c0217f92c19feab393042ed77120c52f37812977c361e2c60ec1cd39ce5c94f4586e27583686f7468fb54df942dfa68782f0d9144a9063b54a743149b35bbcae5d997c77a389958ae81e2fb63d5ba3fb9530380660b0db026816c147d15c6715d9062e095776e4b470c458d292fafea3dd36ca18be4c3d25525ec77a2ebb37990529c8636020b145925a8861f84767bec317a7532c992c27fa8387b6a2cadea32a0b38770712c77098fe3a465cf2072c42d888af28b9a7b9a921f1376c4c0b4a627977b0ef18c105d875abad898a4ce944a304fbd386bd1abf431b71f2cf17addfbab0dfb370eda7cfa4b5087b0d0f9e5969c77850c67b785e17bb19d6ff9d902040b1e2e885cf4c86a9da1801349ff301abd42397ccd0e504975a8978af21820b0b733a92f8318172f94187473445e8037d5d6a409d1723e2eced962e51fd154eb3b0517723da5cdfd3c9b507f6233373bc2c27ab291b1ef506cfd554c77d7a86dff4b0ab69688947f3af508b606c3b7847794716a0c8975dd998311600e92ed3b7a46cacefa1b096fa914c466789bd2bf4704dfb1749e0c16415b777fcfc8c4e6391ecf2cdef38b17ee5d1d7b465674343248e2e0dec95113f46c66b000dcc0d08847ae6fc817185dab80c910385d1cf81bed56f5d14893458b9366bfd8817371be90a810f32ed156530ef0a256f887fb056f00843129d275f541cfa9da6891e4b5d16e36516bcd41caa98c47d7028a645011e56522f40c63e8259541cf87ed4a838b88d0b5da062d5daa240f0571aae8ebc2a4e338ae36b6831cec17f35008fdf9306b6cb670281ccf6d3211c4351d62e93decb0e1417cfc159273d7a871e7082203420db737ad2f95d6f2e8d2f021bed4f5fd81b990e84059250c99c87a81ca6f3f4e7228e70e390fb60c2025c3c182a734fa6dc780c9a7142b456f92aa346c27af9fd93fdcbc4c20b491910e3172a76f9774f8f0bd22c655f16b98589236860f6b3da10935d72ca1fc694cf9bf250c940ca4a771af7551ed9adbb6c54825123ee195364f773927f2b60e6b2fda847a2cd52d737af392be5f1b859592601bd4284e9c9da8db59905cfbd26823b463ead1fdb0f3fb8e25e1c2ada9e04c12719f981d75e98d1463b01ce4e401d559fcbf61b931c5b84f8da062208cf531a9b5a5242f8838441a2c23effec70aea1bd43b9c574f19dde68a5e33a065c8b30e4a6bdbb8d77fd283a3355ad5a30a119ab51a4ff6fb60464a85e083fefff3053cbe6241e87f43088b769fffe63d45a79bc63040fa69d6760803f4003ece1c59db9744ad99a5fa09a4ef455ceafb732f460b9ad4acd3f645e2e3c5a1bf17dabe6a97adc76170a2ed1e042a39612e0254e5f5926e056de9fa04f7b8b3bcfdac664e5054cbf30d5595e814a2d6a047254f78f76e9575e85bddfb9435191e488c3f43ed55530141de2b5b2b403036e3452348a286d127ed0bc7b925b8199eea677e1244db3477183b47c82105dc8f209a075bf66ab8bbdc4a1873e3d7c654c22bcb2bf2db49f9ad1697a833e2f9b2bf81185b7864d71c9b039933074bcff4d2f7319770fa55167c4ce4ccd18dae5e55f4b5506faece930f8efd593255847bbca5c027e52179e1ed917f41907f06a1896df9fa1a45eee05f1022e62b3100c388ec1ee3cc9b94bb169e0596db1a73c03aa38422acd61de2996f42b5e94273faa503b332ef595d340449be4da1867dc53d8f97ac8c41827c95cad2f20bc5b1b502f78b38e6f977c29cc5ad93d59ef034b860f99f6d8c48bad0cf4332a3cdcf83cadf8d5d119d201dcb84087886d28dc1f12c6c0ed1479a7ed572c088a55ef</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>åˆ†å¸ƒå¼é”</title>
    <link href="/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/"/>
    <url>/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/</url>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”"><a href="#1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”" class="headerlink" title="1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”"></a>1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”</h1><p>åœ¨å•ä½“çš„åº”ç”¨å¼€å‘åœºæ™¯ä¸­æ¶‰åŠå¹¶å‘åŒæ­¥çš„æ—¶å€™ï¼Œå¤§å®¶å¾€å¾€é‡‡ç”¨Synchronizedï¼ˆåŒæ­¥ï¼‰æˆ–è€…å…¶ä»–åŒä¸€ä¸ªJVMå†…Lockæœºåˆ¶æ¥è§£å†³å¤šçº¿ç¨‹é—´çš„åŒæ­¥é—®é¢˜ã€‚</p><p>åœ¨åˆ†å¸ƒå¼é›†ç¾¤å·¥ä½œçš„å¼€å‘åœºæ™¯ä¸­ï¼Œå°±éœ€è¦ä¸€ç§æ›´åŠ é«˜çº§çš„é”æœºåˆ¶æ¥å¤„ç†è·¨æœºå™¨çš„è¿›ç¨‹ä¹‹é—´çš„æ•°æ®åŒæ­¥é—®é¢˜ï¼Œè¿™ç§è·¨æœºå™¨çš„é”å°±æ˜¯åˆ†å¸ƒå¼é”ã€‚</p><h1 id="2-åˆ†å¸ƒå¼é”çš„å®ç°"><a href="#2-åˆ†å¸ƒå¼é”çš„å®ç°" class="headerlink" title="2 åˆ†å¸ƒå¼é”çš„å®ç°"></a>2 åˆ†å¸ƒå¼é”çš„å®ç°</h1><p>åˆ†å¸ƒå¼é”çš„æ ¸å¿ƒæ˜¯å®ç°å¤šè¿›ç¨‹ä¹‹é—´äº’æ–¥ï¼Œè€Œæ»¡è¶³è¿™ä¸€ç‚¹çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œå¸¸è§çš„æœ‰ä¸‰ç§ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/640.png" alt="å›¾ç‰‡"></p><h2 id="2-1-åŸºäºæ•°æ®åº“çš„åˆ†å¸ƒå¼é”"><a href="#2-1-åŸºäºæ•°æ®åº“çš„åˆ†å¸ƒå¼é”" class="headerlink" title="2.1 åŸºäºæ•°æ®åº“çš„åˆ†å¸ƒå¼é”"></a>2.1 åŸºäºæ•°æ®åº“çš„åˆ†å¸ƒå¼é”</h2><p>åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”ä¸»è¦æ˜¯åˆ©ç”¨æ•°æ®åº“çš„å”¯ä¸€ç´¢å¼•æ¥å®ç°ï¼Œå”¯ä¸€ç´¢å¼•å¤©ç„¶å…·æœ‰æ’ä»–æ€§ï¼Œè¿™åˆšå¥½ç¬¦åˆæˆ‘ä»¬å¯¹é”çš„è¦æ±‚</p><h3 id="2-1-1-è®¾è®¡åŸç†"><a href="#2-1-1-è®¾è®¡åŸç†" class="headerlink" title="2.1.1 è®¾è®¡åŸç†"></a>2.1.1 è®¾è®¡åŸç†</h3><ul><li>åŒä¸€æ—¶åˆ»åªèƒ½å…è®¸ä¸€ä¸ªç«äº‰è€…è·å–é”ã€‚åŠ é”æ—¶æˆ‘ä»¬åœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•ï¼Œåˆ©ç”¨å”¯ä¸€é”®è¿›è¡Œé˜²é‡ã€‚</li><li>å½“ç«äº‰è€…AåŠ é”æˆåŠŸåï¼Œç¬¬ç«äº‰è€…Bå†æ¥åŠ é”å°±ä¼šæŠ›å‡ºå”¯ä¸€ç´¢å¼•å†²çªï¼Œå¦‚æœæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼Œæˆ‘ä»¬å°±åˆ¤å®šç«äº‰è€…BåŠ é”å¤±è´¥</li><li>ç«äº‰è€…BåŠ é”å¤±è´¥åï¼Œä¼šé˜»å¡ç­‰å¾…ï¼Œä¸€ç›´åˆ°ç«äº‰è€…Aé‡Šæ”¾é”ï¼ˆä¹Ÿå°±æ˜¯åˆ é™¤è®°å½•åï¼‰ï¼Œå†å»è·å–é”</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222626149.png" alt="image-20230228222626149"></p><h3 id="2-1-2-å®ç°æ³¨æ„äº‹é¡¹"><a href="#2-1-2-å®ç°æ³¨æ„äº‹é¡¹" class="headerlink" title="2.1.2 å®ç°æ³¨æ„äº‹é¡¹"></a>2.1.2 å®ç°æ³¨æ„äº‹é¡¹</h3><ul><li>æ²¡æœ‰é”è¶…æ—¶æœºåˆ¶ã€‚å¦‚æœç¨‹åºå‘ç”Ÿäº†å¼‚å¸¸ï¼Œå°†æ— æ³•åˆ é™¤æ•°æ®ï¼Œä¹Ÿå°±æ˜¯é”æ— æ³•è¢«é‡Šæ”¾æ‰ï¼Œéœ€è¦è‡ªå·±å†™ä¸€å¥—é”è¶…æ—¶æœºåˆ¶ï¼Œæ¯”å¦‚ï¼šåœ¨è¡¨ä¸­æ–°å¢ä¸€åˆ—ï¼Œç”¨äºè®°å½•å¤±æ•ˆæ—¶é—´ï¼Œå¹¶ä¸”éœ€è¦æœ‰å®šæ—¶ä»»åŠ¡æ¸…é™¤è¿™äº›å¤±æ•ˆçš„æ•°æ®ã€‚</li><li>åŸºäºæ•°æ®åº“å®ç°çš„ï¼Œæ•°æ®åº“çš„å¯ç”¨æ€§å’Œæ€§èƒ½å°†ç›´æ¥å½±å“åˆ†å¸ƒå¼é”çš„å¯ç”¨æ€§åŠæ€§èƒ½ï¼Œå¯ä»¥è€ƒè™‘å®ç°æ•°æ®åº“çš„é«˜å¯ç”¨æ–¹æ¡ˆã€‚</li><li>éœ€è¦è‡ªæ—‹å®ç°é˜»å¡æ•ˆæœã€‚å½“è·å–é”å¤±è´¥æ—¶è‡ªæ—‹è½¬ã€‚</li><li>å¦‚æœä½¿ç”¨æ•°æ®åº“è‡ªå¢ id ,è§„å¾‹å¤ªæ˜æ˜¾ã€‚</li><li>å—å•è¡¨æ•°æ®é‡çš„é™åˆ¶ã€‚ åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ MySQL çš„å•å¼ è¡¨æ ¹æœ¬ä¸å¯èƒ½å®¹çº³å¤§é‡æ•°æ®ï¼ˆæ€§èƒ½ç­‰åŸå› çš„é™åˆ¶ï¼‰ï¼›å¦‚æœæ˜¯å°†å•è¡¨æ‹†æˆå¤šè¡¨ï¼Œè¿˜æ˜¯ç”¨æ•°æ®åº“è‡ªå¢ id çš„è¯ï¼Œå°±å­˜åœ¨äº† id é‡å¤çš„æƒ…å†µäº†ï¼Œå¾ˆæ˜¾ç„¶è¿™æ˜¯ä¸šåŠ¡ä¸å…è®¸çš„ã€‚</li></ul><blockquote><p>dbæ“ä½œæ€§èƒ½è¾ƒå·®ï¼Œå¹¶ä¸”æœ‰é”è¡¨çš„é£é™©ï¼Œä¸€èˆ¬ä¸è€ƒè™‘ã€‚</p></blockquote><p><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"> */<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Lock</span></span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åŠ é”ï¼Œå¢åŠ é‡è¯•é€»è¾‘</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//å°è¯•è·å–é”</span><br>        <span class="hljs-keyword">if</span>(tryLock())&#123;<br>            System.out.println(<span class="hljs-string">&quot;---------è·å–é”---------&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">//ç­‰å¾…é” é˜»å¡</span><br>            waitLock();<br>            <span class="hljs-comment">//é‡è¯•</span><br>            lock();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MysqlDistributedLock</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractLock</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> MethodlockMapper baseMapper;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryLock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//æ’å…¥ä¸€æ¡æ•°æ®   insert into</span><br>            baseMapper.insert(<span class="hljs-keyword">new</span> Methodlock(<span class="hljs-string">&quot;lock&quot;</span>));<br>        &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>            <span class="hljs-comment">//æ’å…¥å¤±è´¥</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">waitLock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">10</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">unlock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//åˆ é™¤æ•°æ®   delete</span><br>        baseMapper.deleteByMethodlock(<span class="hljs-string">&quot;lock&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;-------é‡Šæ”¾é”------&quot;</span>);<br>    &#125;<br><br></code></pre></td></tr></table></figure><h2 id="2-2-åŸºäº-Redis-çš„åˆ†å¸ƒå¼é”"><a href="#2-2-åŸºäº-Redis-çš„åˆ†å¸ƒå¼é”" class="headerlink" title="2.2 åŸºäº Redis çš„åˆ†å¸ƒå¼é”"></a>2.2 åŸºäº Redis çš„åˆ†å¸ƒå¼é”</h2><p>æ•ˆç‡æœ€é«˜ï¼ŒåŠ é”é€Ÿåº¦æœ€å¿«ï¼Œå› ä¸ºRediså‡ ä¹éƒ½æ˜¯çº¯å†…å­˜æ“ä½œã€‚</p><p>é€‚ç”¨äºå¹¶å‘é‡å¾ˆå¤§ã€æ€§èƒ½è¦æ±‚å¾ˆé«˜è€Œå¯é æ€§é—®é¢˜å¯ä»¥é€šè¿‡å…¶ ä»–æ–¹æ¡ˆå»å¼¥è¡¥çš„åœºæ™¯ã€‚ </p><h3 id="2-2-1-è®¾è®¡åŸç†"><a href="#2-2-1-è®¾è®¡åŸç†" class="headerlink" title="2.2.1 è®¾è®¡åŸç†"></a>2.2.1 è®¾è®¡åŸç†</h3><ul><li><p>åˆ©ç”¨åˆ©ç”¨Redisçš„<code>SETNX key value</code>è¿™ä¸ªå‘½ä»¤è·å–é”ï¼Œå¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¿å­˜çº¿ç¨‹æ ‡ç¤º</p></li><li><p>é‡Šæ”¾é”æ—¶å…ˆåˆ¤æ–­çº¿ç¨‹æ ‡ç¤ºæ˜¯å¦ä¸è‡ªå·±ä¸€è‡´ï¼Œä¸€è‡´åˆ™åˆ é™¤é” (Lua è„šæœ¬ä¿è¯åŸå­æ€§)</p></li></ul><blockquote><p> SETNX key value: åªæœ‰å½“keyä¸å­˜åœ¨æ—¶æ‰ä¼šæ‰§è¡ŒæˆåŠŸï¼Œå¦‚æœkeyå·²ç»å­˜åœ¨åˆ™å‘½ä»¤æ‰§è¡Œå¤±è´¥ã€‚</p></blockquote><h3 id="2-2-2-å®ç°æ³¨æ„äº‹é¡¹"><a href="#2-2-2-å®ç°æ³¨æ„äº‹é¡¹" class="headerlink" title="2.2.2 å®ç°æ³¨æ„äº‹é¡¹"></a>2.2.2 å®ç°æ³¨æ„äº‹é¡¹</h3><ul><li><p>Redis çš„ increment å¹¶ä¸èƒ½æ»¡è¶³å®‰å…¨æ€§ï¼Œå¦‚æœä½¿ç”¨å®ƒéœ€è¦ç‰¹æ®Šå¤„ç†å¢åŠ å¤æ‚æ€§ï¼Œå¦‚ï¼š</p><ul><li>IDçš„ç»„æˆéƒ¨åˆ†ï¼š<ul><li><strong>ç¬¦å·ä½</strong>ï¼š1bitï¼Œæ°¸è¿œä¸º0</li><li><strong>æ—¶é—´æˆ³</strong>ï¼š31bitï¼Œä»¥ç§’ä¸ºå•ä½ï¼Œå¯ä»¥ä½¿ç”¨69å¹´</li><li><strong>åºåˆ—å·</strong>ï¼š32bitï¼Œç§’å†…çš„è®¡æ•°å™¨ï¼Œæ”¯æŒæ¯ç§’äº§ç”Ÿ2^32ä¸ªä¸åŒID</li></ul></li></ul></li><li><p>éœ€è¦è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œå› ä¸ºæœ‰å¯èƒ½å®•æœºæˆ–è€…è¢«è¿ç»´é‡å¯äº†ï¼Œæ— æ³•é‡Šæ”¾é”ï¼Œä½†æ˜¯è¿™ä¸ªè¶…æ—¶æ—¶é—´çš„é•¿çŸ­å´ä¸å¥½ç¡®å®šï¼š</p><ul><li>è®¾ç½®è¿‡çŸ­ï¼Œä¼šå¯¼è‡´å…¶ä»–çº¿ç¨‹æå‰è·å¾—é”ï¼Œå¼•å‘çº¿ç¨‹å®‰å…¨é—®é¢˜</li><li>è®¾ç½®è¿‡é•¿ï¼Œçº¿ç¨‹éœ€è¦é¢å¤–ç­‰å¾…</li></ul></li><li><p>å¦‚æœä¸šåŠ¡æ‰§è¡Œæ—¶é—´&gt; è¿‡æœŸæ—¶é—´ï¼Œå°±éœ€è¦<strong>é”ç»­å‘½</strong>ï¼šæä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œè®¾ä¸€ä¸ªé—´éš”æ—¶é—´ï¼Œå°äºå¤±æ•ˆæ—¶é—´ï¼Œè¿‡ä¸€æ®µæ—¶é—´å»ç›‘æ§ä¸šåŠ¡æ˜¯å¦æ‰§è¡Œå®Œäº†ï¼Œæ‰§è¡Œæ²¡ç»“æŸï¼Œä¹Ÿå°±æ˜¯é”è¿˜æ²¡é‡Šæ”¾ï¼Œæˆ‘å°±å†æŠŠé”çš„è¿‡æœŸæ—¶é—´é‡æ–°è®¾ç½®æˆåˆå§‹å€¼</p></li><li><p>é¿å…çº¿ç¨‹Aé‡Šæ”¾çº¿ç¨‹Bçš„é”ï¼Œéœ€è¦åœ¨é‡Šæ”¾é”æ—¶å¤šåŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œæ¯ä¸ªçº¿ç¨‹åªé‡Šæ”¾è‡ªå·±çš„é”ï¼Œä¸èƒ½é‡Šæ”¾åˆ«äººçš„é”ï¼å¯ä»¥ç»™æ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„UUID</p></li><li><p>éœ€è¦ç¡®ä¿é”å¯ä»¥æ­£å¸¸é‡Šæ”¾</p><ul><li>ä½¿ç”¨Luaè„šæœ¬è·å–å’Œåˆ é™¤é”ï¼Œä¿è¯åŸå­æ€§</li><li>å¿…é¡»ä½¿ç”¨try catch åœ¨finallyä¸­é‡Šæ”¾é”ï¼Œå¦åˆ™æœ‰å¼‚å¸¸ï¼Œé”ä¾¿æ²¡æ³•é‡Šæ”¾ï¼Œå…¶ä»–çº¿ç¨‹è¿›æ¥å°±ä¼šä¸€ç›´æ‰§è¡Œå¤±è´¥</li></ul></li><li><p>éœ€è¦æ”¯æŒé”é‡å…¥ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹å¯èƒ½å¤šæ¬¡è·å–åŒä¸€æŠŠé”</p></li><li><p>éœ€è¦é‡è¯•æœºåˆ¶ï¼Œé¿å…é”åªå°è¯•ä¸€æ¬¡å°±è¿”å›false</p></li><li><p>å¦‚æœRedisæä¾›äº†ä¸»ä»é›†ç¾¤ï¼Œé‚£ä¹ˆéœ€è¦è€ƒè™‘ä¸»ä»ä¸€è‡´æ€§ã€‚å› ä¸ºä¸»ä»åŒæ­¥å­˜åœ¨å»¶è¿Ÿï¼Œå½“ä¸»å®•æœºæ—¶ï¼Œåœ¨ä¸»èŠ‚ç‚¹ä¸­çš„é”æ•°æ®å¹¶æ²¡æœ‰åŠæ—¶åŒæ­¥åˆ°ä»èŠ‚ç‚¹ä¸­ï¼Œåˆ™ä¼šå¯¼è‡´å…¶ä»–çº¿ç¨‹ä¹Ÿèƒ½è·å¾—é”ï¼Œå¼•å‘çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ˆå»¶è¿Ÿæ—¶é—´æ˜¯åœ¨æ¯«ç§’ä»¥ä¸‹çš„ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µæ¦‚ç‡æä½ï¼‰</p></li></ul><p><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedisLockService</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String LOCK_PREFIX = <span class="hljs-string">&quot;lock:&quot;</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å°è¯•è·å–é”</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> lockKey    é”çš„é”®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> requestId  è¯·æ±‚IDï¼Œç”¨äºè§£é”æ—¶éªŒè¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> expireTime é”çš„è¶…æ—¶æ—¶é—´ï¼Œæ¯«ç§’</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> é”æ˜¯å¦è·å–æˆåŠŸ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryLock</span><span class="hljs-params">(String lockKey, String requestId, <span class="hljs-keyword">long</span> expireTime)</span> </span>&#123;<br>        String key = LOCK_PREFIX + lockKey;<br>        <span class="hljs-comment">// å°è¯•è®¾ç½®é”ï¼Œè¿™é‡ŒSETNXä¸æ˜¯åŸå­æ“ä½œï¼Œå®é™…ä½¿ç”¨æ—¶åº”è€ƒè™‘ä½¿ç”¨Luaè„šæœ¬æˆ–Redis 2.6.12+çš„SETå‘½ä»¤  </span><br>        Boolean result = redisTemplate.opsForValue().setIfAbsent(key, requestId, expireTime, TimeUnit.MILLISECONDS);<br>        <span class="hljs-keyword">return</span> Boolean.TRUE.equals(result);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é‡Šæ”¾é”</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> lockKey   é”çš„é”®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> requestId è¯·æ±‚IDï¼Œç”¨äºéªŒè¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> é”æ˜¯å¦é‡Šæ”¾æˆåŠŸ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">releaseLock</span><span class="hljs-params">(String lockKey, String requestId)</span> </span>&#123;<br>        String key = LOCK_PREFIX + lockKey;<br>        <span class="hljs-comment">// // Lua è„šæœ¬ï¼Œç”¨äºé‡Šæ”¾é”ï¼ŒLua è„šæœ¬å¯ä»¥ç¡®ä¿æ“ä½œçš„åŸå­æ€§ã€‚</span><br>        String lockScript =<br>                <span class="hljs-string">&quot;if redis.call(&#x27;get&#x27;, KEYS[1]) == ARGV[1] then &quot;</span> +<br>                        <span class="hljs-string">&quot;   return redis.call(&#x27;del&#x27;, KEYS[1]) &quot;</span> +<br>                        <span class="hljs-string">&quot;else &quot;</span> +<br>                        <span class="hljs-string">&quot;   return 0 &quot;</span> +<br>                        <span class="hljs-string">&quot;end&quot;</span>;<br>        DefaultRedisScript&lt;Long&gt; releaseLockScript = <span class="hljs-keyword">new</span> DefaultRedisScript&lt;&gt;(lockScript, Long.class);<br>        Long result = redisTemplate.execute(releaseLockScript, Collections.singletonList(key), requestId);<br>        <span class="hljs-keyword">return</span> result != <span class="hljs-keyword">null</span> &amp;&amp; result == <span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-2-4-redisonä½¿ç”¨"><a href="#2-2-4-redisonä½¿ç”¨" class="headerlink" title="2.2.4 redisonä½¿ç”¨"></a>2.2.4 <strong>redisonä½¿ç”¨</strong></h3><p>Redissonæ˜¯ä¸€ä¸ªåŸºäºRedisçš„åˆ†å¸ƒå¼Javaå¯¹è±¡å’ŒæœåŠ¡çš„æ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¥æ”¯æŒå„ç§åˆ†å¸ƒå¼ç³»ç»Ÿåœºæ™¯ã€‚Redissonæä¾›äº†å¤šç§åˆ†å¸ƒå¼é”çš„å®ç°ï¼ŒåŒ…æ‹¬å¯é‡å…¥é”ï¼ˆReentrant Lockï¼‰ã€å…¬å¹³é”ï¼ˆFair Lockï¼‰ã€è”é”ï¼ˆMultiLockï¼‰ã€çº¢é”ï¼ˆRedLockï¼‰ã€è¯»å†™é”ï¼ˆReadWriteLockï¼‰ç­‰ï¼Œç”¨äºåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­å®ç°äº’æ–¥è®¿é—®</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222105112.png" alt="image-20230228222105112"></p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedissonLockExample</span> </span>&#123;<br><br>    <span class="hljs-comment">// Redis æœåŠ¡å™¨é…ç½®  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String REDIS_URL = <span class="hljs-string">&quot;redis://127.0.0.1:6379&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <br>        Config config = <span class="hljs-keyword">new</span> Config();<br>        config.useSingleServer().setAddress(REDIS_URL);<br>        RedissonClient redisson = Redisson.create(config);<br>        String lockKey = <span class="hljs-string">&quot;myLock&quot;</span>;<br><br>        <span class="hljs-comment">// è·å–é”å¯¹è±¡  </span><br>        RLock lock = redisson.getLock(lockKey);<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">boolean</span> res = lock.tryLock(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, TimeUnit.SECONDS); <span class="hljs-comment">// å°è¯•åŠ é”ï¼Œè¿™é‡Œåªæ˜¯ç¤ºä¾‹ï¼ŒRedisson ä¸­é€šå¸¸ä¸è¿™æ ·ç”¨  </span><br>            <span class="hljs-keyword">if</span> (res) &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-comment">// æ‰§è¡Œéœ€è¦åŒæ­¥çš„ä»£ç   </span><br>                    System.out.println(<span class="hljs-string">&quot;Lock acquired, executing task...&quot;</span>);<br>                    <span class="hljs-comment">// æ¨¡æ‹Ÿä»»åŠ¡æ‰§è¡Œ  </span><br>                    Thread.sleep(<span class="hljs-number">2000</span>);<br>                &#125; <span class="hljs-keyword">finally</span> &#123;<br>                    <span class="hljs-comment">// é‡Šæ”¾é”  </span><br>                    lock.unlock();<br>                    System.out.println(<span class="hljs-string">&quot;Lock released&quot;</span>);<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                System.out.println(<span class="hljs-string">&quot;Failed to acquire lock&quot;</span>);<br>            &#125;<br><br>            <span class="hljs-comment">// æˆ–è€…ï¼Œæ›´å¸¸è§çš„ç”¨æ³•æ˜¯ç›´æ¥è°ƒç”¨ lock() æ–¹æ³•é˜»å¡ç­‰å¾…é”ï¼Œå¹¶åœ¨ finally å—ä¸­é‡Šæ”¾é”  </span><br>            lock.lock(); <span class="hljs-comment">// é˜»å¡ç­‰å¾…é”  </span><br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-comment">// æ‰§è¡Œéœ€è¦åŒæ­¥çš„ä»£ç   </span><br>                System.out.println(<span class="hljs-string">&quot;Lock acquired, executing task...&quot;</span>);<br>                <span class="hljs-comment">// æ¨¡æ‹Ÿä»»åŠ¡æ‰§è¡Œ  </span><br>                Thread.sleep(<span class="hljs-number">2000</span>);<br>            &#125; <span class="hljs-keyword">finally</span> &#123;<br>                <span class="hljs-comment">// é‡Šæ”¾é”  </span><br>                lock.unlock();<br>                System.out.println(<span class="hljs-string">&quot;Lock released&quot;</span>);<br>            &#125;<br><br>            <span class="hljs-comment">// æ³¨æ„ï¼šåœ¨ Redisson ä¸­ï¼Œæ‚¨è¿˜å¯ä»¥è®¾ç½®é”çš„è‡ªåŠ¨è¿‡æœŸæ—¶é—´ï¼Œä»¥é¿å…æ­»é”  </span><br>            <span class="hljs-comment">// lock.lock(10, TimeUnit.SECONDS); // ä¸Šé”10ç§’åè‡ªåŠ¨è§£é”  </span><br><br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            Thread.currentThread().interrupt();<br>            <span class="hljs-comment">// å¤„ç†ä¸­æ–­å¼‚å¸¸  </span><br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">// å…³é—­ Redisson å®¢æˆ·ç«¯  </span><br>            redisson.shutdown();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-3-åŸºäº-Zookeeper-çš„åˆ†å¸ƒå¼é”"><a href="#2-3-åŸºäº-Zookeeper-çš„åˆ†å¸ƒå¼é”" class="headerlink" title="2.3 åŸºäº Zookeeper çš„åˆ†å¸ƒå¼é”"></a>2.3 åŸºäº Zookeeper çš„åˆ†å¸ƒå¼é”</h2><p>é€‚ç”¨äºé«˜å¯é ï¼ˆé«˜å¯ç”¨ï¼‰ï¼Œè€Œå¹¶å‘é‡ä¸æ˜¯å¤ªé«˜çš„åœºæ™¯</p><p>ä¼˜ç‚¹ï¼šä¸å­˜åœ¨é”å¤±æ•ˆçš„é—®é¢˜ï¼Œä¸éœ€è¦ç»­å‘½ã€‚</p><p>ç¼ºç‚¹ï¼šå› ä¸ºéœ€è¦é¢‘ç¹çš„åˆ›å»ºå’Œåˆ é™¤èŠ‚ç‚¹ï¼Œæ€§èƒ½ä¸Šä¸å¦‚Redisã€‚ </p><p>åœ¨é«˜æ€§èƒ½ã€é«˜å¹¶å‘çš„åº”ç”¨åœºæ™¯ä¸‹ï¼Œä¸å»ºè®®ä½¿ç”¨ZooKeeperçš„åˆ†å¸ƒå¼é”ã€‚è€Œç”±äºZooKeeper çš„é«˜å¯ç”¨æ€§ï¼Œå› æ­¤åœ¨å¹¶å‘é‡ä¸æ˜¯å¤ªé«˜çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œè¿˜æ˜¯æ¨èä½¿ç”¨ZooKeeperçš„åˆ†å¸ƒå¼é”</p><p><strong>Zookeeperç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯curatorä¸­å·²ç»å®ç°äº†åŸºäºZookeeperçš„åˆ†å¸ƒå¼é”ã€‚</strong></p><h3 id="2-3-1-åŸºäºZookeeperè®¾è®¡æ€è·¯ä¸€"><a href="#2-3-1-åŸºäºZookeeperè®¾è®¡æ€è·¯ä¸€" class="headerlink" title="2.3.1 åŸºäºZookeeperè®¾è®¡æ€è·¯ä¸€"></a>2.3.1 åŸºäºZookeeperè®¾è®¡æ€è·¯ä¸€</h3><p>åˆ©ç”¨Zookeeperåˆ›å»ºä¸´æ—¶èŠ‚ç‚¹æ¥å®ç°åˆ†å¸ƒå¼é”ï¼ŒåŒä¸€è·¯å¾„ä¸‹çš„èŠ‚ç‚¹åç§°ä¸èƒ½é‡å¤ï¼Œæ¥è¡Œé˜²é‡</p><ul><li>åŒä¸€æ—¶åˆ»åªèƒ½å…è®¸ä¸€ä¸ªç«äº‰è€…è·å–é”ã€‚åŠ é”æ—¶æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä¸´æ—¶èŠ‚ç‚¹ã€‚</li><li>å½“ç«äº‰è€…AåŠ é”æˆåŠŸåï¼Œç¬¬ç«äº‰è€…Bå†æ¥åŠ é”å°±ä¼šæŠ›å‡ºèŠ‚ç‚¹åç§°ä¸èƒ½é‡å¤é”™è¯¯ï¼Œå¦‚æœæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼Œæˆ‘ä»¬å°±åˆ¤å®šç«äº‰è€…BåŠ é”å¤±è´¥</li><li>ç«äº‰è€…BåŠ é”å¤±è´¥åï¼Œä¼šé˜»å¡ç­‰å¾…ï¼Œç›‘å¬èŠ‚ç‚¹çŠ¶æ€ï¼Œå½“èŠ‚ç‚¹æ•°æ®åˆ é™¤åï¼Œä¹Ÿå°±æ˜¯ç«äº‰è€…Aé‡Šæ”¾é”ï¼Œå†å»è·å–é”</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221910782.png" alt="image-20230228221910782"></p><p><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ZkDistributedLock</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IZkDataListener</span></span>&#123;<br><br>    <span class="hljs-keyword">private</span> ZkClient zkClient ;<br>    <span class="hljs-keyword">private</span> String path = <span class="hljs-string">&quot;/lock&quot;</span>;<br><br>    <span class="hljs-keyword">private</span> CountDownLatch countDownLatch ;<br>    <span class="hljs-keyword">private</span> String config;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryLock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">if</span>(zkClient ==<span class="hljs-keyword">null</span>)&#123;<br>                <span class="hljs-comment">//å»ºç«‹è¿æ¥</span><br>                zkClient = <span class="hljs-keyword">new</span> ZkClient(config);<br>            &#125;<br>            <span class="hljs-comment">// åˆ›å»ºä¸´æ—¶èŠ‚ç‚¹</span><br>            zkClient.createEphemeral(path);<br><br>        &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>            <span class="hljs-comment">//å­˜åœ¨èŠ‚ç‚¹</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">waitLock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//æ³¨å†Œç›‘å¬</span><br>        zkClient.subscribeDataChanges(path,<span class="hljs-keyword">this</span>);<br>        <span class="hljs-keyword">if</span>(zkClient.exists(path))&#123;<br>            countDownLatch = <span class="hljs-keyword">new</span> CountDownLatch(<span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">try</span> &#123;<br>                countDownLatch.await();  <span class="hljs-comment">//è®¡æ•°å™¨å˜ä¸º0ä¹‹å‰ï¼Œéƒ½ä¼šé˜»å¡</span><br>                <span class="hljs-comment">// è§£é™¤ç›‘å¬</span><br>                zkClient.unsubscribeDataChanges(path,<span class="hljs-keyword">this</span>);<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">unlock</span><span class="hljs-params">()</span> </span>&#123;<br><br>        <span class="hljs-keyword">if</span>(zkClient !=<span class="hljs-keyword">null</span>)&#123;<br>            zkClient.delete(path);<br>            System.out.println(<span class="hljs-string">&quot;-----é‡Šæ”¾é”èµ„æº----&quot;</span>);<br>        &#125;<br><br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDataDeleted</span><span class="hljs-params">(String dataPath)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        countDownLatch.countDown();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDataChange</span><span class="hljs-params">(String dataPath, Object data)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-3-2-åŸºäºZookeeperè®¾è®¡æ€è·¯äºŒ"><a href="#2-3-2-åŸºäºZookeeperè®¾è®¡æ€è·¯äºŒ" class="headerlink" title="2.3.2 åŸºäºZookeeperè®¾è®¡æ€è·¯äºŒ"></a>2.3.2 åŸºäºZookeeperè®¾è®¡æ€è·¯äºŒ</h3><ul><li><p>åˆ©ç”¨Zookeeperåˆ›å»ºä¸´æ—¶æœ‰åºèŠ‚ç‚¹æ¥å®ç°åˆ†å¸ƒå¼é”ï¼Œè°åˆ›å»ºçš„èŠ‚ç‚¹åºå·æœ€å°ï¼Œè°å°±è·å¾—äº†é”ï¼Œ</p></li><li><p>å…¶ä»–èŠ‚ç‚¹å°±ä¼šç›‘å¬åºå·æ¯”è‡ªå·±å°çš„èŠ‚ç‚¹ï¼Œä¸€æ—¦åºå·æ¯”è‡ªå·±å°çš„èŠ‚ç‚¹è¢«åˆ é™¤äº†ï¼Œå…¶ä»–èŠ‚ç‚¹å°±ä¼šå¾—åˆ°ç›¸åº”çš„äº‹ä»¶ï¼Œç„¶åæŸ¥çœ‹è‡ªå·±æ˜¯å¦ä¸ºåºå·æœ€å°çš„èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è·å–é”</p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221920388.png" alt="image-20230228221920388"></p><p><strong>ä»£ç ç¤ºä¾‹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ZkDistributedLock2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IZkDataListener</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> ZkClient zkClient;<br>    <span class="hljs-keyword">private</span> String path;<br>    <span class="hljs-keyword">private</span> String config;<br><br>    <span class="hljs-keyword">private</span> CountDownLatch countDownLatch ;<br>    <span class="hljs-keyword">private</span> String beforePath; <span class="hljs-comment">// å½“å‰èŠ‚ç‚¹å‰ä¸€ä¸ªèŠ‚ç‚¹</span><br>    <span class="hljs-keyword">private</span> String currentPath; <span class="hljs-comment">// å½“å‰èŠ‚ç‚¹</span><br><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ZkDistributedLock2</span><span class="hljs-params">(String config, String path)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.path = path;<br>        <span class="hljs-keyword">this</span>.config = config;<br>        zkClient = <span class="hljs-keyword">new</span> ZkClient(config);<br>        <span class="hljs-keyword">if</span> (!zkClient.exists(path)) &#123;<br>            <span class="hljs-comment">// å¦‚æœæ ¹èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ ¹èŠ‚ç‚¹</span><br>            zkClient.createPersistent(path);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lock</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-comment">//å°è¯•è·å–é”</span><br>        <span class="hljs-keyword">boolean</span> locked = tryLock();<br>        <span class="hljs-keyword">if</span>(locked)&#123;<br>            System.out.println(<span class="hljs-string">&quot;---------è·å–é”---------&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">while</span> (!locked)&#123;<br>            <span class="hljs-comment">//ç­‰å¾…é” é˜»å¡</span><br>            waitLock();<br>            <span class="hljs-comment">//é‡è¯•</span><br>            <span class="hljs-comment">//è·å–ç­‰å¾…çš„å­èŠ‚ç‚¹åˆ—è¡¨</span><br>            List&lt;String&gt; childrens = zkClient.getChildren(path);<br>            <span class="hljs-comment">//åˆ¤æ–­ï¼Œæ˜¯å¦åŠ é”æˆåŠŸ</span><br>            <span class="hljs-keyword">if</span> (checkLocked(childrens)) &#123;<br>                locked = <span class="hljs-keyword">true</span>;<br>            &#125;<br>        &#125;<br><br>    &#125;<br><br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryLock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//åˆ›å»ºä¸´æ—¶æœ‰åºçš„èŠ‚ç‚¹  -e -s</span><br>            currentPath = zkClient.createEphemeralSequential(path+<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-keyword">null</span>);<br>            <span class="hljs-comment">//è·å–åˆ°æ‰€æœ‰å­èŠ‚ç‚¹</span><br>            List&lt;String&gt; childrens = zkClient.getChildren(path);<br>            <span class="hljs-comment">//è·å–ç­‰å¾…çš„å­èŠ‚ç‚¹åˆ—è¡¨ï¼Œåˆ¤æ–­è‡ªå·±æ˜¯å¦ç¬¬ä¸€ä¸ª</span><br>            <span class="hljs-keyword">if</span> (checkLocked(childrens)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>            &#125;<br>            <span class="hljs-comment">// è‹¥ä¸æ˜¯ç¬¬ä¸€ä¸ªï¼Œåˆ™æ‰¾åˆ°è‡ªå·±çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span><br>            <span class="hljs-keyword">int</span> index =  Collections.binarySearch(childrens,<br>                    currentPath.substring(currentPath.lastIndexOf(<span class="hljs-string">&quot;/&quot;</span>) + <span class="hljs-number">1</span>));<br>            <span class="hljs-keyword">if</span>(index&lt;<span class="hljs-number">0</span>)&#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(currentPath+<span class="hljs-string">&quot;èŠ‚ç‚¹æ²¡æœ‰æ‰¾åˆ°&quot;</span> );<br>            &#125;<br>            <span class="hljs-comment">//å¦‚æœè‡ªå·±æ²¡æœ‰è·å¾—é”ï¼Œåˆ™è¦ç›‘å¬å‰ä¸€ä¸ªèŠ‚ç‚¹</span><br>            beforePath = path + <span class="hljs-string">&quot;/&quot;</span> + childrens.get(index-<span class="hljs-number">1</span>);<br>        &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br><br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">checkLocked</span><span class="hljs-params">(List&lt;String&gt; childrens)</span> </span>&#123;<br><br>        <span class="hljs-comment">//èŠ‚ç‚¹æŒ‰ç…§ç¼–å·ï¼Œå‡åºæ’åˆ—</span><br>        Collections.sort(childrens);<br><br>        <span class="hljs-comment">// å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªï¼Œä»£è¡¨è‡ªå·±å·²ç»è·å¾—äº†é”</span><br>        <span class="hljs-keyword">if</span> (currentPath.equals(path + <span class="hljs-string">&quot;/&quot;</span> +childrens.get(<span class="hljs-number">0</span>))) &#123;<br>            System.out.println(<span class="hljs-string">&quot;æˆåŠŸçš„è·å–åˆ†å¸ƒå¼é”,èŠ‚ç‚¹ä¸º&quot;</span>+ currentPath);<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">waitLock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            countDownLatch = <span class="hljs-keyword">new</span> CountDownLatch(<span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">if</span>(zkClient.exists(beforePath)) &#123;<br>                <span class="hljs-comment">//è®¢é˜…æ¯”è‡ªå·±æ¬¡å°é¡ºåºèŠ‚ç‚¹çš„åˆ é™¤äº‹ä»¶   index-1</span><br>                zkClient.subscribeDataChanges(beforePath, <span class="hljs-keyword">this</span>);<br>                countDownLatch.await();<br>                zkClient.unsubscribeDataChanges(beforePath, <span class="hljs-keyword">this</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">unlock</span><span class="hljs-params">()</span> </span>&#123;<br><br>        <span class="hljs-keyword">if</span>(zkClient !=<span class="hljs-keyword">null</span>)&#123;<br>            <span class="hljs-comment">//åˆ é™¤ä¸´æ—¶èŠ‚ç‚¹</span><br>            zkClient.delete(currentPath,-<span class="hljs-number">1</span>);<br>            System.out.println(currentPath+<span class="hljs-string">&quot; èŠ‚ç‚¹é‡Šæ”¾é”èµ„æº&quot;</span>);<br>        &#125;<br>    &#125;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDataChange</span><span class="hljs-params">(String dataPath, Object data)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDataDeleted</span><span class="hljs-params">(String dataPath)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        countDownLatch.countDown(); <span class="hljs-comment">//å‡1</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-3-3-Apache-Curator-ä½¿ç”¨"><a href="#2-3-3-Apache-Curator-ä½¿ç”¨" class="headerlink" title="2.3.3 Apache Curator ä½¿ç”¨"></a>2.3.3 Apache Curator ä½¿ç”¨</h3><p>Apache Curator æ˜¯ä¸€ä¸ªå¼€æºçš„å®¢æˆ·ç«¯åº“ï¼Œç”¨äºç®€åŒ– Apache ZooKeeper çš„ä½¿ç”¨ã€‚Curator æä¾›äº†ä¸°å¯Œçš„ APIï¼Œå…¶ä¸­åŒ…æ‹¬å®ç°åˆ†å¸ƒå¼é”çš„åŠŸèƒ½ã€‚Curator çš„ <code>InterProcessMutex</code> ç±»æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼å¯é‡å…¥äº’æ–¥é”çš„å®ç°ï¼Œéå¸¸é€‚åˆåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç”¨æ¥åŒæ­¥èµ„æºè®¿é—®ã€‚</p><h4 id="1-æ·»åŠ -Curator-ä¾èµ–"><a href="#1-æ·»åŠ -Curator-ä¾èµ–" class="headerlink" title="1. æ·»åŠ  Curator ä¾èµ–"></a>1. æ·»åŠ  Curator ä¾èµ–</h4><p>é¦–å…ˆï¼Œä½ éœ€è¦åœ¨ä½ çš„é¡¹ç›®ä¸­æ·»åŠ  Curator çš„ Maven ä¾èµ–ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  <br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.curator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  <br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>curator-framework<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  <br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>ä½ çš„ç‰ˆæœ¬å·<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  <br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.curator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  <br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>curator-recipes<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  <br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>ä½ çš„ç‰ˆæœ¬å·<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¯·æ›¿æ¢ <code>ä½ çš„ç‰ˆæœ¬å·</code> ä¸ºä½ æƒ³è¦ä½¿ç”¨çš„ Curator ç‰ˆæœ¬ã€‚</p><h4 id="2-é…ç½®-Curator-å®¢æˆ·ç«¯"><a href="#2-é…ç½®-Curator-å®¢æˆ·ç«¯" class="headerlink" title="2. é…ç½® Curator å®¢æˆ·ç«¯"></a>2. é…ç½® Curator å®¢æˆ·ç«¯</h4><p>ä½ éœ€è¦é…ç½®ä¸€ä¸ª Curator å®¢æˆ·ç«¯ï¼ŒæŒ‡å®š ZooKeeper çš„æœåŠ¡å™¨åœ°å€ç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.apache.curator.framework.CuratorFramework;  <br><span class="hljs-keyword">import</span> org.apache.curator.framework.CuratorFrameworkFactory;  <br><span class="hljs-keyword">import</span> org.apache.curator.retry.ExponentialBackoffRetry;  <br>  <br>CuratorFramework client = CuratorFrameworkFactory.newClient(  <br>    <span class="hljs-string">&quot;127.0.0.1:2181&quot;</span>, <span class="hljs-comment">// ZooKeeper åœ°å€  </span><br>    <span class="hljs-keyword">new</span> ExponentialBackoffRetry(<span class="hljs-number">1000</span>, <span class="hljs-number">3</span>) <span class="hljs-comment">// é‡è¯•ç­–ç•¥  </span><br>);  <br>client.start();<br></code></pre></td></tr></table></figure><h4 id="3-Curatorå®ç°åˆ†å¸ƒå¼é”"><a href="#3-Curatorå®ç°åˆ†å¸ƒå¼é”" class="headerlink" title="3. Curatorå®ç°åˆ†å¸ƒå¼é”"></a>3. Curatorå®ç°åˆ†å¸ƒå¼é”</h4><p>ä½¿ç”¨ Curator çš„ <code>InterProcessMutex</code> ç±»æ¥å®ç°åˆ†å¸ƒå¼é”ã€‚</p><p><strong>æ³¨æ„äº‹é¡¹</strong></p><ul><li>ç¡®ä¿ ZooKeeper æœåŠ¡æ­£åœ¨è¿è¡Œã€‚</li><li>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½¿ç”¨ Curator çš„é…ç½®å¯èƒ½éœ€è¦æ›´å¤šçš„ç»†åŒ–å’Œä¼˜åŒ–ï¼Œä¾‹å¦‚ä½¿ç”¨æ›´å¤æ‚çš„é‡è¯•ç­–ç•¥æˆ–é…ç½®è¿æ¥æ± ã€‚</li><li><code>InterProcessMutex</code> æä¾›äº†å¯é‡å…¥é”çš„åŠŸèƒ½ï¼Œè¿™æ„å‘³ç€åŒä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥å¤šæ¬¡è·å–åŒä¸€æŠŠé”ã€‚</li><li>åœ¨ <code>finally</code> å—ä¸­é‡Šæ”¾é”æ˜¯éå¸¸é‡è¦çš„ï¼Œä»¥é¿å…æ­»é”ã€‚</li><li>Curator è¿˜æä¾›äº†å…¶ä»–ç±»å‹çš„é”ï¼Œå¦‚ <code>InterProcessSemaphoreMutex</code>ï¼ˆä¿¡å·é‡é”ï¼‰å’Œ <code>InterProcessReadWriteLock</code>ï¼ˆè¯»å†™é”ï¼‰ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©ä½¿ç”¨ã€‚</li></ul><p>ä½¿ç”¨ Curator çš„åˆ†å¸ƒå¼é”å¯ä»¥æå¤§åœ°ç®€åŒ–åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„åŒæ­¥æ§åˆ¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.apache.curator.framework.recipes.locks.InterProcessMutex;  <br><span class="hljs-keyword">import</span> org.apache.curator.framework.recipes.locks.LockAcquireException;  <br>  <br><span class="hljs-comment">// é”çš„è·¯å¾„ï¼ˆé€šå¸¸æ˜¯ ZooKeeper ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹è·¯å¾„ï¼‰  </span><br>String lockPath = <span class="hljs-string">&quot;/locks/myLock&quot;</span>;  <br>  <br><span class="hljs-comment">// åˆ›å»ºé”å¯¹è±¡  </span><br>InterProcessMutex lock = <span class="hljs-keyword">new</span> InterProcessMutex(client, lockPath);  <br>  <br><span class="hljs-keyword">try</span> &#123;  <br>    <span class="hljs-comment">// å°è¯•è·å–é”  </span><br>    <span class="hljs-keyword">if</span> (lock.acquire(<span class="hljs-number">10</span>, TimeUnit.SECONDS)) &#123;  <br>        <span class="hljs-keyword">try</span> &#123;  <br>            <span class="hljs-comment">// æ‰§è¡Œä½ çš„åŒæ­¥ä»£ç   </span><br>            System.out.println(<span class="hljs-string">&quot;Lock acquired, executing task...&quot;</span>);  <br>            <span class="hljs-comment">// æ¨¡æ‹Ÿä»»åŠ¡æ‰§è¡Œ  </span><br>            Thread.sleep(<span class="hljs-number">2000</span>);  <br>        &#125; <span class="hljs-keyword">finally</span> &#123;  <br>            <span class="hljs-comment">// é‡Šæ”¾é”  </span><br>            lock.release();  <br>            System.out.println(<span class="hljs-string">&quot;Lock released&quot;</span>);  <br>        &#125;  <br>    &#125; <span class="hljs-keyword">else</span> &#123;  <br>        <span class="hljs-comment">// å¦‚æœåœ¨è§„å®šæ—¶é—´å†…æ²¡æœ‰è·å–åˆ°é”  </span><br>        System.out.println(<span class="hljs-string">&quot;Failed to acquire lock&quot;</span>);  <br>    &#125;  <br>&#125; <span class="hljs-keyword">catch</span> (InterruptedException | LockAcquireException e) &#123;  <br>    Thread.currentThread().interrupt();  <br>    <span class="hljs-comment">// å¤„ç†å¼‚å¸¸  </span><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CAPåŸåˆ™ä»¥åŠeurekaå’Œzookeeperçš„å¯¹æ¯”</title>
    <link href="/CAP%E5%8E%9F%E5%88%99%E4%BB%A5%E5%8F%8Aeureka%E5%92%8Czookeeper%E7%9A%84%E5%AF%B9%E6%AF%94/"/>
    <url>/CAP%E5%8E%9F%E5%88%99%E4%BB%A5%E5%8F%8Aeureka%E5%92%8Czookeeper%E7%9A%84%E5%AF%B9%E6%AF%94/</url>
    
    <content type="html"><![CDATA[<h1 id="1-CAPç†è®ºæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-CAPç†è®ºæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1 CAPç†è®ºæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1 CAPç†è®ºæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>CAPå³ï¼š</p><ul><li>Consistencyï¼ˆä¸€è‡´æ€§ï¼‰ï¼šå¯¹äºå®¢æˆ·ç«¯çš„æ¯æ¬¡è¯»æ“ä½œï¼Œè¦ä¹ˆè¯»åˆ°çš„æ˜¯æœ€æ–°çš„æ•°æ®ï¼Œè¦ä¹ˆè¯»å–å¤±è´¥ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯æˆ–è¶…æ—¶ï¼Œå…¶å¼ºè°ƒçš„æ˜¯æ•°æ®æ­£ç¡®ã€‚</li><li>Availabilityï¼ˆå¯ç”¨æ€§ï¼‰ï¼šä»»ä½•å®¢æˆ·ç«¯çš„è¯·æ±‚éƒ½èƒ½å¾—åˆ°å“åº”æ•°æ®ï¼Œä¸ä¼šå‡ºç°å“åº”é”™è¯¯ï¼Œä½†ä¸ä¿è¯æ•°æ®æœ€æ–°ï¼Œå¼ºè°ƒçš„æ˜¯ä¸å‡ºé”™ã€‚æ¯”å¦‚æˆ‘ä»¬è´­ä¹°å•†å“æ—¶ï¼Œä»–çš„ç‚¹èµæ•°å°±ä¸è´­ä¹°å•†å“æ— å…³ï¼Œæˆ‘ä»¬å¯ä»¥å…è®¸ä»–ä¸æ˜¯æœ€æ–°çš„ã€‚</li><li>Partition toleranceï¼ˆåˆ†åŒºå®¹å¿æ€§ï¼‰ï¼šç”±äºåˆ†å¸ƒå¼ç³»ç»Ÿé€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼Œç½‘ç»œæ˜¯ä¸å¯é çš„ã€‚å½“ä»»æ„æ•°é‡çš„æ¶ˆæ¯ä¸¢å¤±æˆ–å»¶è¿Ÿåˆ°è¾¾æ—¶ï¼Œç³»ç»Ÿä»ä¼šç»§ç»­æä¾›æœåŠ¡ï¼Œä¸ä¼šæŒ‚æ‰ã€‚</li></ul><p>è¿™ä¸‰ä¸ªæ€§è´¨å¯¹åº”äº†åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸‰ä¸ªæŒ‡æ ‡ã€‚è€ŒCAPç†è®ºè¯´çš„å°±æ˜¯ï¼šä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä¸å¯èƒ½åŒæ—¶åšåˆ°è¿™ä¸‰ç‚¹ã€‚åˆ†å¸ƒå¼ç³»ç»Ÿå¿…é¡»æ»¡è¶³åˆ†åŒºå®¹é”™æ€§ï¼Œæ‰€ä»¥è¦ä¹ˆæ˜¯AP,è¦ä¹ˆæ˜¯CPã€‚</p><h1 id="2-åˆ†å¸ƒå¼CAPå®šç†ï¼Œä¸ºä»€ä¹ˆä¸èƒ½åŒæ—¶æ»¡è¶³ä¸‰ä¸ªç‰¹æ€§"><a href="#2-åˆ†å¸ƒå¼CAPå®šç†ï¼Œä¸ºä»€ä¹ˆä¸èƒ½åŒæ—¶æ»¡è¶³ä¸‰ä¸ªç‰¹æ€§" class="headerlink" title="2 åˆ†å¸ƒå¼CAPå®šç†ï¼Œä¸ºä»€ä¹ˆä¸èƒ½åŒæ—¶æ»¡è¶³ä¸‰ä¸ªç‰¹æ€§"></a>2 åˆ†å¸ƒå¼CAPå®šç†ï¼Œä¸ºä»€ä¹ˆä¸èƒ½åŒæ—¶æ»¡è¶³ä¸‰ä¸ªç‰¹æ€§</h1><p>å‡è®¾æœ‰ä¸¤å°æœåŠ¡å™¨ï¼Œä¸€å°æ”¾ç€åº”ç”¨Aå’Œæ•°æ®åº“Vï¼Œä¸€å°æ”¾ç€åº”ç”¨Bå’Œæ•°æ®åº“Vï¼Œä»–ä»¬ä¹‹é—´çš„ç½‘ç»œå¯ä»¥äº’é€šï¼Œä¹Ÿå°±ç›¸å½“äºåˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸¤ä¸ªéƒ¨åˆ†ã€‚</p><p>åœ¨æ»¡è¶³ä¸€è‡´æ€§çš„æ—¶å€™ï¼Œä¸¤å°æœåŠ¡å™¨(å‡è®¾ä¸ºN1,N2)çš„æ•°æ®æ˜¯ä¸€æ ·çš„ï¼ŒDB0&#x3D;DB0ã€‚åœ¨æ»¡è¶³å¯ç”¨æ€§çš„æ—¶å€™ï¼Œç”¨æˆ·ä¸ç®¡æ˜¯è¯·æ±‚N1æˆ–è€…N2ï¼Œéƒ½ä¼šå¾—åˆ°ç«‹å³å“åº”ã€‚åœ¨æ»¡è¶³åˆ†åŒºå®¹é”™æ€§çš„æƒ…å†µä¸‹ï¼ŒN1å’ŒN2æœ‰ä»»ä½•ä¸€æ–¹å®•æœºï¼Œæˆ–è€…ç½‘ç»œä¸é€šçš„æ—¶å€™ï¼Œéƒ½ä¸ä¼šå½±å“N1å’ŒN2å½¼æ­¤ä¹‹é—´çš„æ­£å¸¸è¿ä½œã€‚</p><p>ç”¨æˆ·é€šè¿‡N1ä¸­çš„Aåº”ç”¨è¯·æ±‚æ•°æ®æ›´æ–°åˆ°æœåŠ¡å™¨DB0ï¼Œè¿™æ—¶N1ä¸­çš„æœåŠ¡å™¨DB0å˜ä¸ºDB1ï¼Œé€šè¿‡åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ•°æ®åŒæ­¥æ›´æ–°æ“ä½œï¼ŒN2æœåŠ¡å™¨ä¸­çš„æ•°æ®åº“V0ä¹Ÿæ›´æ–°ä¸ºäº†DB1ï¼ˆå›¾2ï¼‰ï¼Œè¿™æ—¶ï¼Œç”¨æˆ·é€šè¿‡Bå‘æ•°æ®åº“å‘èµ·è¯·æ±‚å¾—åˆ°çš„æ•°æ®å°±æ˜¯å³æ—¶æ›´æ–°åçš„æ•°æ®DB1ã€‚</p><p>ä¸Šé¢æ˜¯æ­£å¸¸è¿ä½œçš„æƒ…å†µï¼Œä½†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæœ€å¤§çš„é—®é¢˜å°±æ˜¯ç½‘ç»œï¼Œç°åœ¨å‡è®¾ä¸€ç§æç«¯æƒ…å†µï¼ŒN1å’ŒN2ä¹‹é—´çš„ç½‘ç»œæ–­å¼€äº†ï¼Œä½†æˆ‘ä»¬ä»è¦æ”¯æŒè¿™ç§ç½‘ç»œå¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯æ»¡è¶³åˆ†åŒºå®¹é”™æ€§ï¼Œé‚£ä¹ˆè¿™æ ·èƒ½ä¸èƒ½åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§å’Œå¯ç”¨æ€§å‘¢ï¼Ÿ</p><p>å‡è®¾N1å’ŒN2ä¹‹é—´é€šä¿¡çš„æ—¶å€™ç½‘ç»œçªç„¶å‡ºç°æ•…éšœï¼Œæœ‰ç”¨æˆ·å‘N1å‘é€æ•°æ®æ›´æ–°è¯·æ±‚ï¼Œé‚£N1ä¸­çš„æ•°æ®DB0å°†è¢«æ›´æ–°ä¸ºDB1ï¼Œç”±äºç½‘ç»œæ˜¯æ–­å¼€çš„ï¼ŒN2ä¸­çš„æ•°æ®åº“ä»æ—§æ˜¯DB0ï¼›</p><p>å¦‚æœè¿™ä¸ªæ—¶å€™ï¼Œæœ‰ç”¨æˆ·å‘N2å‘é€æ•°æ®è¯»å–è¯·æ±‚ï¼Œç”±äºæ•°æ®è¿˜æ²¡æœ‰è¿›è¡ŒåŒæ­¥ï¼Œåº”ç”¨ç¨‹åºæ²¡åŠæ³•ç«‹å³ç»™ç”¨æˆ·è¿”å›æœ€æ–°çš„æ•°æ®DB1ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿæœ‰äºŒç§é€‰æ‹©ï¼Œç¬¬ä¸€ï¼Œç‰ºç‰²æ•°æ®ä¸€è‡´æ€§ï¼Œå“åº”æ—§çš„æ•°æ®DB0ç»™ç”¨æˆ·ï¼›ç¬¬äºŒï¼Œç‰ºç‰²å¯ç”¨æ€§ï¼Œé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°ç½‘ç»œè¿æ¥æ¢å¤ï¼Œæ•°æ®æ›´æ–°æ“ä½œå®Œæˆä¹‹åï¼Œå†ç»™ç”¨æˆ·å“åº”æœ€æ–°çš„æ•°æ®DB1ã€‚</p><h1 id="3-ä½œä¸ºæœåŠ¡ä¸­å¿ƒï¼Œeurekaå’Œzookeeperçš„å¯¹æ¯”"><a href="#3-ä½œä¸ºæœåŠ¡ä¸­å¿ƒï¼Œeurekaå’Œzookeeperçš„å¯¹æ¯”" class="headerlink" title="3 ä½œä¸ºæœåŠ¡ä¸­å¿ƒï¼Œeurekaå’Œzookeeperçš„å¯¹æ¯”"></a>3 ä½œä¸ºæœåŠ¡ä¸­å¿ƒï¼Œeurekaå’Œzookeeperçš„å¯¹æ¯”</h1><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228233310740.png" alt="image-20230228233310740"></p><h2 id="3-1-é›†ç¾¤æ–¹å¼ä¸åŒ"><a href="#3-1-é›†ç¾¤æ–¹å¼ä¸åŒ" class="headerlink" title="3.1 é›†ç¾¤æ–¹å¼ä¸åŒ"></a>3.1 é›†ç¾¤æ–¹å¼ä¸åŒ</h2><ul><li><p>zookeeperé›†ç¾¤æ˜¯å­˜åœ¨leaderå’Œfollowerå…³ç³»çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸»å¤šä»ã€‚</p></li><li><p>eurekaé›†ç¾¤ä¸­çš„å„ä¸ªèŠ‚ç‚¹æ˜¯å¹³ç­‰çš„åœ°ä½ï¼Œpeer to peerå¯¹ç­‰é€šä¿¡ã€‚è¿™æ˜¯ä¸€ç§<strong>å»ä¸­å¿ƒåŒ–</strong>çš„æ¶æ„ï¼Œåœ¨è¿™ç§æ¶æ„é£æ ¼ä¸­ï¼ŒèŠ‚ç‚¹é€šè¿‡å½¼æ­¤äº’ç›¸æ³¨å†Œæ¥æé«˜å¯ç”¨æ€§ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯è¢«è§†ä¸ºå…¶ä»–èŠ‚ç‚¹çš„å‰¯æœ¬</p></li></ul><h2 id="3-2-zookeeper-ä¿è¯CPï¼Œeurekaä¿è¯-AP"><a href="#3-2-zookeeper-ä¿è¯CPï¼Œeurekaä¿è¯-AP" class="headerlink" title="3.2 zookeeper ä¿è¯CPï¼Œeurekaä¿è¯ AP"></a>3.2 zookeeper ä¿è¯CPï¼Œ<strong>eurekaä¿è¯ AP</strong></h2><ul><li><strong>Zookeeperä¿è¯ CP</strong>ï¼Œåœ¨ä½¿ç”¨ Zookeeper è·å–æœåŠ¡åˆ—è¡¨æ—¶ï¼Œå¦‚æœæ­¤æ—¶çš„ Zookeeper é›†ç¾¤ä¸­çš„ Leader å®•æœºäº†ï¼Œè¯¥é›†ç¾¤å°±è¦è¿›è¡Œ Leader çš„é€‰ä¸¾ï¼Œ<strong>é€‰ä¸¾æ˜¯éœ€è¦æ—¶é—´çš„ï¼Œåœ¨è¿™ä¸€æ®µæ—¶é—´å†…ï¼Œå°†æ— æ³•å¤„ç†è¯·æ±‚</strong>ã€‚æ‰€ä»¥è¯´ï¼ŒZookeeper ä¸èƒ½ä¿è¯æœåŠ¡å¯ç”¨æ€§ã€‚</li><li><strong>eurekaä¿è¯ AP</strong>ï¼Œåœ¨Eurekaå¹³å°ä¸­ï¼Œå¦‚æœæŸå°æœåŠ¡å™¨å®•æœºï¼Œå®¢æˆ·ç«¯è¯·æ±‚ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°æ–°çš„EurekaèŠ‚ç‚¹ï¼Œ<strong>åªè¦æœ‰ä¸€å°Eurekaè¿˜åœ¨ï¼Œå°±èƒ½ä¿è¯æ³¨å†ŒæœåŠ¡å¯ç”¨ï¼Œåªä¸è¿‡æŸ¥åˆ°çš„ä¿¡æ¯å¯èƒ½ä¸æ˜¯æœ€æ–°çš„</strong>ã€‚å½“å®•æœºçš„æœåŠ¡å™¨é‡æ–°æ¢å¤åï¼ŒEureka ä¼šå†æ¬¡å°†å…¶çº³å…¥åˆ°æœåŠ¡å™¨é›†ç¾¤ç®¡ç†ä¹‹ä¸­ã€‚</li></ul><h2 id="3-3-zookeeperçš„å®æ—¶æ€§æ›´å¥½"><a href="#3-3-zookeeperçš„å®æ—¶æ€§æ›´å¥½" class="headerlink" title="3.3 zookeeperçš„å®æ—¶æ€§æ›´å¥½"></a>3.3 zookeeperçš„å®æ—¶æ€§æ›´å¥½</h2><p>eurekaæ˜¯é€šè¿‡å¿ƒè·³ä½“åˆ¶ï¼Œæ£€æµ‹èŠ‚ç‚¹æ˜¯å¦æ­£å¸¸ï¼Œç›¸æ¯”äºzookeeperçš„watcheræœºåˆ¶ï¼Œå®æ—¶æ€§ç¨å·®ä¸€ç‚¹</p><p><strong>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸ºäº†æ»¡è¶³ç”¨æˆ·ä½“éªŒï¼Œåº”è¯¥å…ˆé€‰å¯ç”¨æ€§ã€‚æ‰€ä»¥ï¼Œç†è®ºä¸Šæ¥è¯´ï¼ŒEurekaä½œä¸ºç³»ç»ŸæœåŠ¡çš„æ³¨å†Œä¸­å¿ƒæ˜¯æœ€é€‚åˆçš„ã€‚</strong></p>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
      <tag>CAPåŸåˆ™</tag>
      
      <tag>eureka</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç±»åŠ è½½æœºåˆ¶çš„æ·±åº¦è§£æ</title>
    <link href="/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E7%9A%84%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90/"/>
    <url>/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E7%9A%84%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ç±»åŠ è½½è¿è¡Œå…¨è¿‡ç¨‹"><a href="#1-ç±»åŠ è½½è¿è¡Œå…¨è¿‡ç¨‹" class="headerlink" title="1. ç±»åŠ è½½è¿è¡Œå…¨è¿‡ç¨‹"></a>1. ç±»åŠ è½½è¿è¡Œå…¨è¿‡ç¨‹</h1><p>å½“æˆ‘ä»¬ç”¨javaå‘½ä»¤è¿è¡ŒæŸä¸ªç±»çš„mainå‡½æ•°å¯åŠ¨ç¨‹åºæ—¶ï¼Œé¦–å…ˆéœ€è¦é€šè¿‡<strong>ç±»åŠ è½½å™¨</strong>æŠŠä¸»ç±»åŠ è½½åˆ° JVMã€‚</p><p>æœ‰å¦‚ä¸‹å‡ æ­¥ï¼š <strong>åŠ è½½ &gt;&gt; éªŒè¯ &gt;&gt; å‡†å¤‡ &gt;&gt; è§£æ &gt;&gt; åˆå§‹åŒ– &gt;&gt;</strong> ä½¿ç”¨ &gt;&gt; å¸è½½ </p><ol><li><p>åŠ è½½ï¼š</p><ul><li><strong>é€šè¿‡ç±»çš„å…¨é™å®šåè·å–å…¶äºŒè¿›åˆ¶å­—èŠ‚æµ</strong>ï¼šå¯ä»¥ä»æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œæˆ–å…¶ä»–æ¥æºè·å–å­—èŠ‚ç ã€‚</li><li>å°†å­—èŠ‚æµè½¬æ¢ä¸ºæ–¹æ³•åŒºä¸­çš„å¯¹åº”çš„ç±»ç»“æ„ã€‚</li></ul><h5 id="åŠ è½½çš„æ–¹å¼"><a href="#åŠ è½½çš„æ–¹å¼" class="headerlink" title="åŠ è½½çš„æ–¹å¼"></a><strong>åŠ è½½çš„æ–¹å¼</strong></h5><ul><li><strong>å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰</strong>ï¼šè´Ÿè´£åŠ è½½æ ¸å¿ƒç±»åº“ï¼ˆå¦‚ <code>rt.jar</code> ä¸­çš„ç±»ï¼‰ã€‚</li><li><strong>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰</strong>ï¼šè´Ÿè´£åŠ è½½æ‰©å±•ç±»åº“ï¼ˆå¦‚ <code>jre/lib/ext</code> ç›®å½•ä¸‹çš„ç±»ï¼‰ã€‚</li><li><strong>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰</strong>ï¼šè´Ÿè´£åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ï¼ˆclasspathï¼‰ä¸­çš„ç±»ã€‚</li><li><strong>è‡ªå®šä¹‰ç±»åŠ è½½å™¨</strong>ï¼šå¯ä»¥é€šè¿‡ç»§æ‰¿ <code>java.lang.ClassLoader</code> å®ç°è‡ªå®šä¹‰åŠ è½½é€»è¾‘ã€‚</li></ul></li><li><p>éªŒè¯ï¼š</p><ul><li>æ ¡éªŒå­—èŠ‚ç æ–‡ä»¶çš„æ­£ç¡®æ€§ä¸”ç¬¦åˆ JVM è§„èŒƒï¼Œé˜²æ­¢æ¶æ„ä»£ç ç ´åè™šæ‹Ÿæœºçš„å®‰å…¨æ€§ã€‚</li><li>éªŒè¯æ˜¯ä¸€ä¸ªè€—æ—¶ä½†å¿…è¦çš„è¿‡ç¨‹ï¼Œç¡®ä¿äº†ç±»çš„æ­£ç¡®æ€§å’Œå®‰å…¨æ€§ã€‚</li></ul></li><li><p>å‡†å¤‡ï¼š</p><ul><li>ç»™ç±»çš„é™æ€å˜é‡åˆ†é…å†…å­˜ï¼Œ</li><li><strong>è®¾ç½®é»˜è®¤å€¼</strong>ï¼šå°†é™æ€å˜é‡åˆå§‹åŒ–ä¸ºå…¶ç±»å‹çš„é›¶å€¼ï¼ˆå¦‚ <code>int</code> ç±»å‹ä¸º <code>0</code>ï¼Œ<code>boolean</code> ç±»å‹ä¸º <code>false</code>ï¼Œå¼•ç”¨ç±»å‹ä¸º <code>null</code>ï¼‰ ã€‚ï¼ˆå¦‚ <code>int</code> ç±»å‹ä¸º <code>0</code>ï¼Œ<code>boolean</code> ç±»å‹ä¸º <code>false</code>ï¼Œå¼•ç”¨ç±»å‹ä¸º <code>null</code>ï¼‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span> </span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> value = <span class="hljs-number">123</span>; <span class="hljs-comment">// é™æ€å˜é‡</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li>åœ¨å‡†å¤‡é˜¶æ®µï¼Œ<code>value</code> è¢«åˆ†é…å†…å­˜å¹¶åˆå§‹åŒ–ä¸º <code>0</code>ã€‚</li><li>åˆå§‹åŒ–é˜¶æ®µæ‰ä¼šå°† <code>value</code> è®¾ç½®ä¸º <code>123</code>ã€‚</li></ul></li><li><p>è§£æï¼šå°†<strong>ç¬¦å·å¼•ç”¨</strong>æ›¿æ¢ä¸ºåœ°å€å¼•ç”¨</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-bullet">- </span>ç¬¦å·å¼•ç”¨æ˜¯ä»¥æ–‡æœ¬å½¢å¼è¡¨ç¤ºçš„ç›®æ ‡åœ°å€æˆ–å¯¹è±¡çš„é€»è¾‘åç§°ã€‚å®ƒå¹¶ä¸ç›´æ¥æŒ‡å‘å†…å­˜ä¸­çš„å®é™…ä½ç½®ï¼Œè€Œæ˜¯é€šè¿‡æŸç§é—´æ¥çš„æ–¹å¼ï¼ˆå¦‚åç§°ã€è·¯å¾„ç­‰ï¼‰æè¿°ç›®æ ‡å¯¹è±¡çš„ä½ç½®<br><span class="hljs-bullet">- </span>ç›´æ¥å¼•ç”¨æ˜¯æŒ‡å‘ç›®æ ‡å¯¹è±¡åœ¨å†…å­˜ä¸­çš„å®é™…åœ°å€ã€‚å®ƒæ˜¯å…·ä½“çš„ç‰©ç†åœ°å€ï¼Œå¯ä»¥ç›´æ¥ç”¨äºè®¿é—®ç›®æ ‡å¯¹è±¡ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">ä¸¾ä¾‹ï¼š <br>å‡è®¾æœ‰ä¸€ä¸ªç±» `A` ä¸­å®šä¹‰äº†ä¸€ä¸ªæ–¹æ³• `void foo()`ï¼Œåœ¨å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•å¯èƒ½ä»¥ç¬¦å·å¼•ç”¨çš„å½¢å¼è¡¨ç¤ºä¸ºï¼š<span class="hljs-function"><span class="hljs-keyword">Method</span> #5;</span> <span class="hljs-comment">// NameAndType foo:()V, è¿™é‡Œçš„ `#5` æ˜¯ä¸€ä¸ªç´¢å¼•ï¼ŒæŒ‡å‘å¸¸é‡æ± ä¸­çš„æŸä¸ªæ¡ç›®ï¼Œè€Œ `NameAndType foo:()V` è¡¨ç¤ºæ–¹æ³•çš„åå­—å’Œç­¾åã€‚</span><br>åœ¨è¿è¡Œæ—¶ï¼ŒJVM å°†ä¸Šè¿°ç¬¦å·å¼•ç”¨è§£æä¸ºå®é™…çš„å†…å­˜åœ°å€ï¼Œä¾‹å¦‚ï¼š<span class="hljs-number">0</span>x7f8000001234, è¿™ä¸ªåœ°å€å¯ä»¥ç›´æ¥å®šä½åˆ°æ–¹æ³• `foo()` çš„ä»£ç æ®µã€‚<br></code></pre></td></tr></table></figure></li><li><p><strong>åˆå§‹åŒ–</strong>ï¼š</p><ul><li><p>å¯¹ç±»çš„é™æ€å˜é‡åˆå§‹åŒ–ä¸ºæŒ‡å®šçš„å€¼</p></li><li><p>æ‰§è¡Œé™æ€ä»£ç å—</p></li></ul></li></ol><h1 id="2-ç±»åŠ è½½å™¨"><a href="#2-ç±»åŠ è½½å™¨" class="headerlink" title="2. ç±»åŠ è½½å™¨"></a>2. <strong>ç±»åŠ è½½å™¨</strong></h1><ol><li>**å¼•å¯¼ç±»åŠ è½½å™¨ (Bootstrap ClassLoader)**ï¼š<ul><li><strong>èŒè´£</strong>ï¼šåŠ è½½ Java æ ¸å¿ƒåº“ä¸­çš„ç±»ï¼Œå¦‚ <code>java.lang.*</code>ã€<code>java.util.*</code> ç­‰ã€‚</li><li><strong>åŠ è½½è·¯å¾„</strong>ï¼šJVM å¯åŠ¨æ—¶æŒ‡å®šçš„ <code>rt.jar</code> æˆ–è€… <code>jmod</code> æ–‡ä»¶ä¸­çš„ç±»ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼šç”± JVM å®ç°ï¼Œä½¿ç”¨æœ¬åœ°ä»£ç ï¼Œä¸æ˜¯ä¸€ä¸ªæ™®é€šçš„ Java ç±»ã€‚</li></ul></li><li>**æ‰©å±•ç±»åŠ è½½å™¨ (Extension ClassLoader)**ï¼š<ul><li><strong>èŒè´£</strong>ï¼šåŠ è½½æ ‡å‡†æ‰©å±•åº“ä¸­çš„ç±»ï¼Œä½äº <code>JAVA_HOME/lib/ext</code> ç›®å½•æˆ–ç”±ç³»ç»Ÿå±æ€§ <code>java.ext.dirs</code> æŒ‡å®šçš„ç›®å½•ã€‚</li><li><strong>åŠ è½½è·¯å¾„</strong>ï¼š<code>lib/ext</code> ç›®å½•ä¸­çš„ JAR æ–‡ä»¶ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼šç”± Java å®ç°ï¼Œç»§æ‰¿è‡ª <code>ClassLoader</code> ç±»ã€‚</li></ul></li><li>**ç³»ç»Ÿç±»åŠ è½½å™¨ (System ClassLoader) &#x2F; åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ (Application ClassLoader)**ï¼š<ul><li><strong>èŒè´£</strong>ï¼šåŠ è½½ç”¨æˆ·ç±»è·¯å¾„ (<code>classpath</code>) ä¸­çš„ç±»ï¼ŒåŒ…å«ç”¨æˆ·å®šä¹‰çš„ç±»å’Œç¬¬ä¸‰æ–¹åº“ã€‚</li><li><strong>åŠ è½½è·¯å¾„</strong>ï¼šé€šè¿‡å‘½ä»¤è¡Œå‚æ•° <code>-classpath</code> æˆ–ç¯å¢ƒå˜é‡ <code>CLASSPATH</code> æŒ‡å®šçš„è·¯å¾„ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼šé»˜è®¤çš„ç±»åŠ è½½å™¨ï¼Œå¯ä»¥é€šè¿‡ <code>ClassLoader.getSystemClassLoader()</code> è·å–ã€‚</li></ul></li><li>**è‡ªå®šä¹‰ç±»åŠ è½½å™¨ (Custom ClassLoader)**ï¼š<ul><li><strong>èŒè´£</strong>ï¼šç”±ç”¨æˆ·å®šä¹‰ï¼Œå¯ä»¥ä»ä»»æ„ä½ç½®åŠ è½½ç±»ï¼Œä¾‹å¦‚ç½‘ç»œã€æ•°æ®åº“ç­‰ã€‚</li><li><strong>åŠ è½½è·¯å¾„</strong>ï¼šç”¨æˆ·å®šä¹‰ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡ç»§æ‰¿ <code>ClassLoader</code> ç±»å¹¶è¦†ç›– <code>findClass</code> æ–¹æ³•æ¥è‡ªå®šä¹‰ç±»åŠ è½½é€»è¾‘ã€‚</li></ul></li></ol><h1 id="3-åŒäº²å§”æ´¾æœºåˆ¶"><a href="#3-åŒäº²å§”æ´¾æœºåˆ¶" class="headerlink" title="3. åŒäº²å§”æ´¾æœºåˆ¶"></a>3. åŒäº²å§”æ´¾æœºåˆ¶</h1><p>å½“æŸä¸ªç±»åŠ è½½å™¨éœ€è¦åŠ è½½æŸä¸ª<code>.class</code>æ–‡ä»¶æ—¶ï¼Œå®ƒé¦–å…ˆæŠŠè¿™ä¸ªä»»åŠ¡å§”æ‰˜ç»™ä»–çš„ä¸Šçº§ç±»åŠ è½½å™¨ï¼Œé€’å½’è¿™ä¸ªæ“ä½œï¼Œå¦‚æœä¸Šçº§çš„ç±»åŠ è½½å™¨æ²¡æœ‰åŠ è½½ï¼Œè‡ªå·±æ‰ä¼šå»åŠ è½½è¿™ä¸ªç±»ã€‚</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20240603232254437.png" alt="image-20240603232254437" style="zoom:50%;" /><p>loadClass æ–¹æ³•çš„ä¸»è¦èŒè´£å°±æ˜¯å®ç°åŒäº²å§”æ´¾æœºåˆ¶ï¼šé¦–å…ˆæ£€æŸ¥è¿™ä¸ªç±»æ˜¯ä¸æ˜¯å·²ç»è¢«åŠ è½½è¿‡äº†ï¼Œå¦‚æœåŠ è½½è¿‡äº†ç›´æ¥è¿”å›ï¼Œå¦åˆ™å§”æ´¾ç»™çˆ¶åŠ è½½å™¨åŠ è½½ï¼Œè¿™æ˜¯ä¸€ä¸ªé€’å½’è°ƒç”¨ï¼Œä¸€å±‚ä¸€å±‚å‘ä¸Šå§”æ´¾ï¼Œæœ€é¡¶å±‚çš„ç±»åŠ è½½å™¨ï¼ˆå¯åŠ¨ç±»åŠ è½½å™¨ï¼‰æ— æ³•åŠ è½½è¯¥ç±»æ—¶ï¼Œå†ä¸€å±‚ä¸€å±‚å‘ä¸‹å§”æ´¾ç»™å­ç±»åŠ è½½å™¨åŠ è½½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClassLoader</span> </span>&#123;<br><br>    <span class="hljs-comment">//æ¯ä¸ªç±»åŠ è½½å™¨éƒ½æœ‰ä¸ªçˆ¶åŠ è½½å™¨</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ClassLoader parent;<br>    <br>    <span class="hljs-keyword">public</span> Class&lt;?&gt; loadClass(String name) &#123;<br>  <br>        <span class="hljs-comment">//æŸ¥æ‰¾ä¸€ä¸‹è¿™ä¸ªç±»æ˜¯ä¸æ˜¯å·²ç»åŠ è½½è¿‡äº†</span><br>        Class&lt;?&gt; c = findLoadedClass(name);<br>        <br>        <span class="hljs-comment">//å¦‚æœæ²¡æœ‰åŠ è½½è¿‡</span><br>        <span class="hljs-keyword">if</span>( c == <span class="hljs-keyword">null</span> )&#123;<br>          <span class="hljs-comment">//å…ˆå§”æ´¾ç»™çˆ¶åŠ è½½å™¨å»åŠ è½½ï¼Œæ³¨æ„è¿™æ˜¯ä¸ªé€’å½’è°ƒç”¨</span><br>          <span class="hljs-keyword">if</span> (parent != <span class="hljs-keyword">null</span>) &#123;<br>              c = parent.loadClass(name);<br>          &#125;<span class="hljs-keyword">else</span> &#123;<br>              <span class="hljs-comment">// å¦‚æœçˆ¶åŠ è½½å™¨ä¸ºç©ºï¼ŒæŸ¥æ‰¾BootstrapåŠ è½½å™¨æ˜¯ä¸æ˜¯åŠ è½½è¿‡äº†</span><br>              c = findBootstrapClassOrNull(name);<br>          &#125;<br>        &#125;<br>        <span class="hljs-comment">// å¦‚æœçˆ¶åŠ è½½å™¨æ²¡åŠ è½½æˆåŠŸï¼Œè°ƒç”¨è‡ªå·±çš„findClasså»åŠ è½½</span><br>        <span class="hljs-keyword">if</span> (c == <span class="hljs-keyword">null</span>) &#123;<br>            c = findClass(name);<br>        &#125;<br>        <br>        <span class="hljs-keyword">return</span> cï¼›<br>    &#125;<br>    <br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt; findClass(String name)&#123;<br>       <span class="hljs-comment">//1. æ ¹æ®ä¼ å…¥çš„ç±»ånameï¼Œåˆ°åœ¨ç‰¹å®šç›®å½•ä¸‹å»å¯»æ‰¾ç±»æ–‡ä»¶ï¼ŒæŠŠ.classæ–‡ä»¶è¯»å…¥å†…å­˜</span><br>          ...<br>          <br>       <span class="hljs-comment">//2. è°ƒç”¨defineClasså°†å­—èŠ‚æ•°ç»„è½¬æˆClasså¯¹è±¡</span><br>       <span class="hljs-keyword">return</span> defineClass(buf, off, len)ï¼›<br>    &#125;<br>    <br>    <span class="hljs-comment">// å°†å­—èŠ‚ç æ•°ç»„è§£ææˆä¸€ä¸ªClasså¯¹è±¡ï¼Œç”¨nativeæ–¹æ³•å®ç°</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> Class&lt;?&gt; defineClass(<span class="hljs-keyword">byte</span>[] b, <span class="hljs-keyword">int</span> off, <span class="hljs-keyword">int</span> len)&#123;<br>       ...<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-1-ä½œç”¨"><a href="#3-1-ä½œç”¨" class="headerlink" title="3.1 ä½œç”¨"></a>3.1 ä½œç”¨</h2><ol><li><p><strong>é˜²æ­¢åŠ è½½åŒä¸€ä¸ª.classã€‚</strong>é€šè¿‡å§”æ‰˜å»è¯¢é—®ä¸Šçº§æ˜¯å¦å·²ç»åŠ è½½è¿‡è¯¥.classï¼Œå¦‚æœåŠ è½½è¿‡äº†ï¼Œåˆ™ä¸éœ€è¦é‡æ–°åŠ è½½ã€‚ä¿è¯äº†æ•°æ®å®‰å…¨ã€‚</p></li><li><p><strong>ä¿è¯æ ¸å¿ƒ.classä¸è¢«ç¯¡æ”¹ã€‚</strong>é€šè¿‡å§”æ‰˜çš„æ–¹å¼ï¼Œä¿è¯æ ¸å¿ƒ.classä¸è¢«ç¯¡æ”¹ï¼Œå³ä½¿è¢«ç¯¡æ”¹ä¹Ÿä¸ä¼šè¢«åŠ è½½ï¼Œå³ä½¿è¢«åŠ è½½ä¹Ÿä¸ä¼šæ˜¯åŒä¸€ä¸ªclasså¯¹è±¡ï¼Œå› ä¸ºä¸åŒçš„åŠ è½½å™¨åŠ è½½åŒä¸€ä¸ª.classä¹Ÿä¸æ˜¯åŒä¸€ä¸ªClasså¯¹è±¡ã€‚è¿™æ ·åˆ™ä¿è¯äº†Classçš„æ‰§è¡Œå®‰å…¨ã€‚</p></li></ol><h2 id="3-2-å¦‚ä½•æ‰“ç ´åŒäº²å§”æ´¾ï¼Ÿ"><a href="#3-2-å¦‚ä½•æ‰“ç ´åŒäº²å§”æ´¾ï¼Ÿ" class="headerlink" title="3.2 å¦‚ä½•æ‰“ç ´åŒäº²å§”æ´¾ï¼Ÿ"></a>3.2 å¦‚ä½•æ‰“ç ´åŒäº²å§”æ´¾ï¼Ÿ</h2><p>æ‰“ç ´åŒäº²å§”æ´¾ï¼Œå…¶å®å°±æ˜¯ä¸èµ°åŒäº²å§”æ´¾é‚£ä¸€å¥—ï¼Œè€Œæ˜¯èµ°è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ã€‚</p><p>åŒäº²å§”æ´¾çš„æœºåˆ¶æ˜¯ClassLoaderä¸­çš„loadClassæ–¹æ³•å®ç°çš„ï¼Œæ‰“ç ´åŒäº²å§”æ´¾ï¼Œå…¶å®å°±æ˜¯é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œæ¥ç”¨æˆ‘ä»¬è‡ªå·±çš„æ–¹å¼æ¥å®ç°å³å¯ã€‚å…¸å‹çš„æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹çš„æ¡†æ¶å’Œä¸­é—´ä»¶æœ‰tomcatã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomClassLoader</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ClassLoader</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String classPath;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CustomClassLoader</span><span class="hljs-params">(String classPath)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.classPath = classPath;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Class&lt;?&gt; loadClass(String name) <span class="hljs-keyword">throws</span> ClassNotFoundException &#123;<br>        <span class="hljs-comment">// å°è¯•åŠ è½½è‡ªå®šä¹‰ç±»</span><br>        Class&lt;?&gt; clazz = findClass(name);<br>        <span class="hljs-keyword">if</span> (clazz != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> clazz;<br>        &#125;<br>        <span class="hljs-comment">// è‡ªå·±åŠ è½½ä¸äº†ï¼Œå†è°ƒç”¨çˆ¶ç±»loadClassï¼Œä¿æŒåŒäº²å§”æ‰˜æ¨¡å¼</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.loadClass(name);<br>    &#125;<br><br>    <span class="hljs-comment">// è‡ªå®šä¹‰ç±»åŠ è½½é€»è¾‘ï¼Œä¾‹å¦‚ä»æ–‡ä»¶ã€ç½‘ç»œç­‰åŠ è½½ç±»å­—èŠ‚ç </span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="hljs-keyword">throws</span> ClassNotFoundException &#123;<br>        <span class="hljs-keyword">byte</span>[] result;<br>        String path = classPath + File.separatorChar + name.replace(<span class="hljs-string">&#x27;.&#x27;</span>, File.separatorChar) + <span class="hljs-string">&quot;.class&quot;</span>;<br>        <span class="hljs-keyword">try</span> (FileInputStream fis = <span class="hljs-keyword">new</span> FileInputStream(path)) &#123;<br>            <span class="hljs-keyword">byte</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[fis.available()];<br>            fis.read(buffer);<br>            result = buffer;<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ClassNotFoundException(<span class="hljs-string">&quot;Could not load class &quot;</span> + name, e);<br>        &#125;<br>        <span class="hljs-keyword">return</span> defineClass(name, result, <span class="hljs-number">0</span>, result.length);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç±»åŠ è½½æœºåˆ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°å½•ç”±äºæ•°æ®åº“ç”¨æˆ·æƒé™å¯¼è‡´çš„ä¸€æ¬¡çº¿ä¸Šäº‹æ•…</title>
    <link href="/%E8%AE%B0%E5%BD%95%E7%94%B1%E4%BA%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%80%E6%AC%A1%E7%BA%BF%E4%B8%8A%E4%BA%8B%E6%95%85/"/>
    <url>/%E8%AE%B0%E5%BD%95%E7%94%B1%E4%BA%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%80%E6%AC%A1%E7%BA%BF%E4%B8%8A%E4%BA%8B%E6%95%85/</url>
    
    <content type="html"><![CDATA[<h1 id="1-èƒŒæ™¯"><a href="#1-èƒŒæ™¯" class="headerlink" title="1. èƒŒæ™¯"></a>1. èƒŒæ™¯</h1><ul><li>11.3 ç”Ÿäº§ç¯å¢ƒå’Œç”¨æˆ·æŸ¥è¯¢ç›¸å…³çš„åŠŸèƒ½ï¼Œéƒ½æŠ¥é”™could not extract ResultSet; SQL [n&#x2F;a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet</li><li>ELKæŸ¥è¯¢åŸå› ï¼ŒCaused by: org.postgresql.util.PSQLException: é”™è¯¯: å¯¹è¡¨ em_adm_user_group æƒé™ä¸å¤Ÿ</li><li>f lywayæ–°å»ºäº†V20231031155120__DDL_create_user_group.sqlï¼Œå¹¶ä¸”userVo join user_groupï¼Œæ‰€ä»¥ä¼šæŸ¥è¯¢user_groupè¿™å¼ è¡¨</li></ul><h1 id="2-åŸå› "><a href="#2-åŸå› " class="headerlink" title="2 åŸå› "></a>2 åŸå› </h1><ul><li><p>9.4 LGQå®šä½ä¸­æ¯’äº‹ä»¶çš„æ—¶å€™ï¼Œä¸ºäº†ç¡®è®¤æ˜¯å“ªä¸ªå¾®æœåŠ¡æ‰§è¡Œçš„æ•°æ®åº“æ“ä½œï¼ˆä¸åŒçš„å¾®æœåŠ¡å¦‚æœä½¿ç”¨äº†ä¸åŒçš„ç”¨æˆ·ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯å“ªä¸ªå¾®æœåŠ¡æ‰§è¡Œçš„sqlï¼‰ï¼Œä¿®æ”¹äº†sith-mesçš„application-sithMes.ymlï¼Œå°†æ•°æ®åº“çš„ç”¨æˆ·ä»sith-mesä¿®æ”¹æˆäº†sith-serverï¼Œå¹¶ä¸”èµ‹äºˆäº†sith-serverè¶…çº§ç®¡ç†å‘˜çš„æƒé™ï¼Œæ‰€ä»¥sith-serverå¯ä»¥æ“ä½œsith-mesåˆ›å»ºçš„è¡¨ã€‚</p></li><li><p>æ‰§è¡Œcreate_user_group.sqlçš„æ—¶å€™ï¼Œå› ä¸ºæ­¤æ—¶æ˜¯åœ¨sith-mesæœåŠ¡ä¸‹æ‰§è¡Œçš„ï¼Œæ‰€ä»¥user_groupè¿™å¼ è¡¨çš„owneræ˜¯sith-serverã€‚adminæœåŠ¡æ­¤æ—¶è¿æ¥çš„æ•°æ®åº“ç”¨æˆ·æ˜¯sith-mesï¼Œæ‰€ä»¥æ²¡æœ‰æ“ä½œsith-serverçš„æƒé™</p></li></ul><blockquote><p>ç”¨æˆ·sith-serverå»ºç«‹çš„è¡¨ï¼Œç”¨æˆ·sith-mesæ²¡æœ‰æƒé™æ“ä½œ</p></blockquote><h1 id="3-ç´§æ€¥ä¿®å¤"><a href="#3-ç´§æ€¥ä¿®å¤" class="headerlink" title="3. ç´§æ€¥ä¿®å¤"></a>3. ç´§æ€¥ä¿®å¤</h1><p>å°†æ–°å»ºçš„user_group çš„owneræ”¹æˆäº†sith-mes</p><p>é—®é¢˜ï¼šåæœŸå¦‚æœåœ¨sith-mesæ–°å»ºçš„è¡¨ï¼Œå…¶ä»–å¾®æœåŠ¡è¦æ“ä½œçš„è¯ï¼Œä¾æ—§ä¼šå‡ºç°æ²¡æƒé™é—®é¢˜</p><h1 id="4-è§£å†³æ–¹å¼"><a href="#4-è§£å†³æ–¹å¼" class="headerlink" title="4 è§£å†³æ–¹å¼"></a>4 è§£å†³æ–¹å¼</h1><ol><li>ä¿æŒæ‰€æœ‰å¾®æœåŠ¡ç”¨æˆ·ä¸€è‡´ï¼Œsith-mesæ”¹å›ç”¨æˆ·sith-mesï¼Œæˆ–è€…å…¶ä»–å¾®æœåŠ¡ä¹Ÿæ”¹æˆä½¿ç”¨sith-server</li><li>å°†sith-mesä¹Ÿè®¾ç½®æˆè¶…çº§ç®¡ç†å‘˜ï¼Œä½¿ä»–å¯ä»¥æ“ä½œsith-mesæ•°æ®åº“çš„æ‰€æœ‰è¡¨</li><li>æ¯ä¸ªå¾®æœåŠ¡æ•°æ®åº“ä½¿ç”¨è‡ªå·±çš„ç”¨æˆ·ï¼ŒflywayåŸºäºæ¯ä¸ªå¾®æœåŠ¡å»ºç«‹ï¼Œå¹¶ä¸”éœ€ä¿è¯æœåŠ¡åªæ“ä½œè‡ªå·±æœåŠ¡çš„è¡¨</li></ol><h1 id="5-æ•°æ®åº“æ–°å»ºç”¨æˆ·ï¼Œå¹¶èµ‹äºˆæƒé™æ­¥éª¤"><a href="#5-æ•°æ®åº“æ–°å»ºç”¨æˆ·ï¼Œå¹¶èµ‹äºˆæƒé™æ­¥éª¤" class="headerlink" title="5. æ•°æ®åº“æ–°å»ºç”¨æˆ·ï¼Œå¹¶èµ‹äºˆæƒé™æ­¥éª¤"></a>5. æ•°æ®åº“æ–°å»ºç”¨æˆ·ï¼Œå¹¶èµ‹äºˆæƒé™æ­¥éª¤</h1><p>åœºæ™¯ï¼šç”¨æˆ·panyurouåˆ›å»ºäº†ä¸€ä¸ªåä¸ºâ€œmicro-weatherâ€çš„database(æ•°æ®åº“)ï¼ŒåŒæ—¶åœ¨è¯¥åº“ä¸‹é»˜è®¤çš„public(shema)åˆ›å»ºäº†ä¸€ä¸ªè¡¨city</p><p>éœ€æ±‚ï¼šæ–°å»ºä¸€ä¸ªç”¨æˆ·cityserverï¼Œä½¿å¾—è¿™ä¸ªç”¨æˆ·å¯ä»¥æ“ä½œâ€œmicro-weatherâ€çš„public(shema)ä¸‹çš„æ‰€æœ‰è¡¨</p><h2 id="5-1-åˆ›å»ºç”¨æˆ·å¹¶è®¾ç½®å¯†ç "><a href="#5-1-åˆ›å»ºç”¨æˆ·å¹¶è®¾ç½®å¯†ç " class="headerlink" title="5.1 åˆ›å»ºç”¨æˆ·å¹¶è®¾ç½®å¯†ç "></a>5.1 åˆ›å»ºç”¨æˆ·å¹¶è®¾ç½®å¯†ç </h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span> cityserver <span class="hljs-keyword">with</span> PASSWORD <span class="hljs-string">&#x27;city-server&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="5-2-æ•°æ®åº“æˆæƒ"><a href="#5-2-æ•°æ®åº“æˆæƒ" class="headerlink" title="5.2 æ•°æ®åº“æˆæƒ"></a>5.2 æ•°æ®åº“æˆæƒ</h2><p>èµ‹äºˆæŒ‡å®šè´¦å·ï¼ŒæŒ‡å®šæ•°æ®åº“çš„æ‰€æœ‰æƒé™</p><ol><li><p>ä»¥panyurouçš„èº«ä»½è¿›å…¥æ•°æ®åº“ï¼ˆå› ä¸ºæ˜¯panyurouåˆ›å»ºçš„æ•°æ®åº“å’Œè¡¨ï¼Œæ‰€ä»¥éœ€è¦åœ¨panyurouçš„èº«ä»½ä¸‹æ“ä½œï¼‰ã€‚æ­¤æ—¶æ˜¯å¯ä»¥è®¿é—®cityè¿™å¼ è¡¨çš„</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql">âœ  Desktop psql <span class="hljs-operator">-</span>U panyurou <span class="hljs-operator">-</span>d  micro<span class="hljs-operator">-</span>weather<br><br>psql (<span class="hljs-number">14.6</span> (Homebrew))<br>Type &quot;help&quot; <span class="hljs-keyword">for</span> help.<br><br>micro<span class="hljs-operator">-</span>weather<span class="hljs-operator">=</span># <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> city;<br> id <span class="hljs-operator">|</span> name<br><span class="hljs-comment">----+------</span><br>(<span class="hljs-number">0</span> <span class="hljs-keyword">rows</span>)<br></code></pre></td></tr></table></figure></li><li><p>èµ‹äºˆæ•°æ®åº“æƒé™</p></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">micro<span class="hljs-operator">-</span>weather<span class="hljs-operator">=</span># <span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> privileges <span class="hljs-keyword">on</span> database &quot;micro-weather&quot; <span class="hljs-keyword">to</span> cityserver;<br><span class="hljs-keyword">GRANT</span><br>micro<span class="hljs-operator">-</span>weather<span class="hljs-operator">=</span># \q<br></code></pre></td></tr></table></figure><ol start="3"><li>èµ‹äºˆè¯¥æ•°æ®åº“ä¸‹æ‰€æœ‰è¡¨æƒé™</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">micro<span class="hljs-operator">-</span>weather<span class="hljs-operator">=</span># <span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> privileges <span class="hljs-keyword">on</span> <span class="hljs-keyword">all</span> tables <span class="hljs-keyword">in</span> schema public <span class="hljs-keyword">to</span> cityserver;<br><span class="hljs-keyword">GRANT</span><br>micro<span class="hljs-operator">-</span>weather<span class="hljs-operator">=</span># \q<br></code></pre></td></tr></table></figure><p>æ³¨ï¼šå½“æ²¡æœ‰èµ‹äºˆæƒé™ï¼Œå¹¶ä¸”ä»¥æ–°å»ºçš„ç”¨æˆ·å»è®¿é—®æ•°æ®çš„è¯ï¼Œä¼šæŠ¥é”™</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs subunit">âœ  Desktop psql -U cityserver -d micro-weather<br><br>psql (14.6 (Homebrew))<br>Type &quot;help&quot; for help.<br><br>micro-weather=&gt; select * from city;<br><span class="hljs-keyword">ERROR:  </span>permission denied for table city<br></code></pre></td></tr></table></figure><p>é™„ï¼šæ•°æ®åº“ç”¨æˆ·ä»‹ç»</p><p>æ‰§è¡Œ<code>select * from pg_user;</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231107225414985.png" alt="image-20231107225414985"></p><h2 id="5-3-å¸¸ç”¨sql"><a href="#5-3-å¸¸ç”¨sql" class="headerlink" title="5.3 å¸¸ç”¨sql"></a>5.3 å¸¸ç”¨sql</h2><p>å°†ç”¨æˆ·ä¿®æ”¹æˆè¶…çº§ç®¡ç†å‘˜</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">USER</span> cityserver <span class="hljs-keyword">WITH</span> SUPERUSER<br></code></pre></td></tr></table></figure><p>ç§»é™¤ç”¨æˆ·è¶…çº§ç®¡ç†å‘˜</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">USER</span> cityserver <span class="hljs-keyword">WITH</span> NOSUPERUSER;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>çº¿ä¸Šäº‹æ•…</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVMè°ƒä¼˜æ¡ˆä¾‹</title>
    <link href="/JVM%E8%B0%83%E4%BC%98%E6%A1%88%E4%BE%8B/"/>
    <url>/JVM%E8%B0%83%E4%BC%98%E6%A1%88%E4%BE%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¡ˆä¾‹ä¸€-â€”â€”æµ‹è¯•ç¯å¢ƒæœåŠ¡å¼‚å¸¸æŒ‚æ‰"><a href="#1-æ¡ˆä¾‹ä¸€-â€”â€”æµ‹è¯•ç¯å¢ƒæœåŠ¡å¼‚å¸¸æŒ‚æ‰" class="headerlink" title="1. æ¡ˆä¾‹ä¸€ â€”â€”æµ‹è¯•ç¯å¢ƒæœåŠ¡å¼‚å¸¸æŒ‚æ‰"></a>1. æ¡ˆä¾‹ä¸€ â€”â€”æµ‹è¯•ç¯å¢ƒæœåŠ¡å¼‚å¸¸æŒ‚æ‰</h1><h2 id="1-é—®é¢˜"><a href="#1-é—®é¢˜" class="headerlink" title="1. é—®é¢˜"></a>1. é—®é¢˜</h2><p>æµ‹è¯•ç¯å¢ƒæœåŠ¡å¼‚å¸¸æŒ‚æ‰</p><h2 id="2-æ’æŸ¥æ­¥éª¤"><a href="#2-æ’æŸ¥æ­¥éª¤" class="headerlink" title="2. æ’æŸ¥æ­¥éª¤"></a>2. æ’æŸ¥æ­¥éª¤</h2><p>æŸ¥çœ‹æ“ä½œç³»ç»Ÿæ—¥å¿—ï¼Œå‘ç°å‘ç”Ÿäº†OOMï¼Œæ“ä½œç³»ç»Ÿçš„OOM KIiller æœºåˆ¶ å°†Javaè¿›ç¨‹æ€æ‰äº†ï¼ˆä½¿ç”¨å‘½ä»¤<code> egrep -i &#39;Out of memory&#39; /var/log/messages</code>ï¼‰</p><blockquote><p>[root@sith-mom-test-node deploy]# egrep -i â€˜Out of memoryâ€™ &#x2F;var&#x2F;log&#x2F;messages<br>May 28 10:19:07 sith-mom-test-node kernel: Out of memory: Kill process 12420 (java) score 161 or sacrifice child<br>May 28 10:19:07 sith-mom-test-node kernel: Out of memory: Kill process 12607 (java) score 161 or sacrifice child<br>May 28 10:19:07 sith-mom-test-node kernel: Out of memory: Kill process 12721 (java) score 161 or sacrifice child<br>May 28 17:07:24 sith-mom-test-node kernel: Out of memory: Kill process 10434 (java) score 92 or sacrifice child<br>May 28 17:34:42 sith-mom-test-node kernel: Out of memory: Kill process 9270 (java) score 75 or sacrifice child<br>May 28 17:34:42 sith-mom-test-node kernel: Out of memory: Kill process 9281 (java) score 75 or sacrifice child<br>May 28 17:50:18 sith-mom-test-node kernel: Out of memory: Kill process 24060 (java) score 64 or sacrifice child</p></blockquote><p>é‡æ–°å¯åŠ¨é¡¹ç›®ï¼Œä½¿ç”¨<code>df -h</code>å‘ç°æµ‹è¯•ç¯å¢ƒå†…å­˜ç©ºé—²ä¹Ÿå°±20Gï¼Œä½¿ç”¨<code>jstat -gc 67825 3000 1000</code> å‘ç°å…ƒç©ºé—´å äº†10Gä»¥ä¸Šï¼Œè¿˜åœ¨ä¸€ç›´å¢é•¿ã€‚ï¼ˆæµ‹è¯•ç¯å¢ƒå†…å­˜62Gï¼‰ï¼Œå› ä¸ºjdk.8ä¹‹åå…ƒç©ºé—´ä½¿ç”¨çš„å†…å­˜æ˜¯æœ¬åœ°å†…å­˜ï¼Œé»˜è®¤æ˜¯-1ï¼Œ å³ä¸é™åˆ¶ï¼Œæ‰€ä»¥æ€€ç–‘åˆ°äº†å…ƒç©ºé—´</p><h2 id="3-ä¿®å¤"><a href="#3-ä¿®å¤" class="headerlink" title="3. ä¿®å¤"></a>3. ä¿®å¤</h2><p>åœ¨å¯åŠ¨jaråŒ…æ—¶ï¼ŒåŠ ä¸Šäº†<code>-XX:MaxMetaspaceSize=20G</code>, æŒ‡å®šæœ€å¤§å…ƒç©ºé—´å¤§å°, é—®é¢˜ä¿®å¤ï¼Œåç»­åˆæ„Ÿè§‰20Gå ç”¨å¤ªå¤§ï¼Œåˆå°è¯•é™ä½10Gï¼Œ 5Gï¼Œ ç›®å‰è®¾ç½®çš„æ˜¯1000Mï¼Œ5å¤©Full GC äº†200æ¬¡ï¼Œå¹³å‡2å°æ—¶3æ¬¡ï¼Œ ä¸€æ¬¡5.8ç§’ï¼Œè¿˜åœ¨æŒç»­è°ƒæ•´ï¼ˆæœŸå¾…1å°æ—¶ä¸€æ¬¡Full GC, ä¸€æ¬¡1sï¼‰ã€‚</p><h1 id="3-æ¡ˆä¾‹äºŒ-â€”â€”å¤©æ°”é¢„æŠ¥ç³»ç»Ÿ"><a href="#3-æ¡ˆä¾‹äºŒ-â€”â€”å¤©æ°”é¢„æŠ¥ç³»ç»Ÿ" class="headerlink" title="3.æ¡ˆä¾‹äºŒ â€”â€”å¤©æ°”é¢„æŠ¥ç³»ç»Ÿ"></a>3.æ¡ˆä¾‹äºŒ â€”â€”å¤©æ°”é¢„æŠ¥ç³»ç»Ÿ</h1><p>å¤©æ°”é¢„æŠ¥ç³»ç»Ÿï¼Œæœ‰ä¸€ä¸ªå±•ç¤ºæ‰€æœ‰åŸå¸‚å¤©æ°”é¢„æŠ¥çš„é¡µé¢ï¼Œç”±äºåŸå¸‚æ¯”è¾ƒå¤šï¼Œéœ€è¦åˆ†é¡µå»å±•ç¤ºï¼Œäºæ˜¯å…ˆè®¾ç½®äº†ä¸€æ¬¡æŸ¥è¯¢5000æ¡ï¼Œç”±äºæ¯ä¸€æ¡åŸå¸‚éƒ½éœ€è¦å†å»ç»™ä»–è®¾ç½®å¯¹åº”çš„å¤©æ°”ä¿¡æ¯ï¼Œæ‰€ä»¥æäº†ä¸€ä¸ªforeachæ¯ä¸€æ¡è®°å½•éƒ½éœ€è¦new City()ï¼Œç„¶åå†å»setå¤©æ°”ä¿¡æ¯</p><p>åˆå§‹å‚æ•°æ˜¯ï¼š</p><p>å †çš„æœ€å¤§å’Œæœ€å°å®¹é‡éƒ½è®¾ç½®äº†1536M, å¹´è½»ä»£æ˜¯512Mï¼Œä½¿ç”¨çš„ParNew+CMSåƒåœ¾æ”¶é›†å™¨ï¼Œå…ƒç©ºé—´256M</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">-Xms1536M -Xmx1536M -Xmn512M -Xss256K -XX:<span class="hljs-attribute">SurvivorRatio</span>=6 -XX:<span class="hljs-attribute">MetaspaceSize</span>=256M -XX:<span class="hljs-attribute">MaxMetaspaceSize</span>=512M  -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:<span class="hljs-attribute">CMSInitiatingOccupancyFraction</span>=75 -XX:+UseCMSInitiatingOccupancyOnly<br></code></pre></td></tr></table></figure><h2 id="3-2-è§‚å¯ŸGCæ•´ä½“æƒ…å†µ"><a href="#3-2-è§‚å¯ŸGCæ•´ä½“æƒ…å†µ" class="headerlink" title="3.2 è§‚å¯ŸGCæ•´ä½“æƒ…å†µ"></a>3.2 è§‚å¯ŸGCæ•´ä½“æƒ…å†µ</h2><ul><li><p>step1 : è¿è¡Œ<code> jps</code>çœ‹ä¸‹, æŸ¥çœ‹å½“å‰javaè¿›ç¨‹PID</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222821739.png" alt="image-20230228222821739"></p></li><li><p>step2: è¿è¡Œ <code>jstat -gc 2593 3000 10000</code>ï¼Œæ¯éš”3ç§’ï¼Œæ‰“å°ä¸‹GCå‹åŠ›æ•´ä½“æƒ…å†µã€‚è§‚å¯Ÿå¯å‘ç°ï¼Œç¨‹åºçªç„¶å¼€å§‹é¢‘ç¹Young Gc å’ŒFull GCã€‚</p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222903395.png" alt="image-20230228222903395"></p><h2 id="3-2-æ€è€ƒé¢‘ç¹Full-Gc-è§¦å‘æ¡ä»¶"><a href="#3-2-æ€è€ƒé¢‘ç¹Full-Gc-è§¦å‘æ¡ä»¶" class="headerlink" title="3.2 æ€è€ƒé¢‘ç¹Full Gc è§¦å‘æ¡ä»¶"></a>3.2 æ€è€ƒé¢‘ç¹Full Gc è§¦å‘æ¡ä»¶</h2><ul><li><p>è°ƒç”¨System.gc()æ–¹æ³•çš„è°ƒç”¨ã€‚   <strong>-&gt; ä¸å¯èƒ½ï¼Œç³»ç»Ÿä¸­æ²¡è¿™æ ·è°ƒç”¨</strong></p></li><li><p>äº‘ç©ºé—´ï¼Œæ–¹æ³•åŒºç©ºé—´ä¸è¶³  <strong>-&gt; ä¸å¯èƒ½ï¼Œè§‚å¯ŸMUå¹¶æ²¡æœ‰å¾ˆå¤§å˜åŒ–ï¼Œè¯´æ˜å…ƒç©ºé—´æ²¡æœ‰ä¸€ç›´æ‰©å®¹ï¼Œæ‰€ä»¥ç©ºé—´æ˜¯å¤Ÿçš„</strong></p></li><li><p>è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼Œå¯¹è±¡è½¬å…¥è€å¹´ä»£çš„åœºæ™¯æœ‰ï¼š</p><ul><li>å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼šä¸ºäº†é¿å…ä¸ºå¤§å¯¹è±¡GCæ—¶ï¼Œå¤šæ¬¡åœ¨survivorä¸Šæ¥å›å¤åˆ¶è€Œé™ä½æ•ˆç‡ã€‚   <strong>-&gt; ä¸å¯èƒ½ï¼Œç³»ç»Ÿä¸­æ²¡å¾ˆå¤šå¤§å¯¹è±¡</strong></li><li>é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ï¼šé»˜è®¤æ˜¯ç»å†äº†15æ¬¡minor GC ï¼ŒCMSæ˜¯6æ¬¡ <strong>-&gt; å¯èƒ½ï¼Œä»£ç åœ¨é¢‘ç¹ç”Ÿæˆå¯¹è±¡ï¼Œä¸”å ç”¨å‘¨æœŸæ¯”è¾ƒé•¿ã€‚æœ‰å¯èƒ½æ˜¯ä»£ç æœ‰é—®é¢˜ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥é¢‘ç¹ç”Ÿæˆå¯¹è±¡ï¼Œä½†æ˜¯åº”è¯¥è®©ä»–æœç”Ÿå¤•æ­»ã€‚</strong></li><li><strong>å¯¹è±¡åŠ¨æ€å¹´é¾„åˆ¤æ–­</strong>ï¼šsurvivoråŒºåŸŸé‡Œï¼Œå¯¹è±¡å¹´é¾„ä»å°åˆ°å¤§æ’åºï¼Œå½“ç´¯åŠ åˆ°æŸä¸ªå¹´é¾„æ—¶ï¼Œå ç”¨ survivoråŒºåŸŸ çš„50%ï¼Œå°±ä¼šæŠŠè¿™ä¸ªå¹´é¾„å¤§çš„å¯¹è±¡éƒ½æ™‹å‡åˆ°è€å¹´ä»£ã€‚  <strong>-&gt; å¯èƒ½ï¼Œå› ä¸ºç°åœ¨æ˜¯é¢‘ç¹ç”Ÿæˆäº†å¯¹è±¡ï¼Œå¯ä»¥è€ƒè™‘å¹´è½»ä»£è°ƒå¤§ä¸€äº›ã€‚</strong></li></ul></li><li><p>è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿æœºåˆ¶ã€‚ <strong>-&gt; å¯èƒ½æ€§ä¸å¤§ï¼Œå› ä¸ºè€å¹´ä»£æŒºå¤§çš„</strong></p></li></ul><h2 id="3-3-è°ƒä¼˜æ­¥éª¤"><a href="#3-3-è°ƒä¼˜æ­¥éª¤" class="headerlink" title="3.3 è°ƒä¼˜æ­¥éª¤"></a>3.3 è°ƒä¼˜æ­¥éª¤</h2><p>å¦‚æœæ˜¯å¯¹äºå¯¹è±¡åŠ¨æ€å¹´é¾„åˆ¤æ–­æœºåˆ¶å¯¼è‡´çš„full gcè¾ƒä¸ºé¢‘ç¹å¯ä»¥å…ˆè¯•ç€ä¼˜åŒ–ä¸‹JVMå‚æ•°ï¼ŒæŠŠå¹´è½»ä»£é€‚å½“è°ƒå¤§ç‚¹ï¼š -Xmn1024M</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">-Xms1536M -Xmx1536M -Xmn1024M -Xss256K -XX:SurvivorRatio=<span class="hljs-number">6</span> -XX:MetaspaceSize=256M -XX:MaxMetaspaceSize=512M  -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=<span class="hljs-number">75</span> -XX:+UseCMSInitiatingOccupancyOnly<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°young gcå’Œfull gcä¾ç„¶å¾ˆé¢‘ç¹äº†ï¼Œè€Œä¸”çœ‹åˆ°æœ‰å¤§é‡çš„å¯¹è±¡é¢‘ç¹çš„è¢«æŒªåŠ¨åˆ°è€å¹´ä»£</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222923471.png" alt="image-20230228222923471"></p><p>è¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥å€ŸåŠ©jmapæˆ–è€…jvisualvmå‘½ä»¤å¤§æ¦‚çœ‹ä¸‹æ˜¯ä»€ä¹ˆå¯¹è±¡</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222946533.png" alt="image-20230228222946533"></p><p>æŸ¥åˆ°äº†æœ‰å¤§é‡Userå¯¹è±¡äº§ç”Ÿï¼Œè¿™ä¸ªå¯èƒ½æ˜¯é—®é¢˜æ‰€åœ¨ï¼Œä½†ä¸ç¡®å®šï¼Œè¿˜å¿…é¡»æ‰¾åˆ°å¯¹åº”çš„ä»£ç ç¡®è®¤ï¼Œå¦‚ä½•å»æ‰¾å¯¹åº”çš„ä»£ç äº†ï¼Ÿ </p><p>1ã€ä»£ç é‡Œå…¨æ–‡æœç´¢ç”ŸæˆUserå¯¹è±¡çš„åœ°æ–¹(é€‚åˆåªæœ‰å°‘æ•°å‡ å¤„åœ°æ–¹çš„æƒ…å†µ) </p><p>2ã€å¦‚æœç”ŸæˆUserå¯¹è±¡çš„åœ°æ–¹å¤ªå¤šï¼Œæ— æ³•å®šä½å…·ä½“ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶åˆ†æä¸‹å ç”¨cpuè¾ƒé«˜çš„çº¿ç¨‹ï¼Œä¸€èˆ¬æœ‰å¤§é‡å¯¹è±¡ä¸æ–­äº§ç”Ÿï¼Œå¯¹åº”çš„æ–¹æ³• ä»£ç è‚¯å®šä¼šè¢«é¢‘ç¹è°ƒç”¨ï¼Œå ç”¨çš„cpuå¿…ç„¶è¾ƒé«˜ </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222956571.png" alt="image-20230228222956571"></p><p>å¯ä»¥ç”¨ä¸Šé¢è®²è¿‡çš„jstackæˆ–jvisualvmæ¥å®šä½cpuä½¿ç”¨è¾ƒé«˜çš„ä»£ç ï¼Œæœ€ç»ˆå®šä½åˆ°çš„ä»£ç å¦‚ä¸‹ï¼š </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/report&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WeatherReportController</span> </span>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * æ¨¡æ‹Ÿæ‰¹é‡æŸ¥è¯¢åŸå¸‚å¤©æ°”é¢„æŠ¥åœºæ™¯</span><br><span class="hljs-comment">   */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> ArrayList&lt;City&gt; <span class="hljs-title">queryCities</span><span class="hljs-params">()</span> </span>&#123;<br>    ArrayList&lt;City&gt; cities = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5000</span>; i++) &#123;<br>      cities.add(<span class="hljs-keyword">new</span> City(String.valueOf(i),<span class="hljs-string">&quot;æ·±åœ³&quot;</span>));<br>    &#125;<br>    <span class="hljs-keyword">return</span> cities;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">City</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> String id;<br><br>  <span class="hljs-keyword">private</span> String name;<br><br>  <span class="hljs-keyword">private</span> String code;<br><br>  <span class="hljs-keyword">byte</span>[] info = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">1024</span>*<span class="hljs-number">100</span>];<br>&#125;<br></code></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œjavaçš„ä»£ç ä¹Ÿæ˜¯éœ€è¦ä¼˜åŒ–çš„ï¼Œä¸€æ¬¡æŸ¥è¯¢å‡º500Mçš„å¯¹è±¡å‡ºæ¥ï¼Œæ˜æ˜¾ä¸åˆé€‚ï¼Œè¦æ ¹æ®ä¹‹å‰è¯´çš„å„ç§åŸåˆ™å°½é‡ä¼˜åŒ–åˆ°åˆé€‚çš„å€¼ï¼Œå°½é‡æ¶ˆé™¤è¿™ç§æœç”Ÿå¤•æ­»çš„å¯¹è±¡å¯¼è‡´çš„full gc</p><p>æ”¹æˆæ‰¹é‡æŸ¥è¯¢500åï¼ŒFull GC åŸºæœ¬ä¸å†å‘ç”Ÿ</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223006680.png" alt="image-20230228223006680"></p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="3-æ¡ˆä¾‹ä¸‰â€”â€”-è®¢å•ç³»ç»Ÿ"><a href="#3-æ¡ˆä¾‹ä¸‰â€”â€”-è®¢å•ç³»ç»Ÿ" class="headerlink" title="3. æ¡ˆä¾‹ä¸‰â€”â€” è®¢å•ç³»ç»Ÿ"></a>3. æ¡ˆä¾‹ä¸‰â€”â€” è®¢å•ç³»ç»Ÿ</h1><p>æœ‰ä¸€ä¸ªè®¢å•ç³»ç»Ÿï¼Œéœ€è¦æ”¯æŒæ¯ç§’æ”¯æŒä¸‹300ä¸ªè®¢å•ã€‚å‡å®šæ¯ä¸ªè®¢å•å¯¹è±¡æ˜¯1kbï¼Œé‚£ä¹ˆæ¯ç§’å°†ä¼šæœ‰300kbå¯¹è±¡ç”Ÿæˆã€‚</p><p>ä¸‹å•å¯èƒ½è¿˜æ¶‰åŠåˆ›å»ºå…¶ä»–å¯¹è±¡åˆ›å»ºï¼Œæ¯”å¦‚åº“å­˜ï¼Œä¼˜æƒ å·ï¼Œç§¯åˆ†ï¼Œä»¥åŠè¿™ä¸ªç³»ç»Ÿå¯èƒ½è¿˜æ”¯æŒè®¢å•çš„æŸ¥è¯¢ï¼Œæˆ‘ä»¬æ”¾å¤§20å€ï¼Œé‚£ä¹ˆå°±æ˜¯300 * 20  &#x3D; 6000kbï¼Œçº¦60MBï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªç³»ç»Ÿæ¯ç§’ä¼šäº§ç”Ÿ60Mçš„åƒåœ¾ã€‚</p><p>å‡è®¾æœºå™¨æ˜¯4æ ¸8Gï¼Œé‚£ä¹ˆä¸€èˆ¬å¯èƒ½ä¼šç»™æˆ‘ä»¬è™šæ‹Ÿæœºåˆ†é…ä¸ªå››äº”Gçš„å†…å­˜ï¼Œå°±ä¼šç»™å †åˆ†é…ä¸ª3Gçš„å†…å­˜ï¼Œé‚£ä¹ˆæ–¹æ³•åŒºåˆ†é…256Mï¼Œå•ä¸ªæ ˆå†…å­˜åˆ†é…1Mã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">1</span> â€Xms3072M â€Xmx3072M â€Xss1M â€XX:MetaspaceSize=256M â€XX:MaxMetaspaceSize=256M â€XX:SurvivorRatio=<span class="hljs-number">8</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™ä¹ˆåˆ†é…æœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿå¦‚æœæ˜¯ä¸€ä¸ªå¹¶å‘é‡ä¸å¤§çš„ç³»ç»Ÿï¼ŒåŸºæœ¬ä¸Šä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºæœ¬èº«ä¹Ÿæ²¡æœ‰å¤šå°‘å¯¹è±¡åœ¨å †é‡Œç”Ÿæˆã€‚ä½†æ˜¯å¦‚æœæ˜¯æˆ‘ä»¬ä¸Šé¢è¯´çš„äº¿çº§æµé‡ç³»ç»Ÿï¼Œå°±ä¸èƒ½ç®€ç®€å•å•è¿™ä¹ˆè®¾ç½®äº†ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼š</p><p>å †åˆ†é…çš„å¤§å°æ˜¯3Gï¼ŒæŒ‰ç…§1:2åˆ†é…å¹´è½»ä»£å’Œè€å¹´ä»£çš„è¯ï¼Œå¯ä»¥ç®—å‡ºå¹´è½»ä»£æ˜¯1Gï¼Œè€å¹´ä»£æ˜¯2Gï¼Œå¹´è½»ä»£å†æŒ‰ç…§8:1:1ç»†åˆ†edenå’Œsurvivorï¼Œedenæ˜¯800Mï¼Œå•ä¸ªsurvivoræ˜¯100Mã€‚å¦‚æœæ¯ç§’äº§ç”Ÿ60Må¯¹è±¡ï¼Œä¼˜å…ˆåœ¨edenåˆ†é…ï¼Œä¹Ÿå°±æ˜¯å·®ä¸å¤š13ç§’ï¼Œedenå°±ä¼šè¢«å æ»¡ï¼Œå‘ç”Ÿminor GCï¼Œè¿™æ˜¯90%çš„å¯¹è±¡å·²ç»è¢«å›æ”¶äº†ï¼Œè¿˜å­˜åœ¨ä¸€äº›æ­£åœ¨ä½¿ç”¨çš„å¯¹è±¡ï¼Œå‡å®šæ˜¯60Må¯¹è±¡è¿˜ä¸ä¼šè¢«å›æ”¶ã€‚</p><p>é‚£ä¹ˆè¿™60Må¯¹è±¡ä¼šä»EdenåŒºç§»åˆ°S0åŒºåŸŸï¼Œç”±äºå­˜åœ¨åŠ¨æ€å¹´é¾„åˆ¤æ–­ï¼Œå°±æ˜¯ä¸€æ‰¹å¯¹è±¡çš„æ€»å¤§å°å¤§äºè¿™å—SurvivoråŒºåŸŸå†…å­˜å¤§å°çš„ï¼Œé‚£ä¹ˆæ­¤æ—¶<strong>å¤§äºç­‰äº</strong>è¿™æ‰¹å¯¹è±¡å¹´é¾„æœ€å¤§å€¼çš„å¯¹è±¡ï¼Œå°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£äº†ã€‚è¿™æ ·çš„è¯ï¼Œæ¯13ç§’å°±ä¼šæœ‰60Mçš„å¯¹è±¡è¢«ç§»å…¥è€å¹´ä»£ã€‚</p><p>é‚£ä¹ˆå¤§æ¦‚äº”å…­åˆ†é’Ÿè€å¹´ä»£çš„2Gå°±ä¼šè¢«å æ»¡ï¼Œé‚£ä¹ˆè€å¹´ä»£ä¸€æ»¡å°±è¦å‘ç”Ÿfull gc</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224246219.png" alt="image-20230228224246219"></p><p><a href="https://blog.csdn.net/weixin_44704538/article/details/108222022">(129æ¡æ¶ˆæ¯) JVMçš„STW(stop the world)æœºåˆ¶åŠè°ƒä¼˜æ¡ˆä¾‹_JavaRecordçš„åšå®¢-CSDNåšå®¢_stwæœºåˆ¶</a></p><p>æ¥åˆ†æä¸€ä¸‹ï¼šæˆ‘ä»¬è¿™ä¸ªç³»ç»Ÿå…¶å®æ²¡æœ‰å¾ˆå¤šä¼šé•¿ä¹…å­˜åœ¨çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è€ä¸æ­»çš„å¯¹è±¡ï¼Œæˆ‘ä»¬æ”¾åœ¨è€å¹´ä»£çš„é‚£äº›60Mçš„å¯¹è±¡ï¼Œåœ¨ä¸€ä¸¤ç§’åå…¶å®éƒ½ä¼šå˜ä¸ºåƒåœ¾å¯¹è±¡ï¼Œåœ¨ä¸‹ä¸€æ¬¡full gcæ—¶éƒ½ä¼šè¢«å›æ”¶æ‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™ç§ä¸šåŠ¡åœºæ™¯ï¼Œå®Œå…¨æ²¡å¿…è¦ç»™è€å¹´ä»£è®¾ç½®2Gçš„å†…å­˜ï¼Œæ ¹æœ¬ç”¨ä¸åˆ°ã€‚</p><p>æˆ‘ä»¬å®Œå…¨å¯ä»¥æŠŠå¹´è½»ä»£è®¾ç½®çš„å¤§ä¸€äº›ï¼Œæˆ‘ä»¬ç°åœ¨æ¥å¯¹jvmå‚æ•°è¿›è¡Œä¸€äº›æ›´æ”¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">1</span> â€Xms3072M â€Xmx3072M â€Xmn2048M â€Xss1M â€XX:MetaspaceSize=256M â€XX:MaxMetaspaceSize=256M â€XX:SurvivorRatio=<span class="hljs-number">8</span><br></code></pre></td></tr></table></figure><p>æ­¤æ—¶éœ€è¦25ç§’æŠŠä¼Šç”¸å›­åŒºæ”¾æ»¡ï¼Œæ”¾æ»¡minor gcåæœ‰60Må¯¹è±¡ä¸è¢«å›æ”¶ï¼Œè¦ç§»åˆ°S0åŒºï¼Œè¿™æ—¶60M&lt;200M&#x2F;2ï¼Œæ˜¯å¯ä»¥ç§»å…¥S0åŒºåŸŸçš„ï¼Œä¸‹ä¸€æ¬¡ä¼Šç”¸å›­åŒºå†æ”¾æ»¡åšminor gcçš„æ—¶å€™ï¼Œè¿™æ—¶è¿™60Må¯¹è±¡æ‰€å¯¹åº”çš„è®¢å•å·²ç»ç”Ÿæˆäº†ï¼Œå·²ç»å˜æˆäº†åƒåœ¾å¯¹è±¡ï¼Œæ˜¯å¯ä»¥ç›´æ¥è¢«å›æ”¶çš„ï¼Œæ‰€ä»¥æ²¡æœ‰ä»€ä¹ˆå¯¹è±¡æ˜¯éœ€è¦è¢«ç§»å…¥è€å¹´ä»£çš„ã€‚</p><p>é‚£ä¹ˆè¿™ä¹ˆä¸€è®¾ç½®çš„è¯ï¼Œè¿™ä¸ªç³»ç»Ÿæ˜¯ä¸æ˜¯æ­£å¸¸æƒ…å†µä¸‹åŸºæœ¬ä¸ä¼šå†å‘ç”Ÿfull gcäº†å‘¢ï¼Ÿå°±ç®—å‘ç”Ÿï¼Œä¹Ÿæ˜¯å¾ˆä¹…æ‰ä¼šä¸€æ¬¡äº†ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224257622.png" alt="image-20230228224257622"></p>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½è°ƒä¼˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xxlJobä½¿ç”¨</title>
    <link href="/xxlJob%E4%BD%BF%E7%94%A8/"/>
    <url>/xxlJob%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä»»åŠ¡è°ƒåº¦"><a href="#1-ä»»åŠ¡è°ƒåº¦" class="headerlink" title="1. ä»»åŠ¡è°ƒåº¦"></a>1. ä»»åŠ¡è°ƒåº¦</h1><h2 id="1-ä»€ä¹ˆæ˜¯ä»»åŠ¡è°ƒåº¦"><a href="#1-ä»€ä¹ˆæ˜¯ä»»åŠ¡è°ƒåº¦" class="headerlink" title="1. ä»€ä¹ˆæ˜¯ä»»åŠ¡è°ƒåº¦"></a>1. ä»€ä¹ˆæ˜¯ä»»åŠ¡è°ƒåº¦</h2><p>ä»»åŠ¡è°ƒåº¦æ˜¯ä¸ºäº†è‡ªåŠ¨å®Œæˆç‰¹å®šä»»åŠ¡ï¼Œåœ¨çº¦å®šçš„ç‰¹å®šæ—¶åˆ»å»æ‰§è¡Œä»»åŠ¡çš„è¿‡ç¨‹ã€‚</p><h2 id="2-ä»€ä¹ˆåœºæ™¯ä¼šéœ€è¦ä»»åŠ¡è°ƒåº¦"><a href="#2-ä»€ä¹ˆåœºæ™¯ä¼šéœ€è¦ä»»åŠ¡è°ƒåº¦" class="headerlink" title="2. ä»€ä¹ˆåœºæ™¯ä¼šéœ€è¦ä»»åŠ¡è°ƒåº¦"></a>2. ä»€ä¹ˆåœºæ™¯ä¼šéœ€è¦ä»»åŠ¡è°ƒåº¦</h2><ul><li>æŸç”µå•†å¹³å°éœ€è¦æ¯å¤©ä¸Šåˆ10ç‚¹ï¼Œä¸‹åˆ3ç‚¹ï¼Œæ™šä¸Š8ç‚¹å‘æ”¾ä¸€æ‰¹ä¼˜æƒ åˆ¸</li><li>æŸé“¶è¡Œç³»ç»Ÿéœ€è¦åœ¨ä¿¡ç”¨å¡åˆ°æœŸè¿˜æ¬¾æ—¥çš„å‰3å¤©è¿›è¡ŒçŸ­ä¿¡æé†’</li><li>æŸè´¢åŠ¡ç³»ç»Ÿéœ€è¦æ¯å¤©å‡Œæ™¨ç»“ç®—å‰ä¸€å¤©çš„è´¢åŠ¡æ•°æ®</li></ul><h1 id="2-åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦"><a href="#2-åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦" class="headerlink" title="2. åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦"></a>2. åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦</h1><h2 id="1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦"><a href="#1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦" class="headerlink" title="1. ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦"></a>1. ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦</h2><p>é‡‡ç”¨åˆ†å¸ƒå¼æ¶æ„ï¼Œä¸€ä¸ªæœåŠ¡å¾€å¾€ä¼šéƒ¨ç½²å¤šä¸ªå†—ä½™å®ä¾‹æ¥è¿è¡Œæˆ‘ä»¬çš„ä¸šåŠ¡ï¼Œåœ¨è¿™ç§åˆ†å¸ƒå¼ç³»ç»Ÿç¯å¢ƒä¸‹è¿è¡Œä»»åŠ¡è°ƒåº¦ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º<strong>åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦</strong></p><h2 id="2-ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦"><a href="#2-ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦" class="headerlink" title="2. ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦"></a>2. ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦</h2><p>ä½¿ç”¨springæä¾›çš„@scheduledï¼Œä¹Ÿèƒ½å®ç°è°ƒåº¦çš„åŠŸèƒ½ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦çš„å‘¢ï¼Ÿ</p><ul><li>é«˜å¯ç”¨ï¼šå•æœºç‰ˆçš„ä»»åŠ¡è°ƒåº¦åªèƒ½åœ¨ä¸€å°æœºå™¨ä¸Šè¿è¡Œï¼Œç¨‹åºå‡ºç°å¼‚å¸¸åä¼šå¯¼è‡´æœåŠ¡ä¸å¯ç”¨ã€‚</li><li>é˜²æ­¢ä»»åŠ¡é‡å¤æ‰§è¡Œã€‚å½“éƒ¨ç½²äº†å¤šå°æœåŠ¡ï¼ŒåŒä¸€ä¸ªå®šæ—¶ä»»åŠ¡éœ€è¦æ§åˆ¶åœ¨åŒä¸€æ—¶é—´å†…ï¼Œåªæœ‰ä¸€ä¸ªä»»åŠ¡åœ¨æ‰§è¡Œã€‚</li><li>å•æœºå¤„ç†å­˜åœ¨æé™ã€‚å³ä½¿å¯ä»¥é€šè¿‡å¤šçº¿ç¨‹æé«˜å•æœºçš„å¤„ç†æ•ˆç‡ä½†èƒ½åŠ›ä¾æ—§æœ‰é™ï¼ˆCPUï¼Œå†…å­˜ï¼Œç¡¬ç›˜ï¼‰ï¼Œä¾æ—§å­˜åœ¨å¤„ç†ä¸è¿‡æ¥çš„åœºæ™¯</li></ul><h1 id="2-xxl-Job"><a href="#2-xxl-Job" class="headerlink" title="2. xxl-Job"></a>2. xxl-Job</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h2><p>xxlJobæ˜¯ä¸€ä¸ªè½»é‡çº§<strong>åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦</strong>å¹³å°</p><h2 id="2-è®¾è®¡æ€æƒ³"><a href="#2-è®¾è®¡æ€æƒ³" class="headerlink" title="2. è®¾è®¡æ€æƒ³"></a>2. è®¾è®¡æ€æƒ³</h2><ul><li>å°†è°ƒåº¦è¡Œä¸ºæŠ½è±¡å½¢æˆâ€œè°ƒåº¦ä¸­å¿ƒâ€å…¬å…±å¹³å°ï¼Œè€Œå¹³å°è‡ªèº«å¹¶ä¸æ‰¿æ‹…ä¸šåŠ¡é€»è¾‘ï¼Œâ€œè°ƒåº¦ä¸­å¿ƒâ€è´Ÿè´£å‘èµ·è°ƒåº¦è¯·æ±‚ã€‚</li><li>å°†ä»»åŠ¡æŠ½è±¡æˆåˆ†æ•£çš„JobHandlerï¼Œäº¤ç”±â€œæ‰§è¡Œå™¨â€ç»Ÿä¸€ç®¡ç†ï¼Œâ€œæ‰§è¡Œå™¨â€è´Ÿè´£æ¥æ”¶è°ƒåº¦è¯·æ±‚å¹¶æ‰§è¡Œå¯¹åº”çš„JobHandlerä¸­ä¸šåŠ¡é€»è¾‘ã€‚</li><li>å› æ­¤ï¼Œâ€œè°ƒåº¦â€å’Œâ€œä»»åŠ¡â€ä¸¤éƒ¨åˆ†å¯ä»¥ç›¸äº’è§£è€¦ï¼Œæé«˜ç³»ç»Ÿæ•´ä½“ç¨³å®šæ€§å’Œæ‰©å±•æ€§ï¼›</li></ul><h2 id="3-ç³»ç»Ÿç»„æˆ"><a href="#3-ç³»ç»Ÿç»„æˆ" class="headerlink" title="3. ç³»ç»Ÿç»„æˆ"></a>3. ç³»ç»Ÿç»„æˆ</h2><ul><li><p><strong>è°ƒåº¦æ¨¡å—ï¼ˆè°ƒåº¦ä¸­å¿ƒï¼‰</strong>ï¼š</p><p>è´Ÿè´£ç®¡ç†è°ƒåº¦ä¿¡æ¯ï¼ŒæŒ‰ç…§è°ƒåº¦é…ç½®å‘å‡ºè°ƒåº¦è¯·æ±‚ï¼Œè‡ªèº«ä¸æ‰¿æ‹…ä¸šåŠ¡ä»£ç ã€‚</p><p>è°ƒåº¦ç³»ç»Ÿä¸ä»»åŠ¡è§£è€¦ï¼Œæé«˜äº†ç³»ç»Ÿå¯ç”¨æ€§å’Œç¨³å®šæ€§ï¼ŒåŒæ—¶è°ƒåº¦ç³»ç»Ÿæ€§èƒ½ä¸å†å—é™äºä»»åŠ¡æ¨¡å—ï¼›<br>æ”¯æŒå¯è§†åŒ–ã€ç®€å•ä¸”åŠ¨æ€çš„ç®¡ç†è°ƒåº¦ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä»»åŠ¡æ–°å»ºï¼Œæ›´æ–°ï¼Œåˆ é™¤ï¼ŒGLUEå¼€å‘å’Œä»»åŠ¡æŠ¥è­¦ç­‰ï¼Œæ‰€æœ‰ä¸Šè¿°æ“ä½œéƒ½ä¼šå®æ—¶ç”Ÿæ•ˆï¼ŒåŒæ—¶æ”¯æŒç›‘æ§è°ƒåº¦ç»“æœä»¥åŠæ‰§è¡Œæ—¥å¿—ï¼Œæ”¯æŒæ‰§è¡Œå™¨Failoverã€‚</p></li><li><p><strong>æ‰§è¡Œæ¨¡å—ï¼ˆæ‰§è¡Œå™¨ï¼‰</strong>ï¼š<br>è´Ÿè´£æ¥æ”¶è°ƒåº¦è¯·æ±‚å¹¶æ‰§è¡Œä»»åŠ¡é€»è¾‘ã€‚ä»»åŠ¡æ¨¡å—ä¸“æ³¨äºä»»åŠ¡çš„æ‰§è¡Œç­‰æ“ä½œï¼Œå¼€å‘å’Œç»´æŠ¤æ›´åŠ ç®€å•å’Œé«˜æ•ˆï¼›<br>æ¥æ”¶â€œè°ƒåº¦ä¸­å¿ƒâ€çš„æ‰§è¡Œè¯·æ±‚ã€ç»ˆæ­¢è¯·æ±‚å’Œæ—¥å¿—è¯·æ±‚ç­‰ã€‚</p></li></ul><h1 id="3-å¦‚ä½•è‡ªå·±å»å®ç°ä¸€ä¸ªXXL-JOb"><a href="#3-å¦‚ä½•è‡ªå·±å»å®ç°ä¸€ä¸ªXXL-JOb" class="headerlink" title="3. å¦‚ä½•è‡ªå·±å»å®ç°ä¸€ä¸ªXXL JOb"></a>3. å¦‚ä½•è‡ªå·±å»å®ç°ä¸€ä¸ªXXL JOb</h1><h2 id="1-éœ€æ±‚åˆ†æ"><a href="#1-éœ€æ±‚åˆ†æ" class="headerlink" title="1. éœ€æ±‚åˆ†æ"></a>1. éœ€æ±‚åˆ†æ</h2><ol><li><strong>ä»»åŠ¡è°ƒåº¦</strong>ï¼šæ”¯æŒå®šæ—¶ä»»åŠ¡ã€å»¶è¿Ÿä»»åŠ¡å’Œå‘¨æœŸæ€§ä»»åŠ¡ã€‚</li><li><strong>ä»»åŠ¡æ‰§è¡Œ</strong>ï¼šä»»åŠ¡åˆ†å‘ç»™ä¸åŒçš„æ‰§è¡ŒèŠ‚ç‚¹ã€‚</li><li><strong>ä»»åŠ¡ç®¡ç†</strong>ï¼šæ”¯æŒä»»åŠ¡çš„å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€æš‚åœå’Œæ¢å¤ã€‚</li><li><strong>ç›‘æ§å’Œæ—¥å¿—</strong>ï¼šè®°å½•ä»»åŠ¡æ‰§è¡Œæƒ…å†µå’Œæ—¥å¿—ï¼Œä¾¿äºç›‘æ§å’Œè°ƒè¯•ã€‚</li><li><strong>é«˜å¯ç”¨æ€§</strong>ï¼šä¿è¯è°ƒåº¦ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§å’Œå¯é æ€§ã€‚</li></ol><h2 id="2-ç³»ç»Ÿè®¾è®¡"><a href="#2-ç³»ç»Ÿè®¾è®¡" class="headerlink" title="2. ç³»ç»Ÿè®¾è®¡"></a>2. ç³»ç»Ÿè®¾è®¡</h2><ol><li><strong>è°ƒåº¦ä¸­å¿ƒ</strong>ï¼š<ul><li>è´Ÿè´£ä»»åŠ¡çš„è°ƒåº¦ã€åˆ†å‘å’Œç®¡ç†ã€‚</li><li>ç»´æŠ¤ä»»åŠ¡çš„å…ƒæ•°æ®å’Œè°ƒåº¦ç­–ç•¥ã€‚</li><li>æä¾›ç®¡ç†ç•Œé¢ï¼ˆWeb ç•Œé¢ï¼‰ç”¨äºä»»åŠ¡çš„å¢åˆ æ”¹æŸ¥ã€‚</li></ul></li><li><strong>æ‰§è¡Œå™¨</strong>ï¼š<ul><li>æ¥æ”¶è°ƒåº¦ä¸­å¿ƒåˆ†å‘çš„ä»»åŠ¡å¹¶æ‰§è¡Œã€‚</li><li>åé¦ˆä»»åŠ¡çš„æ‰§è¡ŒçŠ¶æ€å’Œæ—¥å¿—åˆ°è°ƒåº¦ä¸­å¿ƒã€‚</li></ul></li><li><strong>é€šä¿¡æœºåˆ¶</strong>ï¼š<ul><li>è°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨ä¹‹é—´éœ€è¦ä¸€ä¸ªå¯é çš„é€šä¿¡æœºåˆ¶ï¼Œå¸¸è§çš„æœ‰ HTTPã€RPC ç­‰ã€‚</li></ul></li></ol><h2 id="3-æŠ€æœ¯é€‰å‹"><a href="#3-æŠ€æœ¯é€‰å‹" class="headerlink" title="3. æŠ€æœ¯é€‰å‹"></a>3. æŠ€æœ¯é€‰å‹</h2><ol><li><strong>ç¼–ç¨‹è¯­è¨€</strong>ï¼šJava æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå› ä¸º XXL-JOB æœ¬èº«å°±æ˜¯åŸºäº Java å®ç°çš„ï¼Œä¸” Java æœ‰ä¸°å¯Œçš„ç”Ÿæ€æ”¯æŒã€‚</li><li><strong>æŒä¹…åŒ–å­˜å‚¨</strong>ï¼šMySQL ç”¨äºå­˜å‚¨ä»»åŠ¡å…ƒæ•°æ®å’Œæ‰§è¡Œæ—¥å¿—ã€‚</li><li><strong>é€šä¿¡åè®®</strong>ï¼šRESTful API æˆ–è€… gRPCã€‚</li><li><strong>è°ƒåº¦æ¡†æ¶</strong>ï¼šQuartzï¼Œå¯ä»¥ç”¨æ¥å®ç°å¤æ‚çš„è°ƒåº¦ç­–ç•¥ã€‚</li><li><strong>ç›‘æ§ä¸æ—¥å¿—</strong>ï¼šLogback æˆ– Log4j2 è®°å½•æ—¥å¿—ï¼ŒPrometheus å’Œ Grafana ç”¨äºç›‘æ§ã€‚</li></ol><h2 id="4-å…·ä½“å®ç°æ­¥éª¤"><a href="#4-å…·ä½“å®ç°æ­¥éª¤" class="headerlink" title="4. å…·ä½“å®ç°æ­¥éª¤"></a>4. å…·ä½“å®ç°æ­¥éª¤</h2><h4 id="1-åˆ›å»ºè°ƒåº¦ä¸­å¿ƒ"><a href="#1-åˆ›å»ºè°ƒåº¦ä¸­å¿ƒ" class="headerlink" title="1. åˆ›å»ºè°ƒåº¦ä¸­å¿ƒ"></a>1. åˆ›å»ºè°ƒåº¦ä¸­å¿ƒ</h4><ul><li><strong>ä»»åŠ¡ç®¡ç†æ¥å£</strong>ï¼šæä¾›å¢åˆ æ”¹æŸ¥ä»»åŠ¡çš„ APIã€‚</li><li><strong>ä»»åŠ¡è°ƒåº¦æ¨¡å—</strong>ï¼šä½¿ç”¨ Quartz æ¥è°ƒåº¦ä»»åŠ¡ï¼Œå¹¶å®ç°ä»»åŠ¡çš„åˆ†å‘ã€‚</li><li><strong>ä»»åŠ¡ç›‘æ§ä¸æ—¥å¿—æ¨¡å—</strong>ï¼šè®°å½•ä»»åŠ¡æ‰§è¡Œçš„æ—¥å¿—å’ŒçŠ¶æ€ï¼Œæä¾›ç›‘æ§æ¥å£ã€‚</li></ul><h4 id="2-æ‰§è¡Œå™¨å®ç°"><a href="#2-æ‰§è¡Œå™¨å®ç°" class="headerlink" title="2. æ‰§è¡Œå™¨å®ç°"></a>2. æ‰§è¡Œå™¨å®ç°</h4><ul><li><strong>ä»»åŠ¡æ‰§è¡Œæ¥å£</strong>ï¼šå®ç°ä¸€ä¸ª HTTP æˆ– RPC æ¥å£ï¼Œç”¨äºæ¥æ”¶è°ƒåº¦ä¸­å¿ƒåˆ†å‘çš„ä»»åŠ¡ã€‚</li><li><strong>ä»»åŠ¡æ‰§è¡Œé€»è¾‘</strong>ï¼šæ ¹æ®ä»»åŠ¡çš„å®šä¹‰æ‰§è¡Œå…·ä½“çš„ä»»åŠ¡é€»è¾‘ï¼Œå¹¶åé¦ˆæ‰§è¡Œç»“æœå’Œæ—¥å¿—ã€‚</li></ul><h4 id="3-è°ƒåº¦å’Œæ‰§è¡Œæµç¨‹"><a href="#3-è°ƒåº¦å’Œæ‰§è¡Œæµç¨‹" class="headerlink" title="3. è°ƒåº¦å’Œæ‰§è¡Œæµç¨‹"></a>3. è°ƒåº¦å’Œæ‰§è¡Œæµç¨‹</h4><ul><li><strong>ä»»åŠ¡è°ƒåº¦</strong>ï¼šQuartz è§¦å‘ä»»åŠ¡è°ƒåº¦åï¼Œé€šè¿‡ HTTP æˆ– RPC è°ƒç”¨æ‰§è¡Œå™¨çš„ä»»åŠ¡æ‰§è¡Œæ¥å£ã€‚</li><li><strong>ä»»åŠ¡æ‰§è¡Œåé¦ˆ</strong>ï¼šæ‰§è¡Œå™¨åœ¨å®Œæˆä»»åŠ¡åï¼Œå°†ç»“æœå’Œæ—¥å¿—åé¦ˆç»™è°ƒåº¦ä¸­å¿ƒï¼Œè°ƒåº¦ä¸­å¿ƒæ›´æ–°ä»»åŠ¡çŠ¶æ€å’Œæ—¥å¿—ã€‚</li></ul><h4 id="4-é«˜å¯ç”¨è®¾è®¡"><a href="#4-é«˜å¯ç”¨è®¾è®¡" class="headerlink" title="4. é«˜å¯ç”¨è®¾è®¡"></a>4. é«˜å¯ç”¨è®¾è®¡</h4><ul><li><strong>è°ƒåº¦ä¸­å¿ƒé«˜å¯ç”¨</strong>ï¼šé€šè¿‡å¤šå®ä¾‹éƒ¨ç½²å’Œè´Ÿè½½å‡è¡¡å®ç°é«˜å¯ç”¨ã€‚</li><li><strong>æ‰§è¡Œå™¨é«˜å¯ç”¨</strong>ï¼šæ‰§è¡Œå™¨ä¹Ÿæ˜¯å¤šå®ä¾‹éƒ¨ç½²ï¼Œè°ƒåº¦ä¸­å¿ƒæ ¹æ®è´Ÿè½½å‡è¡¡ç­–ç•¥é€‰æ‹©åˆé€‚çš„æ‰§è¡Œå™¨ã€‚</li></ul><h3 id="äº”ã€éƒ¨ç½²ä¸è¿ç»´"><a href="#äº”ã€éƒ¨ç½²ä¸è¿ç»´" class="headerlink" title="äº”ã€éƒ¨ç½²ä¸è¿ç»´"></a>äº”ã€éƒ¨ç½²ä¸è¿ç»´</h3><ol><li><strong>ä½¿ç”¨ Docker å®¹å™¨åŒ–è°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨</strong>ã€‚</li><li><strong>ä½¿ç”¨ Kubernetes å®ç°è°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨çš„é«˜å¯ç”¨éƒ¨ç½²</strong>ã€‚</li><li><strong>ä½¿ç”¨ELKç›‘æ§æ—¥å¿—</strong></li></ol><h2 id="4-Spring-Boot-é›†æˆ-XXL-JOB"><a href="#4-Spring-Boot-é›†æˆ-XXL-JOB" class="headerlink" title="4 Spring Boot é›†æˆ XXL-JOB"></a>4 <strong>Spring Boot é›†æˆ XXL-JOB</strong></h2><p>å‚è€ƒ<a href="https://www.xuxueli.com/xxl-job/#%E4%BA%8C%E3%80%81%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8">å¿«é€Ÿå…¥é—¨</a></p><h3 id="1-é…ç½®è¿è¡Œè°ƒåº¦ä¸­å¿ƒï¼ˆxxl-job-adminï¼‰"><a href="#1-é…ç½®è¿è¡Œè°ƒåº¦ä¸­å¿ƒï¼ˆxxl-job-adminï¼‰" class="headerlink" title="1. é…ç½®è¿è¡Œè°ƒåº¦ä¸­å¿ƒï¼ˆxxl-job-adminï¼‰"></a>1. é…ç½®è¿è¡Œè°ƒåº¦ä¸­å¿ƒï¼ˆxxl-job-adminï¼‰</h3><ol><li>é¦–å…ˆä»æºç ä»“åº“ä¸­ä¸‹è½½ä»£ç </li><li>æ‰§è¡Œdoc&#x2F;db<code>ç›®å½•ä¸‹æœ‰æ•°æ®åº“è„šæœ¬</code>tables_xxl_job.sqlï¼Œåˆå§‹åŒ–è°ƒåº¦æ•°æ®åº“ <code>xxl_job</code></li><li>ä¿®æ”¹ xxl-job-admin çš„é…ç½®æ–‡ä»¶ï¼Œä¸»è¦æ˜¯ä¿®æ”¹æ•°æ®æºä¿¡æ¯ï¼Œè‹¥éœ€è¦ç”¨åˆ°é‚®ä»¶æŠ¥è­¦åŠŸèƒ½ï¼Œéœ€è¦é…ç½®é‚®ç®±</li><li>å¯åŠ¨XxlJobAdminApplicationï¼Œæ­£å¸¸å¯åŠ¨åï¼Œè®¿é—®åœ°å€ä¸ºï¼š<code>http://localhost:8080/xxl-job-admin</code>ï¼Œé»˜è®¤çš„è´¦æˆ·ä¸º adminï¼Œå¯†ç ä¸º 123456ï¼Œ</li></ol><h3 id="2-é…ç½®è¿è¡Œæ‰§è¡Œå™¨é¡¹ç›®ï¼ˆxxl-job-executorï¼‰"><a href="#2-é…ç½®è¿è¡Œæ‰§è¡Œå™¨é¡¹ç›®ï¼ˆxxl-job-executorï¼‰" class="headerlink" title="2. é…ç½®è¿è¡Œæ‰§è¡Œå™¨é¡¹ç›®ï¼ˆxxl-job-executorï¼‰"></a>2. é…ç½®è¿è¡Œæ‰§è¡Œå™¨é¡¹ç›®ï¼ˆxxl-job-executorï¼‰</h3><ol><li><p>æ·»åŠ ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">implementation &#x27;com.xuxueli:xxl-job-core:2.3.0&#x27;<br></code></pre></td></tr></table></figure></li><li><p>åŠ å…¥é…ç½®</p></li></ol><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">### è°ƒåº¦ä¸­å¿ƒéƒ¨ç½²è·Ÿåœ°å€ [é€‰å¡«]ï¼šå¦‚è°ƒåº¦ä¸­å¿ƒé›†ç¾¤éƒ¨ç½²å­˜åœ¨å¤šä¸ªåœ°å€åˆ™ç”¨é€—å·åˆ†éš”ã€‚æ‰§è¡Œå™¨å°†ä¼šä½¿ç”¨è¯¥åœ°å€è¿›è¡Œ&quot;æ‰§è¡Œå™¨å¿ƒè·³æ³¨å†Œ&quot;å’Œ&quot;ä»»åŠ¡ç»“æœå›è°ƒ&quot;ï¼›ä¸ºç©ºåˆ™å…³é—­è‡ªåŠ¨æ³¨å†Œï¼›</span><br><span class="hljs-meta">xxl.job.admin.addresses</span>=<span class="hljs-string">http://localhost:6100/xxl-job-admin</span><br><span class="hljs-comment">### æ‰§è¡Œå™¨é€šè®¯TOKEN [é€‰å¡«]ï¼šéç©ºæ—¶å¯ç”¨ï¼›</span><br><span class="hljs-meta">xxl.job.accessToken</span>=<span class="hljs-string"></span><br><span class="hljs-comment">### æ‰§è¡Œå™¨AppName [é€‰å¡«]ï¼šæ‰§è¡Œå™¨å¿ƒè·³æ³¨å†Œåˆ†ç»„ä¾æ®ï¼›ä¸ºç©ºåˆ™å…³é—­è‡ªåŠ¨æ³¨å†Œ</span><br><span class="hljs-meta">xxl.job.executor.appname</span>=<span class="hljs-string">xxl-job-executor-city-eureka</span><br><span class="hljs-comment">### æ‰§è¡Œå™¨æ³¨å†Œ [é€‰å¡«]ï¼šä¼˜å…ˆä½¿ç”¨è¯¥é…ç½®ä½œä¸ºæ³¨å†Œåœ°å€ï¼Œä¸ºç©ºæ—¶ä½¿ç”¨å†…åµŒæœåŠ¡ â€IP:PORTâ€œ ä½œä¸ºæ³¨å†Œåœ°å€ã€‚ä»è€Œæ›´çµæ´»çš„æ”¯æŒå®¹å™¨ç±»å‹æ‰§è¡Œå™¨åŠ¨æ€IPå’ŒåŠ¨æ€æ˜ å°„ç«¯å£é—®é¢˜ã€‚</span><br><span class="hljs-meta">xxl.job.executor.address</span>=<span class="hljs-string"></span><br><span class="hljs-comment">### æ‰§è¡Œå™¨IP [é€‰å¡«]ï¼šé»˜è®¤ä¸ºç©ºè¡¨ç¤ºè‡ªåŠ¨è·å–IPï¼Œå¤šç½‘å¡æ—¶å¯æ‰‹åŠ¨è®¾ç½®æŒ‡å®šIPï¼Œè¯¥IPä¸ä¼šç»‘å®šHostä»…ä½œä¸ºé€šè®¯æ—¶ç”¨ï¼›åœ°å€ä¿¡æ¯ç”¨äº &quot;æ‰§è¡Œå™¨æ³¨å†Œ&quot; å’Œ &quot;è°ƒåº¦ä¸­å¿ƒè¯·æ±‚å¹¶è§¦å‘ä»»åŠ¡&quot;ï¼›</span><br><span class="hljs-meta">xxl.job.executor.ip</span>=<span class="hljs-string">localhost</span><br><span class="hljs-comment">### æ‰§è¡Œå™¨ç«¯å£å· [é€‰å¡«]ï¼šå°äºç­‰äº0åˆ™è‡ªåŠ¨è·å–ï¼›é»˜è®¤ç«¯å£ä¸º9999ï¼Œå•æœºéƒ¨ç½²å¤šä¸ªæ‰§è¡Œå™¨æ—¶ï¼Œæ³¨æ„è¦é…ç½®ä¸åŒæ‰§è¡Œå™¨ç«¯å£ï¼›</span><br><span class="hljs-meta">xxl.job.executor.port</span>=<span class="hljs-string">9999</span><br><span class="hljs-comment">### æ‰§è¡Œå™¨è¿è¡Œæ—¥å¿—æ–‡ä»¶å­˜å‚¨ç£ç›˜è·¯å¾„ [é€‰å¡«] ï¼šéœ€è¦å¯¹è¯¥è·¯å¾„æ‹¥æœ‰è¯»å†™æƒé™ï¼›ä¸ºç©ºåˆ™ä½¿ç”¨é»˜è®¤è·¯å¾„ï¼›</span><br><span class="hljs-meta">xxl.job.executor.logpath</span>=<span class="hljs-string">/data/applogs/xxl-job/jobhandler</span><br><span class="hljs-comment">### æ‰§è¡Œå™¨æ—¥å¿—æ–‡ä»¶ä¿å­˜å¤©æ•° [é€‰å¡«] ï¼š è¿‡æœŸæ—¥å¿—è‡ªåŠ¨æ¸…ç†, é™åˆ¶å€¼å¤§äºç­‰äº3æ—¶ç”Ÿæ•ˆ; å¦åˆ™, å¦‚-1, å…³é—­è‡ªåŠ¨æ¸…ç†åŠŸèƒ½ï¼›</span><br><span class="hljs-meta">xxl.job.executor.logretentiondays</span>=<span class="hljs-string">30</span><br></code></pre></td></tr></table></figure><ol start="3"><li>åœ¨ config åŒ…ä¸‹åˆ›å»º <code>XxlJobConfig</code> ç±»</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.pyr.city.config;<br><br><span class="hljs-keyword">import</span> com.xxl.job.core.executor.impl.XxlJobSpringExecutor;<br><span class="hljs-keyword">import</span> org.slf4j.Logger;<br><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Value;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * xxl-job config</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> xuxueli 2017-04-28</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">XxlJobConfig</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Logger logger = LoggerFactory.getLogger(XxlJobConfig.class);<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;xxl.job.admin.addresses&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String adminAddresses;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;xxl.job.accessToken&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String accessToken;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;xxl.job.executor.appname&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String appname;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;xxl.job.executor.address&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String address;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;xxl.job.executor.ip&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String ip;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;xxl.job.executor.port&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> port;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;xxl.job.executor.logpath&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String logPath;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;xxl.job.executor.logretentiondays&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> logRetentionDays;<br><br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> XxlJobSpringExecutor <span class="hljs-title">xxlJobExecutor</span><span class="hljs-params">()</span> </span>&#123;<br>        logger.info(<span class="hljs-string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job config init.&quot;</span>);<br>        XxlJobSpringExecutor xxlJobSpringExecutor = <span class="hljs-keyword">new</span> XxlJobSpringExecutor();<br>        xxlJobSpringExecutor.setAdminAddresses(adminAddresses);<br>        xxlJobSpringExecutor.setAppname(appname);<br>        xxlJobSpringExecutor.setAddress(address);<br>        xxlJobSpringExecutor.setIp(ip);<br>        xxlJobSpringExecutor.setPort(port);<br>        xxlJobSpringExecutor.setAccessToken(accessToken);<br>        xxlJobSpringExecutor.setLogPath(logPath);<br>        xxlJobSpringExecutor.setLogRetentionDays(logRetentionDays);<br><br>        <span class="hljs-keyword">return</span> xxlJobSpringExecutor;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="4"><li>ç¼–å†™ JobHandler</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleXxlJob</span> </span>&#123;<br>    <span class="hljs-meta">@XxlJob(&quot;demoJobHandler&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">demoJobHandler</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ‰§è¡Œå®šæ—¶ä»»åŠ¡ï¼Œæ‰§è¡Œæ—¶é—´ä¸ºï¼š&quot;</span>+<span class="hljs-keyword">new</span> Date());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-BEANæ¨¡å¼æµ‹è¯•"><a href="#3-BEANæ¨¡å¼æµ‹è¯•" class="headerlink" title="3. BEANæ¨¡å¼æµ‹è¯•"></a>3. BEANæ¨¡å¼æµ‹è¯•</h3><p>BEANæ¨¡å¼æ‰§è¡Œå™¨ï¼šæ¯ä¸ªæ‰§è¡Œå™¨éƒ½æ˜¯Springçš„ä¸€ä¸ªBeanå®ä¾‹ï¼ŒXXL-JOBé€šè¿‡æ³¨è§£ <code>@XxlJob</code>çš„æ–¹å¼è¿›è¡Œä»»åŠ¡å¼€å‘ï¼›</p><ol><li>ç¼–å†™ JobHandler</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleXxlJob</span> </span>&#123;<br>    <span class="hljs-meta">@XxlJob(&quot;demoJobHandler&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">demoJobHandler</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ‰§è¡Œå®šæ—¶ä»»åŠ¡ï¼Œæ‰§è¡Œæ—¶é—´ä¸ºï¼š&quot;</span>+<span class="hljs-keyword">new</span> Date());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li>åœ¨æ‰§è¡Œå™¨ç®¡ç†é¡µé¢æ·»åŠ è¯¥æ‰§è¡Œå™¨ã€‚</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231114165019091.png" alt="image-20231114165019091"></p><ol start="3"><li>åœ¨ä»»åŠ¡ç®¡ç†ç•Œé¢æ·»åŠ æˆ‘ä»¬åˆšæ‰å¼€å‘çš„ä»»åŠ¡ï¼Œè¿è¡Œæ¨¡å¼é€‰æ‹©BEAN</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231114165049371.png" alt="image-20231114165049371"></p><ol start="4"><li>åœ¨æ“ä½œé¡µé¢ï¼Œç‚¹å‡»æ‰§è¡Œä¸€æ¬¡</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231114165154323.png" alt="image-20231114165154323"></p><h3 id="4-GLUE-Java-æ¨¡å¼æµ‹è¯•"><a href="#4-GLUE-Java-æ¨¡å¼æµ‹è¯•" class="headerlink" title="4. GLUE(Java)æ¨¡å¼æµ‹è¯•"></a>4. GLUE(Java)æ¨¡å¼æµ‹è¯•</h3><ol><li>åœ¨ä»»åŠ¡ç®¡ç†ç•Œé¢æ·»åŠ ä¸€ä¸ªæ–°ä»»åŠ¡ï¼Œè¿è¡Œæ¨¡å¼é€‰æ‹©BEAN</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231114183450401.png" alt="image-20231114183450401"></p><ol start="2"><li>ç¼–è¾‘éœ€è¦æ‰§è¡Œçš„ä»£ç </li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231114183527467.png" alt="image-20231114183527467"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231114183541042.png" alt="image-20231114183541042"></p><ol start="3"><li>åœ¨æ“ä½œé¡µé¢ï¼Œç‚¹å‡»æ‰§è¡Œä¸€æ¬¡</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231114183617278.png" alt="image-20231114183617278"></p><ol start="5"><li>æ‰§è¡Œæ—¥å¿—æ‰“å°</li></ol><p>éœ€è¦ä½¿ç”¨<code>XxlJobHelper.log</code>æ‰“å°æ‰§è¡Œæ—¥å¿—ï¼›</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231114184326029.png" alt="image-20231114184326029"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231114184858772.png" alt="image-20231114184858772"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231114184353146.png" alt="image-20231114184353146"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>pgsql</title>
    <link href="/pgsql/"/>
    <url>/pgsql/</url>
    
    <content type="html"><![CDATA[<h1 id="1-pgsqlçš„ä¼˜åŠ¿"><a href="#1-pgsqlçš„ä¼˜åŠ¿" class="headerlink" title="1. pgsqlçš„ä¼˜åŠ¿"></a>1. pgsqlçš„ä¼˜åŠ¿</h1><h3 id="1-å¼€æºå’Œç¤¾åŒºæ”¯æŒ"><a href="#1-å¼€æºå’Œç¤¾åŒºæ”¯æŒ" class="headerlink" title="1. å¼€æºå’Œç¤¾åŒºæ”¯æŒ"></a>1. <strong>å¼€æºå’Œç¤¾åŒºæ”¯æŒ</strong></h3><ul><li><strong>å¼€æº</strong>ï¼šPostgreSQL æ˜¯å®Œå…¨å¼€æºçš„ï¼Œæ— éœ€æ”¯ä»˜è®¸å¯è´¹ç”¨ã€‚</li><li><strong>æ´»è·ƒçš„ç¤¾åŒº</strong>ï¼šæœ‰ä¸€ä¸ªæ´»è·ƒçš„ç¤¾åŒºæä¾›æ”¯æŒå’Œå¼€å‘ï¼Œä¸æ–­æ”¹è¿›å’Œæ›´æ–°åŠŸèƒ½ã€‚</li></ul><h3 id="2-å¼ºå¤§çš„åŠŸèƒ½é›†"><a href="#2-å¼ºå¤§çš„åŠŸèƒ½é›†" class="headerlink" title="2. å¼ºå¤§çš„åŠŸèƒ½é›†"></a>2. <strong>å¼ºå¤§çš„åŠŸèƒ½é›†</strong></h3><ul><li><strong>ACID åˆè§„</strong>ï¼šå®Œå…¨éµå¾ª ACID åŸåˆ™ï¼Œç¡®ä¿æ•°æ®çš„å¯é æ€§å’Œä¸€è‡´æ€§ã€‚</li><li><strong>é«˜çº§ SQL åŠŸèƒ½</strong>ï¼šæ”¯æŒå¤æ‚æŸ¥è¯¢ã€å­æŸ¥è¯¢ã€çª—å£å‡½æ•°ã€CTEï¼ˆCommon Table Expressionsï¼‰ç­‰ã€‚</li><li><strong>å¹¶å‘æ§åˆ¶</strong>ï¼šä½¿ç”¨å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰å®ç°é«˜æ•ˆå¹¶å‘å¤„ç†ï¼Œå‡å°‘é”äº‰ç”¨ã€‚</li></ul><h3 id="3-æ‰©å±•æ€§å’Œå¯æ‰©å±•æ€§"><a href="#3-æ‰©å±•æ€§å’Œå¯æ‰©å±•æ€§" class="headerlink" title="3. æ‰©å±•æ€§å’Œå¯æ‰©å±•æ€§"></a>3. <strong>æ‰©å±•æ€§å’Œå¯æ‰©å±•æ€§</strong></h3><ul><li><strong>æ‰©å±•æ”¯æŒ</strong>ï¼šæ”¯æŒå¤šç§æ‰©å±•ï¼Œå¦‚ PostGISï¼ˆåœ°ç†ä¿¡æ¯ç³»ç»Ÿæ‰©å±•ï¼‰ã€Full Text Searchï¼ˆå…¨æ–‡æœç´¢æ‰©å±•ï¼‰ã€‚</li><li><strong>å¯ç¼–ç¨‹æ€§</strong>ï¼šæ”¯æŒå­˜å‚¨è¿‡ç¨‹å’Œè§¦å‘å™¨ï¼Œå¯ä»¥ä½¿ç”¨å¤šç§è¯­è¨€ç¼–å†™ï¼Œå¦‚ PL&#x2F;pgSQLã€PL&#x2F;Pythonã€PL&#x2F;Perlã€‚</li></ul><h3 id="4-æ•°æ®å®Œæ•´æ€§"><a href="#4-æ•°æ®å®Œæ•´æ€§" class="headerlink" title="4. æ•°æ®å®Œæ•´æ€§"></a>4. <strong>æ•°æ®å®Œæ•´æ€§</strong></h3><ul><li><strong>æ•°æ®ç±»å‹ä¸°å¯Œ</strong>ï¼šæ”¯æŒä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬ JSONã€æ•°ç»„ã€èŒƒå›´ã€æšä¸¾ã€å‡ ä½•æ•°æ®ç­‰ã€‚</li><li><strong>çº¦æŸå’Œè§¦å‘å™¨</strong>ï¼šæ”¯æŒå¤šç§çº¦æŸï¼ˆå¦‚ä¸»é”®ã€å¤–é”®ã€å”¯ä¸€çº¦æŸï¼‰å’Œè§¦å‘å™¨ï¼Œç¡®ä¿æ•°æ®å®Œæ•´æ€§ã€‚</li><li><strong>å¤–éƒ¨æ•°æ®åŒ…è£…å™¨</strong>ï¼šé€šè¿‡ Foreign Data Wrapperï¼ˆFDWï¼‰å¯ä»¥æŸ¥è¯¢å¤–éƒ¨æ•°æ®æºã€‚</li></ul><h3 id="5-é«˜æ€§èƒ½å’Œä¼˜åŒ–"><a href="#5-é«˜æ€§èƒ½å’Œä¼˜åŒ–" class="headerlink" title="5. é«˜æ€§èƒ½å’Œä¼˜åŒ–"></a>5. <strong>é«˜æ€§èƒ½å’Œä¼˜åŒ–</strong></h3><ul><li><strong>å¹¶è¡ŒæŸ¥è¯¢</strong>ï¼šæ”¯æŒå¹¶è¡ŒæŸ¥è¯¢ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸ CPU æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</li><li><strong>é«˜çº§ç´¢å¼•</strong>ï¼šæ”¯æŒå¤šç§ç´¢å¼•ç±»å‹ï¼ˆå¦‚ B-treeã€GINã€GiSTã€BRINï¼‰ï¼Œæ»¡è¶³ä¸åŒæŸ¥è¯¢éœ€æ±‚ã€‚</li><li><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼šæ”¯æŒè¡¨å’Œç´¢å¼•çš„å†…å­˜ç¼“å­˜ï¼Œæé«˜è®¿é—®é€Ÿåº¦ã€‚</li></ul><h3 id="6-é«˜å¯ç”¨æ€§å’Œå®¹ç¾"><a href="#6-é«˜å¯ç”¨æ€§å’Œå®¹ç¾" class="headerlink" title="6. é«˜å¯ç”¨æ€§å’Œå®¹ç¾"></a>6. <strong>é«˜å¯ç”¨æ€§å’Œå®¹ç¾</strong></h3><ul><li><strong>æµå¤åˆ¶</strong>ï¼šæ”¯æŒä¸»ä»å¤åˆ¶ï¼ˆåŒæ­¥å’Œå¼‚æ­¥ï¼‰ï¼Œå®ç°é«˜å¯ç”¨æ€§ã€‚</li><li><strong>é€»è¾‘å¤åˆ¶</strong>ï¼šæ”¯æŒé€»è¾‘å¤åˆ¶ï¼Œå¯ä»¥è¿›è¡Œéƒ¨åˆ†æ•°æ®çš„å¤åˆ¶å’Œå®šåˆ¶åŒ–çš„æ•°æ®åŒæ­¥ã€‚</li><li><strong>å¤‡ä»½å’Œæ¢å¤</strong>ï¼šæ”¯æŒçƒ­å¤‡ä»½å’Œ PITRï¼ˆæ—¶é—´ç‚¹æ¢å¤ï¼‰ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ã€‚</li></ul><h3 id="7-çµæ´»æ€§å’Œå…¼å®¹æ€§"><a href="#7-çµæ´»æ€§å’Œå…¼å®¹æ€§" class="headerlink" title="7. çµæ´»æ€§å’Œå…¼å®¹æ€§"></a>7. <strong>çµæ´»æ€§å’Œå…¼å®¹æ€§</strong></h3><ul><li><strong>è·¨å¹³å°æ”¯æŒ</strong>ï¼šæ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿï¼Œå¦‚ Linuxã€Windowsã€macOSã€‚</li><li><strong>æ ‡å‡†å…¼å®¹</strong>ï¼šé«˜åº¦å…¼å®¹ SQL æ ‡å‡†ï¼Œæ˜“äºè¿ç§»å’Œé›†æˆã€‚</li><li><strong>æ‰©å±•æ”¯æŒ</strong>ï¼šé€šè¿‡æ’ä»¶å’Œæ‰©å±•ï¼ˆå¦‚ pg_partmanã€pg_stat_statementsï¼‰å¯ä»¥æ‰©å±•åŠŸèƒ½ã€‚</li></ul><h3 id="8-ç®¡ç†å’Œç›‘æ§å·¥å…·"><a href="#8-ç®¡ç†å’Œç›‘æ§å·¥å…·" class="headerlink" title="8. ç®¡ç†å’Œç›‘æ§å·¥å…·"></a>8. <strong>ç®¡ç†å’Œç›‘æ§å·¥å…·</strong></h3><ul><li><strong>pgAdmin</strong>ï¼šå¼ºå¤§çš„å›¾å½¢åŒ–ç®¡ç†å·¥å…·ï¼Œä¾¿äºç®¡ç†å’Œç›‘æ§æ•°æ®åº“ã€‚</li><li><strong>å†…ç½®ç»Ÿè®¡åŠŸèƒ½</strong>ï¼šæä¾›ä¸°å¯Œçš„ç»Ÿè®¡ä¿¡æ¯å’Œè§†å›¾ï¼Œä¾¿äºç›‘æ§å’Œä¼˜åŒ–æ•°æ®åº“æ€§èƒ½ã€‚</li></ul><h3 id="9-å®‰å…¨æ€§"><a href="#9-å®‰å…¨æ€§" class="headerlink" title="9. å®‰å…¨æ€§"></a>9. <strong>å®‰å…¨æ€§</strong></h3><ul><li><strong>è®¿é—®æ§åˆ¶</strong>ï¼šæ”¯æŒåŸºäºè§’è‰²å’Œç”¨æˆ·çš„è®¿é—®æ§åˆ¶ï¼Œæä¾›ç»†ç²’åº¦çš„æƒé™ç®¡ç†ã€‚</li><li><strong>åŠ å¯†</strong>ï¼šæ”¯æŒæ•°æ®ä¼ è¾“åŠ å¯†å’Œç£ç›˜åŠ å¯†ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ã€‚</li><li><strong>è®¤è¯æ–¹å¼</strong>ï¼šæ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼Œå¦‚å¯†ç è®¤è¯ã€Kerberosã€LDAP ç­‰ã€‚</li></ul><h1 id="2-pgsqlæ•°æ®ç±»å‹"><a href="#2-pgsqlæ•°æ®ç±»å‹" class="headerlink" title="2. pgsqlæ•°æ®ç±»å‹"></a>2. pgsqlæ•°æ®ç±»å‹</h1><h3 id="1-æ•°å€¼ç±»å‹"><a href="#1-æ•°å€¼ç±»å‹" class="headerlink" title="1. æ•°å€¼ç±»å‹"></a>1. æ•°å€¼ç±»å‹</h3><ul><li><strong>æ•´æ•°ç±»å‹</strong><ul><li><code>smallint</code>ï¼š2å­—èŠ‚æ•´æ•°ï¼ŒèŒƒå›´ -32,768 åˆ° 32,767</li><li><code>integer</code>ï¼š4å­—èŠ‚æ•´æ•°ï¼ŒèŒƒå›´ -2,147,483,648 åˆ° 2,147,483,647</li><li><code>bigint</code>ï¼š8å­—èŠ‚æ•´æ•°ï¼ŒèŒƒå›´ -9,223,372,036,854,775,808 åˆ° 9,223,372,036,854,775,807</li></ul></li><li><strong>å°æ•°ç±»å‹</strong><ul><li><code>decimal</code> æˆ– <code>numeric</code>ï¼šå¯å˜ç²¾åº¦ï¼Œé€‚ç”¨äºéœ€è¦ç²¾ç¡®å°æ•°çš„åœºåˆ</li><li><code>real</code>ï¼š4å­—èŠ‚æµ®ç‚¹æ•°</li><li><code>double precision</code>ï¼š8å­—èŠ‚æµ®ç‚¹æ•°</li></ul></li><li><strong>åºåˆ—&#x2F;è‡ªåŠ¨å¢é•¿</strong><ul><li><code>serial</code>ï¼šè‡ªåŠ¨é€’å¢çš„4å­—èŠ‚æ•´æ•°</li><li><code>bigserial</code>ï¼šè‡ªåŠ¨é€’å¢çš„8å­—èŠ‚æ•´æ•°</li></ul></li></ul><h3 id="2-å­—ç¬¦ä¸²ç±»å‹"><a href="#2-å­—ç¬¦ä¸²ç±»å‹" class="headerlink" title="2. å­—ç¬¦ä¸²ç±»å‹"></a>2. å­—ç¬¦ä¸²ç±»å‹</h3><ul><li><strong>å®šé•¿å­—ç¬¦ä¸²</strong><ul><li><code>char(n)</code>ï¼šå›ºå®šé•¿åº¦å­—ç¬¦ç±»å‹ï¼Œé•¿åº¦ä¸º n</li></ul></li><li><strong>å˜é•¿å­—ç¬¦ä¸²</strong><ul><li><code>varchar(n)</code>ï¼šå¯å˜é•¿åº¦å­—ç¬¦ç±»å‹ï¼Œæœ€å¤§é•¿åº¦ä¸º n</li><li><code>text</code>ï¼šå¯å˜é•¿åº¦å­—ç¬¦ç±»å‹ï¼Œæ²¡æœ‰é•¿åº¦é™åˆ¶</li></ul></li></ul><h3 id="3-æ—¥æœŸå’Œæ—¶é—´ç±»å‹"><a href="#3-æ—¥æœŸå’Œæ—¶é—´ç±»å‹" class="headerlink" title="3. æ—¥æœŸå’Œæ—¶é—´ç±»å‹"></a>3. æ—¥æœŸå’Œæ—¶é—´ç±»å‹</h3><ul><li>æ—¥æœŸå’Œæ—¶é—´<ul><li><code>date</code>ï¼šæ—¥æœŸç±»å‹ï¼ŒèŒƒå›´ä¸º 4713 BC åˆ° 5874897 AD</li><li><code>time</code>ï¼šæ— æ—¶åŒºçš„æ—¶é—´ç±»å‹</li><li><code>timestamp</code>ï¼šæ— æ—¶åŒºçš„æ—¶é—´æˆ³ç±»å‹</li><li><code>timestamptz</code>ï¼šå¸¦æ—¶åŒºçš„æ—¶é—´æˆ³ç±»å‹</li><li><code>interval</code>ï¼šæ—¶é—´é—´éš”</li></ul></li></ul><h3 id="4-å¸ƒå°”ç±»å‹"><a href="#4-å¸ƒå°”ç±»å‹" class="headerlink" title="4. å¸ƒå°”ç±»å‹"></a>4. å¸ƒå°”ç±»å‹</h3><ul><li>å¸ƒå°”å€¼<ul><li><code>boolean</code>ï¼šå€¼ä¸º <code>TRUE</code>ã€<code>FALSE</code> æˆ– <code>NULL</code></li></ul></li></ul><h3 id="5-æšä¸¾ç±»å‹"><a href="#5-æšä¸¾ç±»å‹" class="headerlink" title="5. æšä¸¾ç±»å‹"></a>5. æšä¸¾ç±»å‹</h3><ul><li>æšä¸¾<ul><li><code>enum</code>ï¼šå®šä¹‰ä¸€ç»„å›ºå®šå€¼</li></ul></li></ul><h3 id="6-æ•°ç»„ç±»å‹"><a href="#6-æ•°ç»„ç±»å‹" class="headerlink" title="6. æ•°ç»„ç±»å‹"></a>6. æ•°ç»„ç±»å‹</h3><ul><li>æ•°ç»„<ul><li>ä»»æ„ç±»å‹çš„æ•°ç»„ï¼Œå¦‚ <code>integer[]</code>ã€<code>text[]</code></li></ul></li></ul><h3 id="7-JSON-ç±»å‹"><a href="#7-JSON-ç±»å‹" class="headerlink" title="7. JSON ç±»å‹"></a>7. JSON ç±»å‹</h3><ul><li>JSON æ•°æ®<ul><li><code>json</code>ï¼šå­˜å‚¨JSONæ•°æ®</li><li><code>jsonb</code>ï¼šå­˜å‚¨äºŒè¿›åˆ¶JSONæ•°æ®ï¼Œæ”¯æŒç´¢å¼•å’Œæ›´å¿«çš„æŸ¥è¯¢</li></ul></li></ul><h3 id="8-èŒƒå›´ç±»å‹"><a href="#8-èŒƒå›´ç±»å‹" class="headerlink" title="8. èŒƒå›´ç±»å‹"></a>8. èŒƒå›´ç±»å‹</h3><ul><li>èŒƒå›´<ul><li><code>int4range</code>ã€<code>int8range</code>ã€<code>numrange</code>ã€<code>tsrange</code>ã€<code>tstzrange</code>ã€<code>daterange</code>ï¼šè¡¨ç¤ºèŒƒå›´å€¼</li></ul></li></ul><h3 id="9-å‡ ä½•ç±»å‹"><a href="#9-å‡ ä½•ç±»å‹" class="headerlink" title="9. å‡ ä½•ç±»å‹"></a>9. å‡ ä½•ç±»å‹</h3><ul><li>å‡ ä½•æ•°æ®<ul><li><code>point</code>ã€<code>line</code>ã€<code>lseg</code>ã€<code>box</code>ã€<code>path</code>ã€<code>polygon</code>ã€<code>circle</code>ï¼šç”¨äºå‡ ä½•è®¡ç®—çš„ç±»å‹</li></ul></li></ul><h3 id="10-ç½‘ç»œåœ°å€ç±»å‹"><a href="#10-ç½‘ç»œåœ°å€ç±»å‹" class="headerlink" title="10. ç½‘ç»œåœ°å€ç±»å‹"></a>10. ç½‘ç»œåœ°å€ç±»å‹</h3><ul><li>ç½‘ç»œåœ°å€<ul><li><code>cidr</code>ï¼šIPv4æˆ–IPv6ç½‘ç»œ</li><li><code>inet</code>ï¼šIPv4æˆ–IPv6åœ°å€</li><li><code>macaddr</code>ï¼šMACåœ°å€</li></ul></li></ul><h3 id="11-UUID-ç±»å‹"><a href="#11-UUID-ç±»å‹" class="headerlink" title="11. UUID ç±»å‹"></a>11. UUID ç±»å‹</h3><ul><li>UUID<ul><li><code>uuid</code>ï¼šé€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦</li></ul></li></ul><h3 id="12-Hstore-ç±»å‹"><a href="#12-Hstore-ç±»å‹" class="headerlink" title="12. Hstore ç±»å‹"></a>12. Hstore ç±»å‹</h3><ul><li>é”®å€¼å¯¹å­˜å‚¨<ul><li><code>hstore</code>ï¼šå­˜å‚¨é”®å€¼å¯¹æ•°æ®</li></ul></li></ul><h3 id="13-å¤åˆç±»å‹"><a href="#13-å¤åˆç±»å‹" class="headerlink" title="13. å¤åˆç±»å‹"></a>13. å¤åˆç±»å‹</h3><ul><li>å¤åˆ<ul><li>ç”¨æˆ·å®šä¹‰çš„å¤åˆç±»å‹ï¼ŒåŒ…å«å¤šä¸ªå­—æ®µ</li></ul></li></ul><h1 id="3-pgsqlç´¢å¼•ç±»å‹"><a href="#3-pgsqlç´¢å¼•ç±»å‹" class="headerlink" title="3. pgsqlç´¢å¼•ç±»å‹"></a>3. pgsqlç´¢å¼•ç±»å‹</h1><h3 id="1-B-tree-ç´¢å¼•"><a href="#1-B-tree-ç´¢å¼•" class="headerlink" title="1. B-tree ç´¢å¼•"></a>1. B-tree ç´¢å¼•</h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼šé»˜è®¤ç´¢å¼•ç±»å‹ï¼Œé€‚ç”¨äºå¤§å¤šæ•°æƒ…å†µã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šé€‚ç”¨äºç­‰å€¼æŸ¥è¯¢ã€èŒƒå›´æŸ¥è¯¢ã€æ’åºã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_example_btree <span class="hljs-keyword">ON</span> example_table (<span class="hljs-built_in">column_name</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="2-Hash-ç´¢å¼•"><a href="#2-Hash-ç´¢å¼•" class="headerlink" title="2. Hash ç´¢å¼•"></a>2. Hash ç´¢å¼•</h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼šé€‚ç”¨äºç­‰å€¼æŸ¥è¯¢ï¼Œä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šä»…é€‚ç”¨äºç­‰å€¼æ¯”è¾ƒï¼Œå¦‚ <code>=</code> å’Œ <code>IN</code>ã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_example_hash <span class="hljs-keyword">ON</span> example_table <span class="hljs-keyword">USING</span> hash (<span class="hljs-built_in">column_name</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="3-GINï¼ˆGeneralized-Inverted-Indexï¼‰"><a href="#3-GINï¼ˆGeneralized-Inverted-Indexï¼‰" class="headerlink" title="3. GINï¼ˆGeneralized Inverted Indexï¼‰"></a>3. GINï¼ˆGeneralized Inverted Indexï¼‰</h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼šé€‚ç”¨äºåŒ…å«å¤æ‚ç»“æ„æ•°æ®çš„åˆ—ï¼Œå¦‚æ•°ç»„ã€å…¨æ–‡æœç´¢ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šæ”¯æŒå¤šå€¼åŒ…å«æŸ¥è¯¢ï¼Œå¦‚æ•°ç»„ã€JSONBã€å…¨æ–‡æœç´¢ã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_example_gin <span class="hljs-keyword">ON</span> example_table <span class="hljs-keyword">USING</span> gin (<span class="hljs-built_in">column_name</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="4-GiSTï¼ˆGeneralized-Search-Treeï¼‰"><a href="#4-GiSTï¼ˆGeneralized-Search-Treeï¼‰" class="headerlink" title="4. GiSTï¼ˆGeneralized Search Treeï¼‰"></a>4. GiSTï¼ˆGeneralized Search Treeï¼‰</h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼šé€‚ç”¨äºéœ€è¦è‡ªå®šä¹‰ç´¢å¼•è¡Œä¸ºçš„åœºæ™¯ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šæ”¯æŒå‡ ä½•æ•°æ®ã€å…¨æ–‡æœç´¢ã€èŒƒå›´æŸ¥è¯¢ã€KNNæŸ¥è¯¢ç­‰ã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_example_gist <span class="hljs-keyword">ON</span> example_table <span class="hljs-keyword">USING</span> gist (<span class="hljs-built_in">column_name</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="5-SP-GiSTï¼ˆSpace-Partitioned-Generalized-Search-Treeï¼‰"><a href="#5-SP-GiSTï¼ˆSpace-Partitioned-Generalized-Search-Treeï¼‰" class="headerlink" title="5. SP-GiSTï¼ˆSpace-Partitioned Generalized Search Treeï¼‰"></a>5. SP-GiSTï¼ˆSpace-Partitioned Generalized Search Treeï¼‰</h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼šé€‚ç”¨äºç©ºé—´æ•°æ®å’Œç¨€ç–æ•°æ®ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šæ”¯æŒç©ºé—´æ•°æ®ã€é«˜ç»´æ•°æ®ç­‰ã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_example_spgist <span class="hljs-keyword">ON</span> example_table <span class="hljs-keyword">USING</span> spgist (<span class="hljs-built_in">column_name</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="6-BRINï¼ˆBlock-Range-INdexesï¼‰"><a href="#6-BRINï¼ˆBlock-Range-INdexesï¼‰" class="headerlink" title="6. BRINï¼ˆBlock Range INdexesï¼‰"></a>6. BRINï¼ˆBlock Range INdexesï¼‰</h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼šé€‚ç”¨äºéå¸¸å¤§çš„è¡¨ï¼Œå­˜å‚¨ç©ºé—´å°ï¼Œé€‚åˆé¡ºåºæ‰«æã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šé€‚ç”¨äºé¡ºåºè®¿é—®çš„å¤§å‹è¡¨ã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_example_brin <span class="hljs-keyword">ON</span> example_table <span class="hljs-keyword">USING</span> brin (<span class="hljs-built_in">column_name</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="7-Full-Text-Search-ç´¢å¼•"><a href="#7-Full-Text-Search-ç´¢å¼•" class="headerlink" title="7. Full Text Search ç´¢å¼•"></a>7. Full Text Search ç´¢å¼•</h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼šé€‚ç”¨äºå…¨æ–‡æœç´¢ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šä¸ºæ–‡æœ¬æ•°æ®åˆ›å»ºé«˜æ•ˆçš„å…¨æ–‡æœç´¢ç´¢å¼•ã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_example_tsvector <span class="hljs-keyword">ON</span> example_table <span class="hljs-keyword">USING</span> gin (to_tsvector(<span class="hljs-string">&#x27;english&#x27;</span>, <span class="hljs-built_in">column_name</span>));<br></code></pre></td></tr></table></figure></li></ul><h3 id="8-Composite-ç´¢å¼•"><a href="#8-Composite-ç´¢å¼•" class="headerlink" title="8. Composite ç´¢å¼•"></a>8. Composite ç´¢å¼•</h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼šåŒ…å«å¤šä¸ªåˆ—çš„ç»„åˆç´¢å¼•ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šä¼˜åŒ–æ¶‰åŠå¤šä¸ªåˆ—çš„æŸ¥è¯¢ã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">CREATE</span> INDEX idx_example_composite <span class="hljs-literal">ON</span> example_table (column<span class="hljs-number">1</span>, column<span class="hljs-number">2</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="9-Partial-ç´¢å¼•"><a href="#9-Partial-ç´¢å¼•" class="headerlink" title="9. Partial ç´¢å¼•"></a>9. Partial ç´¢å¼•</h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼šåŸºäºæ¡ä»¶çš„éƒ¨åˆ†ç´¢å¼•ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šåªç´¢å¼•æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„è¡Œï¼Œå‡å°‘ç´¢å¼•å¤§å°ã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_example_partial <span class="hljs-keyword">ON</span> example_table (<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">WHERE</span> condition;<br></code></pre></td></tr></table></figure></li></ul><h3 id="10-Unique-ç´¢å¼•"><a href="#10-Unique-ç´¢å¼•" class="headerlink" title="10. Unique ç´¢å¼•"></a>10. Unique ç´¢å¼•</h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼šç¡®ä¿åˆ—å€¼å”¯ä¸€ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šä¿è¯åˆ—å€¼å”¯ä¸€æ€§ï¼Œè‡ªåŠ¨åˆ›å»ºåœ¨ä¸»é”®å’Œå”¯ä¸€çº¦æŸä¸Šã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">INDEX</span> idx_example_unique <span class="hljs-keyword">ON</span> example_table (<span class="hljs-built_in">column_name</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="11-Expression-ç´¢å¼•"><a href="#11-Expression-ç´¢å¼•" class="headerlink" title="11. Expression ç´¢å¼•"></a>11. Expression ç´¢å¼•</h3><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼šåŸºäºè¡¨è¾¾å¼çš„ç´¢å¼•ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šå¯¹è®¡ç®—åˆ—æˆ–è¡¨è¾¾å¼åˆ›å»ºç´¢å¼•ã€‚</p></li><li><p>ç¤ºä¾‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">CREATE</span> INDEX idx_example_expression <span class="hljs-literal">ON</span> example_table ((column<span class="hljs-number">1</span> + column<span class="hljs-number">2</span>));<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å†…å­˜æ³„æ¼å’Œå†…å­˜æº¢å‡º</title>
    <link href="/%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E5%92%8C%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA/"/>
    <url>/%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E5%92%8C%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å†…å­˜æ³„æ¼-Memory-Leak"><a href="#1-å†…å­˜æ³„æ¼-Memory-Leak" class="headerlink" title="1.å†…å­˜æ³„æ¼ (Memory Leak)"></a>1.å†…å­˜æ³„æ¼ (Memory Leak)</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. <strong>å®šä¹‰</strong></h2><p> å†…å­˜æ³„æ¼æ˜¯æŒ‡ç¨‹åºæœªèƒ½é‡Šæ”¾å·²ç»ä¸å†ä½¿ç”¨çš„å†…å­˜ï¼Œä»è€Œå¯¼è‡´å†…å­˜èµ„æºè¢«æµªè´¹ã€‚å°½ç®¡è¿™äº›å†…å­˜ä¸å†è¢«ç¨‹åºä½¿ç”¨ï¼Œä½†ç”±äºç¨‹åºä»ç„¶æŒæœ‰å¯¹å®ƒä»¬çš„å¼•ç”¨ï¼Œåƒåœ¾æ”¶é›†å™¨æ— æ³•å›æ”¶å®ƒä»¬ã€‚</p><h2 id="2-ç—‡çŠ¶ï¼š"><a href="#2-ç—‡çŠ¶ï¼š" class="headerlink" title="2. ç—‡çŠ¶ï¼š"></a>2. <strong>ç—‡çŠ¶</strong>ï¼š</h2><ul><li>éšç€æ—¶é—´æ¨ç§»ï¼Œç¨‹åºå ç”¨çš„å†…å­˜ä¸æ–­å¢åŠ ã€‚</li><li>ç¨‹åºå¯èƒ½åœ¨é•¿æ—¶é—´è¿è¡Œåå˜å¾—è¶Šæ¥è¶Šæ…¢ã€‚</li><li>æœ€ç»ˆå¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡ºé”™è¯¯ï¼ˆOutOfMemoryErrorï¼‰ã€‚</li></ul><h2 id="3-åŸå› ï¼š"><a href="#3-åŸå› ï¼š" class="headerlink" title="3. åŸå› ï¼š"></a>3. <strong>åŸå› </strong>ï¼š</h2><ul><li>å¿˜è®°ç§»é™¤ä¸å†ä½¿ç”¨çš„å¯¹è±¡å¼•ç”¨ã€‚</li><li>ä½¿ç”¨é™æ€é›†åˆï¼ˆå¦‚ <code>HashMap</code>ã€<code>ArrayList</code>ï¼‰æ—¶æœªåŠæ—¶æ¸…ç†å…¶ä¸­çš„å¯¹è±¡ã€‚</li><li>äº‹ä»¶ç›‘å¬å™¨ã€å›è°ƒå‡½æ•°æœªè§£é™¤ç»‘å®šã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MemoryLeakExample</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> List&lt;Object&gt; objectList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addObject</span><span class="hljs-params">(Object obj)</span> </span>&#123;<br>        objectList.add(obj);  <span class="hljs-comment">// å¯¹è±¡ä¸€ç›´è¢«æ·»åŠ è¿›é›†åˆä¸­ï¼Œä½†æœªè¢«ç§»é™¤</span><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        MemoryLeakExample example = <span class="hljs-keyword">new</span> MemoryLeakExample();<br>        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>            example.addObject(<span class="hljs-keyword">new</span> Object());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="2-å†…å­˜æº¢å‡º-OutOfMemoryError"><a href="#2-å†…å­˜æº¢å‡º-OutOfMemoryError" class="headerlink" title="2. å†…å­˜æº¢å‡º (OutOfMemoryError)"></a>2. å†…å­˜æº¢å‡º (OutOfMemoryError)</h1><h2 id="1-å®šä¹‰ï¼š"><a href="#1-å®šä¹‰ï¼š" class="headerlink" title="1. å®šä¹‰ï¼š"></a>1. <strong>å®šä¹‰</strong>ï¼š</h2><p> å†…å­˜æº¢å‡ºæ˜¯æŒ‡ç¨‹åºåœ¨è¯·æ±‚å†…å­˜æ—¶ï¼Œå †å†…å­˜å·²æ»¡ä¸”åƒåœ¾æ”¶é›†å™¨æ— æ³•å›æ”¶æ›´å¤šçš„å†…å­˜ï¼Œä»è€Œå¯¼è‡´ JVM æŠ›å‡º <code>OutOfMemoryError</code> é”™è¯¯ã€‚</p><h2 id="2-ç—‡çŠ¶"><a href="#2-ç—‡çŠ¶" class="headerlink" title="2. ç—‡çŠ¶"></a>2. ç—‡çŠ¶</h2><ul><li><p>ç¨‹åºçªç„¶å´©æºƒå¹¶æŠ›å‡º <code>OutOfMemoryError</code>ã€‚</p></li><li><p>æ— æ³•å†åˆ†é…æ–°çš„å¯¹è±¡ã€‚</p></li></ul><h2 id="3-åŸå› ï¼š-1"><a href="#3-åŸå› ï¼š-1" class="headerlink" title="3. åŸå› ï¼š"></a>3. <strong>åŸå› </strong>ï¼š</h2><ul><li>åˆ›å»ºäº†è¿‡å¤šçš„å¤§å¯¹è±¡æˆ–é›†åˆã€‚</li><li>å†…å­˜æ³„æ¼å¯¼è‡´çš„å†…å­˜å ç”¨æŒç»­å¢åŠ ã€‚</li><li>JVM å †å†…å­˜è®¾ç½®ä¸è¶³ä»¥æ»¡è¶³åº”ç”¨çš„éœ€æ±‚ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OutOfMemoryErrorExample</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        List&lt;<span class="hljs-keyword">int</span>[]&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>            list.add(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1000000</span>]);  <span class="hljs-comment">// ä¸æ–­åˆ›å»ºå¤§æ•°ç»„ï¼Œå¯¼è‡´å†…å­˜è€—å°½</span><br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="3-åŒºåˆ«"><a href="#3-åŒºåˆ«" class="headerlink" title="3. åŒºåˆ«"></a>3. åŒºåˆ«</h1><p><strong>å†…å­˜æ³„æ¼</strong>ï¼š</p><ul><li>ç”±äºç¨‹åºé”™è¯¯ï¼Œå†…å­˜æœªè¢«æ­£ç¡®é‡Šæ”¾ã€‚</li><li>å†…å­˜ä½¿ç”¨é‡éšæ—¶é—´å¢åŠ ï¼Œæœ€ç»ˆå¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡ºã€‚</li><li>å¯ä»¥é€šè¿‡åˆ†æç¨‹åºé€»è¾‘å’Œä½¿ç”¨å·¥å…·ï¼ˆå¦‚ VisualVMã€MATï¼‰å®šä½æœªé‡Šæ”¾çš„å†…å­˜ã€‚</li></ul><p><strong>å†…å­˜æº¢å‡º</strong>ï¼š</p><ul><li>ç›´æ¥ç»“æœæ˜¯ JVM æ— æ³•åˆ†é…å†…å­˜ï¼ŒæŠ›å‡º <code>OutOfMemoryError</code>ã€‚</li><li>å¯èƒ½æ˜¯å†…å­˜æ³„æ¼çš„ç»“æœï¼Œä¹Ÿå¯èƒ½æ˜¯ç¨‹åºéœ€è¦çš„å†…å­˜è¶…è¿‡äº† JVM é…ç½®çš„æœ€å¤§å †å†…å­˜ã€‚</li><li>å¯ä»¥é€šè¿‡è°ƒæ•´ JVM å †å†…å­˜å¤§å°ï¼ˆå¦‚ <code>-Xmx</code> å‚æ•°ï¼‰å’Œä¼˜åŒ–ç¨‹åºå†…å­˜ä½¿ç”¨æ¥è§£å†³ã€‚</li></ul><h1 id="4-OOMç­‰å†…å­˜åˆ†æ"><a href="#4-OOMç­‰å†…å­˜åˆ†æ" class="headerlink" title="4 OOMç­‰å†…å­˜åˆ†æ"></a>4 OOMç­‰å†…å­˜åˆ†æ</h1><ul><li>æ–¹å¼ï¼š æ£€æŸ¥æ˜¯å¦æœ‰OutOfMemory ç­‰å†…å­˜å¼‚å¸¸ï¼Œ æ£€æŸ¥å“ªäº›å¯¹è±¡åœ¨ç³»ç»Ÿä¸­æ•°é‡æœ€å¤§ï¼Œé¿å…é¢‘ç¹ç”Ÿæˆæ–°å¯¹è±¡ï¼Œç±»ä¼¼å¤©æ°”é¢„æŠ¥ç³»ç»Ÿé‡Œæœ‰ä¸€ä¸ªåˆ†é¡µå±•ç¤ºï¼Œæ¯æ¬¡æ‰¹é‡å»æ“ä½œ5000ä¸ªå¯¹è±¡ï¼Œä¼šé¢‘ç¹è§¦å‘Minor GC å’Œ Full GCï¼Œåé¢è°ƒæˆ500ä¸ªï¼ŒåŸºæœ¬ä¸Šå°±æ²¡æœ‰Full GCäº†ã€‚</li><li>å·¥å…·ï¼šjmap â€dumpï¼Œç”ŸæˆJavaè™šæ‹Ÿæœºçš„å †è½¬å‚¨å¿«ç…§dumpæ–‡ä»¶ï¼Œç”¨jvisualvmå‘½ä»¤å·¥å…·å¯¼å…¥è¯¥dumpæ–‡ä»¶åˆ†æï¼Œæœ€å¤šçš„ç±»æ˜¯å“ªäº›</li><li>å‚è€ƒåœ°å€ï¼š<a href="https://pyr9.github.io/java%E5%91%BD%E4%BB%A4--jmap%E5%B7%A5%E5%85%B7/">javaå‘½ä»¤â€“jmapå·¥å…· - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></li></ul><h1 id="5-CPUåˆ†æï¼Œå“ªäº›æ–¹æ³•å ç”¨çš„å¤§é‡CPUæ—¶é—´"><a href="#5-CPUåˆ†æï¼Œå“ªäº›æ–¹æ³•å ç”¨çš„å¤§é‡CPUæ—¶é—´" class="headerlink" title="5 CPUåˆ†æï¼Œå“ªäº›æ–¹æ³•å ç”¨çš„å¤§é‡CPUæ—¶é—´"></a>5 CPUåˆ†æï¼Œå“ªäº›æ–¹æ³•å ç”¨çš„å¤§é‡CPUæ—¶é—´</h1><ul><li>æ–¹å¼ï¼š<ul><li>å‘½ä»¤top -p ï¼Œæ˜¾ç¤ºä½ çš„javaè¿›ç¨‹çš„å†…å­˜æƒ…å†µï¼Œæ‰¾åˆ°å½“å‰è¿›ç¨‹çš„PID</li><li>top -Hpï¼Œè·å–æ¯ä¸ªçº¿ç¨‹çš„å†…å­˜æƒ…å†µï¼Œè·å–CPUæ¯”è¾ƒé«˜çš„çº¿ç¨‹idï¼Œå¹¶ä¸“æˆ16è¿›åˆ¶</li><li>æ‰§è¡Œ <code>jstack PID|grep -A 10 4cd0</code>å¾—åˆ°çº¿ç¨‹å †æ ˆä¿¡æ¯ï¼Œæ‰¾å‡ºå¯èƒ½å­˜åœ¨é—®é¢˜çš„ä»£ç ï¼Œæ¯”å¦‚å¤§é‡è®¡ç®—ï¼Œæˆ–è€…å¾ªç¯new å¯¹è±¡</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>RabbitMQçš„æ¶ˆæ¯é›¶ä¸¢å¤±æ–¹æ¡ˆ</title>
    <link href="/RabbitMQ%E7%9A%84%E6%B6%88%E6%81%AF%E7%9A%84%E5%8F%AF%E9%9D%A0%E6%80%A7/"/>
    <url>/RabbitMQ%E7%9A%84%E6%B6%88%E6%81%AF%E7%9A%84%E5%8F%AF%E9%9D%A0%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<h1 id="RabbitMQå¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Ÿ"><a href="#RabbitMQå¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Ÿ" class="headerlink" title="RabbitMQå¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Ÿ"></a>RabbitMQå¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Ÿ</h1><h2 id="å“ªäº›ç¯èŠ‚ä¼šæœ‰ä¸¢æ¶ˆæ¯çš„å¯èƒ½ï¼Ÿ"><a href="#å“ªäº›ç¯èŠ‚ä¼šæœ‰ä¸¢æ¶ˆæ¯çš„å¯èƒ½ï¼Ÿ" class="headerlink" title="å“ªäº›ç¯èŠ‚ä¼šæœ‰ä¸¢æ¶ˆæ¯çš„å¯èƒ½ï¼Ÿ"></a>å“ªäº›ç¯èŠ‚ä¼šæœ‰ä¸¢æ¶ˆæ¯çš„å¯èƒ½ï¼Ÿ</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228233457541.png" alt="image-20230228233457541"></p><h3 id="æ™®é€šæ¶ˆæ¯å¤„ç†æµç¨‹"><a href="#æ™®é€šæ¶ˆæ¯å¤„ç†æµç¨‹" class="headerlink" title="æ™®é€šæ¶ˆæ¯å¤„ç†æµç¨‹"></a>æ™®é€šæ¶ˆæ¯å¤„ç†æµç¨‹</h3><ol><li>æ¶ˆæ¯ç”Ÿæˆè€…å‘é€æ¶ˆæ¯</li><li>MQæ”¶åˆ°æ¶ˆæ¯ï¼Œå°†æ¶ˆæ¯è¿›è¡Œå­˜å‚¨ï¼ˆæŒä¹…åŒ–åˆ°ç¡¬ç›˜ï¼‰ã€‚</li><li>è¿”å›ACKç»™ç”Ÿäº§è€…</li><li>MQ push æ¶ˆæ¯ç»™å¯¹åº”çš„æ¶ˆè´¹è€…ï¼Œç„¶åç­‰å¾…æ¶ˆè´¹è€…è¿”å›ACK</li><li>å¦‚æœæ¶ˆæ¯æ¶ˆè´¹è€…åœ¨æŒ‡å®šæ—¶é—´å†…æˆåŠŸè¿”å›ackï¼Œé‚£ä¹ˆMQè®¤ä¸ºæ¶ˆæ¯æ¶ˆè´¹æˆåŠŸï¼Œåœ¨å­˜å‚¨ä¸­åˆ é™¤æ¶ˆæ¯ï¼Œå³æ‰§è¡Œç¬¬6æ­¥ï¼›å¦‚æœMQåœ¨æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ACKï¼Œåˆ™è®¤ä¸ºæ¶ˆæ¯æ¶ˆè´¹å¤±è´¥ï¼Œä¼šå°è¯•é‡æ–°pushæ¶ˆæ¯,é‡å¤æ‰§è¡Œ4ã€5ã€6æ­¥éª¤</li><li>MQåˆ é™¤æ¶ˆæ¯</li></ol><h3 id="ä¸¢æ¶ˆæ¯çš„åœºæ™¯"><a href="#ä¸¢æ¶ˆæ¯çš„åœºæ™¯" class="headerlink" title="ä¸¢æ¶ˆæ¯çš„åœºæ™¯"></a>ä¸¢æ¶ˆæ¯çš„åœºæ™¯</h3><ul><li>1ï¼Œ2ï¼Œ4ä¸‰ä¸ªåœºæ™¯ï¼Œéƒ½æ˜¯è·¨ç½‘ç»œçš„ï¼Œè€Œè·¨ç½‘ç»œå°±è‚¯å®šä¼šæœ‰ä¸¢æ¶ˆæ¯çš„å¯èƒ½ã€‚</li><li>å…³äº3è¿™ä¸ªç¯èŠ‚ï¼Œé€šå¸¸MQå­˜ç›˜æ—¶éƒ½ä¼šå…ˆå†™å…¥æ“ä½œç³»ç»Ÿçš„ç¼“å­˜page cacheä¸­ï¼Œç„¶åå†ç”±æ“ä½œç³»ç»Ÿå¼‚æ­¥çš„å°†æ¶ˆæ¯å†™å…¥ç¡¬ç›˜ã€‚è¿™ä¸ªä¸­é—´æœ‰ä¸ªæ—¶é—´å·®ï¼Œå°±å¯èƒ½ä¼šé€ æˆæ¶ˆæ¯ä¸¢å¤±ã€‚å¦‚æœæœåŠ¡æŒ‚äº†ï¼Œç¼“å­˜ä¸­è¿˜æ²¡æœ‰æ¥å¾—åŠå†™å…¥ç¡¬ç›˜çš„æ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚è¿™ä¹Ÿæ˜¯ä»»ä½•ç”¨æˆ·æ€çš„åº”ç”¨ç¨‹åºæ— æ³•é¿å…çš„ã€‚</li><li>å¯¹äºä»»ä½•MQäº§å“ï¼Œéƒ½åº”è¯¥ä»è¿™å››ä¸ªæ–¹é¢æ¥è€ƒè™‘æ•°æ®çš„å®‰å…¨æ€§ã€‚é‚£æˆ‘ä»¬çœ‹çœ‹ç”¨RabbitMQæ—¶è¦å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</li></ul><h2 id="RabbitMQæ¶ˆæ¯é›¶ä¸¢å¤±æ–¹æ¡ˆ"><a href="#RabbitMQæ¶ˆæ¯é›¶ä¸¢å¤±æ–¹æ¡ˆ" class="headerlink" title="RabbitMQæ¶ˆæ¯é›¶ä¸¢å¤±æ–¹æ¡ˆ?"></a>RabbitMQæ¶ˆæ¯é›¶ä¸¢å¤±æ–¹æ¡ˆ?</h2><h3 id="1-ç”Ÿäº§è€…ä¿è¯æ¶ˆæ¯æ­£ç¡®å‘é€åˆ°RibbitMQ"><a href="#1-ç”Ÿäº§è€…ä¿è¯æ¶ˆæ¯æ­£ç¡®å‘é€åˆ°RibbitMQ" class="headerlink" title="1. ç”Ÿäº§è€…ä¿è¯æ¶ˆæ¯æ­£ç¡®å‘é€åˆ°RibbitMQ?"></a>1. ç”Ÿäº§è€…ä¿è¯æ¶ˆæ¯æ­£ç¡®å‘é€åˆ°RibbitMQ?</h3><ul><li><p><strong>æ–¹æ¡ˆä¸€ï¼š</strong>å¯ä»¥ä½¿ç”¨ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶ã€‚</p><p>é€šè¿‡å¤šæ¬¡ç¡®è®¤çš„æ–¹å¼ï¼Œä¿è¯ç”Ÿäº§è€…çš„æ¶ˆæ¯èƒ½å¤Ÿæ­£ç¡®çš„å‘é€åˆ°RabbitMQä¸­ã€‚RabbitMQçš„ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶åˆ†ä¸ºåŒæ­¥ç¡®è®¤å’Œå¼‚æ­¥ç¡®è®¤ã€‚</p><ul><li><p>åŒæ­¥ç¡®è®¤ä¸»è¦æ˜¯é€šè¿‡åœ¨ç”Ÿäº§è€…ç«¯ä½¿ç”¨Channel.waitForConfirmsOrDie()æŒ‡å®šä¸€ä¸ªç­‰å¾…ç¡®è®¤çš„å®Œæˆæ—¶é—´ã€‚</p></li><li><p>å¼‚æ­¥ç¡®è®¤æœºåˆ¶åˆ™æ˜¯é€šè¿‡åœ¨ç”Ÿäº§è€…ç«¯æ³¨å…¥ä¸¤ä¸ªå›è°ƒç¡®è®¤å‡½æ•°ã€‚ç¬¬ä¸€ä¸ªå‡½æ•°æ˜¯åœ¨ç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶è°ƒç”¨ï¼Œç¬¬äºŒä¸ªå‡½æ•°åˆ™æ˜¯ç”Ÿäº§è€…æ”¶åˆ°Brokerçš„æ¶ˆæ¯ç¡®è®¤è¯·æ±‚æ—¶è°ƒç”¨ã€‚ä¸¤ä¸ªå‡½æ•°éœ€è¦é€šè¿‡sequenceNumberè‡ªè¡Œå®Œæˆæ¶ˆæ¯çš„å‰åå¯¹åº”ã€‚sequenceNumberçš„ç”Ÿæˆæ–¹å¼éœ€è¦é€šè¿‡channelçš„åºåˆ—è·å–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">channel.addConfirmListener(ConfirmCallback var1,ConfirmCallback var2)<br></code></pre></td></tr></table></figure></li></ul></li><li><p><strong>æ–¹æ¡ˆäºŒï¼š</strong>æ‰‹åŠ¨äº‹åŠ¡</p><ul><li><p>æ‰‹åŠ¨äº‹åŠ¡æœºåˆ¶ä¸»è¦æœ‰å‡ ä¸ªå…³é”®çš„æ–¹æ³•ï¼š channel.txSelect() å¼€å¯äº‹åŠ¡ï¼›channel.txCommit() æäº¤äº‹åŠ¡ï¼› channel.txRollback() å›æ»šäº‹åŠ¡ã€‚ç”¨è¿™å‡ ä¸ªæ–¹æ³•æ¥è¿›è¡Œäº‹åŠ¡ç®¡ç†ã€‚æ¯”å¦‚åœ¨åˆ›å»ºè®¢å•åå¼€å¯äº‹åŠ¡ï¼Œå‡åº“å­˜æˆåŠŸåæäº¤äº‹åŠ¡ï¼Œå¤±è´¥æ—¶å›æ»šã€‚</p></li><li><p>è¿™ç§æ–¹å¼éœ€è¦æ‰‹åŠ¨æ§åˆ¶äº‹åŠ¡é€»è¾‘ï¼Œå¹¶ä¸”æ‰‹åŠ¨äº‹åŠ¡ä¼šå¯¹channeläº§ç”Ÿé˜»å¡ï¼Œé€ æˆååé‡ä¸‹é™</p></li></ul></li></ul><h3 id="2-RabbitMQ-ä¸»ä»æ¶ˆæ¯åŒæ­¥æ—¶ä¸ä¸¢æ¶ˆæ¯"><a href="#2-RabbitMQ-ä¸»ä»æ¶ˆæ¯åŒæ­¥æ—¶ä¸ä¸¢æ¶ˆæ¯" class="headerlink" title="2. RabbitMQ ä¸»ä»æ¶ˆæ¯åŒæ­¥æ—¶ä¸ä¸¢æ¶ˆæ¯?"></a>2. <strong>RabbitMQ ä¸»ä»æ¶ˆæ¯åŒæ­¥æ—¶ä¸ä¸¢æ¶ˆæ¯</strong>?</h3><ul><li>ä¸ä½¿ç”¨æ™®é€šé›†ç¾¤æ¨¡å¼ï¼Œ ä½¿ç”¨é•œåƒé›†ç¾¤æ¨¡å¼</li><li>ç»™åŒ…å«é‡è¦æ¶ˆæ¯çš„é˜Ÿåˆ—å»ºç«‹ä¸€ä¸ªè¿œç«¯å¤‡ä»½ã€‚</li></ul><blockquote><ul><li><p>æ™®é€šé›†ç¾¤æ¨¡å¼</p><ul><li><strong>queueçš„æ¶ˆæ¯</strong>ï¼Œåªä¼šæ”¾åœ¨<strong>ä¸€ä¸ªrabbtimqå®ä¾‹</strong>ä¸Šã€‚<strong>æ¯ä¸ªå®ä¾‹éƒ½åŒæ­¥queueçš„ç»“æ„å’Œqueueæ¶ˆæ¯çš„çœŸæ­£ä½ç½®</strong>ã€‚</li><li>æ¶ˆè´¹çš„æ—¶å€™ï¼Œå®é™…ä¸Šå¦‚æœè¿æ¥åˆ°äº†å¦å¤–ä¸€ä¸ªå®ä¾‹ï¼Œé‚£ä¹ˆé‚£ä¸ªå®ä¾‹ä¼šä»queueæ‰€åœ¨å®ä¾‹ä¸Šæ‹‰å–æ•°æ®è¿‡æ¥ã€‚</li><li>è¿™ç§é›†ç¾¤æ¨¡å¼çš„æ¶ˆæ¯å¯é æ€§ä¸æ˜¯å¾ˆé«˜ã€‚å› ä¸ºå¦‚æœå…¶ä¸­æœ‰ä¸ªèŠ‚ç‚¹æœåŠ¡å®•æœºäº†ï¼Œé‚£è¿™ä¸ªèŠ‚ç‚¹ä¸Šçš„æ•°æ®å°±æ— æ³•æ¶ˆè´¹äº†ï¼Œéœ€è¦ç­‰åˆ°è¿™ä¸ªèŠ‚ç‚¹æœåŠ¡æ¢å¤åæ‰èƒ½æ¶ˆè´¹ã€‚</li></ul></li><li><p>é•œåƒé›†ç¾¤æ¨¡å¼</p><ul><li><p>è¿™ç§æ¨¡å¼æ˜¯åœ¨æ™®é€šé›†ç¾¤æ¨¡å¼åŸºç¡€ä¸Šçš„ä¸€ç§å¢å¼ºæ–¹æ¡ˆï¼Œè¿™ä¹Ÿå°±æ˜¯RabbitMQçš„å®˜æ–¹HAé«˜å¯ç”¨æ–¹æ¡ˆã€‚</p></li><li><p>è¿™ç§æ¨¡å¼ä¼šåœ¨é•œåƒèŠ‚ç‚¹ä¸­é—´ä¸»åŠ¨è¿›è¡Œæ¶ˆæ¯åŒæ­¥ï¼Œè€Œä¸æ˜¯åœ¨å®¢æˆ·ç«¯æ‹‰å–æ¶ˆæ¯æ—¶ä¸´æ—¶åŒæ­¥ã€‚è¿™ç§æ¨¡å¼çš„æ¶ˆæ¯å¯é æ€§æ›´é«˜ï¼Œå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½å­˜ç€å…¨é‡çš„æ¶ˆæ¯ã€‚</p></li><li><p>ä»–çš„å¼Šç«¯ä¹Ÿæ˜¯æ˜æ˜¾çš„ï¼Œé›†ç¾¤å†…éƒ¨çš„ç½‘ç»œå¸¦å®½ä¼šè¢«è¿™ç§åŒæ­¥é€šè®¯å¤§é‡çš„æ¶ˆè€—ï¼Œè¿›è€Œé™ä½æ•´ä¸ªé›†ç¾¤çš„æ€§èƒ½ã€‚è¿™ç§æ¨¡å¼ä¸‹ï¼Œé˜Ÿåˆ—æ•°é‡æœ€å¥½ä¸è¦è¿‡å¤šã€‚</p></li></ul></li></ul></blockquote><h3 id="3-RabbitMQæ¶ˆæ¯å­˜ç›˜ä¸ä¸¢æ¶ˆæ¯"><a href="#3-RabbitMQæ¶ˆæ¯å­˜ç›˜ä¸ä¸¢æ¶ˆæ¯" class="headerlink" title="3. RabbitMQæ¶ˆæ¯å­˜ç›˜ä¸ä¸¢æ¶ˆæ¯?"></a>3. RabbitMQæ¶ˆæ¯å­˜ç›˜ä¸ä¸¢æ¶ˆæ¯?</h3><p>å¯¹äºClassicç»å…¸é˜Ÿåˆ—ï¼Œç›´æ¥å°†é˜Ÿåˆ—å£°æ˜æˆä¸ºæŒä¹…åŒ–é˜Ÿåˆ—å³å¯ã€‚</p><p>è€Œæ–°å¢çš„Quorumï¼ˆ[ËˆkwÉ”rÉ™m] ä»²è£ï¼‰é˜Ÿåˆ—å’ŒStreamé˜Ÿåˆ—ï¼Œéƒ½æ˜¯æ˜æ˜¾çš„æŒä¹…åŒ–é˜Ÿåˆ—ï¼Œèƒ½æ›´å¥½çš„ä¿è¯æœåŠ¡ç«¯æ¶ˆæ¯ä¸ä¼šä¸¢å¤±ã€‚</p><blockquote><p>Quorumé˜Ÿåˆ—å®ç°äº†æŒä¹…åŒ–ï¼Œå¤šå¤‡ä»½çš„FIFOé˜Ÿåˆ—ï¼Œä¸»è¦å°±æ˜¯é’ˆå¯¹RabbitMQçš„é•œåƒæ¨¡å¼è®¾è®¡çš„ã€‚å¤§éƒ¨åˆ†åŠŸèƒ½éƒ½æ˜¯åœ¨Classicé˜Ÿåˆ—åŸºç¡€ä¸Šåšå‡æ³•ï¼Œæ¯”å¦‚ä¸æ”¯æŒæ˜¯éæŒä¹…åŒ–çš„å†…å­˜é˜Ÿåˆ—ã€‚æŸäº›åŠŸèƒ½ï¼ˆä¾‹å¦‚æœ‰å®³æ¶ˆæ¯å¤„ç†ï¼‰æ˜¯ç‰¹å®šäºä»²è£é˜Ÿåˆ—çš„ã€‚</p><p>Streamé˜Ÿåˆ—æ˜¯RabbitMQè‡ª3.9.0ç‰ˆæœ¬å¼€å§‹å¼•å…¥çš„ä¸€ç§æ–°çš„æ•°æ®é˜Ÿåˆ—ç±»å‹ï¼Œæ›´é€‚åˆäºæ¶ˆè´¹è€…å¤šï¼Œè¯»æ¶ˆæ¯éå¸¸é¢‘ç¹çš„åœºæ™¯ã€‚</p></blockquote><blockquote><p>æ¯’æ¶ˆæ¯æ˜¯æŒ‡æ¶ˆæ¯ä¸€ç›´ä¸èƒ½è¢«æ¶ˆè´¹è€…æ­£å¸¸æ¶ˆè´¹(å¯èƒ½æ˜¯ç”±äºæ¶ˆè´¹è€…å¤±è´¥æˆ–è€…æ¶ˆè´¹é€»è¾‘æœ‰é—®é¢˜ç­‰)ï¼Œå°±ä¼šå¯¼è‡´æ¶ˆæ¯ä¸æ–­çš„é‡æ–°å…¥é˜Ÿï¼Œè¿™æ ·è¿™äº›æ¶ˆæ¯å°±æˆä¸ºäº†æ¯’æ¶ˆæ¯ã€‚è¿™äº›è¯»æ¶ˆæ¯åº”è¯¥æœ‰ä¿éšœæœºåˆ¶è¿›è¡Œæ ‡è®°å¹¶åŠæ—¶åˆ é™¤ã€‚Quorumé˜Ÿåˆ—ä¼šæŒç»­è·Ÿè¸ªæ¶ˆæ¯çš„å¤±è´¥æŠ•é€’å°è¯•æ¬¡æ•°ï¼Œå¹¶è®°å½•åœ¨â€x-delivery-countâ€è¿™æ ·ä¸€ä¸ªå¤´éƒ¨å‚æ•°ä¸­ã€‚ç„¶åï¼Œå°±å¯ä»¥é€šè¿‡è®¾ç½® Delivery limitå‚æ•°æ¥å®šåˆ¶ä¸€ä¸ªæ¯’æ¶ˆæ¯çš„åˆ é™¤ç­–ç•¥ã€‚å½“æ¶ˆæ¯çš„é‡å¤æŠ•é€’æ¬¡æ•°è¶…è¿‡äº†Delivery limitå‚æ•°é˜ˆå€¼æ—¶ï¼ŒRabbitMQå°±ä¼šåˆ é™¤è¿™äº›æ¯’æ¶ˆæ¯ã€‚å½“ç„¶ï¼Œå¦‚æœé…ç½®äº†æ­»ä¿¡é˜Ÿåˆ—çš„è¯ï¼Œå°±ä¼šè¿›å…¥å¯¹åº”çš„æ­»ä¿¡é˜Ÿåˆ—ã€‚</p></blockquote><h3 id="4-RabbitMQæ¶ˆè´¹è€…ä¸ä¸¢å¤±æ¶ˆæ¯"><a href="#4-RabbitMQæ¶ˆè´¹è€…ä¸ä¸¢å¤±æ¶ˆæ¯" class="headerlink" title="4. RabbitMQæ¶ˆè´¹è€…ä¸ä¸¢å¤±æ¶ˆæ¯?"></a>4. <strong>RabbitMQæ¶ˆè´¹è€…ä¸ä¸¢å¤±æ¶ˆæ¯</strong>?</h3><ul><li><p>RabbitMQåœ¨æ¶ˆè´¹æ¶ˆæ¯æ—¶å¯ä»¥æŒ‡å®šæ˜¯è‡ªåŠ¨åº”ç­”ï¼Œè¿˜æ˜¯æ‰‹åŠ¨åº”ç­”ã€‚å°†RabbitMQçš„åº”ç­”æ¨¡å¼è®¾å®šä¸ºæ‰‹åŠ¨åº”ç­”å¯ä»¥æé«˜æ¶ˆæ¯æ¶ˆè´¹çš„å¯é æ€§ã€‚</p></li><li><p>è®¾ç½®äº†æ‰‹åŠ¨ç¡®è®¤ï¼Œåˆ™éœ€è¦åœ¨ä¸šåŠ¡å¤„ç†æˆæˆåŠŸåï¼Œæ‰‹åŠ¨è°ƒç”¨<code>channer.basicAck()</code>,å¦‚æœå‡ºç°å¼‚å¸¸åˆ™è°ƒç”¨<code>channer.basicNAck()</code>,è®¾ç½®æ¶ˆæ¯æ˜¯é‡æ–°è¿”å›é˜Ÿåˆ—ï¼Œè¿˜æ˜¯ç›´æ¥ä¸¢æ‰ã€‚</p></li></ul><p><strong>æœ€åï¼Œä»»ä½•ç”¨æˆ·æ€çš„åº”ç”¨ç¨‹åºéƒ½æ— æ³•ä¿è¯ç»å¯¹çš„æ•°æ®å®‰å…¨ï¼Œæ‰€ä»¥ï¼Œå¤‡ä»½ä¸æ¢å¤çš„æ–¹æ¡ˆä¹Ÿéœ€è¦è€ƒè™‘åˆ°ã€‚</strong></p><h2 id="Consumer-Ack-æ¶ˆè´¹ç«¯æ”¶åˆ°æ¶ˆæ¯åçš„ç¡®è®¤æ–¹å¼"><a href="#Consumer-Ack-æ¶ˆè´¹ç«¯æ”¶åˆ°æ¶ˆæ¯åçš„ç¡®è®¤æ–¹å¼" class="headerlink" title="Consumer Ack æ¶ˆè´¹ç«¯æ”¶åˆ°æ¶ˆæ¯åçš„ç¡®è®¤æ–¹å¼"></a>Consumer Ack æ¶ˆè´¹ç«¯æ”¶åˆ°æ¶ˆæ¯åçš„ç¡®è®¤æ–¹å¼</h2><ol><li><p>æœ‰ä¸‰ç§ç¡®è®¤æ–¹å¼</p><ul><li>è‡ªåŠ¨ç¡®è®¤ acknowledge &#x3D; â€œnoneâ€ã€‚ æ¶ˆæ¯ä¸€æ—¦åˆ°è¾¾consumerå°±ä¼šè¢«ç¡®è®¤ï¼Œå¹¶å°†å¯¹åº”çš„message ä»æ¶ˆæ¯ç¼“å­˜ä¸­ç§»é™¤ï¼Œå®é™…åœºæ™¯ä¸­ï¼Œå¾ˆå¯èƒ½æ¶ˆæ¯è¢«æ”¶åˆ°ï¼Œä½†æ˜¯å¤„ç†ä¸šåŠ¡æ—¶å¼‚å¸¸ï¼Œè¿™ç§ç¡®è®¤æœºåˆ¶ä¸‹ï¼Œæ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚</li><li>æ‰‹åŠ¨ç¡®è®¤acknowledge &#x3D; â€œmanualâ€ã€‚è®¾ç½®äº†æ‰‹åŠ¨ç¡®è®¤ï¼Œåˆ™éœ€è¦åœ¨ä¸šåŠ¡å¤„ç†æˆæˆåŠŸåï¼Œæ‰‹åŠ¨è°ƒç”¨<code>channer.basicAck()</code>,å¦‚æœå‡ºç°å¼‚å¸¸åˆ™è°ƒç”¨<code>channer.basicNAck()</code>,è®¾ç½®æ¶ˆæ¯æ˜¯é‡æ–°è¿”å›é˜Ÿåˆ—ï¼Œè¿˜æ˜¯ç›´æ¥ä¸¢æ‰ã€‚</li><li>æ ¹æ®å¼‚å¸¸æƒ…å†µç¡®è®¤ acknowledge &#x3D; â€œautoâ€</li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>RabbitMQ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MQ</tag>
      
      <tag>æ¶ˆæ¯å¯é æ€§</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>FullGC</title>
    <link href="/FullGC/"/>
    <url>/FullGC/</url>
    
    <content type="html"><![CDATA[<h1 id="1-FullGC-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-FullGC-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. FullGC æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. FullGC æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>Full GCï¼ˆFull Garbage Collectionï¼Œå…¨åƒåœ¾æ”¶é›†ï¼‰æ˜¯ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰æ‰§è¡Œçš„ä¸€ç§åƒåœ¾æ”¶é›†è¿‡ç¨‹ï¼Œå®ƒä¼šå¯¹æ•´ä¸ªå †å†…å­˜è¿›è¡Œåƒåœ¾æ”¶é›†ï¼ŒåŒ…æ‹¬å¹´è½»ä»£ï¼ˆYoung Generationï¼‰å’Œè€å¹´ä»£ï¼ˆOld Generationï¼‰ï¼Œä»¥åŠæ°¸ä¹…ä»£ï¼ˆPermGenï¼‰æˆ–å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰ã€‚</p><ul><li><strong>Minor GC</strong>ï¼šä»…é’ˆå¯¹å¹´è½»ä»£ï¼ˆEden å’Œ Survivor ç©ºé—´ï¼‰è¿›è¡Œåƒåœ¾æ”¶é›†ã€‚</li><li><strong>Major GC</strong>ï¼šä¸»è¦é’ˆå¯¹è€å¹´ä»£è¿›è¡Œåƒåœ¾æ”¶é›†ï¼Œæœ‰æ—¶ä¹Ÿè¢«ç§°ä¸º Old GCã€‚</li><li><strong>Full GC</strong>ï¼šé’ˆå¯¹æ•´ä¸ªå †å†…å­˜ï¼ˆåŒ…æ‹¬å¹´è½»ä»£ã€è€å¹´ä»£å’Œå…ƒç©ºé—´ï¼‰è¿›è¡Œåƒåœ¾æ”¶é›†ã€‚</li></ul><p>ç”±äº Full GC å¯¹åº”ç”¨æ€§èƒ½å½±å“è¾ƒå¤§ï¼Œé€šå¸¸å»ºè®®åœ¨è°ƒä¼˜ JVM æ€§èƒ½æ—¶ï¼Œå°½é‡å‡å°‘ Full GC çš„å‘ç”Ÿé¢‘ç‡ï¼Œé€šè¿‡é€‚å½“çš„å‚æ•°è°ƒæ•´å’Œåƒåœ¾æ”¶é›†å™¨çš„é€‰æ‹©æ¥ä¼˜åŒ–å†…å­˜ç®¡ç†ã€‚</p><h1 id="2-è§¦å‘æ¡ä»¶"><a href="#2-è§¦å‘æ¡ä»¶" class="headerlink" title="2. è§¦å‘æ¡ä»¶"></a>2. <strong>è§¦å‘æ¡ä»¶</strong></h1><h3 id="1-è°ƒç”¨System-gc-æ–¹æ³•"><a href="#1-è°ƒç”¨System-gc-æ–¹æ³•" class="headerlink" title="1. è°ƒç”¨System.gc()æ–¹æ³•"></a>1. è°ƒç”¨System.gc()æ–¹æ³•</h3><ul><li>æ­¤æ–¹æ³•çš„è°ƒç”¨æ˜¯å»ºè®®JVMè¿›è¡ŒFull GC,è™½ç„¶åªæ˜¯å»ºè®®è€Œéä¸€å®š,ä½†å¾ˆå¤šæƒ…å†µä¸‹å®ƒä¼šè§¦å‘ Full GC,ä»è€Œå¢åŠ Full GCçš„é¢‘ç‡</li><li><strong>è°ƒä¼˜å»ºè®®</strong>ï¼šèƒ½ä¸ä½¿ç”¨æ­¤æ–¹æ³•å°±åˆ«ä½¿ç”¨ï¼Œè®©è™šæ‹Ÿæœºè‡ªå·±å»ç®¡ç†å®ƒçš„å†…å­˜</li></ul><h3 id="2-æ–¹æ³•åŒºç©ºé—´ä¸è¶³"><a href="#2-æ–¹æ³•åŒºç©ºé—´ä¸è¶³" class="headerlink" title="2. æ–¹æ³•åŒºç©ºé—´ä¸è¶³"></a>2. æ–¹æ³•åŒºç©ºé—´ä¸è¶³</h3><ul><li>æ–¹æ³•åŒºå­˜æ”¾çš„ä¸ºä¸€äº›classçš„ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰æ•°æ®ï¼Œå½“ç³»ç»Ÿä¸­è¦åŠ è½½çš„ç±»ã€åå°„çš„ç±»å’Œè°ƒç”¨çš„æ–¹æ³•è¾ƒå¤šæ—¶ï¼Œæ–¹æ³•åŒºå¯èƒ½ä¼šè¢«å æ»¡ï¼Œä»è€Œæ‰§è¡ŒFull GCã€‚</li><li>å…ƒç©ºé—´çš„åˆå§‹é˜ˆå€¼è®¾ç½®å¤ªå°ï¼Œåƒåœ¾æ”¶é›†å™¨è°ƒæ•´å…ƒç©ºé—´çš„å¤§å°éœ€è¦Full GCã€‚æ¯”å¦‚åˆå§‹å€¼æ˜¯21Mï¼Œfull gcåï¼Œé‡Šæ”¾äº†20Mï¼Œåªå‰©1Mï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±ä¼šå°†è¯¥å€¼è°ƒæˆ2Mï¼›ç›¸åï¼Œå¦‚æœé‡Šæ”¾äº†1Mï¼Œè¿˜å‰©20Mï¼Œä¸‹æ¬¡å°±ä¼šè°ƒæ•´åˆ°40Mï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šå¤šæ¬¡è§¦å‘full GC.</li><li>ä¸€èˆ¬å»ºè®®åœ¨JVMå‚æ•°ä¸­å°†MetaspaceSizeå’ŒMaxMetaspaceSizeè®¾ç½®æˆä¸€æ ·çš„å€¼ï¼Œå¹¶è®¾ç½®å¾—æ¯”åˆå§‹å€¼è¦å¤§ã€‚</li><li><strong>è°ƒä¼˜å»ºè®®ï¼š</strong>å¯¹äº8Gç‰©ç†å†…å­˜çš„æœºå™¨æ¥è¯´ï¼Œä¸€èˆ¬æˆ‘ä¼šå°†è¿™ä¸¤ä¸ªå€¼éƒ½è®¾ç½®ä¸º256Mã€‚å¸¸è§çš„é—®é¢˜ï¼šé¡¹ç›®jaråŒ…åªæœ‰1Gï¼Œä½†æ˜¯å¯åŠ¨äº†å¥½ä¹…ï¼Œå°±å¯èƒ½æ˜¯å› ä¸ºç”±äºå…ƒç©ºé—´è®¾ç½®çš„å¤ªå°ï¼Œä¸€ç›´åœ¨è§¦å‘full GCã€‚</li></ul><h3 id="3-Minor-GC-ä¹‹åä»ç„¶æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å®¹çº³æ–°çš„å¯¹è±¡æ—¶ã€‚"><a href="#3-Minor-GC-ä¹‹åä»ç„¶æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å®¹çº³æ–°çš„å¯¹è±¡æ—¶ã€‚" class="headerlink" title="3. Minor GC ä¹‹åä»ç„¶æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å®¹çº³æ–°çš„å¯¹è±¡æ—¶ã€‚"></a>3. Minor GC ä¹‹åä»ç„¶æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å®¹çº³æ–°çš„å¯¹è±¡æ—¶ã€‚</h3><h3 id="4-å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰è¾¾åˆ°æŒ‡å®šçš„æœ€å¤§å€¼æ—¶ã€‚"><a href="#4-å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰è¾¾åˆ°æŒ‡å®šçš„æœ€å¤§å€¼æ—¶ã€‚" class="headerlink" title="4. å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰è¾¾åˆ°æŒ‡å®šçš„æœ€å¤§å€¼æ—¶ã€‚"></a>4. å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰è¾¾åˆ°æŒ‡å®šçš„æœ€å¤§å€¼æ—¶ã€‚</h3><h3 id="3-è€å¹´ä»£ç©ºé—´ä¸è¶³"><a href="#3-è€å¹´ä»£ç©ºé—´ä¸è¶³" class="headerlink" title="3. è€å¹´ä»£ç©ºé—´ä¸è¶³"></a>3. è€å¹´ä»£ç©ºé—´ä¸è¶³</h3><p><strong>å¯¹è±¡è½¬å…¥è€å¹´ä»£çš„åœºæ™¯æœ‰ï¼š</strong></p><ul><li><p>å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼šä¸ºäº†é¿å…ä¸ºå¤§å¯¹è±¡GCæ—¶ï¼Œå¤šæ¬¡åœ¨survivorä¸Šæ¥å›å¤åˆ¶è€Œé™ä½æ•ˆç‡ã€‚</p><ul><li><strong>è°ƒä¼˜å»ºè®®ï¼š</strong><ul><li>å°½é‡é¿å…å†™å¤§å¯¹è±¡ï¼Œ</li><li>ç»“åˆä½ è‡ªå·±ç³»ç»Ÿçœ‹ä¸‹æœ‰æ²¡æœ‰ä»€ä¹ˆå¤§å¯¹è±¡ ç”Ÿæˆï¼Œé¢„ä¼°ä¸‹å¤§å¯¹è±¡çš„å¤§å°ï¼Œè®¾ç½®XX:PretenureSizeThresholdçš„å€¼ï¼Œä¸€èˆ¬æ¥è¯´è®¾ç½®ä¸º1Må°±å·®ä¸å¤šäº†ï¼Œå¾ˆå°‘æœ‰è¶…è¿‡1Mçš„å¤§å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡ä¸€èˆ¬å°±æ˜¯ä½ ç³»ç»Ÿåˆå§‹ åŒ–åˆ†é…çš„ç¼“å­˜å¯¹è±¡ï¼Œæ¯”å¦‚å¤§çš„ç¼“å­˜Listï¼ŒMapä¹‹ç±»çš„å¯¹è±¡ã€‚</li></ul></li></ul></li><li><p>é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ï¼šé»˜è®¤æ˜¯ç»å†äº†15æ¬¡minor GC ï¼ŒCMSæ˜¯6æ¬¡ã€‚</p><ul><li><strong>è°ƒä¼˜å»ºè®®ï¼š</strong><ul><li>è°ƒæ•´Edenå’Œsurvivorçš„æ¯”ä¾‹ï¼Œé»˜è®¤æ—¶8:1:1ï¼Œé¿å…EdenåŒºåŸŸè¿‡å°ï¼Œå¯¼è‡´é¢‘ç¹minor GCï¼Œå¢å¤§ç³»ç»Ÿæ¶ˆè€—</li><li>å¦‚æœæˆ‘ä»¬å¯ä»¥ç¡®å®šå¤§å¤šæ•°å¯¹è±¡éƒ½æ˜¯å¾ˆå¿«ä¼šè¢«å›æ”¶çš„ï¼Œå¯ä»¥å°†è¯¥å€¼è°ƒå°ï¼Œæ¯”å¦‚å¤§å¤šæ•°å¯¹è±¡éƒ½æ˜¯3æ¬¡å·¦å³å°±å¯ä»¥è¢«å›æ”¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®æˆ5ï¼Œå¦‚æœè¶…è¿‡äº†5ï¼Œå°±è¯´æ˜å‰©ä¸‹çš„åº”è¯¥æ˜¯ä¸€äº›ç±»ä¼¼java bean è¿™ç§ï¼Œä¼šé•¿æœŸå­˜æ´»çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å°±æ²¡å¿…è¦ï¼Œè®©ä»–å†å¾…åœ¨survivorå ç”¨ç©ºé—´äº†ï¼Œæå‰è®©ä»–ä»¬è¿›å…¥è€å¹´ä»£ã€‚</li></ul></li></ul></li><li><p><strong>å¯¹è±¡åŠ¨æ€å¹´é¾„åˆ¤æ–­</strong>ï¼šsurvivoråŒºåŸŸé‡Œï¼Œå¯¹è±¡å¹´é¾„ä»å°åˆ°å¤§æ’åºï¼Œå½“ç´¯åŠ åˆ°æŸä¸ªå¹´é¾„æ—¶ï¼Œå ç”¨ survivoråŒºåŸŸ çš„50%ï¼Œå°±ä¼šæŠŠè¿™ä¸ªå¹´é¾„å¤§çš„å¯¹è±¡éƒ½æ™‹å‡åˆ°è€å¹´ä»£ã€‚ å¦‚æœç³»ç»Ÿä¸­æœç”Ÿå¤•æ­»çš„å¯¹è±¡æ¯”è¾ƒå¤šï¼Œ</p><ul><li><strong>è°ƒä¼˜å»ºè®®ï¼š</strong><ul><li>å¦‚æœç³»ç»Ÿä¸­æœç”Ÿå¤•æ­»çš„å¯¹è±¡æ¯”è¾ƒå¤šï¼Œå¯ä»¥è€ƒè™‘å°†å¹´è½»ä»£å‚æ•°è°ƒå¤§ä¸€äº›ï¼Œè¿™æ ·å¯¹åº”survivoråŒºåŸŸå°±ä¼šå¯¹åº”å˜å¤§ï¼Œå‡å°‘å¯¹è±¡å› ä¸ºè§¦å‘äº†è¿™ä¸ªæœºåˆ¶ï¼Œè¿›å…¥åˆ°è€å¹´ä»£ï¼Œä»è€Œè§¦å‘Full GCã€‚ä¸€èˆ¬æƒ…å†µï¼Œæ–°ç”Ÿä»£é»˜è®¤æ˜¯å †å¤§å°çš„1&#x2F;3</li><li>é¿å…Survivorè®¾ç½®è¿‡å°ï¼Œå¯¼è‡´å¯¹è±¡ä» eden ç›´æ¥åˆ°è¾¾è€å¹´ä»£ï¼Œä»è€Œè§¦å‘Full GC</li></ul></li></ul></li><li><p>è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿æœºåˆ¶ã€‚ </p><p>åœ¨å‘ç”Ÿ Minor GC ä¹‹å‰ï¼Œè™šæ‹Ÿæœºå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ã€‚</p><ul><li>å¤§äº -&gt; minor GC</li><li>å°äº -&gt;æŸ¥çœ‹æ˜¯å¦å¼€å¯äº†ç©ºé—´æ‹…ä¿æœºåˆ¶<ul><li>æ²¡å¼€å¯å°±ç›´æ¥è§¦å‘full GCï¼Œ</li><li>å¼€å¯äº†ï¼Œå°±ä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œå¦‚æœå¤§äºï¼Œå°†å°è¯•ç€è¿›è¡Œä¸€æ¬¡ Minor GCï¼›å¦‚æœå°äºï¼Œä¼šè§¦å‘full gcã€‚</li></ul></li></ul></li></ul><h1 id="3-ä¼˜åŒ–å’Œè°ƒæ•´"><a href="#3-ä¼˜åŒ–å’Œè°ƒæ•´" class="headerlink" title="3. ä¼˜åŒ–å’Œè°ƒæ•´"></a>3. ä¼˜åŒ–å’Œè°ƒæ•´</h1><p>è¿‡äºé¢‘ç¹çš„ Full GC å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤éœ€è¦é€šè¿‡è°ƒæ•´å †å†…å­˜çš„å¤§å°ã€åƒåœ¾æ”¶é›†å™¨çš„é€‰æ‹©ä»¥åŠå…¶ä»– JVM å‚æ•°ï¼ˆå¦‚ <code>-XX:MaxMetaspaceSize</code>ã€<code>-Xms</code>ã€<code>-Xmx</code> ç­‰ï¼‰æ¥ä¼˜åŒ–å’Œå‡å°‘ Full GC çš„å‘ç”Ÿé¢‘ç‡ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ“ä½œç³»ç»ŸOOM Killer</title>
    <link href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9FOOM-Killer/"/>
    <url>/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9FOOM-Killer/</url>
    
    <content type="html"><![CDATA[<h1 id="1-OOM-Killer-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-OOM-Killer-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. OOM Killer æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. OOM Killer æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>OOM Killerï¼ˆOut of Memory Killerï¼‰æ˜¯ Linux æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­çš„ä¸€ä¸ªæœºåˆ¶ï¼Œç”¨äºåœ¨ç³»ç»Ÿå†…å­˜è€—å°½æ—¶ï¼Œé€šè¿‡ç»ˆæ­¢è¿›ç¨‹æ¥é‡Šæ”¾å†…å­˜èµ„æºï¼Œä»è€Œé˜²æ­¢ç³»ç»Ÿå´©æºƒæˆ–æ— æ³•å“åº”ã€‚</p><h2 id="2-OOM-Killer-çš„è§¦å‘æ¡ä»¶"><a href="#2-OOM-Killer-çš„è§¦å‘æ¡ä»¶" class="headerlink" title="2. OOM Killer çš„è§¦å‘æ¡ä»¶"></a>2. OOM Killer çš„è§¦å‘æ¡ä»¶</h2><p>å½“ç³»ç»Ÿçš„ç‰©ç†å†…å­˜å’Œäº¤æ¢ç©ºé—´ï¼ˆswapï¼‰éƒ½è¢«å®Œå…¨å ç”¨ï¼Œä¸”å†…æ ¸æ— æ³•å†åˆ†é…å†…å­˜æ—¶ï¼Œå°±ä¼šè§¦å‘ OOMï¼ˆOut of Memoryï¼‰çŠ¶æ€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿå¿…é¡»é‡Šæ”¾ä¸€äº›å†…å­˜ï¼Œå¦åˆ™æ•´ä¸ªç³»ç»Ÿå°†æ— æ³•ç»§ç»­è¿è¡Œã€‚</p><h1 id="3-OOM-Killer-çš„åŠŸèƒ½"><a href="#3-OOM-Killer-çš„åŠŸèƒ½" class="headerlink" title="3 OOM Killer çš„åŠŸèƒ½"></a>3 OOM Killer çš„åŠŸèƒ½</h1><p>OOM Killer çš„ä¸»è¦åŠŸèƒ½æ˜¯åœ¨ç³»ç»Ÿå†…å­˜è€—å°½æ—¶ï¼Œé€šè¿‡ç»ˆæ­¢æŸäº›è¿›ç¨‹æ¥é‡Šæ”¾å†…å­˜ã€‚è¿™æ˜¯ä¸€ä¸ªæœ€åçš„æ‰‹æ®µï¼Œç›®çš„æ˜¯ä¿è¯ç³»ç»Ÿçš„åŸºæœ¬åŠŸèƒ½å’Œå“åº”èƒ½åŠ›ã€‚</p><h1 id="4-OOM-Killer-çš„é€‰æ‹©æœºåˆ¶"><a href="#4-OOM-Killer-çš„é€‰æ‹©æœºåˆ¶" class="headerlink" title="4. OOM Killer çš„é€‰æ‹©æœºåˆ¶"></a>4. OOM Killer çš„é€‰æ‹©æœºåˆ¶</h1><p>OOM Killer é€‰æ‹©è¿›ç¨‹æ—¶ï¼Œä¼šæ ¹æ®ä¸€ä¸ªè¯„åˆ†ç³»ç»Ÿæ¥å†³å®šç»ˆæ­¢å“ªä¸ªè¿›ç¨‹ã€‚è¯„åˆ†è¶Šé«˜çš„è¿›ç¨‹ï¼Œè¢«ç»ˆæ­¢çš„å¯èƒ½æ€§è¶Šå¤§ã€‚è¯„åˆ†ä¸»è¦åŸºäºä»¥ä¸‹å‡ ä¸ªå› ç´ ï¼š</p><p><strong>è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜é‡</strong>ï¼šä½¿ç”¨å†…å­˜è¶Šå¤šçš„è¿›ç¨‹ï¼Œè¯„åˆ†è¶Šé«˜ã€‚</p><p><strong>è¿›ç¨‹çš„é‡è¦æ€§</strong>ï¼šç³»ç»Ÿå…³é”®è¿›ç¨‹å’Œä½ä¼˜å…ˆçº§è¿›ç¨‹çš„è¯„åˆ†ä¼šæœ‰æ‰€ä¸åŒã€‚é‡è¦çš„ç³»ç»Ÿè¿›ç¨‹ä¸€èˆ¬æœ‰è¾ƒä½çš„è¯„åˆ†ã€‚</p><p><strong>è¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼ˆOOMè°ƒæ•´å€¼ï¼‰</strong>ï¼šå¯ä»¥æ‰‹åŠ¨è®¾ç½®è¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Œè°ƒæ•´å®ƒåœ¨ OOM Killer çœ¼ä¸­çš„é‡è¦æ€§ã€‚</p><h1 id="5-4-OOM-Killer-çš„æ—¥å¿—ä¿¡æ¯"><a href="#5-4-OOM-Killer-çš„æ—¥å¿—ä¿¡æ¯" class="headerlink" title="5. 4. OOM Killer çš„æ—¥å¿—ä¿¡æ¯"></a>5. 4. OOM Killer çš„æ—¥å¿—ä¿¡æ¯</h1><p>å½“ OOM Killer ç»ˆæ­¢ä¸€ä¸ªè¿›ç¨‹æ—¶ï¼Œä¼šåœ¨ç³»ç»Ÿæ—¥å¿—ï¼ˆé€šå¸¸æ˜¯ <code>/var/log/syslog</code> æˆ– <code>/var/log/messages</code>ï¼‰ä¸­è®°å½•ä¸€æ¡ä¿¡æ¯ï¼Œå¦‚ä½ æä¾›çš„æ—¥å¿—æ¡ç›®ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">May <span class="hljs-number">28</span> <span class="hljs-number">17</span>:<span class="hljs-number">34</span>:<span class="hljs-number">42</span> sith-mom-test-node kernel: Out of memory: Kill process <span class="hljs-number">9281</span> (java) score <span class="hljs-number">75</span> or sacrifice child<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è„‘è£‚</title>
    <link href="/%E8%84%91%E8%A3%82/"/>
    <url>/%E8%84%91%E8%A3%82/</url>
    
    <content type="html"><![CDATA[<h1 id="1-è„‘è£‚æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-è„‘è£‚æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. è„‘è£‚æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. è„‘è£‚æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>è„‘è£‚æ˜¯æŒ‡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç½‘ç»œåˆ†åŒºæˆ–å…¶ä»–åŸå› å¯¼è‡´é›†ç¾¤ä¸­çš„èŠ‚ç‚¹åˆ†è£‚æˆå¤šä¸ªå­é›†ã€‚ç”±äºäº’ç›¸æ— æ³•é€šä¿¡ï¼Œè¿™äº›å­é›†å„è‡ªè®¤ä¸ºè‡ªå·±æ˜¯å”¯ä¸€çš„é›†ç¾¤ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´æ€§ã€æœåŠ¡é‡å¤ã€ç«æ€æ¡ä»¶ç­‰ä¸¥é‡é—®é¢˜ã€‚</p><p><strong>åœ¨åˆ†å¸ƒå¼æ•°æ®åº“ã€åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€åˆ†å¸ƒå¼é”ç­‰ç³»ç»Ÿä¸­ï¼Œè„‘è£‚é—®é¢˜å°¤ä¸ºé‡è¦ï¼Œå› ä¸ºå®ƒç›´æ¥å½±å“ç³»ç»Ÿçš„æ­£ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚</strong></p><h1 id="2-è„‘è£‚çš„æˆå› "><a href="#2-è„‘è£‚çš„æˆå› " class="headerlink" title="2. è„‘è£‚çš„æˆå› "></a>2. è„‘è£‚çš„æˆå› </h1><ol><li><strong>ç½‘ç»œåˆ†åŒº</strong>ï¼šé›†ç¾¤ä¸­çš„èŠ‚ç‚¹å› ç½‘ç»œæ•…éšœè¢«åˆ†éš”æˆå¤šä¸ªå­é›†ï¼Œå­é›†ä¹‹é—´æ— æ³•é€šä¿¡ã€‚</li><li><strong>èŠ‚ç‚¹æ•…éšœ</strong>ï¼šéƒ¨åˆ†èŠ‚ç‚¹å› æ•…éšœæš‚æ—¶ä¸å¯ç”¨ï¼Œå½“æ¢å¤åäº§ç”Ÿä¸å…¶ä»–èŠ‚ç‚¹çš„çŠ¶æ€å†²çªã€‚</li><li><strong>é…ç½®é”™è¯¯</strong>ï¼šé›†ç¾¤é…ç½®ä¸å½“ï¼Œå¯¼è‡´èŠ‚ç‚¹é”™è¯¯åœ°åŠ å…¥æˆ–é€€å‡ºé›†ç¾¤ã€‚</li></ol><h1 id="3-è„‘è£‚çš„å½±å“"><a href="#3-è„‘è£‚çš„å½±å“" class="headerlink" title="3. è„‘è£‚çš„å½±å“"></a>3. è„‘è£‚çš„å½±å“</h1><ul><li><strong>æ•°æ®ä¸ä¸€è‡´æ€§</strong>ï¼šä¸åŒå­é›†å„è‡ªè¿›è¡Œå†™æ“ä½œï¼Œå¯¼è‡´æ•°æ®çŠ¶æ€ä¸åŒæ­¥ã€‚</li><li><strong>æœåŠ¡é‡å¤</strong>ï¼šä¸åŒå­é›†å„è‡ªè®¤ä¸ºè‡ªå·±æ˜¯å”¯ä¸€çš„æœåŠ¡æä¾›è€…ï¼Œå¯¼è‡´é‡å¤çš„æœåŠ¡å®ä¾‹ã€‚</li><li><strong>ç«æ€æ¡ä»¶</strong>ï¼šä¸åŒå­é›†çš„æ“ä½œç›¸äº’å†²çªï¼Œå¯¼è‡´ç³»ç»Ÿè¡Œä¸ºä¸å¯é¢„æµ‹ã€‚</li></ul><h1 id="4-è§£å†³è„‘è£‚çš„æ–¹å¼"><a href="#4-è§£å†³è„‘è£‚çš„æ–¹å¼" class="headerlink" title="4. è§£å†³è„‘è£‚çš„æ–¹å¼"></a>4. è§£å†³è„‘è£‚çš„æ–¹å¼</h1><ol><li><strong>å¤šæ•°æ´¾æœºåˆ¶ï¼ˆQuorumï¼‰</strong>ï¼šé€šè¿‡è¦æ±‚è¶…è¿‡åŠæ•°ï¼ˆå³å¤šæ•°æ´¾ï¼‰çš„èŠ‚ç‚¹è¾¾æˆä¸€è‡´æ¥è¿›è¡Œæ“ä½œã€‚åªæœ‰å¤šæ•°æ´¾åŒæ„çš„æ“ä½œæ‰è¢«æ‰§è¡Œã€‚è¿™æ ·ï¼Œå³ä½¿åˆ†åŒºï¼Œä»»æ„ä¸€ä¸ªå­é›†è‹¥æœªè¾¾åˆ°å¤šæ•°æ´¾éƒ½ä¸èƒ½å¯¹å¤–æä¾›æœåŠ¡ï¼Œä»è€Œé¿å…è„‘è£‚ã€‚</li><li><strong>ç§Ÿçº¦ï¼ˆLeasesï¼‰</strong>ï¼šä½¿ç”¨ç§Ÿçº¦æœºåˆ¶ï¼Œç¡®ä¿åœ¨ä¸€ä¸ªæ—¶é—´æ®µå†…åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹èƒ½æŒæœ‰ç§Ÿçº¦ï¼Œæˆä¸ºLeaderã€‚ç§Ÿçº¦è¿‡æœŸåé‡æ–°é€‰ä¸¾ï¼Œé¿å…åŒæ—¶å­˜åœ¨å¤šä¸ªLeaderã€‚</li><li><strong>å¿ƒè·³æ£€æµ‹å’ŒèŠ‚ç‚¹éš”ç¦»</strong>ï¼šèŠ‚ç‚¹ä¹‹é—´å®šæœŸå‘é€å¿ƒè·³ä¿¡å·ä»¥æ£€æµ‹è¿é€šæ€§ã€‚ä¸€æ—¦æ£€æµ‹åˆ°ç½‘ç»œåˆ†åŒºæˆ–èŠ‚ç‚¹å¤±è”ï¼ŒåŠæ—¶éš”ç¦»å¤±è”èŠ‚ç‚¹ï¼Œé˜²æ­¢å…¶ç»§ç»­æä¾›æœåŠ¡ã€‚</li><li><strong>ä»²è£æœºåˆ¶</strong>ï¼šå¼•å…¥ç¬¬ä¸‰æ–¹ä»²è£èŠ‚ç‚¹ï¼Œå¦‚ä»²è£æœåŠ¡å™¨æˆ–å¤–éƒ¨å­˜å‚¨ç³»ç»Ÿï¼Œå½“åˆ†åŒºå‘ç”Ÿæ—¶ï¼Œä»²è£èŠ‚ç‚¹å†³å®šå“ªä¸€éƒ¨åˆ†é›†ç¾¤å¯ä»¥ç»§ç»­å¯¹å¤–æä¾›æœåŠ¡ã€‚</li><li><strong>ä¼˜å…ˆçº§ç­–ç•¥</strong>ï¼šæ ¹æ®èŠ‚ç‚¹çš„è§’è‰²ã€ä½ç½®ã€è´Ÿè½½ç­‰è®¾ç½®ä¼˜å…ˆçº§ï¼Œç¡®ä¿åªæœ‰é«˜ä¼˜å…ˆçº§çš„å­é›†ç»§ç»­æä¾›æœåŠ¡ï¼Œä½ä¼˜å…ˆçº§å­é›†æš‚åœæœåŠ¡ã€‚</li></ol><p><a href="https://pyr9.github.io/zookeeper%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/#9-Zookeeper%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E8%84%91%E8%A3%82%E9%97%AE%E9%A2%98%EF%BC%9F">Zookeeperå¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>javaåŸºç¡€</title>
    <link href="/java%E5%9F%BA%E7%A1%80/"/>
    <url>/java%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Java-é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§åŠç†è§£"><a href="#1-Java-é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§åŠç†è§£" class="headerlink" title="1. Java é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§åŠç†è§£"></a>1. Java é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§åŠç†è§£</h1><p>   é»˜è®¤æƒ…å†µä¸‹ï¼Œé¢å‘å¯¹è±¡æœ‰ä¸‰å¤§ç‰¹æ€§ï¼šç»§æ‰¿ã€å°è£…ã€å¤šæ€ã€‚ä½†å¦‚æœè€ƒå®˜è®©å›ç­”4å¤§ç‰¹æ€§ï¼Œæˆ‘ä»¬å°±æŠŠæŠ½è±¡åŠ ä¸Šå»ã€‚</p><p>1ã€ç»§æ‰¿</p><p> ç»§æ‰¿å°±æ˜¯ä»å·²æœ‰çš„ç±»ç»§æ‰¿ä¿¡æ¯åˆ›å»ºæ–°ç±»çš„è¿‡ç¨‹ï¼Œè¢«ç»§æ‰¿çš„ç±»ç§°ä¸ºçˆ¶ç±»ï¼ˆä¹Ÿå«åŸºç±»ã€è¶…ç±»ï¼‰ï¼Œç»§æ‰¿çš„ç±»å«åšå­ç±»ï¼ˆä¹Ÿå«æ´¾ç”Ÿç±»ï¼‰ã€‚å­ç±»å¯ä»¥å…¨ç›˜æ¥å—çˆ¶ç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼ˆç”šè‡³æ˜¯privateä¿®é¥°çš„ï¼Œä¹Ÿå¯ä»¥ç»§æ‰¿ï¼Œä½†æ˜¯ä¸èƒ½åœ¨çˆ¶ç±»ä¹‹å¤–è®¿é—®ï¼Œæä¾›å…±æœ‰çš„è®¿é—®æ–¹æ³•ï¼ˆæ¯”å¦‚å°è£…set()ã€get()ï¼‰å°±å¯ä»¥ç”¨ï¼‰ã€‚</p><p>2ã€å°è£…</p><p>â€‹      å°è£…å°±æ˜¯æŠŠæ•°æ®å’Œæ“ä½œæ•°æ®çš„æ–¹æ³•ç»‘å®šèµ·æ¥ï¼Œå¯¹å¤–æä¾›ç®€å•çš„æ¥å£ï¼Œåœ¨javaä¸­å¯¹ç±»ä¸­çš„æ–¹æ³•çš„å®šä¹‰å°±æ˜¯å¯¹ç»†èŠ‚çš„ä¸€ç§å°è£…ï¼Œç®€å•åœ°è¯´ï¼Œå°è£…å°±æ˜¯éšè—ä¸€åˆ‡å¯ä»¥éšè—çš„å†…å®¹ï¼Œå¯¹å¤–æä¾›ä¸€ä¸ªç®€å•çš„æ¥å£ã€‚</p><p>3ã€å¤šæ€</p><pre><code class="hljs">     å¤šæ€å°±æ˜¯æŒ‡ä¸åŒå­ç±»å‹å¯¹äºåŒä¸€æ¶ˆæ¯åšå‡ºä¸åŒçš„ååº”ï¼Œç®€å•åœ°è¯´ï¼Œå°±æ˜¯å¯¹äºåŒä¸€å¯¹è±¡ï¼Œè°ƒç”¨ç›¸åŒçš„æ–¹æ³•ï¼Œä½†åšäº†ä¸åŒçš„äº‹æƒ…ï¼Œå¤šæ€å…·ä½“ä½“ç°åœ¨æ–¹æ³•é‡è½½å’Œæ–¹æ³•é‡å†™ï¼Œæ–¹æ³•é‡è½½å®ç°çš„æ˜¯ç¼–è¯‘æ—¶çš„å¤šæ€ï¼Œè€Œæ–¹æ³•é‡å†™å®ç°çš„æ˜¯è¿è¡Œæ—¶çš„å¤šæ€ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å½“å‘ç”Ÿå‘ä¸Šè½¬å‹æ—¶ï¼Œå­ç±»ç‹¬æœ‰çš„æ–¹æ³•ä¸å¯ä»¥è¢«è°ƒç”¨ã€‚</code></pre><p>4ã€æŠ½è±¡</p><pre><code class="hljs">     æŠ½è±¡å°±æ˜¯æŠŠä¸åŒçš„å¯¹è±¡ç›¸åŒçš„ç‰¹å¾æ€»ç»“å‡ºæ¥æå–æˆä¸€ä¸ªç±»ï¼ŒæŠ½è±¡åªå…³æ³¨å¯¹è±¡æœ‰å“ªäº›çš„å±æ€§å’Œæ–¹æ³•ï¼Œï¼Œä»ä¸å…³å¿ƒè¿™äº›æ–¹æ³•å…·ä½“æ€ä¹ˆå®ç°ã€‚</code></pre><h1 id="2-ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿä»€ä¹ˆæ˜¯é¢å‘è¿‡ç¨‹ï¼Ÿ"><a href="#2-ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿä»€ä¹ˆæ˜¯é¢å‘è¿‡ç¨‹ï¼Ÿ" class="headerlink" title="2.ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿä»€ä¹ˆæ˜¯é¢å‘è¿‡ç¨‹ï¼Ÿ"></a>2.ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿä»€ä¹ˆæ˜¯é¢å‘è¿‡ç¨‹ï¼Ÿ</h1><ul><li><p>é¢å‘è¿‡ç¨‹ï¼ˆProcedure Oriented ç®€ç§° POï¼‰ï¼šæŠŠäº‹æƒ…æ‹†åˆ†æˆå‡ ä¸ªæ­¥éª¤ï¼ˆç›¸å½“äºæ‹†åˆ†æˆä¸€ä¸ªä¸ªçš„æ–¹æ³•å’Œæ•°æ®ï¼‰ï¼Œç„¶åæŒ‰ç…§ä¸€å®šçš„é¡ºåºæ‰§è¡Œã€‚</p></li><li><p>é¢å‘å¯¹è±¡ï¼ˆObject Oriented ç®€ç§° OOï¼‰ï¼šé¢å‘å¯¹è±¡ä¼šæŠŠäº‹ç‰©æŠ½è±¡æˆå¯¹è±¡çš„æ¦‚å¿µï¼Œå…ˆæŠ½è±¡å‡ºå¯¹è±¡ï¼Œç„¶åç»™å¯¹è±¡èµ‹ä¸€äº›å±æ€§å’Œæ–¹æ³•ï¼Œç„¶åè®©æ¯ä¸ªå¯¹è±¡å»æ‰§è¡Œè‡ªå·±çš„æ–¹æ³•ã€‚</p></li></ul><p>ä¸¾ä¾‹ï¼šç”¨æ´—è¡£æœºæ´—è¡£æœï¼Œæ¥çœ‹ä¸€ä¸‹ä¸¤è€…çš„å·®åˆ«ã€‚</p><p><strong>é¢å‘è¿‡ç¨‹ï¼š</strong></p><p>æ”¾è¡£æœï¼ˆæ–¹æ³•ï¼‰â€“&gt;åŠ æ´—è¡£ç²‰ï¼ˆæ–¹æ³•ï¼‰â€“&gt; åŠ æ°´ï¼ˆæ–¹æ³•ï¼‰â€“&gt; æ¸…æ´—ï¼ˆæ–¹æ³•ï¼‰â€“&gt; ç”©å¹²ï¼ˆæ–¹æ³•ï¼‰</p><p><strong>é¢å‘å¯¹è±¡ï¼š</strong></p><ol><li><p>new å‡ºä¸¤ä¸ªå¯¹è±¡ â€äººâ€œ å’Œ â€æ´—è¡£æœºâ€œ</p><ul><li><p>â€äººâ€œ åŠ å…¥å±æ€§å’Œæ–¹æ³•ï¼šæ”¾è¡£æœï¼ˆæ–¹æ³•ï¼‰ã€åŠ æ´—è¡£ç²‰ï¼ˆæ–¹æ³•ï¼‰ã€åŠ æ°´ï¼ˆæ–¹æ³•ï¼‰</p></li><li><p>â€æ´—è¡£æœºâ€œ åŠ å…¥å±æ€§å’Œæ–¹æ³•ï¼šæ¸…æ´—ï¼ˆæ–¹æ³•ï¼‰ã€ç”©å¹²ï¼ˆæ–¹æ³•ï¼‰</p></li></ul></li><li><p>ç„¶åæ‰§è¡Œï¼š</p></li></ol><p>â€‹äºº.æ”¾è¡£æœï¼ˆæ–¹æ³•ï¼‰-&gt; äºº.åŠ æ´—è¡£ç²‰ï¼ˆæ–¹æ³•ï¼‰-&gt; äºº.åŠ æ°´ï¼ˆæ–¹æ³•ï¼‰-&gt; æ´—è¡£æœº.æ¸…æ´—ï¼ˆæ–¹æ³•ï¼‰-&gt; æ´—è¡£æœº.ç”©å¹²ï¼ˆæ–¹æ³•ï¼‰</p><h1 id="2-é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„ä¼˜ç¼ºç‚¹å¯¹æ¯”"><a href="#2-é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„ä¼˜ç¼ºç‚¹å¯¹æ¯”" class="headerlink" title="2. é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„ä¼˜ç¼ºç‚¹å¯¹æ¯”"></a>2. é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„ä¼˜ç¼ºç‚¹å¯¹æ¯”</h1><p><strong>é¢å‘è¿‡ç¨‹ï¼š</strong></p><p>ä¼˜ç‚¹ï¼š</p><ul><li>æ•ˆç‡é«˜ï¼Œå› ä¸ºä¸éœ€è¦å®ä¾‹åŒ–å¯¹è±¡ã€‚</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ä»£ç ç»´æŠ¤å’Œæ‰©å±•ç›¸å¯¹å›°éš¾ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§å‹ç³»ç»Ÿä¸­ã€‚</li><li>æ•°æ®å’Œè¡Œä¸ºåˆ†ç¦»ï¼Œä¿®æ”¹æ•°æ®ç»“æ„å¯èƒ½å½±å“å¤šä¸ªå‡½æ•°ã€‚</li></ul><p><strong>é¢å‘å¯¹è±¡ï¼š</strong></p><p>ä¼˜ç‚¹ï¼š</p><ul><li>ä»£ç ç»´æŠ¤å’Œæ‰©å±•ç›¸å¯¹å®¹æ˜“ï¼Œé€šè¿‡ç»§æ‰¿å’Œå¤šæ€å®ç°æ‰©å±•ã€‚</li><li>å°è£…å’Œæ¨¡å—åŒ–è®¾è®¡ä½¿å¾—ç³»ç»Ÿæ›´æ˜“ç»´æŠ¤å’Œæ‰©å±•ã€‚</li></ul><p>ç¼ºç‚¹ï¼šæ•ˆç‡æ¯”é¢å‘è¿‡ç¨‹ä½ã€‚</p><h1 id="3-Javaä¸ºä»€ä¹ˆè¦æœ‰ç±»"><a href="#3-Javaä¸ºä»€ä¹ˆè¦æœ‰ç±»" class="headerlink" title="3. Javaä¸ºä»€ä¹ˆè¦æœ‰ç±»"></a>3. Javaä¸ºä»€ä¹ˆè¦æœ‰ç±»</h1><h3 id="1-é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒ"><a href="#1-é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒ" class="headerlink" title="1. é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒ"></a>1. <strong>é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒ</strong></h3><p>ç±»æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„åŸºæœ¬æ„å»ºæ¨¡å—ã€‚é¢å‘å¯¹è±¡ç¼–ç¨‹æ˜¯ä¸€ç§é€šè¿‡å°†æ•°æ®å’Œè¡Œä¸ºå°è£…åœ¨å¯¹è±¡ä¸­çš„ç¼–ç¨‹èŒƒå¼ã€‚ç±»æä¾›äº†ä¸€ç§å®šä¹‰å’Œåˆ›å»ºå¯¹è±¡çš„æ¨¡æ¿ï¼Œä½¿å¾—é¢å‘å¯¹è±¡ç¼–ç¨‹æˆä¸ºå¯èƒ½ã€‚</p><h3 id="2-å°è£…æ•°æ®å’Œè¡Œä¸º"><a href="#2-å°è£…æ•°æ®å’Œè¡Œä¸º" class="headerlink" title="2. å°è£…æ•°æ®å’Œè¡Œä¸º"></a>2. <strong>å°è£…æ•°æ®å’Œè¡Œä¸º</strong></h3><p>ç±»å…è®¸å°†æ•°æ®ï¼ˆå­—æ®µï¼‰å’Œè¡Œä¸ºï¼ˆæ–¹æ³•ï¼‰å°è£…åœ¨ä¸€èµ·ã€‚è¿™ç§å°è£…æœ‰åŠ©äºç»„ç»‡ä»£ç ï¼Œå¢å¼ºä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§ï¼Œå¹¶ä¿æŠ¤æ•°æ®ä¸è¢«å¤–éƒ¨ç›´æ¥è®¿é—®æˆ–ä¿®æ”¹ã€‚</p><h3 id="3-å®ç°æŠ½è±¡"><a href="#3-å®ç°æŠ½è±¡" class="headerlink" title="3. å®ç°æŠ½è±¡"></a>3. <strong>å®ç°æŠ½è±¡</strong></h3><p>ç±»å…è®¸åˆ›å»ºæŠ½è±¡çš„æ•°æ®ç±»å‹ï¼Œé€šè¿‡éšè—å®ç°ç»†èŠ‚ï¼Œåªæš´éœ²å¿…è¦çš„æ¥å£ç»™å¤–éƒ¨ä½¿ç”¨è€…ã€‚è¿™ç§æŠ½è±¡èƒ½åŠ›ä½¿å¾—å¤æ‚ç³»ç»Ÿå¯ä»¥åˆ†è§£ä¸ºæ›´ç®€å•ã€æ›´å¯ç®¡ç†çš„éƒ¨åˆ†ã€‚</p><h3 id="4-ç»§æ‰¿å’Œä»£ç å¤ç”¨"><a href="#4-ç»§æ‰¿å’Œä»£ç å¤ç”¨" class="headerlink" title="4. ç»§æ‰¿å’Œä»£ç å¤ç”¨"></a>4. <strong>ç»§æ‰¿å’Œä»£ç å¤ç”¨</strong></h3><p>ç±»æ”¯æŒç»§æ‰¿ï¼Œå¯ä»¥ä»ç°æœ‰çš„ç±»æ´¾ç”Ÿå‡ºæ–°çš„ç±»ï¼Œä»è€Œå®ç°ä»£ç çš„å¤ç”¨å’Œæ‰©å±•ã€‚å­ç±»ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¯ä»¥é‡ç”¨ç°æœ‰ä»£ç å¹¶æ·»åŠ æ–°çš„åŠŸèƒ½ã€‚</p><h3 id="5-å¤šæ€æ€§"><a href="#5-å¤šæ€æ€§" class="headerlink" title="5. å¤šæ€æ€§"></a>5. <strong>å¤šæ€æ€§</strong></h3><p>ç±»æ”¯æŒå¤šæ€æ€§ï¼Œè¿™ä½¿å¾—ç›¸åŒæ¥å£çš„ä¸åŒå®ç°å¯ä»¥ä»¥ç»Ÿä¸€çš„æ–¹å¼ä½¿ç”¨ã€‚å¤šæ€æ€§é€šè¿‡æ–¹æ³•é‡å†™å’Œæ¥å£å®ç°å®ç°ï¼Œå…è®¸ä»£ç æ›´åŠ çµæ´»å’Œå¯æ‰©å±•ã€‚</p><h3 id="6-æ¨¡å—åŒ–å’Œç»„ç»‡ä»£ç "><a href="#6-æ¨¡å—åŒ–å’Œç»„ç»‡ä»£ç " class="headerlink" title="6. æ¨¡å—åŒ–å’Œç»„ç»‡ä»£ç "></a>6. <strong>æ¨¡å—åŒ–å’Œç»„ç»‡ä»£ç </strong></h3><p>ç±»æä¾›äº†ä¸€ç§è‡ªç„¶çš„æ–¹å¼æ¥ç»„ç»‡å’Œæ¨¡å—åŒ–ä»£ç ã€‚åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œä½¿ç”¨ç±»å¯ä»¥å°†ç›¸å…³çš„åŠŸèƒ½ã€æ•°æ®å’Œè¡Œä¸ºé›†ä¸­åœ¨ä¸€ä¸ªæ¨¡å—ä¸­ï¼Œä½¿ä»£ç æ›´æ˜“äºç†è§£ã€ç®¡ç†å’Œç»´æŠ¤ã€‚</p><h1 id="4-javaå¦‚ä½•åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Ÿ"><a href="#4-javaå¦‚ä½•åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Ÿ" class="headerlink" title="4. javaå¦‚ä½•åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Ÿ"></a>4. javaå¦‚ä½•åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Ÿ</h1><ol><li><strong>é€šè¿‡ç»§æ‰¿<code>Thread</code>ç±»</strong>ï¼š</li></ol><ul><li>åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»ç»§æ‰¿<code>Thread</code>ç±»ã€‚</li><li>é‡å†™<code>run</code>æ–¹æ³•ï¼Œåœ¨<code>run</code>æ–¹æ³•ä¸­å®šä¹‰çº¿ç¨‹è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚</li><li>åˆ›å»ºè¯¥ç±»çš„å®ä¾‹å¹¶è°ƒç”¨<code>start</code>æ–¹æ³•å¯åŠ¨çº¿ç¨‹ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Thread</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// çº¿ç¨‹è¦æ‰§è¡Œçš„ä»»åŠ¡</span><br>        System.out.println(<span class="hljs-string">&quot;Thread is running&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        MyThread thread = <span class="hljs-keyword">new</span> MyThread();<br>        thread.start();  <span class="hljs-comment">// å¯åŠ¨çº¿ç¨‹</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li><strong>é€šè¿‡å®ç°<code>Runnable</code>æ¥å£</strong>ï¼š</li></ol><ul><li>åˆ›å»ºä¸€ä¸ªå®ç°<code>Runnable</code>æ¥å£çš„ç±»ã€‚</li><li>å®ç°<code>run</code>æ–¹æ³•ï¼Œåœ¨<code>run</code>æ–¹æ³•ä¸­å®šä¹‰çº¿ç¨‹è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚</li><li>åˆ›å»ºä¸€ä¸ª<code>Thread</code>å¯¹è±¡ï¼Œå¹¶å°†å®ç°<code>Runnable</code>æ¥å£çš„å®ä¾‹ä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>Thread</code>æ„é€ å‡½æ•°ã€‚</li><li>è°ƒç”¨<code>Thread</code>å¯¹è±¡çš„<code>start</code>æ–¹æ³•å¯åŠ¨çº¿ç¨‹ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyRunnable</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// çº¿ç¨‹è¦æ‰§è¡Œçš„ä»»åŠ¡</span><br>        System.out.println(<span class="hljs-string">&quot;Thread is running&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        MyRunnable myRunnable = <span class="hljs-keyword">new</span> MyRunnable();<br>        Thread thread = <span class="hljs-keyword">new</span> Thread(myRunnable);<br>        thread.start();  <span class="hljs-comment">// å¯åŠ¨çº¿ç¨‹</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li>**é€šè¿‡å®ç° <code>Callable</code> æ¥å£å¹¶ä½¿ç”¨ <code>FutureTask</code>**ï¼š</li></ol><p>é€šè¿‡ä½¿ç”¨ <code>Callable</code> å’Œ <code>FutureTask</code>ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå¸¦è¿”å›ç»“æœçš„çº¿ç¨‹ï¼Œå¹¶åœ¨éœ€è¦æ—¶è·å–å…¶ç»“æœã€‚è¿™ç§æ–¹å¼éå¸¸é€‚åˆç”¨äºéœ€è¦å¹¶è¡Œæ‰§è¡Œå¹¶è·å–ç»“æœçš„ä»»åŠ¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.concurrent.Callable;<br><span class="hljs-keyword">import</span> java.util.concurrent.ExecutionException;<br><span class="hljs-keyword">import</span> java.util.concurrent.FutureTask;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleCallableExample</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå®ç° Callable æ¥å£çš„ç±»</span><br>        Callable&lt;Integer&gt; callableTask = <span class="hljs-keyword">new</span> Callable&lt;Integer&gt;() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>                <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€äº›è®¡ç®—ä»»åŠ¡</span><br>                System.out.println(<span class="hljs-string">&quot;Thread is running&quot;</span>);<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">42</span>;  <span class="hljs-comment">// è¿”å›ç»“æœ</span><br>            &#125;<br>        &#125;;<br><br>        <span class="hljs-comment">// ä½¿ç”¨ FutureTask åŒ…è£… Callable å¯¹è±¡</span><br>        FutureTask&lt;Integer&gt; futureTask = <span class="hljs-keyword">new</span> FutureTask&lt;&gt;(callableTask);<br><br>        <span class="hljs-comment">// åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹</span><br>        Thread thread = <span class="hljs-keyword">new</span> Thread(futureTask);<br>        thread.start();<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// è·å–å¼‚æ­¥è®¡ç®—çš„ç»“æœ</span><br>            Integer result = futureTask.get();<br>            System.out.println(<span class="hljs-string">&quot;Result from thread: &quot;</span> + result);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException | ExecutionException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><ol start="3"><li><strong>é€šè¿‡ä½¿ç”¨<code>ExecutorService</code>æ¡†æ¶</strong>ï¼š</li></ol><ul><li>ä½¿ç”¨<code>Executors</code>åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ã€‚</li><li>æäº¤å®ç°<code>Runnable</code>æˆ–<code>Callable</code>æ¥å£çš„ä»»åŠ¡ç»™çº¿ç¨‹æ± æ¥æ‰§è¡Œã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.concurrent.ExecutorService;<br><span class="hljs-keyword">import</span> java.util.concurrent.Executors;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyRunnable</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// çº¿ç¨‹è¦æ‰§è¡Œçš„ä»»åŠ¡</span><br>        System.out.println(<span class="hljs-string">&quot;Thread is running&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ExecutorService executorService = Executors.newFixedThreadPool(<span class="hljs-number">2</span>);<br>        MyRunnable myRunnable = <span class="hljs-keyword">new</span> MyRunnable();<br>        executorService.execute(myRunnable);  <span class="hljs-comment">// æäº¤ä»»åŠ¡ç»™çº¿ç¨‹æ± æ‰§è¡Œ</span><br>        executorService.shutdown();  <span class="hljs-comment">// å…³é—­çº¿ç¨‹æ± </span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="5-Springå¦‚ä½•åˆ›å»ºä¸€ä¸ªçº¿ç¨‹"><a href="#5-Springå¦‚ä½•åˆ›å»ºä¸€ä¸ªçº¿ç¨‹" class="headerlink" title="5. Springå¦‚ä½•åˆ›å»ºä¸€ä¸ªçº¿ç¨‹"></a>5. Springå¦‚ä½•åˆ›å»ºä¸€ä¸ªçº¿ç¨‹</h1><ol><li>ä½¿ç”¨ <code>@Async</code> æ³¨è§£</li></ol><p><code>@Async</code> æ³¨è§£ç”¨äºå°†æŸä¸ªæ–¹æ³•æ ‡è®°ä¸ºå¼‚æ­¥æ‰§è¡Œã€‚è¦ä½¿ç”¨å®ƒï¼Œä½ éœ€è¦å¯ç”¨Springçš„å¼‚æ­¥æ”¯æŒã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.scheduling.annotation.Async;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AsyncService</span> </span>&#123;<br>    <br>    <span class="hljs-meta">@Async</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">asyncMethod</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Async method started&quot;</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">2000</span>);  <span class="hljs-comment">// æ¨¡æ‹Ÿé•¿æ—¶é—´ä»»åŠ¡</span><br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;Async method finished&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><ol start="2"><li>ä½¿ç”¨ <code>TaskExecutor</code></li></ol><p><code>TaskExecutor</code> æ˜¯Springæä¾›çš„ä¸€ç»„æ¥å£ï¼Œç”¨äºæŠ½è±¡å¹¶å‘ç¼–ç¨‹çš„ç»†èŠ‚ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>ThreadPoolTaskExecutor</code> æ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;<br><br><span class="hljs-keyword">import</span> java.util.concurrent.Executor;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TaskExecutorConfig</span> </span>&#123;<br><br>    <span class="hljs-meta">@Bean(name = &quot;taskExecutor&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Executor <span class="hljs-title">taskExecutor</span><span class="hljs-params">()</span> </span>&#123;<br>        ThreadPoolTaskExecutor executor = <span class="hljs-keyword">new</span> ThreadPoolTaskExecutor();<br>        executor.setCorePoolSize(<span class="hljs-number">5</span>);<br>        executor.setMaxPoolSize(<span class="hljs-number">10</span>);<br>        executor.setQueueCapacity(<span class="hljs-number">25</span>);<br>        executor.setThreadNamePrefix(<span class="hljs-string">&quot;AsyncThread-&quot;</span>);<br>        executor.initialize();<br>        <span class="hljs-keyword">return</span> executor;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åœ¨æœåŠ¡ç±»ä¸­æ³¨å…¥ <code>TaskExecutor</code> å¹¶ä½¿ç”¨å®ƒæ‰§è¡Œä»»åŠ¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.core.task.TaskExecutor;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TaskExecutorService</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> TaskExecutor taskExecutor;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">executeTask</span><span class="hljs-params">()</span> </span>&#123;<br>        taskExecutor.execute(() -&gt; &#123;<br>            System.out.println(<span class="hljs-string">&quot;Task executed by TaskExecutor&quot;</span>);<br>            <span class="hljs-keyword">try</span> &#123;<br>                Thread.sleep(<span class="hljs-number">2000</span>);  <span class="hljs-comment">// æ¨¡æ‹Ÿé•¿æ—¶é—´ä»»åŠ¡</span><br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>            System.out.println(<span class="hljs-string">&quot;Task completed&quot;</span>);<br>        &#125;);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="6-Java8å¼•å…¥streamæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ"><a href="#6-Java8å¼•å…¥streamæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ" class="headerlink" title="6. Java8å¼•å…¥streamæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ"></a>6. Java8å¼•å…¥streamæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ</h1><h4 id="1-æ›´ç®€æ´çš„ä»£ç "><a href="#1-æ›´ç®€æ´çš„ä»£ç " class="headerlink" title="1. æ›´ç®€æ´çš„ä»£ç "></a>1. <strong>æ›´ç®€æ´çš„ä»£ç </strong></h4><ul><li>ä½¿ç”¨æµAPIï¼Œå¯ä»¥ç”¨æ›´å°‘çš„ä»£ç å®Œæˆå¯¹é›†åˆçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œå¯¹é›†åˆè¿›è¡Œè¿‡æ»¤ã€è½¬æ¢ã€æ’åºå’Œèšåˆç­‰æ“ä½œå¯ä»¥é€šè¿‡é“¾å¼è°ƒç”¨å®ç°ï¼Œä½¿ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“è¯»ã€‚</li></ul><h4 id="2-å¹¶è¡Œå¤„ç†èƒ½åŠ›"><a href="#2-å¹¶è¡Œå¤„ç†èƒ½åŠ›" class="headerlink" title="2. å¹¶è¡Œå¤„ç†èƒ½åŠ›"></a>2. <strong>å¹¶è¡Œå¤„ç†èƒ½åŠ›</strong></h4><ul><li>æµAPIæ”¯æŒè½»æ¾çš„å¹¶è¡Œæ“ä½œï¼Œåªéœ€å°† <code>stream()</code> æ–¹æ³•æ›´æ¢ä¸º <code>parallelStream()</code>ï¼Œå°±å¯ä»¥åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨çš„èƒ½åŠ›æ¥åŠ é€Ÿæ•°æ®å¤„ç†ã€‚è¿™å¯¹äºå¤„ç†å¤§å‹æ•°æ®é›†åˆå°¤ä¸ºé‡è¦ã€‚</li></ul><h4 id="3-æƒ°æ€§æ±‚å€¼"><a href="#3-æƒ°æ€§æ±‚å€¼" class="headerlink" title="3. æƒ°æ€§æ±‚å€¼"></a>3. <strong>æƒ°æ€§æ±‚å€¼</strong></h4><ul><li><code>Stream</code> API é‡‡ç”¨æƒ°æ€§æ±‚å€¼ç­–ç•¥ï¼Œå³åªæœ‰åœ¨æœ€ç»ˆéœ€è¦ç»“æœæ—¶æ‰ä¼šæ‰§è¡Œä¸­é—´æ“ä½œã€‚æ­¤å¤–ï¼Œä¸€äº›ç»ˆç«¯æ“ä½œï¼ˆå¦‚ <code>findFirst()</code> æˆ– <code>anyMatch()</code>ï¼‰å…·æœ‰çŸ­è·¯ç‰¹æ€§ï¼Œè¿™æ„å‘³ç€ä¸€æ—¦æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåç»­çš„æ“ä½œå°±ä¼šåœæ­¢ï¼Œä»è€ŒèŠ‚çœè®¡ç®—èµ„æºã€‚</li></ul><h4 id="4-æ˜“äºç»„åˆå’Œé‡ç”¨"><a href="#4-æ˜“äºç»„åˆå’Œé‡ç”¨" class="headerlink" title="4. æ˜“äºç»„åˆå’Œé‡ç”¨"></a>4. <strong>æ˜“äºç»„åˆå’Œé‡ç”¨</strong></h4><ul><li>ç”±äº <code>Stream</code> æ“ä½œæ˜¯é«˜åº¦æ¨¡å—åŒ–çš„ï¼Œä½ å¯ä»¥è½»æ¾åœ°å°†ä¸åŒçš„æ“ä½œç»„åˆåœ¨ä¸€èµ·å½¢æˆå¤æ‚çš„å¤„ç†æµç¨‹ï¼Œä¹Ÿå¯ä»¥æ–¹ä¾¿åœ°å¤ç”¨è¿™äº›æ“ä½œã€‚</li></ul><h1 id="7-Transactional-å¸¸ç”¨çš„ä¸€äº›é…ç½®ï¼Ÿ"><a href="#7-Transactional-å¸¸ç”¨çš„ä¸€äº›é…ç½®ï¼Ÿ" class="headerlink" title="7 @Transactional å¸¸ç”¨çš„ä¸€äº›é…ç½®ï¼Ÿ"></a>7 @Transactional å¸¸ç”¨çš„ä¸€äº›é…ç½®ï¼Ÿ</h1><ol><li><p><strong>propagation</strong>ï¼ˆä¼ æ’­è¡Œä¸ºï¼‰</p><ul><li><p>å®šä¹‰äº‹åŠ¡åœ¨é‡åˆ°å·²æœ‰äº‹åŠ¡æ—¶çš„è¡Œä¸ºã€‚</p></li><li><p>å¸¸ç”¨å€¼</p><ul><li><p><code>REQUIRED</code>ï¼ˆé»˜è®¤ï¼‰ï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦åˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚</p></li><li><p><code>REQUIRES_NEW</code>ï¼šæ€»æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŒ‚èµ·å®ƒã€‚å¦‚ï¼šåœ¨æ—¥å¿—çš„saveæ—¶ï¼Œå³ä½¿ <code>createUser</code> æ–¹æ³•å¤±è´¥å¹¶å¯¼è‡´äº‹åŠ¡å›æ»šï¼Œæ—¥å¿—è®°å½•æ“ä½œä»ç„¶ä¼šè¢«æäº¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Transactional</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">createUserWithLogging</span><span class="hljs-params">(User user)</span> </span>&#123;<br>  userService.createUser(user);<br>  loggingService.logMessage(<span class="hljs-string">&quot;User created: &quot;</span> + user.getName());<br>&#125;<br>    <br><br><span class="hljs-meta">@Transactional(propagation = Propagation.REQUIRES_NEW)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">logMessage</span><span class="hljs-params">(String message)</span> </span>&#123;<br>  logRepository.save(<span class="hljs-keyword">new</span> Log(message));<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><code>SUPPORTS</code>ï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦åˆ™ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œã€‚</p></li><li><p><code>NOT_SUPPORTED</code>ï¼šä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŒ‚èµ·å®ƒã€‚</p></li><li><p><code>MANDATORY</code>ï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p></li><li><p><code>NEVER</code>ï¼šä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p></li><li><p><code>NESTED</code>ï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œï¼›å¦åˆ™ä¸ <code>REQUIRED</code> è¡Œä¸ºç›¸åŒã€‚</p></li></ul></li></ul></li><li><p><strong>rollbackFor</strong>ï¼ˆå›æ»šå¼‚å¸¸ï¼‰</p><ul><li><p>æŒ‡å®šå“ªäº›å¼‚å¸¸ä¼šå¯¼è‡´äº‹åŠ¡å›æ»šï¼Œé»˜è®¤æƒ…å†µä¸‹åªæœ‰ <code>RuntimeException</code> å’Œ <code>Error</code> ä¼šè§¦å‘å›æ»šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Transactional(rollbackFor = &#123;SQLException.class, IOException.class&#125;)</span><br></code></pre></td></tr></table></figure></li></ul></li><li><p><strong>timeout</strong>ï¼ˆè¶…æ—¶æ—¶é—´ï¼‰</p><ul><li><p>å®šä¹‰äº‹åŠ¡çš„æœ€å¤§æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œè¶…è¿‡è¯¥æ—¶é—´å°†æŠ›å‡ºå¼‚å¸¸å¹¶å›æ»šäº‹åŠ¡ã€‚å½“æŸä¸ªäº‹åŠ¡å¯èƒ½é•¿æ—¶é—´è¿è¡Œæ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®è¶…æ—¶æ—¶é—´æ¥é¿å…é•¿æ—¶é—´å ç”¨èµ„æºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Transactional(timeout = 30)</span><br></code></pre></td></tr></table></figure></li></ul></li><li><p><strong>isolation</strong>ï¼ˆéš”ç¦»çº§åˆ«ï¼‰</p><ul><li><p>å®šä¹‰äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼Œæ§åˆ¶äº‹åŠ¡ä¹‹é—´çš„å¯è§æ€§ã€‚</p></li><li><p>å¸¸ç”¨å€¼</p><ul><li><code>DEFAULT</code>ï¼ˆé»˜è®¤ï¼‰ï¼šä½¿ç”¨åº•å±‚æ•°æ®åº“çš„é»˜è®¤éš”ç¦»çº§åˆ«ã€‚</li><li><code>READ_UNCOMMITTED</code>ï¼šå…è®¸è¯»å–æœªæäº¤çš„æ•°æ®æ›´æ”¹ï¼Œå¯èƒ½å¯¼è‡´è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚</li><li><code>READ_COMMITTED</code>ï¼šå…è®¸ä»å·²ç»æäº¤çš„äº‹åŠ¡ä¸­è¯»å–æ•°æ®ï¼Œé˜²æ­¢è„è¯»ã€‚</li><li><code>REPEATABLE_READ</code>ï¼šå¯¹åŒä¸€å­—æ®µçš„å¤šæ¬¡è¯»å–ç»“æœä¸€è‡´ï¼Œé™¤éæ•°æ®è¢«å½“å‰äº‹åŠ¡æœ¬èº«æ”¹å˜ï¼Œå¯ä»¥é˜²æ­¢è„è¯»å’Œä¸å¯é‡å¤è¯»ã€‚</li><li><code>SERIALIZABLE</code>ï¼šå®Œå…¨ä¸²è¡ŒåŒ–ï¼Œæœ€é«˜çº§åˆ«çš„éš”ç¦»ï¼Œé˜²æ­¢æ‰€æœ‰å¹¶å‘é—®é¢˜ï¼Œä½†æ€§èƒ½è¾ƒä½ã€‚</li></ul></li></ul></li><li><p><strong>readOnly</strong>ï¼ˆåªè¯»æ ‡å¿—ï¼‰</p></li></ol><ul><li><p>å¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œè¡¨ç¤ºè¯¥äº‹åŠ¡æ˜¯åªè¯»çš„ï¼Œä¼˜åŒ–å™¨å¯èƒ½ä¼šè¿›è¡Œä¸€äº›ä¼˜åŒ–ã€‚è¿™ç§æ–¹å¼é€‚ç”¨äºæŸ¥è¯¢æ“ä½œï¼Œé¿å…ä¸å¿…è¦çš„é”å’Œå†™æ“ä½œã€‚</p><pre><code class="hljs">   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Transactional(readOnly = true)</span><br></code></pre></td></tr></table></figure></code></pre></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>springå¸¸è§é¢è¯•é¢˜</title>
    <link href="/spring%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/spring%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Spring-æ³¨å…¥è¿‡ç¨‹"><a href="#1-Spring-æ³¨å…¥è¿‡ç¨‹" class="headerlink" title="1. Spring æ³¨å…¥è¿‡ç¨‹"></a>1. Spring æ³¨å…¥è¿‡ç¨‹</h1><ol><li>å¯åŠ¨ Spring å®¹å™¨</li><li>è¯»å–é…ç½®æ–‡ä»¶æˆ–æ³¨è§£æ‰«æï¼ˆå¦‚ <code>@ComponentScan</code>ï¼‰åŠ è½½ Bean çš„å®šä¹‰ã€‚</li><li>Spring å®¹å™¨ä¼šæ ¹æ® Bean çš„å®šä¹‰å®ä¾‹åŒ–å¯¹è±¡ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå®ä¾‹åŒ–ï¼ˆInstantiationï¼‰ã€‚</li><li>Spring å®¹å™¨ä¼šæ³¨å…¥ä¾èµ–å¯¹è±¡åˆ° Bean ä¸­ã€‚ä¾èµ–æ³¨å…¥å¯ä»¥é€šè¿‡æ„é€ å™¨ã€Setter æ–¹æ³•æˆ–å­—æ®µæ³¨å…¥æ¥å®ç°ã€‚</li></ol><p>ä¾èµ–æ³¨å…¥å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ Spring ä¸Šä¸‹æ–‡è·å– Bean å®ä¾‹ã€‚</p><h1 id="2-Springä¸¤å¤§ç‰¹æ€§"><a href="#2-Springä¸¤å¤§ç‰¹æ€§" class="headerlink" title="2. Springä¸¤å¤§ç‰¹æ€§"></a>2. Springä¸¤å¤§ç‰¹æ€§</h1><p>Spring æ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼ŒSpringå¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œå®ƒä¸ºä¼ä¸šçº§å¼€å‘æä¾›è¿™äº›åŠŸèƒ½çš„åº•å±‚éƒ½ä¾èµ–äºå®ƒçš„ä¸¤ä¸ªæ ¸å¿ƒç‰¹æ€§ï¼šIOCå’ŒAOPã€‚</p><ol><li><p>IOCï¼šIOCæ§åˆ¶åè½¬ä¹Ÿå«ä¾èµ–æ³¨å…¥ï¼ŒIOC åˆ©ç”¨ java åå°„æœºåˆ¶ï¼Œæ‰€è°“æ§åˆ¶åè½¬æ˜¯æŒ‡ï¼Œæœ¬æ¥è¢«è°ƒç”¨è€…çš„å®ä¾‹æ˜¯æœ‰è°ƒç”¨è€…æ¥åˆ›å»ºçš„ï¼Œè¿™æ ·çš„ç¼ºç‚¹æ˜¯è€¦åˆæ€§å¤ªå¼ºï¼ŒIOC åˆ™æ˜¯ç»Ÿä¸€äº¤ç»™ spring å®¹å™¨æ¥ç®¡ç†åˆ›å»ºï¼Œå°†å¯¹è±¡äº¤ç»™å®¹å™¨ç®¡ç†ï¼Œä½ åªéœ€è¦åœ¨ spring é…ç½®æ–‡ä»¶ä¸­é…ç½®ç›¸åº”çš„ beanï¼Œä»¥åŠè®¾ç½®ç›¸å…³çš„å±æ€§ï¼Œè®©spring å®¹å™¨æ¥ç”Ÿæˆç±»çš„å®ä¾‹å¯¹è±¡ä»¥åŠç®¡ç†å¯¹è±¡ã€‚å°±æ¯”å¦‚ï¼šåŸæ¥æˆ‘çš„serviceå±‚è¦è°ƒç”¨daoå±‚ï¼Œserviceå°±è¦åˆ›å»ºdao,ä½†springå‘ç°ä½ çš„serviceå±‚è¦ä¾èµ–daoå±‚åï¼Œå°±å¯ä»¥ç»™ä½ æ³¨å…¥ã€‚</p></li><li><p>AOPï¼šä¸º Aspect Oriented Programming çš„ç¼©å†™ï¼Œæ„ä¸ºï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå¯ä»¥é€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°åœ¨ä¸ä¿®æ”¹æºä»£ç çš„æƒ…å†µä¸‹ç»™ç¨‹åºåŠ¨æ€ç»Ÿä¸€æ·»åŠ åŠŸèƒ½çš„ä¸€ç§æŠ€æœ¯ã€‚<br>ï¼ˆ1ï¼‰æ¯”å¦‚è¯´ç°åœ¨æœ‰ä¸€ä¸ªç±» iAï¼Œé‡Œé¢æœ‰å¢åˆ æ”¹çš„æ–¹æ³•ï¼Œç°åœ¨è¦åœ¨æ¯ä¸ªç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰åè¿›è¡Œå¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡ã€‚ä¼ ç»Ÿçš„æ€æƒ³æ˜¯çºµå‘ç»§æ‰¿ï¼šè¦æƒ³å®ç°äº‹åŠ¡çš„åŠŸèƒ½çš„è¯ï¼Œä¸å¾—ä¸é‡‡ç”¨ å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•ï¼Œé€šè¿‡é‡å†™çˆ¶ç±»çš„ç›®æ ‡æ–¹æ³•ï¼Œåœ¨æ­¤åŸºç¡€ä¸ŠåŠ ä¸Šäº‹åŠ¡ï¼Œå¼€å¯äº‹åŠ¡&#x2F;æäº¤äº‹åŠ¡ï¼Œè¿™æ ·çš„è¯ï¼Œä»£ç é‡å¤ç‡å¾ˆé«˜ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½è¦å†™å¼€å¯äº‹åŠ¡&#x2F;æäº¤äº‹åŠ¡ï¼Œä»£ç é‡å¤ç‡å¤ªé«˜ã€‚<br>ï¼ˆ2ï¼‰AOP é‡‡å–æ¨ªå‘æŠ½å–æœºåˆ¶ï¼šå°±æ˜¯è¯´ï¼Œé‰´äºçºµå‘ç»§æ‰¿å‡ºç°é‡å¤çš„ä»£ç ï¼ŒæŠŠé‡å¤çš„ä»£ç æå–å‡ºæ¥æ”¾åˆ°ä¸€ä¸ªç±» B ä¸­ï¼Œç„¶å spring ç”Ÿæˆä¸€ä¸ªä»£ç†ç±»ï¼Œä»–å’Œç›®æ ‡ç±»ä¹Ÿå°±æ˜¯ç±» A å®ç°ç›¸åŒçš„æ¥å£ï¼Œæ‹¥æœ‰ç›¸åŒçš„æ–¹æ³•ï¼Œé‚£ä¹ˆä»£ç†ç±»å°±å¯ä»¥æŠŠç±» B å’Œç›®æ ‡ç±»éƒ½æ‹¿æ¥ï¼Œè¿›è¡Œç»„åˆï¼Œå¯¹å¤–è®¿é—®çš„è¯ï¼Œå°±æ˜¯è®¿é—®çš„ä»£ç†ç±»ã€‚<br>ï¼ˆ3ï¼‰å°±è¾¾åˆ°å’Œçºµå‘ç»§æ‰¿ä¸€æ ·çš„æ•ˆæœã€‚ä»–åœ¨ spring ä¸­æ˜¯ç”¨åå°„å»åšï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯ç¼–å†™ç›®æ ‡ç±» A å’Œåˆ‡é¢ç±»ç±» Bã€‚ç„¶åå‘Šè¯‰ springï¼Œè®© Spring ç”Ÿæˆä»£ç†å°±è¡Œäº†ï¼Œä»£ç å°‘äº†å¾ˆå¤šï¼Œä½†æ˜¯åŠŸèƒ½ä¸€ä¸ªä¸å°‘ã€‚</p></li></ol><h1 id="3-springä¼˜ç‚¹"><a href="#3-springä¼˜ç‚¹" class="headerlink" title="3. springä¼˜ç‚¹"></a>3. springä¼˜ç‚¹</h1><p>ï¼ˆ1ï¼‰æ–¹ä¾¿è§£è€¦ï¼Œç®€åŒ–å¼€å‘ï¼ˆé«˜å†…èšï¼Œä½è€¦åˆï¼‰<br>Springå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå¯ä»¥å°†æ‰€æœ‰å¯¹è±¡åˆ›å»ºå’Œä¾èµ–å…³ç³»ç»´æŠ¤ï¼Œéƒ½äº¤ç»™springç®¡ç†ï¼Œspringå·¥å‚ç”¨äºç”Ÿæˆbean<br>ï¼ˆ2ï¼‰AOPç¼–ç¨‹çš„æ”¯æŒ<br>å¯ä»¥é€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°åœ¨ä¸ä¿®æ”¹æºä»£ç çš„æƒ…å†µä¸‹ç»™ç¨‹åºåŠ¨æ€ç»Ÿä¸€æ·»åŠ åŠŸèƒ½çš„ä¸€ç§æŠ€æœ¯<br>ï¼ˆ3ï¼‰å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒ<br>åªéœ€è¦é€šè¿‡é…ç½®å°±å¯ä»¥å®Œæˆå¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–ç¨‹<br>ï¼ˆ4ï¼‰æ–¹ä¾¿ç¨‹åºçš„æµ‹è¯•<br>springå¯¹Junit4æ”¯æŒï¼Œå¯ä»¥é€šè¿‡æ³¨è§£æ–¹ä¾¿çš„æµ‹è¯•springç¨‹åº<br>ï¼ˆ5ï¼‰æ–¹ä¾¿é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶<br>springå†…éƒ¨æä¾›äº†å¯¹å„ç§ä¼˜ç§€æ¡†æ¶çš„æ”¯æŒï¼Œå¦‚mybatisç­‰</p><h1 id="4-åœ¨-Spring-ä¸­ï¼Œæœ‰å‡ ç§ä¾èµ–æ³¨å…¥æ–¹å¼ï¼Ÿ"><a href="#4-åœ¨-Spring-ä¸­ï¼Œæœ‰å‡ ç§ä¾èµ–æ³¨å…¥æ–¹å¼ï¼Ÿ" class="headerlink" title="4. åœ¨ Spring ä¸­ï¼Œæœ‰å‡ ç§ä¾èµ–æ³¨å…¥æ–¹å¼ï¼Ÿ"></a>4. åœ¨ Spring ä¸­ï¼Œæœ‰å‡ ç§ä¾èµ–æ³¨å…¥æ–¹å¼ï¼Ÿ</h1><p>é€šå¸¸ï¼Œä¾èµ–æ³¨å…¥å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼å®Œæˆ<br>å³ï¼šæ„é€ å‡½æ•°æ³¨å…¥ã€setter æ³¨å…¥ã€æ¥å£æ³¨å…¥ï¼Œåœ¨ Spring Framework ä¸­ï¼Œä»…ä½¿ç”¨æ„é€ å‡½æ•°å’Œ setter æ³¨å…¥ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 1ã€æ„é€ æ–¹æ³•æ³¨å…¥ --&gt;</span> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;teacher1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.pojo.Teacher&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;è€åˆ˜&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constructor-arg</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;age&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;36&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constructor-arg</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--  setteræ–¹æ³•æ³¨å…¥ --&gt;</span>  <br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;stu&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.pojo.Student&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;lisi44&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;age&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;99&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br></code></pre></td></tr></table></figure><h1 id="5-åœ¨-Spring-ä¸­ï¼Œæœ‰å‡ ç§é…ç½®-Bean-çš„æ–¹å¼ï¼Ÿ"><a href="#5-åœ¨-Spring-ä¸­ï¼Œæœ‰å‡ ç§é…ç½®-Bean-çš„æ–¹å¼ï¼Ÿ" class="headerlink" title="5 åœ¨ Spring ä¸­ï¼Œæœ‰å‡ ç§é…ç½® Bean çš„æ–¹å¼ï¼Ÿ"></a>5 åœ¨ Spring ä¸­ï¼Œæœ‰å‡ ç§é…ç½® Bean çš„æ–¹å¼ï¼Ÿ</h1><p>ä¸‰ç§ï¼Œåˆ†åˆ«ä¸ºï¼šåŸºäºXMLçš„é…ç½®ã€åŸºäºæ³¨è§£çš„é…ç½®ã€åŸºäºJavaçš„é…ç½®</p><p>1.åŸºäºXMLçš„é…ç½®:</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs applescript">&lt;bean <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;stu&quot;</span> <span class="hljs-built_in">class</span>=<span class="hljs-string">&quot;com.pojo.Student&quot;</span>&gt;<br>       &lt;<span class="hljs-keyword">property</span> <span class="hljs-built_in">name</span>=<span class="hljs-string">&quot;name&quot;</span> value=<span class="hljs-string">&quot;lisi&quot;</span>&gt;&lt;/<span class="hljs-keyword">property</span>&gt;<br>       &lt;<span class="hljs-keyword">property</span> <span class="hljs-built_in">name</span>=<span class="hljs-string">&quot;age&quot;</span> value=<span class="hljs-string">&quot;22&quot;</span>&gt;&lt;/<span class="hljs-keyword">property</span>&gt;<br>   &lt;/bean&gt;<br></code></pre></td></tr></table></figure><p>2.åŸºäºæ³¨è§£çš„é…ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br>Student stu;<br></code></pre></td></tr></table></figure><p>3.åŸºäºjava æ˜¾å¼é…ç½®</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> Clazz <span class="hljs-function"><span class="hljs-title">createClazz</span>(<span class="hljs-params"></span>)</span> &#123;<br><br>Clazz clazz=<span class="hljs-keyword">new</span> Clazz();<br>clazz.setName(<span class="hljs-string">&quot;è‡ªåŠ¨åŒ–ä¸“ä¸š&quot;</span>);<br><span class="hljs-keyword">return</span> clazz;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>çº¿ç¨‹æ± </title>
    <link href="/%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
    <url>/%E7%BA%BF%E7%A8%8B%E6%B1%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="1-çº¿ç¨‹æ± çš„å®šä¹‰"><a href="#1-çº¿ç¨‹æ± çš„å®šä¹‰" class="headerlink" title="1. çº¿ç¨‹æ± çš„å®šä¹‰"></a>1. çº¿ç¨‹æ± çš„å®šä¹‰</h1><p>  çº¿ç¨‹æ± çš„åŸºæœ¬æ€æƒ³è¿˜æ˜¯ä¸€ç§å¯¹è±¡æ± çš„æ€æƒ³ï¼Œå¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ï¼Œé‡Œé¢å­˜æ”¾äº†ä¼—å¤šï¼ˆæœªæ­»äº¡ï¼‰çš„çº¿ç¨‹ï¼Œæ± ä¸­çº¿ç¨‹æ‰§è¡Œè°ƒåº¦ç”±æ± ç®¡ç†å™¨æ¥å¤„ç†ã€‚å½“æœ‰çº¿ç¨‹ä»»åŠ¡æ—¶ï¼Œä»æ± ä¸­å–ä¸€ä¸ªï¼Œæ‰§è¡Œå®Œæˆåçº¿ç¨‹å¯¹è±¡å½’æ± ï¼Œè¿™æ ·å¯ä»¥é¿å…åå¤åˆ›å»ºçº¿ç¨‹å¯¹è±¡æ‰€å¸¦æ¥çš„æ€§èƒ½å¼€é”€ï¼ŒèŠ‚çœäº†ç³»ç»Ÿçš„èµ„æºï¼Œæé«˜äº†ä»£ç æ‰§è¡Œæ•ˆç‡ã€‚<br>  çº¿ç¨‹æ± å’Œå·¥å‚æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼æœ‰å…³ï¼ˆè‡ªå·±ä¸è¦æï¼Œè®¾è®¡æ¨¡å¼æ˜¯ä¸ªå‘ï¼‰</p><h1 id="2-ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„"><a href="#2-ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„" class="headerlink" title="2. ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„"></a>2. ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„</h1><p>1.é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹ï¼Œä»è€Œé™ä½åˆ›å»ºå’Œé”€æ¯çš„æ¶ˆè€—ã€‚<br>2.æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä¸éœ€è¦ç­‰å¾…çº¿ç¨‹åˆ›å»ºï¼Œç›´æ¥å¯ä»¥æ‰§è¡Œä»»åŠ¡ã€‚<br>3.æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚ä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥å®ç°å¯¹çº¿ç¨‹ç»Ÿä¸€åˆ†é…ã€è°ƒä¼˜å’Œç›‘æ§ã€‚</p><h1 id="3-å¸¸ç”¨çš„çº¿ç¨‹æ± æœ‰å“ªäº›"><a href="#3-å¸¸ç”¨çš„çº¿ç¨‹æ± æœ‰å“ªäº›" class="headerlink" title="3. å¸¸ç”¨çš„çº¿ç¨‹æ± æœ‰å“ªäº›"></a>3. å¸¸ç”¨çš„çº¿ç¨‹æ± æœ‰å“ªäº›</h1><ul><li>newCachedThreadPoolï¼šåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çš„çº¿ç¨‹æ± ï¼Œè¯¥çº¿ç¨‹æ± ä¸ä¼šå¯¹çº¿ç¨‹æ± å¤§å°åšé™åˆ¶ï¼Œå®ƒçš„å¤§å°å–å†³äºæ“ä½œç³»ç»Ÿï¼ˆæˆ–JVMï¼‰èƒ½å¤Ÿåˆ›å»ºçš„æœ€å¤§çº¿ç¨‹çš„å¤§å°ã€‚</li><li>newFixedThreadPoolï¼šåˆ›å»ºä¸€ä¸ªå¤§å°å›ºå®šçš„çº¿ç¨‹æ± ï¼Œæ¯æäº¤ä¸€ä¸ªä»»åŠ¡ï¼Œå°±åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œç›´åˆ°è¾¾åˆ°çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹å¤§å°ã€‚</li><li>newScheduledThreadPoolï¼šåˆ›å»ºä¸€ä¸ªæ”¯æŒå®šæ—¶å’Œå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ± ã€‚</li><li>newSingleThreadExecutorï¼šåˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œæ­¤çº¿ç¨‹æ± ä¿è¯æ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡Œé¡ºåºæŒ‰ç…§ä»»åŠ¡çš„æäº¤é¡ºåºæ‰§è¡Œã€‚</li></ul><h1 id="4-çº¿ç¨‹æ± çš„å¯åŠ¨ç­–ç•¥"><a href="#4-çº¿ç¨‹æ± çš„å¯åŠ¨ç­–ç•¥" class="headerlink" title="4. çº¿ç¨‹æ± çš„å¯åŠ¨ç­–ç•¥"></a>4. çº¿ç¨‹æ± çš„å¯åŠ¨ç­–ç•¥</h1><p>å½“è°ƒç”¨executeï¼ˆï¼‰å»æ·»åŠ ä¸€ä¸ªä»»åŠ¡æ—¶ï¼Œçº¿ç¨‹ä¼šåšä»¥ä¸‹åˆ¤æ–­ï¼š </p><ol><li>å¦‚æœæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°å°äºcorePoolSizeï¼ˆæ ¸å¿ƒçº¿ç¨‹æ•°ï¼‰ï¼Œé‚£ä¹ˆé©¬ä¸Šä¼šåˆ›å»ºçº¿ç¨‹æ‰§è¡Œè¿™ä¸ªä»»åŠ¡</li><li>å¦‚æœæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°å¤§äºæˆ–ç­‰äºcorePoolSizeï¼Œé‚£ä¹ˆä¼šå°†è¿™ä¸ªè¿™ä¸ªä»»åŠ¡æ”¾å…¥é˜Ÿåˆ—ã€‚</li><li>å¦‚æœæ­¤æ—¶é˜Ÿåˆ—æ»¡äº†ï¼Œè€Œä¸”æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°å°äºmaximumPoolSize,é‚£ä¹ˆè¿˜æ˜¯è¦åˆ›å»ºçº¿ç¨‹æ‰§è¡Œè¿™ä¸ªä»»åŠ¡</li><li>å¦‚æœæ­¤æ—¶é˜Ÿåˆ—æ»¡äº†ï¼Œè€Œä¸”æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°å¤§äºæˆ–ç­‰äºmaximumPoolSize,é‚£ä¹ˆçº¿ç¨‹æ± ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå‘Šè¯‰è°ƒç”¨è€…æ— æ³•å†æ¥å—ä»»åŠ¡äº†ã€‚</li></ol><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å®Œæˆä»»åŠ¡ï¼Œå®ƒä¼šä»é˜Ÿåˆ—é‡Œå–å‡ºä¸‹ä¸€ä¸ªä»»åŠ¡æ¥æ‰§è¡Œ</li><li>å½“ä¸€ä¸ªçº¿ç¨‹æ— äº‹å¯åšï¼Œè¶…è¿‡ä¸€å®šçš„æ—¶é—´ï¼ˆKeepAliveTimeï¼šçº¿ç¨‹è¢«å›æ”¶å‰çš„ç©ºé—²æ—¶é—´ï¼‰æ—¶ï¼Œçº¿ç¨‹æ± ä¼šåˆ¤æ–­ï¼›å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å¤§äºcorePoolSizeï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å°±ä¼šè¢«åœæ‰ã€‚</li><li>å½“çº¿ç¨‹æ± æ‰€æœ‰ä»»åŠ¡å®Œæˆåï¼Œä»–æœ€ç»ˆä¼šæ”¶ç¼©åˆ°corePoolSizeçš„å¤§å°ã€‚</li></ul><p>(ç±»ä¼¼æ•°æ®åº“çš„è¿æ¥æ•°ï¼Œä¹Ÿéœ€è¦è®¾ç½®maximum-pool-size:)</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Jpaå’Œmybatis</title>
    <link href="/Jpa%E5%92%8Cmybatis/"/>
    <url>/Jpa%E5%92%8Cmybatis/</url>
    
    <content type="html"><![CDATA[<h1 id="1-JPAå’Œmybatisçš„åŒºåˆ«"><a href="#1-JPAå’Œmybatisçš„åŒºåˆ«" class="headerlink" title="1. JPAå’Œmybatisçš„åŒºåˆ«"></a>1. JPAå’Œmybatisçš„åŒºåˆ«</h1><p><strong>åŸºæœ¬æ¦‚å¿µ</strong></p><ul><li><strong>MyBatis</strong>ï¼š<ul><li>æ˜¯ä¸€ä¸ªåŠè‡ªåŠ¨åŒ–çš„æŒä¹…å±‚æ¡†æ¶ï¼Œä¸“æ³¨äº SQL æ˜ å°„å’Œç®¡ç†ã€‚</li><li>æä¾› SQL æŸ¥è¯¢ã€ç»“æœæ˜ å°„å’Œå­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨ï¼Œå…è®¸å¼€å‘è€…ç¼–å†™è‡ªå·±çš„ SQLã€‚</li></ul></li><li><strong>JPA</strong>ï¼š<ul><li>æ˜¯ Java EE å’Œ Java SE çš„æ ‡å‡†è§„èŒƒï¼Œç”¨äºå¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆORMï¼‰ã€‚</li><li>ä¸»è¦å®ç°åŒ…æ‹¬ Hibernateã€spring data jpa å’Œ OpenJPAã€‚</li><li>æä¾›å…¨è‡ªåŠ¨åŒ–çš„ ORM åŠŸèƒ½ï¼Œå¼€å‘è€…é€šå¸¸ä¸éœ€è¦ç¼–å†™ SQLï¼Œè€Œæ˜¯ä¾èµ–äº JPA æä¾›çš„æŠ½è±¡å±‚ã€‚</li></ul></li></ul><p><strong>2. SQL æ“ä½œ</strong></p><ul><li><strong>MyBatis</strong>ï¼š<ul><li>å¼ºè°ƒæ‰‹å†™ SQLï¼Œå¼€å‘è€…æœ‰å®Œå…¨çš„ SQL æ§åˆ¶æƒã€‚</li><li>é€šè¿‡ XML æ–‡ä»¶æˆ–æ³¨è§£å®šä¹‰ SQL æ˜ å°„ã€‚</li><li>æ›´é€‚åˆå¯¹ SQL æœ‰ç»†ç²’åº¦æ§åˆ¶éœ€æ±‚çš„åœºæ™¯ã€‚</li></ul></li><li><strong>JPA</strong>ï¼š<ul><li>ä½¿ç”¨ JPQLï¼ˆJava Persistence Query Languageï¼‰æˆ– Criteria API æŸ¥è¯¢ï¼Œç±»ä¼¼äº SQLï¼Œä½†é¢å‘å¯¹è±¡ã€‚</li><li>å¤æ‚æŸ¥è¯¢ä¸‹å¯ä»¥ä½¿ç”¨QueryDsL å’Œå†™nativeSQL</li><li>æ›´ä¾§é‡äºé€šè¿‡å®ä½“ç±»æ“ä½œæ•°æ®åº“ï¼Œå‡å°‘ç›´æ¥ SQL çš„ç¼–å†™ã€‚</li><li>å¯¹ SQL çš„æ§åˆ¶è¾ƒå°‘ï¼Œä½†æ–¹ä¾¿æ•°æ®æ“ä½œã€‚</li><li>æ›´æ¢æ•°æ®åº“å¹³å°æ–¹ä¾¿</li></ul></li></ul><p><strong>3. é…ç½®å’Œå¤æ‚åº¦</strong></p><ul><li><strong>MyBatis</strong>ï¼š<ul><li>é…ç½®è¾ƒä¸ºç®€å•ï¼Œä¸»è¦é€šè¿‡ XML æ–‡ä»¶æˆ–æ³¨è§£ã€‚</li><li>éœ€è¦æ‰‹åŠ¨ç®¡ç† SQL å’Œå¯¹è±¡æ˜ å°„ï¼Œé€‚åˆå¤æ‚ SQL æˆ–å­˜å‚¨è¿‡ç¨‹çš„é¡¹ç›®ã€‚</li></ul></li><li><strong>JPA</strong>ï¼š<ul><li>é…ç½®ç›¸å¯¹å¤æ‚ï¼Œä¾èµ–äºå®ä½“ç±»ã€å…³ç³»æ˜ å°„å’ŒæŒä¹…åŒ–å•å…ƒé…ç½®ã€‚</li><li>é€šè¿‡æ³¨è§£æˆ– XML æ–‡ä»¶å®šä¹‰å®ä½“ç±»åŠå…¶å…³ç³»ï¼Œè‡ªåŠ¨ç®¡ç†å®ä½“çš„ç”Ÿå‘½å‘¨æœŸã€‚</li></ul></li></ul><p><strong>4 æ€§èƒ½å’Œçµæ´»æ€§</strong></p><ul><li><strong>MyBatis</strong>ï¼š<ul><li>æ€§èƒ½è¾ƒå¥½ï¼Œå°¤å…¶åœ¨å¤æ‚æŸ¥è¯¢å’Œæ‰¹é‡æ“ä½œæ–¹é¢ã€‚</li><li>çµæ´»æ€§é«˜ï¼Œå¼€å‘è€…å¯ä»¥ä¼˜åŒ–æ¯ä¸ª SQL è¯­å¥ã€‚</li></ul></li><li><strong>JPA</strong>ï¼š<ul><li>æä¾›ç¼“å­˜æœºåˆ¶ï¼ˆä¸€çº§å’ŒäºŒçº§ç¼“å­˜ï¼‰å’Œå»¶è¿ŸåŠ è½½ï¼Œæé«˜æ€§èƒ½ã€‚</li><li>æ€§èƒ½å— ORM å±‚æ¬¡çš„å½±å“è¾ƒå¤§ï¼Œé€‚åˆ CRUD æ“ä½œè¾ƒå¤šçš„åº”ç”¨ã€‚</li></ul></li></ul><p><strong>5. å­¦ä¹ æ›²çº¿</strong></p><ul><li><strong>MyBatis</strong>ï¼š<ul><li>å­¦ä¹ æ›²çº¿è¾ƒå¹³ç¼“ï¼ŒSQL å’Œæ˜ å°„é…ç½®ç®€å•ç›´è§‚ã€‚</li><li>é€‚åˆæœ‰ SQL åŸºç¡€çš„å¼€å‘è€…ã€‚</li></ul></li><li><strong>JPA</strong>ï¼š<ul><li>å­¦ä¹ æ›²çº¿è¾ƒé™¡ï¼Œéœ€è¦æŒæ¡ JPA è§„èŒƒå’Œé¢å‘å¯¹è±¡çš„æ•°æ®åº“æ“ä½œæ–¹æ³•ã€‚</li><li>é€‚åˆéœ€è¦é«˜å±‚æ¬¡æŠ½è±¡å’Œè‡ªåŠ¨åŒ–ç®¡ç†çš„é¡¹ç›®ã€‚</li></ul></li></ul><p><strong>6 é€‚ç”¨åœºæ™¯</strong></p><ul><li><strong>MyBatis</strong>ï¼š<ul><li>é€‚ç”¨äºéœ€è¦é¢‘ç¹ç¼–å†™å¤æ‚ SQL çš„é¡¹ç›®ã€‚</li><li>é€‚åˆå¯¹ SQL è¯­å¥æœ‰ç²¾ç»†æ§åˆ¶è¦æ±‚çš„åº”ç”¨ã€‚</li></ul></li><li><strong>JPA</strong>ï¼š<ul><li>é€‚ç”¨äºæ ‡å‡†åŒ– CRUD æ“ä½œè¾ƒå¤šçš„ä¼ä¸šçº§åº”ç”¨ã€‚</li><li>é€‚åˆéœ€è¦ ORM ç‰¹æ€§å’Œé¢å‘å¯¹è±¡æ•°æ®åº“æ“ä½œçš„é¡¹ç›®ã€‚</li></ul></li></ul><h1 id="2-Mybatis-åŠ¨æ€-sql-æ¦‚å¿µ"><a href="#2-Mybatis-åŠ¨æ€-sql-æ¦‚å¿µ" class="headerlink" title="2. Mybatis åŠ¨æ€ sql æ¦‚å¿µ"></a>2. Mybatis åŠ¨æ€ sql æ¦‚å¿µ</h1><p>æ‘†è„±æ ¹æ®ä¸åŒæ¡ä»¶æ‹¼æ¥ SQL è¯­å¥çš„ç—›è‹¦ï¼Œä¾‹å¦‚æ‹¼æ¥æ—¶è¦ç¡®ä¿ä¸èƒ½å¿˜è®°æ·»åŠ å¿…è¦çš„ç©ºæ ¼ï¼Œè¿˜è¦æ³¨æ„å»æ‰åˆ—è¡¨æœ€åä¸€ä¸ªåˆ—åçš„é€—å·ã€‚MyBatis ä¸­ç”¨äºå®ç°åŠ¨æ€ SQL çš„å…ƒç´ ä¸»è¦æœ‰ï¼š</p><ol><li><p>if è¯­å¥ (ç®€å•çš„æ¡ä»¶åˆ¤æ–­)</p></li><li><p>choose (when,otherwize) ,ç›¸å½“äº java è¯­è¨€ä¸­çš„ switch ,ä¸ jstl ä¸­çš„choose å¾ˆç±»ä¼¼.</p></li><li><p>where (ä¸»è¦æ˜¯ç”¨æ¥ç®€åŒ– sql è¯­å¥ä¸­ where æ¡ä»¶åˆ¤æ–­çš„ï¼Œèƒ½æ™ºèƒ½çš„å¤„ç† and or , ä¸å¿…æ‹…å¿ƒå¤šä½™å¯¼è‡´è¯­æ³•é”™è¯¯)</p></li><li><p>set (ä¸»è¦ç”¨äºæ›´æ–°æ—¶ï¼ŒåŠŸèƒ½å’Œ where æ ‡ç­¾å…ƒç´ å·®ä¸å¤šï¼Œä¸»è¦æ˜¯åœ¨åŒ…å«çš„è¯­å¥å‰è¾“å‡ºä¸€ä¸ª setï¼Œç„¶åå¦‚æœåŒ…å«çš„è¯­å¥æ˜¯ä»¥é€—å·ç»“æŸçš„è¯å°†ä¼šæŠŠè¯¥é€—å·å¿½ç•¥ï¼Œå¦‚æœ set æ ‡ç­¾æœ€ç»ˆè¿”å›çš„å†…å®¹ä¸ºç©ºçš„è¯åˆ™å¯èƒ½ä¼šå‡ºé”™ï¼ˆ update set name &#x3D; #{name}, where â€¦ ? )</p></li><li><p>trim (trim å…ƒç´ çš„ä¸»è¦åŠŸèƒ½æ˜¯å¯ä»¥åœ¨è‡ªå·±åŒ…å«çš„å†…å®¹å‰åŠ ä¸ŠæŸäº›å‰ç¼€ï¼Œä¹Ÿå¯ä»¥åœ¨å…¶ååŠ ä¸ŠæŸäº›åç¼€ï¼Œä¸ä¹‹å¯¹åº”çš„å±æ€§æ˜¯ prefix å’Œ suffixï¼›å¯ä»¥æŠŠåŒ…å«å†…å®¹çš„é¦–éƒ¨æŸäº›å†…å®¹è¦†ç›–ï¼Œå³å¿½ç•¥ï¼Œä¹Ÿå¯ä»¥æŠŠå°¾éƒ¨çš„æŸäº›å†…å®¹è¦†ç›–ï¼Œå¯¹åº”çš„å±æ€§æ˜¯ prefixOverrides å’Œ suffixOverridesï¼›æ­£å› ä¸º trim æœ‰è¿™æ ·çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥ç”¨æ¥å®ç° where å’Œ set çš„æ•ˆæœ)</p></li><li><p>foreach (javaä¸­æœ‰for, å¯é€šè¿‡forå¾ªç¯ï¼Œ åŒæ ·ï¼Œ mybatisä¸­æœ‰foreach, å¯é€šè¿‡å®ƒå®ç°å¾ªç¯ï¼Œå¾ªç¯çš„å¯¹è±¡å½“ç„¶ä¸»è¦æ˜¯javaé›†åˆæˆ–æ•°ç»„ã€‚)</p></li></ol>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>jpaçš„æ‰¹é‡ä¼˜åŒ–</title>
    <link href="/jpa%E7%9A%84%E6%89%B9%E9%87%8F%E4%BC%98%E5%8C%96/"/>
    <url>/jpa%E7%9A%84%E6%89%B9%E9%87%8F%E4%BC%98%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="1-é—®é¢˜"><a href="#1-é—®é¢˜" class="headerlink" title="1. é—®é¢˜"></a>1. é—®é¢˜</h1><p>Spring-data-jpaè‡ªå·±å¸¦çš„JpaRepositoryé‡Œæœ‰å¾ˆå¤šç°æœ‰çš„æ–¹æ³•ï¼Œå¦‚findAll, saveAll, deleteAll ,ä½†æ˜¯saveAll å’ŒdeleteAll è¿™ç§åº•å±‚éƒ½æ˜¯foreachçš„saveæˆ–è€…deleteçš„ï¼Œæ€§èƒ½éå¸¸ä½</p><h1 id="2-ä¼˜åŒ–"><a href="#2-ä¼˜åŒ–" class="headerlink" title="2. ä¼˜åŒ–"></a>2. ä¼˜åŒ–</h1><p>å¯ä»¥é€šè¿‡é…ç½®<code>hibernate.jdbc.batch_size</code>çš„æ–¹å¼ï¼Œ å°†è¿™äº›æ’å…¥æ“ä½œæ‰“åŒ…æˆä¸€ä¸ªæ‰¹å¤„ç†æ“ä½œï¼Œç„¶åä¸€æ¬¡æ€§å‘é€åˆ°æ•°æ®åº“æ‰§è¡Œã€‚</p><p>è¿™æ ·åšå¯ä»¥å‡å°‘é€šä¿¡æˆæœ¬å’Œäº‹åŠ¡å¼€é”€ï¼Œæé«˜æ€§èƒ½ã€‚ä½†ä¾æ—§ä¸å¤Ÿï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±å†™SQLå¤„ç†å™¨</p><p>åŸºäºPGï¼š</p><h2 id="2-1-insert"><a href="#2-1-insert" class="headerlink" title="2.1 insert"></a>2.1 insert</h2><p>åŸç†ï¼š <code>insert into %s (%s) values %s;</code></p><p>æ³¨æ„ï¼š</p><ul><li><p>éœ€è¦è‡ªå·±ç”ŸæˆIDï¼Œ æœ‰ä¸€å¼ è¡¨ç»´æŠ¤ä¸åŒä¸šåŠ¡è¡¨çš„id_valueåºå·ï¼Œæ ¹æ®å½“å‰ä¸šåŠ¡è¡¨ï¼ŒæŸ¥è¯¢å‡ºå½“å‰id_value, å°†å½“å‰id_value+ LIst.size+1 ä½œä¸ºè¦æ›´æ–°çš„æ–°id_value, æ›´æ–°æˆåŠŸçš„è¯ï¼Œåˆ™å°†ä¹‹å‰æŸ¥è¯¢å‡ºæ¥çš„id_value+1å’Œæœ€æ–°id_valueè¿”å›</p><p><code>update id_value=</code>id_value+ LIst.size+1 where id_value&#x3D;id_value &#96; åˆ©ç”¨CAS</p></li><li><p>è·å–idå¤±è´¥çš„è¯ï¼Œretryä¸€æ¬¡</p></li></ul><h2 id="2-2-update"><a href="#2-2-update" class="headerlink" title="2.2 update"></a>2.2 update</h2><p>åŸç†ï¼š <code>update %s set %s from (values %s) as tmp (%s) where %s.id=tmp.id;</code></p><p>æŠŠfieldsä¼ è¿‡å»ï¼Œ ä¸ä¼ é»˜è®¤æ›´æ–°æ‰€æœ‰</p><p>è¿™é‡Œå°±éœ€è¦æ›´æ–°å½“å‰æ‰€æœ‰çš„fieldsï¼Œ æ„å»ºçš„entityä¸­ä¹‹é¥æŸä¸ªæœ‰è¿™ä¸ªfieldsï¼Œå°±å¾—éƒ½åŠ ä¸Š</p><p>SQLæ‰§è¡Œå¯èƒ½æœ‰é•¿åº¦å’Œè¡Œæ•°é™åˆ¶</p><p>æ¯æ¬¡ä»listé‡Œå–å¯¹è±¡è¿›è¡ŒSQLæ‹¼æ¥æ—¶ï¼Œéƒ½æ£€æŸ¥ä¸‹å½“å‰å‰©ä½™é•¿åº¦æ˜¯å¦å¤Ÿç”¨ï¼Œä»¥åŠå½“å‰è¡Œæ•°æ˜¯å¦è¶…è¿‡é™åˆ¶</p><p>ä¸å¤Ÿçš„è¯ï¼Œå†æ–°æ„å»ºä¸€ä¸ªSQLå°†å‰©ä¸‹çš„éƒ¨åˆ†æ‹¼æ¥è¿›å»</p><p>è¿™æ¬¡çš„ä¼˜åŒ–é€Ÿåº¦æé«˜ï¼Œæ˜¯å€æ•°å¢é•¿çš„ï¼Œå› ä¸ºä¹‹å‰éœ€è¦å¤šä¸ªSQLï¼Œå¤šæ¬¡è¿æ¥å¤šæ¬¡æ‰§è¡Œï¼Œä¸‹è½½éƒ½ä¼˜åŒ–æˆäº†ä¸€æ¬¡</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æ»‘åŠ¨çª—å£</title>
    <link href="/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/"/>
    <url>/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="1-åº”ç”¨åœºæ™¯"><a href="#1-åº”ç”¨åœºæ™¯" class="headerlink" title="1. åº”ç”¨åœºæ™¯"></a>1. åº”ç”¨åœºæ™¯</h1><p>å…³é”®è¯ï¼š</p><ol><li>æ»¡è¶³XXXæ¡ä»¶ï¼ˆè®¡ç®—ç»“æœï¼Œå‡ºç°æ¬¡æ•°ï¼ŒåŒæ—¶åŒ…å«ï¼‰</li><li>æœ€é•¿&#x2F;æœ€çŸ­</li><li>å­ä¸²&#x2F;å­æ•°ç»„&#x2F;å­åºåˆ—</li></ol><p>Egï¼šé•¿åº¦æœ€å°çš„å­æ•°ç»„</p><h1 id="2-ä½¿ç”¨æ€è·¯"><a href="#2-ä½¿ç”¨æ€è·¯" class="headerlink" title="2. ä½¿ç”¨æ€è·¯"></a>2. ä½¿ç”¨æ€è·¯</h1><h2 id="1-å¯»æ‰¾æœ€é•¿"><a href="#1-å¯»æ‰¾æœ€é•¿" class="headerlink" title="1. å¯»æ‰¾æœ€é•¿"></a>1. å¯»æ‰¾æœ€é•¿</h2><p>å·¦å³åŒæŒ‡é’ˆï¼ˆLï¼ŒRï¼‰åœ¨èµ·å§‹ç‚¹ï¼ŒRå‘å³é€ä½æ»‘åŠ¨å¾ªç¯</p><p>â€”â€”æ¯æ¬¡æ»‘åŠ¨è¿‡ç¨‹ä¸­</p><ul><li>çª—å†…å…ƒç´ æ»¡è¶³æ¡ä»¶ï¼ŒRå‘å³æ‰©å¤§çª—å£ï¼Œå¹¶æ›´æ–°æœ€ä¼˜ç»“æœ</li><li>çª—å†…å…ƒç´ ä¸æ»¡è¶³æ¡ä»¶ï¼ŒLå‘å³ç¼©å°çª—å£</li></ul><p>â€”â€”Råˆ°è¾¾ç»“å°¾</p><h2 id="2-æ¨¡ç‰ˆ"><a href="#2-æ¨¡ç‰ˆ" class="headerlink" title="2. æ¨¡ç‰ˆ"></a>2. æ¨¡ç‰ˆ</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span> åˆå§‹åŒ– left, right,  currentResult, bestResult<br><span class="hljs-bullet">2.</span> while (å³æŒ‡é’ˆæ²¡æœ‰åˆ°è¾¾ç»“å°¾) &#123;<br><span class="hljs-code">     åŠ å…¥rightå¯¹åº”å…ƒç´ çš„å€¼ï¼Œæ›´æ–°currentResult</span><br><span class="hljs-code">     while (currentResult ä¸æ»¡è¶³è¦æ±‚) &#123;</span><br><span class="hljs-code">        1 çª—å£ç¼©å°ï¼Œleftå³ç§» left++;</span><br><span class="hljs-code">    &#125;</span><br><span class="hljs-code">    1ã€‹æ›´æ–°æœ€ä¼˜ç»“æœ bestResult</span><br><span class="hljs-code">    2ã€‹çª—å£æ‰©å¤§ rightå³ç§» right++;</span><br><span class="hljs-code">   &#125;</span><br><span class="hljs-code">3. è¿”å›bestResult</span><br></code></pre></td></tr></table></figure><h2 id="3-ä¾‹é¢˜"><a href="#3-ä¾‹é¢˜" class="headerlink" title="3. ä¾‹é¢˜"></a>3. ä¾‹é¢˜</h2><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² <code>s</code> ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ <strong>æœ€é•¿ å­ä¸²</strong> çš„é•¿åº¦ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MaxLengthOfSubString</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxLengthOfSubString</span><span class="hljs-params">(String s)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (s.length() == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>        <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">int</span> right = <span class="hljs-number">0</span>;<br>        HashMap&lt;Character, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap();<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; s.length(); i++) &#123;<br>            <span class="hljs-keyword">if</span> (map.containsKey(s.charAt(i))) &#123;<br>                left = Math.max(left, map.get(s.charAt(i)) + <span class="hljs-number">1</span>);<br>            &#125;<br>            map.put(s.charAt(i), i);<br>            right = Math.max(right, i - left + <span class="hljs-number">1</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> right;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        String s = <span class="hljs-string">&quot;abcabcbb&quot;</span>;<br>        <span class="hljs-keyword">int</span> i = maxLengthOfSubString(s);<br>        System.out.println(i);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-å¯»æ‰¾æœ€çŸ­"><a href="#2-å¯»æ‰¾æœ€çŸ­" class="headerlink" title="2. å¯»æ‰¾æœ€çŸ­"></a>2. å¯»æ‰¾æœ€çŸ­</h2><p>å·¦å³åŒæŒ‡é’ˆï¼ˆLï¼ŒRï¼‰åœ¨èµ·å§‹ç‚¹ï¼ŒRå‘å³é€ä½æ»‘åŠ¨å¾ªç¯</p><p>â€”â€”æ¯æ¬¡æ»‘åŠ¨è¿‡ç¨‹ä¸­</p><ul><li>çª—å†…å…ƒç´ æ»¡è¶³æ¡ä»¶ï¼ŒLå‘å³ç¼©å°çª—å£ï¼Œå¹¶æ›´æ–°æœ€ä¼˜ç»“æœ</li><li>çª—å†…å…ƒç´ ä¸æ»¡è¶³æ¡ä»¶ï¼ŒRå‘å³æ‰©å¤§çª—å£</li></ul><p>â€”â€”Råˆ°è¾¾ç»“å°¾</p><h2 id="2-æ¨¡ç‰ˆ-1"><a href="#2-æ¨¡ç‰ˆ-1" class="headerlink" title="2. æ¨¡ç‰ˆ"></a>2. æ¨¡ç‰ˆ</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span> åˆå§‹åŒ– left, right,  currentResult, bestResult<br><span class="hljs-bullet">2.</span> while (å³æŒ‡é’ˆæ²¡æœ‰åˆ°è¾¾ç»“å°¾) &#123;<br><span class="hljs-code">     åŠ å…¥rightå¯¹åº”å…ƒç´ çš„å€¼ï¼Œæ›´æ–°currentResult</span><br><span class="hljs-code">     while (currentResult æ»¡è¶³è¦æ±‚) &#123;</span><br><span class="hljs-code">        1ã€‹æ›´æ–°æœ€ä¼˜ç»“æœ bestResult</span><br><span class="hljs-code">        2ã€‹ç§»é™¤leftå¯¹åº”å…ƒç´ çš„å€¼</span><br><span class="hljs-code">        3ã€‹çª—å£ç¼©å°ï¼Œleftå³ç§» left++;</span><br><span class="hljs-code">    &#125;</span><br><span class="hljs-code">    çª—å£æ‰©å¤§ rightå³ç§» right++;</span><br><span class="hljs-code">   &#125;</span><br><span class="hljs-code">3. è¿”å›bestResult</span><br></code></pre></td></tr></table></figure><h2 id="3-ä¾‹é¢˜-1"><a href="#3-ä¾‹é¢˜-1" class="headerlink" title="3. ä¾‹é¢˜"></a>3. ä¾‹é¢˜</h2><p>ç»™å®šä¸€ä¸ªå«æœ‰ <code>n</code> ä¸ªæ­£æ•´æ•°çš„æ•°ç»„å’Œä¸€ä¸ªæ­£æ•´æ•° <code>target</code> <strong>ã€‚</strong></p><p>æ‰¾å‡ºè¯¥æ•°ç»„ä¸­æ»¡è¶³å…¶æ€»å’Œå¤§äºç­‰äº <code>target</code> çš„é•¿åº¦æœ€å°çš„ <strong>è¿ç»­</strong></p><p><strong>å­æ•°ç»„</strong></p><p><code>[numsl, numsl+1, ..., numsr-1, numsr]</code> ï¼Œå¹¶è¿”å›å…¶é•¿åº¦<strong>ã€‚</strong>å¦‚æœä¸å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„å­æ•°ç»„ï¼Œè¿”å› <code>0</code> ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minSubArrayLen</span><span class="hljs-params">(<span class="hljs-keyword">int</span> target, <span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;<br>     <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">int</span> right = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">int</span> minLength = Integer.MAX_VALUE;<br>        <span class="hljs-keyword">int</span> curSum = <span class="hljs-number">0</span>;<br><br>        <span class="hljs-keyword">int</span> sLength = nums.length;<br>        <span class="hljs-keyword">if</span> (sLength == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>        <span class="hljs-keyword">while</span> (right &lt; sLength) &#123;<br>            curSum += nums[right];<br>            <span class="hljs-keyword">while</span> (curSum &gt;= target) &#123;<br>                minLength = Math.min(minLength, right - left + <span class="hljs-number">1</span>);<br>                curSum -= nums[left];<br>                left++;<br>            &#125;<br>            right++;<br>        &#125;<br>        <span class="hljs-keyword">return</span> minLength == Integer.MAX_VALUE ? <span class="hljs-number">0</span>: minLength;<br>    &#125;   <br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åŒæ­¥é˜»å¡ä¸å¼‚æ­¥éé˜»å¡çš„æ•´ç†</title>
    <link href="/%E5%90%8C%E6%AD%A5%E9%98%BB%E5%A1%9E%E4%B8%8E%E5%BC%82%E6%AD%A5%E9%9D%9E%E9%98%BB%E5%A1%9E%E7%9A%84%E6%95%B4%E7%90%86/"/>
    <url>/%E5%90%8C%E6%AD%A5%E9%98%BB%E5%A1%9E%E4%B8%8E%E5%BC%82%E6%AD%A5%E9%9D%9E%E9%98%BB%E5%A1%9E%E7%9A%84%E6%95%B4%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h2 id="1-BIO-å’ŒNIO"><a href="#1-BIO-å’ŒNIO" class="headerlink" title="1. BIO å’ŒNIO"></a>1. BIO å’ŒNIO</h2><p>BIOï¼ˆBlocking I&#x2F;Oï¼‰å’Œ NIOï¼ˆNon-blocking I&#x2F;Oï¼‰æ˜¯ Java ä¸­ç”¨äºå¤„ç† I&#x2F;O æ“ä½œçš„ä¸¤ç§ä¸åŒçš„ç¼–ç¨‹æ¨¡å‹ã€‚</p><p><strong>BIOï¼ˆBlocking I&#x2F;Oï¼‰</strong>ï¼š</p><ol><li><strong>åŒæ­¥é˜»å¡</strong>ï¼šåœ¨ BIO æ¨¡å‹ä¸­ï¼ŒI&#x2F;O æ“ä½œæ˜¯åŒæ­¥é˜»å¡çš„ã€‚å½“ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€ä¸ª I&#x2F;O æ“ä½œæ—¶ï¼Œçº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°è¿™ä¸ª I&#x2F;O æ“ä½œå®Œæˆå¹¶è¿”å›ç»“æœã€‚</li><li><strong>é˜»å¡ç­‰å¾…</strong>ï¼šå½“æ‰§è¡Œ I&#x2F;O æ“ä½œæ—¶ï¼ŒBIO ä¼šè®©çº¿ç¨‹ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°æ“ä½œå®Œæˆã€‚è¿™æ ·ä¼šå¯¼è‡´çº¿ç¨‹è¢«æµªè´¹æ‰ï¼Œä¸èƒ½æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œé€ æˆèµ„æºçš„æµªè´¹å’Œä½æ•ˆç‡ã€‚</li><li><strong>ä¼ ç»Ÿçš„ I&#x2F;O æ¨¡å‹</strong>ï¼šåœ¨ä¼ ç»Ÿçš„ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ BIO æ¨¡å‹ã€‚æ¯ä¸ªå®¢æˆ·ç«¯è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥å¤„ç†ï¼Œå½“è¿æ¥æ•°é‡å¢åŠ æ—¶ï¼Œä¼šå¯¼è‡´æœåŠ¡å™¨èµ„æºæ¶ˆè€—è¿‡å¤šï¼Œæ€§èƒ½ä¸‹é™ã€‚</li></ol><p><strong>NIOï¼ˆNon-blocking I&#x2F;Oï¼‰</strong>ï¼š</p><ol><li><strong>å¼‚æ­¥éé˜»å¡</strong>ï¼šNIO æ¨¡å‹æ˜¯ä¸€ç§å¼‚æ­¥éé˜»å¡çš„ I&#x2F;O æ¨¡å‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€ä¸ª I&#x2F;O æ“ä½œæ—¶ï¼Œçº¿ç¨‹ä¸ä¼šè¢«é˜»å¡ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚å½“ I&#x2F;O æ“ä½œå®Œæˆåï¼Œä¼šé€šè¿‡å›è°ƒæˆ–è€…å…¶ä»–æ–¹å¼æ¥å¤„ç†ç»“æœã€‚</li><li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šNIO æ¨¡å‹é‡‡ç”¨äº‹ä»¶é©±åŠ¨çš„æ–¹å¼å¤„ç†å¼‚æ­¥æ“ä½œã€‚å½“æŸä¸ª I&#x2F;O äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œä¼šè§¦å‘ç›¸åº”çš„äº‹ä»¶å¤„ç†å™¨æˆ–è€…å›è°ƒå‡½æ•°ã€‚</li><li><strong>é€šé“å’Œç¼“å†²åŒº</strong>ï¼šNIO æ¨¡å‹å¼•å…¥äº†é€šé“ï¼ˆChannelï¼‰å’Œç¼“å†²åŒºï¼ˆBufferï¼‰çš„æ¦‚å¿µï¼Œå¯ä»¥æ›´çµæ´»åœ°è¿›è¡Œæ•°æ®è¯»å†™æ“ä½œã€‚</li></ol><p><strong>æ€»ç»“</strong>ï¼š</p><ul><li>BIO é€‚ç”¨äºè¿æ¥æ•°è¾ƒå°‘ä¸”å¯¹å¹¶å‘æ€§èƒ½è¦æ±‚ä¸é«˜çš„åœºæ™¯ï¼Œä½†æ˜¯å½“è¿æ¥æ•°é‡å¢åŠ æ—¶ï¼Œä¼šå¯¼è‡´èµ„æºæ¶ˆè€—è¿‡å¤šï¼Œæ€§èƒ½ä¸‹é™ã€‚</li><li>NIO é€‚ç”¨äºéœ€è¦å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚ã€å¼‚æ­¥æ“ä½œå’Œäº‹ä»¶é©±åŠ¨çš„åœºæ™¯ï¼Œèƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°åˆ©ç”¨ç³»ç»Ÿèµ„æºï¼Œå¹¶æé«˜å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚ NIO æ¨¡å‹æ˜¯ Java NIO åŒ…ä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œç”¨äºæ„å»ºé«˜æ€§èƒ½çš„ç½‘ç»œæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚</li></ul><h2 id="2-é˜»å¡ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹"><a href="#2-é˜»å¡ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹" class="headerlink" title="2. é˜»å¡ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹"></a>2. é˜»å¡ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹</h2><p>å“åº”å¼ç¼–ç¨‹ï¼ˆReactive Programmingï¼‰æ˜¯ä¸€ç§åŸºäºæ•°æ®æµå’Œå˜åŒ–ä¼ æ’­çš„ç¼–ç¨‹èŒƒå¼ï¼Œæ—¨åœ¨å¤„ç†å¼‚æ­¥æ•°æ®æµå’Œäº‹ä»¶é©±åŠ¨çš„ç¼–ç¨‹åœºæ™¯ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†ç³»ç»Ÿä¸­çš„æ•°æ®æµå’Œäº‹ä»¶æŠ½è±¡ä¸ºæµï¼ˆStreamï¼‰ï¼Œå¹¶é€šè¿‡ä¸€ç³»åˆ—çš„æ“ä½œç¬¦æ¥å¤„ç†è¿™äº›æµï¼Œå®ç°å¯¹æ•°æ®æµçš„å¼‚æ­¥å¤„ç†ã€ç»„åˆå’Œè½¬æ¢ã€‚</p><p>åœ¨å“åº”å¼ç¼–ç¨‹ä¸­ï¼Œå¸¸è§çš„è§’è‰²åŒ…æ‹¬ï¼š</p><ol><li><strong>æ•°æ®æºï¼ˆData Sourceï¼‰</strong>ï¼šäº§ç”Ÿæ•°æ®æµçš„æºå¤´ï¼Œå¯ä»¥æ˜¯ç”¨æˆ·è¾“å…¥ã€ç½‘ç»œè¯·æ±‚ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ã€‚</li><li><strong>æµï¼ˆStreamï¼‰</strong>ï¼šä»£è¡¨ä¸€ç³»åˆ—è¿ç»­çš„æ•°æ®é¡¹ï¼Œå¯ä»¥æ˜¯åŒæ­¥çš„ä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥çš„ã€‚æµå¯ä»¥å‘å‡ºæ•°æ®é¡¹ã€é”™è¯¯æˆ–è€…å®Œæˆä¿¡å·ã€‚</li><li><strong>è§‚å¯Ÿè€…ï¼ˆObserverï¼‰</strong>ï¼šè®¢é˜…æµå¹¶å¯¹æµä¸­çš„æ•°æ®é¡¹è¿›è¡Œå¤„ç†çš„ç»„ä»¶ï¼Œå®ƒä¼šæ¥æ”¶æ¥è‡ªæµçš„é€šçŸ¥ï¼Œå¹¶å®šä¹‰å¯¹æ•°æ®çš„å¤„ç†é€»è¾‘ã€‚</li><li><strong>æ“ä½œç¬¦ï¼ˆOperatorï¼‰</strong>ï¼šç”¨äºå¯¹æµè¿›è¡Œè½¬æ¢ã€è¿‡æ»¤ã€æ˜ å°„ç­‰æ“ä½œçš„å‡½æ•°æˆ–è€…æ–¹æ³•ã€‚æ“ä½œç¬¦å¯ä»¥é“¾å¼ç»„åˆï¼Œå½¢æˆå¤æ‚çš„æ•°æ®å¤„ç†é€»è¾‘ã€‚</li></ol><p>å“åº”å¼ç¼–ç¨‹å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li><strong>å¼‚æ­¥éé˜»å¡</strong>ï¼šå“åº”å¼ç¼–ç¨‹é€šè¿‡å¼‚æ­¥å’Œéé˜»å¡çš„æ–¹å¼å¤„ç†æ•°æ®æµï¼Œèƒ½å¤Ÿæ›´é«˜æ•ˆåœ°åˆ©ç”¨ç³»ç»Ÿèµ„æºï¼Œå¹¶æé«˜å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</li><li><strong>æ•°æ®æµå¤„ç†</strong>ï¼šå“åº”å¼ç¼–ç¨‹å°†æ•´ä¸ªåº”ç”¨ç¨‹åºçœ‹ä½œæ˜¯ä¸€ä¸ªæ•°æ®æµçš„å¤„ç†ç®¡é“ï¼Œå¯ä»¥åœ¨æ•°æ®æµä¸­åº”ç”¨å„ç§æ“ä½œç¬¦æ¥å®ç°æ•°æ®çš„è½¬æ¢ã€è¿‡æ»¤å’Œèšåˆã€‚</li><li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šå“åº”å¼ç¼–ç¨‹æ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œå®ƒé€šè¿‡è®¢é˜…äº‹ä»¶æµæ¥å¤„ç†å¼‚æ­¥äº‹ä»¶ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè§‚å¯Ÿè€…ä¼šæ”¶åˆ°é€šçŸ¥å¹¶è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</li><li><strong>èƒŒå‹å¤„ç†</strong>ï¼šå“åº”å¼ç¼–ç¨‹ä¸­é€šå¸¸ä¼šå¤„ç†æ•°æ®æµä¸­çš„èƒŒå‹ï¼ˆBackpressureï¼‰ï¼Œå³å½“æ•°æ®ç”Ÿäº§é€Ÿç‡å¤§äºæ¶ˆè´¹é€Ÿç‡æ—¶çš„å¤„ç†æœºåˆ¶ï¼Œä»¥é¿å…å†…å­˜æº¢å‡ºå’Œç³»ç»Ÿå´©æºƒã€‚</li></ul><p>å“åº”å¼ç¼–ç¨‹åœ¨å¤„ç†ç°ä»£åº”ç”¨ç¨‹åºä¸­çš„å¤æ‚æ•°æ®æµå’Œäº‹ä»¶é©±åŠ¨åœºæ™¯ä¸­å…·æœ‰å¾ˆå¥½çš„é€‚ç”¨æ€§ï¼Œä¾‹å¦‚ç½‘ç»œé€šä¿¡ã€å®æ—¶æ•°æ®å¤„ç†ã€ç”¨æˆ·ç•Œé¢äº¤äº’ç­‰ã€‚å¸¸è§çš„å“åº”å¼ç¼–ç¨‹åº“åŒ…æ‹¬ Reactorã€RxJavaã€Project Reactor ç­‰ã€‚</p><h2 id="3-webFlux"><a href="#3-webFlux" class="headerlink" title="3. webFlux"></a>3. webFlux</h2><p>WebFlux æ˜¯ Spring Framework 5 ä¸­å¼•å…¥çš„å“åº”å¼ç¼–ç¨‹çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œç”¨äºæ„å»ºåŸºäºå“åº”å¼ç¼–ç¨‹æ¨¡å‹çš„ Web åº”ç”¨ç¨‹åºã€‚å®ƒæä¾›äº†ä¸€ç§åŸºäº Reactor çš„éé˜»å¡ç¼–ç¨‹æ¨¡å‹ï¼Œèƒ½å¤Ÿå¤„ç†å¤§é‡å¹¶å‘çš„è¯·æ±‚ï¼Œå¹¶æä¾›äº†é«˜æ€§èƒ½å’Œé«˜ååé‡çš„ç‰¹æ€§ã€‚</p><p>WebFlux çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p><ol><li><strong>éé˜»å¡ I&#x2F;O</strong>ï¼šWebFlux ä½¿ç”¨äº† Reactor åº“æä¾›çš„éé˜»å¡ I&#x2F;O æ¨¡å‹ï¼Œèƒ½å¤Ÿæ›´é«˜æ•ˆåœ°åˆ©ç”¨ç³»ç»Ÿèµ„æºï¼Œå¹¶æ”¯æŒå¤„ç†å¤§é‡å¹¶å‘çš„è¯·æ±‚ã€‚</li><li><strong>å“åº”å¼ç¼–ç¨‹æ¨¡å‹</strong>ï¼šWebFlux åŸºäºå“åº”å¼ç¼–ç¨‹æ¨¡å‹ï¼Œä½¿ç”¨ Flux å’Œ Mono æ¥è¡¨ç¤ºå¼‚æ­¥çš„æ•°æ®æµå’Œæ“ä½œã€‚Flux è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªå…ƒç´ çš„å¼‚æ­¥åºåˆ—ï¼Œè€Œ Mono è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªåŒ…å«é›¶ä¸ªæˆ–ä¸€ä¸ªå…ƒç´ çš„å¼‚æ­¥ç»“æœã€‚</li><li><strong>å‡½æ•°å¼é£æ ¼çš„è·¯ç”±å’Œå¤„ç†å™¨</strong>ï¼šWebFlux æä¾›äº†ä¸€ç§å‡½æ•°å¼é£æ ¼çš„è·¯ç”±å’Œå¤„ç†å™¨ APIï¼Œå¯ä»¥é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼æ¥å®šä¹‰è·¯ç”±è§„åˆ™å’Œè¯·æ±‚å¤„ç†é€»è¾‘ã€‚</li><li><strong>ååº”å¼çš„æ ¸å¿ƒç»„ä»¶</strong>ï¼šä½œä¸º Spring Framework çš„ä¸€éƒ¨åˆ†ï¼ŒWebFlux æä¾›äº†ä¸å…¶ä»– Spring ç»„ä»¶ï¼ˆå¦‚ Spring Bootã€Spring Dataã€Spring Security ç­‰ï¼‰è‰¯å¥½é›†æˆçš„èƒ½åŠ›ã€‚</li><li><strong>æ”¯æŒå¤šç§ç½‘ç»œå®¹å™¨</strong>ï¼šWebFlux ä¸ä¾èµ–äº Servlet å®¹å™¨ï¼Œè€Œæ˜¯é€šè¿‡ Nettyã€Undertow æˆ–è€… Servlet 3.1+ å®¹å™¨æ¥è¿è¡Œã€‚è¿™ä½¿å¾— WebFlux èƒ½å¤Ÿæ›´åŠ çµæ´»åœ°é€‰æ‹©é€‚åˆè‡ªå·±åœºæ™¯çš„ç½‘ç»œå®¹å™¨ã€‚</li></ol><p>WebFlux é€‚ç”¨äºéœ€è¦å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚ã€å¼‚æ­¥æ“ä½œå’Œäº‹ä»¶é©±åŠ¨çš„åœºæ™¯ï¼Œæ¯”å¦‚å®æ—¶æ•°æ®å¤„ç†ã€å®æ—¶é€šä¿¡ã€å®æ—¶ç›‘æ§ç­‰ã€‚å®ƒæä¾›äº†ä¸€ç§ç°ä»£åŒ–çš„ç¼–ç¨‹æ¨¡å‹ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°åº”å¯¹ç°ä»£ Web åº”ç”¨ç¨‹åºçš„æŒ‘æˆ˜ã€‚</p><h2 id="4-netty"><a href="#4-netty" class="headerlink" title="4. netty"></a>4. netty</h2><p>netty æ˜¯ä¸€ä¸ªåŸºäº Java NIO çš„å¼‚æ­¥äº‹ä»¶é©±åŠ¨çš„ç½‘ç»œåº”ç”¨æ¡†æ¶ï¼Œç”¨äºå¿«é€Ÿå¼€å‘å¯ç»´æŠ¤çš„é«˜æ€§èƒ½çš„ç½‘ç»œæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ç¨‹åºã€‚å®ƒæä¾›äº†ç®€å•è€Œå¼ºå¤§çš„ APIï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥è½»æ¾åœ°æ„å»ºå„ç§ç±»å‹çš„ç½‘ç»œåº”ç”¨ï¼ŒåŒ…æ‹¬å®æ—¶é€šä¿¡ã€å®æ—¶ç›‘æ§ã€åœ¨çº¿æ¸¸æˆç­‰ã€‚</p><p>Netty çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p><ol><li><strong>å¼‚æ­¥éé˜»å¡</strong>ï¼šNetty ä½¿ç”¨äº† Java NIO æä¾›çš„éé˜»å¡ I&#x2F;O æ¨¡å‹ï¼Œèƒ½å¤Ÿå¤„ç†å¤§é‡å¹¶å‘çš„è¿æ¥å’Œè¯·æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œæé«˜äº†ç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›å’Œæ€§èƒ½ã€‚</li><li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šNetty æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨çš„ç¼–ç¨‹æ¨¡å‹ï¼Œé€šè¿‡æ³¨å†Œå’Œå¤„ç†äº‹ä»¶æ¥è¿›è¡Œå¼‚æ­¥çš„æ•°æ®è¯»å†™æ“ä½œã€‚å½“æœ‰äº‹ä»¶å‘ç”Ÿæ—¶ï¼ŒNetty ä¼šè°ƒç”¨ç›¸åº”çš„å¤„ç†å™¨ï¼ˆHandlerï¼‰æ¥å¤„ç†äº‹ä»¶ï¼Œå®ç°äº†è§£è€¦å’Œé«˜åº¦çµæ´»æ€§ã€‚</li><li><strong>é«˜æ€§èƒ½å’Œé«˜ååé‡</strong>ï¼šNetty çš„è®¾è®¡ç›®æ ‡ä¹‹ä¸€æ˜¯æä¾›é«˜æ€§èƒ½å’Œé«˜ååé‡çš„ç½‘ç»œé€šä¿¡èƒ½åŠ›ã€‚å®ƒé‡‡ç”¨äº†é›¶æ‹·è´ã€å†…å­˜æ± ç­‰æŠ€æœ¯æ¥å‡å°‘å†…å­˜åˆ†é…å’Œå¤åˆ¶çš„å¼€é”€ï¼Œæé«˜äº†æ•°æ®ä¼ è¾“çš„æ•ˆç‡ã€‚</li><li><strong>å¯å®šåˆ¶æ€§</strong>ï¼šNetty æä¾›äº†ä¸°å¯Œçš„ç»„ä»¶å’Œæ‰©å±•ç‚¹ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥çµæ´»åœ°å®šåˆ¶å’Œæ‰©å±•ç½‘ç»œåº”ç”¨çš„åŠŸèƒ½å’Œç‰¹æ€§ã€‚</li><li><strong>å¹¿æ³›çš„åº”ç”¨é¢†åŸŸ</strong>ï¼šNetty è¢«å¹¿æ³›åº”ç”¨äºå„ç§é¢†åŸŸï¼ŒåŒ…æ‹¬ Web æœåŠ¡å™¨ã€å®æ—¶é€šä¿¡æœåŠ¡å™¨ã€æ¶ˆæ¯ä¸­é—´ä»¶ã€æ¸¸æˆæœåŠ¡å™¨ã€ç‰©è”ç½‘è®¾å¤‡ç­‰ã€‚</li></ol><p>ç”±äºå…¶ä¼˜ç§€çš„æ€§èƒ½å’Œå¯æ‰©å±•æ€§ï¼ŒNetty å·²ç»æˆä¸º Java å¼€å‘ä¸­é¦–é€‰çš„ç½‘ç»œåº”ç”¨æ¡†æ¶ä¹‹ä¸€ï¼Œå¾—åˆ°äº†ä¼—å¤šä¼ä¸šå’Œå¼€å‘è€…çš„å¹¿æ³›åº”ç”¨å’Œè®¤å¯ã€‚</p><h2 id="5-zuulå’ŒspringCloud-Gateway"><a href="#5-zuulå’ŒspringCloud-Gateway" class="headerlink" title="5. zuulå’ŒspringCloud Gateway"></a>5. zuulå’ŒspringCloud Gateway</h2><p>**Zuul1.x(Spring Cloud Netflix Zuul 1.x)**ï¼š</p><ol><li><strong>æˆç†Ÿåº¦</strong>ï¼šZuul æ˜¯ Netflix å…¬å¸å¼€å‘çš„ä¸€ä¸ªæˆç†Ÿçš„ç½‘å…³æœåŠ¡ç»„ä»¶ï¼Œå·²ç»åœ¨å¤§è§„æ¨¡ç”Ÿäº§ç¯å¢ƒä¸­è¢«å¹¿æ³›ä½¿ç”¨å’ŒéªŒè¯ã€‚</li><li><strong>åŸºäº Servlet</strong>ï¼šZuul é‡‡ç”¨åŸºäº Servlet çš„æ–¹å¼æ„å»ºï¼Œå®ƒç›´æ¥ä¸ Servlet å®¹å™¨ï¼ˆå¦‚ Tomcatã€Jettyï¼‰é›†æˆï¼Œä½¿ç”¨ä¼ ç»Ÿçš„é˜»å¡å¼ I&#x2F;O æ¨¡å‹ã€‚</li><li><strong>åŒæ­¥å¤„ç†</strong>ï¼šZuul ä½¿ç”¨åŒæ­¥å¤„ç†æ¨¡å‹ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼šç»è¿‡ä¸€ç³»åˆ—çš„è¿‡æ»¤å™¨é“¾ï¼Œè¿™äº›è¿‡æ»¤å™¨æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œå¦‚æœæŸä¸ªè¿‡æ»¤å™¨å‡ºç°é—®é¢˜ï¼Œä¼šå¯¼è‡´æ•´ä¸ªè¯·æ±‚é“¾æ¡ä¸­æ–­ã€‚</li><li><strong>åŠŸèƒ½ä¸°å¯Œ</strong>ï¼šZuul æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½å’Œç‰¹æ€§ï¼ŒåŒ…æ‹¬è·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€è¯·æ±‚è½¬å‘ã€è¿‡æ»¤å™¨ã€ç†”æ–­å™¨ç­‰ï¼Œèƒ½å¤Ÿæ»¡è¶³å„ç§å¤æ‚çš„ç½‘å…³æœåŠ¡éœ€æ±‚ã€‚</li></ol><p><strong>Zuul 2.xï¼ˆSpring Cloud Netflix Zuul 2.xï¼‰</strong>ï¼š</p><ol><li><strong>å¼‚æ­¥éé˜»å¡</strong>ï¼šZuul 2.x ä½¿ç”¨äº†åŸºäº Netty çš„éé˜»å¡å¼ I&#x2F;O æ¨¡å‹ï¼Œèƒ½å¤Ÿå¤„ç†å¤§é‡å¹¶å‘çš„è¯·æ±‚ï¼Œå¹¶æä¾›äº†é«˜æ€§èƒ½å’Œé«˜ååé‡çš„ç‰¹æ€§ã€‚</li><li><strong>åŠŸèƒ½ä¸°å¯Œ</strong>ï¼šZuul 2.x ç»§æ‰¿äº† Zuul 1.x çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬è·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€è¯·æ±‚è½¬å‘ã€è¿‡æ»¤å™¨ã€ç†”æ–­å™¨ç­‰ï¼ŒåŒæ—¶è¿˜æä¾›äº†æ›´å¤šçš„çµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚</li><li><strong>Spring Cloud ç”Ÿæ€é›†æˆ</strong>ï¼šZuul 2.x æ˜¯ Spring Cloud ç”Ÿæ€ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œä¸å…¶ä»– Spring Cloud ç»„ä»¶ï¼ˆå¦‚ Eurekaã€Ribbonã€Spring Cloud Config ç­‰ï¼‰èƒ½å¤Ÿå¾ˆå¥½åœ°é›†æˆã€‚</li><li><strong>ç½‘å…³ä¸å¾®æœåŠ¡æ¶æ„é›†æˆ</strong>ï¼šZuul 2.x å¯ä»¥ä¸ Netflix æä¾›çš„å…¶ä»–å¾®æœåŠ¡æ¶æ„ç»„ä»¶é›†æˆï¼Œå¦‚ Eureka æœåŠ¡æ³¨å†Œä¸­å¿ƒã€Ribbon å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨ç­‰ã€‚</li></ol><p><strong>Spring Cloud Gateway</strong>ï¼š</p><ol><li><strong>åŸºäº Spring WebFlux</strong>ï¼šSpring Cloud Gateway æ˜¯åŸºäº Spring WebFlux æ„å»ºçš„ï¼Œä½¿ç”¨äº† Reactor æä¾›çš„éé˜»å¡å¼ I&#x2F;O æ¨¡å‹ï¼Œèƒ½å¤Ÿæ›´é«˜æ•ˆåœ°åˆ©ç”¨ç³»ç»Ÿèµ„æºï¼Œå¹¶æé«˜å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</li><li><strong>å“åº”å¼ç¼–ç¨‹æ¨¡å‹</strong>ï¼šSpring Cloud Gateway ä½¿ç”¨äº†å“åº”å¼ç¼–ç¨‹æ¨¡å‹ï¼Œæ”¯æŒå¼‚æ­¥å’Œéé˜»å¡çš„è¯·æ±‚å¤„ç†ï¼Œèƒ½å¤Ÿå¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚ã€‚</li><li><strong>çµæ´»æ€§å’Œæ‰©å±•æ€§</strong>ï¼šSpring Cloud Gateway æä¾›äº†æ›´å¤§çš„çµæ´»æ€§å’Œæ‰©å±•æ€§ï¼Œæ”¯æŒåŠ¨æ€è·¯ç”±ã€è‡ªå®šä¹‰è¿‡æ»¤å™¨ã€ç†”æ–­å™¨ç­‰ç‰¹æ€§ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œå®šåˆ¶å’Œæ‰©å±•ã€‚</li><li><strong>å‡½æ•°å¼è·¯ç”±å®šä¹‰</strong>ï¼šSpring Cloud Gateway ä½¿ç”¨å‡½æ•°å¼çš„æ–¹å¼æ¥å®šä¹‰è·¯ç”±è§„åˆ™ï¼Œå¯ä»¥æ›´çµæ´»åœ°å®šä¹‰è·¯ç”±è§„åˆ™å’Œè¯·æ±‚å¤„ç†é€»è¾‘ã€‚</li></ol><p>Zuul 2.x å’Œ Spring Cloud Gateway åœ¨åŸºäºéé˜»å¡å¼ I&#x2F;O æ¨¡å‹ã€å“åº”å¼ç¼–ç¨‹æ¨¡å‹å’Œçµæ´»æ€§ç­‰æ–¹é¢å…·æœ‰ç›¸ä¼¼æ€§ï¼Œä½†ç”±äº Spring Cloud Gateway æ˜¯ Spring Cloud ç”Ÿæ€ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤åœ¨ä¸å…¶ä»– Spring Cloud ç»„ä»¶çš„é›†æˆå’Œç”Ÿæ€æ”¯æŒæ–¹é¢å¯èƒ½æ›´ä¸ºä¼˜è¶Šã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>é›†åˆ</title>
    <link href="/%E9%9B%86%E5%90%88/"/>
    <url>/%E9%9B%86%E5%90%88/</url>
    
    <content type="html"><![CDATA[<h1 id="â¼€ã€é›†åˆåˆ†ç±»"><a href="#â¼€ã€é›†åˆåˆ†ç±»" class="headerlink" title="â¼€ã€é›†åˆåˆ†ç±»"></a>â¼€ã€é›†åˆåˆ†ç±»</h1><p>Javaä¸­çš„é›†åˆæ¡†æ¶â¼¤ç±»å¯åˆ†ä¸ºCollectionå’ŒMapï¼Œâ½½collectionâ¼œæœ‰ä¸¤ä¸ªâ¼¦æ¥â¼Listå’ŒSet</p><h2 id="1-List"><a href="#1-List" class="headerlink" title="1. List"></a>1. <strong>List</strong></h2><ul><li><p>ç‰¹ç‚¹ï¼šå…ƒç´ æœ‰é¡ºåºï¼Œèƒ½é‡å¤ ï¼Œå¯ä»¥æ’â¼Šå¤šä¸ª null å…ƒç´ ã€‚</p></li><li><p>List æ¥â¼æœ‰ä¸‰ä¸ªå®ç°ç±»ï¼šLinkedListï¼ŒArrayListï¼ŒVector</p><ul><li><p>LinkedListï¼šåº•å±‚åŸºäºé“¾è¡¨å®ç°ï¼Œé“¾è¡¨å†…å­˜æ˜¯æ•£ä¹±çš„ï¼Œæ¯â¼€ä¸ªå…ƒç´ å­˜å‚¨æœ¬èº«å†…å­˜åœ°å€çš„åŒæ—¶è¿˜å­˜å‚¨ä¸‹â¼€ä¸ªå…ƒç´ çš„åœ°å€ã€‚é“¾è¡¨å¢åˆ å¿«ï¼ŒæŸ¥æ‰¾æ…¢</p></li><li><p>ArrayList å¯å˜â»“æ•°ç»„ï¼ŒæŸ¥è¯¢å¿«ï¼Œâ¾®åŒæ­¥ï¼ŒArrayList æ˜¯â¾®çº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆç‡â¾¼ï¼›</p></li><li><p>Vector æ˜¯åŸºäºçº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆç‡ä½</p></li></ul></li></ul><h2 id="2-Set"><a href="#2-Set" class="headerlink" title="2. Set"></a>2. <strong>Set</strong></h2><ul><li><p>ç‰¹ç‚¹ï¼šå…ƒç´ â½†â½†é¡ºåºï¼Œä¸èƒ½é‡å¤ï¼Œåªå…è®¸â¼€ä¸ª null å…ƒç´ </p></li><li><p>æœ€æµâ¾çš„â¼ä¸ªå®ç°ç±»æ˜¯ HashSetã€LinkedHashSet ä»¥åŠ TreeSet</p><ul><li><p>HashSetï¼š HashSet ç±»æŒ‰ç…§å“ˆå¸Œç®—æ³•æ¥å­˜å–é›†åˆä¸­çš„å¯¹è±¡ï¼Œå­˜å–é€Ÿåº¦â½è¾ƒå¿«</p></li><li><p>TreeSet ï¼šTreeSet ç±»å®ç°äº† SortedSetæ¥â¼ï¼Œèƒ½å¤Ÿå¯¹é›†åˆä¸­çš„å¯¹è±¡è¿›â¾æ’åºã€‚ TreeSet é€šè¿‡ Comparator æˆ–è€…Comparable ç»´æŠ¤äº†â¼€ä¸ªæ’åºé¡ºåºã€‚</p></li></ul></li></ul><h2 id="3-Map"><a href="#3-Map" class="headerlink" title="3.  Map"></a>3.  <strong>Map</strong></h2><ul><li>ç‰¹ç‚¹ï¼šå…ƒç´ æŒ‰é”®å€¼å¯¹å­˜å‚¨ï¼Œâ½†æ”¾â¼Šé¡ºåº</li><li>æœ€æµâ¾çš„â¼ä¸ªå®ç°ç±»æ˜¯ HashMapã€HashTableã€TreeMapã€ConcurrentHashMapã€LinkedHashMap<ul><li>HashMap:çº¿ç¨‹ä¸å®‰å…¨çš„Map,æœ€å¸¸ç”¨çš„Map</li><li>HashTable: çº¿ç¨‹å®‰å…¨ï¼Œåœ¨å„ä¸ªæ–¹æ³•ä¸Šæ·»åŠ äº†synchronizeå…³é”®å­—ï¼Œç°åœ¨å·²ç»ä¸å†æ¨èä½¿ç”¨HashTableäº†ï¼Œå› ä¸ºç°åœ¨æœ‰äº†ConcurrentHashMapè¿™ä¸ªä¸“é—¨ç”¨äºå¤šçº¿ç¨‹åœºæ™¯ä¸‹çš„mapå®ç°ç±»ï¼Œå…¶å¤§å¤§ä¼˜åŒ–äº†å¤šçº¿ç¨‹ä¸‹çš„æ€§èƒ½</li><li>TreeMapï¼šTreeMapä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„mapå®ç°ç±»ï¼Œå› ä¸ºä»–å…·æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç‰¹ç‚¹å°±æ˜¯ä¼šå¯¹Keyè¿›è¡Œæ’åº</li><li>ConcurrentHashMapï¼šæ˜¯HahsMapçš„ä¸€ä¸ªå­ç±»ï¼Œä½†å®ƒä¿æŒäº†è®°å½•çš„æ’å…¥é¡ºåºï¼Œéå†æ—¶å…ˆå¾—åˆ°çš„è‚¯å®šæ˜¯å…ˆæ’å…¥çš„ï¼Œä¹Ÿå¯ä»¥åœ¨æ„é€ æ—¶å¸¦å‚æ•°ï¼ŒæŒ‰ç…§åº”ç”¨æ¬¡æ•°æ’åºï¼Œåœ¨éå†æ—¶ä¼šæ¯”HahsMapæ…¢ï¼Œä¸è¿‡æœ‰ä¸ªä¾‹å¤–ï¼Œå½“HashMapçš„å®¹é‡å¾ˆå¤§ï¼Œå®é™…æ•°æ®å°‘æ—¶ï¼Œéå†èµ·æ¥ä¼šæ¯”LinkedHashMapæ…¢ï¼ˆå› ä¸ºå®ƒæ˜¯é“¾å•Šï¼‰ï¼Œå› ä¸ºHashMapçš„éå†é€Ÿåº¦å’Œå®ƒå®¹é‡æœ‰å…³ï¼ŒLinkedHashMapéå†é€Ÿåº¦åªä¸æ•°æ®å¤šå°‘æœ‰å…³</li></ul></li></ul><h1 id="â¼†ã€å¸¸è€ƒé›†åˆåº•å±‚å®ç°"><a href="#â¼†ã€å¸¸è€ƒé›†åˆåº•å±‚å®ç°" class="headerlink" title="â¼†ã€å¸¸è€ƒé›†åˆåº•å±‚å®ç°"></a>â¼†ã€å¸¸è€ƒé›†åˆåº•å±‚å®ç°</h1><h2 id="1-ArrayList"><a href="#1-ArrayList" class="headerlink" title="1.  ArrayList"></a>1.  <strong>ArrayList</strong></h2><h3 id="1-åº•å±‚å®ç°"><a href="#1-åº•å±‚å®ç°" class="headerlink" title="1. åº•å±‚å®ç°"></a>1. åº•å±‚å®ç°</h3><p>ArrayListåº•å±‚æ˜¯Objectæ•°ç»„å­˜å‚¨æ•°æ®ï¼ŒæŸ¥æ‰¾å¿«ï¼Œå¢åˆ æ…¢ã€‚</p><p>new ArrayList()çš„åˆå§‹å®¹é‡ï¼Œåœ¨jdk1.6ä¸­æ˜¯ä¸º10ï¼Œç„¶â½½åœ¨1.8ä¸­ï¼Œå¦‚æœåªæ˜¯new ArrayList()ï¼Œå®¹é‡å…¶å®æ˜¯ 0ï¼Œå½“ç¬¬â¼€æ¬¡é€šè¿‡add(e)æ—¶ï¼Œæ‰æ‰©å……ä¸º10ã€‚ä½†å®ƒçš„æ‰©å®¹è¿˜æ˜¯åˆ°ä¹‹å‰çš„1.5å€çš„â¼¤â¼©,æ¯æ¬¡æ‰©å®¹éƒ½æ˜¯å°†åŸæ•°ç»„çš„æ•°æ®å¤åˆ¶è¿›æ–°æ•°ç»„ä¸­ã€‚</p><h3 id="2-å¦‚ä½•é¿å…ArrayListçš„å¹¶å‘é—®é¢˜ï¼Ÿ"><a href="#2-å¦‚ä½•é¿å…ArrayListçš„å¹¶å‘é—®é¢˜ï¼Ÿ" class="headerlink" title="2.å¦‚ä½•é¿å…ArrayListçš„å¹¶å‘é—®é¢˜ï¼Ÿ"></a>2.å¦‚ä½•é¿å…ArrayListçš„å¹¶å‘é—®é¢˜ï¼Ÿ</h3><ol><li>ä½¿â½¤Vector</li></ol><p>Vector æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å®ƒå’Œ ArrayList å·®ä¸å¤šï¼Œåªæ˜¯åœ¨â½…æ³•ä¸ŠåŠ äº†synchronized é”ï¼Œæ‰©å®¹ä¸ºåŸæ¥çš„ä¸¤å€æˆ–åŸå®¹é‡ åŠ æ‰©å®¹å› â¼¦ï¼ˆæ„é€ æ—¶æŒ‡å®šï¼‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">add</span><span class="hljs-params">(E e)</span> </span>&#123; <br>  modCount++;<br>  ensureCapacityHelper(elementCount + <span class="hljs-number">1</span>); elementData\[elementCount++\]= e;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>; <br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li>ä½¿â½¤Collections.synchronizedList</li></ol><p>ä½¿â½¤Collections.synchronizedList()â½…æ³•å¯¹ArrayListå¯¹è±¡è¿›â¾åŒ…è£…,SynchronizedListæ˜¯çº¿ç¨‹å®‰å…¨çš„æ ¹æœ¬åŸå› æ˜¯ä½¿â½¤Synchronizedå¯¹SynchronizedListçš„add,deleteç­‰æ“ä½œè¿›â¾åŠ é”ï¼ŒæŠŠåŸæ¥ArrayListåœ¨â½…æ³•ä¸ŠåŠ é”æ›¿æ¢æˆäº†åœ¨ä»£ç å—åŠ é”ï¼Œä½†æ˜¯è¿™ç§é”çš„â¼’åº¦å¾ˆâ¼¤ï¼Œæ‰€ä»¥è¿™ç§â½…å¼æ•ˆç‡ä½ä¸‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index, E element)</span> </span>&#123; <br>  <span class="hljs-keyword">synchronized</span>(mutex)&#123;<br>    list.add(index, element);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li>ä½¿â½¤å¹¶å‘å®¹å™¨CopyOnWriteArrayList</li></ol><p>CopyOnWriteArrayList æ˜¯å†™æ—¶å¤åˆ¶çš„å®¹å™¨ï¼Œå°±æ˜¯æˆ‘ä»¬å¾€å®¹å™¨â¾¥å†™ä¸œâ»„æ—¶ï¼Œä¸æ˜¯ç›´æ¥å†™ï¼Œâ½½æ˜¯å…ˆCopyå½“å‰å®¹å™¨ï¼Œç„¶åå¾€æ–°å®¹å™¨â¾¥æ·»åŠ å…ƒç´ ï¼Œåœ¨å°†åŸå®¹å™¨çš„å¼•â½¤æŒ‡å‘æ–°å®¹å™¨ã€‚</p><ul><li><p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼šå¯ä»¥å¹¶å‘çš„è¯»ï¼Œâ½½ä¸éœ€è¦åŠ é”ï¼Œå› ä¸ºå½“å‰å®¹å™¨ä¸ä¼šæ·»åŠ ä»»ä½•å…ƒç´ ã€‚å¦‚æœåœ¨æ·»åŠ æ•°æ®çš„æœŸé—´ï¼Œå…¶ä»–çº¿ç¨‹å¦‚æœè¦å»è¯»å–æ•°æ®ï¼Œä»ç„¶æ˜¯è¯»å–åˆ°æ—§çš„å®¹å™¨â¾¥çš„æ•°æ®ã€‚</p></li><li><p>CopyOnWriteArrayListæ˜¯â¼€ç§è¯»å†™åˆ†ç¦»çš„æ€æƒ³ï¼Œåªæ˜¯åœ¨å¢åˆ æ”¹ä¸ŠåŠ é”ï¼Œä½†æ˜¯è¯»ä¸åŠ é”ï¼Œåœ¨è¯»â½…â¾¯çš„æ€§èƒ½å°±å¥½äºVectorï¼ŒCopyOnWriteArrayListâ½€æŒè¯»å¤šå†™å°‘çš„å¹¶å‘æƒ…å†µã€‚</p></li><li><p>CopyOnWriteArrayList ä¸­çš„addã€setã€removeç­‰â½…æ³•ï¼Œéƒ½æ˜¯ â½¤äº† <strong>ReentrantLock</strong> çš„lock()æ¥åŠ é”ï¼Œunlock()æ¥è§£é”ã€‚ å½“å¢åŠ å…ƒç´ æ—¶ä½¿â½¤Array.copyOf()æ¥æ‹·â»‰å‰¯æœ¬ï¼Œåœ¨å‰¯æœ¬ä¸Šå¢åŠ å…ƒç´ ï¼Œç„¶åæ”¹å˜åŸå¼•â½¤æŒ‡å‘å‰¯æœ¬ï¼Œè¯»æ“ä½œä¸åŠ é”ã€‚é€‚åˆè¯»æ“ä½œè¿œè¿œå¤šäºå†™æ“ä½œçš„åº”â½¤ã€‚</p></li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>ï¼ˆ1ï¼‰ å†…å­˜å â½¤é—®é¢˜ï¼›</p><p>ï¼ˆ2ï¼‰æ•°æ®â¼€è‡´æ€§é—®é¢˜CopyOnWriteæœºåˆ¶åªèƒ½ä¿è¯æœ€ç»ˆçš„æ•°æ®â¼€è‡´ï¼Œä¸èƒ½ä¿è¯å®æ—¶æ•°æ®â¼€è‡´ï¼Œå› æ­¤å¦‚æœå¸Œæœ›å†™â¼Šçš„æ•°æ®èƒ½â»¢ä¸Šè¯»åˆ°ï¼Œå°±ä¸åº”è¯¥â½¤ CopyOnWrite;</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">add</span><span class="hljs-params">(E e)</span> </span>&#123;<br>  <span class="hljs-keyword">final</span> ReentrantLock lock = <span class="hljs-keyword">this</span>.lock; <br>  lock.lock();<br>  <span class="hljs-keyword">try</span> &#123;<br>    Object[] elements = getArray();<br>    <span class="hljs-keyword">int</span> len = elements.length;<br>    Object[] newElements = Arrays.copyOf(elements, len + <span class="hljs-number">1</span>);<br>    newElements[len] = e;<br>    setArray(newElements);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>  &#125; <span class="hljs-keyword">finally</span> &#123; <br>    lock.unlock();<br>  &#125;<br>&#125; <br></code></pre></td></tr></table></figure><h2 id="2-LinkedList"><a href="#2-LinkedList" class="headerlink" title="2. LinkedList"></a>2. LinkedList</h2><h3 id="1-åº•å±‚å®ç°-1"><a href="#1-åº•å±‚å®ç°-1" class="headerlink" title="1.åº•å±‚å®ç°"></a>1.åº•å±‚å®ç°</h3><p>LinkedList æ˜¯ä»¥åŒå‘é“¾è¡¨å®ç°ï¼Œé“¾è¡¨â½†å®¹é‡é™åˆ¶ï¼Œä¸”å¢åˆ å¿«ï¼ŒæŸ¥è¯¢æ…¢ã€‚å…¶å†…éƒ¨ä¸»è¦æˆå‘˜ä¸º first å’Œ last ä¸¤ä¸ª NodeèŠ‚ç‚¹ï¼Œåœ¨æ¯æ¬¡ä¿®æ”¹åˆ—è¡¨æ—¶â½¤æ¥æŒ‡å¼•å½“å‰åŒå‘é“¾è¡¨çš„â¾¸å°¾éƒ¨ä½ï¼Œæ¥å¯¹é“¾è¡¨ä¸¤å¤´çš„è¿›â¾æ“ä½œã€‚</p><ul><li>LinkedListçº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå…¶å†…éƒ¨æ·»åŠ ã€åˆ é™¤ã€ç­‰æ“ä½œï¼Œæ²¡æœ‰è¿›â¾åŒæ­¥æ“ä½œã€‚</li></ul><h3 id="2-å¦‚ä½•é¿å…LinkedListçš„å¹¶å‘é—®é¢˜ï¼Ÿ"><a href="#2-å¦‚ä½•é¿å…LinkedListçš„å¹¶å‘é—®é¢˜ï¼Ÿ" class="headerlink" title="2. å¦‚ä½•é¿å…LinkedListçš„å¹¶å‘é—®é¢˜ï¼Ÿ"></a><strong>2.</strong> <strong>å¦‚ä½•é¿å…LinkedListçš„å¹¶å‘é—®é¢˜ï¼Ÿ</strong></h3><ol><li><p>Collections.synchronizedList</p></li><li><p>ConcurrentLinkedQueue</p><p>ConcurrentLinkedQueue é‡‡â½¤ CAS ä¹è§‚é”çš„æœºåˆ¶å®ç°â¾®é˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueue é˜»å¡é˜Ÿåˆ—ï¼‰</p></li></ol><h2 id="3-hashMap"><a href="#3-hashMap" class="headerlink" title="3. hashMap"></a>3. <strong>hashMap</strong></h2><h3 id="1-åº•å±‚å®ç°-2"><a href="#1-åº•å±‚å®ç°-2" class="headerlink" title="1.åº•å±‚å®ç°"></a><strong>1.åº•å±‚å®ç°</strong></h3><p><a href="https://blog.csdn.net/qq_42922647/article/details/97375500">hashMapåº•å±‚åŸç†</a></p><h3 id="2-HashMapçš„putå®ç°"><a href="#2-HashMapçš„putå®ç°" class="headerlink" title="2. HashMapçš„putå®ç°"></a>2. HashMapçš„putå®ç°</h3><p>å½“å¾€hashmapé‡Œput(key,value)æ–°å…ƒç´ æ—¶ï¼Œ</p><p>åˆ©ç”¨keyè®¡ç®—å‡ºhashå€¼ï¼Œç„¶åå†è®¡ç®—ä¸‹æ ‡ï¼›æ±‚è§£ä¸‹æ ‡çš„å…·ä½“è¿‡ç¨‹ä¸ºï¼šå¾—åˆ°key.hashcodeè¿›è¡Œé«˜16ä½^ä½16ä½ï¼Œå¾—åˆ°hashå€¼ï¼›æ ¹æ®ä¸‹æ ‡index&#x3D;(n - 1) &amp; hashï¼Œå³å¯è®¡ç®—å‡ºä¸‹æ ‡ã€‚<br>æ”¾å…¥èŠ‚ç‚¹æ—¶ï¼Œæœ‰ä»¥ä¸‹4ç§æƒ…å†µï¼ˆæºç ä¸­ç”¨4ä¸ªifã€elseå®ç°ï¼‰ï¼š</p><ul><li>æ•°ç»„åŸæœ¬ä½ç½®ä¸ºç©ºï¼Œç›´æ¥æ”¾å…¥ã€‚</li><li>æ•°ç»„åŸæœ¬ä½ç½®ä¸ä¸ºç©ºï¼Œä¸”ä¸‹é¢è¿æ¥äº†é“¾è¡¨ï¼Œå¾€é“¾è¡¨ä¸­æ·»åŠ èŠ‚ç‚¹ï¼Œå½“é“¾è¡¨é•¿åº¦ä¸º8æ—¶ï¼Œè¿›è¡Œæ ‘å½¢åŒ–ï¼Œå°†é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ã€‚</li><li>æ•°ç»„åŸæœ¬ä½ç½®ä¸ä¸ºç©ºï¼Œä¸”ä¸‹é¢è¿æ¥äº†çº¢é»‘æ ‘ï¼Œå¾€æ ‘ä¸­æ·»åŠ èŠ‚ç‚¹ï¼Œå½“çº¢é»‘æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ä¸º6æ—¶ï¼Œå°†çº¢é»‘æ ‘è½¬ä¸ºé“¾è¡¨ã€‚</li><li>æ•°ç»„åŸæœ¬ä½ç½®ä¸ä¸ºç©ºï¼Œä½†è¦æ”¾å…¥çš„èŠ‚ç‚¹çš„keyä¸å½“å‰èŠ‚ç‚¹çš„keyç›¸åŒï¼Œåˆ™è¿›è¡Œå€¼è¦†ç›–ï¼Œç”¨æ–°å€¼æ›¿æ¢æ—§å€¼ã€‚</li></ul><h3 id="3-HashMap-æ˜¯å¦‚ä½•æ‰©å®¹çš„ï¼Ÿ"><a href="#3-HashMap-æ˜¯å¦‚ä½•æ‰©å®¹çš„ï¼Ÿ" class="headerlink" title="3. HashMap æ˜¯å¦‚ä½•æ‰©å®¹çš„ï¼Ÿ"></a>3. HashMap æ˜¯å¦‚ä½•æ‰©å®¹çš„ï¼Ÿ</h3><p><strong>HashMapå‡ºç°æ‰©å®¹æœ‰ä¸¤ç§æƒ…å†µï¼š</strong></p><p>åœ¨æ‰©å®¹çš„æ—¶å€™ï¼Œé¦–å…ƒç´ è¾¾åˆ°é˜ˆå€¼äº†ï¼Œå³å½“å‰å®¹é‡*0.75ã€‚</p><p>hashMapå‡†å¤‡æ ‘å½¢åŒ–ä½†å‘ç°æ•°ç»„å¤ªçŸ­ï¼Œå³å°äºæœ€å°æ ‘å½¢åŒ–çš„å®¹é‡ã€‚</p><p><strong>å½“æ‰©å®¹æ—¶æœ‰ä¸¤ç§æƒ…å†µï¼š</strong></p><p>å½“å‰å®¹é‡å·²è¾¾æœ€å¤§ï¼Œå³é•¿åº¦å·²ç»ä¸º2^30ï¼Œåˆ™ä¸è¿›è¡Œæ‰©å®¹ï¼Œè¿”å›å½“å‰æ•°ç»„ã€‚</p><p>å¦åˆ™ï¼Œåœ¨ç°åœ¨åŸºç¡€ä¸Šæ‰©å¤§äºŒå€</p><h3 id="4-ä¸ºä»€ä¹ˆä»¥2çš„næ¬¡å¹‚è¿›è¡Œæ‰©å®¹ï¼Ÿ"><a href="#4-ä¸ºä»€ä¹ˆä»¥2çš„næ¬¡å¹‚è¿›è¡Œæ‰©å®¹ï¼Ÿ" class="headerlink" title="4. ä¸ºä»€ä¹ˆä»¥2çš„næ¬¡å¹‚è¿›è¡Œæ‰©å®¹ï¼Ÿ"></a>4. <strong>ä¸ºä»€ä¹ˆä»¥2çš„næ¬¡å¹‚è¿›è¡Œæ‰©å®¹ï¼Ÿ</strong></h3><p>  åœ¨hashmapä¸­æ•°ç»„ä¸‹æ ‡çš„ç¡®å®šæ˜¯é€šè¿‡index&#x3D;(n-1)&amp;hashè®¡ç®—çš„ï¼Œ2^næ¢æˆäºŒè¿›åˆ¶éƒ½æ˜¯â€œ100000â€¦.â€è¿™ç§å½¢å¼ï¼Œå‡ä¸€åéƒ½æ˜¯â€œ011111..â€.è¿™ç§é™¤äº†ç¬¬ä¸€ä½åé¢å‡ ä½éƒ½æ˜¯1çš„äºŒè¿›åˆ¶æ•°</p><p>è¿™æ ·çš„è¯ï¼Œç›¸å½“äºhashmapçš„ä½ç½®ï¼Œå°±åªå’Œhashcodeçš„å€¼æœ‰å…³ï¼Œç®—å‡ºæ¥çš„indexæ˜¯åˆ†å¸ƒå‡åŒ€çš„ã€‚</p><p>å½“ä¸å…¨ä¸º1ï¼Œå‡ºç°â€œ01101â€è¿™æ ·çš„å½¢å¼ï¼Œé‚£ä¹ˆä¸0å¯¹åº”çš„é‚£ä¸€ä½ï¼Œä¸è®ºhashcodeå€¼æ˜¯0è¿˜æ˜¯1ï¼Œè¿›è¡Œä¸è¿ç®—åï¼Œéƒ½ä¼šæ”¾å…¥åŒæ ·çš„ä½ç½®ï¼Œè¿™æ ·ä¼šå¤§å¤§å¢åŠ hashå†²çªã€‚<strong>å‘æ‰©å®¹åçš„æ•°ç»„æŒªåŠ¨çš„æ—¶å€™æœ‰ä»¥ä¸‹3ç§æƒ…å†µ</strong></p><ul><li>åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ ï¼šå°†å½“å‰èŠ‚ç‚¹ç½®ç©ºåï¼Œæ–°çš„ä½ç½®&#x3D;hash &amp; (newCap - 1)</li><li>æ•°ç»„ä¸‹æœ‰é“¾è¡¨ï¼šåŸä¸‹æ ‡+åŸå®¹é‡</li><li>æ•°ç»„ä¸‹æœ‰çº¢é»‘æ ‘ï¼šè¿›è¡Œåˆ†å‰²</li></ul><h3 id="5-JDK1-7-å’Œ-JDK1-8-å¯¹-HashMap-çš„å®ç°æ¯”è¾ƒ"><a href="#5-JDK1-7-å’Œ-JDK1-8-å¯¹-HashMap-çš„å®ç°æ¯”è¾ƒ" class="headerlink" title="5. JDK1.7 å’Œ JDK1.8 å¯¹ HashMap çš„å®ç°æ¯”è¾ƒ"></a>5. JDK1.7 å’Œ JDK1.8 å¯¹ HashMap çš„å®ç°æ¯”è¾ƒ</h3><ol><li>åº•å±‚æ•°æ®ç»“æ„ä¸åŒ</li></ol><p>åœ¨ HashMap çš„ put è¿‡ç¨‹ä¸­ï¼ŒJDK1.7 æ—¶æ˜¯æ²¡æœ‰çº¢é»‘æ ‘è¿™ä¸€æ¦‚å¿µçš„ï¼Œç›´æ¥æ˜¯è¿›è¡Œçš„é“¾è¡¨å­˜å‚¨ï¼Œ<strong>åœ¨ JDK1.8 ä¹‹åæ‰å¼•å…¥äº†çº¢é»‘æ ‘çš„æ¦‚å¿µï¼Œæ¥ä¼˜åŒ–å­˜å‚¨å’ŒæŸ¥æ‰¾</strong>ã€‚</p><ol start="2"><li>é“¾è¡¨çš„æ’å…¥æ–¹å¼ä¸åŒ</li></ol><p>åœ¨ HashMap å‘é“¾è¡¨ä¸­æ’å…¥å…ƒç´ çš„è¿‡ç¨‹ä¸­ï¼ŒJDK1.7 æ—¶æ˜¯åœ¨è¡¨å¤´èŠ‚ç‚¹æ’å…¥çš„ï¼ŒJDK1.8 ä¹‹åæ˜¯åœ¨å°¾èŠ‚ç‚¹æ’å…¥çš„ã€‚ç®€å•è¯´å°±æ˜¯æ’å…¥æ—¶ï¼Œå¦‚æœæ•°ç»„ä½ç½®ä¸Šå·²ç»æœ‰å…ƒç´ ï¼Œ1.7 å°†æ–°å…ƒç´ æ”¾åˆ°æ•°ç»„ä¸­ï¼ŒåŸå§‹èŠ‚ç‚¹ä½œä¸ºæ–°èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ï¼Œ1.8 éå†é“¾è¡¨ï¼Œå°†å…ƒç´ æ”¾ç½®åˆ°é“¾è¡¨çš„æœ€å</p><ol start="3"><li>æ‰©å®¹åæ•°å­˜å‚¨ä½ç½®çš„è®¡ç®—æ–¹å¼ä¸åŒ</li></ol><p> æ‰©å®¹çš„æ—¶å€™ 1.7 éœ€è¦å¯¹åŸæ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œé‡æ–° hash å®šä½åœ¨æ–°æ•°ç»„çš„ä½ç½®ï¼Œ1.8 é‡‡ç”¨æ›´ç®€å•çš„åˆ¤æ–­é€»è¾‘ï¼Œä½ç½®ä¸å˜æˆ–ç´¢å¼•+æ—§å®¹é‡å¤§å°ï¼› åœ¨æ’å…¥æ—¶ï¼Œ1.7 å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œå†æ’å…¥ï¼Œ1.8 å…ˆè¿›è¡Œæ’å…¥ï¼Œæ’å…¥å®Œæˆå†åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼› </p><h3 id="6-HashMap-çš„å“ˆå¸Œå‡½æ•°æ€ä¹ˆè®¾è®¡çš„å—ï¼Ÿ"><a href="#6-HashMap-çš„å“ˆå¸Œå‡½æ•°æ€ä¹ˆè®¾è®¡çš„å—ï¼Ÿ" class="headerlink" title="6. HashMap çš„å“ˆå¸Œå‡½æ•°æ€ä¹ˆè®¾è®¡çš„å—ï¼Ÿ"></a>6. HashMap çš„å“ˆå¸Œå‡½æ•°æ€ä¹ˆè®¾è®¡çš„å—ï¼Ÿ</h3><p>hash å‡½æ•°æ˜¯å…ˆæ‹¿åˆ°é€šè¿‡ key çš„ hashcodeï¼Œæ˜¯ 32 ä½çš„ int å€¼ï¼Œç„¶åè®© hashcode çš„é«˜ 16 ä½å’Œä½ 16 ä½è¿›è¡Œå¼‚æˆ–æ“ä½œã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡å—ï¼Ÿ</strong></p><ul><li>é«˜16ä½ä¸ä½16ä½ï¼šæ˜¯ä¸ºäº†é¿å…æ²¡æœ‰é«˜ä½å‚ä¸è¿ç®—å¼•èµ·çš„ç¢°æ’ã€‚</li><li>å¼‚æˆ–ï¼šå› ä¸ºå¼‚æˆ–å±äºé€»è¾‘è¿ç®—ï¼Œåœ¨ç¡¬ç›˜ä¸Šå®ç°çš„ï¼Œè¿ç®—é€Ÿåº¦å¿«ï¼Œåƒ+ã€-ã€è¿™ç§éƒ½å±äºç®—æ•°è¿ç®—ï¼Œé€Ÿåº¦è¾ƒæ…¢ã€‚</li></ul><h3 id="7-é“¾è¡¨çš„æ’å…¥æ–¹å¼ä¸ºä»€ä¹ˆä»å¤´æ’æ³•æ”¹æˆäº†å°¾æ’æ³•ï¼Ÿ"><a href="#7-é“¾è¡¨çš„æ’å…¥æ–¹å¼ä¸ºä»€ä¹ˆä»å¤´æ’æ³•æ”¹æˆäº†å°¾æ’æ³•ï¼Ÿ" class="headerlink" title="7. é“¾è¡¨çš„æ’å…¥æ–¹å¼ä¸ºä»€ä¹ˆä»å¤´æ’æ³•æ”¹æˆäº†å°¾æ’æ³•ï¼Ÿ"></a>7. é“¾è¡¨çš„æ’å…¥æ–¹å¼ä¸ºä»€ä¹ˆä»å¤´æ’æ³•æ”¹æˆäº†å°¾æ’æ³•ï¼Ÿ</h3><p>1.7 å¤´æ’æ³•æ‰©å®¹æ—¶ï¼Œå¤´æ’æ³•ä¼šä½¿é“¾è¡¨å‘ç”Ÿåè½¬ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šäº§ç”Ÿç¯ï¼› A çº¿ç¨‹åœ¨æ’å…¥èŠ‚ç‚¹ Bï¼ŒB çº¿ç¨‹ä¹Ÿåœ¨æ’å…¥ï¼Œé‡åˆ°å®¹é‡ä¸å¤Ÿå¼€å§‹æ‰©å®¹ï¼Œé‡æ–° hashï¼Œæ”¾ç½®å…ƒç´ ï¼Œé‡‡ç”¨å¤´æ’æ³•ï¼Œåéå†åˆ°çš„ B èŠ‚ç‚¹æ”¾å…¥äº†å¤´éƒ¨ï¼Œè¿™æ ·å½¢æˆäº†ç¯ï¼Œ</p><h3 id="8-å¦‚ä½•é¿å…hashMapçš„å¹¶å‘é—®é¢˜ï¼Ÿ"><a href="#8-å¦‚ä½•é¿å…hashMapçš„å¹¶å‘é—®é¢˜ï¼Ÿ" class="headerlink" title="8. å¦‚ä½•é¿å…hashMapçš„å¹¶å‘é—®é¢˜ï¼Ÿ"></a>8. å¦‚ä½•é¿å…hashMapçš„å¹¶å‘é—®é¢˜ï¼Ÿ</h3><p><strong>1.</strong> <strong>Hashtable</strong></p><p>HashTableçš„ä¸»è¦â½…æ³•çš„æºç å®ç°é€»è¾‘ï¼Œä¸HashMapä¸­â¾®å¸¸ç›¸ä¼¼ï¼Œä½†å®ƒçš„æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯é€šè¿‡æ·»åŠ synchronizedé”çš„ï¼Œä»â½½å®ç°äº†çº¿ç¨‹å®‰å…¨ï¼Œå°½ç®¡JVMå¯¹å®ƒåšäº†ä¼˜åŒ–ï¼Œä½†æ•ˆç‡è¿˜æ˜¯ä¸â¾¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> V <span class="hljs-title">put</span><span class="hljs-params">(K key, V value)</span> </span>&#123; <br>  <span class="hljs-keyword">if</span> (value == <span class="hljs-keyword">null</span>) &#123;<br>  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();<br>&#125;<br></code></pre></td></tr></table></figure><p>2 <strong>ConcurrentHashMap</strong></p><p>æˆ‘ä»¬å¸¸â½¤çš„æ˜¯java.util.concurrentåŒ…ä¸‹çš„ConcurrentHashMap</p><p><strong>1.åŸç†æ¦‚è¿°</strong></p><p><strong>ä¹‹å‰çš„ç‰ˆæœ¬ï¼š</strong></p><p>1. ConcurrentHashMapé€šè¿‡åœ¨CASå’Œåˆ†æ®µåŠ é”æ¥å®ç°åŒæ­¥ï¼Œåˆ†æ®µåŠ é”å°±æ˜¯åœ¨ConcurrentHashMap ä¸­ï¼Œå°±æ˜¯æŠŠ Map åˆ†æˆäº†N ä¸ª Segmentï¼ˆé»˜è®¤ 16ä¸ªï¼‰ï¼Œè¿›â½½å‡â¼©é”çš„â¼’åº¦ã€‚</p><p>2.put å’Œ get çš„æ—¶å€™ï¼Œéƒ½æ˜¯ç°æ ¹æ® key.hashCode()ç®—å‡ºæ”¾åˆ°å“ªä¸ª Segmentä¸­ã€‚Segment åœ¨å®ç°ä¸Šç»§æ‰¿äº† ReentrantLockï¼Œè¿™æ ·å°±â¾ƒå¸¦äº†é”çš„åŠŸèƒ½ï¼Œåœ¨put<br>çš„æ—¶å€™éœ€è¦é”ä½ Segmentï¼Œget æ—¶å€™ä¸åŠ é”ï¼Œä½¿â½¤ volatile æ¥ä¿è¯å¯â»…æ€§ã€‚</p><p><strong>jdk1.8ï¼š</strong></p><p>1.ConcurrentHashMap å–æ¶ˆäº† segment åˆ†æ®µé”ï¼Œâ½½é‡‡â½¤ CAS å’Œ synchronizedæ¥ä¿è¯å¹¶å‘å®‰å…¨ã€‚æ•°æ®ç»“æ„è·Ÿ HashMap1.8 çš„ç»“æ„â¼€æ ·ï¼Œä¹Ÿæ˜¯åœ¨é“¾è¡¨èŠ‚ç‚¹æ•°è¾¾åˆ° 8ä¸ªæ—¶ï¼Œè½¬ä¸ºçº¢â¿Šæ ‘ã€‚</p><p>2.synchronizedåªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢â¿Šâ¼†å‰æ ‘çš„â¾¸èŠ‚ç‚¹ï¼Œè¿™æ ·åªè¦hashä¸å†²çªï¼Œå°±ä¸ä¼šäº§â½£å¹¶å‘ï¼Œæ•ˆç‡â¼œæå‡Nå€ã€‚ï¼ˆä¹‹å‰æ˜¯å›ºå®šçš„æ®µæ•°Nï¼Œç°åœ¨æ˜¯æ ¹æ®æ•°ç»„â»“åº¦å‘ˆçº¿æ€§å˜åŒ–çš„)</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/jxg0via1.png"></p><p><strong>2.put</strong> <strong>å®ç°</strong></p><p>ä¸hashmapâ¼¤ä½“â¼€è‡´ï¼Œå°±æ˜¯æ® key çš„ hash å€¼æ‰¾åˆ° node æ•°ç»„ç›¸åº”ä½ç½®å1.å¦‚æœç›¸åº” node è¿˜æœªåˆå§‹åŒ–ï¼Œåˆ™è°ƒâ½¤ <strong>CAS</strong> æ“ä½œæ’â¼Šç›¸åº”æ•°æ®ã€‚</p><p>2.å¦‚æœç›¸åº”ä½ç½® node ä¸ä¸ºç©ºï¼Œåˆ™ä½¿â½¤<strong>synchronized</strong>åŒæ­¥ä»£ç å—å¯¹é“¾è¡¨å’Œçº¢â¿Šæ ‘è¿›â¾æ›´æ–°æ’â¼Šæ“ä½œã€‚ä»¥æ­¤æ¥å®ç°åŒæ­¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">final</span> V <span class="hljs-title">putVal</span><span class="hljs-params">(K key, V value, <span class="hljs-keyword">boolean</span> onlyIfAbsent)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (key == <span class="hljs-keyword">null</span> || value == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();<br>        <span class="hljs-keyword">int</span> hash = spread(key.hashCode());<br>        <span class="hljs-keyword">int</span> binCount = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (Node&lt;K,V&gt;[] tab = table;;) &#123;<br>            Node&lt;K,V&gt; f; <span class="hljs-keyword">int</span> n, i, fh;<br>            <span class="hljs-keyword">if</span> (tab == <span class="hljs-keyword">null</span> || (n = tab.length) == <span class="hljs-number">0</span>)<br>                tab = initTable();<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((f = tabAt(tab, i = (n - <span class="hljs-number">1</span>) &amp; hash)) == <span class="hljs-keyword">null</span>) &#123;<br>                <span class="hljs-keyword">if</span> (casTabAt(tab, i, <span class="hljs-keyword">null</span>,<br>                             <span class="hljs-keyword">new</span> Node&lt;K,V&gt;(hash, key, value, <span class="hljs-keyword">null</span>)))<br>                    <span class="hljs-keyword">break</span>;                   <span class="hljs-comment">// no lock when adding to empty bin</span><br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((fh = f.hash) == MOVED)<br>                tab = helpTransfer(tab, f);<br>            <span class="hljs-keyword">else</span> &#123;<br>                V oldVal = <span class="hljs-keyword">null</span>;<br>                <span class="hljs-keyword">synchronized</span> (f) &#123;<br>                    <span class="hljs-keyword">if</span> (tabAt(tab, i) == f) &#123;<br>                        <span class="hljs-keyword">if</span> (fh &gt;= <span class="hljs-number">0</span>) &#123;<br>                            binCount = <span class="hljs-number">1</span>;<br>                            <span class="hljs-keyword">for</span> (Node&lt;K,V&gt; e = f;; ++binCount) &#123;<br>                                K ek;<br>                                <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;<br>                                    ((ek = e.key) == key ||<br>                                     (ek != <span class="hljs-keyword">null</span> &amp;&amp; key.equals(ek)))) &#123;<br>                                    oldVal = e.val;<br>                                    <span class="hljs-keyword">if</span> (!onlyIfAbsent)<br>                                        e.val = value;<br>                                    <span class="hljs-keyword">break</span>;<br>                                &#125;<br>                                Node&lt;K,V&gt; pred = e;<br>                                <span class="hljs-keyword">if</span> ((e = e.next) == <span class="hljs-keyword">null</span>) &#123;<br>                                    pred.next = <span class="hljs-keyword">new</span> Node&lt;K,V&gt;(hash, key,<br>                                                              value, <span class="hljs-keyword">null</span>);<br>                                    <span class="hljs-keyword">break</span>;<br>                                &#125;<br>                            &#125;<br>                        &#125;<br>                        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (f <span class="hljs-keyword">instanceof</span> TreeBin) &#123;<br>                            Node&lt;K,V&gt; p;<br>                            binCount = <span class="hljs-number">2</span>;<br>                            <span class="hljs-keyword">if</span> ((p = ((TreeBin&lt;K,V&gt;)f).putTreeVal(hash, key,<br>                                                           value)) != <span class="hljs-keyword">null</span>) &#123;<br>                                oldVal = p.val;<br>                                <span class="hljs-keyword">if</span> (!onlyIfAbsent)<br>                                    p.val = value;<br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (binCount != <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD)<br>                        treeifyBin(tab, i);<br>                    <span class="hljs-keyword">if</span> (oldVal != <span class="hljs-keyword">null</span>)<br>                        <span class="hljs-keyword">return</span> oldVal;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        addCount(<span class="hljs-number">1L</span>, binCount);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br><br><br></code></pre></td></tr></table></figure><h2 id="4-HashSet"><a href="#4-HashSet" class="headerlink" title="4 HashSet"></a><strong>4</strong> <strong>HashSet</strong></h2><h3 id="1-åº•å±‚å®ç°-3"><a href="#1-åº•å±‚å®ç°-3" class="headerlink" title="1 åº•å±‚å®ç°"></a>1 åº•å±‚å®ç°</h3><p>HashSet åº•å±‚æ˜¯ä½¿â½¤ HashMapæ¥ä¿å­˜å…ƒç´ çš„,å…ƒç´ éƒ½å­˜åˆ°HashMapé”®å€¼å¯¹çš„Keyä¸Šâ¾¯ï¼Œâ½½Valueå®ƒå®šä¹‰äº†â¼€ä¸ªç»Ÿâ¼€çš„è™šæ‹Ÿçš„Objectå¯¹è±¡ã€‚å®ƒæœ€â¼¤çš„ç‰¹ç‚¹å°±æ˜¯å¯ä»¥å»é‡ã€‚</p><p><strong>1.</strong> <strong>add</strong> <strong>â½…æ³•ï¼ˆHashSetå»é‡åŸç†ï¼‰</strong></p><p>add â½…æ³•è°ƒâ½¤çš„æ˜¯ HashMap çš„ put â½…æ³•å‘ HashSetæ·»åŠ å…ƒç´ ï¼Œå®é™…æ˜¯å¾€mapæˆå‘˜å˜é‡â¾¥â¾¯æ·»åŠ å¯¹åº”çš„keyå’Œ valueï¼Œmapä¸­çš„keyå®é™…å°±æ˜¯è¦æ·»åŠ çš„å…ƒç´ ï¼Œvalueæ˜¯â¼€ä¸ªå›ºå®šçš„å¯¹è±¡ï¼Œå…·ä½“æ“ä½œä¸ºï¼š</p><p>1.HashSet åœ¨å­˜å…ƒç´ æ—¶ä¼šè°ƒâ½¤å¯¹è±¡çš„ hashCode â½…æ³•è®¡ç®—å‡ºå­˜å‚¨ç´¢å¼•ä½ç½®<br>2.å¦‚æœå…¶ç´¢å¼•ä½ç½®å·²ç»å­˜åœ¨å…ƒç´ ï¼ˆå“ˆå¸Œç¢°æ’ï¼‰åˆ™å’Œè¯¥ç´¢å¼•ä½ç½®ä¸Šæ‰€æœ‰çš„å…ƒç´ è¿›â¾equals â½è¾ƒï¼Œå¦‚æœè¯¥ä½ç½®æ²¡æœ‰å…¶ ä»–å…ƒç´ æˆ–è€…â½è¾ƒçš„ç»“æœéƒ½ä¸º falseå°±å­˜è¿›å»ï¼Œå¦åˆ™å°±ä¸å­˜ã€‚<br>3.æ‰€ä»¥å¯ä»¥çœ‹â»…å…ƒç´ æ˜¯æŒ‰ç…§å“ˆå¸Œå€¼æ¥æ‰¾ä½ç½®çš„ï¼Œæ•…â½½â½†åºä¸”å¯ä»¥ä¿è¯â½†é‡å¤å…ƒç´ ï¼Œå› æ­¤æˆ‘ä»¬åœ¨å¾€HashSet é›†åˆä¸­å­˜ å‚¨å…ƒç´ æ—¶ï¼Œå…ƒç´ å¯¹è±¡åº”è¯¥æ­£ç¡®é‡å†™Object ç±»çš„ hashCode å’Œequals â½…æ³•ï¼Œå¦åˆ™ä¼šå‡ºç°ä¸å¯é¢„çŸ¥çš„é”™è¯¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">add</span><span class="hljs-params">(E e)</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> map.put(e, PRESENT)==<span class="hljs-keyword">null</span>; <br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>HashSet ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåº•å±‚çš„ HashMapä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒâ¾ƒç„¶å°±ä¸æ˜¯å•¦ï¼Œå¯ä»¥ä½¿â½¤Collections.synchronizedSet(new HashSet()) æ¥åˆ›å»ºçº¿ç¨‹å®‰å…¨çš„ HashSetã€‚</p></li><li><p>ç”±äº hashMap ä¸­çš„ key ä¸èƒ½é‡å¤ï¼Œæ‰€ä»¥ hashSet ä¸èƒ½å­˜å‚¨é‡å¤å…ƒç´ ï¼›</p></li></ul><h3 id="2-å¦‚ä½•é¿å…HashSetçš„å¹¶å‘é—®é¢˜ï¼Ÿ"><a href="#2-å¦‚ä½•é¿å…HashSetçš„å¹¶å‘é—®é¢˜ï¼Ÿ" class="headerlink" title="2.å¦‚ä½•é¿å…HashSetçš„å¹¶å‘é—®é¢˜ï¼Ÿ"></a><strong>2.å¦‚ä½•é¿å…HashSetçš„å¹¶å‘é—®é¢˜</strong>ï¼Ÿ</h3><ol><li><p>CopyOnWriteArraySet</p><p>CopyOnWriteArraySetåº•å±‚å®ç°æ˜¯åˆ©â½¤æ•°ç»„ï¼Œå®ƒçš„ä¸Šå±‚å®ç°æ˜¯CopyOnWriteArrayListã€‚</p><p>CopyOnWriteArraySetæ˜¯â¼€ä¸ªé›†åˆï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸å¯ä»¥æ”¾ç½®é‡å¤çš„å…ƒç´ çš„ï¼Œå®ƒçš„å–é‡é€»è¾‘æ˜¯åœ¨addä¸­ä½“ç°çš„ã€‚</p><p>CopyOnWriteArraySet æ˜¯åˆ©â½¤ CopyOnWriteArrayListæ¥å®ç°çš„ï¼Œå› ä¸ºCopyOnWriteArrayList æ˜¯çº¿ç¨‹å®‰å…¨ çš„ï¼Œæ‰€ä»¥CopyOnWriteArraySet æ“ä½œä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„</p></li></ol>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>é‡‘æ•°æ®</title>
    <link href="/%E9%87%91%E6%95%B0%E6%8D%AE/"/>
    <url>/%E9%87%91%E6%95%B0%E6%8D%AE/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="6e5cf84ba6f8601f955c633382261fd14ff40164f93432e3d76d3a8574c8aa1d">ffda66bfab181c2acf199c136e56147374682d524a8b022b9f8c35ea0638a7c0cb66cc052f523f3922af786a9e652a8786ad54893e4aeeb0e23155bf5fafd49e32d00216adb3b598dcf36e30c085848cf474ea89f81ede7d801d23ce18681b95947d5388f3bb70ed173538391456d9256fbbfb7f6d79f2abdb5cd06683d6ad25b5ed493a5ab9ffcd057bd440a9d6a0a3359571b35124aaba36c6fcc7b9e652b93ead65af05890b07ed8c658ee253c9b874bb727e722d2d002b9d3e9f9a94c0944aad441f9fa9f525a0f8ef5394f23504e80bcca6cb35253fd2430679f4a0d07f7c12d13c07481e147edbb8ae7ca98158d1428d7adc9f5ff45cc05f16d1ea9dc0f8625baa852cec6a46ec7b3b32188bad959d84fae100033b8b6adef46518439005aa0fce2ebf06afcc8b4762c1328c3730f9fd4e68348b0a46c7191dffee7d010810bb3bd1bf54b982a963e8d94e9a158fad6ef33064ce00b4f40182a7f5c2d5f3f5c0ead2cabeebfbe8d69a2186e08c03c3bc1c18981e9bd52b6c9169c4f5ba79b780b41b9c5d7ddacf029200b0c410c4c3f06a0854831db5b90461bfab2d11be04a88414a4123e30e01f6b4ad614e8c1b868b5c87889580670c948738036a95ff7a7be75627244a6d40e632b1199276f66819a3847d0c1d5bd9ad00d7c1836a8b080ea5658e74210845c1346c60af7ba42fae7a0ddbaa460dcf2804a3dba8fdfd5a600fb99c5f694024ea71194de2f2903d64074a96c89b176b1cc86903fc7590b71c0154f30bda7a6fa7bac9bff491b5564e6982793decd656387a31bbdce055d2e92060b62e63ea565ff74a4786024ace51f449925e02cbab01c9cd63686ea4409274ed10013bd56e53ee22d91ff5f3ffe51934fe91c0a750fa05b19fb0c2ba539fd35b1396f32efd1fec203f915e5ead84c9282c86d841568933289c827cf6c0a35a7096de85136dbf007e8b9072a12be6650fb748810df031bf33f5fff46ee919c7d5b47ac6973167d66b18fded230fb27307917c5e1317cde9b0c92856d17b8d69ac538788b23893d94b6f21b833e601970e1fcdbec9b4e4d2256a1a5dd49429e7dd31a81372c4fd2007159354796a9ea668327df7b61872c54c8a46f2fd736c6aa09050eec5008cbd89ddf1c1bca59c7eae27618f96804e33e1c2f5dec3a0609e32dbc5e9761dc98b7f612c6cea4ff696fe6c9100bfe6bb5157f22038e67097cb89ac5f814ab675315fe6d4e8c60a45425787c3a4ac8a7cbbab38fe2d1a26747958529ea250047af32e3e20ba761f071712984171e4b477d108359b59334721f3eb8d57d236583c7515cd7e1846ff781a243e0b2658268ccbc3804a35452931f8ac268fa7a92a1158d7e3dfbfd41e79b37f0567a9191eaae31a60df388a5551f31d08db2a7274e8a6447f7ab1f008f72b92fee342d8f0312cd6fd614dbf113b6002881b2b1a085ed56fb49d479020baf39276e89cf175b9987ef1703148f60f08417d9ee538400bf669c963d8e15ff8245df6eb9e6466b2bc5c339c5b0af0c379aa77a43fb487bf8425b4b2d5ceb42b029d92328f16ee261eff49d15cfe5538ed145f807cf98e3dcb673ec683e233cedab1df588a8f6dde0f40b0606f40cf95139a04c7a97c2446f20529232779b9e52cf8ea393f6df17a6e1a49451a8fbe6bcdf0017f96bf2695f403bd940e00638bf2e1bbdc9f1cd56af5522c966b602bf6cdea93b7502712afc68a7eb615313120a282fc208f8036fcf14d6047f2c4a32a25c75085f6fb90dc6f66f75bb3a1e5e83f8d3dc3b76578c441c026adb278f9c9d74ae0917e02bb9a19076fdbe281ce5c7da226fd722efb990e1bc8d970aa85f1078fa96237a51f993610ac8fa6dbe6fcfb43384951461013f308d1cafc73628f0d369866d07401fc98726b45452feb1e68324e98ee1c056de44a794709a15789717021aa112247eba4107393d708eb111e13475430c99e9b1f02353f70877a5dc903249657c3f92f66e8039e4e7b313a16fae66d23258ecd617c0c3495245fe30943f54b4de07f932a3389d1d7a520204b6c23394d049e5de8881b7d4b2f2b110646f9f97f77dbd2b3b4dabfbfae7e5ce863ef35de1b40671d8d499b83e8917063721f8b46cc0f35c196fe09983a3587ed15d362c7226690320a9c94418672eedfb0744450279c116d6d4016d4a30c5e9d36086675b04e4cdcbfc85018ff9131777985e721c86c97ccd98f31666339d49d55c5188bc109ab302382993abe65825708adbeed5567b83e9bda8eeefb1af412e5b19eac75c7d384e93a2764776db824957206752a73ad0373343751b3062ee1f767e72d619b902811c6891a0636a1bbcf61c25b39f8aa7cd88f0e64c3d309baf7858ded067e6d26912f20d25f79f3bc8623b9ab3561a23efdae334b853e20d294d7e6774cf09ced33192e2834914044978d7f532c7d46660463bef92612c29d5d755042c1d5fb2ad35231eeaf8c72af060da1915fed81c2a58c4701201a3a98746ceb61aa50343e19d922abd5f7e57cbca872ab1c0d35873efa17ba1caaa8ad2c55416e74e66ac3476cc952231da8aa9e00e9065a2b1c70b662872ea805dfea27bf273f1bf82bec9330771eafda479d84ae835a9e24da7c6e6b0afb8d66d19a093612bb4c758d7cc514f9068058a134276402aaa52732fafb429cd5d116eda4f2f117205ebc2efb073a7d4a30536ec1a4f9cebb04798b3318e2f4398306efc849b7d9b30b46e7c1afbbcf8dcad38bdd73f32635ff8fd20cdc75a0051f7d01ef2f48fa4bd16c66993173a9a366fb4c4ca681892941271d4fadfdd1ddee8cb789c8f13071a0c5274bc8585c42370ea9e1563dadbb65b01e6d52f9c5b58cd116aef96166fb8d96bf1c964f932f119c1b1e89f66e7cae02a48775002b95cac4b1839d9feaf36f97eec254f4f4e896fc5330f523882667a727a449befbce63811cfe9156f8d2eff53407d85c56f0f1bda4f7eedd163089938c435b4e948c02d557e3a99165675bad114d8fd669fda2114f02ea01049a96578f7a79533ae72b1ff1eb93083e229774561fb430de1a4ad250390b374482d895597a2e0b90cc1f04e045c812a8329341a23879ae4e546b91ae6cbbd4faa053af14a19ddbb3a16ebce41d020fc094cf5e37688d82f02d5f0e5506249984d7c1e469de9030738f1daa8fbd90978a44fb2549eed40329bee0b7e06b5d23eafbe54a4a49517d3c882b8068ad9371ed246b291c55d5a82dd3206d7f44f9f725f8c609a542a0494180a425af2deb7f5bddaf54404d303bcc5d3903e22957dc917219e5568b6cf5cfdb64786c921601e602e96b98c65e9d31b8d536cff257d7f09a06444f62f900970</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>dubbo3.0</title>
    <link href="/dubbo/"/>
    <url>/dubbo/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Dubboå’ŒFeignçš„åŒºåˆ«å’Œè”ç³»"><a href="#1-Dubboå’ŒFeignçš„åŒºåˆ«å’Œè”ç³»" class="headerlink" title="1. Dubboå’ŒFeignçš„åŒºåˆ«å’Œè”ç³»"></a>1. Dubboå’ŒFeignçš„åŒºåˆ«å’Œè”ç³»</h1><h1 id="1-é€‰æ‹©å»ºè®®"><a href="#1-é€‰æ‹©å»ºè®®" class="headerlink" title="1. é€‰æ‹©å»ºè®®"></a>1. é€‰æ‹©å»ºè®®</h1><ul><li>å¦‚æœä½ çš„ç³»ç»Ÿæ˜¯ <strong>ä¸­å°å‹å¾®æœåŠ¡æ¶æ„</strong>ï¼Œæ›´æ³¨é‡å¼€å‘æ•ˆç‡å’Œæ˜“ç”¨æ€§ï¼Œä¸”ä¸»è¦ä½¿ç”¨ HTTP åè®®è¿›è¡ŒæœåŠ¡é—´é€šä¿¡ï¼ŒFeign æ˜¯ä¸€ä¸ªæ›´ç®€å•ã€æ›´è½»é‡çº§çš„é€‰æ‹©ã€‚</li><li>å¦‚æœä½ çš„ç³»ç»Ÿæ˜¯ <strong>å¤§è§„æ¨¡åˆ†å¸ƒå¼æ¶æ„</strong>ï¼Œå¯¹æ€§èƒ½è¦æ±‚è¾ƒé«˜ï¼Œå¹¶ä¸”éœ€è¦å¼ºå¤§çš„æœåŠ¡æ²»ç†èƒ½åŠ›ï¼ˆè´Ÿè½½å‡è¡¡ã€æœåŠ¡é™çº§ã€é™æµã€è·¯ç”±è§„åˆ™ï¼‰ï¼Œå»ºè®®ä½¿ç”¨ <strong>Dubbo</strong>ã€‚</li><li>å¦‚æœä½ çš„é¡¹ç›®å·²ç»ä½¿ç”¨äº† Nacosã€Sentinelã€Seata ç­‰é˜¿é‡Œå·´å·´å¼€æºç»„ä»¶ï¼ŒDubbo çš„é›†æˆä¼šæ›´åŠ é¡ºç•…ã€‚</li></ul><h1 id="2-å¼‚åŒç‚¹"><a href="#2-å¼‚åŒç‚¹" class="headerlink" title="2. å¼‚åŒç‚¹"></a>2. å¼‚åŒç‚¹</h1><h2 id="1-ç›¸åŒç‚¹"><a href="#1-ç›¸åŒç‚¹" class="headerlink" title="1. ç›¸åŒç‚¹"></a>1. ç›¸åŒç‚¹</h2><ol><li><p>éƒ½æ˜¯ <strong>RPC æ¡†æ¶</strong></p><ul><li>Dubbo å’Œ Feign éƒ½æ˜¯ç”¨æ¥è§£å†³å¾®æœåŠ¡ä¹‹é—´çš„è¿œç¨‹è°ƒç”¨é—®é¢˜ã€‚</li><li>å®ƒä»¬çš„æ ¸å¿ƒç›®æ ‡éƒ½æ˜¯è®©å¼€å‘è€…åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·è°ƒç”¨è¿œç¨‹æœåŠ¡ã€‚</li></ul></li><li><p>éƒ½<strong>æ”¯æŒæœåŠ¡å‘ç°</strong></p><ul><li>Dubbo å’Œ Feign éƒ½å¯ä»¥ä¸æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ˆå¦‚ ZooKeeperã€Eurekaã€Nacos ç­‰ï¼‰é›†æˆï¼Œå®ç°æœåŠ¡çš„åŠ¨æ€å‘ç°å’Œè·¯ç”±ã€‚</li></ul></li><li><p>éƒ½<strong>æ”¯æŒè´Ÿè½½å‡è¡¡</strong></p><ul><li>Dubbo å’Œ Feign éƒ½æä¾›äº†è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿå°†è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å®ä¾‹ã€‚</li></ul></li><li><p>éƒ½<strong>æ”¯æŒå£°æ˜å¼ç¼–ç¨‹</strong></p><ul><li>Dubbo å’Œ Feign éƒ½å¯ä»¥é€šè¿‡æ¥å£å®šä¹‰æœåŠ¡ï¼Œå‡å°‘æ‰‹åŠ¨ç¼–å†™ä»£ç çš„å·¥ä½œé‡ã€‚</li><li>Feign çš„å£°æ˜å¼é£æ ¼æ›´åŠ ç®€æ´ï¼Œè€Œ Dubbo çš„é…ç½®ç›¸å¯¹å¤æ‚ä½†åŠŸèƒ½æ›´å¼ºå¤§ã€‚</li></ul></li><li><p>éƒ½<strong>é€‚åˆå¾®æœåŠ¡æ¶æ„</strong></p><ul><li>Dubbo å’Œ Feign éƒ½æ˜¯ä¸ºå¾®æœåŠ¡æ¶æ„è®¾è®¡çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿã€‚</li></ul></li></ol><h2 id="2-åŒºåˆ«"><a href="#2-åŒºåˆ«" class="headerlink" title="2. åŒºåˆ«"></a>2. åŒºåˆ«</h2><ol><li><p>ä½¿ç”¨çš„é€šä¿¡åè®®ä¸åŒ</p><ul><li>dubboé»˜è®¤ä½¿ç”¨è‡ªå®šä¹‰çš„äºŒè¿›åˆ¶åè®®ï¼ˆDubbo åè®®ï¼‰ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–åè®®ï¼ˆå¦‚ HTTPã€gRPC ç­‰ï¼‰ã€‚Dubbo åè®®åº•å±‚åŸºäº TCP è¿›è¡Œé€šä¿¡ï¼Œæ€§èƒ½è¾ƒé«˜ï¼Œå»¶è¿Ÿè¾ƒä½ã€‚</li><li>Feignä½¿ç”¨æ ‡å‡†çš„ HTTP&#x2F;HTTPS åè®®è¿›è¡Œé€šä¿¡ã€‚ä¾èµ– RESTful é£æ ¼çš„æ¥å£è®¾è®¡ã€‚</li></ul></li><li><p>åºåˆ—åŒ–æ–¹å¼ä¸åŒ</p><ul><li>Dubboæ”¯æŒå¤šç§åºåˆ—åŒ–æ–¹å¼ï¼Œå¦‚ Hessianã€Protobufã€JSON ç­‰ï¼Œé»˜è®¤ä½¿ç”¨é«˜æ•ˆäºŒè¿›åˆ¶åºåˆ—åŒ–ï¼ˆå¦‚ Hessian2ï¼‰ã€‚é€‚åˆå¯¹æ€§èƒ½è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ã€‚</li><li>Feignæ”¯æŒå¤šç§åºåˆ—åŒ–æ–¹å¼ï¼ŒåŒ…æ‹¬ JSONã€XMLã€Form è¡¨å•ç­‰ï¼Œé»˜è®¤ä½¿ç”¨ JSON åºåˆ—åŒ–ï¼Œè™½ç„¶ç®€å•æ˜“ç”¨ï¼Œä½†æ€§èƒ½ä¸å¦‚äºŒè¿›åˆ¶åºåˆ—åŒ–ã€‚</li></ul></li><li><p>å¯¹æ³¨å†Œä¸­å¿ƒä¾èµ–ç¨‹åº¦ä¸åŒ</p><ul><li>Dubboå¼ºä¾èµ–æ³¨å†Œä¸­å¿ƒï¼ˆå¦‚ ZooKeeperã€Nacosã€Consul ç­‰ï¼‰æ¥ç®¡ç†æœåŠ¡çš„åœ°å€ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯é€šè¿‡æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡æä¾›è€…çš„åœ°å€åˆ—è¡¨ï¼Œä»è€Œå®ŒæˆæœåŠ¡è°ƒç”¨ã€‚</li><li>Feignå¯ä»¥ä¸ Eurekaã€Consul ç­‰æœåŠ¡æ³¨å†Œä¸­å¿ƒç»“åˆä½¿ç”¨ï¼Œä½†æœ¬èº«ä¸å¼ºåˆ¶ä¾èµ–æ³¨å†Œä¸­å¿ƒï¼Œå½“æœåŠ¡åœ°å€å›ºå®šæˆ–é€šè¿‡é…ç½®æ–‡ä»¶æŒ‡å®šæ—¶ï¼ŒFeign ä¹Ÿå¯ä»¥ç‹¬ç«‹å·¥ä½œã€‚</li></ul></li><li><p>å®ç°è´Ÿè½½å‡è¡¡çš„æ–¹å¼ä¸åŒ</p><ul><li>Dubboå†…ç½®äº†å¤šç§è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼ˆå¦‚éšæœºã€è½®è¯¢ã€ä¸€è‡´æ€§å“ˆå¸Œç­‰ï¼‰ã€‚</li><li>Feignä¾èµ– Spring Cloud LoadBalancer&#x2F;Ribbonï¼ˆSpring Cloud çš„è´Ÿè½½å‡è¡¡ç»„ä»¶ï¼‰å®ç°è´Ÿè½½å‡è¡¡ã€‚</li></ul></li><li><p>æ”¯æŒå®¹é”™æœºåˆ¶æ–¹å¼ä¸åŒ</p><ul><li>Dubboæä¾›å¤šç§å®¹é”™ç­–ç•¥</li><li>Feigné›†æˆ Hystrix å®ç°ç†”æ–­å’Œé™çº§</li></ul></li></ol><h1 id="4-dubboä½¿ç”¨"><a href="#4-dubboä½¿ç”¨" class="headerlink" title="4. dubboä½¿ç”¨"></a>4. dubboä½¿ç”¨</h1><p>å®ç° UserServiceï¼ˆæœåŠ¡æä¾›è€…ï¼‰</p><p>åœ¨æœåŠ¡æä¾›è€…æ¨¡å—ä¸­å®ç° <code>UserService</code> æ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.example.service;<br><br><span class="hljs-keyword">import</span> com.example.api.UserService;<br><span class="hljs-keyword">import</span> org.apache.dubbo.config.annotation.DubboService;<br><br><span class="hljs-meta">@DubboService(version = &quot;1.0.0&quot;)</span> <span class="hljs-comment">// å£°æ˜è¿™æ˜¯ä¸€ä¸ª Dubbo æœåŠ¡</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserService</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">sayHello</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello, &quot;</span> + name + <span class="hljs-string">&quot;!&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è°ƒç”¨ UserServiceï¼ˆæœåŠ¡æ¶ˆè´¹è€…ï¼‰</p><p>åœ¨æœåŠ¡æ¶ˆè´¹è€…æ¨¡å—ä¸­é€šè¿‡ <code>@DubboReference</code> æ³¨è§£å¼•ç”¨è¿œç¨‹æœåŠ¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.example.consumer;<br><br><span class="hljs-keyword">import</span> com.example.api.UserService;<br><span class="hljs-keyword">import</span> org.apache.dubbo.config.annotation.DubboReference;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloController</span> </span>&#123;<br><br>    <span class="hljs-meta">@DubboReference(version = &quot;1.0.0&quot;)</span> <span class="hljs-comment">// å¼•ç”¨è¿œç¨‹æœåŠ¡</span><br>    <span class="hljs-keyword">private</span> UserService userService;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">hello</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam</span> String name)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> userService.sayHello(name); <span class="hljs-comment">// è¿œç¨‹è°ƒç”¨ sayHello æ–¹æ³•</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>howxmåå°è®¾è®¡</title>
    <link href="/howxm%E5%90%8E%E5%8F%B0%E8%AE%BE%E8%AE%A1/"/>
    <url>/howxm%E5%90%8E%E5%8F%B0%E8%AE%BE%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="fbb08d7055a81b1c2927920f139228550f78d6fef045ef4ea3e500eb43e23ba0">ffda66bfab181c2acf199c136e56147374682d524a8b022b9f8c35ea0638a7c0263079da70fca6ed3fa9937b472a75a43e36575b9bdd82a12137a631acd9d426e1920435f87905a237e03ce266ae4d25338c220aeaa0dfdeccad85d019a474861b38c88bee9b6ed96d9be009f759c55e2e270b74b7a19340cc610ca63472ad99c97ad35b34121e626e1b71b5775d33b9ea934489fe563ee0a5923d74baecc49c80aec4700f19a2649f44b91925bae63ae8c058a3a56d505adf0374c87d6236ea745db9ecb4e739f84aa436f22abfb62086827436c9da65247bb24a315224a47328a7788fb7477c79c61ae5acaee1b84c9f14c53214da631803f1577d79671e7ce6b383368d939690b6ecc19f960cf30d18384b1add1fb8f5913f793354e26f11c6f8e5c4ecefa499dfb9791376098f216b408f4d9fcba05e0d40c4136e2a4f846e5ca4177a6fadaa019788650c0a4b0a84d3c02d40358f7d9202d2a2884166ca9d202341b0a2959ff1fa559b3aa4a1502b62f2b0412a56b7840c9278007fecff21ddde94204820464933823aed7f32f4e9b3c12af10ced9bb213082171803b49efac81f9aea2221f1633e68c99f407d2fcfd29e1e75ccafc414b2f7a39926514da22cedac5239d4858a226f5f8f41df87177d26c58178995b1895b765e05b1b185e988e766bb5ffa82b3520d4f6a28e32d294474724b6e7cd6e525fc5d6791eecceab2abc1f74aaf3faebfc2c5f4d34f01a2fe27b9490b7fd9c84c3e505ec30e01408866589b283055e719f354d6a2eaee7f26eb689945b2745480a46a2164826c1816ec2341596cee0e69c135dcdadab4fd4752581d2f1eb32ca8e1d3d41bb4ad79230ba6087d1c8d05b84584299767251137285118c996aea8ee3b4de08e422cce3f0749a097dae6a0280d2115ebcf7ec7f42daea020f669509023588794f8f875dd3da6bab4113779ad49f0277bbfae8ef3dd6cb3546f5e9178e6922d1c9bcd0f6572d18d4771c2458b88299ffb3658d2a59abcc99bea757e2844d5e2d329b3a34c72d1eed48cf682b92e0dc2039e3918de07911184717ae57960bb6146a0b01b173a8e1684a3145decc5eaf91f12d6a41581b08c3863e083a916954efd4e8b26a3ed1a03d1dc34b0a39a9114d8f3446fa0aa9a752ec8afbbf2bbd0666cba9f6c2e63c5ea0cb5ee43ed6876c139480fc1ded7964640862ab138f48e622e0f6ba14dec161872d18475558308dd6bb273540b8e5fca9797dd522e4c796e2f9b02a0178c198b9e42628882b70341a8cbbb28f20c7eaf869dbdf15b9d14e64e0e30c2004a5ebefcccb5e57d5da031ddf6c3649bb0f1d26b9933f1802cd649ed82dd2060bca3064e36eb5b07558fb7e8c5d506ea6e69ee3ab611760b838e73cd9b18b9c9b7079594d5420015c377f5784c0c61fb57f5493bb2cc13dfcfa0d39bad8622c817aef25cc9687ab26fc7f835c3b7d48bde47a2bac90d1e32bbf77d5be3ab3f2efd984271111a84c9b2bde98bca449585fad3f378528a93b5e7582e7101694d6232ecaf366177256438545569860d57852b61788ca63955e20b013c156b38464701c33f6ab6164bef6d02316200b73b30e2fd22d5840e4bbc435551fae928c29186109871ed16ad290e8cc5223a0e8570985b9a6fcfbf369c6b0a9b81ae1c26cbfb81597f4f3c210db459223cb95de2ce99c19dbc8db2a937e9d1cdc4e7aae5b397f6a6aecdf855d9877215368fec3ebc0d2ac79ecf58dde1ec8e719646a0960aa012c8e1efb7a2cc0d73191eef6e64152c3f110f9a44efae4e1ee7cb24b44760f90ec71d44ced55f9b64f1988564ef59becca0993c4dfc8e1517718a4167dbd3d8b51028e0277a34ffb68b3b2f9647e275d54c031173b649ea1db1f9a7e65b37495be76ea8f9927d981c7f8bd3f0cc39982345ba88bb0598129f688627692c9770c2619ecea708674bd2350482a4a9ef35115bbfd20a0360a115ab39ccb2f7351f5cfc100271bc4efc094944e4ffa67b0ef9510132c938c8e59ec289bb7fc3e5beed71fd27689c568db04c1bf08e1e1574ef2c34c81384096ede3a17ef50388cc3e6ef9fbecf54807064998e18789bb82ce4cf3189aae8f3da6763aa6ac2af477b876585b5bbe0a33e7c58f8851f045191e5bf1d9dc3f218c24f16794525cb745ab22fb3383431f43fc6fe6d7c0993c932a8e89dfd28b6186634706eaedb669f601827f04e91c2673eb853e19a86bd8c7d59833c8dc37c61fb9f104e2e489df3f47dd9a9e4c385db616af41e8b0ee9b694b664d7172ed40b3d59beb563</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>k8så¸¸ç”¨å‘½ä»¤</title>
    <link href="/k8s%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <url>/k8s%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<ul><li><h4 id="1-ç”¨é¢‘ç‡æœ€é«˜çš„K8så¸¸ç”¨å‘½ä»¤"><a href="#1-ç”¨é¢‘ç‡æœ€é«˜çš„K8så¸¸ç”¨å‘½ä»¤" class="headerlink" title="1. ç”¨é¢‘ç‡æœ€é«˜çš„K8så¸¸ç”¨å‘½ä»¤"></a>1. ç”¨é¢‘ç‡æœ€é«˜çš„K8så¸¸ç”¨å‘½ä»¤</h4><ul><li><code>kubectl get</code>: è·å–èµ„æºçš„ä¿¡æ¯ï¼Œå¦‚è·å–Podã€Serviceã€Deploymentç­‰èµ„æºçš„çŠ¶æ€ä¿¡æ¯ã€‚</li><li><code>kubectl create</code>: åˆ›å»ºèµ„æºï¼Œå¦‚åˆ›å»ºPodã€Serviceã€Deploymentç­‰èµ„æºã€‚</li><li><code>kubectl delete</code>: åˆ é™¤èµ„æºï¼Œå¦‚åˆ é™¤Podã€Serviceã€Deploymentç­‰èµ„æºã€‚</li><li><code>kubectl apply</code>: åº”ç”¨é…ç½®æ–‡ä»¶ï¼Œå¦‚åº”ç”¨Deploymentçš„é…ç½®æ–‡ä»¶ã€‚</li><li><code>kubectl describe</code>: æŸ¥çœ‹èµ„æºçš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚æŸ¥çœ‹Podã€Serviceã€Deploymentç­‰èµ„æºçš„è¯¦ç»†é…ç½®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚</li></ul><h4 id="2-éš¾åº¦è¾ƒé«˜çš„K8så¸¸ç”¨å‘½ä»¤"><a href="#2-éš¾åº¦è¾ƒé«˜çš„K8så¸¸ç”¨å‘½ä»¤" class="headerlink" title="2. éš¾åº¦è¾ƒé«˜çš„K8så¸¸ç”¨å‘½ä»¤"></a>2. éš¾åº¦è¾ƒé«˜çš„K8så¸¸ç”¨å‘½ä»¤</h4><ul><li><code>kubectl exec</code>: åœ¨å®¹å™¨å†…éƒ¨æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚åœ¨Podå†…éƒ¨æ‰§è¡Œå‘½ä»¤æˆ–è®¿é—®å®¹å™¨å†…éƒ¨çš„ç»ˆç«¯ã€‚</li><li><code>kubectl port-forward</code>: å°†é›†ç¾¤å†…çš„æœåŠ¡ç«¯å£è½¬å‘åˆ°æœ¬åœ°ï¼Œç”¨äºæœ¬åœ°è®¿é—®é›†ç¾¤å†…çš„æœåŠ¡ã€‚</li><li><code>kubectl logs</code>: æŸ¥çœ‹Podçš„æ—¥å¿—ä¿¡æ¯ï¼Œå¦‚æŸ¥çœ‹å®¹å™¨çš„æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºã€‚</li><li><code>kubectl scale</code>: è°ƒæ•´èµ„æºçš„å‰¯æœ¬æ•°ï¼Œå¦‚è°ƒæ•´Deploymentçš„å‰¯æœ¬æ•°ã€‚</li><li><code>kubectl rollout</code>: æ§åˆ¶åº”ç”¨çš„æ»šåŠ¨æ›´æ–°ï¼Œå¦‚è¿›è¡Œç‰ˆæœ¬å‡çº§æˆ–å›æ»šã€‚</li></ul><h4 id="3-æ˜“é”™çš„K8så¸¸ç”¨å‘½ä»¤"><a href="#3-æ˜“é”™çš„K8så¸¸ç”¨å‘½ä»¤" class="headerlink" title="3. æ˜“é”™çš„K8så¸¸ç”¨å‘½ä»¤"></a>3. æ˜“é”™çš„K8så¸¸ç”¨å‘½ä»¤</h4><ul><li><code>kubectl get pods</code>: è·å–Podçš„ä¿¡æ¯æ—¶ï¼Œå¸¸å¸¸å¿˜è®°åŠ <code>s</code>ï¼Œå¯¼è‡´æ— æ³•è·å–åˆ°Podçš„çŠ¶æ€ä¿¡æ¯ã€‚</li><li><code>kubectl create -f &lt;file&gt;</code>: åˆ›å»ºèµ„æºæ—¶ï¼Œå¿˜è®°æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œå¯¼è‡´èµ„æºæ— æ³•åˆ›å»ºæˆåŠŸã€‚</li><li><code>kubectl delete pod &lt;pod-name&gt;</code>: åˆ é™¤Podæ—¶ï¼Œå¿˜è®°æŒ‡å®šPodçš„åç§°ï¼Œå¯¼è‡´æ— æ³•åˆ é™¤æŒ‡å®šçš„Podã€‚</li><li><code>kubectl apply -f &lt;file&gt;</code>: åº”ç”¨é…ç½®æ–‡ä»¶æ—¶ï¼Œå¿˜è®°æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œå¯¼è‡´é…ç½®æ–‡ä»¶æ— æ³•ç”Ÿæ•ˆã€‚</li><li><code>kubectl describe &lt;resource&gt;</code>: æŸ¥çœ‹èµ„æºçš„è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œå¿˜è®°æŒ‡å®šèµ„æºçš„åç§°ï¼Œå¯¼è‡´æ— æ³•è·å–åˆ°è¯¦ç»†ä¿¡æ¯ã€‚</li></ul><h4 id="4-å…¶ä»–å‘½ä»¤"><a href="#4-å…¶ä»–å‘½ä»¤" class="headerlink" title="4. å…¶ä»–å‘½ä»¤"></a>4. å…¶ä»–å‘½ä»¤</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Kubernetes</span>ï¼ˆK<span class="hljs-number">8</span>sï¼‰ å¸¸ç”¨å‘½ä»¤~<br></code></pre></td></tr></table></figure><ol><li>kubectl get podsï¼šè·å–å½“å‰é›†ç¾¤ä¸­æ‰€æœ‰çš„Podsã€‚</li><li>kubectl describe pod [podåç§°]ï¼šæ˜¾ç¤ºæŒ‡å®šPodçš„è¯¦ç»†ä¿¡æ¯ã€‚</li><li>kubectl create -f [yamlæ–‡ä»¶]ï¼šä½¿ç”¨yamlæ–‡ä»¶åˆ›å»ºä¸€ä¸ªèµ„æºï¼ˆå¦‚Podã€Deploymentç­‰ï¼‰ã€‚</li><li>kubectl apply -f [yamlæ–‡ä»¶]ï¼šä½¿ç”¨yamlæ–‡ä»¶åˆ›å»ºæˆ–æ›´æ–°ä¸€ä¸ªèµ„æºã€‚</li><li><code>kubectl delete pod [podåç§°]</code>ï¼šåˆ é™¤æŒ‡å®šçš„Podã€‚</li><li>kubectl scale deployment [deploymentåç§°] â€“replicas&#x3D;[å‰¯æœ¬æ•°é‡]ï¼šæ‰©å±•æˆ–ç¼©å‡æŒ‡å®šDeploymentçš„å‰¯æœ¬æ•°é‡ã€‚</li><li>kubectl exec -it [podåç§°] [å‘½ä»¤]ï¼šåœ¨æŒ‡å®šçš„Podä¸­æ‰§è¡Œå‘½ä»¤ã€‚</li><li>kubectl logs [podåç§°]ï¼šæŸ¥çœ‹æŒ‡å®šPodçš„æ—¥å¿—ã€‚</li><li>kubectl port-forward [podåç§°] [æœ¬åœ°ç«¯å£]:[è¿œç¨‹ç«¯å£]ï¼šå°†æœ¬åœ°ç«¯å£ä¸Podä¸­çš„ç«¯å£è¿›è¡Œè½¬å‘ã€‚</li><li>kubectl get deploymentsï¼šè·å–å½“å‰é›†ç¾¤ä¸­æ‰€æœ‰çš„Deploymentsã€‚</li></ol></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>MESç³»ç»Ÿåå°è®¾è®¡</title>
    <link href="/MES%E7%B3%BB%E7%BB%9F%E5%90%8E%E5%8F%B0%E8%AE%BE%E8%AE%A1/"/>
    <url>/MES%E7%B3%BB%E7%BB%9F%E5%90%8E%E5%8F%B0%E8%AE%BE%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="94649eda5b82adbe18f574dce6682723b4c2e391bb00685cbfdcbdbcb2169475">ffda66bfab181c2acf199c136e56147374682d524a8b022b9f8c35ea0638a7c0968d8fa93c1632ca0eca11e8328051aac950ca88cc17aad4c97c33df2dd5dcaf79ea33e0b361896167545efc6e85d8224f0857b51eb0ffc0d607b1ab93a8bb4f46e82b9d380f54f438e337b6bece1b828dc3d412a2ba4e90764bbdf9098ce7208c50434bdd5d9598f6cde2fc386c0641f3481abdbeed28b3c6d26cf8d3482ce3c59f0e61fdd81db351e7116bce13e0f2ce2bdccfe58bb88dc085087f7409853671e42eb0635ae49f2773813258e743e7d8d1bb9f2333c5c84b5e35f3f360907b389441120a0af7c1ed2840e7d7287b469b9872f890a39ae827bd43e52ccf51d9be5229d59ba46e3487b82d855819d9a365522efa3d7a11b95e34d677bd4255e2f13e2be5280091cefbe471e10dc03a6b8854e47c195a579bdca11b0d9ac16e3cb48ff512e56695bc8a5a6cdf64d60b9b82cc9c26f473ded6d111de7dfbe765feceb764c67166db15307131bc63de96e2d1424428a8d5698ecdfe840f579843b930a6a8052982828eccac31e8689080f35fa82f01de7b2b4e3d439b9ed39853988defaf1c92d458af67a8aee1bc337bcdda9cc9cec86e79e16e6a11983b84996cdc58c9a25b6869dabe17c296167911dee4a078c8e70c7539fc7bddbe67fbd4df5dcc2e2c819136202a647b1dd6c4a4b6976360ff3726577876546b40df0e9d5baa0f64bd6dfe2473502c8a62e7f4032f6d9bc87d919c4f1258f9166c4b19231d62de642246653e02d6fe4bea093de2b4eb0ce76e22b71a1b7fd18478b5a3d41e8f75725e01feda44500e8721b15c6dbd4e6769d174696c1a7d0c9c26b3a0c469cbd33cac2793fe1c528a1566cce31eb363ce4791ff58f47fa9eee433902a6cb039f4871b74e7f1010a4944088c0e01b0f5586efcffb43efb38ea6b46e8c65d7862c4ebdde456454329dd7449a48684fae29690b368805c955e88e754e6ec0a39a6494b2e01a37175286bc1aaf13f9e260ef547fa0fd1a68caba817c8732d1aa26c7951297357f541dc86d93df126fa65faba9b400264e9901de2ac713f4c47e544df65481a03e633fb01533566f2e2e38355ae8e1aa2b3499954af4c31014b9d338fc26af3db0165b88f988407a0a7e98d92d147e00c793f238d494293811c5c65b8269d3451ac0fa0f2e41c2f0061f11727555bb109502757e6fddcd34b3ae8ea689fe78376b33ef5536bba153ff58f8fe2bd83688bb9064243b0b0f3d89dba405b1650131598ac30e0d8ba3ad4f388861461f1cec05334dd68a8e34f0daa355ca97b6674d7dc6ad357d4b27b2f34153abcddf11751070db026d2be548e61198362d61241f280b6965cff7874734fa34fe1685ee8cc198fbcbd16e3985de3665d81f0db44e6b115f9e7faf3c3f55053448d0a34b1664c0cfc04a658ac3756e1be4986d4f4b47570c5976cc7125391e3e5e0b47919205ac942f1cdd54f8e7f44893ca0affbb6a6a31a818cffc9b7d44439cc97ebf1b681f7aee6a89653d5ba594729fccd98d762d847a6c73c73e087e3e9fd20bf8a8d559d684faef2ba36b8c25d937c9c9f74d213e076201cdf3bea7e02cbef472edc1d8c1b89c8a6e4f5e098c8ffb0253966cd9fed2514ec701e12f75dec5ad55f112b41fff965793caeb805a582d2fec12bd403b00a3d37a769058aa99585d02745545324716fd7241bdc7b3abd733c9821dd8de062dff6a81070479231cfce70eb75fd4e32a8b41182d8f51c24561ba90658478f591ac0863d4a667c810ac8132d71bb618069ed607acf307f91508216da87521dd1effe0649700631b8961845eb3f3f3e78d933a9a26b1ec4962fdf3497760448a22fecf375da898f59d2bc2dc8b07e4f762694217c1449bf2c31e4793d0659d7e5b93a7587fd63fbbb5d5d4bfa174ad030c6eed1674b85eca945b66edf006ce8dec35a2488e083f15d35ec4dd602204f4b7a6d33f246592c2546ce0bb1a75e856ee56c752d6e1256d7c2098e0a810cf5f6fccd134c0b5285ead86ab2c9ce8caf9289eeeb2c30683af550393a77352971bff615a90edca257adb485ebdf4a4754e54d09b3837551449e7fce52943e53c2f40e5255cb2fc5de75d5433bd6ee4c38f856f3c6b0bf5189de5e16bfd8bb9fc0a0b6568a7d6624cd138940c40e5a4b8fac674c413085b1fb4d13316bbbefb83ad251e374024d7c11b8106d59ca484814db41d2455027ee9da020d5513371a99ad7d74a142020f158e9bc3f7a9405360f9ff34cea0259215aafc80cf5df8631e15622d8e684261f3ca39141463e044a683165a9fe97274c07bb6fa290caa1898e078540cd0733591a7a5dee8592cd5b75e7c6552fc5db88d4f08fc4d28eb221c765c592006dfde479b98fda28fee507f335ee607a63a4da7be450993154d6a2f7301c085305a44db19ae8d14234ac61998aa0a4ec498ed5f151015a8e15574f0ebae8dabaa9b362aee635d4851f1efa583346f2068a1155d7db38183de1bcc566f1ff60d2c9514f66cb8303237cebbcf0f60e4947e72cb59cad84a494d843c5c6893415acb90b25ac5d312a80d28e3a842e4f656449a4f4a45f736757dec5323ee8de0613a1ac6589433acda0e29303b6eca092a096987dc39e3f7aadbe8194d032287ce7e1c8413cea8d23e29b5b39036e3d3b18f5455fac62a53859cd495ce077551a0f57409165eba1442d46a0e052684b2d8e7e37054fb91158a089209f75682aa9d4e1e45944952a89c80855dd499a63576ef064c5750c58eafec03ee411e497da009f769176d598df36e876e313e9b9b7d36f9d9952608db2624404cf6ac95f916bfe42cc9c81e8a5bbac8a73da09bc57d4472a320e4783f750584d65826322409fda44c8e9a89017c95d76ae5d086ab9b8a8703e6a02031b36a6808644ded2249debac2a2a29c8589cf4ee128f267d592fdf20640296832f201c6b0eae5349334f10eb7da7ffa960cb55c67ea05fd06f58b380e3774cb95758a6cfcc9a01ee1f7edbd9d748b7ea390b5eb446f609b036b3a20cf4665c8c9278ff7584602170daef3dcbf29fc07e19475e18735fb2b604bfa65aee29ce82adc2e5acb5079e417bcce5b3f92bf8d73f6068502d8fff73600fe38cef76da14ebc04c3a26a8239bd1679e2fb279e67956e6489ebcefe3519c0f1500f9c7c59ef72ed197dcc3058d46cb6ca15f2c68efadf1fe94bc73ab355e1cfca9cc4d8a3e3e34506582a3abc7158d9e0b2535ae16f48c6d0b92edceda29c4a6f739db15a181a9a15beaaf95297a70da610938bf76112ca3a13ca08d8059cb49c53ba3de13c964b6febc07a66b2fa7e7d0fb8c44094ca1e8e8ac6f5e3c55806d7344a546c8f01fec2d4147377d9a2781b8a6dbc289e6ae5c0c563016a7df9c649e7ce0f522ddfa816bb4e2734afd842c85dcc1f03b48762fea549159bd6d948192e8c809c5d18d2f0c9f75f345bc8f82592b8368c4007d02a846fd2fdb3765a22105779a03e4cbed80bcc8ddb23a840b41ada248713ae0aaaf526f3d494f3a7f02c1a57f49a363c538b4bedd28934edd563ca49721541fd965b553dab2d8747b832c008023a41c8aa6b3f1a1ecfd7385691b690f2628eca7444fee873245408b23bea0290dbd658d68043b10ab58c62f09b2cbd6300f2abc63404805ce57d74630c20c37f0df521193557e9ffedc83da7324ed27abceb43c625ed98f098a814e66a9228bcba7a96777c941652abf462ae1b4bbe7f1d4a70836da318965b23396e62ab03d270fec83172e29d4917a4731eea46408987ad82154ff07ab25034df5a27fc3a86fc177d0bbd290b56586077cb9ccaef3d779b739a26b3c166aed8515d5b41c0e15f052bb0d9d965b19c3f5dd8fd38e6c035b4bb5f7714f00187b62e6e546d57fd61b43bf24d67301385c3bbe9c77eda2787036fa234c6a8ac84863cf5eca0b5c867a338b34d4bf8ac77871b631b72546fb7e1e4d3db22cc206c7c4c8893ae77565eecebfefc111a124a3f5dbbbdcc2eab0289eb4417a4e632b280ff6f321f6501d8317ad643e0d175559dfe84dce1bef0f2d725d1db3a27f70ac663ddc9ece7791b5a02849792a2136a25ba4f3ec923c64fa9ef25735f83e0e7644d4145e2c8e9b71f879d0c2cdfe73a13614441b7e41b2efd02a03a5f53fd17999aa6e3996d4a70ff81a8d6fbf90ec4c929065268026062c5ddf00950a8af22d8396db4c26246e76790c7fb44857fe92100131895288beb20e53a03527b5854482a862d061dd6ad5f8b58b59e684db30c490137914e993c3edf8f6568fc366264d5e8341818792fb27fbad210dca98c22d03cd1bda64f4a7b42d82861097fa7d3655e6d7da2f2808a02577717571ace5468c153d3244abe43636e5ae60ace92826c28db7fb937d40a0bcfd56634cb8c3b7f9f6636eb2ce8753932922827233d88f7261e6949dd12d424c8b3055c3b61648cae4050ee8c1a8406326ac907719c5c3fa75793ac460681dff9c21f5b12598300e13dd8a04a205d83b80900c7de913442dc14492b4a9d2f2c669bb095abe01c144513403c502f3e6405e5deb21a0216a3ebe0fa46c600c58c2a4f4dcd3c972b27983ebd60b7173e96e32bfce6451df3aff6f4a9fc3458032c6a93224f5f46352d58704e6aa2e5cc209aa3a40ed8535c2e151b033dab021de9c5d6ef3883f24887a964aee052954e3a705fd0fb662487da10f18e4edcd8e4e6847b65a9a9288e8fde18f1e276577f3d0557dbe6443f0b7029d004a454f3875eab047b8d73b1f7bb715b90c7b175741dc879a420c12455a9eb2dc0be28bc8865b1ed8a1e2c189ee690fbf00bbd4db55237243bb88e607271567064578ba0c5f3c81da593a9d82ffb96530d7d2738bf434c699b4d5c58882742de407dfb4e408c63fddb07492dfb7a7e48aca45e6044d7487e76d184c7c7300fd78ad69058262b533d74f65f06511cfabad5ebfadb531143a2c227a68138e7f36429d90b2cee853f58b07d8a547be82b6170ab0357695ac01ff2b7c457f0aaf63b6b7180b7a41386cd3e8b463887d998ddca641792cd86c69a7f7facf6a9ab03b9f8d6c44fb0284b6717dd3328949b987b97e15313826d0406c0d0f4107e88c95391b18ce47b20973b19f6333f447e0a424fb2a356a01426fc380f5400e2bb49a74a841080e8f57202fbaf662d9506d78852feb219c43147d9e0088ab207def5aa40ab6e33473191d056f53e0b39ec4f6a053ce03ee4c969c9943ffbb590e9712d40f4676493ab0142a7bc678b8a5a378cd317d5da4bc86dfc3bdfb499ba05f63dd805b17a9cf8f3c5bbe598a7ea7e98b7aa175754e83023983063b65bb047782501facd6d97d519f578a980013546d2254cee1005974ff6e30701e45338561af10a248d64059a81c321abfd6255f18899f9c328df735c7428d5ad2d6d302d2dcef39c72da3992254cd68b36c07174ecc1a44d454c5b93d36cd59e44ddbfeb15c5dc5e762dd17a5f8496c9c734713a50899bb008a2be1171abb78e74df90eb7af3b19de827f629e1833bf9a5ada7106dcac7564daf11f68523584ea803408eb48a45c462b737704861d6e17528a83eaa6c382c9985d239c3d9ad336f3e10c364ee3846b3e648d5541abc47bc24a2f1661db4537ac156485d24963fece68cdd927364bccb5a2d795d4b2eb9f7e96912d0b92cf0c58ee4289d7fb7a94c300a5505b81ae19106de4d627ee07d94229f104131fa947104ecd09133e479eb5da64547b0b2b7b79c5e263a690c906425106b02f6d54124a1e243a17e582267a04ea85dae3dabfe89d20962ef1aa6cfa28bb73f488eedf406320c74990ba464ed988658d4405edb1efd63b1aa33c0ca52d8f56d08f42a5c3446a7f5495fc746d3435bffb1be2af998ae8d666ea26657b843e4fc9d18444446d54fcdc4577d33924cf12f3ead0d3ccbe65fe238500175dbf6626593d16aa4c230c49213703dbfd09cacc9fad9153345d22d8b93fd576ed9181395dad68d17fcd77a3411259152fb89e6bba99e205d5cf7cd0d1c4df7a79e60f89a6853af028707a078589ea12492eaad8458609d7e1d5b1879d4c97ed78b085d519db68c8cad8374fe40ded83eaca1165365365a3d1f5e7b149dde8538484ceac68ed130ba47aaad0fb5ad63d28a16aebee22985c633b742f4d9b667e8da6c908429e80be917a8065f97275a8f28376a6419e07efc68a517c2f7ce98ba2208a3f72ceda1dc2aa8476bc4b1e24846e0f113f539cbf10e9fdf1bd7e38fea0c195ef9327effc33d20b64eed7ffa887078a5902d4f01d550d9586aaceebf20abdc1d774692f3cb1f2783fe9ef7008f57dc5e0be0760cd5ca1217a5b186e7fcd8ad3ca93ded12bb05d6b5a317415cbc3a824edc68f1bed9694fa1e35502826a9e486824ad6c410811f4d37d96a960889cb1c08a31e6dbea8ddce9eb16c96aa31811f609521719f461f7a50ef0857f5502db2b8f5512d071f6c858640141babf75cf26354e6bce2e03563fe1416807b316a47fdaa125109c7f71db8cb87ab48632cf6ecebbce1944c7b9a518e1def3056c7ee03cb519ef123165035e76cb7f8495180d621af345e5f592746eba5b367588f4bc761093521b9cb5cfc14d0365590024aadeb8d1b1341153184c0ed4dff8646ff4dfa6ff0008af9dd99b354ac708a6ae9289766da4521df6b12476f6fa76dbe4216a5bf82d94f13a4ebc6d27f5b7f75d0124b0d182cbb156630b5ee1856eabed0537e6e2804d02ff2bbce666bbc7436a57c7e17bb391a330c8cc7ce7adb13d689e71349806e41ced208bba66b68557ac1869d4b063816b8cfa905c54edb6f2d895448431d0e4ae5bfcfe752ba122e16f549a87cb9e5638ff53eda04895bc9c78a043b8e16de41e6c42afefa2166b9197b885af200ecb84a3afc6a4018afa09f86317d19e2c246dbc6b9b18b1483e9de83c6551837567f92896f66ab0205deee110f00795d39c404ba8c1d5fdcb2f999baaa873d624a8ae885fb382727670d0a2f0db7405b5a71257c60e264d7ad59c74d8e4097d2ff282345735f0f242d14bafff38b45c7fe4afc297945947f694b51ba7e06238e7dab92e948157d958c2cf1f3ea4bb171b847a2dbfc16e76c104e09ea2518be2c793a151fc1d6e99c98b176913fd0d7d127c6281864c5f0c1ba24d95f8d0c639b47dc4fb8212a3247bca2bf812a9bdfad11fb2aa216bd6eecf8bafc4432c7ca37532d7991379e6a8d8aeb2706c3b08f05cb9574c2dfa5c4caa313459665203979334d86e184f7c60adb1af38ec2d5737c914d7c72c959d69139425a819076d1927c278ceb60fb877c7c4f403211c18ec05f406b7416d902f420ad451d686651b0140cf98a7d9da9b56f99d7af3be3388c64f38ad3987b77830fefd3fa0940c41fb3d6e3e79975bee863d9dcbaeb492f68aa92683a9b15ddf0dc4912d7fa75910548ea9b97bb5b5be8cd2fe0853ac03ba32591b0b01c5aff59df052affd00577acb83639a9b6f9d9ec78d3002686021f80f5d78eae4507f7a4446a1e6e5942056d54120c11c845737426b9d241123669079bb23d9ecdee1c3e55334b79eb15165fc731e58472ac14f5baf0081eb3b78e7445b255300df456f0ce17d5a6b3b1d0947799e7fe9d7059c7c965f408d1bbb2e9ee84553f8a1b4cc50a4151eb9f2376f789de851aa0565238696d11c6a404e0af4fac3c65d3bba8af68cc1ea62eb287c77c818f526fa5a2247dce98886668272735c135784d74d8ab3be8a07910ed657f649342b092741e7580c3de6da8231b27c061275b49504df9647a2b614cce3a9cb1edc909c0e46c86600ac62416d066c60a3c58c1220c20db5f52f20ffad4aed7848ec4aacc27b27b54c7d111d737f7edf2b289a75b4635aa811c757d90441022c63a67e3f52963edb50e73c47e582e752ee69d526342ce5bc2ce7a1ef6d87ef946be8206443c702af7e9ced893d90e8498ce9df00e4518ef36a2e8fa575c419a7616d104dc37cf3fd85f5609cbe5bc59ee88030cdec2634394b19d38c3cfbc75db4136d9804a57d648ddd84aecdd5848834c091bfd7845fa3c907b2536e9c8c9a7228e22e0347e518ee4abd1e67ccce57675aa861e817862c7cc3e782040961c9e4cbb9da10b70be5aaf1b493b33c8269b1d49e26cec4f9d1a2815aaecbf3eaef6e175932549136fcb30efbb9358ba577c24bff8d8737999f5df30713400b2abb5fafe9d6a82d816c446e6e62d4da5a24765bdb6a21139bf14be4f01a685d2eb195871dbc6da1deefcf413be63566cafb05f643e39600911cf6759c05ead1e3aae4c4fd46665cfe3aa065a8b194fd7fc9180f2ee3f27cdf87394e89bfc4de4e9585199b5bde457f9194e514d91d630bef68f8ccf98532a509637f269e333d567eb10440f5656d2ac17c016762021562a5949f50aa7f6e31b804c7100f8da015fbc587c99efdfe3e2b12d92f230db11472e2b2eb6d72d372c57336a2e3ba240797c0c2017e71ec2953ba9ca9e2ed76b9e5455d5324a553a1784029dbd0666b0db8fb37eaefb25473adb1c590c61392ceaa186a20a4a338a98b0117fa61cd68a90d46a11549391f7e053d3b5e9d19d671b941c4f74feb6100e6e020e7bd159dc829bab9fe7ffa219a83b35ef8cb5df1907bdd50d3cfc97d92d0d45c330201812e72b5d3e82f031693e2bf524f3741c224d1c9bc9c4b4117436da38f9a7256e208f28f1a86d0b7db82e2650e368bbabb3d99783ee92715b09df76466773f3ff969cfe1ebc071018b1f7b4b9fbc18cb78a2d31d632fc46cd304527c54f2ad87a154894ec03d4c65793bf9310d3db08ee76148c126b8d4638e1b889477aa08791f8286efb7d43a0050649af965fdb83434d4a1992ed40cab0217e3417b23fa49dfe9e5c0a98b800ef69b0d76eba3c9579ccbbb06a51545a93b2acd6e44c8c7a9c7c415dc292ce085b53bc848cf24849bd04d75f0bb73705ca05bafd418317cddc378fa133f4620aa454bd1e40f31db9a21d4d04f4d85285815b5608398a00676c51994c6d978109cf920cf5dd58a0ecfd1abadef33fb23f33165312fc87d8a68218a841aed30592056253c57c505743417f5434df29b2c44d39baafd2a084a2d7bf83c09f11d8c8eb1926465c5805079cd934d735f5f8e18a1607488b67eed726df86dd2dbf29c84e79be491e07bd9c3e87ea37c944e48ad6955d28bcea646a673a649ad6f194d19faf4e308a61d0aff4bebac9ee097574824ff02a9b63c7be60da94315da58b66453bc0c6b2a57b6b8e04004f031794a1e6798b1dc498544d37f042c9b1315bc20d26484534e965481d0a1e452bc02c5db89e893846a9cc0cbc389814e80857e7be15147d163fb6867bea1cda80d66db8ae7ce601d1c403f7651873df5f6feefda3fbfae7f5f7dfb57e604623889f2bd52efeb075a8cc3be4cf61f313a1469b414cff7587f21e537085d241e406a68c0f5c642ba08c5565ad677085ec929089409d38f9d39fa40f6ae6b20fc0ea850521c73b436938b37c300d9f99c86eb76c6cf06745bb80dc753cab2c45a0c1cc9604f991207991c9eaab87bc8df0ec6952205640098e924be87eac0f3bad980b05c71ee53fee0d01504dc0367fffcaa0fd53061fd7d0d4d8abb54d16f41f5cdfe6684c99a2df56141f0f40e6c2fe340445bebcd0d1291392f4ada22ed06b4f76032191eee5ef03fe374f394daebe6935442608ccbbe1ff97dd6812b7e9c015ef9c4b37d2b51aae45ce9de554e225d0187994227697edd4c0e8466d9efd8250b9564e660de9b6acac20dec479a28a953bbfeb05476744c97a28f60869cde5d35565c332db61ffddfe5a130229a91abf453766bf194d5aabe70df00ee2bf779a0ab307383ca6562eb7153120409ca95816b2c7b05ccda1a0db28dc2c74561dded66bb80997e8a7d0d834693600da0b25dccfe6a59321aaf76fbeecf946a914f238503f5706edd25dc0afd286823837dd5bcc62c9c5a66be2e246d4de88e1beff0d8e425c356e32c6eedfe1d4d2a4d23697199981008f5c8c513feee37dbf8115444eed2f84d67629f06cb4fac5b6990aeb610eb158c042de03e66b594673f2794d2e6cc362b2df247ce80e5fb902855ec68875e5f5a3ae0387023c720af31ce5373734c5a727be1833f8477d8a13768af91f1723bea4318a154d22f96b214395863ec24363f311b216058c569974e4766ca64a0b044dee73a85c34b48d10145e2b788fcd6ef9629b4484bcecdd8f30deb8a93f387b498b1c5c142fdd14c04f3ca31e9f47f56026c94c49829ff12c088015e2f34b9ea513f452f5b678703dfd7c1c7927825bdf6913080d406835e3ddd2b267197cb74ff546bd9ed116be20d17b91cde8d495ca70d803e1b267c30224d50cf63036c4638207caa4d2fd11a3528cd2c3da0a76db4118d48a127baae8b20ea0c0148cc413a0c029d31ee19e8de885453558f852930fd602423d4f90afea7168a9afbb704a3cc09feb037676ead38562282ae1de3d988940b4295f4bd12cc0feb55be9c08ea4880d8946e531a679afe4b77df1f8336e4a0d1f79769d7499798ddd27f765657c34606ac71a59504a2a24ce9a3e0b66afbad872c09b2c6b322d886cfabb20d83fdf947071f26d8c8b82b91affb47d2a1c79d68a44e930da08f6545662040901215620f9de4e1c4fe96e36311c27db83fd67576aa5ef68f1bb714c7c7af5c066de20af24ddc87caee40c390588fa3255ee58e6f268ac76cd277e3dd9ed1702a5afd4b508e7527f5de74218f3e59f8690e170281a69fe942a0ea7d629540ea8f8911ba05b517dd06b54ee2e8e83102742668715fc6b2b6a617d813ede9594150a90d8a39d972af652992ea4058137eab3d5f3b278ee4c044c7d6c7cd5d60205e5b6bc4977eb641dbb5ae33881d4f153b70505f0872616782874ea83f87a496cd29c120489402a1e00f01882b58ea3ae15f1d06c9c862412f2a06f883f37de47f40f437c9826c81ecb77517afa006498407a320841b6c90663b6921e24657ca406b32d5474508c72e661b6fd42005faae7d321ba79c081490a3533f58ffa4463663be0fb62f3e56d86e97007bd6a4c30858d725107a7a3cff60aedb967b23df48ddc83dd12f075fa4962fb8f3d47353f68379cf36222da77a32a03599719bf193b28ac606d58d8cea1deab2fb59917f576e3e701e534bb794cadcd2e8b02872797cdd7ee6e12258494bf0c06e749973a1d41ba0f7da4b40881ff0f2c45b5d5e3d5f58b2165b6e6148a6ce9fadd54a9901a0f507dbb7748ecc0a5153a2dc49a64a4fe3fba270972d22493ba382a78daea5fe6a09dd9704084bfd0bdce3d3ddc49ee018edd368c55096a3e74fc254258a2b33a93b98b7e59eefe61a1f60113b5cd109b200ee22fe2ad818cc37d1c4f4368a0e06deed37f89df3fd149fe045334c6d5b543e680a862d54958f274fc0535c1151122fbb179863da09b8f6a8c894116d9c856f9863de27fc03b2c25e05aae37df11e0f48d402f656d20ba52a67a8f0be798fbc18be3fca459b8e413297ca546a953c6ac32235807861a075fd733ef520e040e20085da89c4e96b855455312899c6717d68e90e1b83507b7b6cb5da5b969e1957c76cf11c4c48cf6129466aca81d00f1d16ffb1f1a185d93e1c3572caa06ea0f90ca7d5725141a74cc31413f317206c048a94439b5a08d005c2f7af792e03088c5fe91e0cf44756ce3820740db3043cb4deacbc4c0c7755312d9203603eac3f6570dc8be9596eda743d1b0c87f9c422349af816d66e6371562d0d6ec57c14ccfc247c5317e459b0af6540ff2cd4cbe6c2f78fd02c834ed2820faed0753fd86a392fc5c6957bbf031b2af4c85e7f00ab635c6051140d06310c5e0cffd91ec3ecf3664fffaf09871bc2e99a8eceafda2008ce3366d591df9edee3de245aa43648ff83ab10b232d4926e2e023716531a1c472295affd9bd00a6bea6ebd6e9431ec6176f4d8b6b53c60680aeed6a2c104e61ac27f52c560f05fd864c051c2ea2e81a27439765fee44c296e27ced8732d45bc613c10d59b6d1537d33f9064963a9083255ffe361c271f2ce623c8c227cfa7f6b3ea0e215a12b8f6318671caa3562373418a6cd071314752c8a089816fdedb0b3cb0df95f8e7f267a77f5d1eeb00e8086ad5de56bf825c3b90d2c4413f77881cb43ad45cc1c5d976f3259a01bc93c44dcdf45f690840b8a1734126d41bdb109bd9451f30ea08a13adf92c469b1d24e62ed7552ca5acd822d2eaaecad923207960668198488cfa120fc93d6cad47016b072c2b71a5f2856bfbfb72908241883e31465b50bd44f441f91ad20d859ccefb091d80c091a4fade671adf13b70374e8d7cbbf2ee288965f877cb5b70fb962867fcb346cbefff9796c8a37e3a00342b8e317a463fd3021542df61a78eeb167c61ab2651c28b99f19ef46eb4ef16ac3e63ade4a2393d0476a8c310bd455f099d6730924282e8f555a2021cff10c3084c02c2219eb857e4178b57411a8a611cdd598319b0d66d027f9d6a415dd9a4f1edb2f4b43fe0cbe894ff2ebd952141cd5259bc5de22a74ec85c0b210ee0b452c3c89a831b58701d4d1b8f04aed85ede32ea63e870193f5ee5ab166472bb6c08521087ab039653a090f2527f77fff05820f42d95cef55f99cb7b3292a24e20a40bff1dc97877f5a2014ecedb6c1bc209e84a7559d22e8a3d29dea70819824984e233673e4032ad273fa27885f351e77cc7494c7f0ecac5c0e09e5e8126e844b3e714715e7c99d9d19103726005d85693004ec91dfc85d02bc6a478b460d87f4e3a683a96de84f02c3a9236a25a905918086db8e5a6e74a9017f30f1886d2a012695239a48aad886c3d3ddd5d1330e5891ea937428f2bbdb5ff804136622eb806d01b39898ae85ee60543af51fd973712d64a32205a884fd2871cc22e375d04220c70575cceb2bf1c387da6baf2d7312092c66f5232b574c0e9a2b2d7c20dbdd4dbe1ef19e9e2efcd8bd3fb7b2c64e6fd831a4696c0379adbc843f061f5f8baafc547e2adad75bf8f4b8ec921075b10525dad94bf87757eb1f555e4408f80d326ba7536ba9545b378b5ba8558bc712b06424a633e929de2a74f3dc646841f2f5f627e74f643f6cafb1b757be3b4e8c635283294240ac9774fb311405119a2247345faf7ee5719e01e4756177e68079317f8d512d7aee79c3c29a1399cfd1cd3b9adb7e6d2a4fd4a260b34e8f29deab346245f38ff110fe992fbbd868df9725afef2fcc3df14c80a2c2b37ac5820fcfa9f067c78c9dfdc8553851ca1cd37d551b50314557841242d0700896624924ae15f944451cf4c2889c6709821825ca89a15692a00547e62a849160141725fa0036d1d85c09f86290c4c9d9fc61a5885c5c81d5db149e8ef5a026dd063c2e6b89e6cda4bf2084e80e027a9018c95b89bf6062cbbd9e7e25a77cf236a1ba028c26fec07275767123e594089f943694a1c52691014c8b42624065376924b86557539eefdb1151b0c3cbe5f324f5dfdfd9d320caff0858f25f5addafb3bdeb39d5711051e7f5d7174efed1649fd0ce9eccec1dff87ac2b326c5aada84b8361c82b1f49a7e2284c347ffb37a49f8da97e74a45f840fb853a8f6590fa700ecf39b7808beead91a06cf9aa3dfeeff8480750e73553fc9f771ab23d33416c8760b1c74cf6023c909d9b7266461f83ce2fad6c9809bd415782d08144944ba58f9e2951f9426f06426ff61face7d064eb6dd9ae4e1455fd1928fcfab885ff26110ff844395f4c3da19f0b14f014851c4ac4deb6e02e2ca680816fe50ea7da946ddc8c7d74eb63c22569deff345ebecb6383cffc83b9564bbe29794d9baa1bd6cccfe1434222f5a882d34b7f973c9d26109e01cb51f454622d56241c5899abc3f48a0d8640aa88c672fce7d26addafb95c9b59ed59a04b3b78ea34e59bab84a993d63128bcd67372d847bf7991929e0cf71c8cbed2fbbedf04b300425aafdfaf0cc689709fa730ece12555f60b0aa99c83a0d468f0da8ae1b2409d774c27462e1ae6b99ed540440647f71048eb031dd85e427d6ade26effc9e98cfa8648feb2ad209e07179df16453c23d2fcd33721da95c18fa4d6d4736f5b1919f88ed0f9eabe5ea3b41314b9771961441c6f9827d76367868caf5d1b8a809f344340516179bda2b1ffb590eca379d4f429c79e57095b936f16a6180a489c846a86e89675895dfa15686201e87f4f3c0cbd5ee1b0c648933dbb7069389320e207f7ed22c9c4e24c5b93bb5e638c645aa80e8a5bca904d1b97106957c041f41963d8173bddb33e207650c19f97ecb4f46040217bb1be626cb278e0370010f1c016bf282ff61c946220b5ac1608922350edd3077e4a673f37cde1844c66d34ea511d3e29c77dcd4cb8479afb915e015b1da05ffc39d761a82237cb4af4e2359c35db0aa7a5cc3491baf25e7f0c5ba8138f9b80afae845ef2f63c1c663f32f91c05c6b21bf2612558fecfb0a7e2495ff4183b61edc8421f264206fac9752459ceda7a5819b7bd58b866c11b0fcede66ebaa44c25676ea88dce8eb3e9e469c277be208ba9d43b88e435287accc584d80e187471f7b1e3c81003ad0891a2d0c99f1e1a76144b4db29632e7e7ebf908a697d3220c3a7d34827f381d7ccf82c5baa64434e37373c52403237e05a405cc75ddd89127ea43effee99825d2e771537f883194371cd0efca259a8194b16854e4f488adcf68986ba2c6b519cf124e95f7222c69ef85ceed205414faa267e908b76f40167741272b6ea3afe071e105f1de62710966b5209b59b44bfa8e0852ec91f1abb35fd9953afd9614facb2f9303301fbe0a5f2b676c035d2246c84fee3c090b3aa7ab1432a3e48c71f8dd573a03902d04425aca9f6a36bc26eff36023fcecffa6a0b7079524857a0b7d636e22550d9786ecec69652ad8f9a203b58e90c3d8cca239c3761b0d983b4c9391becf65619618e7bcb631a4721ba5d7f539fb47d0fe15f6b18b2a67ac90b143d2478515659697144be989c2888e85a8dc82cd17fa7d185d0644e0b0f9a70e7993087cc3b6303954a6e36ff9eb2ee5a61656b3477f2850759f45cfe13f50171c9e56f49e24a74851474a66ad10d169077706278db72daf1b73b9797f0bbf1baa5fe4477262bfdfd401e7265b76653e2d4781d947f8cb835f2947ee3ddc3a5d65bc7959534624e3fe2ef2f1ab43d6553863668c391a3a6f359b6cf7725eae3cb6ac5b6fb69c58b6378044025b7daa3f720ce42e7fd2417e8056e600ed2ca937ac27ab521bdf67b11d3c14f5c6e02a38740224891fdebc17d9cecae0a8815c4f0c6b9454c63786d610125e6a30756e9e8c077d6851c14ed5cf8040b622951486067ce06e99f3fc947ecc20d6f71a675eabdd418c51e2bb8635b41ca976fa9dee546b114e46258b093eb36ec94d625ab0e26e4d1d36af32bc505dd257523ceddc14581b3ed6661bb610518b01df5418af7a67db3e170b2723e5c27cb3dae5723c47af34951d9ae46e937da377953a5cdcb8c1fb6d0ef8b0aca20200ee6a20ab33305ee5bc41b0bdff3d772c2ee283e60f5b2e0ed5212279f66c9870dc570d30f7b56c26b2ed337508883b2114a2470f85391e585c8391a70b13b7d0ec90b9fcd5a38cc59869bb126fd006c8d9b86b60adb862afc39dd25c0c169f5037bfc28fc3f5369017432e65b24220cb10d2a23bfecc04638e5e2394281b00cf4c352f385a6898d29257eded19f52a5c8d6b97c94fe049550f5803a4e1f4ba2f493e306496ee268f0326ac9b0169a4823f56f89655c1386057afbbc66dbf2f5c9f500f2edef8f975d3af32a3a324be21c59b5f1c2b2ee93bad8a04785c4e08f399b8558d192b688ec9d4c59e7257a934564765222c0ae04ee5231f8aa09c54a2e27b01d5e1ef8b963ec71b59916ac7e1b0c97823bcfb95be0ade916ed961935db2b81bc6957ec394a9c6c0f0bf11e7eaf9e37ea320b34c426717d90fa0164b7ded37f3fe508c09824b25fc54982d47356360eedd6a19f24d23b6447e0ca6e086ce5efb132c004e4b1e30785570920abac3f225c706b5db335acd80267a24e04ec3a45450375a39ee0fa7bc767872431706862044a13a34668bb122ff7af0b650793917b80258f5212a1ab2f36a886a46efac3b352e8320c76a66c514ab6a9b68d19946a067b7c2ee23c3b7a40454c0fa7f3ad375d96f6eab9e988160a27ef79e2cf2aecc86aff3ab06e266b13390ca6db268a296a42011d65484fcd3f6694c97c45cd74e4ef536c7b2c71eb3449d38f55098061c1b70edd61fb9843755953d4979b4c2c366aab7d60439d259509310526d2b06b0e6a0b5f33c0172ef3ba3cdc76a1705ce26fe8bd4f2fd9817553cbad8ab4f1bd81ab456f32d853a3bb6baa594f0c247b6ac3e1966f12322d452362ab4d71c1ffc12b15160dba22b0bfc0c879ef5f4e760761ff7f6444b525070bf53e2e5e0b10ca8ac75ad938268945ed4427cb83b052e35db77256e63ab7742f87eaffb6d8fae081bd668652e0929aa3727186ef1d6c2c385198fadabd5c1d88b926ce79f4204bcf9e4999c95502b1d83ddc46cbd8cb8f3505532888481b7d3d517a35da4d2d8ba4f98a6169f7a2049b04bfafa560e5efe0f0ed4c3832118ee2e006791d97a2a8394ef7852be7b1412e58d44a5c90168d650bd4f410cc507a73515f7457ca1652f4eea97b1cc7ffebcbc411939bd7c15500667fa5c599425260a7370fd769239979131afd6dbb29987238ac16bd83b8af5680970f1ea9f24612078c1af799676e57d53eb9cdefa3b20793c22a44a8fd03b4241bf2b738c58907ee13b5ff7ba0e6c443eb9d0500c292ede138ab47d9e1bfef5622d8abb4db2af720615c52166f024b16a8135395a2fe7264f7ea80520490ade646ca4ff1ca8694740c19ff9dbb3dc79707865e1b048bad45edae4b2a6be88c1752dc361670a35d16e883080d0ec16674e0dc967a4c8cc0afa78f5742d9f9bdae85c54dad13575534575c35c81108947a2dee90bcabbeb7c1218189eef3cf416c99eb7d2f6bc2161037ac77199c5998ac0cceff93fc2e5b7c186fed386367b216799b2f0336298ad695a67945f6ff2992b67ad020dfdf7aa4a4e916339854327ea3fe32a7db1a31dee3b53724c958cceb34738012aeff0ec33c468133945fec8d3eb9ca52ed190e83f4a352e330a73f44c07997da18cae94e7eb545df62d9e498b8464946e5e51cd27e17e6d47a0dc027d5193c9c20f20d2a37455918a4f02daf0711bedce87157e2c5008559311b480bd4c8c15acbbed81c1b8a4ad15cb75bfd35bc8706ff917ac19f486f55a2be27983c855c1832810d992bddd2b5c849666dbba463e6300b16a91222896c666586d15cd74e293aebd57d16b234ead0ecec428ea0b9894300b7c0f551925050c438b111c9030430dc0198a202f824c7c2cab589ea195503bc1be38b87bc7147d536fa0cf2db2bdc616306757e43521c6db2c0a7c49dc30a89fb995399de0a1d886ac9f208d9814930b5a3ebe84972940179ca280c5011215c380a7c5808cb31998046671d109d6a2cffcb9a9fd967b6de4b761b02052a9909ee50f02b3dc6d0493410a57f3c5dcdcb7a93a91bc89cfaa142648f1d808b4209d2cfb8a83409f57703480bff59b4ec908c68e9a73e92b98642e511645c44f3dc43c5ba832b330a4b34aae8c3d43d9f22c21e7d2bcf4b75ccde7fb99b6c4aa17093692b8b31d39564215060408647d2d7df86a8188321864f1d55ae425f49d5f408ba35af7aadb6a67df180634102a5cf83a45d53c3bf68f5fd025150aba815c02e56fc67333a8f78152352b3372e2a36587f3a935bdcb1d4722667bb3220c2289ae44f0a4555af85397c74e86282f2861caab28ec9a3d024562080a78f57c2bc423bf9c1d71b0c64b3501287817193585b4afd25d1785c1801869485f9aaa67fc5b148a71ae3cc0885e6a53d6499296cd3ff7a81f5392db7cd57374c16f8b01c0cc1a77dfd8fbec13dfcdb4b621f23e4753dc6c5f146aadc6eb3b8f53ae04a1fc5ce9c3ccd09c0c90e1897ddd5d95af8623e1bbcdf19dffcd5811eaea8965a10501032662deafd16ae722ba9f6824190d344a1b187c377f69ddfef872ebcd8bccabd8f1ae0d19a2e719876e0e4b7f9ba38d706a9c1f88fbf1b578e93235a7c8d494f9c6598f0a336b49a3df56d7d2cf08576c5c08431aea7d3c3a45a2a095269f8349a4275d24e29de93a9692e9afe363c8401914920265df0dd8d0b2b01d1871868bd44aa7ec9b5b7ebaf360503906eb59413c9914f5a986d91cdea3f0f8cf7b2e1a4b07ef36f6876cfe06a19f7885ce07132f9e98ca6d5520cc4f2cc310081e9f1e3050d87e446cef181ec3bb40adfaa107c99a0a171bb60ea87ed95a0d9797d30a7b09cb1c98ae6473ae5c9fab7d8655c72dd95f964659cbe06d435cf4135dd9986a6ceb99a8b5ff8564ab83fa2b728ccf27b36b9403a948fdf5b1d514ee13b4fbdd2dec08bdbc77ce31a9f392ac859ccb92e761728f8643416673a10f53dda5beab6b0855d07a6a22df4a69f62d869e130cb7d528660d490fe043d40905318d528980e48de1f4f0a8a8a012dca1c22642557edd38950278b6ed0f911dfe718dd3c7b5509ac5c22a1a8d2b5bb74bab57b515d771bc3540d6ba7f29611bf18cb33adf1c56cb834c07295d059f558c34395c446782ef7b71f975ad8b110fd700a8e469aea84c387c03d1c6935908bcfc70f2d4e800e559225c3ca1ae1964ec8a02339754d357842b6a9644afa5e4772a6b9df34ccb073cec71e58778bd62307f5094d90015fc91713f691613cba05b7239de22adc49709128599db034843fb113956f2b3c2d1ea95e091c458e99397c25f32bc723e81d875f8d25cf46b77d48f0a6a6d4ca52d5a7e11b13dfb6169f03858d2859b164d00c7fa9dfd1d6135ffffadfdf705a5d3a14b858e5c87dbe81fd473ca1216b40499dcd79fad4ca02a162de6f8bc224c0f692c3a31d2e0a6717eb36aa6b0cffc32359725cc46a95c3928072eb4790b73ad16d61726f7f6b04d0ff4de440f9c8c4b4736285ac2aa73974cf29d39d9ca7757770a288213160b6a189f1ab4ac103cc639b73e16fe0efed362ee71fdf618536c32dec24718ed5a4bf6b12904d14579eab9f78bf4013d86bc7c837c3f63e48b4d0679a09a4a2c08012e43f59d9d8f189cc46d96b1a1df5f5ecbc83497fdea6dfcb398b0666e4f07b3100c6444001b1c565c0dcc54e9dff7ef2c4476edf2dc82d4069d29384fa2063cc588787617ad56ccac7b18fed76fabf5f9a9cd5b9f6b6429792390a2b1f3d094dfbdff6d69ea383bfae12a76f21f1aa231957c7364158cdaf7583a1f431abf67fbd450b4ee70aae304443f3782993c60d5dc1ac5b6b58de7a6600636885e3d434bdaf5b0a4e42714874bfa964ca51594bcb91e6af00feb82aaae054a38b2d586fca685a9b5ba2691715156222559ead521c50cbb82597345b9d0e78aff4b4ec89d350beb8e1029524b1615dcdbc54828b212909d684ef2ce84aef807b2af195cda3e6be6379769531b29ccd21188621a4c4b80871ea31361a081abdaf9f9fc4eb3c5905b99b789fca2c40afaf3b30879f41deb4e4e0a1d86059a4a5b000efbacbbec5507eadcff4b1df320bebe757aacce9d7afac337eac97c423c7dcd7ae15a841fb7b3bf0db9bb802752651f14fac4dde7ef9caa8c81ba14ffb825b4f53bde8ac6eaaa7aaded55b32cb3763fc31a84427c6596741ba7794a047dd1932db9fb2713e3bfbc115d2111b5fbc5de68bff308154ed26a3d4b46ea90d328ebeca1006554d47bd6b5bb5d084b8b92a44fc2cefaebbd41b3b2e171fc5e0bd771d8bc0d2565aaa31a40d522f5128e56b82fc123fcd1098d60aa09b345d28bdd755d02f501d3822c00be685f4e3163983711a0e17ee06dd00afefb629e57ea48b98113aecaf0d3aa795ecfd373c16b98e34f6156761e991ff2315fbb832db3af91e59de2f35e621ccc12758c04fbf80d132cda97c63a595531fe102f3bfeb14869b6018fbfe8bc5ae5b4dfe60ca0d884f6e6b49edbb2efa6187d5fe63e5ca7afd375913d7c27a4b52dd79c476b789a052e2230128460b7da6eda8c5e86ff0643500f0f658f1a879fca15ca2a83aa72f4ffabcc2551c6b6083ef28a687fe4afc578595553204d63a6095792596d2e49b43f120f2edba9ad7503d667779ae3b31d62b099c1a261b8cfa2569d43d5e8b467833e41b79f4495642b9d4b60713781db1504a1caad4fc222c628aeaaa32a0791cd249cb0b4e5fd4cea058c7793985929bed41e57c91a5d10940dfa5eb585c44f72a9721bfccb563e689ae21cdd2228b5495548e386f7cd7027448fd68cd80d256d00b2ada36c01b79f467db26258c629868b825e17436aa23265fd99c647e4129e37691db27e93f6027dbfeb39f02fcedb169cc2cfc27112083b055309b7c488f03ed343770b2cd7638c28c1c64932cb71a1d539941931644f8fe2bb5021f861f5952abad6bf1b23830b7645c0bd33d14628374168d05f19245ebb85bc0d0546679928f2ff73bd69a49a7b3956e05123c8e37eb22e58bb23ebb006c7705eddf295cb347b4a96e8cf58356d721329f0eba5296456cd6ca51e6360529503467b5017d44cea550affaec9526c2bd15bc74dfc4cf5e0c4b2d6965b27beaab4322cc20bf224a842099be5289ac58953544365c491d67e22fc19e5176df6bd54a826ef78b1f601e83466074c8d4939d216e09b533cb4305db0c64d7b51cc65c03b5493b025aa140e76ed231b6e19f3d1a0d3018006f25267321ebe896c229e586fa9ea237b2674dc05ce1bab5ccb5570bd89da74c042d9ef940a071639b17e915d337d650beb342c8985a31411f4e37a7673e4f85994c7694ab636797c0465dd3e043cce64ccaa2c0e499f10bb8356c9fb9e93ada2d311556470ef9bc2d86e8b63696ab55d4369187ec2d84aaa56f5f92a1d571046593ce46a75263c2ee7f4cde868860d7d745dcbebadb4af4a7b72dabf9026984b973938c93226447453d716b69a535d4810181cf98f740c3980158e21b662f4010982ab11feda30fc4be6ea6f442e7cf53989df159c3a6d842522ba6f3307d5f84ff2a310753230fa33a2f5395aa15a000690d58b52161ad4f78142b0bb7b7b49fb9ecb2d01e69f566d612af1a42ce9c9254ebdf0834b6d72d5b0f825c0f8ce68c73061eb3d0349e7b5510c02f74887825ec0846a04ee5cfc25ed33b834f67bca76e21bd1a04f91970d75a215d266201c3831c16f3911f39c4c6c43b3115b68ee6c743a1f03943b94f37979438cfbc29aa52514a1d87d0e15c1cb6c24bfdd266402da62174c70ad6dd3f23c861d40243ca3a6d3f79395f4fe2576064e190079357d6ccd4425529cbcae6eff0ca2761db8a6f4a2e77c1f1d5215ac02cda5dbfbfb7ca1e6665972e4a93daf0c0fbc919fe2cbf790a9f0867e6b5498d7aff7ebb461d37996c32ae2eed28f16bf6cfdfd4c26dc08bc9a2e9e0fa5095959d6260139fdbcac86797fefda9acf1295861c851002bd816b01c165a85aa84d2b49b4004e71c5c87ea6076e48b1d1c65f9e510b2e39ca70a12a36605b7a11ae91efe8d1cc63e654284b27cc67f16b43e79e462283872c5f0d462f355b4efc91cd1aa93ee555975de99c915de5c375c79157237d1dc8bb7af86c71aa5d1838a43455a6d1eaf709154e93cffec464a53d622163e74e25f8bcb2b82eff9c97ac74ce522ff0c00ce35f62265ae32fdac62c73ef15681b63a39fbbb5003718965b0f58708c7e3a2240f144bb0cfef4961bfebe11726cfecd823dcd447537043e0b28d0c8a4527e371b18376f73afdbabd48b42d461a2cbdc5273880fffb2c36e67f8985835fc3262b3a985a805e38d16827318bc4bb4bf828e7b96dfe39cdf32fd2fa12893520e24f2642770734519baf573ecf23a784b9cb5d297404beee39a7261dd6a736e3ef0f417d2e7165c9dbb15ab9122d10bfa84c4eae7ea8a4ba844546adf88c8b1e40eeef92238836f581c3cedc0d7279276e4ca0b6d1a748d891ed58426462a8e25468a4b899cc0b2caf6203666f56d5a391b11cc6a467abf74e18659e03385514acf81cd9009f8ae946e9a0e6e39526ea5d0b8f16fc7f4aa264c7b6c307381f945f6e668669744cca860f3c1fe306ce298072e89dd35e422245531518948f7ec5f52646b2651550fa77f3eead42d5222a31f7dc976b8a23a8c5bee0b270f16d484a81a1494cec9b1d5755608bc704c354cc734c4f04d5f60b44a4e95cccc2853690b8dee96029e07507efdc6ebafcd5c6d43bc4bd1419dc7732172610be625f409bda40aad970befd3745f7483941713c7fcc74e3a5edc108cbced8e6d05292cb6fa2f060b95f40f4968ca316179f6522109c7fe3896270919c053927ba5f1ab5bf629454e5af92d7ca1810cbcefe864383f309e58266087e8fb4629134ffa412c2f14d878c2ec583c9edba87bd66a871158b332c749fab23bba175f7cb7f7e8d2a5b2fbc7f45031a3240a5353f92424244ef03684dc6c5b773a96ee7b63f99707f808515f1f4440907949fc680b542a3b268f0cfdc0077d609fc42b8eeceded8c53b34e2f0c81d80c609c14cb13c5e6ea285c16666832ffd726618f58bf32bdda3b0a7c69fa91e8b76b4ac0eea74120c7c3015e32530e7896528a300b8765b871fa78bb512505981f8d14986b100f5bdd7ac6e9ff30a3198661a86c0cc334f1f5aa358be05ba2542d2e42304e4595cde3156f5b3eb3ea1cc8771c2f8fece148f7b49a9a1b799f52826c7b41d48adb62698312581945ca05260244af941abc03db934a748de1012d10cb30231469e091b2aeb2aeccb622ebcec1f8b11735267e7f087937c6d3e4d6184423e122b94f8b57b8e7901aebdf47eb7374bf299b06503f67baca0e3771195c41a2d2334c471ced9e4eedd71b3bc653f12cb6c95bacfc49e142775a0f6276a34594d0962d8e2b687a00f29527bd11c67b502f60058881965d48adc5a94891276e4fd367be201b48330a753f32a4b5f9a3f0d03c194e815440113dd4f24c44f82fe03a67f4d23e39ecda16bd0734081fc7b9df93e4121e23718c8db69798b2c57e1def1a22246e152c867448a52e5b2983ac1cb159c289bb5c30a8bd472d8272569562739a829e50692d370c33f7f2309413ee575133988cac6d86fcd464b766dea40811eab84c9e8956fd59258d4eb467a910d2af3029d8bdaba3b5023a2851954ccdcd4212981760bd98f0c2de1dde3fe285055f10f6d163c8b254190f3feda87a46da8c13b38d90d38113e17422be6fb4666b78a533dc7a0c39157d0ae7f09749145c52f79f3eebac2fb6fd6fb2246107f6e995600c5949843b9ed4a89b806e806aaca93de5440ed01bd5405b79a9b528994eea1dde0446e4010740ec649240e87791a2c03774d5358a9de6bd0e11d77c57c97f6034fb0a2bb5ab816a7e33ae0ee325755469d335566420d64506c19bbeb82892c0b6fab043a2a48a024e60dc5c5f865ba679987a7221caa99dc6f52904f358a555fd9876492dc979f82c0e8d2701a222634645bcd5f67daf8ab0a77ebffb83060d812d0f2e1a9e686124af864201770c989d597bc48542f502d03817bc39365bd71b8247fd788020d7165198ee1727fed70aa646d84972d786103de016af824c5772ca66724003b83497ffd42d3399c73188b4250e932cddca7576f2728a27f0c52465dde975d0b1b2314cf429e82d1ab069f92d0e92362b332403101885f7eccd049b1250eaf95d8d11affb8104591e9358bc66d9e78cb37a01dac04f199ecee939c839b093a8a91181d1fcb2b0a4c72e7d181c595592fbfd32e3eac576eadeb7a52f54c7761c74aaee0f6982b35e27adc3fb42a40a92a15425c9e1b6e28ae8a6f589a90beaaaf1de974c68de11ecfc87b2b7ea94f0ed715fe2680b52e460ceb77da76b246d5432adbd16e6d54e2c168e75cfa4540e1517b51c858a9cf4e4cc399f5ab6e63cab11ede06b8c5bca61c65dac3bf2fc12e37971b8e4ace9e4da8f4a4dce84b0fc863d923ead6df43110c30417bc3581a14dbdb5f58492fda0f336b0d8905e6273668cc141bb8c4f90313d1d66f81ace01cb67d62f3c493d1aacf52bc52f96ece8883db86269316967fb57d8acc952d91f9de4a4c51381732e9fed4324d74ac3adbc7306df88773c0a791b6833f3a33882860677100589c259ecacfcb322832cf7eae2c3b8dcd4e770abd3d86119fb7eae34b2f88456e01f2bb71a230344705ec80536d0950ea5928435c95b5a36cae788d07b9d879a9e8c4da594158072681fbbd7e5030dfea4866282b9201706e6196fc9142076a0d413e02af1b61bf6aa084b499cf0fe9a8352c5e0054f5e4f7a25accabe8132a7ca510dfdc4336a399fc580af4406b4501c49d465827a480f6698c0ee02527ddded3799a1730ec91be8d5b6dc2b7705366eb9e81205606cd1e31d2aa9befebfbc5f6769a4c609516e6a7c4054d716eaa3f3640e87db7e190f4552b237779f5723b02bae9a624ea2c53e69b5f03fee5ab15cfd5a4753b423f712b0150195aad9b2c64805a47c9c54a157a9e879fe633f517bfb0ef854813fbaa40a2cddda2611d976a338913683b07e9ce809460d4630e5cb644577359ba2e7b8ec88f59c0297bfcd8f33017a06aee4659066df457fca9f360b94debe3b12e9fc20d27db33178ca2be58670261fbc4c31c4a53a7b261ea7ab8e7c4c40b9b974c4aee4ce75a9e3da03ae4f2643d4e71829d3fb550a8d9a7c5e179a8c14f8a2d7e560c5837d1cc1261db834b5874cc37925dba88a0e68b3b5943f1acf32ea386038a788fc1eec0c9a618b726e68aee554bb69226b97dbf50d49844822dc94a614c04b6181dc8fb3038c3ff0ac6b108c1c719b8fd9205dd0eda3590c0d9075e04ec473f38831303f00c71ee139ffe6b227ece7d54062efe9fca07f6a6ee162b576e1fb13ad8044252e09bfdc6cdb6e4fdb537d4f9adf78939bcac33c76c135d6ff8d0bcadf0d04a43f7ac6b9f829276243e9c205be1a5d5e10c60b8fc8a38827b8419d23120bb52b659e7179540cadce7604b06b5c7af663c2c46a73f6b92e92f813f10c1c9edda1c7c950a66eaf4990e52f77ad9cb8c1c7e1d22ce536585ec7935242832d65146d3c523bd20beff86c71e57f72eba30744babaceca8f8b75426e87d28076012eff0faace60d02a2c1d9842ae8f766875b91f88fadad3a8c6ce27adff75647d9261a4d2ac8d3c51a1d097cc02d1233a921cb089c534c173f02f80dfa1619a8da8c519a576154284766c6d64d690db22e41c96c047cb98a618fbde3a11e2015669e0acd04b7bba0c3bd759de67ae292dcbeec741f2cea117c4fe499e0cffbbc168c61e6e6549f9086b5408c610394fdbed1a84949b600f475c6156db891ea8e15e55f444e3d3c6614720f38750654409eb49ff05358a4d1f9dd67235acb23d36dd006cbeeda7be860e1f5fd26e47c2acafcc2e99358d94b09615c1e5186c86bba45c555e6dbab603f9a23e27d53ff534f3316a8da0bf72ef89078a6ebbdd8efbcee43814ae461258f618874854c0d88fbe405a26e3c71919b3670f8ebd0a76ee1bca7688cc37a114c80abf54a4ea55d66c6a3a41afa78742960936b96ee0b05869ff64a783573bea3a6cae3e70c0a3ba093619b0589119fe2e1d8df2734dd780d1c5080b56e8f120ea9f8744b80f96a1472b0fb1111003afca4fffd8ce8de92cbe7cfea06fa2ce5ceabfb3f7b1daec15fa62b2c8f83cfcff4ef773a81bd2520fcec6043e7471fbe206da6ad67d879faf87cccaa9d6ca482d307448afb158deb7532354b395eee3f30734012df47aee98c9c3326181eaf0cba460190a942a461867cfe388d1ff114001eff76a869fdbe1db09cf55ed60a7160dbbc5dcfacee78496c66eaca2795517c52e97677ceacefaf53790920aea770fa218bbb963bcfed42f6588124c363896d10643dfc897154b36e5e99060249fd720da15011e9b1b8912743a20ce422c09c39f9b61715a308c8428c0ead44801b2e9a0bd79b1e20464753e27d2fc0ba2ab6bea0d67e4e19087687d29d2a64cb84f00f4a8fd1cd5f60ab999327cffe11b7ed59d15ac7eacd3726acfc6bee6518b67d20bc77daed3e10f1b66ffbc4a7f651fa273f9c8bbb387684fb9bb886167161486dd060f4feed14050fd32cdf03cc564baf427c290c08aa5afd109a68ab16d7ae356924c271f958765264b298caeb02091cfaf14f79d86764c65fccf56eb5ce1eaf4abe7c3ff54c71c2736e7ea47f0613c6ff29bf6df2a3a5fb5433a71b825330a4fb1ac5995c5136f00cd515d958cc0c911b149be0bc97a71b26ed39d67be542a08e0e85f67d33fb917e4938b42c87f047d4396e69ca64536b1609263298896f9d166cfabe94f41c420e8ee6aeb42f35147657cef8e41bdfec58d27bac49aa88186c8b3d5bf177ffb798d7ee8277c3c7ac2f7288844323b6403b17849437183ef2af3fa73280a7aaf4293d4e7370abccb95d639ace037075efde54c1a86064f8714001bdb61337e23a335d6bfcba96228a2e0992ef4bd28840e988fdf64f91db6f7d2db47cbfa99289123bb09feda5272ee4bfdbb02bb97504f8386e1d8fc730c502ba61c90949498734f8731f77e230f46165d6886e4038f8e7eee7b8d6c65ae5d6a0311cb89ded1a7330dc22e6c4d345a600f5f6d3b5e70d8e2d4186a879dc99c6d55973d4eb4da73aacdc2c7ce3376fd51e3b35a4e2cbf230dc91b0cff640ded69bee8f6c1390a5df2859657d239a3349dc0c060e0abe323a09ddd46fd8b0e775f4b56165128780f33c776e03b4c3a308e59b0b2f340bb5c29e065a983befe689af6a077ab777ecf7584027a1ef77ce3c6312035aaf1d64dabcbcdedce6c44039a6fe8b556b12953e158fc9936ee910574f69a4059fe7eb785fc94943200f4562c085414c5515e67e22efe800d2dd87aa814a6384b5582dc2b042efc6e1047c48cbe768720fcb85b18bf165278fb5d3629c17d7418698cb9cb40645b58c0beda36bbe00d1c7710ec40f7543fbf1624954570ab2c88a0997c5e4fe2bc3c76e5fc58fa0a98b048fc44c22efd3ecd69caf3cffcc140d05cd6abbb574e52a037123e41c52598a2752f5b5f2ab886a4513c7d4e05d4b64e1de422fe38bc1ceca7553611be553765366d231902d9a40832cf55d1bef59ebe6550b6e1cdc64acf688537bc89410e63a478d57a60c12dce3e9b46c8fc62aa1ad04d4ac5bb38ad2c6c85e4325d12b50144f3358062f0ff936f668fef7b2e32d3b0723b5f6264d2bd5df4653509f01f2ec7570467bc61541bed0eebaeb95f146e2d241235eb3ed44361046223ec5cf93af97d1502412ce522748d18075fdec0296ee4756f7bbf80309c4c7f63faeff771ee6089c6a8dac6b893402e4fb8b5f299ef34e776b5856630df40c249994affd3761d11701ef243924fc5cf02a5af791a12df2cbe62e7eaa7e3dab026e66993ef63228880e76cf415618deaf7eb59f6dd38b8741d69327b689bf27e634050f89d44f6063afe2c641b2fd04048815c1c6f1ef78e25141e24fe63dac6c606b0f48fcac444209a66eddd5898d3f3138d99e4f79d45443a75dfe744655be28f9d8ea4d4ba5f120e148d92fff1a2a33db6a69f7d50f4b150a000ed601fa15c7688f36343fcb85ec7ce496cc4a2ad323c6e307b7d9b35cecb32ac4eed895856bcf47c6c434c324c36b8d705c38ecac48c3105549feef4467de6f67dfbd3767a7db82ba7a42df2f7641a120c230d8736da483e06da1bc40403d51a69c7445d70e989c4006d00f124476c97e9a7f795c55e5cb55361943ce028ee9565eca0f11dc60b8c094855f7bb30729bd3acd4bdac3ef48bef469c0f1f8cb5e4aeda202ed5afffbb3c4bc2d0de19c3c6edfca66ea202d2ea33ac561db00fbfd0cf348fef1b6c148ece0fb18a8a94dfaea8363ff593f96e5ea95c0e87a46cc76aa20e12b02e90b063f6c79016bf732188085ce180032537286098b42808d6c4e775e82f6e15d84b684ed3c9548445cf2b60f886066f3ba7eca250669228473b7fcc3bc922e9fc25546cb66cbe42f75916e22f2cced6033d3a1be7e3256da9050ac4b174883249359147182a2579fae725d7835adb84ca51efaadfaf068fc7f9e55ac3d12048d8e0d31470c2850465e14c528f391694424f9c8836b02f449c695ad803014bc6b39408a097ebf43c54b7328804f835f22956a26893b567bea5d182d13acbda32fb6382510313502b3d61e24a3eb089b2ee86c212df0b99b00ad983140ca97cf84638e85211fb944422f6ec45490b4c5d2299ceeb96f5c526da6bc3dc2a58ee36fc190a8317592ec464a8fc12f95d55393dfed0d699ee075f628f4182818f714728eeaa6fa1e0b3302c84e6cdfe81c41739a88d4ee34940a7a3fd8c11d4df29416688e794218d0a5041f840989fb985d9862f7f0b7bd1b6a9e5bb0ffd87a93fb6a30446adde3aebcfcc5da6d19b920f780d3b7e43c5b51a9f663900e16a4d4834cc6ddf182909b69da6a08623c726d98318cee3cb0b94a4772c603797b4005f3b5309c9028bf996aefdc3bce7fdc117e6c305a2e699e7945c672ac51dc4a60804cb376f22add8478cb01ced71538ec9422e6bddb6f2a665a611e8c5cfadd537e598b5264640ecb2410a018779759305f7432847d533a29322ff82f5232e7dc4f8fcbc8dc8ccb6fedf1226fde53c2a03a416645e64563b2c127735eea03924b9eddea303f1670925cb1db61ee058fe4a7cbbfa0d1ab31b57833bd4c33532565722d907ab13a8ad8eabed7f8962915cc8cf338268d9e5af29f8ab79b334932bfb5b6c42a0ded405f7012f421b5f9d8d24fb643a650e1ab6b4f9670debe0abf13ac81f584e14eadfd84fe29e2f31d6e3b1720f8da302eb1ee08d3e53cd8b79a4c9820e2d52dfc9f17734c67cce0ece7d761912e4695ca7d78e624f75e434dac3e7457369ff4c766c8cea74296c4bc864c5d24a3ee7c9c03af8d18274ffa813dcdf881b243aae62a2f1bc55e749661b58ee3229ce81d923d44c7c30e874e3519c7b0a5dc0d17a883d5bf89f798e25ff1ef19fe914a5efb57f34c6f0520f52448164d7acdec725f2e323ce49038b83bed4940b651fdd5cf36295100eb75a083c9cce5c1c93598f419d8c983de9d0f0d1303185998e6f1c5266ade8c9627722c6ce4f3d261dc13a61183456bf5dc9aff95957fa38ed2bb423fd482c1c0fea1f7085a7b4d8f2401e84ee5d9368188f40ef0b6db30650bfe4f79db59af93a1b70877368600bda161fe9530992747</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å·¥æ—¶ç³»ç»Ÿåå°è®¾è®¡</title>
    <link href="/%E5%B7%A5%E6%97%B6%E7%B3%BB%E7%BB%9F%E5%90%8E%E5%8F%B0%E8%AE%BE%E8%AE%A1/"/>
    <url>/%E5%B7%A5%E6%97%B6%E7%B3%BB%E7%BB%9F%E5%90%8E%E5%8F%B0%E8%AE%BE%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="4121c481bc378531b8da1bb2acd69e2ac48d5d5a28050241057ee1dcca02cace">ffda66bfab181c2acf199c136e56147374682d524a8b022b9f8c35ea0638a7c0fbafa91e096ab4252635e94b631c366d7225c859cab4afa4e3ae4c46954539ec55dbd37b725cb8c79208b7af6f2124ee54f7b3725088be93d66219ee59d00fe36c6135d4f6fcde22a37fc164b49e1f5463a1df99a5cd41f8b1dcece582034e60925435e3dd5a3669278b0be58209679f315e25c43f9b73b1ff7e20aea93f16359eafc34d4caeb9376936ba5fca4542b83b4eea89611024cc8c21225e795271b8338a4f25decd2b57316f39ffa696a038df9e8203b0a98a0a389232078fe6b3903bbe67bfccb7bb3d1876254ed967b66be424ea34dceb4a77936894a41e5b008930e41696e411bdb2403d9176e5c43f1073b8b66c88e8dc095ef4c38da50bcd4ba5cf1d61d2e328c5c64d3605a3529b1807672eecd1bc09fbc815d087a669dabba793af25b4af9610f7dd03401f320efc8a7b35846e7fab6d9aa13f2c6dc7204e09f87dc35e8b1f87102d60d04f641016836a2b43790c7128ef710ba7d07b42e4c97f50d0b4b5c241c699e26736b331936680618ed72a2c6e7add5b5d4068b6b1ebaf6e02c39e94435279d51e5cdbc56d8cf04ef72b414fe6d9a0f86d9382924eb60e40798fc8bd7b8328ab1c9747b3cd49e864b8603b38f768d1e3f631f02680eb021d08c53015d0f71bd8aa839c02a9389559ae17a211d2170b0e29e87c1880587f6a5df69aee55784b574ce528d15708891a066c799f10e0dbe9319c0c66bd55c733b60d590d542b4caf82cd5c9beb613eab402da4192933156f07e97845ace30a3013da232269eb72e6c3af3fd4780b47e5428677eded5eb9477ef0b764e2e52cb3e9d6107a2bb0d29677cd3a16aeb10c0417e3ab8f87b0da2d079e145ed8a22f70dde81304d01a7d0d34b82608b6a2bace9cdab4929d7d68d1303b5fa9f917ad224f87c130f9e0dfc747180ec2ccaf5bb32296e03d98b82dd15d951edf377aa63934cf22fc966e2b645af4e1c4945923e61c9dad7bb39e3cdb58f0354f9ee06725ee1c67bdaeb771d7c40d987365710ea13b52d3287f3556262df20b7b3abb4674731b1a28078863f4148b3fa68fb15e9222d52bbe822314483358237c024b9c49825508acb649a69e704dd3e33f7c65d5b06dd69abd4fac949960db00bd8d72ad1ab4a0223ff7e007bd5b71705d6ce91bb9689eee2020244a821e957572b317891c71108407e8f7eb3639a99f653f5a2485ede232f68f0b33820ed638a9220c330622d809b07562a3e6da0e4039e9afdd92695f35f63f19a6199d4b41b440e7ed7588c9635afd1e2a4e592404afb25665bd8d2d60e3d9330d4fe9675d1f57a3ff424985057e2e237a4d346d5c61f08838d4cf37a4c14f122ab0cb4edb10bf5aed0fa8559fc9c6e31faa1dc045e54e25ab60cae1bdefa7d8647036fe1a88405a8cce1a1df9c14ccebda2c99c456e065d13a1d5e70c93bf2252a487102a565d92e958c150ae05f1295225876e045f71198a95e9ba2d872315b7e540548b6b65449c15559be91724b3e8d90c9c0475c067031eef824f40a202e5ea425c9c3cff79055f5d45b51c56225e47d220176e1a55f61f21f0e8243c1af29b928b09af8caf45b41da59d2c83cbf3a0d4c18817c670806fccb65ed24f54dad02d205949e291c7b7f42585ba0ad9ceebd72e113d534ff1ac46e8f68fbd0ce2ee754a24d4afceae5a20a6b54b9ab9ed4f9d9d00113ede61d9faa48be81848f8dfc4e68c52802aeb08492fe5274df57d9664324eda8515a2b2e2842df726538089e40f2152fa56e955f3bfd82e17bb9c6f03f842a208aa02ae076d48f52e3b15eb5f9106e74e91063773cf111b085f4a7c578c8b276545bf217d15cdb8afb4d9100b7944d49f6006f6658ad40998522cc716384b325758c31e9c57b5a3c22fc9d444f57bced1f7fb1c8b59547cf4dd66fe2e5282ece706f26aaee18fa08dcd7f88eb1b91faee45e52be2e74fc3f8ffcedca7903c15417f31aff16173f221480ac70f171af4c78d8ca4b209202a4011b9956f8a38d606e7b26297f4edc0dfc6f0ed2637f5d86cfd551793a84799ca69fee540ce895652a62df545a92450172d075412b34d7420fa0f9d491ba8aa59ff8a985128a02756839c034641eb66b3389bbcb0f707fd415d0c49fbf737211afa390335056da8d45b7f435abba28a93e647a8163731137462b826e15f1e643555a3eb1205ca12635b9d9fe4bf1f19eb65f24875a6b8e5440cec703b34eb71a7b81b8343f388589ab246d848d6a66c220e7cb07ba90a301f05deecacae04ef99b532f207fbbd587e90375993591ee1b1b66941a594e0cf28811c5fd4bbc76966a07237b36560ee8513359a1b3affc4e23a2036299f4cbb151904f678edf74a8da092944ae8705fc40abffd625086ee6f59201a3e610ad800d1870a69e205ffc3d079b6ee43d22b999494f4b24194a2ccb0fcf5b4f03fa850a4307e5478c6f39b458fc8cab0c8e76041722180ff74a367c52fb2c978674fb885c0c37ef4a3a7d6ee27ac1fe4f6426cf83bfdfc4253713cd2cd41c30f8161e8271d09b3f2743dd40a5fcb8859f6b9f348fe5509fb21a0e5335bba4ecbec8c57efa02c57d9e71cbadb967968e7c6d46cc6d9fe97b7b745d2b530850dd18e9e50d9a430c3ac34f036c5d4761c76723f55d3cc6ec9b231156ab9c3d4e9c25cc8abe3aab4093461bdbf558bab854a8b288d9a213dbe372a3f13e4ee16f15208e34a389269a25983354948c99833ea68f4a01ef3b1959d0bb2e4d5a0437d5ba6770817546a25f045928881450b33dde0ed356dd605a15371dabafad7830bcc2171acc22ef897a821d3e4fe68948972289213b4280a38a6858d6f14119015f2670556ca9302345405e7fdb14cace7a1da28b502f2125363509cc822d63101b781bcd770d37f6e73b3497b4c60e6c0dcaba838a72c72174782b34992b7b36797dd16aa307d5b2b1d0a789245588ae5f0d946c7b3d07e6f1f714c5e29fc7a8fef591391ff721aa127cb165defb8a1eee9a6378c1b312947187794eb1b1772ae6728744e6c4ffd996765e9c7f0444a152692afbaa279ce3fe0eeaf97b4c1ef1df727538dd885a69ff552a6782d341fd50fd76df34d539f14aa10b31205855a221dfd3413589ff602de8d0dcdfecc274e2f7201ca581d45f2b420ba29a4b94d52b01c8a5e86a0d3120308c4c54270a56ff4f7f46ddbc57bf880c15e6252c5cdb8a7a14773e1781e88c230a982b353e3583bf929471ff1eaa85f8939977bff29b53df11eaa380a003999bdd0d2a449dff3d4ed2fba2b9bb6b8a957354942e702b66a6ea4371d21c0961c1725a4ed18150bc379e15f73560560f2859c3f87172e38990726e5828dd92766213af0a0908302c65e7921ec19855c92e5127dbeb8f7366c19a7dcf62e046b9c4236601efbf6a6480c795474511106b5859604b7406b99055c426b41f053d318271857a233e4fb1955246da01d77c0dde37cd045ce998bf64c9aa08dd8398764b95aef71eaa879016275204ffb5cb8f0775d31431420d42e6796d72d6b7d56fd61e5c6e44e01fdbac8fd35b44417d769f5a2b4f701def9ec379bca91cd9a572dccea46aba480c59f8a71d689dc4f3ef5c8398537c864ccb6485b34088118e4a99d180e208330530fbf12c014d670681dd28b9c6d05c6bfd7bfb77f8a0cd33280260075c708643b75d953c3c57927eb922264da24d38eb5727008c0bb762503f43b25b3cd5b31f34414396b1bc2d4fe7c1969ed0bcedcaed69052827777af0669b42ca1dbd1a56b64979aa23eb64668f3e0f944a046ba1c295db86208c1409101e5e8efaaf8be80c4cfce878085b3ca11e32bc346b59ba606cef5f51ce1e9b64d8db7826c873ca41cefa39ccdcc2b7a01455b85286b4f572ef31b16b7c6d48a30ac2cc79a87721d2b08d6566bc7e8563ef2e52531c58757e15e94af5ac1b2f34030b6bfe45e05f2098634ec7ecc7876ce973f432c38992c5083360d1ef8d09de3519c53c5e71de6b8017f1d128e0ce8c491fcc9ea0f4de98b25e012a352359f3d5caab727996a44529cc4b110920538efb3f3b9e169dd2d51d6eda6359615089540f746f0f525a8a51ffd41ccdcc1bb28e425ab95761d77e0a11db9dc491f8218526cb71a3c449c15e2a8bbc46bd2a3d98572e05b479964e8db3aaad4f16c2cf0d8295f282b91d9302cbad4f4cf85f8cda9b6b9fe48ca6a06c43b78cf50898bf49465a12f2d56757fe499fceee812f888d16ad3c5f5bf606c9e1f9bf2d57f54a2ce26161935e6cce37e8f1e4832f55d5f59a5e1acda2a8a871923b4f660d770f85836bcf77d037098f85098b32bd04df05103cbcfcd3acbc8a46aa61e2a1756409fcf2be5f1963a4cf5d7ecf63072af4411c02543180936e74611f412f9dc57fc1d6bac0774d8d14b696ae7d6f419ac23243de72c12f150f79f905e6498e057b8937b9b2699f365c3c04751c3a6adac4c820dd0917310530c24e1f3e9b641cb2d50d556d520297158c552ad546d12f1a223039dcfa4a38d69ae82ad933d0917f49d92db369bc27da865a637cb093b3353f3e4b896f56ff0ce11cd391400db0bf6e37603fd556d410fa123f21023c1b9a41851e95ad9eb977f07fd305c5313cf49b59264d01ff69dc988ae1adee5441b5bbb81f707b619c718b3597c344f39f4448ac67c402805f3067c0461d42278b277bdcf6f110f7b22c3176459e47e68938581731d521fc4be0a344e6d9b98842f313cfe90e5fdd47ec6acae849ccdbc712ea48b8bc66130de89018329fcebf1121bf2bf5a9b64be574b68561e61a5d3aa1619ae8e6f5c07527acb93fcfbd2a2ad69aae2c869869a775f9087f4c0b8fbc60729118adca59c67c7e89a365e65954e376eb419e1a79bd77321dc0a8b9199e9806b0b30481063e7c2e435e2685a64b87163a240c7231ffe7e6ac34701d109c8d779dab38065d5637efac057b0e833288b174611700671fcd6d91ca41915f5dc01e133f54f0603343d7e31c89f17a22b564dbc6fbeb9c9a61626f8d7bda51f9add2654178076d34dae75bd766b3aad8b6204daa373a6bee2b2d829b8e3f7c6b101fb7d16884c20fb4885b0fac1a28830d5d06640e91fe78f3681cdf84bdcd605e6d472e9f72446152e0f0f34992cb673e4d6d527d6d6608d6f1d5d6479e415a923d584eb9a883ce4928f23c1ba7c2f439dbb08ea27a9e59499d35bd0f41fb28c68199973d0e98da042f386944cf35e75cd9280fa1a5e2d641d091646b318906a4d3c781903c4ca30c5fcbde0cf8769da76b08e110914471882e07cf079751eaa3a58f5d1c9aa874c53a072db7901dca00b3f001a6c13e4b519d82ca0b8b9c505f6b8f9f6fc9956170b79f7b645067d73f8a3e46f9f40569df1b041ad31750cf49d8c1dc374d5a069d2b3f10fadf0fc22518477d4a37d40c8fc91cfc9654f6856a77b2151f678d60a1224e7cb0ed4e382d16d25ea770e02f125467e3a63c3b4e163f258b75271c4b523ac5a205a5f79bfa2f78421f27488af72ed03c5d8359243f441d8d34faa393b6fa9c833856741832e4a607c78cc72f720a4e5628743902c06c156061a6dfd397b40d7ef5810dd6f3ddb143488e95acf358690c1ea1d3e33ee63c772f3c7fd2205a6b833fee05e745b08f1f42b4e3632fd03798807158fe1f93c23a03a6a087d0c3dfe0d772badb5cca98bb1fd88e42ded832f8c4d44be8c6c56a7622c6b0822bfe2c98e2ab33904c60b79bf345953863c652b4559ee6bc69e33d296ff8f4155ff1bdb6de29a84014908d357f2c9f4dc76b88d15c53aadf1ba5393d85d45c4a7010b5e8b0fdc0fcee4dff218b999c1c2c21bfd772ebcdb0df34e313b2d3ad4531b21a8b7124391ff60651a0087aad2895638b439660812c496e23e84129688a8eb4d1833011801326fc8d355fafecb702476cb35f5875b6d623ec9c7d0cf18e58ec6389bacd3fcb7ac3157ce835f6cf713bad3bf7477649c5c244076e50f581f1fb0f08fda3d1574a1bb85df8fc45f1da9f42e97398ddbeb20b8703b09f9f95abc1bd0457d53aa6f570f61c29125d8932bba9b5f433121feecc85090e1578550c77496226e2ba68c613f1567493b076f782722fb8008e2d7a250a7d18d4d9780abaf308becab7d44fbc779ac5b1b6a19a338762ca14ba364ddf261abfdbc0a25f7ec049a8b3517174d0f3e87685af5e99b06403eb768307bfa7323683e2950b61ca7c95752aeb0013bdecb276f3f53ef87b533fbc940fc11d9b04f11d5127c5d4ddd2215126195b4b7d6081941078349d7232f6af7590bc78f478bb14b897485d1098b1d96a3a183d7c07eaf0c164f900bcfa4e7e7625ec1871133b40aaf4ffafe9ed5ab5ee43812d343b1a4bdacf9db21b38d025cca42f085d4f10078cf5990a0b976ff31d3d0653bb75b7121480a4f5fe40bc812240f32897fa0e84808f3383b12723c6b59edbb65e9ebb44fb88426482e75279503100c8fba7bc74f414b15eee6f5cf3baf912c2b50dacd993dfd5e00d5c24ddd45361df148927f3a4f500b1c06013d0108da282f5a1b37158fb9b23d6cb8a1e0c01bbc7c905b5bb313ca6d48c137e097fe2e5e89ba08395427f67e969e8d0f4d724debee99280bc1b50c9b5534092dfc1700aa6a695bdb49bc2f777025b38d3c95e1275f9477afdf019eea9896aa7a836fc59e1a7a690629253f0758fe1c155d8becc3a33098f13973faaca3367a46248a0ef8912190b514238888d3cf4dd5ff9f67f96285cd2cbb53c5b9eba398ede5165bcd008a4e080473bac2ef0828133d477ce25c952e88a08f14f889c17a73dddbd1d83cc4881214c92d59b905d2024b35cbe0b5b99c274930fabb1fd7886a842460b990f4d075b4763777ea895878f6ea70555ef9845eb8d96bf4cf58ad378b1238e24c00f6fe88ce37b3e5d044ae38caa7be259b8dc4339a4a3c2cb2c95ac9e150f020af6e7f6ef5f0aaea91d09690b22c9393dd3c2fd5ff65e7f39d32b4796746692e6e05b960f810db711ab85f2e6e3ebc81b0ddf470f4e3c45be95a94e35726f1073ae4b21c764e65de39bb2cae851a127d357e9bdd8a3215aa9a6e73210827c570b79202797d55686e4e13de1e1a9d708123567ea658d94412ff7cfa477b3d13766bcaf1ba45b2086b20dfdbec634e4c9f9a8e483eafcc0c95df5cfceea1be434f594eafb555eba75a34fe18a35f58988e24dd2b8805304ef387951788a87586dde74d39e5748964d520d7982ef51b7f5099520c960ffa7dde2b58d83eee9f678e5a055c7e63eeefb08fbb2079ea2ad2444c812ca5ba981932c1d385151070fd3ff35f9e66a81e8d737264aa797dd345cf1eacd629b8dcf328dea1aac290a5f59f9ba42f9a1bf0048737a6baae943e17317b0153116c2d120efb277ed39660baee02a34e4d91e845c6bd4bbcb5792e9338a2403cbaa2e4f43964bb0c8267291b114f1fc557b64112f6b28012a69f9706df3a642b5385ad4e6199c8eb0216b1b239843a49100877094eb5cca116140bd22901abe8585d859d9c936788279765791f0b04f7ddd9a576259d26166552b7514c23134025dac5721904dce0a3915a8fd0ecb1adada7ec55d00252c351611e714c07a8d0e45947b55566cf5a4d22792b1868b7e08d2113588f45911e7f921e5ea295d1518cc518f83d6f5091233982d593a4d0e32ec30d0c11135e260b4b8b8ce7783cbc0afc06a7a6151e7663ea1a770a0f7ac30cc41f6ed8af2c3e400142a9dd90276f9e357150e2ce81a74d22d1f3017d430f579044db0c117619c1f9d9f6fcc25f3356b5e2101fac15c98091bcece2c3a8c0ea4a36956cdcd81f7c3465c94b321e3d31e82aa901aa39df5201dd5881b6633037121c64cc2c2dc4dffb74745090174ebdd52b8d9fbf1c28da452cb97580f08f4dfee704fa79137e9eeb24ce5fe508923d1cf86783b133d797894fe1d4eedf67c6a1e259a1efca6f9b572bde072a521a102eca21987ace2d747f27ee6b07c37d2981335e0d1b3cfc7dda7d629b9c994b05f6c6a225fe9067e97ceb1845c01cbea3e77b68a7af0c4981f16cb2cdc05ddcdd855ca8522559b1dd7d3086bff4b6857b4014830f074cc88b88cfff0af1b2e74f187161896ef2ee407d40e7e0c94832b02074194fd7ff205a4774c6101b6290105897ac925571d15ccd3b5a62afc326ecfd91c4ce406b213717161af33aa91ca7e7e6e545dfa7fcca738528aad54f5af59edafd50472b5cad81a7b367932de9691ed7235aeaf8f8648f014374b175cd2b196a1030108951efc9d5b543f0cbb0511ec49e013ef3034e9c502da9c8afb03573b11175e7708cd35112e6c2e25b41f5d9431fdddd6d545e44d60419306a225690b024a90fca60597fd2044b618f7aa90bad3ed7f9c129bde00b66d032909ff8e9b857defade17b75e95279377497b4a6324fb67227c2605d3aa9006fd9f6d421e0c719b37d16c61d917f39b05522ed31136cea55c6a9bc357803d579c88432c5baf7daf622188d6d04c33e8c863355e9e9ea4df3112f41f79723990c482b7627072e794d25ddbcb7dc14f2471af654f1089ae2f508d508a354b40e057cfd31ea9bbfb400ac7dadd749eaec570bfb85496fff51ec48ac9d29a0348f59954dc51fb5c2948e385ac6867921f942236c1812866b6054599637d104b1caf69cb9c8a6e009e52f29c61eb92e66197039c06456a0e1e5b598bb6e8162b3a6c9779189aab0bf7e8314ec3fe845f4ac96d45e32d748cecbc712f66676d30e5886ad373bfdbfdceaa04539f075c65af4d192c159f3b4d3e5c2160a522fde45b115c74685ef2171a224940246f3d951da0fd756305bb4fcc5804b7a141741a5ed139bd440b67fc11e90e4cc2b7af78eb7df441e02746c62046105bafcbafa2731b7d67ff702031fd7d7e9d6b3cd949a4c87d6439066c364ade206a1c5bc4c490f793ecb1864fa41a2ef8bce436c99e18049551ba1875f40db4536a77bebca51f4e01c238cb621bc89bb9b932587b5d2aee55e723c23dfc8ec1609a865595e675cdeed966263fff2efc7e3c91d82b7bd94877578939e8389d965d18b956f995e9a329b74f7302ca9657c844bef3cca693ac7e1b1a125834510a2e00a492e489b28fc7c9c7038720e55cdb141186832da7efc99e8661f6c80dc100dc15644e93d4822ad6041706f688421a9ce0b731b6e7a00dc061f532864ab14e1746c0f160dd00b72a46be638dc8f5eb4518bd3830fa4299bb1227ec09b443af67933ff89373c3b7c3654a9855f7bd84a970729936d061fab6799c19c36980168965737363198c99ccc50a2140f7f96204b950aeccff7795758299b945a8f0ac01cb318d62717a70d833c22fc8abfeb2e9289ffedbb7b84e53b05dd85675549d5afd5bf359e2648f8d33df9e959a89b6b4a903a3af14b58fcf4744290cbdf170a624fb48ab2a0dc715d755caf535e95d621a5c62cffae716f0e37124df13252a1d726448ed9a7acdc73b5c2fdd59eab9df14a92396583bbaefe1b2bae955421cbd0d61d88274da6755ead81df242f6b733433e4ffe39382f4eaca2deadd2cf13126ad1b4763f64a60fb6b4c460565e2841af8d2ad044a5eb74e1d444c48bb1f4934bb588f2c4d9ae09845ae03f969bc069798a1a16f2cf05ffbb1cdcc0fa1f249f5ed63c82d10f74a84ecd8c8f2a3aaf7848a44882f20ac0b62676cb9e6d1e6fbae0584b4fd1ec6f8ac46f98a4e0d6a98e786cbb94364585f4cf97dcc952828d342ac097d9324e0d404c85f3d3c9eeeebd530cd90a4acebb279a72bfacb3e2a6cb549277b67499ad3a8d6ab260f938470670443dd8b1681933396a2875201c77dbd4acd171e6423cfd5639d88f7d3c154d9e53b4a7266314d2c98ead561a4c087dc68df74f42ea7715cc4a914bb8788c0295b2ab6a369bb1f90e872cf1f28062ea76f652bbf907992376cffc9c4d444ac52e101ead487b938d504fc477a3e12239a1ea0d42e39973c6febfbf8f90c286c708438656592f2e96986ff079c26532c77b726995da64af46fdc1c678c0e00f15d2491be8e7e3a79b9517452344b9b95c53b42ac117b98fa2260c283c23fafba8232d5ac168be9b3a5716f8144e12c6d6dc49a61f4b038b6f3bc4aea5cc9ce295fda98c712d92dcd11dbf3afcf477f6c06f5abc3b0d8fe3ecc86156d9578c1e0fbcf7325dc5df446804ebadcc4af5c32073097f87ea54cea739686c2c15d642f75b33cbfb4a9d309c16d8661ee557a41259d34eb45275521d466e058df07d84b6843b2b901aa32463a9ea7a67bdb8d75a5fb359577a76d407330001875886144ebbbbb1e41b79bca476919c6bd75c67890d0493b72423a04589b69c6cd91d3b6bc80be0d1d8df73119ae7e57d6be6d9a2b205fb7385935bbd37d7b77cccd857621d48633eecb104b246edc4a0aba36034f38f942bf808f6cfe5a89019836d963ac2e2393f97d986f566e15252acef38f9fc61db4f140e4911edefdad2c994908323b4044bcdf2edba508b473a7bb0be3e1d4294a33c9e4d78bfa3aef1fdc6eb0e8caa293a748d2ace17aacb1142fd728687a1604d559bdb3d19a06160d1b0511c031a6249c3d62ec93ff497f32154e040665bb7c041eee11c75a9e287d5baa403377e216f079c41aeaa2f52d30c8d288ea3db70b55997d23ba96fe33b51a9859f978ff37c40d857a71e243bd52038506a632922eb682fc254f5bf1530271b65d95fd6ed48c73697040d7f1774a523487e9143b107ca8d059f283a473c7edd52ddd2e67ae5bb0c5a781627069c29946cccc8babbe3f96c604628b3d8a8df78dfce5379669f82bb1375a36b6a891550953e8f88f6cf9236eeae50de2c6738d5b9705afb043ed5a88c8d9e31ea98777db40cabf999718374b3ad9b3b4859e353050d9f8e45d051c770cd6af513f28e9ceb6bd8343be89900adf9beae1ed7c405cfd7724e22bddf6a51eedaa1f8f1e446a6b7fc6bf3e505ae4b50d2819a8894aa40758cf186d8526582f146ed0464b5f7256b25279710c52d32190e876f461c143f15021a6924ffd79daaff68a30bd8a825a9ae790446fbf8f45c9b2134a973a0e28008d12f884ee9826840275d305dd3a799d831c0f7e1e3d25ba14d8132cf3c96ab830f3fc1f240650d6f25a434a51af642dcc1cfbbd0751ddc52725a0abc7593b4dea92fdae87f754be184e91a833cd72f89827081c43c1d31b24216790bf348038ca9edd92a163b53acfe0c9415bba5b2c5f5f53ae04119740b82eaff38efe13a92b2e4f99c349ecbdbfbf26db69a1e16ab265be0e058107311cffaf4c340e0889b39f9bfd6bb74b312dd50b379343d22a5d80c73aad4165aa71c1daa93e4ad16fde61805ff43ff6a281dc329f386ac62e63cf6ecf5aec3a299a62d99a1a696bdc5534696389e1b3845293a5396ecae70ae06d2950ef7df111325bf06fbc16b8cc657e5e415f2f22c0f87981f1b590343cf35da2c7283d2b3dc9552c9a83e5a1a3ec499f86bbef487c7055dd5b4834d01bc2d7af76ae8d0e38c1d200e2421310738dac218d6bbf75b80e66e1a7744eb688b0eec7606c937e1a4bb4be545d39ab6e62cded4cb629050ab5bd2a0ae28e31e4e63ddb255ba8ab40f6c31def36a97f1dd5225651987bc1efad5fef6f349f8b096fdc182aa6cff6496bd8a4c862289e1561a8e11ba9b2aef002dd5f7e31e0abee3ca96e7c9318d3cc4aea1dd2c4d414bd8d4cde79a561725ac3821fbe4b93b02d42ac04081afde0734b6a31bcc521e9d75e604196db46abed021d24b5e747bf088e376ddab88305c100d47f2fe7d4195561b1f11c0ac310ba9124689567b3de3cb2d4a45994ded4043541124b3458296c63e5555b816efdf871edab54f523c5ed47d1bd7f26cfcd83e7ffea0a9e002db071916bc922bdf6cf69cbfed5c9604337a18d16ac988695ad91edb356d2276fe3dafd95c7221e6abb21798c17bc8f3e3475a08facba12eede90f6297ac6ac2bcd2757779ba7c20c10fecf71c241ed2a876869e6ab5ea3a0dea830fb5e766997382fead64e947ce9ac06ca03423947536732eea241415dcf1113b865ffb32fe0ce12917cf2595cdecc7b43066da3d518a03aa31eee6619497f0cae5d6597c8a31f83dfca8daed1d3a7d1c189e7f1285e58ab0c699970677e7d39c3fc0fbfc57b88b6a61cbbe3ca7260cd41089070111bf33c0e1c810b6d48c783eb69679be2d218ab377e434b541364c0ab5e89baf8a3aaf755aac46524440d97acc24cb786e1418026533b7bc69ee2a2a1aeb203cd33899997c67dab123e194a7f19f130340cdbd1eb2c2fc9c56a4af0aeddc688c9e0037cbd6262805acab51e028a605f608e77b1e4a544392cdfeb83733be12ce0f4a7b7cb8d4f2b565a82b1e898a1cb118f6d0764c07fa485203855da36e224ecd743483a2dfc984b65dc5e1a783caf57d042b5f20cb094a8c6de66ce36ac83bfa9aee577e7fcf3ae656f13e7566b8636d823c7babb88ab0065f302a56205cd04f58ea821fd8c71ccf53ae32d7fbd727403ceae644e850e59a537699aed11e8ecccdbf8c82a33c5717ffb09a295b60545de2bc1487d2a344f3a1edb2782efc64f4d9314bb2310bc7b088b798362295a08784ac82c37997dde8ccf4a50b8b74ef55e2ece2f379c52ce00bb800df0c468ead1212097490aa1c43f42a6d91fb02df00ee501a6580bec3baa2c93bdeb37be3024495a9167ffe2d94d938d1db5aabd9ffd6888ca50dbd7206168846851004d4da5520a594e4d0e51233713a432b87cc1951ece99efdd830104a88002a5464862abb16c8b3c83a0533bd1ff2973d271acb45089886628c63708001c5fd660dba682f186a2dbe1c1ed3cb86617397d3fc60b01a80e1db4468f7d7dd37742682094b7adc9d4bfbe661b590ae51e799e493161e2f3522c8248f532e57d9ea9945f4bd8125890ad964cc4dc27e2e659320c62bddc318be8306337b378ed529cc5469076848be8872b87e2e11da4b1bc76c048c74302e784d4d3cb8f405e375a30f1a37ec0944faf115c421c9010dd35273080e59945590109ba273f5803251e522e70fc8397f359a86d856ea397939dee430f74b33ad782181b059bb5fe1a18830843c1a504b45a444e681b83b7408d479acece5a9a367c34756cea9e8e25c04dd54278628f4eb1679dd7dd537dd692aa1e904e2232aebb64f98993eb8e27d32c9287080ea210447ecfe41d4fcff0d9dbca02e6892878d2c898bcf0e415379b2041dc6b964e0621d14869fb5fd689d69333815d603ada5551c1963776cc6eff12d116008ac145d46a7959aace3a95ffdc483744b0bda24bb2f0aac4d220ae8577ad76c632d557c31792a60dd42b728aecf49e2d17f9681809ad3e8403a7f1702743a03b25fef6d86fd375011581bd6ff5a56489069ccc458229b972be037a25c49eb7e2cd4cef36962ebe0c0fc9e679120bc206da2e1138c59a8a420b4a56b7b37262a204ea6bc3fc9cbb1b09b3b46433345900e9cba2ed12f53fb9a1c7623990dc9d4e0706fe80db5de9045145b6e93e494efcc96a1f1f81db8297747f58ec767c0854855d077e5a43699ffec1fa86a1076190f6f95b7aaf50bcad886d91d1ecd500ae01512749d21f8f2d3eb19241850c4230567a49307e345566471545404c224ef7414ddc9ef7739a1b1444ac5ba78f72e28a4f2bcb8fb4de4168984ffc0feb30fbc8e4c6cb9ba8add434752b044869338f93a683d4e7c0582b059f649ca21b61c1a750b15b6df2283fe610304a0ed6c12193442725f65431a3ff77dd860f9c92436aa1fc7c3d2093857ac1d1cbb44932f6f287c73f5745da87523fe779c611f272040d2181ed03e2667f0df5348bdbc675852c4ce90282b10e4dba27d014f11ca3c48182245faadce269cc93425c36dddc630b418ee32a622d283249827189bd5c4b01438df4f83eee3762583395485d41e15cdc604b4bca10c63c5faf023b37dd1fea5962de34a457f030dcb40be6856470029a3592dcafa7c31785afcf2bd0f5b</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>dockeræ­å»ºELK</title>
    <link href="/docker%E6%90%AD%E5%BB%BAELK/"/>
    <url>/docker%E6%90%AD%E5%BB%BAELK/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ELKæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-ELKæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. ELKæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. ELKæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>ELKä¸»è¦ç”±ElasticSearchã€Logstashå’ŒKibanaä¸‰ä¸ªå¼€æºå·¥å…·ç»„æˆï¼Œè¿˜æœ‰å…¶ä»–ä¸“é—¨ç”±äºæ”¶é›†æ•°æ®çš„è½»é‡å‹æ•°æ®é‡‡é›†å™¨Beatsã€‚</p><ul><li>Elasticsearch ï¼šåˆ†å¸ƒå¼æœç´¢å¼•æ“ã€‚å…·æœ‰é«˜å¯ä¼¸ç¼©ã€é«˜å¯é ã€æ˜“ç®¡ç†ç­‰ç‰¹ç‚¹ã€‚å¯ä»¥ç”¨äºå…¨æ–‡æ£€ç´¢ã€ç»“æ„åŒ–æ£€ç´¢å’Œåˆ†æï¼Œå¹¶èƒ½å°†è¿™ä¸‰è€…ç»“åˆèµ·æ¥ã€‚Elasticsearch æ˜¯ç”¨Java åŸºäº Lucene å¼€å‘ï¼Œç°åœ¨ä½¿ç”¨æœ€å¹¿çš„å¼€æºæœç´¢å¼•æ“ä¹‹ä¸€ï¼ŒWikipedia ã€StackOverflowã€Github ç­‰éƒ½åŸºäºå®ƒæ¥æ„å»ºè‡ªå·±çš„æœç´¢å¼•æ“ã€‚åœ¨elasticsearchä¸­ï¼Œæ‰€æœ‰èŠ‚ç‚¹çš„æ•°æ®æ˜¯å‡ç­‰çš„ã€‚</li><li>Logstash ï¼šæ•°æ®æ”¶é›†å¤„ç†å¼•æ“ã€‚æ”¯æŒåŠ¨æ€çš„ä»å„ç§æ•°æ®æºæœé›†æ•°æ®ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ã€åˆ†æã€ä¸°å¯Œã€ç»Ÿä¸€æ ¼å¼ç­‰æ“ä½œï¼Œç„¶åå­˜å‚¨ä»¥ä¾›åç»­ä½¿ç”¨ã€‚</li><li>Kibana ï¼šå¯è§†åŒ–åŒ–å¹³å°ã€‚å®ƒèƒ½å¤Ÿæœç´¢ã€å±•ç¤ºå­˜å‚¨åœ¨ Elasticsearch ä¸­ç´¢å¼•æ•°æ®ã€‚ä½¿ç”¨å®ƒå¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”¨å›¾è¡¨ã€è¡¨æ ¼ã€åœ°å›¾å±•ç¤ºå’Œåˆ†ææ•°æ®ã€‚</li><li>Filebeatï¼šè½»é‡çº§æ•°æ®æ”¶é›†å¼•æ“ã€‚ç›¸å¯¹äºLogstashæ‰€å ç”¨çš„ç³»ç»Ÿèµ„æºæ¥è¯´ï¼ŒFilebeat æ‰€å ç”¨çš„ç³»ç»Ÿèµ„æºå‡ ä¹æ˜¯å¾®ä¹åŠå¾®ã€‚å®ƒæ˜¯åŸºäºåŸå…ˆ Logstash-fowarder çš„æºç æ”¹é€ å‡ºæ¥ã€‚æ¢å¥è¯è¯´ï¼šFilebeatå°±æ˜¯æ–°ç‰ˆçš„ Logstash-fowarderï¼Œä¹Ÿä¼šæ˜¯ ELK Stack åœ¨ Agent çš„ç¬¬ä¸€é€‰æ‹©ã€‚</li></ul><h1 id="2-å®‰è£…"><a href="#2-å®‰è£…" class="headerlink" title="2. å®‰è£…"></a>2. å®‰è£…</h1><h2 id="2-1-åˆ›å»ºdockerç½‘ç»œ"><a href="#2-1-åˆ›å»ºdockerç½‘ç»œ" class="headerlink" title="2.1 åˆ›å»ºdockerç½‘ç»œ"></a>2.1 <strong>åˆ›å»ºdockerç½‘ç»œ</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker network create -d bridge elastic<br></code></pre></td></tr></table></figure><h2 id="2-2-å®‰è£…ES"><a href="#2-2-å®‰è£…ES" class="headerlink" title="2.2 å®‰è£…ES"></a>2.2 å®‰è£…ES</h2><h3 id="1-æ‹‰å–é•œåƒ"><a href="#1-æ‹‰å–é•œåƒ" class="headerlink" title="1. æ‹‰å–é•œåƒ"></a>1. æ‹‰å–é•œåƒ</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> pull elasticsearch:<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ"><a href="#2-åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ" class="headerlink" title="2. åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ"></a>2. åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mkdir</span> /etc/elk<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span>/elasticsearch<br><span class="hljs-attribute">sudo</span> chown -R <span class="hljs-number">1000</span>:<span class="hljs-number">1000</span> /etc/elk<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span>/elasticsearch<br></code></pre></td></tr></table></figure><h3 id="3-ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬"><a href="#3-ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬" class="headerlink" title="3. ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬"></a>3. ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬</h3><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livescript">docker run -<span class="hljs-literal">it</span> <span class="hljs-string">\</span><br>    -p <span class="hljs-number">9200</span>:<span class="hljs-number">9200</span> <span class="hljs-string">\</span><br>    -p <span class="hljs-number">9300</span>:<span class="hljs-number">9300</span> <span class="hljs-string">\</span><br>    --name elasticsearch <span class="hljs-string">\</span><br>    --net elastic <span class="hljs-string">\</span><br>    -e ES_JAVA_OPTS=<span class="hljs-string">&quot;-Xms1g -Xmx1g&quot;</span> <span class="hljs-string">\</span><br>    -e <span class="hljs-string">&quot;discovery.type=single-node&quot;</span> <span class="hljs-string">\</span><br>    -e LANG=C.UTF-<span class="hljs-number">8</span> <span class="hljs-string">\</span><br>    -e LC_ALL=C.UTF-<span class="hljs-number">8</span> <span class="hljs-string">\</span><br>    elasticsearch:<span class="hljs-number">8.4</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="4-å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š"><a href="#4-å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š" class="headerlink" title="4. å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š"></a>4. å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">docker cp elasticsearch:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/elasticsearch/</span>config <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span>/elasticsearch<br>docker cp elasticsearch:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/elasticsearch/</span>data <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span>/elasticsearch<br>docker cp elasticsearch:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/elasticsearch/</span>plugins <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span>/elasticsearch<br>docker cp elasticsearch:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/elasticsearch/</span>logs <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span>/elasticsearch<br></code></pre></td></tr></table></figure><h3 id="5-ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#5-ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="5. ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>5. ä¿®æ”¹é…ç½®æ–‡ä»¶</h3><p><code>/etc/elk8.4.3/elasticsearch/config/elasticsearch.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">cluster.name:</span> <span class="hljs-string">&quot;docker-cluster&quot;</span><br><span class="hljs-attr">network.host:</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><br><br><span class="hljs-comment"># Enable security features</span><br><span class="hljs-attr">http.cors.enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">http.cors.allow-origin:</span> <span class="hljs-string">&quot;*&quot;</span><br><span class="hljs-attr">http.cors.allow-headers:</span> <span class="hljs-string">Authorization</span><br><br><span class="hljs-attr">xpack.security.enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">xpack.security.enrollment.enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">xpack.monitoring.collection.enabled:</span> <span class="hljs-literal">true</span><br><br><br><span class="hljs-comment"># Enable encryption for HTTP API client connections, such as Kibana, Logstash, and Agents</span><br><span class="hljs-attr">xpack.security.http.ssl:</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">keystore.path:</span> <span class="hljs-string">certs/http.p12</span><br><br><span class="hljs-comment"># Enable encryption and mutual authentication between cluster nodes</span><br><span class="hljs-attr">xpack.security.transport.ssl:</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">verification_mode:</span> <span class="hljs-string">certificate</span><br>  <span class="hljs-attr">keystore.path:</span> <span class="hljs-string">certs/transport.p12</span><br>  <span class="hljs-attr">truststore.path:</span> <span class="hljs-string">certs/transport.p12</span><br></code></pre></td></tr></table></figure><h3 id="6-åˆ é™¤å®¹å™¨"><a href="#6-åˆ é™¤å®¹å™¨" class="headerlink" title="6. åˆ é™¤å®¹å™¨"></a>6. åˆ é™¤å®¹å™¨</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">docker rm <span class="hljs-string">/elasticsearch</span><br></code></pre></td></tr></table></figure><h3 id="7-ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•"><a href="#7-ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•" class="headerlink" title="7. ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•"></a>7. ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs awk">docker run -it \<br>    -d \<br>    -p <span class="hljs-number">9200</span>:<span class="hljs-number">9200</span> \<br>    -p <span class="hljs-number">9300</span>:<span class="hljs-number">9300</span> \<br>    --name elasticsearch \<br>    --net elastic \<br>    -e ES_JAVA_OPTS=<span class="hljs-string">&quot;-Xms1g -Xmx1g&quot;</span> \<br>    -e <span class="hljs-string">&quot;discovery.type=single-node&quot;</span> \<br>    -e LANG=C.UTF-<span class="hljs-number">8</span> \<br>    -e LC_ALL=C.UTF-<span class="hljs-number">8</span> \<br>    -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/elasticsearch/</span>config:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/elasticsearch/</span>config \<br>    -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/elasticsearch/</span>data:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/elasticsearch/</span>data \<br>    -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/elasticsearch/</span>plugins:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/elasticsearch/</span>plugins \<br>    -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/elasticsearch/</span>logs:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/elasticsearch/</span>logs \<br>    elasticsearch:<span class="hljs-number">8.4</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="8-è®¾ç½®ç”¨æˆ·å¯†ç "><a href="#8-è®¾ç½®ç”¨æˆ·å¯†ç " class="headerlink" title="8. è®¾ç½®ç”¨æˆ·å¯†ç "></a>8. è®¾ç½®ç”¨æˆ·å¯†ç </h3><ul><li>è¿›å…¥å®¹å™¨ <code>docker exec -it elk /bin/bash</code></li><li>è¿›å…¥binç›®å½• <code>cd bin</code></li><li>ç»™elasticï¼Œkibana_system è®¾ç½®å¯†ç ä¸ºâ€œsith-mesâ€ ,æ‰§è¡Œ<code>./elasticsearch-setup-passwords interactive </code>æˆ–<code>elasticsearch-reset-password -u elastic -i</code></li><li>é‡å¯å®¹å™¨</li></ul><h3 id="9-é…ç½®Monitoringç›‘æ§æ—¥å¿—"><a href="#9-é…ç½®Monitoringç›‘æ§æ—¥å¿—" class="headerlink" title="9. é…ç½®Monitoringç›‘æ§æ—¥å¿—"></a>9. é…ç½®Monitoringç›‘æ§æ—¥å¿—</h3><p>é¿å…å®ä¾‹çš„å¤§éƒ¨åˆ†ç©ºé—´è¢«ç›‘æ§ç´¢å¼•å ç”¨ï¼Œå¯é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼è¿›è¡Œä¼˜åŒ–ï¼ˆå®é™…ä½¿ç”¨ä¸­ï¼Œå¯ä»¥å°†ä»¥ä¸Šä¸¤ç§æ–¹æ¡ˆç»“åˆä½¿ç”¨ï¼‰</p><p><a href="https://help.aliyun.com/zh/es/user-guide/configure-monitoring-indexes">å¦‚ä½•é…ç½®Monitoringç›‘æ§æ—¥å¿—_æ£€ç´¢åˆ†ææœåŠ¡ Elasticsearchç‰ˆ(ES)-é˜¿é‡Œäº‘å¸®åŠ©ä¸­å¿ƒ (aliyun.com)</a></p><h2 id="2-3-å®‰è£…Kibana"><a href="#2-3-å®‰è£…Kibana" class="headerlink" title="2.3 å®‰è£…Kibana"></a>2.3 å®‰è£…Kibana</h2><h3 id="1-æ‹‰å–é•œåƒ-1"><a href="#1-æ‹‰å–é•œåƒ-1" class="headerlink" title="1. æ‹‰å–é•œåƒ"></a>1. æ‹‰å–é•œåƒ</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> pull kibana:<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ-1"><a href="#2-åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ-1" class="headerlink" title="2. åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ"></a>2. åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mkdir</span> /etc/elk<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span>/kibana<br><span class="hljs-attribute">sudo</span> chown -R <span class="hljs-number">1000</span>:<span class="hljs-number">1000</span> /etc/elk<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span>/kibana<br></code></pre></td></tr></table></figure><h3 id="3-ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬-1"><a href="#3-ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬-1" class="headerlink" title="3. ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬"></a>3. ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬</h3><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livescript">docker run -<span class="hljs-literal">it</span> <span class="hljs-string">\</span><br>-d <span class="hljs-string">\</span><br>--restart=always <span class="hljs-string">\</span><br>--log-driver json-file <span class="hljs-string">\</span><br>--log-opt max-size=<span class="hljs-number">100m</span> <span class="hljs-string">\</span><br>--log-opt max-file=<span class="hljs-number">2</span> <span class="hljs-string">\</span><br>--name kibana <span class="hljs-string">\</span><br>-p <span class="hljs-number">5601</span>:<span class="hljs-number">5601</span> <span class="hljs-string">\</span><br>--net elastic <span class="hljs-string">\</span><br>kibana:<span class="hljs-number">8.4</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="4-å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š-1"><a href="#4-å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š-1" class="headerlink" title="4. å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š"></a>4. å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">docker cp kibana:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/kibana/</span>config <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/kibana/</span>        <br>docker cp kibana:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/kibana/</span>data <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/kibana/</span>        <br>docker cp kibana:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/kibana/</span>plugins <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/kibana/</span> <br>docker cp kibana:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/kibana/</span>logs <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/kibana/</span>  <br></code></pre></td></tr></table></figure><h3 id="5-ä¿®æ”¹é…ç½®æ–‡ä»¶-1"><a href="#5-ä¿®æ”¹é…ç½®æ–‡ä»¶-1" class="headerlink" title="5. ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>5. ä¿®æ”¹é…ç½®æ–‡ä»¶</h3><p> <code>/etc/elk8.4.3/kibana/config/kibana.yml</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">server</span>.host: <span class="hljs-string">&quot;0.0.0.0&quot;</span><br><span class="hljs-attribute">server</span>.shutdownTimeout: <span class="hljs-string">&quot;5s&quot;</span><br><span class="hljs-attribute">elasticsearch</span>.hosts:<span class="hljs-meta"> [ &quot;http://192.168.3.17:9200&quot; ]</span><br><span class="hljs-attribute">elasticsearch</span>.username: <span class="hljs-string">&quot;kibana_system&quot;</span><br><span class="hljs-attribute">elasticsearch</span>.password: <span class="hljs-string">&quot;sith-mes&quot;</span><br><span class="hljs-attribute">monitoring</span>.ui.container.elasticsearch.enabled: true<br><span class="hljs-attribute">i18n</span>.locale: <span class="hljs-string">&quot;en&quot;</span><br><span class="hljs-attribute">xpack</span>.encryptedSavedObjects.encryptionKey: dcbf<span class="hljs-number">819</span>d<span class="hljs-number">8874</span>e<span class="hljs-number">8242</span>eaf<span class="hljs-number">107</span>d<span class="hljs-number">538</span>fe<span class="hljs-number">874</span><br><span class="hljs-attribute">xpack</span>.reporting.encryptionKey: ba<span class="hljs-number">2</span>d<span class="hljs-number">98</span>e<span class="hljs-number">6</span>dad<span class="hljs-number">4</span>fa<span class="hljs-number">73</span>d<span class="hljs-number">77</span>f<span class="hljs-number">5</span>f<span class="hljs-number">34</span>a<span class="hljs-number">568</span>cfdd<br><span class="hljs-attribute">xpack</span>.security.encryptionKey: <span class="hljs-number">3871</span>dfc<span class="hljs-number">1</span>bd<span class="hljs-number">945</span>e<span class="hljs-number">1141364</span>e<span class="hljs-number">4244800</span>b<span class="hljs-number">39</span><br></code></pre></td></tr></table></figure><p>âš ï¸<strong>è¿™é‡Œçš„ç”¨æˆ·æ˜¯ kibana_system</strong></p><h3 id="6-åˆ é™¤å®¹å™¨-1"><a href="#6-åˆ é™¤å®¹å™¨-1" class="headerlink" title="6. åˆ é™¤å®¹å™¨"></a>6. åˆ é™¤å®¹å™¨</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">docker rm <span class="hljs-string">/kibana</span><br></code></pre></td></tr></table></figure><h3 id="7-ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•-1"><a href="#7-ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•-1" class="headerlink" title="7. ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•"></a>7. ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs gradle">docker run -it \<br>  -d \<br>  --restart=always \<br>  --log-driver json-<span class="hljs-keyword">file</span> \<br>  --log-opt max-<span class="hljs-keyword">size</span>=<span class="hljs-number">100</span>m \<br>  --log-opt max-<span class="hljs-keyword">file</span>=<span class="hljs-number">2</span> \<br>  --name kibana \<br>  -p <span class="hljs-number">5601</span>:<span class="hljs-number">5601</span> \<br>  --net elastic \<br>  -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/kibana/</span>config:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/kibana/</span>config \<br>  -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/kibana/</span>data:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/kibana/</span>data \<br>  -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/kibana/</span>plugins:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/kibana/</span>plugins \<br>  -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/kibana/</span>logs:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/kibana/</span>logs \<br>  kibana:<span class="hljs-number">8.4</span>.<span class="hljs-number">3</span><br><br></code></pre></td></tr></table></figure><h3 id="8-é…ç½®ç´¢å¼•ç”Ÿå‘½å‘¨æœŸ"><a href="#8-é…ç½®ç´¢å¼•ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="8. é…ç½®ç´¢å¼•ç”Ÿå‘½å‘¨æœŸ"></a>8. é…ç½®ç´¢å¼•ç”Ÿå‘½å‘¨æœŸ</h3><ol><li><p>é…ç½®ç­–ç•¥ Index Lifecycle Policies</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/img_v3_02ao_623ea326-f24e-4ebb-9b9c-d41cc894e9ag.jpg" alt="img_v3_02ao_623ea326-f24e-4ebb-9b9c-d41cc894e9ag"></p></li><li><p>åˆ›å»ºç´¢å¼•æ¨¡æ¿</p></li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;template&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;settings&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;index&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;lifecycle&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;è‡ªå®šä¹‰çš„policy&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;routing&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;allocation&quot;</span>: &#123;<br>            <span class="hljs-attr">&quot;include&quot;</span>: &#123;<br>              <span class="hljs-attr">&quot;_tier_preference&quot;</span>: <span class="hljs-string">&quot;data_content&quot;</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-attr">&quot;number_of_shards&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>,<br>        <span class="hljs-attr">&quot;number_of_replicas&quot;</span>: <span class="hljs-string">&quot;0&quot;</span><br>      &#125;<br>    &#125;,<br>    <span class="hljs-attr">&quot;aliases&quot;</span>: &#123;&#125;,<br>    <span class="hljs-attr">&quot;mappings&quot;</span>: &#123;&#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li><p>ç»™ç´¢å¼•ç­–ç•¥ä¸ŠåŠ ç´¢å¼•æ¨¡æ¿</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/img_v3_02ao_a2e5305a-307f-4d19-a05a-17abb32f599g.jpg" alt="img_v3_02ao_a2e5305a-307f-4d19-a05a-17abb32f599g"></p></li></ol><h2 id="2-4-å®‰è£…logstash"><a href="#2-4-å®‰è£…logstash" class="headerlink" title="2.4 å®‰è£…logstash"></a>2.4 å®‰è£…logstash</h2><h3 id="1-æ‹‰å–é•œåƒ-2"><a href="#1-æ‹‰å–é•œåƒ-2" class="headerlink" title="1. æ‹‰å–é•œåƒ"></a>1. æ‹‰å–é•œåƒ</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> pull logstash:<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ-2"><a href="#2-åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ-2" class="headerlink" title="2. åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ"></a>2. åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mkdir</span> /etc/elk<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span>/logstash<br><span class="hljs-attribute">sudo</span> chown -R <span class="hljs-number">1000</span>:<span class="hljs-number">1000</span> /etc/elk<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span>/logstash<br></code></pre></td></tr></table></figure><h3 id="3-ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬-2"><a href="#3-ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬-2" class="headerlink" title="3. ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬"></a>3. ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬</h3><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs livescript">docker run -<span class="hljs-literal">it</span> <span class="hljs-string">\</span><br>-d <span class="hljs-string">\</span><br>--name logstash <span class="hljs-string">\</span><br>-p <span class="hljs-number">9600</span>:<span class="hljs-number">9600</span> <span class="hljs-string">\</span><br>-p <span class="hljs-number">5044</span>:<span class="hljs-number">5044</span> <span class="hljs-string">\</span><br>--net elastic <span class="hljs-string">\</span><br>logstash:<span class="hljs-number">8.4</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="4-å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š-2"><a href="#4-å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š-2" class="headerlink" title="4. å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š"></a>4. å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">docker cp logstash:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/logstash/</span>config <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/logstash/</span> <br>docker cp logstash:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/logstash/</span>pipeline <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/logstash/</span> <br>sudo cp <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/elasticsearch/</span>config<span class="hljs-regexp">/certs /</span>etc<span class="hljs-regexp">/elk8.4.3/</span>logstash<span class="hljs-regexp">/config/</span>certs<br></code></pre></td></tr></table></figure><h3 id="5-ä¿®æ”¹é…ç½®æ–‡ä»¶-2"><a href="#5-ä¿®æ”¹é…ç½®æ–‡ä»¶-2" class="headerlink" title="5. ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>5. ä¿®æ”¹é…ç½®æ–‡ä»¶</h3><ul><li><code>/etc/elk8.4.3/logstash/config/logstash.yml</code></li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">http<span class="hljs-selector-class">.host</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span><br>xpack<span class="hljs-selector-class">.monitoring</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.hosts</span>: <span class="hljs-selector-attr">[ <span class="hljs-string">&quot;http://192.168.3.17:9200&quot;</span> ]</span><br>xpack<span class="hljs-selector-class">.monitoring</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.username</span>: elastic<br>xpack<span class="hljs-selector-class">.monitoring</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.password</span>: sith-mes<br></code></pre></td></tr></table></figure><ul><li><code>/etc/elk8.4.3/logstash/pipeline/logstash.conf</code></li></ul><figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs puppet"><span class="hljs-keyword">input</span> &#123;<br>  beats &#123;<br>    <span class="hljs-attr">port</span> =&gt; <span class="hljs-number">5044</span><br>  &#125;<br>&#125;<br> <br><span class="hljs-keyword">filter</span> &#123;<br>      grok &#123;  <br>      <span class="hljs-attr">match</span> =&gt; &#123;<span class="hljs-string">&quot;message&quot;</span> =&gt; <span class="hljs-string">&quot;\[%&#123;TIMESTAMP_ISO8601:time&#125;\] \[%&#123;LOGLEVEL:level&#125;\] \[%&#123;NOTSPACE:threadName&#125;\] \[%&#123;DATA:logger&#125;\] \[%&#123;DATA:hostname&#125;\] \[%&#123;DATA:ip&#125;\] \[%&#123;DATA:loginName&#125;\] \[%&#123;DATA:applicationName&#125;\] \[%&#123;DATA:executor&#125;\] %&#123;GREEDYDATA:restInfo&#125;&quot;</span>&#125;<br>    &#125;<br><br>  <span class="hljs-keyword">date</span> &#123;<br>    <span class="hljs-attr">match</span> =&gt; [ <span class="hljs-string">&quot;@timestamp&quot;</span>, <span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss Z&quot;</span> ]<br>  &#125;<br>  <span class="hljs-keyword">mutate</span> &#123;<br>    <span class="hljs-attr">remove_field</span> =&gt; [<span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-string">&quot;host&quot;</span>, <span class="hljs-string">&quot;[event][original]&quot;</span>]<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">output</span> &#123;<br>  elasticsearch &#123;<br>    <span class="hljs-attr">hosts</span> =&gt; [<span class="hljs-string">&quot;http://192.168.3.17:9200&quot;</span>]<br>    <span class="hljs-attr">index</span> =&gt; <span class="hljs-string">&quot;log-%&#123;+YYYY.MM.dd&#125;&quot;</span><br>    <span class="hljs-comment"># ssl =&gt; true</span><br>    <span class="hljs-comment"># ssl_certificate_verification =&gt; false</span><br>    <span class="hljs-comment"># cacert =&gt; &quot;/usr/share/logstash/config/certs/http_ca.crt&quot;</span><br>    <span class="hljs-comment"># ca_trusted_fingerprint =&gt; &quot;ç¬¬ä¸€æ¬¡å¯åŠ¨elasticsearchæ˜¯ä¿å­˜çš„ä¿¡æ¯ä¸­æŸ¥æ‰¾&quot;</span><br>    <span class="hljs-attr">user</span> =&gt; <span class="hljs-string">&quot;elastic&quot;</span><br>    <span class="hljs-attr">password</span> =&gt; <span class="hljs-string">&quot;sith-mes&quot;</span><br>  &#125;<br></code></pre></td></tr></table></figure><h3 id="6-åˆ é™¤å®¹å™¨-2"><a href="#6-åˆ é™¤å®¹å™¨-2" class="headerlink" title="6. åˆ é™¤å®¹å™¨"></a>6. åˆ é™¤å®¹å™¨</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">docker rm <span class="hljs-string">/logstash</span><br></code></pre></td></tr></table></figure><h3 id="7-ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•-2"><a href="#7-ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•-2" class="headerlink" title="7. ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•"></a>7. ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">docker run -it \<br>  -d \<br>  --name logstash \<br>  -p <span class="hljs-number">9600</span>:<span class="hljs-number">9600</span> \<br>  -p <span class="hljs-number">5044</span>:<span class="hljs-number">5044</span> \<br>  --net elastic \<br>  -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/logstash/</span>config:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/logstash/</span>config \<br>  -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/logstash/</span>pipeline:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/logstash/</span>pipeline \<br>  logstash:<span class="hljs-number">8.4</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h2 id="2-5-å®‰è£…filebeat"><a href="#2-5-å®‰è£…filebeat" class="headerlink" title="2.5 å®‰è£…filebeat"></a>2.5 å®‰è£…filebeat</h2><h3 id="1-æ‹‰å–é•œåƒ-3"><a href="#1-æ‹‰å–é•œåƒ-3" class="headerlink" title="1. æ‹‰å–é•œåƒ"></a>1. æ‹‰å–é•œåƒ</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> pull elastic/filebeat:<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ-3"><a href="#2-åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ-3" class="headerlink" title="2. åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ"></a>2. åˆ›å»ºæŒ‚è½½ç›®å½•å¹¶æˆæƒ</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mkdir</span> /etc/elk<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span>/filebeat<br><span class="hljs-attribute">sudo</span> chown -R <span class="hljs-number">1000</span>:<span class="hljs-number">1000</span> /etc/elk<span class="hljs-number">8</span>.<span class="hljs-number">4</span>.<span class="hljs-number">3</span>/filebeat<br></code></pre></td></tr></table></figure><h3 id="3-ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬-3"><a href="#3-ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬-3" class="headerlink" title="3. ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬"></a>3. ç¬¬ä¸€æ¬¡æ‰§è¡Œdockerå¯åŠ¨è„šæœ¬</h3><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs livescript">docker run -<span class="hljs-literal">it</span> <span class="hljs-string">\</span><br>-d <span class="hljs-string">\</span><br>--name filebeat <span class="hljs-string">\</span><br>--network host <span class="hljs-string">\</span><br>-e TZ=Asia/Shanghai <span class="hljs-string">\</span><br>elastic/filebeat:<span class="hljs-number">8.4</span>.<span class="hljs-number">3</span> <span class="hljs-string">\</span><br>filebeat -e  -c /usr/share/filebeat/filebeat.yml<br></code></pre></td></tr></table></figure><h3 id="4-å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š-3"><a href="#4-å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š-3" class="headerlink" title="4. å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š"></a>4. å°†å®¹å™¨å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">docker cp filebeat:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/filebeat/</span>filebeat.yml <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/filebeat/</span> <br>docker cp filebeat:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/filebeat/</span>data <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/filebeat/</span> <br>docker cp filebeat:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/filebeat/</span>logs <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/filebeat/</span> <br></code></pre></td></tr></table></figure><h3 id="5-ä¿®æ”¹é…ç½®æ–‡ä»¶-3"><a href="#5-ä¿®æ”¹é…ç½®æ–‡ä»¶-3" class="headerlink" title="5. ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>5. ä¿®æ”¹é…ç½®æ–‡ä»¶</h3><ul><li><code>/etc/elk8.4.3/filebeat/filebeat.yml</code></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">filebeat.config:</span><br>  <span class="hljs-attr">modules:</span><br>    <span class="hljs-attr">path:</span> <span class="hljs-string">$&#123;path.config&#125;/modules.d/*.yml</span><br>    <span class="hljs-attr">reload.enabled:</span> <span class="hljs-literal">false</span><br><br><span class="hljs-attr">processors:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">add_cloud_metadata:</span> <span class="hljs-string">~</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">add_docker_metadata:</span> <span class="hljs-string">~</span><br><br><span class="hljs-attr">output.logstash:</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-comment"># The Logstash hosts</span><br>  <span class="hljs-attr">hosts:</span> [<span class="hljs-string">&quot;192.168.3.17:5044&quot;</span>]<br> <br><span class="hljs-attr">filebeat.inputs:</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">log</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">paths:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">/usr/share/filebeat/target/*/info.log</span>  <span class="hljs-comment"># è¿™ä¸ªè·¯å¾„æ˜¯éœ€è¦æ”¶é›†çš„æ—¥å¿—è·¯å¾„ï¼Œæ˜¯dockerå®¹å™¨ä¸­çš„è·¯å¾„</span><br>  <span class="hljs-attr">scan_frequency:</span> <span class="hljs-string">10s</span><br>  <span class="hljs-attr">exclude_lines:</span> [<span class="hljs-string">&#x27;HEAD&#x27;</span>]<br>  <span class="hljs-attr">exclude_lines:</span> [<span class="hljs-string">&#x27;HTTP/1.1&#x27;</span>]<br>  <span class="hljs-attr">multiline.pattern:</span> <span class="hljs-string">&#x27;^[[:space:]]+(at|\.&#123;3&#125;)\b|Exception|æ•è·å¼‚å¸¸&#x27;</span><br>  <span class="hljs-attr">multiline.negate:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">multiline.match:</span> <span class="hljs-string">after</span><br></code></pre></td></tr></table></figure><h3 id="6-åˆ é™¤å®¹å™¨-3"><a href="#6-åˆ é™¤å®¹å™¨-3" class="headerlink" title="6. åˆ é™¤å®¹å™¨"></a>6. åˆ é™¤å®¹å™¨</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">docker rm <span class="hljs-string">/filebeat</span><br></code></pre></td></tr></table></figure><h3 id="7-ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•-3"><a href="#7-ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•-3" class="headerlink" title="7. ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•"></a>7. ä¿®æ”¹dockerå¯åŠ¨è„šæœ¬ï¼Œå¢åŠ -væŒ‚è½½ç›®å½•</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk">docker run -it \<br>  -d \<br>  --name filebeat \<br>  --network host \<br>  -e TZ=Asia/Shanghai \<br>  -v <span class="hljs-regexp">/home/</span>sith<span class="hljs-regexp">/deploy/</span>backend<span class="hljs-regexp">/logs:/u</span>sr<span class="hljs-regexp">/share/</span>filebeat/target \<br>  -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/filebeat/</span>filebeat.yml:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/filebeat/</span>filebeat.yml \<br>  -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/filebeat/</span>data:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/filebeat/</span>data \<br>  -v <span class="hljs-regexp">/etc/</span>elk8.<span class="hljs-number">4.3</span><span class="hljs-regexp">/filebeat/</span>logs:<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/filebeat/</span>logs \<br>  elastic/filebeat:<span class="hljs-number">8.4</span>.<span class="hljs-number">3</span> \<br>  filebeat -e  -c <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/filebeat/</span>filebeat.yml<br></code></pre></td></tr></table></figure><p>âš ï¸ï¼š ESæ˜ å°„çš„dataå’Œlogæ¯”è¾ƒå¤§ï¼Œå»ºè®®æ”¾åœ¨ç£ç›˜ç©ºé—´æ¯”è¾ƒè¶³çš„ç›®å½•ã€‚</p><p>é™„ï¼šdocker-compose.ymlæ–‡ä»¶</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">networks:</span><br>  <span class="hljs-attr">tms:</span><br>    <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">elasticsearch:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">elasticsearch:8.4.3</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">elasticsearch</span><br>    <span class="hljs-attr">user:</span> <span class="hljs-string">&quot;root&quot;</span>  <span class="hljs-comment"># è®¾ç½®å®¹å™¨å†…ç”¨æˆ·ä¸º root</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">discovery.type=single-node</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">ELASTIC_PASSWORD=plm1234567890</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">9200</span><span class="hljs-string">:9200</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">9300</span><span class="hljs-string">:9300</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./elasticsearch/config:/usr/share/elasticsearch/config</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./elasticsearch/data:/usr/share/elasticsearch/data</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./elasticsearch/plugins:/usr/share/elasticsearch/plugins</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./elasticsearch/logs:/usr/share/elasticsearch/logs</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br><br>  <span class="hljs-attr">logstash:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">logstash:8.4.3</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">logstash</span><br>    <span class="hljs-attr">user:</span> <span class="hljs-string">&quot;root&quot;</span>  <span class="hljs-comment"># è®¾ç½®å®¹å™¨å†…ç”¨æˆ·ä¸º root</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;5044:5044&quot;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./logstash/config:/usr/share/logstash/config</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./logstash/pipeline:/usr/share/logstash/pipeline</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br><br>  <span class="hljs-attr">kibana:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">kibana:8.4.3</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">kibana</span><br>    <span class="hljs-attr">user:</span> <span class="hljs-string">&quot;root&quot;</span>  <span class="hljs-comment"># è®¾ç½®å®¹å™¨å†…ç”¨æˆ·ä¸º root</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">5601</span><span class="hljs-string">:5601</span><br>    <span class="hljs-attr">depends_on:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">elasticsearch</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./kibana/config:/usr/share/kibana/config</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./kibana/data:/usr/share/kibana/data</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./kibana/plugins:/usr/share/kibana/plugins</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./kibana/logs:/usr/share/kibana/logs</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br><br>  <span class="hljs-attr">filebeat:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">elastic/filebeat:8.4.3</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">filebeat</span><br>    <span class="hljs-attr">user:</span> <span class="hljs-string">&quot;root&quot;</span>  <span class="hljs-comment"># è®¾ç½®å®¹å™¨å†…ç”¨æˆ·ä¸º root</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/Z004NNRE/tms/deploy/backend/assistant-service/logs:/usr/share/filebeat/target/assistant-service</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/Z004NNRE/tms/deploy/backend/auth-service/logs:/usr/share/filebeat/target/auth-service</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/Z004NNRE/tms/deploy/backend/user-service/logs:/usr/share/filebeat/target/user-service</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/Z004NNRE/tms/deploy/backend/tms-service/logs:/usr/share/filebeat/target/tms-service</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/Z004NNRE/tms/deploy/backend/gateway-server/logs:/usr/share/filebeat/target/gateway-server</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/Z004NNRE/tms/deploy/backend/eureka-server/logs:/usr/share/filebeat/target/eureka-server</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./filebeat/filebeat.yml:/usr/share/filebeat/filebeat.yml</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./filebeat/data:/usr/share/filebeat/data</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./filebeat/logs:/usr/share/filebeat/logs</span><br>    <span class="hljs-attr">depends_on:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">logstash</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tms</span><br><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šDockerä¸­å‡ºç°bash: vim: command not foundè§£å†³æ–¹æ¡ˆ</strong></p><p>è§£å†³è¿™ä¸ªé—®é¢˜å…¶å®éå¸¸ç®€å•ï¼šåªéœ€è¦åœ¨ä½ çš„Dockerå®¹å™¨å†…å®‰è£…vimå³å¯ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>é¦–å…ˆæ‰“å¼€ä½ æ­£åœ¨è¿è¡Œçš„dockerå®¹å™¨ï¼š<br><code>docker exec -it [container_id] /bin/bash</code></p></li><li><p>è¿›å…¥åˆ°äº†dockerç¯å¢ƒå, æˆ‘ä»¬å¯ä»¥é€šè¿‡apt-getï¼ˆå¦‚æœæ‚¨ä½¿ç”¨åŸºäºDebianæˆ–Ubuntuç­‰Linuxå‘è¡Œç‰ˆï¼‰æˆ–yumï¼ˆå¦‚æœæ‚¨ä½¿ç”¨åŸºäºCentOSç­‰Linuxå‘è¡Œç‰ˆï¼‰æ¥å®‰è£…Vimï¼š</p><ul><li><code>apt-get update &amp;&amp; apt-get install vim -y   </code>Debian&#x2F;Ubuntuç­‰ç³»ç»Ÿ </li><li>CentOS&#x2F;RHELç­‰ç³»ç»Ÿ<code>yum update &amp;&amp; yum install vim -y </code></li></ul></li><li><p>ä»¥ä¸Šæ­¥éª¤è™½ç„¶èƒ½å¤Ÿè§£å†³é—®é¢˜ï¼Œä½†æ¯æ¬¡åˆ›å»ºæ–°çš„Dockerå®¹å™¨æ—¶ï¼Œéƒ½éœ€è¦æ‰‹åŠ¨æ‰§è¡Œè¿™äº›æ­¥éª¤ï¼Œæ˜¾ç„¶ä¸æ˜¯ä¸€ä¸ªç†æƒ³çš„è§£å†³æ–¹æ¡ˆã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯åœ¨Dockerfileä¸­æ·»åŠ å®‰è£…vimç¼–è¾‘å™¨çš„å‘½ä»¤ã€‚è¿™æ ·ï¼Œåœ¨æ„å»ºdockeré•œåƒæ—¶å°±ä¼šè‡ªåŠ¨å®‰è£…vimã€‚</p><p>åœ¨ä½ çš„Dockerfileä¸­æ·»åŠ ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cobol">RUN apt-get update &amp;&amp; apt-get install vim -y  # Debian/Ubuntuç­‰ç³»ç»Ÿ<br> <br>RUN yum update &amp;&amp; yum install vim -y  # CentOS/RHELç­‰ç³»ç»Ÿ<br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>docker</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>springbootå¼•å…¥flyway</title>
    <link href="/springboot%E5%BC%95%E5%85%A5flyway/"/>
    <url>/springboot%E5%BC%95%E5%85%A5flyway/</url>
    
    <content type="html"><![CDATA[<h1 id="1-flyway-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-flyway-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. flyway æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. flyway æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>Flyway å°±æ˜¯ä¸€æ¬¾æ•°æ®åº“ç•Œçš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼Œå®ƒå¯ä»¥è®°å½•æ•°æ®åº“çš„å˜åŒ–è®°å½•</p><p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong></p><p>ç›®å‰é€šè¿‡äººå·¥å»ç»´æŠ¤ã€åŒæ­¥æ•°æ®åº“è„šæœ¬ï¼Œä½†ç»å¸¸ä¼šé‡åˆ°ç–å¿½è€Œé—æ¼çš„æƒ…å†µï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨å¼€å‘ç¯å¢ƒå¯¹æŸä¸ªè¡¨æ–°å¢äº†ä¸€ä¸ªå­—æ®µï¼Œè€Œéƒ¨ç½²åˆ°çº¿ä¸Šæ—¶å´å¿˜äº†æ‰§è¡Œè¯¥ SQL è„šæœ¬ï¼Œå¯¼è‡´å‡ºç° bugã€‚</p><p>æœ‰äº† Flywayï¼Œåœ¨Spring booté¡¹ç›®å¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œflywayå®šä¹‰çš„ SQL ï¼Œè€Œæ— éœ€äººä¸ºæ‰‹å·¥æ§åˆ¶ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒå› æ•°æ®åº“ä¸åŒæ­¥è€Œå¯¼è‡´çš„å„ç§ç¯å¢ƒé—®é¢˜ã€‚</p><h1 id="2-springbootå¼•å…¥flyway"><a href="#2-springbootå¼•å…¥flyway" class="headerlink" title="2. springbootå¼•å…¥flyway"></a>2. springbootå¼•å…¥flyway</h1><h2 id="1-å¼•å…¥ä¾èµ–"><a href="#1-å¼•å…¥ä¾èµ–" class="headerlink" title="1. å¼•å…¥ä¾èµ–"></a>1. å¼•å…¥ä¾èµ–</h2><p>pom.xmlå¢åŠ </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.flywaydb<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>flyway-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="2-æ”¯æŒmavenç¼–è¯‘sqlæ–‡ä»¶-æ ¹æ®æƒ…å†µï¼Œå¯ä»¥ä¸é…"><a href="#2-æ”¯æŒmavenç¼–è¯‘sqlæ–‡ä»¶-æ ¹æ®æƒ…å†µï¼Œå¯ä»¥ä¸é…" class="headerlink" title="2. æ”¯æŒmavenç¼–è¯‘sqlæ–‡ä»¶(æ ¹æ®æƒ…å†µï¼Œå¯ä»¥ä¸é…)"></a>2. æ”¯æŒmavenç¼–è¯‘sqlæ–‡ä»¶(æ ¹æ®æƒ…å†µï¼Œå¯ä»¥ä¸é…)</h2><p>pom.xmlå¢åŠ </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/resources<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>              <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.sql<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>          <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="2-æ·»åŠ é…ç½®"><a href="#2-æ·»åŠ é…ç½®" class="headerlink" title="2. æ·»åŠ é…ç½®"></a>2. æ·»åŠ é…ç½®</h2><p>application.ymlå¢åŠ </p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">flyway:</span><br>    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span> <span class="hljs-comment">## å¼€å¯flyway, sithMesDevä¸å¼€å¯ä¸ºfalse</span><br>    <span class="hljs-attr">baseline-on-migrate:</span> <span class="hljs-literal">true</span> <span class="hljs-comment">#å¯¹äºå·²ç»å­˜åœ¨çš„é¡¹ç›®ï¼Œæ•°æ®åº“ä¸­å­˜åœ¨æ•°æ®ï¼Œé€šè¿‡è®¾ç½®baselineå‘Šè¯‰flywayï¼Œè¿™ä¸ªbaselineåŠä¹‹å‰çš„sqlè„šæœ¬éƒ½ä¸è¦æ‰§è¡Œäº†</span><br>    <span class="hljs-attr">locations:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">classpath:db.migration</span> <span class="hljs-comment">#æŒ‡å®šé¡¹ç›®ä¸­éœ€è¦è¿ç§»çš„sqlæ–‡ä»¶åœ¨å“ªä¸ªä½ç½®ï¼Œåœ¨springbooté¡¹ç›®ä¸­classpathæŒ‡çš„æ˜¯resourceæ–‡ä»¶å¤¹</span><br>    <span class="hljs-attr">table:</span> <span class="hljs-string">flyway_schema_history_xxx</span> <span class="hljs-comment"># ç‰ˆæœ¬æ§åˆ¶æ—¥å¿—è¡¨ï¼Œé»˜è®¤flyway_schema_history,ä¸åŒç³»ç»Ÿå»ºè®®ä¿®æ”¹è¡¨åï¼Œå¦‚flyway_schema_history_admin</span><br></code></pre></td></tr></table></figure><h2 id="3-åˆ›å»ºè¿ç§»æ‰€éœ€è¦çš„è„šæœ¬"><a href="#3-åˆ›å»ºè¿ç§»æ‰€éœ€è¦çš„è„šæœ¬" class="headerlink" title="3. åˆ›å»ºè¿ç§»æ‰€éœ€è¦çš„è„šæœ¬"></a>3. åˆ›å»ºè¿ç§»æ‰€éœ€è¦çš„è„šæœ¬</h2><p>åœ¨é¡¹ç›®src&#x2F;main&#x2F;resourcesä¸‹æ–°å»ºæ–‡ä»¶å¤¹å±‚çº§db&#x2F;migrationï¼Œå°†éœ€è¦æ‰§è¡Œçš„sqlæ–‡ä»¶æ”¾è¿›å»</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231109154251326.png" alt="image-20231109154251326"></p><h2 id="4-æµ‹è¯•"><a href="#4-æµ‹è¯•" class="headerlink" title="4 æµ‹è¯•"></a>4 æµ‹è¯•</h2><p>é‡å¯é¡¹ç›®ï¼Œå¯ä»¥è§‚å¯Ÿæ§åˆ¶ä¼šå‡ºç°ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231109154142159.png" alt="image-20231109154142159"></p>]]></content>
    
    
    <categories>
      
      <category>Springboot</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æƒé™ç³»ç»Ÿè®¾è®¡</title>
    <link href="/%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/"/>
    <url>/%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<p><strong>æƒé™ç®¡ç†æ˜¯å…¬å¸æ•°æ®å®‰å…¨çš„é‡è¦ä¿è¯ï¼Œé’ˆå¯¹ä¸åŒçš„å²—ä½ï¼Œä¸åŒçš„çº§åˆ«çœ‹åˆ°çš„æ•°æ®æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ“ä½œæ•°æ®çš„é™åˆ¶ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚</strong></p><blockquote><p>å¦‚ä½•è®©å„ä¸ªå²—ä½çš„äººåœ¨ç³»ç»Ÿä¸Šå„å¸å…¶èŒï¼Œå°±æ˜¯æƒé™ç®¡ç†è¦è§£å†³çš„é—®é¢˜ã€‚</p></blockquote><h1 id="1-æƒé™è®¾è®¡"><a href="#1-æƒé™è®¾è®¡" class="headerlink" title="1. æƒé™è®¾è®¡"></a>1. æƒé™è®¾è®¡</h1><p>ä¸šåŠ¡åˆ†ç±»ä¸Šæ¥è®²æƒé™å¯ä»¥åˆ†ä¸ºæ•°æ®æŸ¥çœ‹æƒé™ï¼Œæ•°æ®ä¿®æ”¹æƒé™ç­‰ã€‚</p><p>å¯¹åº”åˆ°ç³»ç»Ÿè®¾è®¡ä¸­æœ‰é¡µé¢æƒé™ã€èœå•æƒé™ã€æŒ‰é’®æƒé™ç­‰ã€‚èœå•ä¹Ÿåˆ†ä¸€çº§èœå•ã€äºŒçº§èœå•ç”šè‡³ä¸‰çº§èœå•ï¼Œèœå•å¯¹åº”çš„é¡µé¢é‡Œåˆæœ‰å¾ˆå¤šæŒ‰é’®ã€‚</p><p>æˆ‘ä»¬åœ¨è®¾è®¡çš„æ—¶å€™æœ€å¥½æŠŠæƒé™è®¾è®¡æˆæ ‘å½¢ç»“æ„ï¼Œè¿™æ ·åœ¨ç”³è¯·æƒé™çš„æ—¶å€™å°±å¯ä»¥ä¸€ç›®äº†ç„¶çš„çœ‹åˆ°èœå•çš„ç»“æ„ï¼Œéœ€è¦å“ªäº›æƒé™å°±éå¸¸çš„æ˜äº†äº†ã€‚</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231005205506829.png" alt="image-20231005205506829" style="zoom:50%;" /><h1 id="2-æƒé™æ¨¡å‹çš„æ¼”è¿›"><a href="#2-æƒé™æ¨¡å‹çš„æ¼”è¿›" class="headerlink" title="2.æƒé™æ¨¡å‹çš„æ¼”è¿›"></a>2.æƒé™æ¨¡å‹çš„æ¼”è¿›</h1><p><code>RBAC</code>å…¨ç§°ä¸ºåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶æ¨¡å‹ï¼ˆ<code>Role-based access control</code>ï¼‰ï¼Œåœ¨è¯¥æ¨¡å‹ä¸­ï¼Œé€šè¿‡è®©æƒé™ä¸è§’è‰²å…³è”æ¥å®ç°æˆæƒï¼Œç»™ç”¨æˆ·åˆ†é…ä¸€ç³»åˆ—çš„è§’è‰²æ¥è®©æ³¨å†Œç”¨æˆ·å¾—åˆ°è¿™äº›è§’è‰²å¯¹åº”çš„æƒé™ã€‚</p><h3 id="1-RBAC0-x2F-åŸºæœ¬æ¨¡å‹"><a href="#1-RBAC0-x2F-åŸºæœ¬æ¨¡å‹" class="headerlink" title="1. RBAC0&#x2F;åŸºæœ¬æ¨¡å‹"></a>1. RBAC0&#x2F;åŸºæœ¬æ¨¡å‹</h3><p><code>RBAC0</code>æ˜¯æœ€åŸºæœ¬çš„æ¨¡å‹ï¼Œæœªåšç‰¹æ®Šè¦æ±‚å’Œæ‰©å±•ï¼Œåœ¨è¯¥æ¨¡å‹ä¸­ï¼Œä¸€ä¸ªç”¨æˆ·å¯ä»¥åŒæ—¶æ‹¥æœ‰å¤šä¸ªè§’è‰²ï¼Œæ¯ä¸ªè§’è‰²å¯ä»¥æ‹¥æœ‰å¤šä¸ªæƒé™ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231121113023361.png" alt="image-20231121113023361"></p><p><strong>è¡¨è®¾è®¡</strong>ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231121114418238.png" alt="image-20231121114418238"></p><h3 id="2-RBAC1-x2F-è§’è‰²ç»§æ‰¿çš„RBACæ¨¡å‹"><a href="#2-RBAC1-x2F-è§’è‰²ç»§æ‰¿çš„RBACæ¨¡å‹" class="headerlink" title="2. RBAC1&#x2F;è§’è‰²ç»§æ‰¿çš„RBACæ¨¡å‹"></a>2. RBAC1&#x2F;è§’è‰²ç»§æ‰¿çš„RBACæ¨¡å‹</h3><p>ç”±äºå…·æœ‰å…¬å¸çš„å²—ä½å…·æœ‰ä¸Šä¸‹çº§å…³ç³»ï¼Œä¸”ä¸Šçº§æ‹¥æœ‰ä¸‹çº§çš„æ‰€æœ‰æƒé™ï¼Œæ‰€ä»¥ä¸åŒçš„è§’è‰²ä¹‹é—´å­˜åœ¨ç€é‡å çš„æƒé™ï¼Œå¦‚ï¼š</p><ul><li><p>å‘˜å·¥ï¼šå‘˜å·¥çš„æƒé™</p></li><li><p>ä¸»ç®¡ï¼šå‘˜å·¥çš„æƒé™ã€ä¸»ç®¡çš„æƒé™</p></li><li><p>è€æ¿ï¼šå‘˜å·¥çš„æƒé™ã€ä¸»ç®¡çš„æƒé™ã€è€æ¿çš„æƒé™</p></li></ul><blockquote><p>å­˜åœ¨çš„å¼Šç«¯æ˜¯ï¼šæ¯å½“å¢åŠ ä¸€æ¡å‘˜å·¥çš„æƒé™ï¼Œéƒ½éœ€è¦åŒæ—¶ç»‘å®šç»™ã€å‘˜å·¥ã€‘ã€ã€ä¸»ç®¡ã€‘å’Œã€è€æ¿ã€‘ã€‚å€˜è‹¥å°†ã€è€æ¿ã€‘æ¼äº†ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°ã€å‘˜å·¥æœ‰æƒé™ï¼Œè€Œè€æ¿æ²¡æƒé™ã€‘çš„æƒ…å†µäº†ã€‚</p></blockquote><p><strong>è®¾è®¡æ€è·¯</strong>ï¼šä¸Šå±‚è§’è‰²é»˜è®¤æ‹¥æœ‰ä¸‹å±‚è§’è‰²çš„æ‰€æœ‰æƒé™ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231121113513733.png" alt="image-20231121113513733"></p><p>è¡¨è®¾è®¡ï¼šéœ€è¦åœ¨åˆšæ‰çš„åŸºç¡€ä¸Šå¢åŠ è§’è‰²ç»§æ‰¿è¡¨ï¼Œæ¥è®°å½•è§’è‰²ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªå­—æ®µè§’è‰²IDå’Œçˆ¶è§’è‰²ID</p><h3 id="3-RBAC2-x2F-å¸¦çº¦æŸçš„RBACæ¨¡å‹"><a href="#3-RBAC2-x2F-å¸¦çº¦æŸçš„RBACæ¨¡å‹" class="headerlink" title="3. RBAC2&#x2F;å¸¦çº¦æŸçš„RBACæ¨¡å‹"></a>3. RBAC2&#x2F;å¸¦çº¦æŸçš„RBACæ¨¡å‹</h3><p>å¸¦çº¦æŸçš„RBACæ¨¡å‹åˆç§°RBAC2æ¨¡å‹ã€‚<strong>åŸºäºRBAC0æ¨¡å‹çš„åŸºç¡€ä¸Šï¼Œè¿›è¡Œäº†è§’è‰²çš„è®¿é—®æ§åˆ¶ã€‚</strong>æ­¤æ¨¡å‹ä¸­å¸¸ç”¨ä»¥ä¸‹é™åˆ¶ï¼š</p><ul><li><p>äº’æ–¥è§’è‰²ï¼šåŒä¸€ä¸ªç”¨æˆ·åœ¨ä¸¤ä¸ªäº’æ–¥è§’è‰²ä¸­åªèƒ½é€‰æ‹©ä¸€ä¸ªã€‚</p></li><li><p>åŸºæ•°çº¦æŸï¼šä¸€ä¸ªç”¨æˆ·æ‹¥æœ‰çš„è§’è‰²æ˜¯æœ‰é™çš„ï¼Œä¸€ä¸ªè§’è‰²æ‹¥æœ‰çš„æƒé™ä¹Ÿæ˜¯æœ‰é™çš„ã€‚</p></li><li><p>å…ˆå†³æ¡ä»¶çº¦æŸï¼šç”¨æˆ·æƒ³è¦è·å¾—ä¸Šå±‚è§’è‰²ï¼Œé¦–å…ˆå¿…é¡»æ‹¥æœ‰ä¸‹å±‚è§’è‰²ã€‚</p></li><li><p>è¿è¡Œæ—¶äº’æ–¥ ï¼šå…è®¸ä¸€ä¸ªç”¨æˆ·å…·æœ‰ä¸¤ä¸ªè§’è‰²ï¼Œä¸€æ¬¡é‰´æƒåªèƒ½ä½¿ç”¨ä¸€ä¸ªè§’è‰²ã€‚</p></li></ul><h1 id="3-ç”¨æˆ·åˆ’åˆ†"><a href="#3-ç”¨æˆ·åˆ’åˆ†" class="headerlink" title="3. ç”¨æˆ·åˆ’åˆ†"></a>3. ç”¨æˆ·åˆ’åˆ†</h1><h2 id="1-ç”¨æˆ·ç»„ï¼ˆç»„ç»‡ï¼‰"><a href="#1-ç”¨æˆ·ç»„ï¼ˆç»„ç»‡ï¼‰" class="headerlink" title="1 ç”¨æˆ·ç»„ï¼ˆç»„ç»‡ï¼‰"></a>1 ç”¨æˆ·ç»„ï¼ˆç»„ç»‡ï¼‰</h2><p>å¦‚æœç”¨æˆ·æ•°é‡æ¯”è¾ƒåºå¤§ï¼Œå¯ä»¥åŠ å…¥ç”¨æˆ·ç»„æ¨¡å¼ã€‚éœ€è¦ç»™ç”¨æˆ·åˆ†ç»„ï¼Œæ¯ä¸ªç”¨æˆ·ç»„å†…æœ‰å¤šä¸ªç”¨æˆ·ï¼Œå¯ä»¥ç»™ç”¨æˆ·åŠ è§’è‰²å¤–ï¼Œä¹Ÿå¯ä»¥ç»™ç”¨æˆ·ç»„åŠ è§’è‰²ã€‚æœ€ç»ˆç”¨æˆ·æ‹¥æœ‰çš„æ‰€æœ‰æƒé™ &#x3D; ç”¨æˆ·ä¸ªäººæ‹¥æœ‰çš„æƒé™+è¯¥ç”¨æˆ·æ‰€åœ¨ç”¨æˆ·ç»„æ‹¥æœ‰çš„æƒé™ã€‚</p><p>ä¼˜åŠ¿ï¼š</p><ul><li><strong>å®ç°æƒé™åˆ†é…çš„è‡ªåŠ¨åŒ–ï¼š</strong> å’Œç»„ç»‡å…³ç³»æ‰“é€šä¹‹åï¼ŒæŒ‰ç…§ç»„ç»‡æ¥åˆ†é…è§’è‰²ï¼Œå¦‚æœæœ‰æ–°å…¥èŒçš„ç”¨æˆ·ï¼Œè¢«åˆ’åˆ†åœ¨æŸä¸ªç»„ç»‡ä¸‹é¢ä¹‹åï¼Œä¼šè‡ªåŠ¨è·å–è¯¥ç»„ç»‡ä¸‹æ‰€æœ‰çš„æƒé™ï¼Œæ— éœ€äººå·¥åˆ†é…ã€‚åˆæ¯”å¦‚æœ‰ç”¨æˆ·è°ƒå²—ï¼Œåªéœ€è¦æŠŠç»„ç»‡å…³ç³»è°ƒæ•´å°±å¯ä»¥äº†ï¼Œæƒé™ä¼šè·Ÿç€ç»„ç»‡å…³ç³»è‡ªåŠ¨è°ƒæ•´ã€‚</li><li><strong>æ§åˆ¶æ•°æ®æƒé™ï¼š</strong> æŠŠè§’è‰²å…³è”åˆ°ç»„ç»‡ï¼Œç»„ç»‡é‡Œçš„æˆå‘˜åªèƒ½çœ‹åˆ°æœ¬ç»„ç»‡ä¸‹çš„æ•°æ®ï¼Œæ¯”å¦‚å¸‚åœºæ¨å¹¿å’Œå¤§å®¢å®šåˆ¶ï¼Œå¸‚åœºæ¨å¹¿é’ˆå¯¹çš„æ˜¯é›¶æ•£çš„å®¢æˆ·ï¼Œå¤§å¯å®šåˆ¶é’ˆå¯¹çš„æ˜¯æœ‰ä¸€å®šä½“é‡çš„å®¢æˆ·ï¼Œç›¸äº’çš„æ•°æ®è™½ç„¶åœ¨ä¸€ä¸ªå¹³å°ï¼Œä½†æ˜¯åªèƒ½çœ‹è‡ªå·±ç»„ç»‡ä¸‹çš„æ•°æ®ã€‚</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231121143805877.png" alt="image-20231121143805877"></p><p>è¡¨è®¾è®¡ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231121145331930.png" alt="image-20231121145331930"></p><h1 id="4-å®æˆ˜æ¼”ç»ƒ"><a href="#4-å®æˆ˜æ¼”ç»ƒ" class="headerlink" title="4. å®æˆ˜æ¼”ç»ƒ"></a>4. å®æˆ˜æ¼”ç»ƒ</h1><p>ä¸šåŠ¡åˆ†ç±»ä¸Šæ¥è®²æƒé™å¯ä»¥åˆ†ä¸ºæ•°æ®æŸ¥çœ‹æƒé™ï¼Œæ•°æ®ä¿®æ”¹æƒé™ç­‰ã€‚</p><p>æˆ‘ä»¬ç›®å‰æ˜¯åŸºäº<code>RBAC0</code>ï¼Œ æœ€åŸºæœ¬çš„æ¨¡å‹ï¼Œæœªåšç‰¹æ®Šè¦æ±‚å’Œæ‰©å±•ï¼Œåœ¨è¯¥æ¨¡å‹ä¸­ï¼Œä¸€ä¸ªç”¨æˆ·å¯ä»¥åŒæ—¶æ‹¥æœ‰å¤šä¸ªè§’è‰²ï¼Œæ¯ä¸ªè§’è‰²å¯ä»¥æ‹¥æœ‰å¤šä¸ªæƒé™ã€‚</p><h2 id="1-è¡¨è®¾è®¡ï¼š"><a href="#1-è¡¨è®¾è®¡ï¼š" class="headerlink" title="1. è¡¨è®¾è®¡ï¼š"></a>1. è¡¨è®¾è®¡ï¼š</h2><p><strong>åŸºç¡€è¡¨ï¼š</strong></p><ul><li><p>ç”¨æˆ· Userï¼šid, name</p></li><li><p>è§’è‰² Role:   id, name, code</p></li><li><p>æƒé™æ¨¡å— Acl_Moduleï¼šname, parent_id, level, code</p></li><li><p>æƒé™ACl : id, name, acl_module_id, parent_id, url, type(æŒ‰é’®ï¼Œè¯·æ±‚åœ°å€)</p></li></ul><p><strong>å…³ç³»è¡¨ï¼š</strong></p><ul><li>ç”¨æˆ·-è§’è‰²å…³ç³»è¡¨</li><li>è§’è‰²æƒé™å…³ç³»è¡¨</li></ul><h2 id="2-åç«¯é€»è¾‘"><a href="#2-åç«¯é€»è¾‘" class="headerlink" title="2. åç«¯é€»è¾‘"></a>2. åç«¯é€»è¾‘</h2><ol><li>æ–°å»ºæƒé™ç‚¹ï¼Œèœå•æˆ–è€…æŒ‰é’®ï¼ˆurlæ˜¯è¯·æ±‚åœ°å€ï¼‰</li><li>åˆ›å»ºè§’è‰²ï¼Œè®¾ç½®è§’è‰²åç§°ï¼Œ è§’è‰²è¯»å†™æƒé™ç­‰çº§ï¼ˆå¢&#x2F;åˆ &#x2F;æ”¹&#x2F;æŸ¥ï¼‰ä¸­çš„ç»„åˆã€‚ç»™è¿™ä¸ªæƒé™é…ç½®æ–°å»ºçš„æƒé™ç‚¹ä»¥åŠå¯¹åº”çš„äºº</li></ol><p>ï¼ˆå¢åˆ æ”¹æŸ¥ï¼Œåˆ†åˆ«å¯¹åº”2ï¼Œ3ï¼Œ5ï¼Œ7 è¿™æ ·çš„è¯ï¼Œæ•°æ®åº“åªéœ€è¦å­˜ä¸€ä½å»è®°å½•ï¼Œå½“ç„¶å­˜0101è¿™ç§ä¹Ÿè¡Œï¼‰</p><ol start="3"><li>åœ¨æƒé™æ‹¦æˆªå™¨å¢åŠ æ ¡éªŒ<ol><li>è·å–å½“å‰ç™»å½•ç”¨æˆ·å¯ä»¥è®¿é—®çš„æƒé™åˆ—è¡¨</li><li>å°†æƒé™åˆ—è¡¨å’Œå½“å‰è¯·æ±‚åšæ¯”è¾ƒï¼Œéœ€æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼Œå³å¯æ”¾è¡Œï¼Œå¦åˆ™æç¤ºæ²¡æœ‰æƒé™<ul><li>è¯·æ±‚URLåœ¨å½“å‰æƒé™URLåˆ—è¡¨é‡Œ</li></ul></li><li>å½“å‰è®¿é—®çš„methodä¹Ÿåœ¨æƒé™URLåˆ—è¡¨é‡Œï¼ˆè¿™é‡Œéœ€è¦åç«¯ä½¿ç”¨restfulè¯·æ±‚ï¼Œå³å¢åˆ æ”¹æŸ¥å¯¹åº” POSTï¼ŒDELETEï¼Œ PUTï¼ŒGETï¼Œ æˆ–è€…åç«¯å¸¦æ ‡è¯†è¿‡æ¥ï¼‰</li></ol></li></ol><h2 id="3-å‰ç«¯é€»è¾‘"><a href="#3-å‰ç«¯é€»è¾‘" class="headerlink" title="3. å‰ç«¯é€»è¾‘"></a>3. å‰ç«¯é€»è¾‘</h2><ol><li>å‰ç«¯åœ¨ç”¨æˆ·ç™»å½•åï¼Œå°±åœ¨localstoryé‡Œå­˜å‚¨äº†ï¼Œè°ƒç”¨å½“å‰userçš„æƒé™åˆ—è¡¨çš„ç»“æœï¼Œåªæœ‰ç”¨æˆ·é€€å‡ºç™»å½•åï¼Œæ‰ä¼šæ›´æ–°</li></ol><p>ç›®å‰æ²¡æœ‰è€ƒè™‘è§’è‰²ç»§æ‰¿å’Œäº’æ–¥ï¼Œæƒé™å§”æ‰˜</p><h1 id="5-é™¤äº†RBACè¿˜æœ‰å“ªäº›å®ç°æƒé™çš„æ–¹å¼ï¼Ÿ"><a href="#5-é™¤äº†RBACè¿˜æœ‰å“ªäº›å®ç°æƒé™çš„æ–¹å¼ï¼Ÿ" class="headerlink" title="5. é™¤äº†RBACè¿˜æœ‰å“ªäº›å®ç°æƒé™çš„æ–¹å¼ï¼Ÿ"></a>5. é™¤äº†RBACè¿˜æœ‰å“ªäº›å®ç°æƒé™çš„æ–¹å¼ï¼Ÿ</h1>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æŠ½è±¡å·¥å‚æ¨¡å¼</title>
    <link href="/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>åœ¨å·¥å‚çˆ¶ç±»å®šä¹‰ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè€Œå·¥å‚å­ç±»åˆ™è´Ÿè´£ç”Ÿæˆ<strong>ä¸€ç»„ç›¸å…³çš„å¯¹è±¡</strong>ã€‚è¿™äº›å¯¹è±¡ä¹‹é—´é€šå¸¸æœ‰æŸç§å…³è”æˆ–ä¾èµ–å…³ç³»ã€‚</p><p>æŠ½è±¡å·¥å‚æ¨¡å¼é€‚ç”¨äºéœ€è¦åˆ›å»ºå¤šä¸ªç›¸å…³å¯¹è±¡å¹¶ç¡®ä¿å®ƒä»¬ä¹‹é—´çš„ä¸€è‡´æ€§çš„æƒ…å†µã€‚</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><ul><li>å®¢æˆ·ç«¯ä¸ä¾èµ–æŸä¸ªäº§å“å®ä¾‹å…·ä½“å¦‚ä½•åˆ›å»º</li><li>å¼ºè°ƒä¸€ç³»åˆ—ç›¸å…³çš„äº§å“å¯¹è±¡ä¸€èµ·åˆ›å»ºä½¿ç”¨</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li><p>ç”¨æˆ·åªéœ€è¦å…³å¿ƒäº§å“æ‰€éœ€å·¥å‚ï¼Œæ— éœ€å…³å¿ƒåˆ›å»ºç»†èŠ‚</p></li><li><p>å°†ä¸€ä¸ªç³»åˆ—çš„äº§å“æ—ç»Ÿä¸€åˆ°ä¸€èµ·åˆ›å»ºï¼šæŠ½è±¡å·¥å‚æ¨¡å¼é€šè¿‡ä¸€ç»„ç›¸å…³çš„å·¥å‚ç±»æ¥åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ä¾èµ–çš„å¯¹è±¡ï¼Œç¡®ä¿äº†è¿™äº›å¯¹è±¡ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚è¿™æ„å‘³ç€åˆ›å»ºçš„å¯¹è±¡æ˜¯ç›¸äº’é…åˆã€ä¸€èµ·ä½¿ç”¨çš„ï¼Œèƒ½å¤Ÿæ»¡è¶³ç‰¹å®šçš„éœ€æ±‚æˆ–ç›®æ ‡ã€‚</p></li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>äº§å“æ—ä¸­æ‰©å±•æ–°çš„äº§å“å›°éš¾</li><li>å¢åŠ äº†ç³»ç»Ÿçš„æŠ½è±¡æ€§å’Œç†è§£éš¾åº¦</li></ul><blockquote><p>äº§å“æ—æ˜¯æŒ‡ä¸€ç»„ç›¸å…³è”æˆ–ä¾èµ–çš„äº§å“ï¼Œå®ƒä»¬åœ¨åŠŸèƒ½ã€ç‰¹æ€§æˆ–ç›®æ ‡ä¸Šå…·æœ‰ä¸€å®šçš„ç›¸ä¼¼æ€§æˆ–å…³è”æ€§ã€‚äº§å“æ—é€šå¸¸ç”±å¤šä¸ªå…·ä½“äº§å“ç»„æˆï¼Œæ¯ä¸ªå…·ä½“äº§å“å±äºåŒä¸€ä¸ªäº§å“æ—ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾æœ‰ä¸€ä¸ªæ±½è½¦åˆ¶é€ ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«äº†å¤šä¸ªäº§å“æ—ï¼šè½¿è½¦äº§å“æ—ã€SUVäº§å“æ—å’Œå¡è½¦äº§å“æ—ã€‚æ¯ä¸ªäº§å“æ—åŒ…å«äº†å„è‡ªçš„å…·ä½“äº§å“ï¼Œå¦‚è½¿è½¦äº§å“æ—å¯èƒ½åŒ…å«äº†è½¿è½¦çš„å…·ä½“å‹å·ï¼ˆå¦‚å°å‹è½¿è½¦ã€ä¸­å‹è½¿è½¦ã€è±ªåè½¿è½¦ç­‰ï¼‰ï¼ŒSUVäº§å“æ—å¯èƒ½åŒ…å«äº†SUVçš„å…·ä½“å‹å·ï¼ˆå¦‚ç´§å‡‘å‹SUVã€ä¸­å‹SUVã€å…¨å°ºå¯¸SUVç­‰ï¼‰</p></blockquote><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼š ä¸åŒçš„è¯¾ç¨‹ï¼Œé…ç½®çš„åšå®¢å’Œè§†é¢‘éƒ½æ˜¯ä¸ä¸€æ ·çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åšå®¢</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Article</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JavaArticle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Article</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ç¼–å†™Javaè¯¾ç¨‹åšå®¢&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PythonArticle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Article</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ç¼–å†™Pythonè¯¾ç¨‹åšå®¢&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è§†é¢‘</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Video</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JavaVideo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Video</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å½•åˆ¶Javaè¯¾ç¨‹è§†é¢‘&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PythonVideo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Video</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å½•åˆ¶Pythonè¯¾ç¨‹è§†é¢‘&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è¯¾ç¨‹å·¥å‚æ¥å£ï¼Œåˆ›å»ºä¸åŒè¯¾ç¨‹çš„è§†é¢‘å’Œåšå®¢</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CourseFactory</span> </span>&#123;<br>    <span class="hljs-function">Video <span class="hljs-title">getVideo</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function">Article <span class="hljs-title">getArticle</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JavaCourseFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CourseFactory</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Video <span class="hljs-title">getVideo</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JavaVideo();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Article <span class="hljs-title">getArticle</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JavaArticle();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PythonCourseFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CourseFactory</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Video <span class="hljs-title">getVideo</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> PythonVideo();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Article <span class="hljs-title">getArticle</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> PythonArticle();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        CourseFactory courseFactory = <span class="hljs-keyword">new</span> JavaCourseFactory();<br>        Video video = courseFactory.getVideo();<br>        Article article = courseFactory.getArticle();<br>        video.produce();<br>        article.produce();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>å½•åˆ¶Javaè¯¾ç¨‹è§†é¢‘<br>ç¼–å†™Javaè¯¾ç¨‹åšå®¢</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å·¥å‚æ¨¡å¼</title>
    <link href="/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>å·¥å‚æ¨¡å¼ï¼Œåˆç§°å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚åœ¨å·¥å‚çˆ¶ç±»å®šä¹‰ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè€Œå·¥å‚å­ç±»åˆ™è´Ÿè´£ç”Ÿæˆå…·ä½“çš„å¯¹è±¡ã€‚æ¯ä¸ªå…·ä½“å·¥å‚ç±»æ ¹æ®éœ€è¦åˆ›å»ºä¸åŒçš„å¯¹è±¡ï¼Œä»è€Œå®ç°äº†å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨çš„è§£è€¦ã€‚</p><p>ç±»å‹ï¼šåˆ›å»ºå‹</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><ul><li>åˆ›å»ºå¯¹è±¡éœ€è¦å¤§é‡é‡å¤ä»£ç </li><li>å®¢æˆ·ç«¯ä¸ä¾èµ–æŸä¸ªäº§å“å®ä¾‹å…·ä½“å¦‚ä½•åˆ›å»º</li><li>ä¸€ä¸ªç±»é€šè¿‡å­ç±»æ¥æŒ‡å®šåˆ›å»ºå“ªä¸ªå¯¹è±¡</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>ç”¨æˆ·åªéœ€è¦å…³å¿ƒäº§å“æ‰€éœ€å·¥å‚ï¼Œæ— éœ€å…³å¿ƒåˆ›å»ºç»†èŠ‚</li><li>ç¬¦åˆå¼€é—­åŸåˆ™</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ç±»çš„ä¸ªæ•°å®¹æ˜“å¤šï¼Œå¢åŠ å¤æ‚åº¦</li><li>å¢åŠ äº†ç³»ç»Ÿçš„æŠ½è±¡æ€§å’Œç†è§£éš¾åº¦</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼š éœ€è¦æ ¹æ®ç”µå½±ç±»å‹åˆ›å»ºç”µå½±</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æŠ½è±¡äº§å“ç±» ï¼Œå®šä¹‰å…·ä½“äº§å“çš„å…¬å…±æ¥å£</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Video</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span></span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JavaVideo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Video</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å½•åˆ¶Javaè¯¾ç¨‹è§†é¢‘&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PythonVideo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Video</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å½•åˆ¶Pythonè¯¾ç¨‹è§†é¢‘&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åˆ›å»ºæŠ½è±¡å·¥å‚ç±»ï¼Œå®šä¹‰å…·ä½“å·¥å‚çš„å…¬å…±æ¥å£</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VideoFactory</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Video <span class="hljs-title">getVideo</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JavaVideoFactory</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">VideoFactory</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Video <span class="hljs-title">getVideo</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JavaVideo();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PythonVideoFactory</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">VideoFactory</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Video <span class="hljs-title">getVideo</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> PythonVideo();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        VideoFactory pythonVideoFactory = <span class="hljs-keyword">new</span> PythonVideoFactory();<br>        VideoFactory javaVideoFactory = <span class="hljs-keyword">new</span> JavaVideoFactory();<br>        Video pythonVideo = pythonVideoFactory.getVideo();<br>        pythonVideo.produce();<br>        Video javaVideo = javaVideoFactory.getVideo();<br>        javaVideo.produce();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>å½•åˆ¶Pythonè¯¾ç¨‹è§†é¢‘<br>å½•åˆ¶Javaè¯¾ç¨‹è§†é¢‘</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ä»£ç†æ¨¡å¼</title>
    <link href="/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>ä¸ºå¯¹è±¡æä¾›ä»£ç†ï¼Œä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®</p><p>ä»£ç†å¯¹è±¡åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹ä½œç”¨</p><p><strong>åˆ†ç±»</strong>ï¼šé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><ul><li>ä¿æŠ¤ç›®æ ‡å¯¹è±¡</li><li>å¢å¼ºç›®æ ‡å¯¹è±¡</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>ä»£ç†æ¨¡å¼å¯ä»¥å°†ä»£ç†å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡æ¥è€¦ï¼Œæ‰©å±•æ€§å¥½</li><li>å¢å¼ºç›®æ ‡å¯¹è±¡</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>é€ æˆç±»æ•°ç›®å¢åŠ </li><li>åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡é—´å¢åŠ äº†ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œä¼šå¯¼è‡´è¯·æ±‚é€Ÿåº¦å˜æ…¢</li><li>å¢åŠ ç³»ç»Ÿå¤æ‚åº¦</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼šå‘é€é‚®ä»¶å‰è¿›è¡Œé¢å¤–çš„æ“ä½œ</p><ul><li>é™æ€ä»£ç†</li></ul><p> ç”±ç¨‹åºå‘˜åˆ›å»ºæˆ–ç‰¹å®šå·¥å…·è‡ªåŠ¨ç”Ÿæˆæºä»£ç ï¼Œå†å¯¹å…¶ç¼–è¯‘ã€‚åœ¨ç¨‹åºè¿è¡Œå‰ï¼Œä»£ç†ç±»çš„.classæ–‡ä»¶å°±å·²ç»å­˜åœ¨äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Email</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlashEmail</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Email</span> </span>&#123;<br> <br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-comment">// TODO Auto-generated method stub</span><br>            System.out.println(<span class="hljs-string">&quot;é‚®ä»¶å‘é€ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä»£ç†ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmailProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Email</span> </span>&#123;<br> <br>Email email;<br>  <br>  <span class="hljs-comment">//ä¼ å…¥å§”æ‰˜ç±»åˆå§‹åŒ–ä»£ç†ç±»</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">EmailProxy</span><span class="hljs-params">(Email email)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">this</span>.email=email;<br>&#125;<br>  <br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span><span class="hljs-params">()</span> </span>&#123;<br>            System.out.println(<span class="hljs-string">&quot;å‘é€é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚&quot;</span>);<br>            email.send();<br>            System.out.println(<span class="hljs-string">&quot;é‚®ä»¶å‘é€åã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br> <br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br><span class="hljs-comment">//åŸå§‹å¯¹è±¡</span><br>   Email email=<span class="hljs-keyword">new</span> FlashEmail();<br>   EmailProxy emailProxy=<span class="hljs-keyword">new</span> EmailProxy(email);<br>   emailProxy.send();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>å‘é€é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚<br>é‚®ä»¶å‘é€ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚<br>é‚®ä»¶å‘é€åã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><ul><li><p>åŠ¨æ€ä»£ç†</p><p>åŠ¨æ€ä»£ç†ç±»çš„å­—èŠ‚ç åœ¨ç¨‹åºè¿è¡Œæ—¶ç”±Javaåå°„æœºåˆ¶åŠ¨æ€ç”Ÿæˆï¼Œæ— éœ€ç¨‹åºå‘˜æ‰‹å·¥ç¼–å†™å®ƒçš„æºä»£ç ã€‚</p><p>java.lang.reflect åŒ…ä¸­çš„Proxyç±»å’ŒInvocationHandler æ¥å£æä¾›äº†ç”ŸæˆåŠ¨æ€ä»£ç†ç±»çš„èƒ½åŠ›ã€‚è¿™ä¸€ä¸ªç±»å’Œæ¥å£æ˜¯å®ç°æˆ‘ä»¬åŠ¨æ€ä»£ç†æ‰€å¿…é¡»ç”¨åˆ°çš„ã€‚</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmailDynamicProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">InvocationHandler</span> </span>&#123;<br> <br>Object target;<span class="hljs-comment">//å§”æ‰˜å¯¹è±¡</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">EmailDynamicProxy</span><span class="hljs-params">(Object obj)</span> </span>&#123;<br><span class="hljs-keyword">super</span>();<br><span class="hljs-keyword">this</span>.target = obj;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">bind</span><span class="hljs-params">()</span></span>&#123;<br>Class cls = target.getClass();<br><span class="hljs-keyword">return</span> Proxy.newProxyInstance(cls.getClassLoader(),cls.getInterfaces(),<span class="hljs-keyword">this</span>);<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>System.out.println(<span class="hljs-string">&quot;å‘é€é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚&quot;</span>);<br>    <span class="hljs-comment">//ä»å§”æ‰˜å¯¹è±¡ä¸­ï¼Œè°ƒç”¨è¯¥å¯¹è±¡çš„æŒ‡å®šæ–¹æ³•ï¼Œè¿™é‡Œç›¸å½“äºsendæ–¹æ³•</span><br>method.invoke(target);<br>System.out.println(<span class="hljs-string">&quot;å‘é€åã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);<br><span class="hljs-keyword">return</span> target;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Email email = <span class="hljs-keyword">new</span> FlashEmail();<br>        Email emailProxy = (Email) <span class="hljs-keyword">new</span> EmailDynamicProxy(email).bind();<br>        emailProxy.send();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>çŠ¶æ€æ¨¡å¼</title>
    <link href="/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>å½“ä¸€ä¸ªå¯¹è±¡å†…åœ¨çŠ¶æ€æ”¹å˜æ—¶å…è®¸æ”¹å˜å…¶è¡Œä¸ºã€‚æ¯”å¦‚ï¼šåœæ­¢çŠ¶æ€ä¸‹ï¼Œä¸å…è®¸å¿«è¿›è§†é¢‘è¿™ä¸ªè¡Œä¸º</p><p>ç±»å‹ï¼šè¡Œä¸ºå‹</p><p><strong>æ ¸å¿ƒè§’è‰²</strong></p><ol><li>ç¯å¢ƒç±»ï¼ˆContextï¼‰ï¼šç¯å¢ƒç±»æ˜¯æ‹¥æœ‰çŠ¶æ€çš„å¯¹è±¡ã€‚å®ƒç»´æŠ¤ä¸€ä¸ªæŒ‡å‘å½“å‰çŠ¶æ€å¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶å°†ä¸çŠ¶æ€ç›¸å…³çš„è¯·æ±‚å§”æ‰˜ç»™çŠ¶æ€å¯¹è±¡è¿›è¡Œå¤„ç†ã€‚</li><li>æŠ½è±¡çŠ¶æ€ç±»ï¼ˆStateï¼‰ï¼šæŠ½è±¡çŠ¶æ€ç±»å®šä¹‰äº†ä¸€ä¸ªæ¥å£ï¼Œç”¨äºå°è£…ä¸ç¯å¢ƒå¯¹è±¡ç›¸å…³çš„è¡Œä¸ºã€‚å®ƒå¯ä»¥æ ¹æ®å…·ä½“çš„çŠ¶æ€è¿›è¡Œå…·ä½“çš„è¡Œä¸ºå®ç°ã€‚</li><li>å…·ä½“çŠ¶æ€ç±»ï¼ˆConcrete Stateï¼‰ï¼šå…·ä½“çŠ¶æ€ç±»å®ç°äº†æŠ½è±¡çŠ¶æ€ç±»ä¸­å®šä¹‰çš„æ¥å£ï¼Œæä¾›äº†ä¸å…·ä½“çŠ¶æ€ç›¸å…³çš„è¡Œä¸ºå®ç°ã€‚</li></ol><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><p>ä¸€ä¸ªå¯¹è±¡å­˜åœ¨å¤šä¸ªçŠ¶æ€ï¼ˆä¸åŒçŠ¶æ€ä¸‹è¡Œä¸ºä¸åŒï¼‰ï¼Œä¸”çŠ¶æ€å¯ä»¥è½¬æ¢</p><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>å°†ä¸åŒçŠ¶æ€éš”ç¦»</li><li>å°†å„ç§çŠ¶æ€çš„è½¬æ¢é€»è¾‘ï¼Œåˆ†å¸ƒåˆ°stateçš„å­ç±»ä¸­ï¼Œå‡å°‘äº’ç›¸ä¾èµ–</li><li>å¢åŠ æ–°çš„çŠ¶æ€ç®€å•</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>çŠ¶æ€å¤šçš„åœºæ™¯ä¸‹ï¼Œå¯¼è‡´ç±»æ•°ç›®å¢åŠ ï¼Œç³»ç»Ÿå˜å¤æ‚</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼šç½‘ç«™çš„è¯¾ç¨‹è§†é¢‘æœ‰æš‚åœï¼Œå¿«è¿›ï¼Œåœæ­¢ï¼Œæ’­æ”¾çŠ¶æ€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¯¾ç¨‹çŠ¶æ€æŠ½è±¡ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CourseVideoState</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> CourseVideoContext courseVideoContext;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCourseVideoContext</span><span class="hljs-params">(CourseVideoContext courseVideoContext)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.courseVideoContext = courseVideoContext;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">play</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">speed</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pause</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stop</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ’­æ”¾çŠ¶æ€</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PlayState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CourseVideoState</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">play</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ­£å¸¸æ’­æ”¾è¯¾ç¨‹è§†é¢‘çŠ¶æ€&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">speed</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.SPEED_STATE);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pause</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.PAUSE_STATE);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stop</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.STOP_STATE);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å¿«è¿›çŠ¶æ€</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpeedState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CourseVideoState</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">play</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.PLAY_STATE);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">speed</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å¿«è¿›æ’­æ”¾è¯¾ç¨‹è§†é¢‘çŠ¶æ€&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pause</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.PAUSE_STATE);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stop</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.STOP_STATE);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æš‚åœçŠ¶æ€</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PauseState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CourseVideoState</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">play</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.PLAY_STATE);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">speed</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.SPEED_STATE);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pause</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æš‚åœæ’­æ”¾è¯¾ç¨‹è§†é¢‘çŠ¶æ€&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stop</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.STOP_STATE);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åœæ­¢çŠ¶æ€</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StopState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CourseVideoState</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">play</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.courseVideoContext.setCourseVideoState(CourseVideoContext.PLAY_STATE);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">speed</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ERROR åœæ­¢çŠ¶æ€ä¸èƒ½å¿«è¿›!!&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pause</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ERROR åœæ­¢çŠ¶æ€ä¸èƒ½æš‚åœ!!&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stop</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;åœæ­¢æ’­æ”¾è¯¾ç¨‹è§†é¢‘çŠ¶æ€&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è¯¾ç¨‹çŠ¶æ€ä¸Šä¸‹æ–‡</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CourseVideoContext</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> CourseVideoState courseVideoState;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> PlayState PLAY_STATE = <span class="hljs-keyword">new</span> PlayState();<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> StopState STOP_STATE = <span class="hljs-keyword">new</span> StopState();<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> PauseState PAUSE_STATE = <span class="hljs-keyword">new</span> PauseState();<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> SpeedState SPEED_STATE = <span class="hljs-keyword">new</span> SpeedState();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> CourseVideoState <span class="hljs-title">getCourseVideoState</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> courseVideoState;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCourseVideoState</span><span class="hljs-params">(CourseVideoState courseVideoState)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.courseVideoState = courseVideoState;<br>        <span class="hljs-keyword">this</span>.courseVideoState.setCourseVideoContext(<span class="hljs-keyword">this</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">play</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.courseVideoState.play();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">speed</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.courseVideoState.speed();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stop</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.courseVideoState.stop();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pause</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.courseVideoState.pause();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        CourseVideoContext courseVideoContext = <span class="hljs-keyword">new</span> CourseVideoContext();<br>        courseVideoContext.setCourseVideoState(<span class="hljs-keyword">new</span> PlayState());<br><br>        System.out.println(<span class="hljs-string">&quot;å½“å‰çŠ¶æ€:&quot;</span>+courseVideoContext.getCourseVideoState().getClass().getSimpleName());<br>        courseVideoContext.pause();<br><br>        System.out.println(<span class="hljs-string">&quot;å½“å‰çŠ¶æ€:&quot;</span>+courseVideoContext.getCourseVideoState().getClass().getSimpleName());<br><br>        courseVideoContext.speed();<br><br>        System.out.println(<span class="hljs-string">&quot;å½“å‰çŠ¶æ€:&quot;</span>+courseVideoContext.getCourseVideoState().getClass().getSimpleName());<br><br>        courseVideoContext.stop();<br><br>        System.out.println(<span class="hljs-string">&quot;å½“å‰çŠ¶æ€:&quot;</span>+courseVideoContext.getCourseVideoState().getClass().getSimpleName());<br>        <br>        courseVideoContext.speed();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>å½“å‰çŠ¶æ€:PlayState<br>å½“å‰çŠ¶æ€:PauseState<br>å½“å‰çŠ¶æ€:SpeedState<br>å½“å‰çŠ¶æ€:StopState<br>ERROR åœæ­¢çŠ¶æ€ä¸èƒ½å¿«è¿›!!</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è®¿é—®è€…æ¨¡å¼</title>
    <link href="/%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><ul><li><p>å®ƒå…è®¸åœ¨ä¸æ”¹å˜å·²æœ‰å¯¹è±¡ç»“æ„çš„æƒ…å†µä¸‹ï¼Œå®šä¹‰å¯¹è¿™äº›å¯¹è±¡çš„æ–°æ“ä½œã€‚</p></li><li><p>æœ‰ä¸¤ä¸ªæ ¸å¿ƒè§’è‰²ï¼š</p><ul><li>è®¿é—®è€…ï¼ˆVisitorï¼‰ï¼šå®šä¹‰äº†å¯ä»¥å¯¹å„ç§å¯¹è±¡ç»“æ„ä¸­å…ƒç´ è¿›è¡Œçš„æ“ä½œã€‚å®ƒæŠ½è±¡å‡ºäº†å¯ä»¥å¯¹ä¸åŒå¯¹è±¡æ‰§è¡Œçš„æ“ä½œï¼Œå¹¶é€šè¿‡ä¸åŒçš„å…·ä½“è®¿é—®è€…æ¥å®ç°å…·ä½“çš„æ“ä½œé€»è¾‘ã€‚</li><li>å…ƒç´ ï¼ˆElementï¼‰ï¼šå®šä¹‰äº†ä¸€ä¸ªæ¥å—è®¿é—®è€…çš„æ–¹æ³•ï¼Œä½¿å¾—è®¿é—®è€…å¯ä»¥è®¿é—®å®ƒçš„å†…éƒ¨çŠ¶æ€ã€‚å…ƒç´ å¯ä»¥æ˜¯å•ä¸ªå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡çš„é›†åˆã€‚</li></ul></li><li><p>ç±»å‹ : è¡Œä¸ºå‹</p></li></ul><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><ul><li>éœ€è¦å¯¹å¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ è¿›è¡Œå¤šç§ä¸ç›¸å…³æˆ–ä¸ä¸€è‡´çš„æ“ä½œï¼Œè€Œä¸å¸Œæœ›åœ¨å…ƒç´ ç±»ä¸­å¢åŠ è¿™äº›æ“ä½œçš„æƒ…å†µã€‚</li><li>éœ€è¦å¯¹ä¸åŒç±»å‹çš„å…ƒç´ æ‰§è¡Œä¸åŒçš„æ“ä½œï¼Œè€Œåˆä¸å¸Œæœ›ä½¿ç”¨æ¡ä»¶è¯­å¥æˆ–ç±»å‹åˆ¤æ–­æ¥å®ç°çš„æƒ…å†µã€‚</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>å¢åŠ æ–°çš„æ“ä½œå¾ˆå®¹æ˜“ , åªéœ€è¦å¢åŠ ä¸€ä¸ªæ–°çš„è®¿é—®è€…å³å¯</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li><p>å¢åŠ  æ–° æ•°æ®ç»“æ„æ¯”è¾ƒå›°éš¾</p></li><li><p>å…ƒç´ å˜æ›´æ¯”è¾ƒå›°éš¾ ; å¦‚ä¸ºè¢«è®¿é—®çš„å¯¹è±¡å¢åŠ  &#x2F; å‡å°‘ä¸€äº›å±æ€§ , ç›¸åº”çš„è®¿é—®è€…ä¹Ÿéœ€è¦è¿›è¡Œä¿®æ”¹</p></li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼šè¯¾ç¨‹åˆ†ä¸ºå…è´¹è¯¾ç¨‹å’ŒVIPè¯¾ç¨‹ , ç”¨æˆ·åˆ†ä¸º å…è´¹ç”¨æˆ· å’Œ VIPç”¨æˆ· ;ä¸åŒçš„ç”¨æˆ· , è®¿é—®ä¸åŒçš„è¯¾ç¨‹ , å„è‡ªæœ‰ä¸åŒçš„æ•ˆæœ ;</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Course</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å½“æœ‰è®¿é—®è€…è¦è®¿é—®è¯¾ç¨‹æ—¶ , å°†è®¿é—®è€…ä¼ å…¥è¯¥æ–¹æ³•</span><br><span class="hljs-comment">     * ç”¨äºåˆ¤å®šè®¿é—®è€…æ˜¯å¦æœ‰æƒé™è®¿é—®è¯¾ç¨‹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(IVisitor visitor)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FreeCourse</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Course</span> </span>&#123;<br>    <br>  <span class="hljs-comment">// å…è´¹è¯¾ç¨‹ï¼Œæ¥å—è®¿é—®è€…ï¼Œæ¥åˆ¤æ–­è®¿é—®è€…æ˜¯å¦æœ‰æƒé™è®¿é—®è¯¾ç¨‹</span><br>  <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(IVisitor visitor)</span> </span>&#123;<br>        visitor.visit(<span class="hljs-keyword">this</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VIPCourse</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Course</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> price;<br><br>    <span class="hljs-comment">// VIPè¯¾ç¨‹ï¼Œæ¥å—è®¿é—®è€…ï¼Œæ¥åˆ¤æ–­è®¿é—®è€…æ˜¯å¦æœ‰æƒé™è®¿é—®è¯¾ç¨‹</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(IVisitor visitor)</span> </span>&#123;<br>        visitor.visit(<span class="hljs-keyword">this</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è®¿é—®è€…æ¥å£, å°è£…å¤šä¸ªCourseçš„è®¿é—®æ–¹å¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IVisitor</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">visit</span><span class="hljs-params">(FreeCourse freeCourse)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">visit</span><span class="hljs-params">(VIPCourse VIPCourse)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VIPVisitor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IVisitor</span> </span>&#123;<br><br>    <span class="hljs-comment">//è®¿é—®å…è´¹è¯¾ç¨‹ï¼Œæ‰“å°æ‰€æœ‰å…è´¹è¯¾ç¨‹åç§°</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">visit</span><span class="hljs-params">(FreeCourse freeCourse)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯ VIP, å¯ä»¥è®¿é—®:å…è´¹è¯¾ç¨‹:&quot;</span>+freeCourse.getName());<br>    &#125;<br><br>    <span class="hljs-comment">//è®¿é—®VIPè¯¾ç¨‹ï¼Œæ‰“å°æ‰€æœ‰VIPè¯¾ç¨‹åç§°åŠä»·æ ¼</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">visit</span><span class="hljs-params">(VIPCourse VIPCourse)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯ VIP ,å¯ä»¥è®¿é—®VIPè¯¾ç¨‹:&quot;</span>+ VIPCourse.getName()+<span class="hljs-string">&quot; ä»·æ ¼:&quot;</span>+ VIPCourse.getPrice()+<span class="hljs-string">&quot;å…ƒ&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        List&lt;Course&gt; courseList = <span class="hljs-keyword">new</span> ArrayList&lt;Course&gt;();<br><br>        FreeCourse freeCourse = <span class="hljs-keyword">new</span> FreeCourse();<br>        freeCourse.setName(<span class="hljs-string">&quot;SpringMVCæ•°æ®ç»‘å®š&quot;</span>);<br><br>        VIPCourse VIPCourse = <span class="hljs-keyword">new</span> VIPCourse();<br>        VIPCourse.setName(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²&quot;</span>);<br>        VIPCourse.setPrice(<span class="hljs-number">299</span>);<br><br>        courseList.add(freeCourse);<br>        courseList.add(VIPCourse);<br><br>        <span class="hljs-keyword">for</span>(Course course : courseList)&#123;<br>            course.accept(<span class="hljs-keyword">new</span> VIPVisitor());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>æˆ‘æ˜¯ VIP, å¯ä»¥è®¿é—®:å…è´¹è¯¾ç¨‹:SpringMVCæ•°æ®ç»‘å®š<br>æˆ‘æ˜¯ VIP ,å¯ä»¥è®¿é—®VIPè¯¾ç¨‹:Javaè®¾è®¡æ¨¡å¼ç²¾è®² ä»·æ ¼:299å…ƒ</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è´£ä»»é“¾æ¨¡å¼</title>
    <link href="/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>è´£ä»»é“¾æ¨¡å¼ä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œé€šå¸¸æ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶è€…çš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒä¼šæŠŠç›¸åŒçš„è¯·æ±‚ä¼ ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><p>ç±»å‹ï¼šè¡Œä¸ºå‹</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><ul><li>ä¸€ä¸ªè¯·æ±‚éœ€è¦å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¿›è¡Œå¤„ç†</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>è´£ä»»é“¾å¯ä»¥åŠ¨æ€ç»„åˆ</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>è´£ä»»é“¾å¤ªé•¿æˆ–è€…å¤„ç†æ—¶é—´å¤ªé•¿ï¼Œå½±å“æ€§èƒ½</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼šå‘å¸ƒä¸€ç¯‡æ–‡ç« åï¼Œå†…å®¹å®¡æŸ¥è€…å®¡æŸ¥å†…å®¹ï¼Œå®¡æŸ¥é€šè¿‡äº†åï¼Œè§†é¢‘å®¡æŸ¥è€…å®¡æŸ¥è§†é¢‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Article</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> String content;<br>    <span class="hljs-keyword">private</span> String video;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Approver</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> Approver approver;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setNextApprover</span><span class="hljs-params">(Approver approver)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.approver = approver;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">check</span><span class="hljs-params">(Article article)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContentApprover</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Approver</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">check</span><span class="hljs-params">(Article article)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(StringUtils.isNotEmpty(article.getContent()))&#123;<br>            System.out.println(article.getName()+<span class="hljs-string">&quot;å†…å®¹åˆè§„,æ‰¹å‡†&quot;</span>);<br>            <span class="hljs-keyword">if</span>(approver != <span class="hljs-keyword">null</span>)&#123;<br>                approver.check(article);<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            System.out.println(article.getName()+<span class="hljs-string">&quot;å†…å®¹ä¸åˆè§„,ä¸æ‰¹å‡†,æµç¨‹ç»“æŸ&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VideoApprover</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Approver</span></span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">check</span><span class="hljs-params">(Article article)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(StringUtils.isNotEmpty(article.getVideo()))&#123;<br>            System.out.println(article.getName()+<span class="hljs-string">&quot;è§†é¢‘å†…å®¹åˆè§„,æ‰¹å‡†&quot;</span>);<br>            <span class="hljs-keyword">if</span>(approver != <span class="hljs-keyword">null</span>)&#123;<br>                approver.check(article);<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            System.out.println(article.getName()+<span class="hljs-string">&quot;è§†é¢‘å†…å®¹ä¸åˆè§„,ä¸æ‰¹å‡†,æµç¨‹ç»“æŸ&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Approver contentApprover = <span class="hljs-keyword">new</span> ContentApprover();<br>        Approver videoApprover = <span class="hljs-keyword">new</span> VideoApprover();<br><br>        Article article = <span class="hljs-keyword">new</span> Article();<br>        article.setName(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²&quot;</span>);<br>        article.setContent(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²çš„å†…å®¹&quot;</span>);<br>        article.setVideo(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²çš„è§†é¢‘&quot;</span>);<br><br>        contentApprover.setNextApprover(videoApprover);<br><br>        contentApprover.check(article);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ä¸­ä»‹è€…æ¨¡å¼</title>
    <link href="/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>å®šä¹‰ä¸€ä¸ªå°è£…ä¸€ç»„å¯¹è±¡å¦‚ä½•äº¤äº’çš„å¯¹è±¡</p><p>ç±»å‹ï¼šè¡Œä¸ºå‹</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><ul><li>å¯¹è±¡ä¹‹é—´æœ‰å¤æ‚çš„é€šä¿¡å…³ç³»ï¼šå½“å¯¹è±¡ä¹‹é—´çš„é€šä¿¡å…³ç³»å˜å¾—å¤æ‚æ—¶ï¼Œä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥ç®€åŒ–å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œå°†å¤æ‚çš„é€šä¿¡é€»è¾‘è½¬ç§»åˆ°ä¸­ä»‹è€…ä¸­è¿›è¡Œç®¡ç†ã€‚</li><li>å¯¹è±¡ä¹‹é—´çš„è€¦åˆåº¦è¾ƒé«˜ï¼šå½“å¯¹è±¡ä¹‹é—´çš„è€¦åˆåº¦è¾ƒé«˜ï¼Œå½¼æ­¤ä¹‹é—´çš„ä¾èµ–å…³ç³»è¾ƒä¸ºå¤æ‚æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼æ¥è§£è€¦å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œå‡å°‘å¯¹è±¡ä¹‹é—´çš„ç›´æ¥ä¾èµ–ã€‚</li><li>ä¸€å¯¹å¤šçš„å…³ç³»ï¼šä¸­ä»‹è€…æ¨¡å¼é€‚ç”¨äºä¸€å¯¹å¤šçš„å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡éœ€è¦ä¸å¤šä¸ªå…¶ä»–å¯¹è±¡è¿›è¡Œé€šä¿¡æ—¶ï¼Œå¯ä»¥å¼•å…¥ä¸­ä»‹è€…æ¥ç®€åŒ–å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ã€‚</li><li>åˆ†å¸ƒå¼ç³»ç»Ÿï¼šä¸­ä»‹è€…æ¨¡å¼åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¹Ÿæœ‰åº”ç”¨ã€‚ä¾‹å¦‚ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ¶ˆæ¯ä¸­é—´ä»¶å¯ä»¥çœ‹ä½œæ˜¯ä¸­ä»‹è€…ï¼Œè´Ÿè´£åè°ƒä¸åŒç»„ä»¶æˆ–æœåŠ¡ä¹‹é—´çš„é€šä¿¡å’Œæ•°æ®äº¤æ¢ã€‚</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>è§£è€¦å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼šä¸­ä»‹è€…æ¨¡å¼é€šè¿‡å°†å¯¹è±¡ä¹‹é—´çš„é€šä¿¡é›†ä¸­åœ¨ä¸­ä»‹è€…å¯¹è±¡ä¸­ï¼Œå°†å¯¹è±¡ä¹‹é—´çš„ç›´æ¥è€¦åˆè½¬æ¢ä¸ºå¯¹è±¡ä¸ä¸­ä»‹è€…çš„è€¦åˆã€‚è¿™æ ·ä¸€æ¥ï¼Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»å˜å¾—æ¾æ•£ï¼Œå¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å’Œå¤ç”¨å¯¹è±¡å’Œä¸­ä»‹è€…ã€‚</li><li>ç®€åŒ–å¯¹è±¡åè®®ï¼šä¸­ä»‹è€…æ¨¡å¼å¯ä»¥ç®€åŒ–å¯¹è±¡ä¹‹é—´çš„åè®®ã€‚å¯¹è±¡åªéœ€è¦ä¸ä¸­ä»‹è€…è¿›è¡Œé€šä¿¡ï¼Œä¸éœ€è¦äº†è§£å…¶ä»–å¯¹è±¡çš„å…·ä½“å®ç°ç»†èŠ‚ï¼Œä»è€Œé™ä½äº†å¯¹è±¡ä¹‹é—´çš„å¤æ‚æ€§ã€‚</li><li>å¯æ‰©å±•æ€§å’Œç»´æŠ¤æ€§ï¼šç”±äºä¸­ä»‹è€…æ¨¡å¼å°†å¯¹è±¡ä¹‹é—´çš„é€šä¿¡é›†ä¸­ç®¡ç†ï¼Œå½“ç³»ç»Ÿéœ€è¦å¢åŠ æ–°çš„å¯¹è±¡æ—¶ï¼Œåªéœ€ä¸ä¸­ä»‹è€…è¿›è¡Œäº¤äº’å³å¯ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰å¯¹è±¡ä¹‹é—´çš„é€šä¿¡é€»è¾‘ã€‚è¿™æé«˜äº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§å’Œç»´æŠ¤æ€§ã€‚</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ä¸­ä»‹è€…å¤æ‚åŒ–ï¼šéšç€ç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´é€šä¿¡å…³ç³»çš„å¢åŠ ï¼Œä¸­ä»‹è€…å¯¹è±¡å¯èƒ½å˜å¾—å¤æ‚ã€‚å®ƒéœ€è¦å¤„ç†å’Œç®¡ç†å¤šä¸ªå¯¹è±¡ä¹‹é—´çš„äº¤äº’é€»è¾‘ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸­ä»‹è€…æœ¬èº«çš„å¤æ‚æ€§å¢åŠ ã€‚</li><li>å•ç‚¹æ•…éšœï¼šä¸­ä»‹è€…æ¨¡å¼å°†å¯¹è±¡ä¹‹é—´çš„é€šä¿¡é›†ä¸­åœ¨ä¸­ä»‹è€…å¯¹è±¡ä¸­ï¼Œå¦‚æœä¸­ä»‹è€…å¯¹è±¡å‡ºç°é—®é¢˜æˆ–å¤±è´¥ï¼Œå¯èƒ½ä¼šå½±å“æ•´ä¸ªç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚ä¸­ä»‹è€…çš„æ•…éšœå¯èƒ½ä¼šå¯¼è‡´é€šä¿¡é“¾è·¯ä¸­çš„æ‰€æœ‰å¯¹è±¡æ— æ³•æ­£å¸¸é€šä¿¡ã€‚</li><li>è¿èƒŒå•ä¸€èŒè´£åŸåˆ™ï¼šä¸­ä»‹è€…æ¨¡å¼å¯èƒ½å¯¼è‡´ä¸­ä»‹è€…å¯¹è±¡æ‰¿æ‹…è¿‡å¤šçš„è´£ä»»ã€‚ä¸­ä»‹è€…éœ€è¦äº†è§£å’Œç®¡ç†å¤šä¸ªå¯¹è±¡ä¹‹é—´çš„é€šä¿¡å…³ç³»ï¼Œå¯èƒ½è¿èƒŒäº†å•ä¸€èŒè´£åŸåˆ™ï¼Œä½¿å¾—ä¸­ä»‹è€…å¯¹è±¡å˜å¾—åºå¤§å’Œå¤æ‚ã€‚</li><li>å¢åŠ ç³»ç»Ÿå¤æ‚æ€§ï¼šå¼•å…¥ä¸­ä»‹è€…æ¨¡å¼ä¼šå¢åŠ ç³»ç»Ÿä¸­çš„é¢å¤–ç±»å’Œå¯¹è±¡ï¼Œä»è€Œå¢åŠ ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</li><li>é€šä¿¡æ•ˆç‡é™ä½ï¼šä¸­ä»‹è€…æ¨¡å¼å¯èƒ½å¯¼è‡´é€šä¿¡æ•ˆç‡é™ä½ã€‚å½“ç³»ç»Ÿä¸­çš„å¯¹è±¡éœ€è¦é¢‘ç¹åœ°è¿›è¡Œé€šä¿¡æ—¶ï¼Œç”±äºé€šä¿¡éƒ½éœ€è¦é€šè¿‡ä¸­ä»‹è€…è¿›è¡Œè½¬å‘ï¼Œå¯èƒ½ä¼šå¯¼è‡´é€šä¿¡çš„å»¶è¿Ÿå¢åŠ ã€‚</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼š</p><p>ç”¨æˆ·é€šè¿‡QQç¾¤æ¥è¿›è¡ŒèŠå¤©è€Œä¸æ˜¯ç›´æ¥é¢å¯¹é¢èŠ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sendMessage</span><span class="hljs-params">(String message)</span> </span>&#123;<br>        StudyGroup.showMessage(<span class="hljs-keyword">this</span>, message);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StudyGroup</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">showMessage</span><span class="hljs-params">(User user, String message)</span></span>&#123;<br>        System.out.println(<span class="hljs-keyword">new</span> Date() + <span class="hljs-string">&quot; [&quot;</span> + user.getName() + <span class="hljs-string">&quot;] : &quot;</span> + message);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        User geely = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;Geely&quot;</span>);<br>        User tom= <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;Tom&quot;</span>);<br><br>        geely.sendMessage(<span class="hljs-string">&quot; Hey! Tom! Let&#x27;s learn Design Pattern&quot;</span>);<br>        tom.sendMessage(<span class="hljs-string">&quot;OK! Geely&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>Wed Oct 04 21:43:12 CST 2023 [Geely] :  Hey! Tom! Letâ€™s learn Design Pattern<br>Wed Oct 04 21:43:12 CST 2023 [Tom] : OK! Geely</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å‘½ä»¤æ¨¡å¼</title>
    <link href="/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>å°†è¯·æ±‚æˆ–æ“ä½œå°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œ<strong>ä»è€Œä½¿ä¸åŒçš„è¯·æ±‚å¯ä»¥è¢«å¼‚æ­¥ã€å»¶è¿Ÿã€æ’é˜Ÿï¼Œæˆ–è€…è®°å½•ä¸‹æ¥ä»¥å¤‡æ’¤é”€æˆ–é‡åšç­‰æ“ä½œ</strong>ã€‚</p><p>ç±»å‹ï¼šè¡Œä¸ºå‹</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><ul><li>æ’¤é”€&#x2F;é‡åšæ“ä½œï¼šå½“éœ€è¦æ”¯æŒæ’¤é”€å’Œé‡åšåŠŸèƒ½æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤æ¨¡å¼ã€‚å‘½ä»¤å¯¹è±¡å¯ä»¥è®°å½•æ“ä½œçš„çŠ¶æ€å’Œå‚æ•°ï¼Œä»¥ä¾¿åœ¨éœ€è¦æ—¶æ‰§è¡Œæ’¤é”€æ“ä½œ</li><li>äº‹åŠ¡æ€§æ“ä½œï¼šå‘½ä»¤æ¨¡å¼å¯ä»¥ç”¨äºå®ç°äº‹åŠ¡æ€§æ“ä½œï¼Œå³ä¸€ç³»åˆ—ç›¸å…³æ“ä½œçš„æ‰§è¡Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚é€šè¿‡å°†æ¯ä¸ªæ“ä½œå°è£…ä¸ºä¸€ä¸ªå‘½ä»¤å¯¹è±¡ï¼Œå¯ä»¥åœ¨éœ€è¦æ—¶æ‰§è¡Œå›æ»šæ“ä½œï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚</li><li>é˜Ÿåˆ—è¯·æ±‚ï¼šå‘½ä»¤æ¨¡å¼å¯ä»¥ç”¨äºæ„å»ºè¯·æ±‚é˜Ÿåˆ—ã€‚æ¯ä¸ªå‘½ä»¤å¯¹è±¡éƒ½è¡¨ç¤ºä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶ä¸”å¯ä»¥æŒ‰é¡ºåºæ‰§è¡Œè¿™äº›è¯·æ±‚ã€‚è¿™åœ¨éœ€è¦æŒ‰é¡ºåºæ‰§è¡Œä¸€ç³»åˆ—æ“ä½œçš„æƒ…å†µä¸‹å¾ˆæœ‰ç”¨ã€‚</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>é™ä½è€¦åˆ</li><li>å®¹æ˜“æ‰©å±•å‡ºæ–°å‘½ä»¤æˆ–è€…ä¸€ç»„å‘½ä»¤</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å‘½ä»¤ä¼šæ‰©å±•ç±»çš„æ•°é‡ï¼Œä»è€Œæé«˜ç³»ç»Ÿå¤æ‚åº¦</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼šCEOä¸‹è¾¾æ‰“å¼€è¯¾ç¨‹è§†é¢‘å’Œå…³é—­è¯¾ç¨‹è§†é¢‘çš„æ“ä½œçš„å‘½ä»¤ï¼Œå‘˜å·¥æ‰§è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CourseVideo</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CourseVideo</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">open</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-keyword">this</span>.name+<span class="hljs-string">&quot;è¯¾ç¨‹è§†é¢‘å¼€æ”¾&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">close</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-keyword">this</span>.name+<span class="hljs-string">&quot;è¯¾ç¨‹è§†é¢‘å…³é—­&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Command</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OpenCourseVideoCommand</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Command</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> CourseVideo courseVideo;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">OpenCourseVideoCommand</span><span class="hljs-params">(CourseVideo courseVideo)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.courseVideo = courseVideo;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span> </span>&#123;<br>        courseVideo.open();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CloseCourseVideoCommand</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Command</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> CourseVideo courseVideo;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CloseCourseVideoCommand</span><span class="hljs-params">(CourseVideo courseVideo)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.courseVideo = courseVideo;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span> </span>&#123;<br>        courseVideo.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å‘˜å·¥è®°å½•éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œè¿›è¡Œæ‰§è¡Œ</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Staff</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> List&lt;Command&gt; commandList = <span class="hljs-keyword">new</span> ArrayList&lt;Command&gt;();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addCommand</span><span class="hljs-params">(Command command)</span></span>&#123;<br>        commandList.add(command);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">executeCommands</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">for</span>(Command command : commandList)&#123;<br>            command.execute();<br>        &#125;<br>        commandList.clear();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        CourseVideo courseVideo = <span class="hljs-keyword">new</span> CourseVideo(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²&quot;</span>);<br>        OpenCourseVideoCommand openCourseVideoCommand = <span class="hljs-keyword">new</span> OpenCourseVideoCommand(courseVideo);<br>        CloseCourseVideoCommand closeCourseVideoCommand = <span class="hljs-keyword">new</span> CloseCourseVideoCommand(courseVideo);<br><br>        Staff staff = <span class="hljs-keyword">new</span> Staff();<br>        staff.addCommand(openCourseVideoCommand);<br>        staff.addCommand(closeCourseVideoCommand);<br><br>        staff.executeCommands();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>Javaè®¾è®¡æ¨¡å¼ç²¾è®²è¯¾ç¨‹è§†é¢‘å¼€æ”¾<br>Javaè®¾è®¡æ¨¡å¼ç²¾è®²è¯¾ç¨‹è§†é¢‘å…³é—­</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¤‡å¿˜å½•æ¨¡å¼</title>
    <link href="/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>ä¿å­˜ä¸€ä¸ªå¯¹è±¡çš„æŸç§çŠ¶æ€ï¼Œä»¥ä¾¿åœ¨é€‚å½“çš„æ—¶å€™æ¥æ¢å¤å¯¹è±¡</p><p>ç±»å‹ï¼šè¡Œä¸ºå‹</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><p>ä¿å­˜åŠæ¢å¤æ•°æ®ç›¸å…³ä¸šåŠ¡åœºæ™¯</p><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>ä¸ºç”¨æˆ·æä¾›ä¸€ç§å¯æ¢å¤çš„æœºåˆ¶</li><li>å­˜æ¡£ä¿¡æ¯çš„å°è£…</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>èµ„æºå ç”¨</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼šç½‘ç«™ä¸Šå‘å¸ƒåšå®¢ï¼Œæ”¯æŒæš‚å­˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Article</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String title;<br>    <span class="hljs-keyword">private</span> String content;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ArticleMemento <span class="hljs-title">saveToMemento</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ArticleMemento(<span class="hljs-keyword">this</span>.title, <span class="hljs-keyword">this</span>.content);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">undoFromMemento</span><span class="hljs-params">(ArticleMemento articleMemento)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.title = articleMemento.getTitle();<br>        <span class="hljs-keyword">this</span>.content = articleMemento.getContent();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-meta">@Getter</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ArticleMemento</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String title;<br>    <span class="hljs-keyword">private</span> String content;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åˆ©ç”¨æ ˆçš„å…ˆè¿›åå‡ºæ¥åšå¤‡å¿˜å½•</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ArticleMementoManager</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Stack&lt;ArticleMemento&gt; ARTICLE_MEMENTO_STACK = <span class="hljs-keyword">new</span> Stack&lt;ArticleMemento&gt;();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ArticleMemento <span class="hljs-title">getMemento</span><span class="hljs-params">()</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ARTICLE_MEMENTO_STACK.pop();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addMemento</span><span class="hljs-params">(ArticleMemento articleMemento)</span></span><br><span class="hljs-function">    </span>&#123;<br>        ARTICLE_MEMENTO_STACK.push(articleMemento);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ArticleMementoManager articleMementoManager = <span class="hljs-keyword">new</span> ArticleMementoManager();<br>        Article article= <span class="hljs-keyword">new</span> Article(<span class="hljs-string">&quot;å¦‚å½±éšè¡Œçš„è®¾è®¡æ¨¡å¼A&quot;</span>,<span class="hljs-string">&quot;å†…å®¹A&quot;</span>);<br><br>        <span class="hljs-comment">// ç‰ˆæœ¬1ä¿å­˜åˆ°å¤‡å¿˜å½•</span><br>        ArticleMemento articleMemento = article.saveToMemento();<br>        articleMementoManager.addMemento(articleMemento);<br>        System.out.println(<span class="hljs-string">&quot;æ ‡é¢˜:&quot;</span>+article.getTitle()+<span class="hljs-string">&quot; å†…å®¹:&quot;</span>+article.getContent()+<span class="hljs-string">&quot; æš‚å­˜æˆåŠŸ&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;å®Œæ•´ä¿¡æ¯:&quot;</span>+article);<br><br>        System.out.println(<span class="hljs-string">&quot;============ä¿®æ”¹æ–‡ç« start============&quot;</span>);<br>        article.setTitle(<span class="hljs-string">&quot;å¦‚å½±éšè¡Œçš„è®¾è®¡æ¨¡å¼B&quot;</span>);<br>        article.setContent(<span class="hljs-string">&quot;å†…å®¹B&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;============ä¿®æ”¹æ–‡ç« end============&quot;</span>);<br><br>        <span class="hljs-comment">// ç‰ˆæœ¬2ä¿å­˜åˆ°å¤‡å¿˜å½•</span><br>        articleMemento = article.saveToMemento();<br>        articleMementoManager.addMemento(articleMemento);<br>        System.out.println(<span class="hljs-string">&quot;æ ‡é¢˜:&quot;</span>+article.getTitle()+<span class="hljs-string">&quot; å†…å®¹:&quot;</span>+article.getContent()+<span class="hljs-string">&quot; æš‚å­˜æˆåŠŸ&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;å®Œæ•´ä¿¡æ¯:&quot;</span>+article);<br><br>        <span class="hljs-comment">// å›é€€åˆ°ç‰ˆæœ¬2</span><br>        System.out.println(<span class="hljs-string">&quot;============æš‚å­˜å›é€€start============&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;å›é€€å‡ºæ ˆ1æ¬¡&quot;</span>);<br>        articleMemento = articleMementoManager.getMemento();<br>        article.undoFromMemento(articleMemento);<br><br>        <span class="hljs-comment">// å›é€€åˆ°ç‰ˆæœ¬1</span><br>        System.out.println(<span class="hljs-string">&quot;å›é€€å‡ºæ ˆ2æ¬¡&quot;</span>);<br>        articleMemento = articleMementoManager.getMemento();<br>        article.undoFromMemento(articleMemento);<br>        System.out.println(<span class="hljs-string">&quot;============æš‚å­˜å›é€€end============&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;å®Œæ•´ä¿¡æ¯:&quot;</span>+article);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>æ ‡é¢˜:å¦‚å½±éšè¡Œçš„è®¾è®¡æ¨¡å¼A å†…å®¹:å†…å®¹A æš‚å­˜æˆåŠŸ<br>å®Œæ•´ä¿¡æ¯:Article(title&#x3D;å¦‚å½±éšè¡Œçš„è®¾è®¡æ¨¡å¼A, content&#x3D;å†…å®¹A)<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;ä¿®æ”¹æ–‡ç« start&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;ä¿®æ”¹æ–‡ç« end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>æ ‡é¢˜:å¦‚å½±éšè¡Œçš„è®¾è®¡æ¨¡å¼B å†…å®¹:å†…å®¹B æš‚å­˜æˆåŠŸ<br>å®Œæ•´ä¿¡æ¯:Article(title&#x3D;å¦‚å½±éšè¡Œçš„è®¾è®¡æ¨¡å¼B, content&#x3D;å†…å®¹B)<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;æš‚å­˜å›é€€start&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>å›é€€å‡ºæ ˆ1æ¬¡<br>å›é€€å‡ºæ ˆ2æ¬¡<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;æš‚å­˜å›é€€end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>å®Œæ•´ä¿¡æ¯:Article(title&#x3D;å¦‚å½±éšè¡Œçš„è®¾è®¡æ¨¡å¼A, content&#x3D;å†…å®¹A)</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è§‚å¯Ÿè€…æ¨¡å¼</title>
    <link href="/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>å®šä¹‰äº†å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šä¾èµ–ã€‚è®©å¤šä¸ªè§‚å¯Ÿè€…åŒæ—¶ç›‘å¬ä¸€ä¸ªä¸»é¢˜å¯¹è±¡ï¼Œå½“ä¸»é¢˜å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒçš„è§‚å¯Ÿè€…éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶æ›´æ–°ã€‚</p><p>ç±»å‹ï¼šè¡Œä¸ºå‹</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><p>å…³è”è¡Œä¸ºåœºæ™¯ã€‚å»ºç«‹ä¸€å¥—è§¦å‘æœºåˆ¶</p><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>æ”¯æŒå¹¿æ’­é€šä¿¡</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>è§‚å¯Ÿè€…ä¹‹é—´æœ‰è¿‡å¤šä¾èµ–çš„è¯ï¼Œä¼šæé«˜ç¨‹åºå¤æ‚åº¦</li><li>ä½¿ç”¨éœ€è¦æ³¨æ„ï¼Œé¿å…è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…å¾ªç¯è°ƒç”¨</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼šåŒå­¦åœ¨ç½‘ç«™ä¸Šæå‡ºé—®é¢˜ï¼Œè€å¸ˆæ”¶åˆ°é€šçŸ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ç»§æ‰¿Observableè¡¨æ˜ä»–æ˜¯è¢«è§‚å¯Ÿè€…</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Course</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Observable</span></span>&#123;<br>    <span class="hljs-keyword">private</span> String courseName;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Course</span><span class="hljs-params">(String courseName)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.courseName = courseName;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getCourseName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> courseName;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produceQuestion</span><span class="hljs-params">(Course course, Question question)</span></span>&#123;<br>        System.out.println(question.getUserName()+<span class="hljs-string">&quot;åœ¨&quot;</span>+course.courseName+<span class="hljs-string">&quot;æäº¤äº†ä¸€ä¸ªé—®é¢˜&quot;</span>);<br>        <span class="hljs-comment">// è®¾ç½®å¯¹è±¡å‘ç”Ÿå˜åŒ–</span><br>        setChanged();<br>        <span class="hljs-comment">// é€šçŸ¥è§‚å¯Ÿè€…</span><br>        notifyObservers(question);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Getter</span><br><span class="hljs-meta">@Setter</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Question</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String userName;<br>    <span class="hljs-keyword">private</span> String questionContent;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  implements Observerè¡¨æ˜Teacheræ˜¯è§‚å¯Ÿè€…ç±»,</span><br><span class="hljs-comment"> *  å¤å†™updateæ¥æŒ‡åæ¥å—åˆ°é€šçŸ¥åæ‰§è¡Œçš„é€»è¾‘</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Teacher</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Observer</span></span>&#123;<br>    <span class="hljs-keyword">private</span> String teacherName;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Teacher</span><span class="hljs-params">(String teacherName)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.teacherName = teacherName;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(Observable o, Object arg)</span> </span>&#123;<br>        Course course = (Course)o;<br>        Question question = (Question)arg;<br>        System.out.println(teacherName+<span class="hljs-string">&quot;è€å¸ˆçš„&quot;</span>+course.getCourseName()+<span class="hljs-string">&quot;è¯¾ç¨‹æ¥æ”¶åˆ°ä¸€ä¸ª&quot;</span>+question.getUserName()+<span class="hljs-string">&quot;æäº¤çš„é—®ç­”:&quot;</span>+question.getQuestionContent());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Course course = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²&quot;</span>);<br>        Teacher teacher1 = <span class="hljs-keyword">new</span> Teacher(<span class="hljs-string">&quot;Alpha&quot;</span>);<br>        Teacher teacher2 = <span class="hljs-keyword">new</span> Teacher(<span class="hljs-string">&quot;Beta&quot;</span>);<br>        <br>        <span class="hljs-comment">// æ·»åŠ è§‚å¯Ÿè€…</span><br>        course.addObserver(teacher1);<br>        course.addObserver(teacher2);<br><br>        <span class="hljs-comment">//ä¸šåŠ¡é€»è¾‘ä»£ç </span><br>        Question question = <span class="hljs-keyword">new</span> Question();<br>        question.setUserName(<span class="hljs-string">&quot;Geely&quot;</span>);<br>        question.setQuestionContent(<span class="hljs-string">&quot;Javaçš„ä¸»å‡½æ•°å¦‚ä½•ç¼–å†™&quot;</span>);<br><br>        course.produceQuestion(course,question);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>Geelyåœ¨Javaè®¾è®¡æ¨¡å¼ç²¾è®²æäº¤äº†ä¸€ä¸ªé—®é¢˜<br>Betaè€å¸ˆçš„Javaè®¾è®¡æ¨¡å¼ç²¾è®²è¯¾ç¨‹æ¥æ”¶åˆ°ä¸€ä¸ªGeelyæäº¤çš„é—®ç­”:Javaçš„ä¸»å‡½æ•°å¦‚ä½•ç¼–å†™<br>Alphaè€å¸ˆçš„Javaè®¾è®¡æ¨¡å¼ç²¾è®²è¯¾ç¨‹æ¥æ”¶åˆ°ä¸€ä¸ªGeelyæäº¤çš„é—®ç­”:Javaçš„ä¸»å‡½æ•°å¦‚ä½•ç¼–å†™</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è§£é‡Šå™¨æ¨¡å¼</title>
    <link href="/%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a>1 æ¦‚å¿µ</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰å®ƒæ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºã€‚å¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œä½¿ç”¨è¿™ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­</p><p>ç±»å‹ï¼šè¡Œä¸ºå‹</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><ul><li>å¯ä»¥å°†ä¸€ä¸ªéœ€è¦è§£é‡Šæ‰§è¡Œçš„è¯­è¨€ä¸­çš„å¥å­è¡¨ç¤ºä¸ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘ã€‚ </li><li>ä¸€äº›é‡å¤å‡ºç°çš„é—®é¢˜å¯ä»¥ç”¨ä¸€ç§ç®€å•çš„è¯­è¨€æ¥è¿›è¡Œè¡¨</li><li>ä¸€ä¸ªç®€å•è¯­æ³•éœ€è¦è§£é‡Šçš„åœºæ™¯ã€‚</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>è¯­æ³•ç”±å¾ˆå¤šç±»ç»„æˆï¼Œä¾¿äºæ‰©å±•</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>è¯­æ³• è§„åˆ™å¤ªå¤šæ—¶ï¼Œå¢åŠ äº†ç³»ç»Ÿå¤æ‚åº¦</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼šå®šä¹‰è¡¨è¾¾å¼ã€6 100 11 +  * <em>ã€‘ï¼Œè®¡ç®—é€»è¾‘ä¸ºï¼ˆ100 + 11 ï¼‰</em> * 6</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Interpreter</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">interpret</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NumberInterpreter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Interpreter</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> number;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">NumberInterpreter</span><span class="hljs-params">(<span class="hljs-keyword">int</span> number)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.number=number;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">NumberInterpreter</span><span class="hljs-params">(String number)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.number=Integer.parseInt(number);<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">interpret</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.number;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AddInterpreter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Interpreter</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Interpreter firstExpression,secondExpression;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AddInterpreter</span><span class="hljs-params">(Interpreter firstExpression, Interpreter secondExpression)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.firstExpression=firstExpression;<br>        <span class="hljs-keyword">this</span>.secondExpression=secondExpression;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">interpret</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.firstExpression.interpret()+<span class="hljs-keyword">this</span>.secondExpression.interpret();<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;+&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MultiInterpreter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Interpreter</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> Interpreter firstExpression,secondExpression;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MultiInterpreter</span><span class="hljs-params">(Interpreter firstExpression, Interpreter secondExpression)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.firstExpression=firstExpression;<br>        <span class="hljs-keyword">this</span>.secondExpression=secondExpression;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">interpret</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.firstExpression.interpret()*<span class="hljs-keyword">this</span>.secondExpression.interpret();<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;*&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyExpressionParser</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Stack&lt;Interpreter&gt; stack = <span class="hljs-keyword">new</span> Stack&lt;Interpreter&gt;();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">parse</span><span class="hljs-params">(String str)</span> </span>&#123;<br>        String[] strItemArray = str.split(<span class="hljs-string">&quot; &quot;</span>);<br>        <span class="hljs-keyword">for</span> (String symbol : strItemArray) &#123;<br>            <span class="hljs-keyword">if</span> (!isOperator(symbol)) &#123;<br>                Interpreter numberExpression = <span class="hljs-keyword">new</span> NumberInterpreter(symbol);<br>                stack.push(numberExpression);<br>                System.out.printf(<span class="hljs-string">&quot;å…¥æ ˆ: %d%n&quot;</span>, numberExpression.interpret());<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">//æ˜¯è¿ç®—ç¬¦å·ï¼Œå¯ä»¥è®¡ç®—</span><br>                Interpreter firstExpression = stack.pop();<br>                Interpreter secondExpression = stack.pop();<br>                System.out.printf(<span class="hljs-string">&quot;å‡ºæ ˆ: %d å’Œ %d%n&quot;</span>,<br>                        firstExpression.interpret(), secondExpression.interpret());<br>                Interpreter operator = getExpressionObject(firstExpression, secondExpression, symbol);<br>                System.out.printf(<span class="hljs-string">&quot;åº”ç”¨è¿ç®—ç¬¦: %s%n&quot;</span>, operator);<br>                <span class="hljs-keyword">int</span> result = operator.interpret();<br>                NumberInterpreter resultExpression = <span class="hljs-keyword">new</span> NumberInterpreter(result);<br>                stack.push(resultExpression);<br>                System.out.printf(<span class="hljs-string">&quot;é˜¶æ®µç»“æœå…¥æ ˆ: %d%n&quot;</span>, resultExpression.interpret());<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">int</span> result = stack.pop().interpret();<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOperator</span><span class="hljs-params">(String symbol)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (symbol.equals(<span class="hljs-string">&quot;+&quot;</span>) || symbol.equals(<span class="hljs-string">&quot;*&quot;</span>));<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Interpreter <span class="hljs-title">getExpressionObject</span><span class="hljs-params">(Interpreter firstExpression, Interpreter secondExpression, String symbol)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (symbol.equals(<span class="hljs-string">&quot;+&quot;</span>)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AddInterpreter(firstExpression, secondExpression);<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (symbol.equals(<span class="hljs-string">&quot;*&quot;</span>)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MultiInterpreter(firstExpression, secondExpression);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        String geelyInputStr=<span class="hljs-string">&quot;6 100 11 + *&quot;</span>;<br>        MyExpressionParser expressionParser=<span class="hljs-keyword">new</span> MyExpressionParser();<br>        <span class="hljs-keyword">int</span> result=expressionParser.parse(geelyInputStr);<br>        System.out.println(<span class="hljs-string">&quot;è§£é‡Šå™¨è®¡ç®—ç»“æœ: &quot;</span>+result);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>å…¥æ ˆ: 6<br>å…¥æ ˆ: 100<br>å…¥æ ˆ: 11<br>å‡ºæ ˆ: 11 å’Œ 100<br>åº”ç”¨è¿ç®—ç¬¦: +<br>é˜¶æ®µç»“æœå…¥æ ˆ: 111<br>å‡ºæ ˆ: 111 å’Œ 6<br>åº”ç”¨è¿ç®—ç¬¦: *<br>é˜¶æ®µç»“æœå…¥æ ˆ: 666<br>è§£é‡Šå™¨è®¡ç®—ç»“æœ: 666</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç­–ç•¥æ¨¡å¼</title>
    <link href="/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>åœ¨ç­–ç•¥æ¨¡å¼å®šä¹‰äº†ä¸€ç³»åˆ—ç®—æ³•æˆ–ç­–ç•¥ï¼Œå¹¶å°†æ¯ä¸ªç®—æ³•å°è£…åœ¨ç‹¬ç«‹çš„ç±»ä¸­ï¼Œä½¿å¾—å®ƒä»¬å¯ä»¥äº’ç›¸æ›¿æ¢ã€‚é€šè¿‡ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶æ ¹æ®éœ€è¦é€‰æ‹©ä¸åŒçš„ç®—æ³•ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç ã€‚</p><p>ç±»å‹ï¼šè¡Œä¸ºå‹</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><ul><li>ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ¨å‡ ç§ç­–ç•¥ä¸­é€‰æ‹©ä¸€ç§</li><li>ç³»ç»Ÿå¾ˆå¤šç±»ï¼ŒåŒºåˆ«ä»…ä»…æ˜¯è¡Œä¸ºä¸åŒ</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>ç¬¦åˆå¼€é—­åŸåˆ™</li><li>é¿å…å¤§é‡ä½¿ç”¨ifâ€¦else, switch..case</li><li>æé«˜ç®—æ³•çš„ä¿å¯†æ€§å’Œå®‰å…¨æ€§</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å®¢æˆ·ç«¯å¿…é¡»çŸ¥é“æ‰€æœ‰çš„ç­–ç•¥ç±»ï¼Œå¹¶è‡ªè¡Œå†³å®šä½¿ç”¨å“ªä¸ªç±»</li><li>äº§ç”Ÿå¾ˆå¤šç­–ç•¥ç±»</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼šæ…•è¯¾ç½‘æ´»åŠ¨ä¿ƒé”€ï¼Œæœ‰å¤šç§æ–¹å¼ï¼šæ»¡å‡ï¼Œè¿”ç°ï¼Œç«‹å‡ç­‰ï¼ŒåŒ11å’Œ618éƒ½é‡‡å–ä¸åŒçš„ç­–ç•¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">PromotionStrategy</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">doPromotion</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmptyPromotionStrategy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PromotionStrategy</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPromotion</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ— ä¿ƒé”€æ´»åŠ¨&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LiJianPromotionStrategy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PromotionStrategy</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPromotion</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ç«‹å‡ä¿ƒé”€,è¯¾ç¨‹çš„ä»·æ ¼ç›´æ¥å‡å»é…ç½®çš„ä»·æ ¼&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FanXianPromotionStrategy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PromotionStrategy</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPromotion</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;è¿”ç°ä¿ƒé”€,è¿”å›çš„é‡‘é¢å­˜æ”¾åˆ°æ…•è¯¾ç½‘ç”¨æˆ·çš„ä½™é¢ä¸­&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä¿ƒé”€æ´»åŠ¨</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PromotionActivity</span> </span>&#123;<br>  <span class="hljs-comment">// ä¿ƒé”€ç­–ç•¥</span><br>    <span class="hljs-keyword">private</span> PromotionStrategy promotionStrategy;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PromotionActivity</span><span class="hljs-params">(PromotionStrategy promotionStrategy)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.promotionStrategy = promotionStrategy;<br>    &#125;<br><br>  <span class="hljs-comment">// æ‰§è¡Œä¿ƒé”€</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">executePromotionStrategy</span><span class="hljs-params">()</span></span>&#123;<br>        promotionStrategy.doPromotion();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        PromotionActivity promotionActivity618 = <span class="hljs-keyword">new</span> PromotionActivity(<span class="hljs-keyword">new</span> LiJianPromotionStrategy());<br>        PromotionActivity promotionActivity1111 = <span class="hljs-keyword">new</span> PromotionActivity(<span class="hljs-keyword">new</span> FanXianPromotionStrategy());<br><br>        promotionActivity618.executePromotionStrategy();<br>        promotionActivity1111.executePromotionStrategy();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>ç«‹å‡ä¿ƒé”€,è¯¾ç¨‹çš„ä»·æ ¼ç›´æ¥å‡å»é…ç½®çš„ä»·æ ¼<br>è¿”ç°ä¿ƒé”€,è¿”å›çš„é‡‘é¢å­˜æ”¾åˆ°æ…•è¯¾ç½‘ç”¨æˆ·çš„ä½™é¢ä¸­</p><p><strong>ä»£ç æ¼”è¿›</strong></p><p>å¦‚æœéœ€è¦æ ¹æ®ä¼ è¿‡æ¥çš„keyï¼Œå»é€‰æ‹©å¯¹åº”çš„ç­–ç•¥ï¼Œä½¿ç”¨å…±å‚æ¨¡å¼æ¼”è¿›ã€‚ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PromotionStrategyFactory</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;String,PromotionStrategy&gt; PROMOTION_STRATEGY_MAP = <span class="hljs-keyword">new</span> HashMap&lt;String, PromotionStrategy&gt;();<br>    <span class="hljs-keyword">static</span> &#123;<br>        PROMOTION_STRATEGY_MAP.put(PromotionKey.LIJIAN,<span class="hljs-keyword">new</span> LiJianPromotionStrategy());<br>        PROMOTION_STRATEGY_MAP.put(PromotionKey.FANXIAN,<span class="hljs-keyword">new</span> FanXianPromotionStrategy());<br>    &#125;<br><br>    <span class="hljs-comment">// é¿å…æ¯æ¬¡è¿›æ¥éƒ½éœ€è¦new</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> PromotionStrategy NON_PROMOTION = <span class="hljs-keyword">new</span> EmptyPromotionStrategy();<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">PromotionStrategyFactory</span><span class="hljs-params">()</span></span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PromotionStrategy <span class="hljs-title">getPromotionStrategy</span><span class="hljs-params">(String promotionKey)</span></span>&#123;<br>        PromotionStrategy promotionStrategy = PROMOTION_STRATEGY_MAP.get(promotionKey);<br>        <span class="hljs-keyword">return</span> promotionStrategy == <span class="hljs-keyword">null</span> ? NON_PROMOTION : promotionStrategy;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">PromotionKey</span></span>&#123;<br>        String LIJIAN = <span class="hljs-string">&quot;LIJIAN&quot;</span>;<br>        String FANXIAN = <span class="hljs-string">&quot;FANXIAN&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        String promotionKey = <span class="hljs-string">&quot;LIJIAN&quot;</span>;<br>        PromotionActivity promotionActivity = <span class="hljs-keyword">new</span> PromotionActivity(PromotionStrategyFactory.getPromotionStrategy(promotionKey));<br>        promotionActivity.executePromotionStrategy();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>ç«‹å‡ä¿ƒé”€,è¯¾ç¨‹çš„ä»·æ ¼ç›´æ¥å‡å»é…ç½®çš„ä»·æ ¼</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è¿­ä»£å™¨æ¨¡å¼</title>
    <link href="/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>æä¾›ä¸€ç§æ–¹æ³•ï¼Œé¡ºåºè®¿é—®ä¸€ä¸ªé›†åˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨å±•ç¤º</p><p>ç±»å‹ï¼šè¡Œä¸ºå‹</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><ul><li>è®¿é—®ä¸€ä¸ªé›†åˆçš„å†…å®¹ï¼Œè€Œä¸æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨å±•ç¤º</li><li>ä¸ºéå†ä¸åŒçš„é›†åˆç»“æ„æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£</li></ul><blockquote><p>å¹³æ—¶æˆ‘ä»¬ä¸å¤ªä¼šè‡ªå·±å†™ï¼Œå› ä¸ºå·²ç»æœ‰å¾ˆå¤šå·¥å…·ç±»å†™å¥½äº†</p></blockquote><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>åˆ†ç¦»äº†é›†åˆå¯¹è±¡çš„å­˜å‚¨å’Œéå†è¡Œä¸ºï¼Œç”±è¿­ä»£å™¨è¿›è¡Œéå†</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ç±»çš„ä¸ªæ•°æˆå¯¹å¢åŠ ï¼Œéœ€è¦æ–°å¢è¿­ä»£å™¨ç±»</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼š éå†è¯¾ç¨‹åˆ—è¡¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Course</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CourseAggregate</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addCourse</span><span class="hljs-params">(Course course)</span></span>;<br>    <span class="hljs-function">CourseIterator <span class="hljs-title">getIterator</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CourseAggregateImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CourseAggregate</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> List courseList;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CourseAggregateImpl</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.courseList = <span class="hljs-keyword">new</span> ArrayList();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addCourse</span><span class="hljs-params">(Course course)</span> </span>&#123;<br>        courseList.add(course);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> CourseIterator <span class="hljs-title">getIterator</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CourseIteratorImpl(courseList);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CourseIterator</span> </span>&#123;<br>    <span class="hljs-function">Course <span class="hljs-title">nextCourse</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">hasNext</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CourseIteratorImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CourseIterator</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Course&gt; courseList;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> position;<br>    <span class="hljs-keyword">private</span> Course course;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CourseIteratorImpl</span><span class="hljs-params">(List&lt;Course&gt; courseList)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.courseList=courseList;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Course <span class="hljs-title">nextCourse</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;è¿”å›è¯¾ç¨‹,ä½ç½®æ˜¯: &quot;</span>+position);<br>        course=courseList.get(position);<br>        position++;<br>        <span class="hljs-keyword">return</span> course;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasNext</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(position&lt; courseList.size())&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Course course1 = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;Javaç”µå•†ä¸€æœŸ&quot;</span>);<br>        Course course2 = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;Javaç”µå•†äºŒæœŸ&quot;</span>);<br>        Course course3 = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²&quot;</span>);<br>        Course course4 = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;Pythonè¯¾ç¨‹&quot;</span>);<br>        Course course5 = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;ç®—æ³•è¯¾ç¨‹&quot;</span>);<br>        Course course6 = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;å‰ç«¯è¯¾ç¨‹&quot;</span>);<br><br><br>        CourseAggregate courseAggregate = <span class="hljs-keyword">new</span> CourseAggregateImpl();<br><br>        courseAggregate.addCourse(course1);<br>        courseAggregate.addCourse(course2);<br>        courseAggregate.addCourse(course3);<br>        courseAggregate.addCourse(course4);<br>        courseAggregate.addCourse(course5);<br>        courseAggregate.addCourse(course6);<br><br>        System.out.println(<span class="hljs-string">&quot;-----è¯¾ç¨‹åˆ—è¡¨-----&quot;</span>);<br>        printCourses(courseAggregate);<br>    &#125;<br><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">printCourses</span><span class="hljs-params">(CourseAggregate courseAggregate)</span></span>&#123;<br>        CourseIterator courseIterator= courseAggregate.getIterator();<br>        <span class="hljs-keyword">while</span>(!courseIterator.hasNext())&#123;<br>            Course course=courseIterator.nextCourse();<br>            System.out.println(course.getName());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>è¿”å›è¯¾ç¨‹,ä½ç½®æ˜¯: 0<br>Javaç”µå•†ä¸€æœŸ<br>è¿”å›è¯¾ç¨‹,ä½ç½®æ˜¯: 1<br>Javaç”µå•†äºŒæœŸ<br>è¿”å›è¯¾ç¨‹,ä½ç½®æ˜¯: 2<br>Javaè®¾è®¡æ¨¡å¼ç²¾è®²<br>è¿”å›è¯¾ç¨‹,ä½ç½®æ˜¯: 3<br>Pythonè¯¾ç¨‹<br>è¿”å›è¯¾ç¨‹,ä½ç½®æ˜¯: 4<br>ç®—æ³•è¯¾ç¨‹<br>è¿”å›è¯¾ç¨‹,ä½ç½®æ˜¯: 5<br>å‰ç«¯è¯¾ç¨‹</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼</title>
    <link href="/%E6%A8%A1%E7%89%88%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E6%A8%A1%E7%89%88%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a><strong>1 æ¦‚å¿µ</strong></h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a><strong>1 å®šä¹‰</strong></h2><p>å®šä¹‰ä¸€ä¸ªç®—æ³•çš„éª¨æ¶ï¼Œå…è®¸å­ç±»ä¸ºä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­¥éª¤æä¾›å®ç°ã€‚</p><p>ä½¿å­ç±»åœ¨ä¸æ”¹å˜ç®—æ³•ç»“æ„çš„æƒ…å†µä¸‹ï¼Œé‡æ–°å®šä¹‰ç®—æ³•çš„æŸäº›æ­¥éª¤</p><p>ç±»å‹ï¼šè¡Œä¸ºå‹</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a><strong>2 åº”ç”¨åœºæ™¯</strong></h2><ul><li><p>ä¸€æ¬¡æ€§å®ç°ä¸€ä¸ªç®—æ³•ä¸å˜çš„éƒ¨åˆ†ï¼Œå¹¶å°†å¯å˜çš„è¡Œä¸ºç•™ç»™å­ç±»å®ç°</p></li><li><p>å°†å„ç±»ä¸­å…¬å…±çš„è¡Œä¸ºæŠ½å–å‡ºæ¥åˆ°ä¸€ä¸ªå…¬å…±çš„çˆ¶ç±»ä¸­ï¼Œé¿å…ä»£ç é‡å¤</p></li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a><strong>3 ä¼˜ç¼ºç‚¹</strong></h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>æé«˜å¤ç”¨æ€§</li><li>æé«˜æ‰©å±•æ€§</li><li>ç¬¦åˆå¼€é—­åŸåˆ™</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ç±»æ•°ç›®å¢åŠ </li><li>å¢åŠ ç³»ç»Ÿå¤æ‚åº¦</li><li>ç»§æ‰¿è‡ªèº«ç¼ºç‚¹ï¼Œå¦‚æœçˆ¶ç±»æ·»åŠ æ–°çš„æŠ½è±¡æ–¹æ³•ï¼Œæ‰€æœ‰å­ç±»éƒ½éœ€è¦æ”¹ä¸€éã€‚</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a><strong>2 ä»£ç å®ç°</strong></h1><p>åœºæ™¯ï¼š</p><p>å‡†å¤‡è®²è§£å‰ç«¯å’Œåç«¯è¯¾ç¨‹æµç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ACourse</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">makeCourse</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.makePPT();<br>        <span class="hljs-keyword">this</span>.makeVideo();<br>        <span class="hljs-keyword">if</span>(needWriteArticle())&#123;<br>            <span class="hljs-keyword">this</span>.writeArticle();<br>        &#125;<br>        <span class="hljs-keyword">this</span>.prepareContentMaterial();<br>    &#125;<br><br>    <span class="hljs-comment">// æ³¨æ„è¿™é‡Œå¦‚æœæ˜¯å¿…é¡»è¦æ‰§è¡Œçš„æ­¥éª¤ï¼Œå¿…é¡»åŠ finalï¼Œå¦åˆ™å­ç±»å¯ä»¥é‡å†™ï¼Œå°±æ‰“ä¹±äº†æ­¥éª¤</span><br>    <span class="hljs-function"><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">makePPT</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;åˆ¶ä½œPPT&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">makeVideo</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;åˆ¶ä½œè§†é¢‘&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">writeArticle</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ç¼–å†™è¯¾å ‚ç¬”è®°&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-comment">//é’©å­æ–¹æ³•ï¼Œæ³¨æ„è¿™é‡Œä¸æ˜¯finalçš„å­ç±»å¯ä»¥å¤å†™å®ƒ</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">needWriteArticle</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">prepareContentMaterial</span><span class="hljs-params">()</span></span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BackEndCourse</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ACourse</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">prepareContentMaterial</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æä¾›è¯¾ç¨‹Javaæºä»£ç &quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">needWriteArticle</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FECourse</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ACourse</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> needWriteArticleFlag = <span class="hljs-keyword">false</span>;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">prepareContentMaterial</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æä¾›è¯¾ç¨‹çš„å‰ç«¯ä»£ç &quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;æä¾›è¯¾ç¨‹çš„å›¾ç‰‡ç­‰å¤šåª’ä½“ç´ æ&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">FECourse</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> needWriteArticleFlag)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.needWriteArticleFlag = needWriteArticleFlag;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">needWriteArticle</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.needWriteArticleFlag;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;åç«¯è®¾è®¡æ¨¡å¼è¯¾ç¨‹start---&quot;</span>);<br>        ACourse designPatternCourse = <span class="hljs-keyword">new</span> BackEndCourse();<br>        designPatternCourse.makeCourse();<br>        System.out.println(<span class="hljs-string">&quot;åç«¯è®¾è®¡æ¨¡å¼è¯¾ç¨‹end---&quot;</span>);<br><br><br>        System.out.println(<span class="hljs-string">&quot;å‰ç«¯è¯¾ç¨‹start---&quot;</span>);<br>        ACourse feCourse = <span class="hljs-keyword">new</span> FECourse(<span class="hljs-keyword">false</span>);<br>        feCourse.makeCourse();<br>        System.out.println(<span class="hljs-string">&quot;å‰ç«¯è¯¾ç¨‹end---&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>åç«¯è®¾è®¡æ¨¡å¼è¯¾ç¨‹startâ€”<br>åˆ¶ä½œPPT<br>åˆ¶ä½œè§†é¢‘<br>ç¼–å†™è¯¾å ‚ç¬”è®°<br>æä¾›è¯¾ç¨‹Javaæºä»£ç <br>åç«¯è®¾è®¡æ¨¡å¼è¯¾ç¨‹endâ€”<br>å‰ç«¯è¯¾ç¨‹startâ€”<br>åˆ¶ä½œPPT<br>åˆ¶ä½œè§†é¢‘<br>æä¾›è¯¾ç¨‹çš„å‰ç«¯ä»£ç <br>æä¾›è¯¾ç¨‹çš„å›¾ç‰‡ç­‰å¤šåª’ä½“ç´ æ<br>å‰ç«¯è¯¾ç¨‹endâ€”</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ¡¥æ¥æ¨¡å¼</title>
    <link href="/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a>1 æ¦‚å¿µ</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a>1 å®šä¹‰</h2><p>æ¡¥æ¥æ¨¡å¼æ˜¯å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚å®ƒæ˜¯ç”¨ç»„åˆå…³ç³»ä»£æ›¿ç»§æ‰¿å…³ç³»æ¥å®ç°ï¼Œä»è€Œé™ä½äº†æŠ½è±¡å’Œå®ç°è¿™ä¸¤ä¸ªå¯å˜ç»´åº¦çš„è€¦åˆåº¦ã€‚</p><p>ç±»å‹ï¼šç»“æ„å‹</p><blockquote><p><strong>æ¡¥</strong>æˆ‘ä»¬å¤§å®¶éƒ½ç†Ÿæ‚‰ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯ç”¨æ¥å°†æ²³çš„ä¸¤å²¸è”ç³»èµ·æ¥çš„ã€‚è€Œæ­¤å¤„çš„æ¡¥æ˜¯ç”¨æ¥å°†ä¸¤ä¸ªç‹¬ç«‹çš„ç»“æ„è”ç³»èµ·æ¥ï¼Œè€Œè¿™ä¸¤ä¸ªè¢«è”ç³»èµ·æ¥çš„ç»“æ„å¯ä»¥ç‹¬ç«‹çš„å˜åŒ–ã€‚</p></blockquote><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a>2 åº”ç”¨åœºæ™¯</h2><ul><li>ä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œä¸”è¿™ä¸¤ä¸ªç»´åº¦éƒ½éœ€è¦è¿›è¡Œæ‰©å±•ã€‚ï¼ˆå¦‚ä¸­å›½å·¥å•†é“¶è¡Œ å¹´ä»˜è´¦å·ï¼Œä¼šæ ¹æ®é“¶è¡Œå’Œå­˜å‚¨æ–¹å¼ä¸¤ä¸ªç»´åº¦è¿›è¡Œæ‰©å±•ï¼‰</li><li>å¯¹äºé‚£äº›ä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿æˆ–å› ä¸ºå¤šå±‚ç»§æ‰¿å¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ çš„ç³»ç»Ÿï¼Œæ¡¥æ¥æ¨¡å¼å°¤ä¸ºé€‚ç”¨ã€‚</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a>3 ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>æŠ½è±¡ä¸å®ç°åˆ†ç¦»ï¼Œæ‰©å±•èƒ½åŠ›å¼º</li><li>ä½¿ç”¨äº†ç»„åˆï¼Œç¬¦åˆåˆæˆå¤ç”¨åŸåˆ™</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚è¦æ±‚å¼€å‘è€…å¯ä»¥æ­£ç¡®åœ°è¯†åˆ«å‡ºç³»ç»Ÿä¸­ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦</li><li>å¢åŠ äº†ç³»ç»Ÿçš„è®¾è®¡éš¾åº¦ã€‚</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a>2 ä»£ç å®ç°</h1><p>åœºæ™¯ï¼š</p><p>æœ‰ä¸€ä¸ªé“¶è¡Œç±»ï¼Œä»–å¯ä»¥æ‰©å±•å‡ºä¸¤ä¸ªå­ç±»ï¼šä¸­å›½å·¥å•†é“¶è¡Œå’Œä¸­å›½å†œä¸šé“¶è¡Œã€‚å¸Œæœ›è¿™ä¸¤ä¸ªé“¶è¡Œéƒ½æ”¯æŒæœˆæœˆå­˜å’Œå¹´å­˜è¿™ä¸¤ç§å­˜å‚¨æ–¹å¼ï¼Œç”±äºå·²ç»æœ‰ä¸¤ä¸ªç±»ï¼Œæ‰€ä»¥éœ€è¦åˆ›å»º ä¸­å›½å·¥å•†é“¶è¡Œ+æœˆæœˆå­˜ï¼Œä¸­å›½å·¥å•†é“¶è¡Œ+å¹´å­˜ï¼Œä¸­å›½å†œä¸šé“¶è¡Œ+æœˆæœˆå­˜ï¼Œä¸­å›½å†œä¸šé“¶è¡Œ+å¹´å­˜ï¼Œè¿™å››ç§ç±»æ¥æ”¯æŒã€‚</p><p>å¦‚æœéœ€è¦æ–°å¢é“¶è¡Œæˆ–è€…æ–°å¢å­˜å‚¨æ–¹å¼ï¼Œå°†å¯¼è‡´ä»£ç å¤æ‚ç¨‹åº¦æŒ‡æ•°å¢é•¿ã€‚</p><p>è§£å†³ï¼šåœ¨é“¶è¡Œå’Œå­˜å‚¨æ–¹å¼è¿™ä¸¤ä¸ªç‹¬ç«‹çš„ç»´åº¦åˆ†åˆ«æ‰©å±•ï¼Œé€‚ç”¨ç»„åˆçš„æ–¹å¼å»ºç«‹å…³è”ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Account</span> </span>&#123;<br>    <span class="hljs-function">Account <span class="hljs-title">createAccount</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MonthSavingAccount</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Account</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Account <span class="hljs-title">createAccount</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ–°å»ºä¸€ä¸ªæœˆå­˜å‚¨è´¦å·ã€‚ã€‚ã€‚&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MonthSavingAccount();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">YearSavingAccount</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Account</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Account <span class="hljs-title">createAccount</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ–°å»ºä¸€ä¸ªå¹´å­˜å‚¨è´¦å·ã€‚ã€‚ã€‚&quot;</span>);<br>        <span class="hljs-comment">//...</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> YearSavingAccount();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bank</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> Account account;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Bank</span><span class="hljs-params">(Account account)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.account = account;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">abstract</span> Account <span class="hljs-title">createAccount</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ABCBank</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Bank</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ABCBank</span><span class="hljs-params">(Account account)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(account);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function">Account <span class="hljs-title">createAccount</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ‰“å¼€ä¸­å›½å†œä¸šé“¶è¡Œè´¦å·ç®¡ç†ç³»ç»Ÿã€‚ã€‚ã€‚&quot;</span>);<br>        account.createAccount();<br>        <span class="hljs-keyword">return</span> account;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ICBCBank</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Bank</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ICBCBank</span><span class="hljs-params">(Account account)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(account);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function">Account <span class="hljs-title">createAccount</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ‰“å¼€ä¸­å›½å·¥å•†é“¶è¡Œè´¦å·ç®¡ç†ç³»ç»Ÿã€‚ã€‚ã€‚&quot;</span>);<br>        account.createAccount();<br>        <span class="hljs-keyword">return</span> account;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">// æ–°å»ºä¸€ä¸ªå·¥å•†é“¶è¡Œ + æœˆå­˜å‚¨è´¦å·</span><br>        Bank icbcBank = <span class="hljs-keyword">new</span> ICBCBank(<span class="hljs-keyword">new</span> MonthSavingAccount());<br>        icbcBank.createAccount();<br><br>        <span class="hljs-comment">// æ–°å»ºä¸€ä¸ªå·¥å•†é“¶è¡Œ + å¹´å­˜å‚¨è´¦å·</span><br>        Bank icbcBank2 = <span class="hljs-keyword">new</span> ICBCBank(<span class="hljs-keyword">new</span> YearSavingAccount());<br>        icbcBank2.createAccount();<br><br>        <span class="hljs-comment">// æ–°å»ºä¸€ä¸ªå†œä¸šé“¶è¡Œ + å¹´å­˜å‚¨è´¦å·</span><br>        Bank abcBank = <span class="hljs-keyword">new</span> ABCBank(<span class="hljs-keyword">new</span> YearSavingAccount());<br>        abcBank.createAccount();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>æ‰“å¼€ä¸­å›½å·¥å•†é“¶è¡Œè´¦å·ç®¡ç†ç³»ç»Ÿã€‚ã€‚ã€‚<br>æ–°å»ºä¸€ä¸ªæœˆå­˜å‚¨è´¦å·ã€‚ã€‚ã€‚<br>æ‰“å¼€ä¸­å›½å·¥å•†é“¶è¡Œè´¦å·ç®¡ç†ç³»ç»Ÿã€‚ã€‚ã€‚<br>æ–°å»ºä¸€ä¸ªå¹´å­˜å‚¨è´¦å·ã€‚ã€‚ã€‚<br>æ‰“å¼€ä¸­å›½å†œä¸šé“¶è¡Œè´¦å·ç®¡ç†ç³»ç»Ÿã€‚ã€‚ã€‚<br>æ–°å»ºä¸€ä¸ªå¹´å­˜å‚¨è´¦å·ã€‚ã€‚ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç»„åˆæ¨¡å¼</title>
    <link href="/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a>1 æ¦‚å¿µ</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a>1 å®šä¹‰</h2><p>å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†â€”â€”æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„</p><p>ç»„åˆæ¨¡å¼ä½¿å®¢æˆ·ç«¯å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡ä¿æŒä¸€è‡´çš„å¤„ç†æ–¹å¼</p><p>ç±»å‹ï¼šç»“æ„å‹</p><h2 id="2-é€‚ç”¨åœºæ™¯"><a href="#2-é€‚ç”¨åœºæ™¯" class="headerlink" title="2 é€‚ç”¨åœºæ™¯"></a>2 é€‚ç”¨åœºæ™¯</h2><ul><li>å¸Œæœ›å®¢æˆ·ç«¯å¯ä»¥å¿½ç•¥ç»„åˆå¯¹è±¡å’Œå•ä¸ªå¯¹è±¡ä¹‹å‰çš„å·®å¼‚</li><li>å¤„ç†æ ‘å½¢ç»“æ„æ—¶</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a>3 ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹</p><ul><li>è®©å®¢æˆ·ç«¯å¿½ç•¥äº†å±‚æ¬¡çš„å·®å¼‚ï¼Œæ–¹ä¾¿å¯¹æ•´ä¸ªå±‚æ¬¡è¿›è¡Œæ§åˆ¶ã€‚ç®€åŒ–å®¢æˆ·ç«¯ä»£ç </li><li>ç¬¦åˆå¼€é—­åŸåˆ™</li></ul><p>ç¼ºç‚¹</p><ul><li>ä½¿è®¾è®¡å˜å¾—æŠ½è±¡</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a>2 ä»£ç å®ç°</h1><p>åœºæ™¯ï¼šæ‰“å°è¯¾ç¨‹ç›®å½•å’Œè¯¾ç¨‹çš„å±‚æ¬¡å…³ç³»ã€‚è¯¾ç¨‹çš„ä¸»ç›®å½•åŒ…æ‹¬è¯¾ç¨‹ç›®å½•å’Œè¯¾ç¨‹ã€‚</p><p>æœ‰äº›è¯¾ç¨‹å±äºæŸä¸ªå­ç›®å½•ä¸‹ï¼Œæœ‰äº›æ— æ³•å½’ç±»åˆ°å­ç›®å½•ï¼Œç›´å±äºä¸»ç›®å½•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ç›®å½•ç»„ä»¶</span><br><span class="hljs-comment"> *      ç›®å½• å’Œ ä¹¦ç± éƒ½ç»§æ‰¿ CatalogComponent æ¥å£</span><br><span class="hljs-comment"> *      å­ç±»æ ¹æ®å½“å‰çš„çš„ç±»å‹ , é€‰æ‹©æ€§é‡å†™æ¥å£</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CatalogComponent</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(CatalogComponent catalogComponent)</span></span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> UnsupportedOperationException(<span class="hljs-string">&quot;ä¸æ”¯æŒæ·»åŠ æ“ä½œ&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">(CatalogComponent catalogComponent)</span></span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> UnsupportedOperationException(<span class="hljs-string">&quot;ä¸æ”¯æŒè·å–åç§°æ“ä½œ&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> UnsupportedOperationException(<span class="hljs-string">&quot;ä¸æ”¯æŒæ‰“å°æ“ä½œ&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Course</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatalogComponent</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> price;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Course</span><span class="hljs-params">(String name, <span class="hljs-keyword">double</span> price)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.price = price;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">(CatalogComponent catalogComponent)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getPrice</span><span class="hljs-params">(CatalogComponent catalogComponent)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.price;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Course Name:&quot;</span>+name+<span class="hljs-string">&quot; Price:&quot;</span>+price);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Catalog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatalogComponent</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> List&lt;CatalogComponent&gt; items = <span class="hljs-keyword">new</span> ArrayList&lt;CatalogComponent&gt;();<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer level;<br><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Catalog</span><span class="hljs-params">(String name, Integer level)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.level = level;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(CatalogComponent catalogComponent)</span> </span>&#123;<br>        items.add(catalogComponent);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">(CatalogComponent catalogComponent)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-keyword">this</span>.name);<br>        <span class="hljs-keyword">for</span>(CatalogComponent catalogComponent : items)&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.level != <span class="hljs-keyword">null</span>)&#123;<br>                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span>  i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.level; i++)&#123;<br>                    System.out.print(<span class="hljs-string">&quot;  &quot;</span>);<br>                &#125;<br>            &#125;<br>            catalogComponent.print();<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        CatalogComponent linuxCourse = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;Linuxè¯¾ç¨‹&quot;</span>,<span class="hljs-number">11</span>);<br>        CatalogComponent windowsCourse = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;Windowsè¯¾ç¨‹&quot;</span>,<span class="hljs-number">11</span>);<br><br>        CatalogComponent javaCourseCatalog = <span class="hljs-keyword">new</span> Catalog(<span class="hljs-string">&quot;Javaè¯¾ç¨‹ç›®å½•&quot;</span>,<span class="hljs-number">2</span>);<br><br>        CatalogComponent mmallCourse1 = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;Javaç”µå•†ä¸€æœŸ&quot;</span>,<span class="hljs-number">55</span>);<br>        CatalogComponent mmallCourse2 = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;Javaç”µå•†äºŒæœŸ&quot;</span>,<span class="hljs-number">66</span>);<br>        CatalogComponent designPattern = <span class="hljs-keyword">new</span> Course(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼&quot;</span>,<span class="hljs-number">77</span>);<br><br>        javaCourseCatalog.add(mmallCourse1);<br>        javaCourseCatalog.add(mmallCourse2);<br>        javaCourseCatalog.add(designPattern);<br><br>        CatalogComponent mainCourseCatalog = <span class="hljs-keyword">new</span> Catalog(<span class="hljs-string">&quot;è¯¾ç¨‹ä¸»ç›®å½•&quot;</span>,<span class="hljs-number">1</span>);<br>        mainCourseCatalog.add(linuxCourse);<br>        mainCourseCatalog.add(windowsCourse);<br>        mainCourseCatalog.add(javaCourseCatalog);<br><br>        mainCourseCatalog.print();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231004141724348.png" alt="image-20231004141724348" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>äº«å…ƒæ¨¡å¼</title>
    <link href="/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a>1 æ¦‚å¿µ</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h2><p>â€œäº«â€å°±è¡¨ç¤ºå…±äº«ï¼Œâ€œå…ƒâ€è¡¨ç¤ºå¯¹è±¡ã€‚å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­å­˜åœ¨å¤šä¸ªç›¸åŒçš„å¯¹è±¡ï¼Œé‚£ä¹ˆåªéœ€è¦å…±äº«ä¸€ä»½å¯¹è±¡çš„æ‹·è´,è€Œä¸å¿…ä¸ºæ¯ä¸€æ¬¡ä½¿ç”¨éƒ½åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ç›®çš„æ˜¯å‡å°‘å¯¹è±¡åˆ›å»ºï¼Œå‡å°‘å†…å­˜å ç”¨ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚</p><p>ç±»å‹ï¼šç»“æ„å‹</p><blockquote><p>æ¯”å¦‚ï¼šå»å›¾ä¹¦é¦†å€Ÿä¹¦ï¼Œå¦‚æœä¹¦æ¶ä¸Šæœ‰è¿™æœ¬ä¹¦ç›´æ¥æ‹¿èµ°ï¼Œåˆ°å€Ÿé˜…æœºä¸Šå€Ÿé˜…å°±å¥½äº†ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥åˆ°å›¾ä¹¦ç®¡ç†å¤„å»æ‹¿ä¸€æœ¬æ–°ä¹¦ã€‚å¯¹äºæ•´ä¸ªå›¾ä¹¦é¦†æ¥è¯´ï¼Œä¹¦å…¶å®å°±æ˜¯å…±äº«çš„ã€‚å¯¹äºæˆ‘ä»¬å€Ÿä¹¦çš„æµç¨‹å’Œå›¾ä¹¦å…±äº«çš„æ–¹å¼å°±æ˜¯äº«å…ƒæ¨¡å¼ã€‚</p></blockquote><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a>2 åº”ç”¨åœºæ™¯</h2><ul><li>ç³»ç»Ÿåº•å±‚å¼€å‘ã€‚æ¯”å¦‚Javaçš„stringç±»å‹ï¼Œå¦‚æœæœ‰åˆ™è¿”å›ï¼Œæ²¡æœ‰åˆ™åˆ›å»ºä¸€ä¸ªï¼Œä¿å­˜åœ¨å­—ç¬¦ä¸²ç¼“å­˜æ± é‡Œï¼›æ•°æ®åº“è¿æ¥æ± ã€‚</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a>3 ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>å‡å°‘å¯¹è±¡åˆ›å»ºï¼Œå‡å°‘å†…å­˜å ç”¨ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li><p>å…³æ³¨å†…å¤–éƒ¨çŠ¶æ€ï¼Œå…³æ³¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ä¸€èˆ¬æˆ‘ä»¬éƒ½ç”¨çš„HashMap,çº¿ç¨‹å®‰å…¨å¯ä»¥ä½¿ç”¨hashTable,æå‡æ•ˆç‡å¯ä»¥concurentHashMap</p></li><li><p>æé«˜äº†ç³»ç»Ÿçš„å¤æ‚åº¦</p></li></ul><h2 id="4-ä¸»è¦è§’è‰²"><a href="#4-ä¸»è¦è§’è‰²" class="headerlink" title="4 ä¸»è¦è§’è‰²"></a>4 ä¸»è¦è§’è‰²</h2><ul><li>æŠ½è±¡äº«å…ƒï¼ˆBookï¼‰ï¼šå®šä¹‰éœ€è¦å…±äº«çš„å¯¹è±¡ä¸šåŠ¡æ¥å£ã€‚äº«å…ƒç±»è¢«åˆ›å»ºå‡ºæ¥æ€»æ˜¯ä¸ºäº†å®ç°æŸäº›ç‰¹å®šçš„ä¸šåŠ¡é€»è¾‘.</li><li>å…·ä½“äº«å…ƒï¼ˆConcreteBookï¼‰ï¼šå®ç°æŠ½è±¡äº«å…ƒç±»çš„æ¥å£ï¼Œå®ŒæˆæŸä¸€å…·ä½“é€»è¾‘ã€‚åœ¨è¿™é‡Œè¡¨ç¤ºå¯ä»¥è¢«å€Ÿå‡ºã€‚</li><li>äº«å…ƒå·¥å‚ï¼ˆLlibraryï¼‰ï¼šç”¨äºåˆ›å»ºå…·ä½“äº«å…ƒç±»ï¼Œç»´æŠ¤ç›¸åŒçš„äº«å…ƒå¯¹è±¡ã€‚å½“è¯·æ±‚å¯¹è±¡å·²ç»å­˜åœ¨æ—¶ï¼Œç›´æ¥è¿”å›å¯¹è±¡ï¼Œä¸å­˜åœ¨æ—¶ï¼Œåœ¨åˆ›å»ºå¯¹è±¡ã€‚åœ¨ä¾‹å­ä¸­çš„è§£é‡Šå°±æ˜¯å›¾ä¹¦é¦†ï¼Œä¿å­˜äº†æ‰€æœ‰çš„ä¹¦ï¼Œå½“å­¦ç”Ÿå€Ÿä¹¦æ—¶ï¼Œæœ‰å°±æ‹¿èµ°ï¼Œæ²¡æœ‰ä¹°ä¸€æœ¬æ–°ä¹¦ã€‚è¿™é‡Œé¢å…¶å®æ˜¯ä½¿ç”¨äº†å•ä¾‹æ¨¡å¼çš„</li></ul><blockquote><p>äº«å…ƒå·¥å‚æ˜¯äº«å…ƒæ¨¡å¼çš„æ ¸å¿ƒï¼Œå®ƒéœ€è¦ç¡®ä¿ç³»ç»Ÿå¯ä»¥å…±äº«ç›¸åŒçš„å¯¹è±¡ã€‚å®ƒä¼šç»´æŠ¤ä¸€ä¸ªå¯¹è±¡åˆ—è¡¨ï¼Œå½“æˆ‘ä»¬æƒ³è¦è·å–äº«å…ƒç±»æ—¶ï¼Œå¦‚æœè¯·æ±‚çš„äº«å…ƒç±»å·²ç»è¢«åˆ›å»ºï¼Œåˆ™ç›´æ¥è¿”å›å·²æœ‰çš„äº«å…ƒç±»ï¼šè‹¥æ²¡æœ‰ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„äº«å…ƒå¯¹è±¡ï¼Œå¹¶å°†å®ƒåŠ å…¥åˆ°ç»´æŠ¤é˜Ÿåˆ—ä¸­ã€‚</p></blockquote><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a>2 ä»£ç å®ç°</h1><p>åœºæ™¯ï¼šå»å›¾ä¹¦é¦†å€Ÿä¹¦ï¼Œå¦‚æœä¹¦æ¶ä¸Šæœ‰è¿™æœ¬ä¹¦ç›´æ¥æ‹¿èµ°ï¼Œåˆ°å€Ÿé˜…æœºä¸Šå€Ÿé˜…å°±å¥½äº†ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥åˆ°å›¾ä¹¦ç®¡ç†å¤„å»æ‹¿ä¸€æœ¬æ–°ä¹¦ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Book</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">borrow</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteBook</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Book</span> </span>&#123;<br>    <span class="hljs-comment">//è¢«å€Ÿå‡ºçš„ä¹¦å,å¤–éƒ¨çŠ¶æ€ï¼Œä¸å¯ä»¥å…±äº«çš„çŠ¶æ€ï¼Œä¼ å…¥çš„ä¹¦åä¸åŒï¼Œä¹¦ä¸åŒ</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-comment">// å†…éƒ¨çŠ¶æ€ï¼Œè¿™äº›ä¹¦éƒ½å±äºæ–°åä¹¦åº—ï¼Œå¯å…±äº«çš„çŠ¶æ€</span><br>    <span class="hljs-keyword">private</span> String librarySign = <span class="hljs-string">&quot;æ–°åä¹¦åº—&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConcreteBook</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">borrow</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å›¾ä¹¦é¦†å€Ÿå‡ºä¸€æœ¬ä¹¦ï¼Œä¹¦åä¸ºï¼š&quot;</span> + <span class="hljs-keyword">this</span>.name );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç›¸å½“äºbookFactory</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Library</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, Book&gt; BOOK_MAP = <span class="hljs-keyword">new</span> HashMap&lt;String, Book&gt;();<br><br>    <span class="hljs-comment">//å›¾ä¹¦é¦†å¤–å€Ÿå›¾ä¹¦</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Book <span class="hljs-title">borrowBook</span><span class="hljs-params">(String bookName)</span></span>&#123;<br>        <span class="hljs-comment">//å¦‚æœä¹¦æ¶æœ‰ï¼Œç›´æ¥å€Ÿå‡º</span><br>        Book   book = BOOK_MAP.get(bookName);<br>        <span class="hljs-comment">//å¦‚æœä¹¦æ¶æ²¡æœ‰ï¼Œé‚£å°±è°ƒè¿›æ¥ä¸€æœ¬æ–°ä¹¦</span><br>        <span class="hljs-keyword">if</span>(book == <span class="hljs-keyword">null</span>)&#123;<br>            book = <span class="hljs-keyword">new</span> ConcreteBook(bookName);<br>            BOOK_MAP.put(bookName, book);<br>        &#125;<br>        <span class="hljs-keyword">return</span> book;<br>    &#125;<br><br>    <span class="hljs-comment">//å›¾ä¹¦é¦†ä¹¦æ¶ä¸Šçš„ä¹¦çš„æ•°é‡</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getAllBookSize</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> BOOK_MAP.size();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String[] bookNames = &#123;<span class="hljs-string">&quot;ç™½é›ªå…¬ä¸»&quot;</span>,<span class="hljs-string">&quot;ä¸€åƒé›¶ä¸€å¤œ&quot;</span>,<span class="hljs-string">&quot;ç«çƒˆé¸Ÿ&quot;</span>,<span class="hljs-string">&quot;æµ·è’‚&quot;</span>&#125;;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> BOOK_SIZE = <span class="hljs-number">10</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; BOOK_SIZE; i++) &#123;<br>            <span class="hljs-keyword">int</span> randomIndex = <span class="hljs-keyword">new</span> Random().nextInt(bookNames.length);<br>            String bookName = bookNames[randomIndex];<br>            Book book = Library.borrowBook(bookName);<br>            book.borrow();<br>        &#125;<br>        <span class="hljs-comment">//è¾“å‡ºä¸€äº›å­¦ç”Ÿä¸€å…±å€Ÿå¤šå°‘æœ¬ä¹¦</span><br>        System.out.println(<span class="hljs-string">&quot;å­¦ç”Ÿä¸€å…±å€Ÿäº† &quot;</span> + BOOK_SIZE + <span class="hljs-string">&quot; æœ¬ä¹¦! &quot;</span>);<br>        <span class="hljs-comment">//è¾“å‡ºä¸€ä¸‹å›¾ä¹¦é¦†ä¸€å…±å€Ÿå‡ºå¤šå°‘æœ¬ä¹¦</span><br>        System.out.println(<span class="hljs-string">&quot;å›¾ä¹¦é¦†å®é™…å€Ÿå‡º&quot;</span> + Library.getAllBookSize() + <span class="hljs-string">&quot; æœ¬ä¹¦&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>å›¾ä¹¦é¦†å€Ÿå‡ºä¸€æœ¬ä¹¦ï¼Œä¹¦åä¸ºï¼šæµ·è’‚<br>å›¾ä¹¦é¦†å€Ÿå‡ºä¸€æœ¬ä¹¦ï¼Œä¹¦åä¸ºï¼šç«çƒˆé¸Ÿ<br>å›¾ä¹¦é¦†å€Ÿå‡ºä¸€æœ¬ä¹¦ï¼Œä¹¦åä¸ºï¼šä¸€åƒé›¶ä¸€å¤œ<br>å›¾ä¹¦é¦†å€Ÿå‡ºä¸€æœ¬ä¹¦ï¼Œä¹¦åä¸ºï¼šç«çƒˆé¸Ÿ<br>å›¾ä¹¦é¦†å€Ÿå‡ºä¸€æœ¬ä¹¦ï¼Œä¹¦åä¸ºï¼šç«çƒˆé¸Ÿ<br>å›¾ä¹¦é¦†å€Ÿå‡ºä¸€æœ¬ä¹¦ï¼Œä¹¦åä¸ºï¼šç™½é›ªå…¬ä¸»<br>å›¾ä¹¦é¦†å€Ÿå‡ºä¸€æœ¬ä¹¦ï¼Œä¹¦åä¸ºï¼šç™½é›ªå…¬ä¸»<br>å›¾ä¹¦é¦†å€Ÿå‡ºä¸€æœ¬ä¹¦ï¼Œä¹¦åä¸ºï¼šæµ·è’‚<br>å›¾ä¹¦é¦†å€Ÿå‡ºä¸€æœ¬ä¹¦ï¼Œä¹¦åä¸ºï¼šæµ·è’‚<br>å›¾ä¹¦é¦†å€Ÿå‡ºä¸€æœ¬ä¹¦ï¼Œä¹¦åä¸ºï¼šä¸€åƒé›¶ä¸€å¤œ<br>å­¦ç”Ÿä¸€å…±å€Ÿäº† 10 æœ¬ä¹¦!<br>å›¾ä¹¦é¦†å®é™…å€Ÿå‡º4 æœ¬ä¹¦</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>é€‚é…å™¨æ¨¡å¼</title>
    <link href="/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a>1 æ¦‚å¿µ</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a>1 å®šä¹‰</h2><p>å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·æœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£ã€‚ä½¿å¾—åŸæœ¬ä¸å…¼å®¹çš„ç±»ï¼Œå¯ä»¥ä¸€èµ·å·¥ä½œ</p><p>ç±»å‹ï¼šç»“æ„å‹</p><p>åˆ†ç±»ï¼š</p><p>å¯¹è±¡é€‚é…å™¨ï¼šä½¿ç”¨ç»„åˆ</p><p>ç±»é€‚é…å™¨ï¼šä½¿ç”¨ç±»ç»§æ‰¿</p><h2 id="2-é€‚ç”¨åœºæ™¯"><a href="#2-é€‚ç”¨åœºæ™¯" class="headerlink" title="2 é€‚ç”¨åœºæ™¯"></a>2 é€‚ç”¨åœºæ™¯</h2><ul><li>å·²ç»å­˜åœ¨çš„ç±»ï¼Œä»–çš„æ–¹æ³•å’Œéœ€æ±‚ä¸åŒ¹é…æ—¶ï¼ˆæ–¹æ³•çš„ç»“æœç›¸åŒæˆ–ç›¸ä¼¼ï¼‰</li><li>ä¸æ˜¯è½¯ä»¶è®¾è®¡é˜¶æ®µè€ƒè™‘çš„è®¾è®¡æ¨¡å¼ï¼Œæ˜¯éšç€è½¯ä»¶çš„ç»´æŠ¤ï¼Œç”±äºä¸åŒäº§å“ï¼Œä¸åŒå‚å®¶é€ æˆåŠŸèƒ½ç±»ä¼¼è€Œæ¥å£ä¸ç›¸åŒæƒ…å†µä¸‹çš„è§£å†³æ–¹æ¡ˆ</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a>3 ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>æé«˜ç±»çš„é€æ˜æ€§å’Œå¤ç”¨ï¼Œç°æœ‰çš„ç±»å¤ç”¨è€Œä¸å‘ç”Ÿæ”¹å˜</li><li>ç›®æ ‡ç±»å’Œé€‚é…å™¨ç±»è§£è€¦ï¼Œæé«˜ç¨‹åºæ‰©å±•æ€§</li><li>ç¬¦åˆå¼€é—­åŸåˆ™</li></ul><p>ç¼ºç‚¹ï¼š</p><p>å¢åŠ ä»£ç å¯è¯»æ€§çš„éš¾åº¦</p><h1 id="2-ä»£ç "><a href="#2-ä»£ç " class="headerlink" title="2 ä»£ç "></a>2 ä»£ç </h1><p>åœºæ™¯ï¼šå°†220Vç›´æµç”µï¼Œé€šè¿‡å……ç”µå™¨è½¬æ¢æˆ5Vçš„äº¤æµç”µï¼Œä»è€Œç»™æ‰‹æœºå……ç”µ</p><h2 id="2-1-ç±»é€‚é…å™¨æ¨¡å¼"><a href="#2-1-ç±»é€‚é…å™¨æ¨¡å¼" class="headerlink" title="2.1 ç±»é€‚é…å™¨æ¨¡å¼"></a>2.1 ç±»é€‚é…å™¨æ¨¡å¼</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¢«é€‚é…è€…</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AC220</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">outputAC220V</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">int</span> output = <span class="hljs-number">220</span>;<br>        System.out.println(<span class="hljs-string">&quot;è¾“å‡ºäº¤æµç”µ&quot;</span>+output+<span class="hljs-string">&quot;V&quot;</span>);<br>        <span class="hljs-keyword">return</span> output;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç›®æ ‡è¾“å‡º</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">DC5</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">outputDC5V</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é€‚é…å™¨ï¼Œä½¿è¢«é€‚é…è€…è½¬æ¢æˆç›®æ ‡ç±»ï¼Œå¹¶ä¸”æœ‰ç›®æ ‡è¾“å‡ºçš„æ¥å£æ–¹æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PowerAdapter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AC220</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">DC5</span></span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">outputDC5V</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> adapterInput = <span class="hljs-keyword">super</span>.outputAC220V();<br>        <span class="hljs-comment">//å˜å‹å™¨...</span><br>        <span class="hljs-keyword">int</span> adapterOutput = adapterInput/<span class="hljs-number">44</span>;<br>        System.out.println(<span class="hljs-string">&quot;ä½¿ç”¨PowerAdapterè¾“å…¥AC:&quot;</span>+adapterInput+<span class="hljs-string">&quot;V&quot;</span>+<span class="hljs-string">&quot;è¾“å‡ºDC:&quot;</span>+adapterOutput+<span class="hljs-string">&quot;V&quot;</span>);<br>        <span class="hljs-keyword">return</span> adapterOutput;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Target adapterTarget = <span class="hljs-keyword">new</span> Adapter();<br>        adapterTarget.request();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-2-å¯¹è±¡é€‚é…å™¨"><a href="#2-2-å¯¹è±¡é€‚é…å™¨" class="headerlink" title="2.2 å¯¹è±¡é€‚é…å™¨"></a>2.2 å¯¹è±¡é€‚é…å™¨</h2><p>åªæœ‰é€‚é…å™¨çš„ä»£ç å‘ç”Ÿäº†æ”¹å˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PowerAdapter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">DC5</span></span>&#123;<br>    <span class="hljs-comment">// è¿™é‡Œä½¿ç”¨ç»„åˆçš„æ–¹å¼ï¼Œå°†è¢«é€‚é…è€…ç»„åˆåˆ°äº†å½“å‰ç±»</span><br>    <span class="hljs-keyword">private</span> AC220 ac220 = <span class="hljs-keyword">new</span> AC220();<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">outputDC5V</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> adapterInput = ac220.outputAC220V();<br>        <span class="hljs-comment">//å˜å‹å™¨...</span><br>        <span class="hljs-keyword">int</span> adapterOutput = adapterInput/<span class="hljs-number">44</span>;<br>        System.out.println(<span class="hljs-string">&quot;ä½¿ç”¨PowerAdapterè¾“å…¥AC:&quot;</span>+adapterInput+<span class="hljs-string">&quot;V&quot;</span>+<span class="hljs-string">&quot;è¾“å‡ºDC:&quot;</span>+adapterOutput+<span class="hljs-string">&quot;V&quot;</span>);<br>        <span class="hljs-keyword">return</span> adapterOutput;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è£…é¥°å™¨æ¨¡å¼</title>
    <link href="/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1. æ¦‚å¿µ"></a>1. æ¦‚å¿µ</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h2><p>åœ¨ä¸æ”¹å˜åŸæœ‰å¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œå°†åŠŸèƒ½é™„åŠ åˆ°å¯¹è±¡ä¸Š</p><p>æä¾›äº†æ¯”ç»§æ‰¿ï¼Œæ›´æœ‰å¼¹æ€§çš„æ›¿ä»£æ–¹æ¡ˆï¼ˆæ‰©å±•åŸæœ‰å¯¹è±¡åŠŸèƒ½ï¼‰</p><p>ç±»å‹ï¼šç»“æ„å‹</p><h2 id="2-é€‚ç”¨åœºæ™¯"><a href="#2-é€‚ç”¨åœºæ™¯" class="headerlink" title="2 é€‚ç”¨åœºæ™¯"></a>2 é€‚ç”¨åœºæ™¯</h2><ul><li><p>æ‰©å±•ä¸€ä¸ªç±»çš„åŠŸèƒ½ï¼Œæˆ–è€…ç»™ä¸€ä¸ªç±»æ·»åŠ é™„åŠ èŒè´£</p></li><li><p>åŠ¨æ€çš„ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½å¯ä»¥å†åŠ¨æ€æ’¤é”€</p></li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a>3 ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹ï¼š</p><ul><li><p>ç»§æ‰¿çš„æœ‰åŠ›è¡¥å……ï¼Œæ¯”ç»§æ‰¿çµæ´»ï¼Œä¸æ”¹å˜åŸæœ‰å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ åŠŸèƒ½</p></li><li><p>é€šè¿‡ä½¿ç”¨ä¸åŒçš„è£…é¥°ç±»ä»¥åŠè¿™äº›è£…é¥°ç±»çš„æ’åˆ—ç»„åˆï¼Œå¯ä»¥å®ç°ä¸åŒçš„æ•ˆæœ</p></li><li><p>ç¬¦åˆå¼€é—­åŸåˆ™ã€‚è£…é¥°è€…å’Œè¢«è£…é¥°è€…å¯ä»¥ç‹¬ç«‹å˜åŒ–</p></li></ul><p>ç¼ºç‚¹</p><ul><li><p>ä¼šå‡ºç°æ›´å¤šçš„ä»£ç ï¼Œæ›´å¤šçš„ç±»ï¼Œå¢åŠ ç¨‹åºå¤æ‚æ€§ï¼ˆå„ç§æŠ½è±¡è£…é¥°ç±»ï¼ŒæŠ½è±¡å®ä½“ç±»ï¼‰</p></li><li><p>åŠ¨æ€è£…é¥°æ—¶ï¼Œå¤šå±‚è£…é¥°ä¼šæ›´å¤æ‚</p></li></ul><h2 id="4-ä½¿ç”¨"><a href="#4-ä½¿ç”¨" class="headerlink" title="4 ä½¿ç”¨"></a>4 ä½¿ç”¨</h2><ul><li>é€šå¸¸éœ€è¦ä¸€ä¸ªæŠ½è±¡çš„å®ä½“ç±»ï¼Œä¸€ä¸ªå…·ä½“çš„å®ä½“ç±»ã€‚ä¸€ä¸ªæŠ½è±¡çš„è£…é¥°è€…ï¼Œä¸€ä¸ªå…·ä½“çš„è£…é¥°è€…ã€‚</li><li>é€šå¸¸ä¼šå°†è¢«è£…é¥°è€…ï¼Œä»¥å‚æ•°çš„æ–¹å¼ä¼ ç»™è£…é¥°è€…çš„æ„é€ å™¨</li></ul><h1 id="2-ä»£ç "><a href="#2-ä»£ç " class="headerlink" title="2 ä»£ç "></a>2 ä»£ç </h1><p>ä¸šåŠ¡åœºæ™¯ï¼šçƒ§çƒ¤åº—è€æ¿åˆ¶ä½œç…é¥¼ï¼Œæœ‰äººåŠ ä¸€ä¸ªé¸¡è›‹ï¼Œä¸€ä¸ªè‚ ã€‚æœ‰äººåŠ ä¸¤ä¸ªé¸¡è›‹ä¸€ä¸ªè‚ </p><p>å®ä½“ï¼šç…é¥¼</p><p>è£…é¥°è€…ï¼šé¸¡è›‹ï¼Œé¦™è‚ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ABattercake</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> String <span class="hljs-title">getDesc</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">int</span> <span class="hljs-title">cost</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Battercake</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ABattercake</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> String <span class="hljs-title">getDesc</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ç…é¥¼&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-title">cost</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">8</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractDecorator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ABattercake</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> ABattercake aBattercake;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AbstractDecorator</span><span class="hljs-params">(ABattercake aBattercake)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.aBattercake = aBattercake;<br>    &#125;<br><br>  <span class="hljs-comment">// åœ¨åˆ¶ä½œç…é¥¼å’Œé¦™è‚ æ—¶éœ€è¦çš„ä¸€äº›é¢å¤–çš„æ“ä½œ</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doSomething</span><span class="hljs-params">()</span></span>;<br>  <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> String <span class="hljs-title">getDesc</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.aBattercake.getDesc();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-title">cost</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.aBattercake.cost();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EggDecorator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractDecorator</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">EggDecorator</span><span class="hljs-params">(ABattercake aBattercake)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(aBattercake);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doSomething</span><span class="hljs-params">()</span> </span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> String <span class="hljs-title">getDesc</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.getDesc()+<span class="hljs-string">&quot; åŠ ä¸€ä¸ªé¸¡è›‹&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-title">cost</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.cost()+<span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SausageDecorator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractDecorator</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SausageDecorator</span><span class="hljs-params">(ABattercake aBattercake)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(aBattercake);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doSomething</span><span class="hljs-params">()</span> </span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> String <span class="hljs-title">getDesc</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.getDesc()+<span class="hljs-string">&quot; åŠ ä¸€æ ¹é¦™è‚ &quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-title">cost</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.cost()+<span class="hljs-number">2</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ABattercake aBattercake;<br>        aBattercake = <span class="hljs-keyword">new</span> Battercake();<br>        <span class="hljs-comment">// åŠ ä¸€ä¸ªé¸¡è›‹</span><br>        aBattercake = <span class="hljs-keyword">new</span> EggDecorator(aBattercake);<br>        <span class="hljs-comment">// åŠ ä¸€ä¸ªé¸¡è›‹</span><br>        aBattercake = <span class="hljs-keyword">new</span> EggDecorator(aBattercake);<br>        <span class="hljs-comment">// åŠ ä¸€æ ¹é¦™è‚ </span><br>        aBattercake = <span class="hljs-keyword">new</span> SausageDecorator(aBattercake);<br><br>        System.out.println(aBattercake.getDesc()+<span class="hljs-string">&quot; é”€å”®ä»·æ ¼:&quot;</span>+aBattercake.cost());<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼šç…é¥¼ åŠ ä¸€ä¸ªé¸¡è›‹ åŠ ä¸€ä¸ªé¸¡è›‹ åŠ ä¸€æ ¹é¦™è‚  é”€å”®ä»·æ ¼:12</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¤–è§‚æ¨¡å¼</title>
    <link href="/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a>1 æ¦‚å¿µ</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a>1 å®šä¹‰</h2><p>å¤–è§‚æ¨¡å¼ï¼ˆFacade Patternï¼‰ï¼šåˆå«é—¨é¢æ¨¡å¼ï¼Œå¼•å…¥ä¸€ä¸ªå¤–è§‚è§’è‰²æ¥ç®€åŒ–è°ƒç”¨è€…ä¸å„ä¸ªå­ç³»ç»Ÿä¹‹é—´çš„äº¤äº’ï¼Œå‘å®¢æˆ·ç«¯æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æ¥å£ã€‚</p><p>ç±»å‹ï¼š ç»“æ„å‹</p><h2 id="2-é€‚ç”¨åœºæ™¯"><a href="#2-é€‚ç”¨åœºæ™¯" class="headerlink" title="2 é€‚ç”¨åœºæ™¯"></a>2 é€‚ç”¨åœºæ™¯</h2><ul><li>å½“è°ƒç”¨è€…éœ€è¦è°ƒç”¨å¤šä¸ªå­ç³»ç»Ÿæ¥å®Œæˆè‡ªå·±çš„é€»è¾‘</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a>3 ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>ç»™å„ä¸ªå­ç³»ç»Ÿæä¾›ç»Ÿä¸€çš„å…¥å£ï¼Œæ— éœ€æ·±å…¥äº†è§£å­ç³»ç»Ÿï¼Œè°ƒç”¨è€…ä½¿ç”¨èµ·æ¥å¾ˆç®€å•</li><li>æŠŠå„ä¸ªå­ç³»ç»Ÿå’Œè°ƒç”¨è€…è§£è€¦ï¼Œæ‰©å±•æ€§ä¼šæ›´å¥½</li><li>æ›´å¥½çš„åˆ’åˆ†è®¿é—®å±‚æ¬¡ã€‚æœ‰äº›å­æ–¹æ³•æ˜¯ä¸éœ€è¦æš´éœ²ç»™å¤–éƒ¨çš„ï¼Œæœ‰äº›æ˜¯éœ€è¦çš„ã€‚æˆ‘ä»¬æŠŠéœ€è¦æš´éœ²çš„æ–¹æ³•ï¼Œé›†æˆåœ¨å¤–è§‚ç±»ä¸Š</li><li>ç¬¦åˆè¿ªç±³ç‰¹æ³•åˆ™ï¼Œå³æœ€å°çŸ¥é“æ³•åˆ™ã€‚å®¢æˆ·ç«¯åªéœ€è¦å’Œå¤–è§‚ç±»è¿›è¡Œäº¤äº’ï¼Œä¸éœ€è¦å’Œå­ç³»ç»Ÿè¿›è¡Œäº¤äº’</li></ul><p>ç¼ºç‚¹ï¼š</p><p>å¦‚æœè®¾è®¡ä¸åˆç†ï¼Œå¢åŠ æ–°çš„å­ç³»ç»Ÿæ—¶å¯èƒ½éœ€è¦ä¿®æ”¹å¤–è§‚ç±»æˆ–è°ƒç”¨è€…çš„æºä»£ç ï¼Œè¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€</p><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a>2 ä»£ç å®ç°</h1><p>åœºæ™¯ï¼šç§¯åˆ†å•†åŸï¼Œæ ¹æ®å·²æœ‰ç§¯åˆ†è´­ä¹°å•†å“ã€‚æ¶‰åŠåˆ°çš„å­ç³»ç»Ÿä¸ºï¼šç§¯åˆ†æ ¡éªŒç³»ç»Ÿï¼Œæ”¯ä»˜ç³»ç»Ÿï¼Œç‰©æµç³»ç»Ÿ.</p><p>è°ƒç”¨è€…ä¸éœ€è¦çŸ¥é“æ ¡éªŒï¼Œæ”¯ä»˜ï¼Œç‰©æµçš„æƒ…å†µï¼Œåªéœ€è¦çŸ¥é“è¦ä½¿ç”¨ç§¯åˆ†ï¼Œå…‘æ¢å“ªä¸ªå•†å“å³å¯ï¼Œæ‰€ä»¥æ„å»ºç§¯åˆ†å…‘æ¢ç±»ï¼Œä½¿è°ƒç”¨è€…ç›´æ¥ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PointsGift</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PointsGift</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QualifyService</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isAvailable</span><span class="hljs-params">(PointsGift pointsGift)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ ¡éªŒ&quot;</span>+pointsGift.getName()+<span class="hljs-string">&quot; ç§¯åˆ†èµ„æ ¼é€šè¿‡,åº“å­˜é€šè¿‡&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PointsPaymentService</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">pay</span><span class="hljs-params">(PointsGift pointsGift)</span></span>&#123;<br>        <span class="hljs-comment">//æ‰£å‡ç§¯åˆ†</span><br>        System.out.println(<span class="hljs-string">&quot;æ”¯ä»˜&quot;</span>+pointsGift.getName()+<span class="hljs-string">&quot; ç§¯åˆ†æˆåŠŸ&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShippingService</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">shipGift</span><span class="hljs-params">(PointsGift pointsGift)</span></span>&#123;<br>        <span class="hljs-comment">//ç‰©æµç³»ç»Ÿçš„å¯¹æ¥é€»è¾‘</span><br>        System.out.println(pointsGift.getName()+<span class="hljs-string">&quot;è¿›å…¥ç‰©æµç³»ç»Ÿ&quot;</span>);<br>        String shippingOrderNo = <span class="hljs-string">&quot;666&quot;</span>;<br>        <span class="hljs-keyword">return</span> shippingOrderNo;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GiftExchangeService</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> QualifyService qualifyService = <span class="hljs-keyword">new</span> QualifyService();<br>    <span class="hljs-keyword">private</span> PointsPaymentService pointsPaymentService = <span class="hljs-keyword">new</span> PointsPaymentService();<br>    <span class="hljs-keyword">private</span> ShippingService shippingService = <span class="hljs-keyword">new</span> ShippingService();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">giftExchange</span><span class="hljs-params">(PointsGift pointsGift)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(qualifyService.isAvailable(pointsGift))&#123;<br>            <span class="hljs-comment">//èµ„æ ¼æ ¡éªŒé€šè¿‡</span><br>            <span class="hljs-keyword">if</span>(pointsPaymentService.pay(pointsGift))&#123;<br>                <span class="hljs-comment">//å¦‚æœæ”¯ä»˜ç§¯åˆ†æˆåŠŸ</span><br>                String shippingOrderNo = shippingService.shipGift(pointsGift);<br>                System.out.println(<span class="hljs-string">&quot;ç‰©æµç³»ç»Ÿä¸‹å•æˆåŠŸ,è®¢å•å·æ˜¯:&quot;</span>+shippingOrderNo);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        PointsGift pointsGift = <span class="hljs-keyword">new</span> PointsGift(<span class="hljs-string">&quot;Tæ¤&quot;</span>);<br>        GiftExchangeService giftExchangeService = <span class="hljs-keyword">new</span> GiftExchangeService();<br>        giftExchangeService.giftExchange(pointsGift);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>docker+jenkinså®ç°SpringBooté¡¹ç›®è‡ªåŠ¨åŒ–éƒ¨ç½²</title>
    <link href="/docker+jenkins%E5%AE%9E%E7%8E%B0SpringBoot%E9%A1%B9%E7%9B%AE%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/"/>
    <url>/docker+jenkins%E5%AE%9E%E7%8E%B0SpringBoot%E9%A1%B9%E7%9B%AE%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/</url>
    
    <content type="html"><![CDATA[<h1 id="1-èƒŒæ™¯"><a href="#1-èƒŒæ™¯" class="headerlink" title="1 èƒŒæ™¯"></a>1 èƒŒæ™¯</h1><p>å½“å‰æœ‰ä¸€ä¸ªå¾®æœåŠ¡é¡¹ç›®ï¼Œå…±åŒ…å«4ä¸ªå¸¸ç”¨çš„å¾®æœåŠ¡å­é¡¹ç›®ï¼ŒåŸå§‹é¡¹ç›®å‡çº§æ–¹å¼ä¸º:</p><ol><li>ä¿®æ”¹application.ymlæ–‡ä»¶ï¼Œprofileä¸ºproduct</li><li>åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šæ‰‹åŠ¨åˆ©ç”¨mavenæ‰“åŒ…ï¼Œåˆ†ä¸ºclean, package</li><li>åˆ†åˆ«è¿›å…¥4ä¸ªé¡¹ç›®çš„targetç›®å½•ä¸‹ï¼Œå°†æ‰“å¥½çš„jaråŒ…æ‹·è´å‡ºæ¥ã€‚</li><li>å°†æœ¬æœºæ‹·è´å‡ºæ¥çš„4ä¸ªjaråŒ…ä¸Šä¼ åˆ°è·³æ¿æœºä¸Š</li><li>å°†ä¸Šä¼ åˆ°è·³ç­æœºä¸Šçš„4ä¸ªjaråŒ…æ‹·è´å‡ºæ¥ï¼Œä¼ åˆ°å®¢æˆ·æœåŠ¡å™¨ä¸Šçš„æŒ‡å®šç›®å½•</li><li>åœ¨æœåŠ¡å™¨ä¸Šä¾æ¬¡æ‰§è¡Œjps -lï¼ˆåˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„Javaè¿›ç¨‹å’Œå®ƒä»¬çš„è¿›ç¨‹PIDï¼‰ï¼Œkill -9 , jar -jar xxx.jarå‘½ä»¤</li><li>å†æ¬¡æ‰§è¡Œjps -lï¼ŒæŸ¥çœ‹æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨</li></ol><p>æµç¨‹ä¸ä»…å¤æ‚ï¼Œè€Œä¸”è€—è´¹æ—¶é—´ï¼Œæ‰€ä»¥è€ƒè™‘è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œæ¥ç®€åŒ–è¿™ä¸€ä½“ç³»æµç¨‹</p><h1 id="2-åŸç†"><a href="#2-åŸç†" class="headerlink" title="2 åŸç†"></a>2 åŸç†</h1><ol><li><p>ä»gitä»“åº“æ‹‰å–æœ€æ–°ä»£ç </p></li><li><p>åˆ©ç”¨mavenæ‰§è¡Œclean , packageæ“ä½œï¼Œè¿›è¡Œæ‰“åŒ…</p></li><li><p>æ‰“åŒ…ç»“æœé€šçŸ¥åˆ°é£ä¹¦ï¼ˆå¯æœ‰å¯æ— ï¼‰</p></li><li><p>å°†æ‰“å¥½çš„jaråŒ…ï¼Œå‘é€åˆ°æŒ‡å®šæœåŠ¡å™¨ä¸Š</p></li><li><p>æ‰§è¡Œéƒ¨ç½²è„šæœ¬ åŒ…æ‹¬kill -9 , jar -jar xxx.jar</p></li></ol><h1 id="3-å…·ä½“æ­¥éª¤"><a href="#3-å…·ä½“æ­¥éª¤" class="headerlink" title="3 å…·ä½“æ­¥éª¤"></a>3 å…·ä½“æ­¥éª¤</h1><h2 id="1-é…ç½®mavenå’Œjdk"><a href="#1-é…ç½®mavenå’Œjdk" class="headerlink" title="1. é…ç½®mavenå’Œjdk"></a>1. é…ç½®mavenå’Œjdk</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231005191707787.png" alt="image-20231005191707787"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231005191548704.png" alt="image-20231005191548704"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231005191644036.png" alt="image-20231005191644036"></p><h2 id="2-æ–°å»ºJob"><a href="#2-æ–°å»ºJob" class="headerlink" title="2. æ–°å»ºJob"></a>2. æ–°å»ºJob</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231005191359836.png" alt="image-20231005191359836"></p><h2 id="3-é…ç½®gitä»“åº“åœ°å€å’Œåˆ†æ”¯å"><a href="#3-é…ç½®gitä»“åº“åœ°å€å’Œåˆ†æ”¯å" class="headerlink" title="3. é…ç½®gitä»“åº“åœ°å€å’Œåˆ†æ”¯å"></a>3. é…ç½®gitä»“åº“åœ°å€å’Œåˆ†æ”¯å</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230315160535916.png" alt="img"></p><h2 id="4-é…ç½®æ„å»ºç¯å¢ƒ"><a href="#4-é…ç½®æ„å»ºç¯å¢ƒ" class="headerlink" title="4. é…ç½®æ„å»ºç¯å¢ƒ"></a>4. é…ç½®æ„å»ºç¯å¢ƒ</h2><p>æ¯æ¬¡æ„å»ºå‰åˆ é™¤å·¥ä½œç©ºé—´ï¼ˆé¿å…ç”±äºç±»è½¬ç§»ä½ç½®åï¼Œä¸¤ä¸ªä½ç½®éƒ½å­˜åœ¨ç±»ï¼Œå¼•èµ·åŒåbeanå†²çªï¼‰</p><p>æ‰“å°æ§åˆ¶å°è¾“å‡ºæ—¶é—´æˆ³ï¼Œä¾¿äºè§‚å¯Ÿæ„å»ºè¿›åº¦</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231005191939745.png" alt="image-20231005191939745"></p><h2 id="5-é…ç½®ç¼–è¯‘ä½¿ç”¨çš„pom-xmlæ–‡ä»¶"><a href="#5-é…ç½®ç¼–è¯‘ä½¿ç”¨çš„pom-xmlæ–‡ä»¶" class="headerlink" title="5 é…ç½®ç¼–è¯‘ä½¿ç”¨çš„pom.xmlæ–‡ä»¶"></a>5 é…ç½®ç¼–è¯‘ä½¿ç”¨çš„pom.xmlæ–‡ä»¶</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231005192206486.png" alt="image-20231005192206486"></p><h2 id="6-é…ç½®ç»™é£ä¹¦å‘é€é€šçŸ¥"><a href="#6-é…ç½®ç»™é£ä¹¦å‘é€é€šçŸ¥" class="headerlink" title="6 é…ç½®ç»™é£ä¹¦å‘é€é€šçŸ¥"></a>6 é…ç½®ç»™é£ä¹¦å‘é€é€šçŸ¥</h2><p>ç”±äºä¸è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥éƒ½éœ€è¦ç»™é£ä¹¦å‘é€é€šçŸ¥ï¼Œè¿™é‡Œä½¿ç”¨äº†<strong>Post build task</strong> æ’ä»¶</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231005192341444.png" alt="image-20231005192341444"></p><p>feishu.sh:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#ï¼/bin/bash</span><br>jobName=<span class="hljs-variable">$JOB_BASE_NAME</span><br>json=$(curl -u admin:password https://xxx.com.cn/jenkins/job/<span class="hljs-variable">$jobName</span>/<span class="hljs-variable">$&#123;BUILD_NUMBER&#125;</span>/api/json)<br>state=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$json</span> | sed <span class="hljs-string">&#x27;s/,/\n/g&#x27;</span> | grep <span class="hljs-string">&quot;result&quot;</span> | sed <span class="hljs-string">&#x27;s/:/\n/g&#x27;</span> | sed <span class="hljs-string">&#x27;1d&#x27;</span> | sed <span class="hljs-string">&#x27;s/&#125;//g&#x27;</span>)<br>nowTime=$(TZ=UTC-8 date +%Y-%m-%d<span class="hljs-string">&quot; &quot;</span>%H:%M:%S)<br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$&#123;state&#125;</span> == <span class="hljs-string">&quot;\&quot;SUCCESS\&quot;&quot;</span> ] ; <span class="hljs-keyword">then</span> stateText=<span class="hljs-string">&quot;æˆåŠŸ&quot;</span>; <span class="hljs-keyword">else</span> stateText=<span class="hljs-string">&quot;å¤±è´¥&quot;</span>; <span class="hljs-keyword">fi</span><br>curl -X POST -H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span> \<br>        -d <span class="hljs-string">&#x27;&#123;&quot;msg_type&quot;:&quot;post&quot;,&quot;content&quot;: &#123;&quot;post&quot;: &#123;&quot;zh_cn&quot;: &#123;&quot;title&quot;: &quot;jenkinsæ„å»ºæŠ¥å‘Š&quot;,&quot;content&quot;: [[&#123;&quot;tag&quot;: &quot;text&quot;,&quot;text&quot;: &quot;&#x27;</span><span class="hljs-string">&quot;å  ç§°ï¼š<span class="hljs-variable">$jobName</span>\nç¼–  å·ï¼š<span class="hljs-variable">$&#123;BUILD_NUMBER&#125;</span>\nçŠ¶  æ€:  <span class="hljs-variable">$stateText</span>\næ—¶  é—´:  <span class="hljs-variable">$nowTime</span>\nè¯¦  æƒ…:  https://xxx.com.cn/jenkins/job/<span class="hljs-variable">$jobName</span>/<span class="hljs-variable">$&#123;BUILD_NUMBER&#125;</span>/console\næ—¥  å¿—ï¼šhttps://b1ortdxsoc.feishu.cn/wiki/RbAowYec2iUw72kWlJocapX8n2f&quot;</span><span class="hljs-string">&#x27;&quot;&#125;]]&#125; &#125; &#125;&#125;&#x27;</span> \<br>https://open.feishu.cn/open-apis/bot/v2/hook/ffb88764-379c-4a98-8496-b1a713114f3<br></code></pre></td></tr></table></figure><p>é£ä¹¦æ”¶åˆ°çš„æ ¼å¼ä¸ºï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231005192946100.png" alt="image-20231005192946100"></p><h2 id="7-æ¯ä¸ªå¾®æœåŠ¡å•ç‹¬å»ºä¸€ä¸ªæ‰§è¡Œjob"><a href="#7-æ¯ä¸ªå¾®æœåŠ¡å•ç‹¬å»ºä¸€ä¸ªæ‰§è¡Œjob" class="headerlink" title="7 æ¯ä¸ªå¾®æœåŠ¡å•ç‹¬å»ºä¸€ä¸ªæ‰§è¡Œjob"></a>7 æ¯ä¸ªå¾®æœåŠ¡å•ç‹¬å»ºä¸€ä¸ªæ‰§è¡Œjob</h2><p>é…ç½®è¿è¡Œè¿™ä¸ªjobæ—¶ï¼Œå°†æ„å»ºå¥½çš„jaråŒ…ä¸Šä¼ åˆ°å®¢æˆ·æœåŠ¡å™¨ä¸Šï¼Œå¹¶ä¸”æ‰§è¡Œéƒ¨ç½²è„šæœ¬</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231005193534214.png" alt="image-20231005193534214"></p><p>deploy.shï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">source</span> /etc/profile<br>java -version<br>BUILD_ID=dontKillMe<br><span class="hljs-built_in">export</span> TERM=xterm<br>CURRENT_TIMESTAMP=$(date +%s)<br>NOW=$(date -d @<span class="hljs-variable">$CURRENT_TIMESTAMP</span> <span class="hljs-string">&quot;+%Y-%m-%d_%H-%M-%S&quot;</span>)<br>jar=<span class="hljs-variable">$1</span>-1.0.0-SNAPSHOT.jar<br>cp <span class="hljs-variable">$jar</span> <span class="hljs-variable">$1</span>-<span class="hljs-variable">$NOW</span>.jar<br>jar=`ls <span class="hljs-variable">$1</span>*.jar |sort -r|head -n 1`<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$jar</span><br><br>profile_active=sithMes<br><span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$2</span>&quot;</span> ]<br><span class="hljs-keyword">then</span><br>    profile_active=<span class="hljs-variable">$2</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;set profile_active: <span class="hljs-variable">$profile_active</span>&quot;</span><br><span class="hljs-keyword">fi</span><br><br>log_output=/dev/null<br><span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$3</span>&quot;</span> ]<br><span class="hljs-keyword">then</span><br>    log_output=<span class="hljs-variable">$3</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;set log_output: <span class="hljs-variable">$log_output</span>&quot;</span><br><span class="hljs-keyword">fi</span><br><br>ps -ef | grep java | grep <span class="hljs-variable">$1</span> | grep -v grep | awk <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span> | xargs <span class="hljs-built_in">kill</span> -9<br>nohup java -jar <span class="hljs-variable">$jar</span> --spring.profiles.active=<span class="hljs-variable">$profile_active</span> &gt;<span class="hljs-variable">$log_output</span> 2&gt;&amp;1 &amp;<br>sleep 30<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">test</span> $(pgrep -f <span class="hljs-variable">$jar</span>|wc -l) -eq 0<br><span class="hljs-keyword">then</span><br>   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Start Failed&quot;</span><br>   <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">else</span><br>   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Start Success&quot;</span><br><span class="hljs-keyword">fi</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;============================== æ‰§è¡Œ top | head -50 =====================&#x27;</span><br><br>top -b| head -40<br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;================================== æ‰§è¡Œ jps -l ========================&#x27;</span><br><br>jps -l<br></code></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œ æ²¡æŸ¥åˆ°jaråŒ…æ‰§è¡Œæ—¶ï¼Œæ‰§è¡Œexit 1ï¼Œä¼šæ—¶jenkinså½“å‰jobçš„çŠ¶æ€å˜æˆé»„è‰²ï¼Œè€Œä¸æ˜¯æˆåŠŸæ—¶çš„ç»¿è‰²ã€‚</p></blockquote><h1 id="4-å¸¸è§é—®é¢˜"><a href="#4-å¸¸è§é—®é¢˜" class="headerlink" title="4 å¸¸è§é—®é¢˜"></a>4 å¸¸è§é—®é¢˜</h1><h2 id="1-jenkinsè¿ç§»æ—¶éœ€è¦è¿ç§»å“ªäº›æ–‡ä»¶å¤¹ï¼Ÿ"><a href="#1-jenkinsè¿ç§»æ—¶éœ€è¦è¿ç§»å“ªäº›æ–‡ä»¶å¤¹ï¼Ÿ" class="headerlink" title="1 jenkinsè¿ç§»æ—¶éœ€è¦è¿ç§»å“ªäº›æ–‡ä»¶å¤¹ï¼Ÿ"></a>1 jenkinsè¿ç§»æ—¶éœ€è¦è¿ç§»å“ªäº›æ–‡ä»¶å¤¹ï¼Ÿ</h2><p>å°†è€æœåŠ¡å™¨<a href="https://so.csdn.net/so/search?q=jenkins&spm=1001.2101.3001.7020">jenkins</a>ä¸»ç›®å½•ä¸‹çš„config.xmlæ–‡ä»¶ä»¥åŠjobsã€usersã€workspaceã€pluginså››ä¸ªç›®å½•æ‹·è´åˆ°æ–°æœºå™¨çš„jenkinsä¸»ç›®å½•ä¸‹ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker cp /Users/panyurou/.jenkins/<span class="hljs-built_in">jobs</span>  6257c7abfa11:/var/jenkins_home/<span class="hljs-built_in">jobs</span><br></code></pre></td></tr></table></figure><h2 id="2-ä½¿ç”¨dockerå¢åŠ å‰ç¼€-x2F-jenkins"><a href="#2-ä½¿ç”¨dockerå¢åŠ å‰ç¼€-x2F-jenkins" class="headerlink" title="2 ä½¿ç”¨dockerå¢åŠ å‰ç¼€ &#x2F;jenkins"></a>2 ä½¿ç”¨dockerå¢åŠ å‰ç¼€ &#x2F;jenkins</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker pull jenkins/jenkins:2.346<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker run -d -p 8089:8080  --name jenkins4 -e JENKINS_OPTS=<span class="hljs-string">&quot;--prefix=/jenkins&quot;</span> jenkins/jenkins:2.346<br></code></pre></td></tr></table></figure><h2 id="3-æ²¡æƒé™"><a href="#3-æ²¡æƒé™" class="headerlink" title="3 æ²¡æƒé™"></a>3 æ²¡æƒé™</h2><p>æŠ¥é”™ï¼šI have experienced this when the $JENKINS_HOME&#x2F;jobs directory had incorrect permissions or ownership.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker <span class="hljs-built_in">exec</span> -it --user root 7666058a5629 bash<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">chown -R jenkins:jenkins /var/jenkins_home<br></code></pre></td></tr></table></figure><h2 id="4-SSHæœåŠ¡å™¨éªŒè¯å¤±è´¥"><a href="#4-SSHæœåŠ¡å™¨éªŒè¯å¤±è´¥" class="headerlink" title="4 SSHæœåŠ¡å™¨éªŒè¯å¤±è´¥"></a>4 SSHæœåŠ¡å™¨éªŒè¯å¤±è´¥</h2><p>æŠ¥é”™ï¼š stderr: No RSA host key is known for [xxx.xxx.xxx.xxx]:7999 and you have requested strict checking.</p><p>Manage Jenkins -&gt; Security -&gt; Configure Global Security</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231003184529837.png" alt="image-20231003184529837"></p><h2 id="5-Dockeréƒ¨ç½²jenkinsé…ç½®å…¬ç§é’¥æ‹‰å–ä»£ç "><a href="#5-Dockeréƒ¨ç½²jenkinsé…ç½®å…¬ç§é’¥æ‹‰å–ä»£ç " class="headerlink" title="5 Dockeréƒ¨ç½²jenkinsé…ç½®å…¬ç§é’¥æ‹‰å–ä»£ç "></a>5 Dockeréƒ¨ç½²jenkinsé…ç½®å…¬ç§é’¥æ‹‰å–ä»£ç </h2><p><a href="https://blog.csdn.net/weixin_38080573/article/details/128482482">https://blog.csdn.net/weixin_38080573/article/details/128482482</a></p><h2 id="6-jdkï¼Œmavenéœ€è¦é‡æ–°é…ç½®dockeré‡Œå®‰è£…çš„è·¯å¾„"><a href="#6-jdkï¼Œmavenéœ€è¦é‡æ–°é…ç½®dockeré‡Œå®‰è£…çš„è·¯å¾„" class="headerlink" title="6 jdkï¼Œmavenéœ€è¦é‡æ–°é…ç½®dockeré‡Œå®‰è£…çš„è·¯å¾„"></a>6 jdkï¼Œmavenéœ€è¦é‡æ–°é…ç½®dockeré‡Œå®‰è£…çš„è·¯å¾„</h2><p>maven settings.xml ä»“åº“éœ€è¦é…ç½®æˆdockeré‡Œçš„ä»“åº“</p><h2 id="7-è®¾ç½®å¼€æœºè‡ªå¯docker"><a href="#7-è®¾ç½®å¼€æœºè‡ªå¯docker" class="headerlink" title="7 è®¾ç½®å¼€æœºè‡ªå¯docker"></a>7 è®¾ç½®å¼€æœºè‡ªå¯docker</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">systemctl <span class="hljs-builtin-name">enable</span> docker<br></code></pre></td></tr></table></figure><h2 id="8-è®¾ç½®dockerå¯åŠ¨æ—¶ï¼Œå¯åŠ¨jenkinså®¹å™¨"><a href="#8-è®¾ç½®dockerå¯åŠ¨æ—¶ï¼Œå¯åŠ¨jenkinså®¹å™¨" class="headerlink" title="8 è®¾ç½®dockerå¯åŠ¨æ—¶ï¼Œå¯åŠ¨jenkinså®¹å™¨"></a>8 è®¾ç½®dockerå¯åŠ¨æ—¶ï¼Œå¯åŠ¨jenkinså®¹å™¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker update --restart=always jenkins<br></code></pre></td></tr></table></figure><p>âš ï¸å¦‚æœæ„å»ºçš„æ˜¯pipeline, å¯å‚è€ƒä»¥ä¸‹è„šæœ¬ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs groovy">pipeline &#123;<br>  agent any<br>  stages &#123;<br>    stage(<span class="hljs-string">&#x27;Git Pull&#x27;</span>) &#123;<br>        steps &#123;<br>            <span class="hljs-comment">// ä» Git ä»“åº“æ‹‰å–ä»£ç </span><br>            deleteDir()<br>            echo <span class="hljs-string">&quot;start fetch code from git&quot;</span><br>            git <span class="hljs-attr">branch:</span> <span class="hljs-string">&#x27;sith_mom/master&#x27;</span>, <span class="hljs-attr">credentialsId:</span> <span class="hljs-string">&#x27;sshkey-cre&#x27;</span>, <span class="hljs-attr">url:</span> <span class="hljs-string">&#x27;git@codeup.aliyun.com:61794b74d39c439da2ee88ff/SIEMENS_MMF/MMF.git&#x27;</span><br>        &#125;<br>    &#125;<br>    <br>    stage(<span class="hljs-string">&#x27;Build&#x27;</span>) &#123;<br>        steps &#123;<br>            <span class="hljs-comment">// æ‰“å°å½“å‰ Java ç‰ˆæœ¬</span><br>            sh <span class="hljs-string">&#x27;java -version&#x27;</span><br>            <span class="hljs-comment">// è®¾ç½® JAVA_HOME ç¯å¢ƒå˜é‡ä¸º JDK 1.8 çš„è·¯å¾„</span><br>            script &#123;<br>                env.JAVA_HOME = <span class="hljs-string">&#x27;/home/jdk1.8.0_381&#x27;</span><br>            &#125;<br><br>            <span class="hljs-comment">// æ‰§è¡Œ Maven ç¼–è¯‘</span><br>             sh <span class="hljs-string">&#x27;/home/apache-maven-3.6.3/bin/mvn -f mmf-backend/pom.xml -s /home/apache-maven-3.6.3/conf/my-settings.xml -gs /home/apache-maven-3.6.3/conf/my-settings.xml clean package -T 1C -Dmaven.test.skip=true -Dmaven.compile.fork=true&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;<br><br>post &#123;<br>    always &#123;<br>        script &#123;<br>            sh <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">                cd /home</span><br><span class="hljs-string">                bash feishu.sh</span><br><span class="hljs-string">             &#x27;&#x27;&#x27;</span><br>        &#125;<br>    &#125;<br>    success &#123;<br>        <span class="hljs-comment">// æ„å»ºæˆåŠŸåçš„æ“ä½œ</span><br>        echo <span class="hljs-string">&#x27;Build successful!&#x27;</span><br>    &#125;<br>    failure &#123;<br>        <span class="hljs-comment">// æ„å»ºå¤±è´¥åçš„æ“ä½œ</span><br>        echo <span class="hljs-string">&#x27;Build failed!&#x27;</span><br>    &#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ–è®¸éœ€è¦æ‰§è¡Œçš„æ“ä½œï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">chmod</span> -R <span class="hljs-number">777</span> apache-maven-<span class="hljs-number">3</span>.<span class="hljs-number">6</span>.<span class="hljs-number">3</span><br><span class="hljs-attribute">chmod</span> <span class="hljs-number">755</span> /home/jdk<span class="hljs-number">1</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>_<span class="hljs-number">381</span>/bin<br><span class="hljs-attribute">chmod</span> -R <span class="hljs-number">777</span> /home/node-v<span class="hljs-number">14</span>.<span class="hljs-number">17</span>.<span class="hljs-number">1</span>-linux-x<span class="hljs-number">64</span>/bin<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>jenkins</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸ç”¨23ç§è®¾è®¡æ¨¡å¼</title>
    <link href="/%E5%B8%B8%E7%94%A823%E7%A7%8D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E5%B8%B8%E7%94%A823%E7%A7%8D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a>1 æ¦‚å¿µ</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a>1 å®šä¹‰</h2><p><em>è®¾è®¡æ¨¡å¼æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨çš„ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚</em></p><p><strong>ä¼˜ç‚¹</strong></p><ul><li>é‡ç”¨ä»£ç </li><li>è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£</li><li>ä¿è¯ä»£ç å¯é æ€§</li></ul><h2 id="2-å…­å¤§åŸåˆ™"><a href="#2-å…­å¤§åŸåˆ™" class="headerlink" title="2 å…­å¤§åŸåˆ™"></a>2 å…­å¤§åŸåˆ™</h2><ul><li><strong>å¼€é—­åŸåˆ™</strong>ï¼š<strong>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</strong>ã€‚åœ¨ç¨‹åºéœ€è¦è¿›è¡Œæ‹“å±•çš„æ—¶å€™ï¼Œä¸èƒ½å»ä¿®æ”¹åŸæœ‰çš„ä»£ç ï¼Œå®ç°ä¸€ä¸ªçƒ­æ’æ‹”çš„æ•ˆæœã€‚</li><li><strong>é‡Œæ°ä»£æ¢åŸåˆ™</strong>ï¼šä»»ä½•åŸºç±»å¯ä»¥å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¸€å®šå¯ä»¥å‡ºç°ã€‚</li><li><strong>ä¾èµ–å€’è½¬åŸåˆ™</strong>ï¼šé’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¾èµ–äºæŠ½è±¡è€Œä¸ä¾èµ–äºå…·ä½“ã€‚</li><li><strong>æ¥å£éš”ç¦»åŸåˆ™</strong>ï¼šä½¿ç”¨å¤šä¸ªéš”ç¦»çš„æ¥å£ï¼Œæ¯”ä½¿ç”¨å•ä¸ªæ¥å£è¦å¥½ã€‚</li><li><strong>è¿ªç±³ç‰¹æ³•åˆ™</strong>ï¼šåˆç§°æœ€å°‘çŸ¥é“åŸåˆ™ã€‚ä¸€ä¸ªå®ä½“åº”å½“å°½é‡å°‘åœ°ä¸å…¶ä»–å®ä½“ä¹‹é—´å‘ç”Ÿç›¸äº’ä½œç”¨ï¼Œä½¿å¾—ç³»ç»ŸåŠŸèƒ½æ¨¡å—ç›¸å¯¹ç‹¬ç«‹ã€‚</li><li><strong>åˆæˆå¤ç”¨åŸåˆ™</strong>ï¼šå°½é‡ä½¿ç”¨åˆæˆ&#x2F;èšåˆçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿ã€‚</li></ul><h1 id="2-åˆ†ç±»"><a href="#2-åˆ†ç±»" class="headerlink" title="2 åˆ†ç±»"></a>2 åˆ†ç±»</h1><h2 id="1-åˆ›å»ºå‹æ¨¡å¼ï¼ˆäº”ç§ï¼‰"><a href="#1-åˆ›å»ºå‹æ¨¡å¼ï¼ˆäº”ç§ï¼‰" class="headerlink" title="1 åˆ›å»ºå‹æ¨¡å¼ï¼ˆäº”ç§ï¼‰"></a>1 åˆ›å»ºå‹æ¨¡å¼ï¼ˆäº”ç§ï¼‰</h2><p>è¿™äº›æ¨¡å¼æä¾›äº†ä¸€ç§åœ¨åˆ›å»ºå¯¹è±¡çš„åŒæ—¶éšè—åˆ›å»ºé€»è¾‘çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ new è¿ç®—ç¬¦ç›´æ¥å®ä¾‹åŒ–å¯¹è±¡ã€‚</p><p><a href="https://pyr9.github.io/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/">å•ä¾‹æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/">å·¥å‚æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/">æŠ½è±¡å·¥å‚æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/">å»ºé€ è€…æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/">åŸå‹æ¨¡å¼</a></p><h2 id="2-ç»“æ„å‹æ¨¡å¼ï¼ˆä¸ƒç§ï¼‰"><a href="#2-ç»“æ„å‹æ¨¡å¼ï¼ˆä¸ƒç§ï¼‰" class="headerlink" title="2. ç»“æ„å‹æ¨¡å¼ï¼ˆä¸ƒç§ï¼‰"></a>2. ç»“æ„å‹æ¨¡å¼ï¼ˆä¸ƒç§ï¼‰</h2><p>è¿™äº›æ¨¡å¼å…³æ³¨å¯¹è±¡ä¹‹é—´çš„ç»„åˆå’Œå…³ç³»ï¼Œæ—¨åœ¨è§£å†³å¦‚ä½•æ„å»ºçµæ´»ä¸”å¯å¤ç”¨çš„ç±»å’Œå¯¹è±¡ç»“æ„ã€‚</p><p><a href="https://pyr9.github.io/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/">é€‚é…å™¨æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/">è£…é¥°å™¨æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/">ä»£ç†æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/">å¤–è§‚æ¨¡å¼</a></p><p><a href="%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F">æ¡¥æ¥æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/">ç»„åˆæ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/">äº«å…ƒæ¨¡å¼</a></p><h2 id="3-è¡Œä¸ºå‹æ¨¡å¼ï¼ˆåä¸€ç§ï¼‰"><a href="#3-è¡Œä¸ºå‹æ¨¡å¼ï¼ˆåä¸€ç§ï¼‰" class="headerlink" title="3 è¡Œä¸ºå‹æ¨¡å¼ï¼ˆåä¸€ç§ï¼‰"></a>3 è¡Œä¸ºå‹æ¨¡å¼ï¼ˆåä¸€ç§ï¼‰</h2><p>è¿™äº›æ¨¡å¼å…³æ³¨å¯¹è±¡ä¹‹é—´çš„é€šä¿¡å’Œäº¤äº’ï¼Œæ—¨åœ¨è§£å†³å¯¹è±¡ä¹‹é—´çš„è´£ä»»åˆ†é…å’Œç®—æ³•çš„å°è£…ã€‚</p><p><a href="https://pyr9.github.io/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/">ç­–ç•¥æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E6%A8%A1%E7%89%88%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/">æ¨¡æ¿æ–¹æ³•æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/">è§‚å¯Ÿè€…æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/">è¿­ä»£å™¨æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/">è´£ä»»é“¾æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/">å‘½ä»¤æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/">å¤‡å¿˜å½•æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/">çŠ¶æ€æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F/">è®¿é—®è€…æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/">ä¸­ä»‹è€…æ¨¡å¼</a></p><p><a href="https://pyr9.github.io/%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F/">è§£é‡Šå™¨æ¨¡å¼</a></p><h1 id="3-å¯¹æ¯”"><a href="#3-å¯¹æ¯”" class="headerlink" title="3 å¯¹æ¯”"></a>3 å¯¹æ¯”</h1><h2 id="1-äº«å…ƒæ¨¡å¼ä¸å•ä¾‹æ¨¡å¼çš„åŒºåˆ«"><a href="#1-äº«å…ƒæ¨¡å¼ä¸å•ä¾‹æ¨¡å¼çš„åŒºåˆ«" class="headerlink" title="1 äº«å…ƒæ¨¡å¼ä¸å•ä¾‹æ¨¡å¼çš„åŒºåˆ«"></a>1 äº«å…ƒæ¨¡å¼ä¸å•ä¾‹æ¨¡å¼çš„åŒºåˆ«</h2><ul><li><p>äº«å…ƒè®¾è®¡æ¨¡å¼æ˜¯ä¸€ä¸ªç±»æœ‰å¾ˆå¤šå¯¹è±¡ï¼Œè€Œå•ä¾‹æ˜¯ä¸€ä¸ªç±»ä»…ä¸€ä¸ªå¯¹è±¡ã€‚</p></li><li><p>äº«å…ƒæ¨¡å¼æ˜¯ä¸ºäº†èŠ‚çº¦å†…å­˜ç©ºé—´ï¼Œæå‡ç¨‹åºæ€§èƒ½ï¼Œè€Œå•ä¾‹æ¨¡å¼åˆ™ä¸»è¦æ˜¯å‡ºäºå…±äº«ä¸€ä¸ªå®ä¾‹çš„ç›®çš„ã€‚</p></li></ul><h2 id="2-æ¡¥æ¥æ¨¡å¼å’Œç»„åˆæ¨¡å¼"><a href="#2-æ¡¥æ¥æ¨¡å¼å’Œç»„åˆæ¨¡å¼" class="headerlink" title="2 æ¡¥æ¥æ¨¡å¼å’Œç»„åˆæ¨¡å¼"></a>2 æ¡¥æ¥æ¨¡å¼å’Œç»„åˆæ¨¡å¼</h2><ul><li>ç»„åˆæ¨¡å¼å¼ºè°ƒéƒ¨åˆ†å’Œæ•´ä½“çš„ç»„åˆ</li><li>æ¡¥æ¥æ¨¡å¼å¼ºè°ƒå¹³è¡Œçº§åˆ«ä¸Šä¸åŒç±»çš„ç»„åˆ</li></ul><h2 id="3-æ¡¥æ¥æ¨¡å¼å’Œé€‚é…å™¨æ¨¡å¼"><a href="#3-æ¡¥æ¥æ¨¡å¼å’Œé€‚é…å™¨æ¨¡å¼" class="headerlink" title="3 æ¡¥æ¥æ¨¡å¼å’Œé€‚é…å™¨æ¨¡å¼"></a>3 æ¡¥æ¥æ¨¡å¼å’Œé€‚é…å™¨æ¨¡å¼</h2><p>å…±åŒç‚¹ï¼šéƒ½æ˜¯ä¸ºäº†è®©ä¸¤ä¸ªä¸œè¥¿é…åˆå·¥ä½œ</p><p>åŒºåˆ«</p><ul><li>é€‚é…å™¨æ˜¯æ”¹å˜å·²æœ‰çš„æ¥å£ï¼Œä½¿ä»–ä»¬å¯ä»¥é…åˆ</li><li>æ¡¥æ¥æ˜¯ä½¿ç±»çš„æŠ½è±¡å’Œå®ç°åˆ†ç¦»å¼€ï¼Œä½¿å±‚æ¬¡ç»“æ„ç»„åˆèµ·æ¥</li></ul><h2 id="4-æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼"><a href="#4-æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼" class="headerlink" title="4 æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼"></a>4 æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼</h2><ul><li>ç­–ç•¥æ¨¡å¼å¯ä»¥æ”¹å˜ç®—æ³•çš„æµç¨‹ï¼Œæ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ä¸å¯ä»¥</li></ul><h1 id="4-é¡¹ç›®ä½¿ç”¨"><a href="#4-é¡¹ç›®ä½¿ç”¨" class="headerlink" title="4 é¡¹ç›®ä½¿ç”¨"></a>4 é¡¹ç›®ä½¿ç”¨</h1><ol><li><p>å•ä¾‹æ¨¡å¼ï¼š</p><ul><li>çº¿ç¨‹æ± ï¼šExecutors.newSingleThreadExecutorç¡®ä¿åªæœ‰ä¸€ä¸ªçº¿ç¨‹å®ä¾‹åœ¨è¿è¡Œã€‚</li><li>æ•°æ®åº“è¿æ¥æ± ï¼š getInstance</li></ul></li><li><p>å·¥å‚æ¨¡å¼ï¼š</p><ul><li>å•å…ƒæµ‹è¯•é€šè¿‡UserFactoryï¼Œ åˆ›å»ºæµ‹è¯•æ•°æ®</li><li>jpaQueryFactoryåˆ›å»ºä¸€ä¸ªselectæŸ¥è¯¢</li></ul></li><li><p>å»ºé€ è€…æ¨¡å¼ï¼šlombokçš„@Builderï¼Œåˆ›å»ºå¯¹è±¡ã€‚</p></li><li><p>åŸå‹æ¨¡å¼ï¼š<code>java.lang.Cloneable</code>æ¥å£å’Œ<code>clone()</code>æ–¹æ³•ï¼ˆåŸå‹æ¨¡å¼ï¼šé€šè¿‡å…‹éš†ç°æœ‰çš„å¯¹è±¡æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ï¼‰</p></li><li><p>ä»£ç†æ¨¡å¼ï¼šAOPåˆ‡é¢ï¼Œ</p></li><li><p>æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ï¼šå®šä¹‰ç®—æ³•æ¡†æ¶ï¼Œå…è®¸å­ç±»é‡å†™æŸäº›æ­¥éª¤è€Œä¸æ”¹å˜æ•´ä½“ç»“æ„ã€‚</p><ul><li>å·¥ä½œæµï¼ŒconpleteFeedback(å®Œæˆåå›è°ƒ)ï¼Œ getProcessDefinitionKey(è·å–æµç¨‹å®šä¹‰key): åŸºç±»å®šä¹‰æ¡†æ¶ï¼Œå­ç±»å®ç°</li><li>beforeSaveTrigger&#x2F;afterSaveTrigger</li></ul></li><li><p>è§‚å¯Ÿè€…æ¨¡å¼ï¼šApplicationEventPublisher.publishEvent(aaa), @EventListener handle </p></li><li><p>è´£ä»»é“¾æ¨¡å¼ï¼šActiviti ä½¿ç”¨è´£ä»»é“¾æ¨¡å¼å¤„ç†ä»»åŠ¡åˆ†é…å’Œæµç¨‹æµè½¬ã€‚<code>Command</code> æ¥å£å®šä¹‰äº†ä¸€ç»„æ“ä½œå‘½ä»¤ï¼Œä¸åŒçš„ <code>Command</code> å®ç°ç±»è´Ÿè´£å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚å¯åŠ¨æµç¨‹ã€å®Œæˆä»»åŠ¡ï¼‰ï¼Œ<code>CommandExecutor</code> å°†å¤šä¸ªå‘½ä»¤ä¸²è”èµ·æ¥ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œã€‚</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åŸå‹æ¨¡å¼</title>
    <link href="/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a>1 æ¦‚å¿µ</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a>1 å®šä¹‰</h2><p>åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰æ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒé€šè¿‡å…‹éš†ç°æœ‰çš„å¯¹è±¡æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚éƒ¨åˆ†åœºæ™¯ä¸‹ï¼Œæ€§èƒ½è¦ä¼˜äºnewæ¥åˆ›å»ºå¯¹è±¡</p><h2 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2 åº”ç”¨åœºæ™¯"></a>2 åº”ç”¨åœºæ™¯</h2><ul><li>ç±»åˆå§‹åŒ–æ¶ˆè€—æ¯”è¾ƒå¤šçš„èµ„æº</li><li>newä¸€ä¸ªå¯¹è±¡éœ€è¦å¾ˆç¹ççš„è¿‡ç¨‹ï¼ˆæ•°æ®å‡†å¤‡ï¼Œè®¿é—®æƒé™ç­‰ï¼‰</li><li>æ„é€ å‡½æ•°æ¯”è¾ƒå¤æ‚</li><li>å¾ªç¯ä½“ä¸­äº§ç”Ÿå¤§é‡å¯¹è±¡ã€‚ï¼ˆé¿å…é‡å¤æ‰§è¡Œæ„é€ å‡½æ•°çš„æ“ä½œï¼Œä»è€Œæé«˜æ€§èƒ½å’Œæ•ˆç‡ï¼‰</li></ul><h2 id="3-ä¼˜ç¼ºç‚¹"><a href="#3-ä¼˜ç¼ºç‚¹" class="headerlink" title="3 ä¼˜ç¼ºç‚¹"></a>3 ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>ä¸éœ€è¦è°ƒç”¨æ„é€ å‡½æ•°ï¼Œæ¯”ç›´æ¥newä¸€ä¸ªå¯¹è±¡æ€§èƒ½é«˜</li><li>ç®€åŒ–åˆ›å»ºè¿‡ç¨‹</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å¿…é¡»é…å¤‡cloneæ–¹æ³•</li><li>æ·±æ‹·è´å’Œæµ…æ‹·è´å®¹æ˜“å¼•å…¥bug</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2 ä»£ç å®ç°"></a>2 ä»£ç å®ç°</h1><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>java.lang.Cloneable</code>æ¥å£å’Œ<code>clone()</code>æ–¹æ³•æ¥å®ç°åŸå‹æ¨¡å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Cloneable</span></span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Date birthday;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> Object <span class="hljs-title">clone</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.clone();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException, NoSuchMethodException, InvocationTargetException, IllegalAccessException </span>&#123;<br>        Date birthday = <span class="hljs-keyword">new</span> Date(<span class="hljs-number">0L</span>);<br>        Pig pig1 = <span class="hljs-keyword">new</span> Pig(<span class="hljs-string">&quot;ä½©å¥‡&quot;</span>,birthday);<br>        Pig pig2 = (Pig) pig1.clone();<br>        System.out.println(pig1);<br>        System.out.println(pig2);<br><br>        pig1.getBirthday().setTime(<span class="hljs-number">666666666666L</span>);<br>        System.out.println(<span class="hljs-string">&quot;==================æ›´æ–°æ—¥æœŸ====================&quot;</span>);<br><br>        System.out.println(pig1);<br>        System.out.println(pig2);<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231003175638825.png" alt="image-20231003175638825"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡<code>clone()</code>æ–¹æ³•é€šè¿‡è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„<code>Pig</code>å¯¹è±¡ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„æ·±æ‹·è´ä¸æµ…æ‹·è´çš„é—®é¢˜ã€‚</p><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœŸå¾…çš„ç»“æœæ˜¯åªæ›´æ–°pig1çš„ç”Ÿæ—¥ï¼Œä½†æ˜¯ç”±äºpig1å’Œpig2çš„ç”Ÿæ—¥æ˜¯åŒä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥pÄ«g2çš„ç”Ÿæ—¥ä¹Ÿæ›´æ–°äº†ã€‚</p><p>cloneæ–¹æ³•åšä»¥ä¸‹è°ƒæ•´ï¼Œå°†birthdayä¹Ÿè¿›è¡Œcloneï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> Object <span class="hljs-title">clone</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException </span>&#123;<br>    Pig pig = (Pig)<span class="hljs-keyword">super</span>.clone();<br>    <span class="hljs-comment">////æ·±å…‹éš†</span><br>    pig.birthday = (Date) pig.birthday.clone();<br>    <span class="hljs-keyword">return</span> pig;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="3-å…‹éš†ç ´åå•ä¾‹"><a href="#3-å…‹éš†ç ´åå•ä¾‹" class="headerlink" title="3. å…‹éš†ç ´åå•ä¾‹"></a>3. å…‹éš†ç ´åå•ä¾‹</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HungrySingleton</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Cloneable</span></span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> HungrySingleton hungrySingleton= <span class="hljs-keyword">new</span> HungrySingleton();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> HungrySingleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> hungrySingleton;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> Object <span class="hljs-title">clone</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.clone();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException, NoSuchMethodException, InvocationTargetException, IllegalAccessException </span>&#123;<br>        HungrySingleton hungrySingleton = HungrySingleton.getInstance();<br>        Method method = hungrySingleton.getClass().getDeclaredMethod(<span class="hljs-string">&quot;clone&quot;</span>);<br>        method.setAccessible(<span class="hljs-keyword">true</span>);<br>        HungrySingleton cloneHungrySingleton = (HungrySingleton) method.invoke(hungrySingleton);<br>        System.out.println(hungrySingleton);<br>        System.out.println(cloneHungrySingleton);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231003181533190.png" alt="image-20231003181533190"></p><p>è§£å†³:</p><ol><li>ä¿®æ”¹cloneæ–¹æ³•</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> Object <span class="hljs-title">clone</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException </span>&#123;<br>  <span class="hljs-keyword">return</span> getInstance();<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li>é¿å…å•ä¾‹ç±»å®ç° Cloneable</li></ol><h1 id="3-JDKçš„ä½¿ç”¨"><a href="#3-JDKçš„ä½¿ç”¨" class="headerlink" title="3. JDKçš„ä½¿ç”¨"></a>3. JDKçš„ä½¿ç”¨</h1><p>å®ç°äº†Cloneableçš„ç±»</p><ul><li>arrayList</li><li>Hashmap</li><li>Object</li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å•ä¾‹æ¨¡å¼</title>
    <link href="/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1. æ¦‚å¿µ"></a>1. æ¦‚å¿µ</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h2><ul><li><p>å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰æ˜¯ Java ä¸­æœ€ç®€å•çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚</p></li><li><p>è¿™ç§æ¨¡å¼æ¶‰åŠåˆ°ä¸€ä¸ªå•ä¸€çš„ç±»ï¼Œè¯¥ç±»è´Ÿè´£åˆ›å»ºè‡ªå·±çš„å¯¹è±¡ï¼ŒåŒæ—¶ç¡®ä¿åªæœ‰å•ä¸ªå¯¹è±¡è¢«åˆ›å»ºã€‚</p></li><li><p>è¿™ä¸ªç±»æä¾›äº†ä¸€ç§è®¿é—®å…¶å”¯ä¸€çš„å¯¹è±¡çš„æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ï¼Œä¸éœ€è¦å®ä¾‹åŒ–è¯¥ç±»çš„å¯¹è±¡ã€‚å®ƒåˆ†ä¸ºæ‡’æ±‰å¼å’Œé¥¿æ±‰å¼ã€‚æ³¨æ„ï¼š</p><ul><li><p>æ„é€ å™¨å¿…é¡»ç§æœ‰åŒ–</p></li><li><p>å¯¹å¤–å¿…é¡»è·å¾—ä¸€ä¸ªå…¬æœ‰çš„è®¿é—®æ–¹å¼æ¥è·å¾—å®ä¾‹ã€‚</p></li></ul></li></ul><h2 id="2-ä¼˜ç¼ºç‚¹"><a href="#2-ä¼˜ç¼ºç‚¹" class="headerlink" title="2 ä¼˜ç¼ºç‚¹"></a>2 ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>åœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜å¼€é”€</li><li>å¯ä»¥é¿å…å¯¹èµ„æºçš„å¤šé‡å ç”¨ï¼Œä¸ä¼šå‡ºç°å¯¹åŒä¸€ä¸ªæ–‡ä»¶åŒæ—¶è¿›è¡Œå†™æ“ä½œ</li><li>è®¾ç½®å…¨å±€è®¿é—®ç‚¹ï¼Œä¸¥æ ¼æ§åˆ¶è®¿é—®</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>æ²¡æœ‰æ¥å£ï¼Œæ‰©å±•å›°éš¾</li></ul><h1 id="2-ä»£ç å®ç°"><a href="#2-ä»£ç å®ç°" class="headerlink" title="2. ä»£ç å®ç°"></a>2. ä»£ç å®ç°</h1><h2 id="2-1-æ‡’æ±‰å¼"><a href="#2-1-æ‡’æ±‰å¼" class="headerlink" title="2.1  æ‡’æ±‰å¼"></a>2.1  æ‡’æ±‰å¼</h2><p>å½“ç¨‹åºç¬¬ä¸€æ¬¡è®¿é—®å•ä¾‹æ¨¡å¼å®ä¾‹æ—¶æ‰è¿›è¡Œåˆ›å»ºï¼ˆå»¶è¿ŸåŠ è½½ï¼‰ã€‚</p><h3 id="1-å•çº¿ç¨‹å®ç°"><a href="#1-å•çº¿ç¨‹å®ç°" class="headerlink" title="1  å•çº¿ç¨‹å®ç°"></a>1  å•çº¿ç¨‹å®ç°</h3><p> ç¼ºç‚¹ï¼šåªèƒ½åœ¨å•çº¿ç¨‹ä¸‹ä½¿ç”¨ï¼Œå¤šçº¿ç¨‹ä¸‹ä¼šäº§ç”Ÿå¤šä¸ªå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LazySingleton</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> LazySingleton singleton;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">LazySingleton</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> LazySingleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>&#123;<br><br>        <span class="hljs-keyword">if</span> (singleton == <span class="hljs-keyword">null</span>) &#123;<br>            singleton = <span class="hljs-keyword">new</span> LazySingleton();<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> singleton;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="2-åŠ é”å¤šçº¿ç¨‹"><a href="#2-åŠ é”å¤šçº¿ç¨‹" class="headerlink" title="2  åŠ é”å¤šçº¿ç¨‹"></a>2  åŠ é”å¤šçº¿ç¨‹</h3><p>ç¼ºç‚¹ï¼šåŠ é”è¿›è¡ŒåŒæ­¥ï¼Œè™½ç„¶å¯ä»¥ä¿è¯å•ä¾‹ï¼Œä½†æ•ˆç‡å¤ªä½ï¼Œæµªè´¹å¤§é‡æ—¶é—´ã€‚æ¯ä¸€ä¸ªçº¿ç¨‹è¿›æ¥è°ƒç”¨getInstance()ï¼Œéƒ½éœ€è¦å»è·å–é”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton2</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton2 singleton;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Singleton2</span><span class="hljs-params">()</span> </span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> Singleton2 <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (singleton == <span class="hljs-keyword">null</span>) &#123;<br>            singleton = <span class="hljs-keyword">new</span> Singleton2();<br>        &#125;<br>        <span class="hljs-keyword">return</span> singleton;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-åŒé‡æ£€æŸ¥æœºåˆ¶"><a href="#3-åŒé‡æ£€æŸ¥æœºåˆ¶" class="headerlink" title="3  åŒé‡æ£€æŸ¥æœºåˆ¶"></a>3  åŒé‡æ£€æŸ¥æœºåˆ¶</h3><p>ä¼˜ç‚¹ï¼šä¿è¯å•ä¾‹çš„åŒæ—¶ï¼Œä¹Ÿæé«˜äº†æ•ˆç‡ã€‚ï¼ˆæ¯ä¸€ä¸ªçº¿ç¨‹è¿›æ¥è°ƒç”¨getInstance()ï¼Œåªæœ‰å¯¹è±¡ä¸ä¸ºç©ºï¼Œæ‰éœ€è¦å»è·å–é”ï¼‰</p><p>ç¼ºç‚¹ï¼šä¼šè¢«åºåˆ—åŒ–å’Œåå°„ç ´åå•ä¾‹ï¼ˆåºåˆ—åŒ–å¯å¤„ç†ï¼Œåå°„ä¸å¯å¤„ç†ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LazyDoubleCheckSingleton</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">static</span> LazyDoubleCheckSingleton lazyDoubleCheckSingleton = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">LazyDoubleCheckSingleton</span><span class="hljs-params">()</span></span>&#123;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> LazyDoubleCheckSingleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(lazyDoubleCheckSingleton == <span class="hljs-keyword">null</span>)&#123;<br>            <span class="hljs-keyword">synchronized</span> (LazyDoubleCheckSingleton.class)&#123;<br>                <span class="hljs-keyword">if</span>(lazyDoubleCheckSingleton == <span class="hljs-keyword">null</span>)&#123;<br>                    lazyDoubleCheckSingleton = <span class="hljs-keyword">new</span> LazyDoubleCheckSingleton();<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> lazyDoubleCheckSingleton;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼šsingletonå‰é¢è¦åŠ volatileå…³é”®å­—æ¥ä¿è¯ç¨‹åºè¿è¡Œçš„æœ‰åºæ€§ï¼Œå¦åˆ™å¤šçº¿ç¨‹è®¿é—®ä¸‹å¯èƒ½ä¼šå‡ºç°å¯¹è±¡æœªåˆå§‹åŒ–é”™è¯¯ï¼</p><blockquote><p>è¯´æ˜ï¼šåœ¨å†…å­˜ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªå˜é‡éœ€è¦ä¸‰æ­¥ï¼š1.ç”³è¯·ä¸€å—å†…å­˜ ï¼›2.è°ƒç”¨æ„é€ æ–¹æ³•åˆå§‹åŒ– ï¼›3 åˆ†é…ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘è¿™å—å†…å­˜</p></blockquote><p>åœ¨ç¼–è¯‘åŸç†ä¸­ï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„å†…å®¹å«åšç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œå³åœ¨ä¸æ”¹å˜åŸæ¥è¯­ä¹‰çš„æƒ…å†µä¸‹ï¼Œè°ƒæ•´è¯­å¥çš„æ‰§è¡Œé¡ºåºï¼Œæ¥è®©ç¨‹åºè¿è¡Œçš„æ›´å¿«ã€‚å› æ­¤å­˜åœ¨è¿™æ ·ä¸€ç§æƒ…å†µï¼Œæœ‰ä¸¤ä¸ªçº¿ç¨‹Aã€BåŒæ—¶è®¿é—®getInstanceæ–¹æ³•</p><ol><li><p>Açº¿ç¨‹åˆ¤æ–­å¯¹è±¡ä¸ºç©ºï¼Œæ²¡æ¥å¾—åŠè¿›è¡Œç¬¬äºŒæ¬¡åˆ¤æ–­ï¼Œï¼ˆæ—¶é—´ç‰‡ç”¨å®Œäº†ï¼ŒBçº¿ç¨‹è¿›å…¥ï¼‰</p></li><li><p>Bçº¿ç¨‹åˆ¤æ–­å¯¹è±¡ä¸ºç©ºï¼Œæ‰§è¡Œåˆ›å»ºå˜é‡çš„3æ­¥ï¼Œå…ˆç”³è¯·ä¸€å—å†…å­˜ï¼Œååˆ†é…ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘è¿™å—å†…å­˜ï¼Œä½†è¿˜æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼ˆæ—¶é—´ç‰‡ç”¨å®Œäº†ï¼ŒAçº¿ç¨‹è¿›å…¥ï¼‰</p></li><li><p>Açº¿ç¨‹æ¥ç€æ‰§è¡Œï¼Œå‘ç°æ­¤æ—¶singletonå·²ç»ä¸ä¸ºç©ºäº†ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›ï¼Œä½†æ­¤æ—¶è¿”å›çš„singletonå¯¹è±¡è™½ç„¶Bçº¿ç¨‹å·²ç»newäº†ï¼Œä½†è¿˜æ²¡æœ‰åˆå§‹åŒ–è¿™ä¸ªå®ä¾‹å¹¶æ²¡æœ‰æ„é€ å®Œæˆï¼Œæ­¤æ—¶å¦‚æœAçº¿ç¨‹ä½¿ç”¨è¿™ä¸ªå®ä¾‹ï¼Œç¨‹åºå°±ä¼šå‡ºç°å¯¹è±¡æœªåˆå§‹åŒ–é”™è¯¯äº†ã€‚</p></li></ol><h2 id="2-2-é¥¿æ±‰å¼"><a href="#2-2-é¥¿æ±‰å¼" class="headerlink" title="2.2 é¥¿æ±‰å¼"></a>2.2 é¥¿æ±‰å¼</h2><p>é¡¾åæ€ä¹‰ï¼Œé¥¿æ±‰æ³•å°±æ˜¯åœ¨ç¬¬ä¸€æ¬¡å¼•ç”¨è¯¥ç±»çš„æ—¶å€™å°±åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼Œè€Œä¸ç®¡å®é™…æ˜¯å¦éœ€è¦åˆ›å»ºã€‚</p><p>ä¼˜ç‚¹ï¼šå†™æ³•ç®€å•ï¼Œåœ¨ç±»åŠ è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹åŒ–ï¼Œé¿å…çº¿ç¨‹åŒæ­¥ã€‚</p><h3 id="1-ç®€å•å†™æ³•"><a href="#1-ç®€å•å†™æ³•" class="headerlink" title="1 ç®€å•å†™æ³•"></a>1 ç®€å•å†™æ³•</h3><p>ç¼ºç‚¹ï¼šæ²¡æœ‰è¾¾åˆ°æ‡’åŠ è½½çš„æ•ˆæœï¼Œè‹¥æœè‡ªå§‹è‡³ç»ˆéƒ½æ²¡æœ‰ç”¨è¿‡è¿™ä¸ªå¯¹è±¡ï¼Œå°±ä¼šé€ æˆå†…å­˜æµªè´¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HungrySingleton</span></span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> HungrySingleton hungrySingleton= <span class="hljs-keyword">new</span> HungrySingleton();<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">HungrySingleton</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> HungrySingleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> hungrySingleton;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-é™æ€å†…éƒ¨ç±»"><a href="#2-é™æ€å†…éƒ¨ç±»" class="headerlink" title="2  é™æ€å†…éƒ¨ç±»"></a>2  é™æ€å†…éƒ¨ç±»</h3><p>è¿™é‡Œé‡‡ç”¨äº†é™æ€å†…éƒ¨ç±»å®ä¾‹singletonå¯¹è±¡ï¼Œé™æ€å†…éƒ¨ç±»ç›¸å½“äºä¸€ä¸ªé™æ€å±æ€§ï¼Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡åŠ è½½ç±»æ—¶æ‰ä¼šåˆå§‹åŒ–ï¼Œåœ¨ç±»åˆå§‹åŒ–æ—¶ï¼Œåˆ«çš„çº¿ç¨‹æ˜¯æ— æ³•è¿›å…¥çš„ï¼Œå› æ­¤ä¿è¯äº†çº¿ç¨‹å®‰å…¨ã€‚</p><p>ç¼ºç‚¹ï¼šä¼šè¢«åºåˆ—åŒ–å’Œåå°„ç ´åå•ä¾‹ï¼ˆåºåˆ—åŒ–å¯å¤„ç†ï¼Œåå°„ä¸å¯å¤„ç†ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StaticInnerClassSingleton</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InnerClass</span></span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> StaticInnerClassSingleton staticInnerClassSingleton = <span class="hljs-keyword">new</span> StaticInnerClassSingleton();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> StaticInnerClassSingleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> InnerClass.staticInnerClassSingleton;<br>    &#125;<br>  <br>  <span class="hljs-comment">// é¿å…åå°„æ”»å‡»</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">StaticInnerClassSingleton</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(InnerClass.staticInnerClassSingleton != <span class="hljs-keyword">null</span>)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;å•ä¾‹æ„é€ å™¨ç¦æ­¢åå°„è°ƒç”¨&quot;</span>);<br>        &#125;<br>    &#125;<br>  <span class="hljs-comment">// é¿å…åºåˆ—åŒ–ç ´åå•ä¾‹</span><br>      <span class="hljs-function"><span class="hljs-keyword">private</span> Object <span class="hljs-title">readResolve</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> InnerClass.staticInnerClassSingleton;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="3-æšä¸¾å•ä¾‹ï¼ˆæ¨èï¼‰"><a href="#3-æšä¸¾å•ä¾‹ï¼ˆæ¨èï¼‰" class="headerlink" title="3 æšä¸¾å•ä¾‹ï¼ˆæ¨èï¼‰"></a>3 æšä¸¾å•ä¾‹ï¼ˆæ¨èï¼‰</h3><p>å¯¹äºè¿™ç§æ–¹å¼çš„å•ä¾‹ï¼Œä¸å—åå°„å’Œåºåˆ—åŒ–çš„æ”»å‡»ï¼Œæ˜¯æœ€æ¨èçš„ä¸€ç§å†™æ³•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs wiki">å•å…ƒç´ çš„æšä¸¾ç±»å‹å·²ç»æˆä¸ºå®ç°Singletonçš„æœ€ä½³æ–¹æ³•               -- å‡ºè‡ª ã€Šeffective javaã€‹<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">EnumInstance</span> </span>&#123;<br>    INSTANCE;<br>    <span class="hljs-keyword">private</span> Object data;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">getData</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> data;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setData</span><span class="hljs-params">(Object data)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.data = data;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> EnumInstance <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> INSTANCE;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚å¯ä»¥çœ‹å‡ºæšä¸¾ä¸å—åºåˆ—åŒ–å½±å“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestEnum</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        EnumInstance instance = EnumInstance.getInstance();<br>        instance.setData(<span class="hljs-keyword">new</span> Object());<br><br>        ObjectOutputStream oos = <span class="hljs-keyword">new</span> ObjectOutputStream(<span class="hljs-keyword">new</span> FileOutputStream(<span class="hljs-string">&quot;singleton_file&quot;</span>));<br>        oos.writeObject(instance);<br>        File file = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;singleton_file&quot;</span>);<br>        ObjectInputStream ois = <span class="hljs-keyword">new</span> ObjectInputStream(<span class="hljs-keyword">new</span> FileInputStream(file));<br>        EnumInstance newInstance = (EnumInstance) ois.readObject();<br><br>        System.out.println(instance.getData());<br>        System.out.println(newInstance.getData());<br>        System.out.println(instance.getData() == newInstance.getData());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231003161934648.png" alt="image-20231003161934648"></p><p>æµ‹è¯•åå°„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestEnumReflect</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        EnumInstance instance = EnumInstance.getInstance();<br>        instance.setData(<span class="hljs-keyword">new</span> Object());<br><br>        <span class="hljs-comment">// enumæ²¡æœ‰æ— å‚æ„é€ å™¨</span><br>        Constructor&lt;EnumInstance&gt; constructor = EnumInstance.class.getDeclaredConstructor(String.class, <span class="hljs-keyword">int</span>.class);<br>        constructor.setAccessible(<span class="hljs-keyword">true</span>);<br>        EnumInstance newInstance = constructor.newInstance(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-number">111</span>);<br><br>        System.out.println(instance.getData());<br>        System.out.println(newInstance.getData());<br>        System.out.println(instance.getData() == newInstance.getData());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231003163510478.png" alt="image-20231003163510478"></p><p>å¯ä»¥çœ‹åˆ°ï¼ŒæŠ¥é”™ Cannot reflectively create enum objectsï¼Œæ— æ³•é€šè¿‡åå°„åˆ›å»ºæšä¸¾å¯¹è±¡</p><h1 id="3-åºåˆ—åŒ–å’Œåå°„ç ´åå•ä¾‹"><a href="#3-åºåˆ—åŒ–å’Œåå°„ç ´åå•ä¾‹" class="headerlink" title="3. åºåˆ—åŒ–å’Œåå°„ç ´åå•ä¾‹"></a>3. åºåˆ—åŒ–å’Œåå°„ç ´åå•ä¾‹</h1><h2 id="3-1-åºåˆ—åŒ–ç ´åå•ä¾‹"><a href="#3-1-åºåˆ—åŒ–ç ´åå•ä¾‹" class="headerlink" title="3.1 åºåˆ—åŒ–ç ´åå•ä¾‹"></a>3.1 åºåˆ—åŒ–ç ´åå•ä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HungrySingleton</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span></span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> HungrySingleton hungrySingleton= <span class="hljs-keyword">new</span> HungrySingleton();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> HungrySingleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> hungrySingleton;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException </span>&#123;<br>        HungrySingleton instance = HungrySingleton.getInstance();<br>        ObjectOutputStream oos = <span class="hljs-keyword">new</span> ObjectOutputStream(<span class="hljs-keyword">new</span> FileOutputStream(<span class="hljs-string">&quot;singleton_file&quot;</span>));<br>        oos.writeObject(instance);<br><br>        File file = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;singleton_file&quot;</span>);<br>        ObjectInputStream ois = <span class="hljs-keyword">new</span> ObjectInputStream(<span class="hljs-keyword">new</span> FileInputStream(file));<br>        HungrySingleton newInstance = (HungrySingleton) ois.readObject();<br><br>        System.out.println(instance);<br>        System.out.println(newInstance);<br>        System.out.println(instance == newInstance);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231003124316573.png" alt="image-20231003124316573"></p><p>è§£å†³æ–¹å¼ï¼š</p><p>HungrySingleton å¢åŠ readResolve()æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> Object <span class="hljs-title">readResolve</span><span class="hljs-params">()</span></span>&#123;<br>  <span class="hljs-keyword">return</span> hungrySingleton;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-2-åå°„ç ´åå•ä¾‹"><a href="#3-2-åå°„ç ´åå•ä¾‹" class="headerlink" title="3.2 åå°„ç ´åå•ä¾‹"></a>3.2 åå°„ç ´åå•ä¾‹</h2><p>åªå¯é¿å…åå°„ç ´åé¥¿æ±‰å¼å•ä¾‹ï¼Œæ— æ³•é¿å…åå°„ç ´åæ‡’æ±‰å¼å•ä¾‹ã€‚</p><h3 id="1-é¥¿æ±‰å¼å•ä¾‹"><a href="#1-é¥¿æ±‰å¼å•ä¾‹" class="headerlink" title="1. é¥¿æ±‰å¼å•ä¾‹"></a>1. é¥¿æ±‰å¼å•ä¾‹</h3><p>å¯¹äºé¥¿æ±‰å¼ï¼Œå³åœ¨ç±»åˆå§‹åŒ–æ—¶åˆ›å»ºå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestReflect</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        HungrySingleton instance = HungrySingleton.getInstance();<br><br>        Constructor&lt;HungrySingleton&gt; constructor = HungrySingleton.class.getDeclaredConstructor();<br>        constructor.setAccessible(<span class="hljs-keyword">true</span>);<br>        HungrySingleton newInstance = constructor.newInstance();<br><br>        System.out.println(instance);<br>        System.out.println(newInstance);<br>        System.out.println(instance == newInstance);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231003145832779.png" alt="image-20231003145832779"></p><p>ç”±ä¸Šå¯çœ‹å‡ºï¼Œé€šè¿‡åå°„åˆ›å»ºäº†ä¸¤ä¸ªä¸åŒçš„å®ä¾‹ã€‚å¯åšå¦‚ä¸‹è°ƒæ•´ï¼š</p><p>å½“ä½¿ç”¨æ— å‚æ„é€ å™¨æ„å»ºå¯¹è±¡æ—¶ï¼Œç”±äºå¯¹è±¡å·²ç»åœ¨ç±»åŠ è½½æ—¶åˆ›å»ºï¼Œåˆ™ä¸å…è®¸å†åˆ›å»ºæ–°å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HungrySingleton</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span>,<span class="hljs-title">Cloneable</span></span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> HungrySingleton hungrySingleton;<br><br>    <span class="hljs-keyword">static</span>&#123;<br>        hungrySingleton = <span class="hljs-keyword">new</span> HungrySingleton();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">HungrySingleton</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(hungrySingleton != <span class="hljs-keyword">null</span>)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;å•ä¾‹æ„é€ å™¨ç¦æ­¢åå°„è°ƒç”¨&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> HungrySingleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> hungrySingleton;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-æ‡’æ±‰å¼å•ä¾‹"><a href="#2-æ‡’æ±‰å¼å•ä¾‹" class="headerlink" title="2. æ‡’æ±‰å¼å•ä¾‹"></a>2. æ‡’æ±‰å¼å•ä¾‹</h3><p>å³ä½¿åœ¨ç§æœ‰æ„é€ å™¨ä¸­ï¼Œå¢åŠ äº†ç¦æ­¢åå°„è°ƒç”¨çš„é€»è¾‘ï¼Œä¹Ÿæ— æ³•ç¡®ä¿å•ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LazySingleton</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> LazySingleton lazySingleton = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">LazySingleton</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(lazySingleton != <span class="hljs-keyword">null</span>)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;å•ä¾‹æ„é€ å™¨ç¦æ­¢åå°„è°ƒç”¨&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">static</span> LazySingleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(lazySingleton == <span class="hljs-keyword">null</span>)&#123;<br>            lazySingleton = <span class="hljs-keyword">new</span> LazySingleton();<br>        &#125;<br>        <span class="hljs-keyword">return</span> lazySingleton;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å½“å…ˆé€šè¿‡åå°„åˆ›å»ºå¯¹è±¡ï¼Œå†é€šè¿‡æ–¹æ³•è°ƒç”¨åˆ›å»ºå¯¹è±¡çš„åœºæ™¯ï¼Œå°±ä¼šäº§ç”Ÿä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestReflect2</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        Constructor&lt;LazySingleton&gt; constructor = LazySingleton.class.getDeclaredConstructor();<br>        constructor.setAccessible(<span class="hljs-keyword">true</span>);<br>        LazySingleton newInstance = constructor.newInstance();<br><br>        LazySingleton instance = LazySingleton.getInstance();<br><br>        System.out.println(instance);<br>        System.out.println(newInstance);<br>        System.out.println(instance == newInstance);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231003172322321.png" alt="image-20231003172322321"></p><p>å½“å…ˆé€šè¿‡æ–¹æ³•è°ƒç”¨åˆ›å»ºå¯¹è±¡çš„åœºæ™¯ï¼Œå†é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡ï¼Œåˆ™ä¼šæ ¹æ®é€»è¾‘é˜»æ­¢ç¬¬äºŒä¸ªå¯¹è±¡çš„äº§ç”Ÿã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestReflect2</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        LazySingleton instance = LazySingleton.getInstance();<br><br>        Constructor&lt;LazySingleton&gt; constructor = LazySingleton.class.getDeclaredConstructor();<br>        constructor.setAccessible(<span class="hljs-keyword">true</span>);<br>        LazySingleton newInstance = constructor.newInstance();<br>        <br>        System.out.println(instance);<br>        System.out.println(newInstance);<br>        System.out.println(instance == newInstance);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20231003172354599.png" alt="image-20231003172354599"></p><blockquote><p> å› ä¸ºäºŒè€…è™½ç„¶éƒ½ä¼šè°ƒç”¨æ— å‚æ„é€ å™¨ï¼Œä½†æ˜¯åªæœ‰getInstance()æ–¹æ³•æ‰ä¼šå°†lazySingletonèµ‹å€¼ã€‚</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å»ºé€ è€…æ¨¡å¼</title>
    <link href="/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="å»ºé€ è€…æ¨¡å¼"><a href="#å»ºé€ è€…æ¨¡å¼" class="headerlink" title="å»ºé€ è€…æ¨¡å¼"></a>å»ºé€ è€…æ¨¡å¼</h1><h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1. æ¦‚å¿µ"></a>1. æ¦‚å¿µ</h1><ol><li><p>å®šä¹‰</p><p>å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸ä»–çš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚</p></li><li><p>ä½¿ç”¨åœºæ™¯</p><ul><li>å½“å¯¹è±¡æœ‰å¤æ‚çš„å†…éƒ¨ç»“æ„ï¼ˆå¾ˆå¤šå±æ€§ï¼‰</li><li>å½“åˆ›é€ ä¸€ä¸ªå¯¹è±¡ éœ€è¦å¾ˆå¤šæ­¥éª¤æ—¶ , é€‚åˆä½¿ç”¨å»ºé€ è€…æ¨¡å¼ ;  å½“åˆ›é€ ä¸€ä¸ªå¯¹è±¡ åªéœ€è¦ä¸€ä¸ªç®€å•çš„æ–¹æ³•å°±å¯ä»¥å®Œæˆ , é€‚åˆä½¿ç”¨å·¥å‚æ¨¡å¼</li></ul></li><li><p>ä¼˜ç¼ºç‚¹</p><ul><li><p>ä¼˜ç‚¹ï¼š</p><ul><li>åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»</li><li>å»ºé€ ç±»ä¹‹é—´ ç›¸äº’ç‹¬ç«‹ , åœ¨ ä¸€å®šç¨‹åº¦ä¸Šè§£è€¦ ;</li></ul></li><li><p>ç¼ºç‚¹ :</p><ul><li><p>å¢åŠ ç±»æ•°é‡ : äº§ç”Ÿå¤šä½™çš„ Builder å¯¹è±¡ ;</p></li><li><p>å†…éƒ¨ä¿®æ”¹å›°éš¾ : å¦‚æœ äº§å“å†…éƒ¨å‘ç”Ÿå˜åŒ– , å»ºé€ è€…ä¹Ÿè¦ç›¸åº”ä¿®æ”¹ ;</p></li></ul></li></ul></li><li><p>å»ºé€ è€…æ¨¡å¼ ä¸ å·¥å‚æ¨¡å¼ :</p><ul><li><p>æ³¨é‡ç‚¹ä¸åŒ : å»ºé€ è€…æ¨¡å¼ æ›´æ³¨é‡äº æ–¹æ³•çš„è°ƒç”¨é¡ºåº ; å·¥å‚æ¨¡å¼ æ³¨é‡äº åˆ›å»ºäº§å“ , ä¸å…³å¿ƒæ–¹æ³•è°ƒç”¨çš„é¡ºåº ;</p></li><li><p>åˆ›å»ºå¯¹è±¡åŠ›åº¦ä¸åŒ : åˆ›å»ºå¯¹è±¡çš„åŠ›åº¦ä¸åŒ , å»ºé€ è€…æ¨¡å¼å¯ä»¥åˆ›å»ºå¤æ‚çš„äº§å“ , ç”±å„ç§å¤æ‚çš„éƒ¨ä»¶ç»„æˆ , å·¥å‚æ¨¡å¼åˆ›å»ºå‡ºæ¥çš„éƒ½æ˜¯ç›¸åŒçš„å®ä¾‹å¯¹è±¡ ,</p></li></ul></li></ol><h1 id="2-ä»£ç "><a href="#2-ä»£ç " class="headerlink" title="2. ä»£ç "></a>2. ä»£ç </h1><p>æ•™å¸ˆåˆ›å»ºè¯¾ç¨‹</p><h2 id="2-1-ç‰ˆæœ¬1"><a href="#2-1-ç‰ˆæœ¬1" class="headerlink" title="2.1 ç‰ˆæœ¬1"></a>2.1 ç‰ˆæœ¬1</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Coach</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> CourseBuilder courseBuilder;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCourseBuilder</span><span class="hljs-params">(CourseBuilder courseBuilder)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.courseBuilder = courseBuilder;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Course <span class="hljs-title">makeCourse</span><span class="hljs-params">(String courseName,String coursePPT,</span></span><br><span class="hljs-params"><span class="hljs-function">                             String courseVideo,String courseArticle,</span></span><br><span class="hljs-params"><span class="hljs-function">                             String courseQA)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.courseBuilder.buildCourseName(courseName);<br>        <span class="hljs-keyword">this</span>.courseBuilder.buildCoursePPT(coursePPT);<br>        <span class="hljs-keyword">this</span>.courseBuilder.buildCourseVideo(courseVideo);<br>        <span class="hljs-keyword">this</span>.courseBuilder.buildCourseArticle(courseArticle);<br>        <span class="hljs-keyword">this</span>.courseBuilder.buildCourseQA(courseQA);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.courseBuilder.makeCourse();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CourseBuilder</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">buildCourseName</span><span class="hljs-params">(String courseName)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">buildCoursePPT</span><span class="hljs-params">(String coursePPT)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">buildCourseVideo</span><span class="hljs-params">(String courseVideo)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">buildCourseArticle</span><span class="hljs-params">(String courseArticle)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">buildCourseQA</span><span class="hljs-params">(String courseQA)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Course <span class="hljs-title">makeCourse</span><span class="hljs-params">()</span></span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CourseActualBuilder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CourseBuilder</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> Course course = <span class="hljs-keyword">new</span> Course();<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">buildCourseName</span><span class="hljs-params">(String courseName)</span> </span>&#123;<br>        course.setCourseName(courseName);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">buildCoursePPT</span><span class="hljs-params">(String coursePPT)</span> </span>&#123;<br>        course.setCoursePPT(coursePPT);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">buildCourseVideo</span><span class="hljs-params">(String courseVideo)</span> </span>&#123;<br>        course.setCourseVideo(courseVideo);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">buildCourseArticle</span><span class="hljs-params">(String courseArticle)</span> </span>&#123;<br>        course.setCourseArticle(courseArticle);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">buildCourseQA</span><span class="hljs-params">(String courseQA)</span> </span>&#123;<br>        course.setCourseQA(courseQA);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Course <span class="hljs-title">makeCourse</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> course;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Course</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String courseName;<br>    <span class="hljs-keyword">private</span> String coursePPT;<br>    <span class="hljs-keyword">private</span> String courseVideo;<br>    <span class="hljs-keyword">private</span> String courseArticle;<br><br>    <span class="hljs-comment">//question &amp; answer</span><br>    <span class="hljs-keyword">private</span> String courseQA;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        CourseBuilder courseBuilder = <span class="hljs-keyword">new</span> CourseActualBuilder();<br>        Coach coach = <span class="hljs-keyword">new</span> Coach();<br>        coach.setCourseBuilder(courseBuilder);<br><br>        Course course = coach.makeCourse(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²&quot;</span>,<br>                <span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²PPT&quot;</span>,<br>                <span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²è§†é¢‘&quot;</span>,<br>                <span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²æ‰‹è®°&quot;</span>,<br>                <span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²é—®ç­”&quot;</span>);<br>        System.out.println(course);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-2-ç‰ˆæœ¬2"><a href="#2-2-ç‰ˆæœ¬2" class="headerlink" title="2.2 ç‰ˆæœ¬2"></a>2.2 ç‰ˆæœ¬2</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Course</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> String courseName;<br>    <span class="hljs-keyword">private</span> String coursePPT;<br>    <span class="hljs-keyword">private</span> String courseVideo;<br>    <span class="hljs-keyword">private</span> String courseArticle;<br><br>    <span class="hljs-comment">//question &amp; answer</span><br>    <span class="hljs-keyword">private</span> String courseQA;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Course</span><span class="hljs-params">(CourseBuilder courseBuilder)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.courseName = courseBuilder.courseName;<br>        <span class="hljs-keyword">this</span>.coursePPT = courseBuilder.coursePPT;<br>        <span class="hljs-keyword">this</span>.courseVideo = courseBuilder.courseVideo;<br>        <span class="hljs-keyword">this</span>.courseArticle = courseBuilder.courseArticle;<br>        <span class="hljs-keyword">this</span>.courseQA = courseBuilder.courseQA;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CourseBuilder</span></span>&#123;<br>        <span class="hljs-keyword">private</span> String courseName;<br>        <span class="hljs-keyword">private</span> String coursePPT;<br>        <span class="hljs-keyword">private</span> String courseVideo;<br>        <span class="hljs-keyword">private</span> String courseArticle;<br><br>        <span class="hljs-comment">//question &amp; answer</span><br>        <span class="hljs-keyword">private</span> String courseQA;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> CourseBuilder <span class="hljs-title">buildCourseName</span><span class="hljs-params">(String courseName)</span></span>&#123;<br>            <span class="hljs-keyword">this</span>.courseName = courseName;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>        &#125;<br><br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> CourseBuilder <span class="hljs-title">buildCoursePPT</span><span class="hljs-params">(String coursePPT)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.coursePPT = coursePPT;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> CourseBuilder <span class="hljs-title">buildCourseVideo</span><span class="hljs-params">(String courseVideo)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.courseVideo = courseVideo;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> CourseBuilder <span class="hljs-title">buildCourseArticle</span><span class="hljs-params">(String courseArticle)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.courseArticle = courseArticle;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> CourseBuilder <span class="hljs-title">buildCourseQA</span><span class="hljs-params">(String courseQA)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.courseQA = courseQA;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> Course <span class="hljs-title">build</span><span class="hljs-params">()</span></span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Course(<span class="hljs-keyword">this</span>);<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Course course = <span class="hljs-keyword">new</span> Course.CourseBuilder()<br>                .buildCourseName(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²&quot;</span>)<br>                .buildCoursePPT(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²PPT&quot;</span>)<br>                .buildCourseVideo(<span class="hljs-string">&quot;Javaè®¾è®¡æ¨¡å¼ç²¾è®²è§†é¢‘&quot;</span>)<br>                .build();<br>        System.out.println(course);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="3-Javaçš„åº”ç”¨"><a href="#3-Javaçš„åº”ç”¨" class="headerlink" title="3. Javaçš„åº”ç”¨"></a>3. Javaçš„åº”ç”¨</h1><ol><li>JDK ä¸­StringBuilder, stringBufferçš„append()</li></ol><ul><li><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230926215714433.png" alt="image-20230926215714433"><u></u></li></ul><ol start="2"><li><p>springä¸­BeanDefinitionBuilder</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230926221325746.png" alt="image-20230926221325746"></p></li><li><p>Mybatis ä¸­MybatisSqlSessionFactoryBuilder</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230926221450251.png" alt="image-20230926221450251"></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç®€å•å·¥å‚æ¨¡å¼</title>
    <link href="/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    <url>/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®€å•å·¥å‚æ¨¡å¼"><a href="#ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="ç®€å•å·¥å‚æ¨¡å¼"></a>ç®€å•å·¥å‚æ¨¡å¼</h1><h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1. æ¦‚å¿µ"></a>1. æ¦‚å¿µ</h1><ul><li>å®šä¹‰ï¼šç”±ä¸€ä¸ªå·¥å‚å¯¹è±¡å†³å®šåˆ›å»ºå‡ºå“ªä¸€ç§å¯¹è±¡çš„å®ä¾‹</li><li>ä¼˜ç¼ºç‚¹ï¼š<ul><li>ä¼˜ç‚¹ï¼šåªéœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œå°±å¯ä»¥è·å–ä½ æ‰€éœ€è¦çš„å¯¹è±¡ï¼Œè€Œæ— éœ€çŸ¥é“ç»†èŠ‚</li><li>ç¼ºç‚¹ï¼šå·¥å‚çš„èŒè´£è¿‡é‡ï¼Œå¢åŠ æ–°çš„äº§å“ï¼Œéœ€è¦ä¿®æ”¹å·¥å‚çš„åˆ¤æ–­é€»è¾‘ï¼Œè¿åå¼€é—­åŸåˆ™</li></ul></li></ul><h1 id="2-ä»£ç "><a href="#2-ä»£ç " class="headerlink" title="2. ä»£ç "></a>2. ä»£ç </h1><p>éœ€æ±‚ï¼š éœ€è¦æ ¹æ®ç”µå½±ç±»å‹åˆ›å»ºç”µå½±</p><h2 id="2-1-ç‰ˆæœ¬1ï¼šå¸¸è§„å†™æ³•"><a href="#2-1-ç‰ˆæœ¬1ï¼šå¸¸è§„å†™æ³•" class="headerlink" title="2.1 ç‰ˆæœ¬1ï¼šå¸¸è§„å†™æ³•"></a>2.1 ç‰ˆæœ¬1ï¼šå¸¸è§„å†™æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JavaVideo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Video</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å½•åˆ¶Javaè¯¾ç¨‹è§†é¢‘&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PythonVideo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Video</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å½•åˆ¶Pythonè¯¾ç¨‹è§†é¢‘&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        PythonVideo pythonVideo = <span class="hljs-keyword">new</span> PythonVideo();<br>        pythonVideo.produce();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-2-ç‰ˆæœ¬2ï¼š-ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼æ”¹é€ "><a href="#2-2-ç‰ˆæœ¬2ï¼š-ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼æ”¹é€ " class="headerlink" title="2.2 ç‰ˆæœ¬2ï¼š ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼æ”¹é€ "></a>2.2 ç‰ˆæœ¬2ï¼š ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼æ”¹é€ </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VideoFactory</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Video <span class="hljs-title">getVideo</span><span class="hljs-params">(String type)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;java&quot;</span>.equalsIgnoreCase(type))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JavaVideo();<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;python&quot;</span>.equalsIgnoreCase(type))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> PythonVideo();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        VideoFactory videoFactory = <span class="hljs-keyword">new</span> VideoFactory();<br>        Video video = videoFactory.getVideo(<span class="hljs-string">&quot;python&quot;</span>);<br>        <span class="hljs-keyword">if</span>(video == <span class="hljs-keyword">null</span>)&#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        video.produce();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-3-ç‰ˆæœ¬3-åŸºäºåå°„æ”¹é€ ï¼Œé¿å…å·¥å‚é‡Œé€»è¾‘å¤ªå¤æ‚"><a href="#2-3-ç‰ˆæœ¬3-åŸºäºåå°„æ”¹é€ ï¼Œé¿å…å·¥å‚é‡Œé€»è¾‘å¤ªå¤æ‚" class="headerlink" title="2.3 ç‰ˆæœ¬3:  åŸºäºåå°„æ”¹é€ ï¼Œé¿å…å·¥å‚é‡Œé€»è¾‘å¤ªå¤æ‚"></a>2.3 ç‰ˆæœ¬3:  åŸºäºåå°„æ”¹é€ ï¼Œé¿å…å·¥å‚é‡Œé€»è¾‘å¤ªå¤æ‚</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VideoFactory</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Video <span class="hljs-title">getVideo</span><span class="hljs-params">(Class c)</span></span>&#123;<br>        Video video = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            video = (Video) Class.forName(c.getName()).newInstance();<br>        &#125; <span class="hljs-keyword">catch</span> (InstantiationException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">catch</span> (IllegalAccessException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">catch</span> (ClassNotFoundException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> video;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        VideoFactory videoFactory = <span class="hljs-keyword">new</span> VideoFactory();<br>        Video video = videoFactory.getVideo(JavaVideo.class);<br>        <span class="hljs-keyword">if</span>(video == <span class="hljs-keyword">null</span>)&#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        video.produce();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="3-JDKçš„åº”ç”¨"><a href="#3-JDKçš„åº”ç”¨" class="headerlink" title="3 JDKçš„åº”ç”¨"></a>3 JDKçš„åº”ç”¨</h1><p>JDK1.8çš„åº”ç”¨ï¼šjava.util.Calendar</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Calendar <span class="hljs-title">createCalendar</span><span class="hljs-params">(TimeZone zone,</span></span><br><span class="hljs-params"><span class="hljs-function">                                           Locale aLocale)</span></span><br><span class="hljs-function">    </span>&#123;<br>        CalendarProvider provider =<br>            LocaleProviderAdapter.getAdapter(CalendarProvider.class, aLocale)<br>                                 .getCalendarProvider();<br>        <span class="hljs-keyword">if</span> (provider != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">return</span> provider.getInstance(zone, aLocale);<br>            &#125; <span class="hljs-keyword">catch</span> (IllegalArgumentException iae) &#123;<br>                <span class="hljs-comment">// fall back to the default instantiation</span><br>            &#125;<br>        &#125;<br><br>        Calendar cal = <span class="hljs-keyword">null</span>;<br><br>        <span class="hljs-keyword">if</span> (aLocale.hasExtensions()) &#123;<br>            String caltype = aLocale.getUnicodeLocaleType(<span class="hljs-string">&quot;ca&quot;</span>);<br>            <span class="hljs-keyword">if</span> (caltype != <span class="hljs-keyword">null</span>) &#123;<br>                cal = <span class="hljs-keyword">switch</span> (caltype) &#123;<br>                    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;buddhist&quot;</span> -&gt; <span class="hljs-keyword">new</span> BuddhistCalendar(zone, aLocale);<br>                    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;japanese&quot;</span> -&gt; <span class="hljs-keyword">new</span> JapaneseImperialCalendar(zone, aLocale);<br>                    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;gregory&quot;</span>  -&gt; <span class="hljs-keyword">new</span> GregorianCalendar(zone, aLocale);<br>                    <span class="hljs-keyword">default</span>         -&gt; <span class="hljs-keyword">null</span>;<br>                &#125;;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (cal == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-comment">// If no known calendar type is explicitly specified,</span><br>            <span class="hljs-comment">// perform the traditional way to create a Calendar:</span><br>            <span class="hljs-comment">// create a BuddhistCalendar for th_TH locale,</span><br>            <span class="hljs-comment">// a JapaneseImperialCalendar for ja_JP_JP locale, or</span><br>            <span class="hljs-comment">// a GregorianCalendar for any other locales.</span><br>            <span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> The language, country and variant strings are interned.</span><br>            <span class="hljs-keyword">if</span> (aLocale.getLanguage() == <span class="hljs-string">&quot;th&quot;</span> &amp;&amp; aLocale.getCountry() == <span class="hljs-string">&quot;TH&quot;</span>) &#123;<br>                cal = <span class="hljs-keyword">new</span> BuddhistCalendar(zone, aLocale);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (aLocale.getVariant() == <span class="hljs-string">&quot;JP&quot;</span> &amp;&amp; aLocale.getLanguage() == <span class="hljs-string">&quot;ja&quot;</span><br>                       &amp;&amp; aLocale.getCountry() == <span class="hljs-string">&quot;JP&quot;</span>) &#123;<br>                cal = <span class="hljs-keyword">new</span> JapaneseImperialCalendar(zone, aLocale);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                cal = <span class="hljs-keyword">new</span> GregorianCalendar(zone, aLocale);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> cal;<br>    &#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>mysqlç´¢å¼•å¸¸è§é¢è¯•é¢˜</title>
    <link href="/mysql%E7%B4%A2%E5%BC%95%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/mysql%E7%B4%A2%E5%BC%95%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-mysql-ä¸ºä»€ä¹ˆä½¿ç”¨B-æ ‘ï¼Ÿ"><a href="#1-mysql-ä¸ºä»€ä¹ˆä½¿ç”¨B-æ ‘ï¼Ÿ" class="headerlink" title="1. mysql ä¸ºä»€ä¹ˆä½¿ç”¨B+æ ‘ï¼Ÿ"></a>1. mysql ä¸ºä»€ä¹ˆä½¿ç”¨B+æ ‘ï¼Ÿ</h1><ul><li><p>äºŒå‰æ ‘ï¼šå•è¾¹å¢é•¿çš„åœºæ™¯ä¼šå¯¼è‡´å…¨è¡¨æ‰«æã€‚</p></li><li><p>çº¢é»‘æ ‘ï¼šç›¸å¯¹å¹³è¡¡ï¼Œæ¯”äºŒå‰æ ‘æ€§èƒ½å¥½ï¼Œå¤§æ•°æ®ä¸‹ï¼Œçº¢é»‘æ ‘çš„é«˜åº¦è¿‡é«˜ï¼Œä¼šé€ æˆç£ç›˜IOé¢‘ç¹ã€‚</p></li><li><p>Hash: ä¸æ”¯æŒèŒƒå›´æŸ¥æ‰¾å’Œæ’åº</p></li><li><p><strong>Bæ ‘ VS B+æ ‘</strong>ï¼š</p></li></ul><ol><li>æ›´é«˜çš„èŠ‚ç‚¹åˆ©ç”¨ç‡</li></ol><p>B+æ ‘ä¸Bæ ‘çš„ä¸€ä¸ªå…³é”®åŒºåˆ«åœ¨äºB+æ ‘çš„æ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ï¼Œè€Œéå¶å­èŠ‚ç‚¹åªå­˜å‚¨é”®å€¼å’ŒæŒ‡å‘å­èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚è¿™æ ·å¯ä»¥ä½¿éå¶å­èŠ‚ç‚¹åŒ…å«æ›´å¤šçš„é”®å€¼å’ŒæŒ‡é’ˆï¼Œæé«˜äº†èŠ‚ç‚¹çš„åˆ©ç”¨ç‡ï¼Œä»è€Œå‡å°‘äº†æ ‘çš„é«˜åº¦ã€‚</p><ol start="2"><li>æ›´é«˜çš„æŸ¥è¯¢æ•ˆç‡</li></ol><p>ç”±äºB+æ ‘çš„å¶å­èŠ‚ç‚¹å½¢æˆäº†ä¸€ä¸ªé“¾è¡¨ï¼Œæ‰€æœ‰çš„å®é™…æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸­ï¼Œè¿™ä½¿å¾—èŒƒå›´æŸ¥è¯¢å’Œé¡ºåºéå†æ›´åŠ é«˜æ•ˆã€‚å¯ä»¥å¾ˆå®¹æ˜“åœ°é€šè¿‡é¡ºåºè®¿é—®å¶å­èŠ‚ç‚¹æ¥å®ç°èŒƒå›´æŸ¥è¯¢ï¼Œè€Œä¸éœ€è¦å›æº¯ã€‚</p><ol start="3"><li>æ›´é€‚åˆç£ç›˜å­˜å‚¨</li></ol><p>æ•°æ®åº“ç³»ç»Ÿé€šå¸¸éœ€è¦å¤„ç†å¤§é‡çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®å¤§éƒ¨åˆ†å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚B+æ ‘è®¾è®¡æ›´åŠ é€‚åˆç£ç›˜å­˜å‚¨ï¼Œå› ä¸ºå®ƒå‡å°‘äº†æ ‘çš„é«˜åº¦ï¼Œè¿›è€Œå‡å°‘äº†ç£ç›˜I&#x2F;Oæ“ä½œçš„æ¬¡æ•°ã€‚æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜å‚¨æ›´å¤šçš„æŒ‡é’ˆï¼Œä»è€Œé™ä½äº†è®¿é—®æ•°æ®æ—¶éœ€è¦è¯»å–çš„ç£ç›˜å—æ•°é‡ã€‚</p><ol start="4"><li>æ›´ç¨³å®šçš„æŸ¥è¯¢æ€§èƒ½</li></ol><p>åœ¨B+æ ‘ä¸­ï¼Œæ‰€æœ‰å®é™…æ•°æ®éƒ½åœ¨å¶å­èŠ‚ç‚¹ä¸Šï¼Œéå¶å­èŠ‚ç‚¹ä»…ä½œä¸ºç´¢å¼•ä½¿ç”¨ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰çš„æŸ¥æ‰¾æ“ä½œæ‰€éœ€çš„è·¯å¾„é•¿åº¦ç›¸åŒã€‚å› æ­¤ï¼ŒB+æ ‘çš„æŸ¥è¯¢æ€§èƒ½æ›´åŠ ç¨³å®šã€‚</p><p><strong>å…·ä½“æ¯”è¾ƒï¼šBæ ‘ vs B+æ ‘</strong></p><ul><li><p><strong>èŠ‚ç‚¹ç»“æ„</strong>ï¼š</p><ul><li><strong>Bæ ‘</strong>ï¼šæ¯ä¸ªèŠ‚ç‚¹æ—¢åŒ…å«é”®å€¼ä¹ŸåŒ…å«æ•°æ®ã€‚</li><li><strong>B+æ ‘</strong>ï¼šæ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ï¼Œéå¶å­èŠ‚ç‚¹åªåŒ…å«é”®å€¼å’ŒæŒ‡é’ˆã€‚</li></ul></li><li><p><strong>æ•°æ®å­˜å‚¨ä½ç½®</strong>ï¼š</p><ul><li><strong>Bæ ‘</strong>ï¼šæ•°æ®å­˜å‚¨åœ¨å„ä¸ªèŠ‚ç‚¹ä¸­ã€‚</li><li><strong>B+æ ‘</strong>ï¼šæ•°æ®å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸­ï¼Œä¸”å¶å­èŠ‚ç‚¹å½¢æˆé“¾è¡¨ã€‚</li></ul></li><li><p><strong>æŸ¥è¯¢æ€§èƒ½</strong>ï¼š</p><ul><li><strong>Bæ ‘</strong>ï¼šæŸ¥æ‰¾è¿‡ç¨‹ä¸­å¯èƒ½åœ¨ä¸åŒæ·±åº¦æ‰¾åˆ°æ•°æ®ã€‚</li><li><strong>B+æ ‘</strong>ï¼šæŸ¥æ‰¾è·¯å¾„é•¿åº¦ç›¸åŒï¼ŒæŸ¥è¯¢æ€§èƒ½æ›´ç¨³å®šã€‚</li></ul></li><li><p><strong>èŒƒå›´æŸ¥è¯¢</strong>ï¼š</p><ul><li><p><strong>Bæ ‘</strong>ï¼šèŒƒå›´æŸ¥è¯¢éœ€è¦éå†å¤šä¸ªèŠ‚ç‚¹ï¼Œä¸å¦‚B+æ ‘é«˜æ•ˆã€‚</p></li><li><p><strong>B+æ ‘</strong>ï¼šå¶å­èŠ‚ç‚¹å½¢æˆé“¾è¡¨ï¼Œé¡ºåºéå†å’ŒèŒƒå›´æŸ¥è¯¢éå¸¸é«˜æ•ˆã€‚</p></li></ul></li></ul><h1 id="2-èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•"><a href="#2-èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•" class="headerlink" title="2. èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•"></a>2. èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•</h1><h2 id="1-èšç°‡ç´¢å¼•-Clustered-Index"><a href="#1-èšç°‡ç´¢å¼•-Clustered-Index" class="headerlink" title="1. èšç°‡ç´¢å¼• (Clustered Index)"></a>1. èšç°‡ç´¢å¼• (Clustered Index)</h2><p><strong>å®šä¹‰</strong>ï¼š èšç°‡ç´¢å¼•å°†æ•°æ®è¡Œçš„ç‰©ç†å­˜å‚¨é¡ºåºä¸ç´¢å¼•é¡ºåºä¸€è‡´ã€‚æ¯å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªèšç°‡ç´¢å¼•ï¼Œå› ä¸ºæ•°æ®è¡Œçš„ç‰©ç†å­˜å‚¨é¡ºåºåªèƒ½æœ‰ä¸€ç§ã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>æ•°æ®è¡Œå’Œç´¢å¼•å­˜å‚¨åœ¨åŒä¸€ä¸ªç»“æ„ä¸­ï¼Œç´¢å¼•å¶å­èŠ‚ç‚¹åŒ…å«å®Œæ•´çš„æ•°æ®è¡Œã€‚</li><li>é€šå¸¸ï¼Œè¡¨çš„ä¸»é”®ä¼šè¢«ä½œä¸ºèšç°‡ç´¢å¼•ã€‚å¦‚æœæ²¡æœ‰æ˜¾å¼å®šä¹‰ä¸»é”®ï¼ŒMySQL ä¼šé€‰æ‹©ä¸€ä¸ªå”¯ä¸€çš„éç©ºç´¢å¼•ä½œä¸ºèšç°‡ç´¢å¼•ï¼›å¦‚æœæ²¡æœ‰è¿™æ ·çš„ç´¢å¼•ï¼ŒMySQL ä¼šç”Ÿæˆä¸€ä¸ªéšè—çš„è¡Œ ID ä½œä¸ºèšç°‡ç´¢å¼•ã€‚</li><li>èšç°‡ç´¢å¼•æé«˜äº†åŸºäºä¸»é”®çš„æŸ¥è¯¢æ€§èƒ½ï¼Œå› ä¸ºç´¢å¼•å’Œæ•°æ®åœ¨åŒä¸€ä¸ªç»“æ„ä¸­ï¼Œæ— éœ€äºŒæ¬¡æŸ¥æ‰¾ã€‚</li><li>æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œçš„æ€§èƒ½å¯èƒ½ä¼šå—åˆ°å½±å“ï¼Œå› ä¸ºæ•°æ®è¡Œçš„ç‰©ç†ä½ç½®å¯èƒ½éœ€è¦è°ƒæ•´ä»¥ç»´æŒç´¢å¼•é¡ºåºã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š å‡è®¾æœ‰ä¸€å¼ è¡¨ <code>employees</code>ï¼Œå®ƒçš„ä¸»é”®æ˜¯ <code>employee_id</code>ï¼Œåˆ™ <code>employee_id</code> å­—æ®µæ˜¯èšç°‡ç´¢å¼•ï¼š</p><h2 id="2-éèšç°‡ç´¢å¼•-Non-clustered-Index"><a href="#2-éèšç°‡ç´¢å¼•-Non-clustered-Index" class="headerlink" title="2. éèšç°‡ç´¢å¼• (Non-clustered Index)"></a>2. éèšç°‡ç´¢å¼• (Non-clustered Index)</h2><p><strong>å®šä¹‰</strong>ï¼š éèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹åŒ…å«æŒ‡å‘æ•°æ®è¡Œçš„æŒ‡é’ˆï¼ˆé€šå¸¸æ˜¯èšç°‡ç´¢å¼•é”®å€¼æˆ–è¡Œ IDï¼‰ï¼Œè€Œä¸æ˜¯å®é™…çš„æ•°æ®è¡Œã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>æ•°æ®è¡Œçš„ç‰©ç†å­˜å‚¨é¡ºåºä¸ç´¢å¼•é¡ºåºæ— å…³ã€‚</li><li>æ¯ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ªéèšç°‡ç´¢å¼•ã€‚</li><li>éèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨ç´¢å¼•é”®å’ŒæŒ‡å‘æ•°æ®è¡Œçš„æŒ‡é’ˆã€‚</li><li>é€šè¿‡éèšç°‡ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œé¦–å…ˆé€šè¿‡ç´¢å¼•æ‰¾åˆ°æŒ‡é’ˆï¼Œç„¶åæ ¹æ®æŒ‡é’ˆæ‰¾åˆ°å®é™…çš„æ•°æ®è¡Œï¼Œè¿™éœ€è¦ä¸€æ¬¡é¢å¤–çš„æŸ¥æ‰¾æ“ä½œã€‚</li></ul><p>å‡è®¾æœ‰ä¸€å¼ è¡¨ <code>employees</code>ï¼Œä½ å¯ä»¥ä¸º <code>name</code> å­—æ®µåˆ›å»ºä¸€ä¸ªéèšç°‡ç´¢å¼•ï¼š</p><h2 id="3-èšç°‡ç´¢å¼•ä¸éèšç°‡ç´¢å¼•çš„åŒºåˆ«"><a href="#3-èšç°‡ç´¢å¼•ä¸éèšç°‡ç´¢å¼•çš„åŒºåˆ«" class="headerlink" title="3 èšç°‡ç´¢å¼•ä¸éèšç°‡ç´¢å¼•çš„åŒºåˆ«"></a>3 èšç°‡ç´¢å¼•ä¸éèšç°‡ç´¢å¼•çš„åŒºåˆ«</h2><ol><li><strong>æ•°æ®å­˜å‚¨æ–¹å¼</strong>ï¼š<ul><li><strong>èšç°‡ç´¢å¼•</strong>ï¼šæ•°æ®è¡ŒæŒ‰ç´¢å¼•é¡ºåºå­˜å‚¨ï¼Œå¶å­èŠ‚ç‚¹åŒ…å«å®é™…çš„æ•°æ®è¡Œã€‚</li><li><strong>éèšç°‡ç´¢å¼•</strong>ï¼šç´¢å¼•ç»“æ„å’Œæ•°æ®åˆ†å¼€å­˜å‚¨ï¼Œå¶å­èŠ‚ç‚¹åŒ…å«æŒ‡å‘æ•°æ®è¡Œçš„æŒ‡é’ˆã€‚</li></ul></li><li><strong>æŸ¥è¯¢æ€§èƒ½</strong>ï¼š<ul><li><strong>èšç°‡ç´¢å¼•</strong>ï¼šå¯¹ä¸»é”®æŸ¥è¯¢éå¸¸é«˜æ•ˆï¼Œå› ä¸ºä¸éœ€è¦é¢å¤–çš„æŸ¥æ‰¾æ“ä½œã€‚</li><li><strong>éèšç°‡ç´¢å¼•</strong>ï¼šæŸ¥è¯¢éœ€è¦å…ˆé€šè¿‡ç´¢å¼•æ‰¾åˆ°æŒ‡é’ˆï¼Œå†é€šè¿‡æŒ‡é’ˆæ‰¾åˆ°æ•°æ®è¡Œï¼Œæœ‰ä¸€å®šçš„æŸ¥æ‰¾å¼€é”€ã€‚</li></ul></li><li><strong>æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ€§èƒ½</strong>ï¼š<ul><li><strong>èšç°‡ç´¢å¼•</strong>ï¼šå¯èƒ½éœ€è¦é‡æ’æ•°æ®è¡Œä»¥ä¿æŒé¡ºåºï¼Œå› æ­¤æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œå¯èƒ½ä¼šæ›´æ…¢ã€‚</li><li><strong>éèšç°‡ç´¢å¼•</strong>ï¼šåªéœ€æ›´æ–°ç´¢å¼•ç»“æ„ï¼Œä¸å½±å“æ•°æ®è¡Œçš„ç‰©ç†é¡ºåºï¼Œæ“ä½œç›¸å¯¹è¾ƒå¿«ã€‚</li></ul></li><li><strong>ç©ºé—´ä½¿ç”¨</strong>ï¼š<ul><li><strong>èšç°‡ç´¢å¼•</strong>ï¼šç”±äºæ•°æ®è¡Œå­˜å‚¨åœ¨ç´¢å¼•ç»“æ„ä¸­ï¼Œå¯èƒ½ä¼šå ç”¨æ›´å¤šçš„å­˜å‚¨ç©ºé—´ã€‚</li><li><strong>éèšç°‡ç´¢å¼•</strong>ï¼šç´¢å¼•ç»“æ„è¾ƒå°ï¼Œå› ä¸ºåªåŒ…å«ç´¢å¼•é”®å’ŒæŒ‡é’ˆã€‚</li></ul></li></ol><h2 id="4-å®é™…åº”ç”¨ä¸­çš„é€‰æ‹©"><a href="#4-å®é™…åº”ç”¨ä¸­çš„é€‰æ‹©" class="headerlink" title="4 å®é™…åº”ç”¨ä¸­çš„é€‰æ‹©"></a>4 å®é™…åº”ç”¨ä¸­çš„é€‰æ‹©</h2><ul><li><strong>èšç°‡ç´¢å¼•</strong>ï¼šé€‚ç”¨äºé¢‘ç¹çš„åŸºäºä¸»é”®çš„æŸ¥è¯¢æ“ä½œï¼Œå°¤å…¶æ˜¯èŒƒå›´æŸ¥è¯¢ã€‚ä¾‹å¦‚ï¼ŒæŒ‰æ—¥æœŸæˆ–IDèŒƒå›´æŸ¥è¯¢æ•°æ®æ—¶ï¼Œèšç°‡ç´¢å¼•å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ã€‚</li><li><strong>éèšç°‡ç´¢å¼•</strong>ï¼šé€‚ç”¨äºå…¶ä»–é¢‘ç¹æŸ¥è¯¢çš„åˆ—ï¼Œæ¯”å¦‚æœç´¢ã€è¿‡æ»¤å’Œæ’åºæ“ä½œã€‚éèšç°‡ç´¢å¼•å¯ä»¥åŠ å¿«è¿™äº›æ“ä½œçš„é€Ÿåº¦ï¼Œä½†è¦æ³¨æ„ç»´æŠ¤ç´¢å¼•å¸¦æ¥çš„é¢å¤–å¼€é”€ã€‚</li></ul><h1 id="3-InnoDBå’ŒMyISAMå¯¹æ¯”"><a href="#3-InnoDBå’ŒMyISAMå¯¹æ¯”" class="headerlink" title="3 InnoDBå’ŒMyISAMå¯¹æ¯”"></a>3 InnoDBå’ŒMyISAMå¯¹æ¯”</h1><p>å­˜å‚¨å¼•æ“æ˜¯å¯¹äºè¡¨è€Œè¨€çš„ï¼Œä¸åŒçš„è¡¨å¯ä»¥è®¾ç½®ä¸åŒçš„å­˜å‚¨å¼•æ“</p><h2 id="1-InnoDb"><a href="#1-InnoDb" class="headerlink" title="1 InnoDb"></a>1 InnoDb</h2><ul><li><p>é€‚åˆéœ€è¦äº‹åŠ¡å’Œå¤–é”®çº¦æŸã€‚</p></li><li><p>é«˜åº¦å¹¶å‘çš„è¯»å†™æ“ä½œæ€§èƒ½è¾ƒå¥½ã€‚</p></li><li><p>æ”¯æŒè¡Œçº§é”å®šï¼Œæé«˜å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</p></li><li><p>æ”¯æŒèšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•ã€‚</p><ul><li>InnoDB ä½¿ç”¨ B+ æ ‘ç»“æ„å®ç°èšç°‡ç´¢å¼•ã€‚æ¯ä¸ª InnoDB è¡¨éƒ½æœ‰ä¸€ä¸ªèšç°‡ç´¢å¼•ï¼Œé€šå¸¸æ˜¯è¡¨çš„ä¸»é”®ã€‚å¦‚æœæ²¡æœ‰æ˜¾å¼å®šä¹‰ä¸»é”®ï¼ŒInnoDB ä¼šé€‰æ‹©ä¸€ä¸ªå”¯ä¸€çš„éç©ºç´¢å¼•ä½œä¸ºèšç°‡ç´¢å¼•ï¼›å¦‚æœæ²¡æœ‰è¿™æ ·çš„ç´¢å¼•ï¼ŒInnoDB ä¼šç”Ÿæˆä¸€ä¸ªéšè—çš„è¡Œ ID ä½œä¸ºèšç°‡ç´¢å¼•ã€‚</li><li>ç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åœ¨ä¸€èµ·çš„ã€‚ ç´¢å¼•æ–‡ä»¶+ æ•°æ®æ–‡ä»¶ æ˜¯xxx.ibd</li><li>å¶å­ç»“ç‚¹åŒ…å«äº†å®Œæ•´çš„æ•°æ®è®°å½•ï¼Œdataé‡Œå­˜å‚¨çš„æ˜¯ï¼šç´¢å¼•æ‰€åœ¨è¡Œçš„å…¶ä»–æ‰€æœ‰æ•°æ®</li></ul></li></ul><h2 id="2-MyISAMç´¢å¼•"><a href="#2-MyISAMç´¢å¼•" class="headerlink" title="2 MyISAMç´¢å¼•"></a>2 MyISAMç´¢å¼•</h2><ul><li><p>ä¸æ”¯æŒäº‹åŠ¡å’Œå¤–é”®çº¦æŸã€‚</p></li><li><p>é€‚åˆè¯»æ“ä½œå¤šäºå†™æ“ä½œçš„åº”ç”¨ã€‚</p></li><li><p>è¡¨çº§é”å®šï¼Œå†™æ“ä½œä¼šé”å®šæ•´ä¸ªè¡¨ï¼Œé€‚åˆä½å¹¶å‘å†™æ“ä½œçš„åº”ç”¨ã€‚</p></li><li><p>ç´¢å¼•æ–‡ä»¶è¾ƒå°ï¼Œé€‚åˆå¤§é‡è¯»æ“ä½œå’Œå…¨æ–‡ç´¢å¼•ã€‚</p></li></ul><ul><li>åªæ”¯æŒéèšç°‡ç´¢å¼•ï¼Œä¸æ”¯æŒèšç°‡ç´¢å¼•ã€‚<ul><li>æ•…MyISAMç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„ã€‚ç´¢å¼•æ–‡ä»¶æ˜¯xxx.MYI, æ•°æ®æ–‡ä»¶æ˜¯xxx.MYD</li></ul></li></ul><blockquote><p>æ‰§è¡Œæµç¨‹ï¼šå½“æœ‰ä¸€æ¡æŸ¥è¯¢è¯­å¥ï¼šwhere Col1 &#x3D; 49ï¼Œ å…ˆåˆ¤æ–­æœ‰æ²¡æœ‰èµ°ç´¢å¼•ï¼Œèµ°ç´¢å¼•çš„è¯ï¼Œå…ˆæ ¹æ®49å¿«é€Ÿåœ¨MYIæ–‡ä»¶ä¸­å®šä½åˆ°ç»“ç‚¹ï¼Œè·å–è¯¥ç»“ç‚¹å­˜å‚¨çš„ç´¢å¼•æ‰€åœ¨è¡Œçš„ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ0x90ï¼Œå†å»MYDä¸­å®šä½æ•°æ®ã€‚</p></blockquote><h1 id="4-æœ€å·¦å‰ç¼€æ³•åˆ™"><a href="#4-æœ€å·¦å‰ç¼€æ³•åˆ™" class="headerlink" title="4 æœ€å·¦å‰ç¼€æ³•åˆ™"></a>4 æœ€å·¦å‰ç¼€æ³•åˆ™</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h2><p>å¯¹äºä¸€ä¸ªå¤šåˆ—ç´¢å¼•ï¼ŒæŸ¥è¯¢æ¡ä»¶å¿…é¡»ä»ç´¢å¼•çš„æœ€å·¦åˆ—å¼€å§‹å¹¶æŒ‰é¡ºåºä½¿ç”¨ï¼Œå¦åˆ™ç´¢å¼•ä¸ä¼šè¢«å®Œå…¨åˆ©ç”¨ã€‚MySQL æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šé‡æ–°æ’åˆ—æ¡ä»¶é¡ºåºï¼Œä»¥å……åˆ†åˆ©ç”¨ç´¢å¼•ã€‚å› æ­¤ï¼Œå³ä½¿æ¡ä»¶é¡ºåºä¸åŒï¼Œåªè¦åŒ…å«ç´¢å¼•çš„å‰ç¼€éƒ¨åˆ†ï¼Œç´¢å¼•ä»ä¼šè¢«ä½¿ç”¨ã€‚</p><p>å³ï¼šå‡è®¾ä½ å»ºç«‹äº†ä¸€ä¸ªè”åˆç´¢å¼•ï¼ˆAï¼ŒBï¼ŒCï¼‰ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡ŒæŸ¥è¯¢çš„æ—¶å€™  <code>where A=xx1 </code>æˆ–è€… <code>where A=xx1 and B=xx2  </code>æˆ–è€…<code>where A=xx1 and B=xx2 and C=xx3 </code>ä¼šèµ°ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢ä¼˜åŒ–ï¼Œå› ä¸ºä»–ä»¬éƒ½æ˜¯ä»æœ€å·¦åˆ—Aå¼€å§‹ã€‚</p><p>æ¯”å¦‚ï¼š <code>where B=xx1 and C=xx2  </code> å°±ä¸ä¼šèµ°ç´¢å¼•</p><p> <code>where a=xx1 and C=xx2  </code> å°±ä¼šèµ°éƒ¨åˆ†ç´¢å¼•ï¼Œå³Açš„éƒ¨åˆ†</p><h2 id="2-åŸå› "><a href="#2-åŸå› " class="headerlink" title="2. åŸå› "></a>2. åŸå› </h2><p>æœ€å·¦åŒ¹é…åŸåˆ™éƒ½æ˜¯é’ˆå¯¹è”åˆç´¢å¼•æ¥è¯´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»è”åˆç´¢å¼•çš„åŸç†æ¥äº†è§£æœ€å·¦åŒ¹é…åŸåˆ™ã€‚</p><p>ç´¢å¼•çš„åº•å±‚æ˜¯ä¸€é¢— B+ æ ‘ï¼Œé‚£ä¹ˆè”åˆç´¢å¼•å½“ç„¶è¿˜æ˜¯ä¸€é¢— B+ æ ‘ï¼Œåªä¸è¿‡è”åˆç´¢å¼•çš„é”®å€¼æ•°é‡ä¸æ˜¯ä¸€ä¸ªï¼Œè€Œæ˜¯å¤šä¸ªã€‚æ„å»ºä¸€é¢— B+ æ ‘åªèƒ½æ ¹æ®ä¸€ä¸ªå€¼æ¥æ„å»ºï¼Œå› æ­¤æ•°æ®åº“ä¾æ®è”åˆç´¢å¼•æœ€å·¦çš„å­—æ®µæ¥æ„å»º B+ æ ‘ã€‚å½¢å¦‚(a,b,c)è”åˆç´¢å¼•çš„ b+ æ ‘ã€‚a æ˜¯æœ‰åºçš„ï¼Œè€Œ bï¼Œc éƒ½æ˜¯æ— åºçš„ã€‚ä½†æ˜¯å½“åœ¨ a ç›¸åŒçš„æ—¶å€™ï¼Œb æ˜¯æœ‰åºçš„ï¼Œb ç›¸åŒçš„æ—¶å€™ï¼Œc åˆæ˜¯æœ‰åºçš„ã€‚å³åªæœ‰å…ˆç¡®å®šäº†å‰ä¸€ä¸ªï¼ˆå·¦ä¾§çš„å€¼ï¼‰åï¼Œæ‰èƒ½ç¡®å®šä¸‹ä¸€ä¸ªå€¼ã€‚</p><h1 id="5-ä¸ºä»€ä¹ˆInnoDbè¡¨è¦å°½é‡è®¾å®šä¸€ä¸ªä¸»é”®"><a href="#5-ä¸ºä»€ä¹ˆInnoDbè¡¨è¦å°½é‡è®¾å®šä¸€ä¸ªä¸»é”®" class="headerlink" title="5 ä¸ºä»€ä¹ˆInnoDbè¡¨è¦å°½é‡è®¾å®šä¸€ä¸ªä¸»é”®"></a>5 ä¸ºä»€ä¹ˆInnoDbè¡¨è¦å°½é‡è®¾å®šä¸€ä¸ªä¸»é”®</h1><ul><li>innnoDbè¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯æŒ‰B+treeç»„ç»‡çš„ä¸€ä¸ªç´¢å¼•æ–‡ä»¶</li><li>ä¸»é”®æ˜¯æ•°æ®åº“ç¡®ä¿æ•°æ®è¡Œåœ¨æ•´å¼ è¡¨å”¯ä¸€æ€§çš„ä¿éšœ.</li><li>è®¾å®šäº†ä¸»é”®ä¹‹åï¼Œåœ¨åç»­çš„åˆ æ”¹æŸ¥çš„æ—¶å€™å¯èƒ½æ›´åŠ å¿«é€Ÿä»¥åŠç¡®ä¿æ“ä½œæ•°æ®èŒƒå›´å®‰å…¨ã€‚ </li><li>å¦‚æœæ²¡æœ‰ä¸»é”®ï¼ŒInnoDBä¼šé€‰æ‹©ä¸€ä¸ªå”¯ä¸€é”®æ¥ä½œä¸ºèšç°‡ç´¢ å¼•ï¼Œå¦‚æœæ²¡æœ‰å”¯ä¸€é”®ï¼Œä¼šç”Ÿæˆä¸€ä¸ªéšå¼çš„ä¸»é”®ã€‚</li></ul><h1 id="6-ä¸»é”®ä½¿ç”¨æ•´å‹çš„è‡ªå¢IDè€Œä¸æ˜¯UUIDï¼Ÿ"><a href="#6-ä¸»é”®ä½¿ç”¨æ•´å‹çš„è‡ªå¢IDè€Œä¸æ˜¯UUIDï¼Ÿ" class="headerlink" title="6 ä¸»é”®ä½¿ç”¨æ•´å‹çš„è‡ªå¢IDè€Œä¸æ˜¯UUIDï¼Ÿ"></a>6 ä¸»é”®ä½¿ç”¨æ•´å‹çš„è‡ªå¢IDè€Œä¸æ˜¯UUIDï¼Ÿ</h1><ul><li>æŸ¥æ‰¾å…ƒç´ çš„æ—¶å€™ä¼šæ¶‰åŠåˆ°å¤§é‡çš„æ•°æ®æ¯”è¾ƒï¼Œæ•´å‹æ¯”å­—ç¬¦ä¸²å¿«</li><li>UUIDå ç”¨çš„å­˜å‚¨ç©ºé—´ä¼šå¤§äºæ•´å½¢</li><li>å¶å­ç»“ç‚¹æ˜¯æŒ‰é¡ºåºæ’åˆ—çš„ï¼Œå¦‚æœä¸»é”®ç´¢ å¼•æ˜¯è‡ªå¢IDï¼Œé‚£ä¹ˆåªéœ€è¦ä¸æ–­å‘åæ’åˆ—å³å¯ï¼Œå¦‚æœæ˜¯UUIDï¼Œç”±äºåˆ°æ¥çš„IDä¸åŸæ¥çš„å¤§å°ä¸ç¡®å®šï¼Œåœ¨ç»´æŠ¤B+æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œä¼šé€ æˆéå¸¸å¤šçš„æ•°æ®æ’å…¥ï¼Œæ•°æ®ç§»åŠ¨ï¼Œç„¶åå¯¼è‡´äº§ç”Ÿå¾ˆå¤šçš„å†… å­˜ç¢ç‰‡ï¼Œè¿›è€Œé€ æˆæ’å…¥æ€§èƒ½çš„ä¸‹é™ã€‚</li></ul><h1 id="7-è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ"><a href="#7-è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ" class="headerlink" title="7 è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ"></a>7 è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ</h1><ul><li>5ä¸ªå•å€¼ç´¢å¼•ï¼Œå¯¹åº”5æ£µB+æ ‘ï¼Œè”åˆç´¢å¼•å°±åªéœ€è¦ä¸€æ£µæ ‘ï¼Œæ‰€ä»¥æ—¥å¸¸æ¨èä½¿ç”¨è”åˆç´¢å¼•è€Œä¸æ˜¯å•å€¼ç´¢å¼•ã€‚</li><li>ç´¢å¼•æ’åºçš„æ—¶å€™ä¼šæŒ‰ç…§å­—æ®µé¡ºåºï¼Œé€ä¸ªå»æ’åº</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230412331.png" alt="image-20230228230412331"></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>zookeeperå¸¸è§é¢è¯•é¢˜</title>
    <link href="/zookeeper%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/zookeeper%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Zookeeperé›†ç¾¤ä¸­æœ‰å‡ ä¸ªè§’è‰²"><a href="#1-Zookeeperé›†ç¾¤ä¸­æœ‰å‡ ä¸ªè§’è‰²" class="headerlink" title="1. Zookeeperé›†ç¾¤ä¸­æœ‰å‡ ä¸ªè§’è‰²"></a>1. Zookeeperé›†ç¾¤ä¸­æœ‰å‡ ä¸ªè§’è‰²</h1><p>Zookeeperé›†ç¾¤ä¸­æœ‰ä¸‰ä¸ªä¸»è¦è§’è‰²ï¼š</p><ul><li><strong>Leader</strong>ï¼šè´Ÿè´£å¤„ç†å†™è¯·æ±‚å’ŒåŒæ­¥æ•°æ®åˆ°Followersã€‚</li><li><strong>Follower</strong>ï¼šå¤„ç†è¯»è¯·æ±‚ï¼Œå‚ä¸é€‰ä¸¾è¿‡ç¨‹ã€‚</li><li><strong>Observer</strong>ï¼šä¸å‚ä¸æŠ•ç¥¨é€‰ä¸¾ï¼Œä»…åŒæ­¥Leaderçš„æ•°æ®ï¼Œç”¨äºæ‰©å±•è¯»å–æ€§èƒ½ã€‚</li></ul><h1 id="2-Zookeeperå¦‚ä½•ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Ÿ"><a href="#2-Zookeeperå¦‚ä½•ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Ÿ" class="headerlink" title="2.  Zookeeperå¦‚ä½•ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Ÿ"></a>2.  Zookeeperå¦‚ä½•ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Ÿ</h1><p>Zookeeperä½¿ç”¨ä¸€ç§ç§°ä¸ºZABåè®®ï¼ˆZookeeper Atomic Broadcastï¼‰çš„åè®®æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚å®ƒç¡®ä¿æ‰€æœ‰å†™æ“ä½œåœ¨LeaderèŠ‚ç‚¹ä¸Šè¿›è¡Œï¼ŒLeaderé€šè¿‡å¹¿æ’­å°†æ•°æ®åŒæ­¥åˆ°Followersï¼Œä»è€Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚</p><h1 id="3-ä»€ä¹ˆæ˜¯ZABåè®®ï¼Ÿ"><a href="#3-ä»€ä¹ˆæ˜¯ZABåè®®ï¼Ÿ" class="headerlink" title="3. ä»€ä¹ˆæ˜¯ZABåè®®ï¼Ÿ"></a>3. ä»€ä¹ˆæ˜¯ZABåè®®ï¼Ÿ</h1><p>ZABåè®®ï¼ˆZookeeper Atomic Broadcastï¼‰æ˜¯Zookeeperç”¨äºä¿è¯æ•°æ®ä¸€è‡´æ€§çš„æ ¸å¿ƒåè®®ã€‚å®ƒåŒ…æ‹¬ä¸¤ç§ä¸»è¦æ¨¡å¼ï¼š</p><ul><li><strong>æ¶ˆæ¯å¹¿æ’­æ¨¡å¼</strong>ï¼šç”¨äºæ­£å¸¸æ“ä½œæœŸé—´ï¼Œå°†Leaderä¸Šçš„æ•°æ®æ›´æ–°å¹¿æ’­åˆ°æ‰€æœ‰Followersã€‚</li><li><strong>å´©æºƒæ¢å¤æ¨¡å¼</strong>ï¼šç”¨äºLeaderå´©æºƒæ—¶ï¼Œé€‰ä¸¾æ–°çš„Leaderå¹¶åŒæ­¥æ•°æ®ã€‚</li></ul><h1 id="4-Zookeeperé›†ç¾¤éœ€è¦å¤šå°‘ä¸ªèŠ‚ç‚¹æ¥ä¿è¯é«˜å¯ç”¨æ€§ï¼Ÿ"><a href="#4-Zookeeperé›†ç¾¤éœ€è¦å¤šå°‘ä¸ªèŠ‚ç‚¹æ¥ä¿è¯é«˜å¯ç”¨æ€§ï¼Ÿ" class="headerlink" title="4. Zookeeperé›†ç¾¤éœ€è¦å¤šå°‘ä¸ªèŠ‚ç‚¹æ¥ä¿è¯é«˜å¯ç”¨æ€§ï¼Ÿ"></a>4. Zookeeperé›†ç¾¤éœ€è¦å¤šå°‘ä¸ªèŠ‚ç‚¹æ¥ä¿è¯é«˜å¯ç”¨æ€§ï¼Ÿ</h1><p>Zookeeperé›†ç¾¤é€šå¸¸ç”±2N+1ä¸ªèŠ‚ç‚¹ç»„æˆï¼Œä»¥ä¿è¯åœ¨Nä¸ªèŠ‚ç‚¹æ•…éšœçš„æƒ…å†µä¸‹ï¼Œé›†ç¾¤ä»èƒ½æ­£å¸¸å·¥ä½œã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç”±5ä¸ªèŠ‚ç‚¹ç»„æˆçš„é›†ç¾¤å¯ä»¥å®¹å¿2ä¸ªèŠ‚ç‚¹æ•…éšœã€‚</p><h1 id="5-åœ¨ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦è¿›è¡ŒLeaderé€‰ä¸¾ï¼Ÿ"><a href="#5-åœ¨ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦è¿›è¡ŒLeaderé€‰ä¸¾ï¼Ÿ" class="headerlink" title="5. åœ¨ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦è¿›è¡ŒLeaderé€‰ä¸¾ï¼Ÿ"></a>5. åœ¨ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦è¿›è¡ŒLeaderé€‰ä¸¾ï¼Ÿ</h1><ul><li>Zookeeperé›†ç¾¤å¯åŠ¨æ—¶ï¼Œæ²¡æœ‰Leaderã€‚</li><li>å½“å‰LeaderèŠ‚ç‚¹å´©æºƒæˆ–å¤±è”ã€‚</li><li>ç½‘ç»œåˆ†åŒºå¯¼è‡´éƒ¨åˆ†èŠ‚ç‚¹æ— æ³•ä¸Leaderé€šä¿¡ã€‚</li></ul><h1 id="6-Zookeeperçš„é€‰ä¸¾æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#6-Zookeeperçš„é€‰ä¸¾æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="6. Zookeeperçš„é€‰ä¸¾æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ"></a>6. Zookeeperçš„é€‰ä¸¾æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>Zookeeperä½¿ç”¨ZABåè®®çš„Leaderé€‰ä¸¾æœºåˆ¶æ¥é€‰ä¸¾æ–°çš„Leaderã€‚é€‰ä¸¾æœºåˆ¶ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ul><li><strong>å¯åŠ¨æœŸé—´çš„Leaderé€‰ä¸¾</strong>ï¼šå½“Zookeeperé›†ç¾¤å¯åŠ¨æ—¶ï¼Œæ²¡æœ‰Leaderï¼Œæ‰€æœ‰èŠ‚ç‚¹ä¼šè¿›è¡ŒæŠ•ç¥¨é€‰ä¸¾Leaderã€‚</li><li><strong>Leaderå´©æºƒåçš„Leaderé€‰ä¸¾</strong>ï¼šå¦‚æœLeaderèŠ‚ç‚¹å´©æºƒï¼Œå‰©ä½™èŠ‚ç‚¹ä¼šé‡æ–°é€‰ä¸¾æ–°çš„Leaderã€‚</li></ul><h1 id="7-é€‰ä¸¾è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ"><a href="#7-é€‰ä¸¾è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ" class="headerlink" title="7. é€‰ä¸¾è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ"></a>7. é€‰ä¸¾è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ</h1><ol><li><p><strong>å¯åŠ¨é€‰ä¸¾</strong>ï¼šå½“ZooKeeperé›†ç¾¤å¯åŠ¨æ—¶ï¼Œæ‰€æœ‰èŠ‚ç‚¹ï¼ˆServerï¼‰éƒ½ä¼šå¤„äº LOOKING çŠ¶æ€ï¼Œè¡¨ç¤ºå®ƒä»¬åœ¨å¯»æ‰¾ä¸€ä¸ªé¢†å¯¼è€…ã€‚</p></li><li><p><strong>æŠ•ç¥¨é˜¶æ®µ</strong>ï¼š</p><ul><li><p>æ¯ä¸ªèŠ‚ç‚¹å‘å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹å‘é€ä¸€æ¡æŠ•ç¥¨ä¿¡æ¯ã€‚æŠ•ç¥¨ä¿¡æ¯åŒ…å«èŠ‚ç‚¹è‡ªèº«çš„IDï¼ˆmyidï¼‰ã€å…¶å½“å‰çš„ZXIDï¼ˆäº‹åŠ¡IDï¼‰ã€ä»¥åŠå®ƒè®¤ä¸ºçš„Leaderçš„IDå’ŒZXIDã€‚</p></li><li><p>èŠ‚ç‚¹åœ¨åˆå§‹çŠ¶æ€ä¸‹ä¼šæŠ•è‡ªå·±ä½œä¸ºLeaderï¼Œå¹¶å‘å…¶ä»–èŠ‚ç‚¹å‘é€è¿™ä¸ªæŠ•ç¥¨ã€‚</p></li></ul></li><li><p><strong>æ¥æ”¶æŠ•ç¥¨</strong>ï¼š</p><ul><li><p>æ¯ä¸ªèŠ‚ç‚¹æ¥æ”¶åˆ°æ¥è‡ªå…¶ä»–èŠ‚ç‚¹çš„æŠ•ç¥¨ä¿¡æ¯åï¼Œä¼šå¯¹è¿™äº›æŠ•ç¥¨è¿›è¡Œæ¯”è¾ƒã€‚</p></li><li><p>æ¯”è¾ƒçš„ä¾æ®æ˜¯é¦–å…ˆçœ‹ZXIDï¼ŒZXIDå¤§çš„èŠ‚ç‚¹æ›´æœ‰å¯èƒ½æˆä¸ºLeaderã€‚å¦‚æœZXIDç›¸åŒï¼Œåˆ™æ¯”è¾ƒèŠ‚ç‚¹IDï¼ŒIDå¤§çš„èŠ‚ç‚¹ä¼šè¢«é€‰ä¸ºLeaderã€‚</p></li></ul></li><li><p><strong>æ›´æ–°æŠ•ç¥¨</strong>ï¼š</p><ul><li>å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ¥æ”¶åˆ°çš„æŠ•ç¥¨ä¿¡æ¯ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªæ¯”è‡ªå·±å½“å‰æŠ•ç¥¨æ›´é«˜çš„ï¼ˆæ ¹æ®ZXIDå’ŒèŠ‚ç‚¹IDæ¯”è¾ƒï¼‰ï¼Œé‚£ä¹ˆè¯¥èŠ‚ç‚¹ä¼šæ›´æ–°è‡ªå·±çš„æŠ•ç¥¨ä¿¡æ¯ï¼Œå¹¶é‡æ–°å‘é€æŠ•ç¥¨ã€‚</li><li>è¿™æ ·ä¸æ–­åœ°æ›´æ–°å’Œä¼ æ’­æŠ•ç¥¨ä¿¡æ¯ï¼Œæœ€ç»ˆæ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šè¶‹å‘äºè®¤å¯åŒä¸€ä¸ªLeaderã€‚</li></ul></li><li><p><strong>èƒœå‡ºè€…</strong>ï¼š</p><ul><li>å½“æŸä¸ªèŠ‚ç‚¹å‘ç°è‡ªå·±æ”¶åˆ°çš„å¤§å¤šæ•°æŠ•ç¥¨ï¼ˆè¶…è¿‡åŠæ•°ï¼‰éƒ½è®¤å¯åŒä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºLeaderæ—¶ï¼Œè¿™ä¸ªèŠ‚ç‚¹å°±ä¼šè®¤ä¸ºé€‰ä¸¾å®Œæˆï¼Œå¹¶å°†è‡ªå·±çŠ¶æ€ä»LOOKINGè½¬æ¢ä¸ºFOLLOWINGæˆ–LEADINGã€‚</li><li>Leaderä¼šå°†å…¶ä»–èŠ‚ç‚¹çš„çŠ¶æ€ä»LOOKINGè½¬æ¢ä¸ºFOLLOWINGæˆ–OBSERVINGã€‚</li></ul></li><li><p><strong>å®Œæˆé€‰ä¸¾</strong>ï¼šä¸€æ—¦å¤§å¤šæ•°èŠ‚ç‚¹è¾¾æˆä¸€è‡´ï¼Œé€‰ä¸¾è¿‡ç¨‹ç»“æŸï¼ŒLeaderèŠ‚ç‚¹å¼€å§‹å·¥ä½œï¼ŒFollowerèŠ‚ç‚¹å¼€å§‹åŒæ­¥æ•°æ®ã€‚ã€‚</p></li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20240707232914392.png" alt="image-20240707232914392"></p><h1 id="8-Leaderé€‰ä¸¾çš„ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#8-Leaderé€‰ä¸¾çš„ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="8. Leaderé€‰ä¸¾çš„ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ"></a>8. Leaderé€‰ä¸¾çš„ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>Zookeeperä½¿ç”¨Fast Paxosç®—æ³•çš„ä¸€ç§å˜ç§è¿›è¡ŒLeaderé€‰ä¸¾ã€‚é€‰ä¸¾è¿‡ç¨‹é€šè¿‡æ¯”è¾ƒæ¯ä¸ªèŠ‚ç‚¹çš„epochï¼ˆæ—¶ä»£ç¼–å·ï¼‰å’Œzxidï¼ˆäº‹åŠ¡IDï¼‰æ¥å†³å®šLeaderï¼Œé€‰æ‹©epochå’Œzxidæœ€å¤§çš„èŠ‚ç‚¹ä½œä¸ºLeaderã€‚</p><h1 id="9-Zookeeperå¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜ï¼Ÿ"><a href="#9-Zookeeperå¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜ï¼Ÿ" class="headerlink" title="9.  Zookeeperå¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜ï¼Ÿ"></a>9.  Zookeeperå¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜ï¼Ÿ</h1><p>Zookeeperä½¿ç”¨å¤šæ•°æ´¾æœºåˆ¶æ¥åº”å¯¹è„‘è£‚é—®é¢˜ã€‚åœ¨Zookeeperé›†ç¾¤ä¸­ï¼š</p><ul><li>åªæœ‰è¶…è¿‡åŠæ•°çš„èŠ‚ç‚¹åŒæ„çš„æ“ä½œæ‰ä¼šè¢«æ‰§è¡Œï¼ˆå¦‚å†™æ“ä½œã€Leaderé€‰ä¸¾ç­‰ï¼‰ã€‚å³ä½¿åŸæ¥çš„é›†ç¾¤åˆ†è£‚æˆå¤šä¸ªå°é›†ç¾¤ï¼Œé‚£ä¹ˆæ‹¥æœ‰è¶…è¿‡åŸé›†ç¾¤åŠæ•°èŠ‚ç‚¹çš„é›†ç¾¤è‡³å¤šåªæœ‰ä¸€ä¸ªï¼Œå› æ­¤è‡³å¤šåªä¼šæœ‰ä¸€ä¸ªå°é›†ç¾¤å¯ä»¥æˆåŠŸé€‰ä¸¾å‡ºleaderï¼Œå°±é¿å…äº†è„‘è£‚ã€‚</li><li>ä»»ä½•ä¸€ä¸ªå­é›†è‹¥æœªè¾¾åˆ°è¶…è¿‡åŠæ•°èŠ‚ç‚¹ï¼Œåˆ™ä¸èƒ½å¯¹å¤–æä¾›æœåŠ¡ã€‚</li></ul><p>å…·ä½“æªæ–½åŒ…æ‹¬ï¼š</p><ol><li><strong>ZABåè®®</strong>ï¼šZookeeper Atomic Broadcaståè®®ç¡®ä¿åœ¨Leaderå´©æºƒåé‡æ–°é€‰ä¸¾æ–°çš„Leaderï¼Œå¹¶åŒæ­¥æ•°æ®ï¼Œä¿è¯ä¸€è‡´æ€§ã€‚</li><li><strong>é€‰ä¸¾æœºåˆ¶</strong>ï¼šZookeeperé€šè¿‡å¿«é€Ÿé€‰ä¸¾ç®—æ³•é€‰æ‹©æ–°çš„Leaderï¼Œç¡®ä¿é€‰ä¸¾è¿‡ç¨‹é«˜æ•ˆå¯é ã€‚</li><li><strong>åŒæ­¥æœºåˆ¶</strong>ï¼šæ–°çš„Leaderå½“é€‰åï¼Œä¼šä¸Followersè¿›è¡Œæ•°æ®åŒæ­¥ï¼Œç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹æ•°æ®ä¸€è‡´ã€‚</li></ol><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p>å‡è®¾æœ‰ä¸€ä¸ªç”±5ä¸ªèŠ‚ç‚¹ç»„æˆçš„Zookeeperé›†ç¾¤ï¼š</p><ul><li>åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ‰€æœ‰5ä¸ªèŠ‚ç‚¹äº’ç›¸é€šä¿¡ï¼Œåè°ƒä¸€è‡´ã€‚</li><li>å‘ç”Ÿç½‘ç»œåˆ†åŒºåï¼ŒèŠ‚ç‚¹å¯èƒ½è¢«åˆ†ä¸ºä¸¤ä¸ªå­é›†ï¼Œä¸€ä¸ªåŒ…å«3ä¸ªèŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªåŒ…å«2ä¸ªèŠ‚ç‚¹ã€‚</li><li>ç”±äºZookeeperä½¿ç”¨å¤šæ•°æ´¾æœºåˆ¶ï¼ŒåŒ…å«3ä¸ªèŠ‚ç‚¹çš„å­é›†å¯ä»¥ç»§ç»­å¯¹å¤–æä¾›æœåŠ¡ï¼ˆå› ä¸º3 &gt; 5&#x2F;2ï¼‰ï¼Œè€ŒåŒ…å«2ä¸ªèŠ‚ç‚¹çš„å­é›†åˆ™æš‚åœæœåŠ¡ã€‚</li></ul><p>é€šè¿‡è¿™äº›æœºåˆ¶ï¼ŒZookeeperæœ‰æ•ˆé¿å…äº†è„‘è£‚é—®é¢˜ï¼Œç¡®ä¿ç³»ç»Ÿçš„ä¸€è‡´æ€§å’Œæ­£ç¡®æ€§ã€‚</p><p><strong>ZooKeeperé›†ç¾¤Leaderé€‰ä¸¾ä¸­,ä¸º ä»€ä¹ˆå¿…é¡»è¶…è¿‡é›†ç¾¤æ€»èŠ‚ç‚¹æ•°é‡ä¸€åŠçš„èŠ‚ç‚¹æ”¶åˆ°ç›¸åŒæŠ•ç¥¨,æ‰èƒ½é€‰ä¸¾å‡º Leader?</strong></p><p>ç­”:æ˜¯ä¸ºäº†é˜²æ­¢å› ä¸ºé›†ç¾¤è„‘è£‚å¯¼è‡´æ•´ä¸ªZooKeeperé›†ç¾¤ä¸å¯ç”¨ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å­—ç¬¦ä¸²æ—‹è½¬</title>
    <link href="/%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%97%8B%E8%BD%AC/"/>
    <url>/%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%97%8B%E8%BD%AC/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è‚¡ç¥¨ä¹°å–</title>
    <link href="/%E8%82%A1%E7%A5%A8%E4%B9%B0%E5%8D%96/"/>
    <url>/%E8%82%A1%E7%A5%A8%E4%B9%B0%E5%8D%96/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>äºŒå‰æ ‘ç®—æ³•é¢˜</title>
    <link href="/%E4%BA%8C%E5%8F%89%E6%A0%91%E7%AE%97%E6%B3%95%E9%A2%98/"/>
    <url>/%E4%BA%8C%E5%8F%89%E6%A0%91%E7%AE%97%E6%B3%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-åŸºæœ¬äºŒå‰æ ‘éå†"><a href="#1-åŸºæœ¬äºŒå‰æ ‘éå†" class="headerlink" title="1. åŸºæœ¬äºŒå‰æ ‘éå†"></a>1. åŸºæœ¬äºŒå‰æ ‘éå†</h1><h2 id="1-å‰åºéå†ï¼ˆPre-order-Traversalï¼‰"><a href="#1-å‰åºéå†ï¼ˆPre-order-Traversalï¼‰" class="headerlink" title="1. å‰åºéå†ï¼ˆPre-order Traversalï¼‰"></a>1. å‰åºéå†ï¼ˆPre-order Traversalï¼‰</h2><p>å‰åºéå†çš„é¡ºåºæ˜¯ï¼šæ ¹èŠ‚ç‚¹ -&gt; å·¦å­æ ‘ -&gt; å³å­æ ‘ã€‚</p><p><strong>ç®—æ³•æ­¥éª¤ï¼š</strong></p><ol><li>è®¿é—®æ ¹èŠ‚ç‚¹ã€‚</li><li>å‰åºéå†å·¦å­æ ‘ã€‚</li><li>å‰åºéå†å³å­æ ‘ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BinaryTree</span> </span>&#123;<br>    <span class="hljs-comment">// å‰åºéå† - é€’å½’</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">preOrderTraverse</span><span class="hljs-params">(TreeNode node)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (node != <span class="hljs-keyword">null</span>) &#123;<br>            System.out.print(node.value + <span class="hljs-string">&quot; &quot;</span>);<br>            preOrderTraversal(node.left);<br>            preOrderTraversal(node.right);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-ä¸­åºéå†-In-order-Traversal"><a href="#2-ä¸­åºéå†-In-order-Traversal" class="headerlink" title="2. ä¸­åºéå† (In-order Traversal)"></a>2. ä¸­åºéå† (In-order Traversal)</h2><p>ä¸­åºéå†çš„é¡ºåºæ˜¯ï¼š<strong>å·¦å­æ ‘ -&gt; æ ¹èŠ‚ç‚¹ -&gt; å³å­æ ‘</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BinaryTree</span> </span>&#123;<br>    <span class="hljs-comment">// ä¸­åºéå† - é€’å½’</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">inOrderTraverse</span><span class="hljs-params">(TreeNode node)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (node != <span class="hljs-keyword">null</span>) &#123;<br>            inOrderTraversal(node.left);<br>            System.out.print(node.value + <span class="hljs-string">&quot; &quot;</span>);<br>            inOrderTraversal(node.right);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-ååºéå†-Post-order-Traversal"><a href="#3-ååºéå†-Post-order-Traversal" class="headerlink" title="3. ååºéå† (Post-order Traversal)"></a>3. ååºéå† (Post-order Traversal)</h2><p>ååºéå†çš„é¡ºåºæ˜¯ï¼š<strong>å·¦å­æ ‘ -&gt; å³å­æ ‘ -&gt; æ ¹èŠ‚ç‚¹</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BinaryTree</span> </span>&#123;<br>    <span class="hljs-comment">// ååºéå† - é€’å½’</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postOrderTraverse</span><span class="hljs-params">(TreeNode node)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (node != <span class="hljs-keyword">null</span>) &#123;<br>            postOrderTraversal(node.left);<br>            postOrderTraversal(node.right);<br>            System.out.print(node.value + <span class="hljs-string">&quot; &quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20240526220416984.png" alt="image-20240526220416984"></p><h1 id="2-äºŒå‰æ ‘æŒ‰å±‚éå†"><a href="#2-äºŒå‰æ ‘æŒ‰å±‚éå†" class="headerlink" title="2. äºŒå‰æ ‘æŒ‰å±‚éå†"></a>2. äºŒå‰æ ‘æŒ‰å±‚éå†</h1><p>ç»™ä½ äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ <code>root</code> ï¼Œè¿”å›å…¶èŠ‚ç‚¹å€¼çš„ <strong>å±‚åºéå†</strong> ã€‚ ï¼ˆå³é€å±‚åœ°ï¼Œä»å·¦åˆ°å³è®¿é—®æ‰€æœ‰èŠ‚ç‚¹ï¼‰ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2021/02/19/tree1.jpg" alt="img"></p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šroot = <span class="hljs-comment">[3,9,20,null,null,15,7]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[<span class="hljs-comment">[3]</span>,<span class="hljs-comment">[9,20]</span>,<span class="hljs-comment">[15,7]</span>]</span><br></code></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lua">è¾“å…¥ï¼šroot = [<span class="hljs-number">1</span>]<br>è¾“å‡ºï¼š<span class="hljs-string">[[1]]</span><br></code></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">è¾“å…¥ï¼šroot = <span class="hljs-comment">[]</span><br>è¾“å‡ºï¼š<span class="hljs-comment">[]</span> <br></code></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li>æ ‘ä¸­èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´ <code>[0, 2000]</code> å†…</li><li><code>-1000 &lt;= Node.val &lt;= 1000</code></li></ul><h3 id="1-é€’å½’"><a href="#1-é€’å½’" class="headerlink" title="1. é€’å½’"></a>1. é€’å½’</h3><ol><li>ç›¸åŒå±‚æ¬¡çš„èŠ‚ç‚¹å½’å…¥åŒä¸€ä¸ªæ•°ç»„</li><li>ä¼ å…¥è¾…åŠ©çš„levelå‚æ•°å†³å®šå±‚æ¬¡</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;<br><br>    List&lt;List&lt;Integer&gt;&gt; levels = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br><br>    <span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; levelOrder(TreeNode root) &#123;<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> levels;<br>        &#125;<br>        helper(root, <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> levels;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">helper</span><span class="hljs-params">(TreeNode node, <span class="hljs-keyword">int</span> level)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (levels.size() == level) &#123;<br>            levels.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;());<br>        &#125;<br>        levels.get(level).add(node.val);<br>        <span class="hljs-keyword">if</span> (node.left != <span class="hljs-keyword">null</span>) &#123;<br>            helper(node.left, level + <span class="hljs-number">1</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (node.right != <span class="hljs-keyword">null</span>) &#123;<br>            helper(node.right, level + <span class="hljs-number">1</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-è¿­ä»£"><a href="#2-è¿­ä»£" class="headerlink" title="2. è¿­ä»£"></a>2. è¿­ä»£</h3><ol><li>ç‰¹ä¾‹å¤„ç†ï¼š å½“æ ¹èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™è¿”å›ç©ºåˆ—è¡¨ [] ã€‚</li><li>åˆå§‹åŒ–ï¼š æ‰“å°ç»“æœåˆ—è¡¨ res &#x3D; [] ï¼ŒåŒ…å«æ ¹èŠ‚ç‚¹çš„é˜Ÿåˆ— queue &#x3D; [root] ã€‚</li><li>BFS å¾ªç¯ï¼š å½“é˜Ÿåˆ— queue ä¸ºç©ºæ—¶è·³å‡ºã€‚<ol><li>æ–°å»ºä¸€ä¸ªä¸´æ—¶åˆ—è¡¨ tmp ï¼Œç”¨äºå­˜å‚¨å½“å‰å±‚æ‰“å°ç»“æœã€‚</li><li>å½“å‰å±‚æ‰“å°å¾ªç¯ï¼š å¾ªç¯æ¬¡æ•°ä¸ºå½“å‰å±‚èŠ‚ç‚¹æ•°ï¼ˆå³é˜Ÿåˆ— queue é•¿åº¦ï¼‰ã€‚<ol><li>å‡ºé˜Ÿï¼š é˜Ÿé¦–å…ƒç´ å‡ºé˜Ÿï¼Œè®°ä¸º nodeã€‚</li><li>æ‰“å°ï¼š å°† node.val æ·»åŠ è‡³ tmp å°¾éƒ¨ã€‚</li><li>æ·»åŠ å­èŠ‚ç‚¹ï¼š è‹¥ node çš„å·¦ï¼ˆå³ï¼‰å­èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™å°†å·¦ï¼ˆå³ï¼‰å­èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ— queue ã€‚</li></ol></li><li>å°†å½“å‰å±‚ç»“æœ tmp æ·»åŠ å…¥ res ã€‚</li></ol></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; levelOrder(TreeNode root) &#123;<br>    List&lt;List&lt;Integer&gt;&gt; ret = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> ret;<br>    &#125;<br><br>    Queue&lt;TreeNode&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();<br>    queue.offer(root);<br>    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;<br>        List&lt;Integer&gt; level = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        <span class="hljs-keyword">int</span> currentLevelSize = queue.size();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= currentLevelSize; ++i) &#123;<br>            TreeNode node = queue.poll();<br>            level.add(node.val);<br>            <span class="hljs-keyword">if</span> (node.left != <span class="hljs-keyword">null</span>) &#123;<br>                queue.offer(node.left);<br>            &#125;<br>            <span class="hljs-keyword">if</span> (node.right != <span class="hljs-keyword">null</span>) &#123;<br>                queue.offer(node.right);<br>            &#125;<br>        &#125;<br>        ret.add(level);<br>    &#125;<br>    <span class="hljs-keyword">return</span> ret;<br>&#125;<br><br></code></pre></td></tr></table></figure><blockquote><p><code>queue.offer</code> æ–¹æ³•æ˜¯ Java ä¸­ <code>Queue</code> æ¥å£çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå°†å…ƒç´ æ’å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚ä¸ <code>add</code> æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œ<code>offer</code> æ–¹æ³•åœ¨æ— æ³•æ’å…¥å…ƒç´ æ—¶ï¼ˆä¾‹å¦‚é˜Ÿåˆ—å·²æ»¡çš„æƒ…å†µä¸‹ï¼‰ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å…«è‚¡æ–‡</title>
    <link href="/%E5%85%AB%E8%82%A1%E6%96%87/"/>
    <url>/%E5%85%AB%E8%82%A1%E6%96%87/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="990cf299b562b99898c2e8bbb08ce5973cd334961c92345f25224d658311ca9e">a497b25e6862ef932bd8b8e9634b73107fd22b7c0b6aeb86f1e0db1a2c94058e2791e6883304c39a2e6156e35cf07b99817ab42434893fb4cd27fd45e3520ca6b82ade7e614a79938a947a10386348bd1c130358cb6ad33b0d989e00a81a865d716dc45dbbfe311c2668b19ee8a99d2f0ba445f8a0ab41f25b11e3e3269ea2123e4485bdf64ecf597297cb70b74a74cd4db42db6d371ed9303e6b6b5132ab8fbac7b231066e602b5439eb21bddff0b676eaa3e81a8ed634f66779be6f3604b344e451f40ce3763b9a31321c7f796144f25a10371e387e4136032fd5a076986e490ac4cea37c863fa2b647e98b2af1629aee0ad6b5976c105976f35ab756e4af370c405a31d97e0f082bebcfdb4504aaa1473d3d16c916d95df01e155aadcea9f3f0896ae945fb94ae16b302b688e09a4c5232e76d939cfe7949dee03a7fed10936781b43a2bd555dbf37b6e8c6f690895d56fb75d2605602a6d2cee7e703e86e47a66c89c35f24e7ddadbba859e4c78129b227861a7098ffa92c5b866cfe2c6fc942bbb8b01abc9e37e6c69c09d3f0155ca594be91f0a62f30ed99e3e12b16b0a8abf11e43a17820e31d071a5be29d52d691e1dca623f77fe5c5e68681930321612cc1521aebe0c013af8c08db800fdc26b8e3871b3039436116ff0fcd477d01f49565dff17146e65e9b243d14da3c8d0556ee2f6667bfb01f4ed092362fb14c031b91a291ae80efb773264882f53e76a508099392bbff87dfeabe4e5830bf8caf0507b0f27218b980b4d4b83317d604ddc3b80e7d03cbc59db549dc6e7b85aa21cdb1dec335308215380322a3bbfc2c9a6102b0f69a117b24d585daeae60d8b351a4d9635a0903afe3242a3aa78772bcac3fbf52576983d2c085db6bcea4c211082417682d2842373a337232d6259244dd62187fc40252c3d723e96cc0045f219430a133c84ccfb4245887b683a063d9d4d20ec22e25fa3502b63a97218972664d1b37c59948a3ae059c33ee3d9b6194768a77391c4ec08968c6d8e4bcd0530cb14afeeaad1b83fad90bd7769843442e2eaa3355bc9b59215d4d894f4fe76e97885ed7c2581ee4e55c2200736b78a7a62a28041eb5ecfc9ea478e2db6f8721463708a528c6acb1b6fd2f227ca91c9ee4b445b581378d8ca249324bc2fdc9d6b7d11c0d561003a95f502fb1fd1fb788c4dbd71f57d2293e7d0ab6d6b9b10e2fe5ce4ea09a9c17d76fc01f620f17571250d0c66bad081f879b38faa9744f900e8fb3c2ed76acb8467706be6e50e3762985710468709ea0d75af510bbe29f74663347c05e909b5ce12723bb7fab3cdacb18cc159908398f507036aecf9eed8454e9dc64a335a73f0d8fbf3d01a2d5bc18873babc122efe9ae5a1ebc6dd030d2f559bc1043eb7e99477fe011c3a319f6126d1db4ba6d1b7cddb56532b34d11b39e8e9b1a221c532a36eb1cf1e6860aafcb98a87390e7b74c4bd21729d2e7a737442c134e2320063499a238d089ca0a83cf27b99d2a51657ea01086bc9f4eaf492ea56f735ed11bc9bf01a43b7baead8c56456eae2300ac642aa3b42120e85bb91da84187516006f87e7959a4a60ae2d2e00ae23597ae8d482017ca04d10121c884a5ad00b6e2cd2bb360007f26aebccb720f45c3581945780baf37128b2aa830850e44bc6cdce31b89f214b6bb0e528adb2a203cccc20c5669f2834d870b8f05ab07fab4b9ab1188ff4c861ce989276f6f49458401d8c7152e7ddfb7b08c305ffddeff2a91ac5b5e2befe46ca906908693aee6720c748b8065421178e51c026c6309f706eef04a6129a8bfb672b66125c6660f4198708013a00700e8466b720a2bb8933f1f32fc06c68fc17599e5bd3f17484de70d080a4cf9eb08973b5e5d735c3e9a4dc36c0580f5ceac9e33fa7e7ce31eb86c29bc70f0fde62fd135f197f2e8570bd101629df98e9ff9f6bf4174664ee2fc6f7d85b78b7abd6a1c19fbc5533eda09a3f3567f82b5024fa0508a4169127962c0278bdb13eee418f3f1350c118f03251b2483fe27a4e87be2e07364f6bc4824ced7017dec447d6ef331610efc1df39e2795e7c891e2d2a51c355ac8d18d16a3c279ef00a256aada703eb790824753b406f624ff7e12327bc57fc7363d473625babce9cff23b12c8899a7bb57a5dea008457435fe6debe1b4f6ed969346f0113a68a66cfdd483187601fa1d4fc547dae7a63b7cadae41df714e5a722ad014e1543c89d6b6ba323759bd32cd359d277c4410980b0bb76656052374f588f82c7af568e58d5d297653d17e346fb8c411f26bcfd4088c42ffdaf26700df98f7804e4cfbc5d500a5e630efdc39ce52013a85949359489c6e23266b6794233715c29faa61d315d2a071729ed67ebe1f3059c10320959c91874740dc8f427ed035ab220f08bd8f4dddcb1586a8436a101f08e0ec5230d112638e1c36db7e36c2a51e5dac512c262e14d0c43012da22338785b71e8a7f8546ac9e21d11bdce69f22c5dcb59fbc8d9d2315bbcfa09c45b64fb897e845a7843917aab7616a2e1f76dbddf2c8a278abd0a5ab106bfbfbcbccddf7961c4316dcf34af7d612220d89613bbbe018c7931d3186b6205d594075cbdfef5a697012665cd4f87e5ac70b661dd215f174405565916794835f2b981bf20bac02ff755513f788e2732985d71cba16a90e9e29c0d4a81401024123c18eff838bf4c621398d4ee91368e84dac1d0e22d7e88ada9a549ddccf37f5b60f97cf59b2c44b05c7735b154baa83f29b6d00f29e14fad8d00bb8a32d4efe7fe84598e93e71e0909556a6844505b3f8826ea0bb8870bfe157153679bb3d93b486fefccbaa38e0b97e19ddcb70baa33975dd8a58359d2cd6ae496f8d10b25763a5e4c4f0f907466b3e74158cebfd15a87c1569044741e97cd670a4b0fb575b1b663d258ce1e2dcaf3a1ec74af58ad50c0836e49de50595e5ebdf7217d3a291598ebe627cbfe63f1742d52e0c266108f25a55e6fa4dc1547c8bb03f8133c25c3e7d47633e67b9f0b57954a8004623937f8331e35496e01b9e8bbf6818435eb047b2d94dc8df99d658e8d4b54822603bcd46c17475c08f7f1d410958d3377a5075ad8cd2ed62a2918007c820d46b978298b2e7e3afc1d700225d3df31e13a2582a7aa014d89a34ed4808c2b9cc49ac9e6a3dfef94d9c57f3e2332c8c5942a40c8eb5c1f91da44fc05e34df7aaa5a1b5ba5e620687245b26cdc9c8dca6ede611efa10940762f4b51cefb24253831973cc23ee4b488e81698efa26bb152ac3527ea7d392e641a34b1530c49771b94636678971a477ce7345630b57e6e0df878db36af74a56a1bc39d28fec67f128e595b5d876cf82703bbf75ff12b20560fbd1f5fc601ddadba9e3d3ec407ccc13e485cb023f413bd38d77089dacde2a09b1b9e1ccf263280b021cde7b01e7a3231fd5f1bbb31c5da9787a14945441e62f753080831a6396720ee2a34efb48696da7ada6e026a48cc9590f3a3f24fbae29937e872d1de4036f568e81737ded408befc92e6fc61b249c6adb27c8c0697217786c48a70778734cffc7cc5b6c255bc1fc69e113d4433298c275bb7b0b92653f1b444bc66b28053520e4f6b72c1c97c8caecd4637d12ddb4ca2baaf1048765faa184c9a6b9db45676bc7cfbc3578fe993e9d77d6c1490ed86106ae4d6ec4525a97d0f8340098b3e51f4412c59c27f66fc69008a927065298963a7e46582b8f76bede70d444fb27a3025fdcb9e0f1a60dab9126865b01c9c0bb9a02d897604014b34e149fecc2db407354e5977dcb8ce33a5ad425537869cea345170c0ad1c98bf19e6dde4460a1d1b0415bf5dcd843577de044418c7ee622c913bba7a31d87b43989dd812c6d9efcc54cc8390c61a235bc144fe28d0bcfa92bb9fc6b764f6b9955cc890b4d99d3aaef569fb79af85328ca3fa4d03cb60bb66558124a38ff4aedc086b220e61d8a0217134f37a3454364f2e98e6551c7746722b4887cd8dcc51629cd68f15d8f849776e762f2302e7786ccc0c8f5e0e7df11bf96d31cd3127b99a603c4cba3a99c2b790d3b45457ea9a7dc4f4c3c777105ae76cfd2d7ca7843df92d85f4662e77c7b1ed37a370500f6a1d24e2fb5caf8de7b5ad8160acbc5c8750a12be54d1ea9abb5109857a79c49d6981dacd405396f47f51fa343efc3b1eebd2f5d011e4cffa6d602b70009661fe0731c74cd87653825bfeddabde7b778715f3d7a40cb3742f4441baedec6dd99b27b7d8cb6b352d57065038072cf190d836547910a1656455ea1c4de6a7db024c613cbdd676b44e7ad7fe325f998a97262008b9f62655a9d16653efc68a150ddf92ffeddc651170d045b56367200b7f2c16de1d58252510e6c810f51855e6b5742758e6b8c2a54f40b878e1bbabd382f6934c6aa0db294d1b6012fd4e6b4d125d3d8f6b1a5771da98e2e817810fefefa08cdba776254ef3dd3542ae64be383455baab600feaef96197e0b6fd514500ce8ced002e367501d546af2b8d93c360348386e6cda36acda7f3ef02ef12d8baa4654928910e2bab3ea690bc72ae5bf0c78ee0850fd5134777a96c5d2c45ac00c42fa26086eb219dc851e135bc061bdd79e38c2f1378236ff8cc365ced9762b8035d6382532dbc795cdd6f7698825dc97dc62edded03c7908f11b907b86c3985cb77a8ffa23961a54cf1f73f38aca320a83fe32670fe902820d7ca560d54a79119310bef1e71b431cbacee3b89e3f7290690f836c2d4954290ab746de6e5d6af310d26d9eae41e437e206ad0b6dcf737eb5188e6cf7cf79cdec0682a35c87b55090782a91d0c1a0cdc6d14c5958bbebd8c88834158a7a68a7fccbceab158eca153ad4382ee623f7bd0b4342f3caa24453dbf25210c0b4628c85b861954991cce608dc653dcc3961e8112ed0f92db682fe5bc7524d14056854e1fff54d9bcd3b54980fcbedc2f21297cbae00e36a5d47aa65883b73e24c337c460108d1231886954f02850e1db0162335a699aa64069b9b251e1a322123143d28bc2818fc9781c383cdd6f1927eebca4ef026a7a172f198b41fb42787c23277e345d8893f93ea505263a376dd635c6beba4afe3ae4eac012d0ae97ff2f0fb149d8fbc341c09bb86d23139fb9c17732a9c28cd2f36f4bc23d39a31e0a2e705a40c5f4c290553a1e82a12f5fa8a5bbac266f3376c68d8f51bd66058dc1953db6d20abd1ed8d166cb8759b622ba7ee8d2308b1f4c31b7a8424a0c8b8339503de84bf0bd7b53c88239c3e5042349f492be7ea5da724b61ee4d5947f32b39b925ee59c04178ad6733abb1d3dd9f38ac9626e7a8e0bc904f7f1347bf5ad6d508d61affb83c2816bbd98ed8f593fd390f9723ce31bf383e266fc6b3173cc705c9b8277b2c22bdbe62d48c48ec1c771560fda11bc431c5299bfe2723b4f59dce3a98bada30b79125c2da0b2d5360fad5a94e7d32343bda5c9dfb8a634483bb11c7e0b9cd4f88c5d355298737c6c597cba4091b92edeeb8d491560dc0d6c552af0f6a6eea48a99251304656e440b4ce8c7313f7337182783640d34caefeba4242227cab606153950439d184ef82e5317998892fe615725edf9f81e70f7f6d5732b1f90af818da49b0cd1fe614fbb1d2285b62689ab323e4eeec391c07a39dee945dea85cec64b053b431514a57877ba7506aeef7a921a28bf823607478303191013ca7b82fde6c0d055c536d91d54bffb351a6cb0ebc60549821690b03fcff8061c01b1aca0ba877f49b3aee57fd0db2dad6c0a97d6b5e01e03e8b7208ef1fc6ee050f06f02e8ca0ef4e5c6ff0267106d63a2ba5e6b1e335e65e50244f834b4f7f7544d1d1c389bff6e18ab3667e7dc8f24aa0c0dbe424249842536026ebe01abb21792d8b033be866a2d8221f58e2ac8df7a9ae0560792bf97da1dc54ac35a39b32243a03c793a9b0299d2baa92ea26bd39074dfc62b40c4799741ce8106ac496c7770c55302344193ca26b056d010b56ca3299360c52542befb42c5b9a2189797a569b3e35355021ee70e82415228149ea4d6fe2d67ed732517e1de058797e79d409044f1640e8983af20fe3cc13be5aa369b578d3e3a4d156066e318e6d21fc7598913ada84d5b11dfafca3a18a3627efbaef11882d059f94be9eccf13afe05d9a2237b070a2ce7c960e8b9373c3c3329777d389f5d501e402df06625fd65879dcd81126fe939ea1e6019390e2d496633c7002bf37f25a5f410c1810044904c4de2aa96e73e4787eaedb054f565e8fbae08c3ceaa959fe0195c1906c174a4ae6072dfb5d8615245ad6b9e5de5b786209830c3613a0836dcbc1a80d90f0678b561aa884c7a3a40d32dd6082ae489b7086743ce4890dddbac8e2882bd98163844bd4029b1206ca3594896cfb347afdc732d3ab90f7e523972033a76663920de40c8c67567af349343da4d2d5f04c3dab536bd592ca697cf6d9e9584a0c3983f3e4368bdfb0c8c9f3db76da562c88f06716c18f7608d36ffb668d2115f33558fe8ba1355aafa48468449c821c0fe0032ed3fbcfecd925fc16b6f261f9f0f6251457123b903165ad17871c3f748af22547acc3e8f1491fe242daaa2315029832119bacec6b53930235abb80f8db39654068c30e180c35c11dc46741e1db2c8fe9cdd588050b011560a1b65bc0171a0fd0e6b3200410ea54d4b77beeb942ee60d1b98e54fb9ad06c1fcd0bec414195b0ee1e08cddfb209734664b90440d2f4e86fee69dc9918a25d07d8f15ad12088ec611bf4fa88d1b739287a4a04ffaf23fd0a77663fb5d3fb0b8d5221893cbdd91b91e5e4a6dd276c7a510fefdf09ec6be004cb464a39db7d0df10a10e0361349ea46f4193b9c87a7e56828860b200ed9bfe0875541691645c868456d28edb3405fa7afb24a53441ebe1dc8881776f96d7dccbfd59e9d8a5e2db7db58d971b5274844379786a34cdbf7ea5291c4ed9fd789fd35150566b64dbcb45fbeedca90fc970f9241f0f968323b25eccc562a2649c392e77f5da8a6e8e45b484cd0c0dfe9904c143310b935c75cd653348253526121e783bf13acdb49f104a0e87010fcb6d2fb715f7ddee8a65a41d3d06084d2c76e3466b16f6766cd6845b968169f2edb8ed5f0472d552dee13d7c1fd125a413b15bf514c75c710d474c98a756ed14fae9998e23606a6a88f6270f8361b1c07cdf68a8c95d1e6de1208b5c5d5da04b581f79cb08c07a65a71fea32f6427ecf4241d09d0b92aeb3f8bee0774d92d9c033a967dfd89fce089bdf165ceb2a90b9d2cae03dafc28637906f9c8fac19fbc3a7cc5fd361db732a12469988a2fe390bee6572d1ee7aee0eb2b59b5e5b4735cfe57048de40819cc6264abcc5d64b2b2cf71c0dd02ba8beac7715a672db77974c761ace21aa97929486ecf25427f34c53a8c2ce34cec21ef52eafc4c1e375c3d9cce077769e3c11bf20485f5e24be940f7e50c54afb587c0dd862698b87f2195b6ace20811f20871b4ad6c30541a7d3aebef89e2e789078c1250275c1d2ef134644f0e8e9b5272d710ed85e579bc93eb36bb6f84ede66a568f8ef9b67e66fac4ddbbe545b6b490c20ca7a81e8df95eadebb81f176333ecfd5ee5d45b6ea7dc15e274e95582abe0cb76c12f945766c0f3e81b6f7fc9d937d094a30659846248f58bcc0311581433cc01b8325d8e99500b0462e4dade7d186919d32757e84352f21b7cc59599dbbb3b68d7d0a61cc991a8d80d2c4603be3ab4cd20045c4af9c9f0e2c04bd331f1d9747c99a04c0a0602a9fe8153d84ab051893df08287cf4ecb5cf7695ce06dbb650e4b67fe399624f3c00973872db3a3523ff7ba330bef72af327a06d2dc8379782dc923b3774801ec7cb70ae502c0e06c59ca51974b78ef217eec9475bb2c615d12b0af570056c3314b70d5aef728989e32a8d85d72911fd3ced2e572109e0b39d95f8fc8611f3092041dce19e6d405faf6fb2161bd19de3aa63b448b82bec3e4479ed48df431f6346cb8d154b1b9b9bcc7f1765a2d0339f29997ca4591a40e93b12ea4148d9a50d2e20d7c75df042d9bfeb0315ef76a028061f816c2361181caebdcd1264ae48e6f4cb7c484f072b054c20f798528a4ac58a3837c4b876e59dd2c233d74b92e1b106838582ede77a0853e13246e586ca659a85d2cc3ac514207195ead502408a8eb16a96364d93c41f12013aa5aadf73e565997c86a118124fcb9247cacb827cc81db139e9d81e93ce5186f92ea4ff144211fe966f991bae5a6d4ace46afd4ee17443cb0795e8a32a27394fb85c6e6ae298b2399fabcef96c76d527114f328baecd4a346e3c093afef9078c8262ce9df388ff7e4517bb20402c302122d5a39d18acb301fd96b9c2e416b101bf4e0499184720769d8f1b5d73d8ff845049f97730c3174f145f3cf7701eebd510cc0c2f9c8585d3a4c06ca785596ea6e4efc885a6e82572b1134548b1d0579eaad39a4e75ba16fec77eee46881d53de13240256da0321759bb637fcdd60fd526b198ee6dbc3ff34d039b11876c79f5fab696d0ffc8204415fd665aefeb8df1c3d13e4db7e94f337161b4b3594af16dc5b25d97705058599eaa18d342769abfd31bb630223fc4a6435f0a4816cc29283307cea99fa1faacf9d452ee1475594355938f4b70f681de712f33dd7e83a2e40c5061d72a602cc1345c2443f42c22b4ecae52dfa90111f109f2067737447bce2e03ea19613eb29fc96594505e8f4da1948ece76db05341d8f86a373d7e0f2a4adc7c610272e7936b0f808b4fa862f6123090423248f8be3b7feb4fba0e2923b1d0675afa2b421ea694f1950424f17c8d0ab170de0711e16f9a0b071af9df68bd209e910af8cc367bf2a4b8f9c1be63b8aa0b5c161f521798470bdf07bac10d5c0fedaecf1377382d1223ce8e382f2c763e1e30386daca57cfcd160333cc57df09d1c5df4e05bb456a63dcb66f620149238655913ffccbf9521c87eb839250abd38b2b33c455ec84a23a2832038eecc875e7fc0b8daee14053a265e12a4694c4ff1c7d62f6f8f5f23b0be9aa43080a8934e94e8370e230bf456e9ce041bf618ca2e59ece6aa0a66c46c582806a0d3cb062140771fc67a4721203422d27e5f429b43a8f5093a14746b9cd8daaa03d4a98ea5d1753f75491c9c10105bce3696c543de53ccd025f92af7a37702f6e7624f3277751ec58898e42fe924ae5efbc4cd2f3cc99d7382eb98b60bfb64b34e042d4d0e6b2d2c12084760a889207339a73d5ea1887bb60b2149d48ee11a88dd4dda4f1bd94300a8d3fb688b10a5acea71a470c9bb5414acd1b20f0d1748d08cd4791e828639c3ae415b1e63d0060c407d963b708ac3da06b120820a29dbc238b2ebd83136eb1fce010d2261220f308d8f8569f7048ad5be396c09443348811699131deb7625d5530c6802e1cde4aaca53f396985077f15072177bed98762ec9f2e384e7ed1bf3eea3ba61bd3ec83967b3d7a63963f2f738471597fb8985a6626983d4168ca56810487e218b6a105639efb09f04a723a1f19df3d9a4b57dfbdee082718de5f34aeae65087bae7f52e58a2ad0cd8d7b013992f5be5c7f0b948227d18b36abb380c27ced68876670a43b5991dad40a6b9383af278ac5d42031a6a05571fff12a81336d6a57741e8cd865e25fe26130758b0e09c6033810c567d2bb15487e556235dfe766b1e077883fcb9388cb444ef252be0b12dfe19f2f260d6002a50b37d890868993f84272f81435d19221374b4f132ad655ff71f1b07323d933891c4168b8a9e1ff4bf8ca860b161f3c64d1595c9fa42e442c3e61b54829821dae7de7630c3ce5c3cae702c2e49f79e476efd4989b70f0a3fbf4b9b250f70bfe6fe80bb32ec0522bfffa0fa806415274f12fbb922938ea485cd221cb7954815a5a6374b494f463dd23eeb97e72dfef46f9bd0349a85f95bdb9062ebd23efd1ca4edfc2a8145d834d4bd433d057ee2a3acac3c3bff3ffdc66bd276ade9921f7f7e938330262fc64d0b7d9983200bcb90ee10f32d5d15ed7496a838df4e02df3c963abda977039bd5092d401c03e2f4444fe7dfade4ce1665b18baef033b774259d74eb5d7949b811d90a59a14282d396bab4f108ba5b974fa43d9119f9c6f05d423e9c3d8a4f8ed6580590bc38393458c580f92962ec36421699f63865291171bbd972e03c0f40f593504006005005475b9ccba51349b5b22d4c8c8e083e7678c0adf39f15fa2c1c2602138e24fc907b07c93a181b1148118ef8435b311618a30e87fa5c03547a7433bcfb8ef2c927f61e1b51356983262e82eedfcc3871fef83abc3a3d66e2a87c44558df27c109c4026916f693d23d03521968560a73405f924a419fb0b3dc3e1b53e76c672219629e1f2d9724e954c2599b77ad7e732324f3971a289547305017dcbd64cc863b9e8e17e3d82551864e32fd8b76dc07ff30c9c3cd4e2e57dfdc7d11c27ed667c80feebb4de30741b0ab9ad6cd417ffb82213d68f7e649cdc7f1c8225c3b7c3aacd5635550c5db0a7d8a5d07694e991952c9bce669aa92d0959c7f67986177047d6d47e5519cb8fd40c9b4a92227a208a6948ae195df65a3a9bb6b8ea6ec336de45aa85e95be9fa8ce202a0045b6c48cb7c80b55355dfc7c4570c9f96389616a4f7166a6aeffd2fd1e45dc5c9c44353cf81b7ebd8649e0b47923c8e068d0bf4a592b83a274fa761016495798c71023a4b3d91589c40fcef207c6f276ad9fc36010752444f59fb41dfddbf57eabc7cf92cca2eb424907cb38a997388e581c02292afe892b3582019e3ada1c6ac1c940f0c6bd788a34e038a251654310e43fde33b442bcbe0be641f72e48bebe5c4bdfc86dc2a2dbb4280a3857d54f496fe176dbef0b5af48382292e4be4c7ed5eef86d9a7f3c4441374e971f78e9dab516d0d8fee1b076ac10899560a69be6def6557a9cbd8e01876db20d927fcc0062948925983646ec33b0931540fb9342363ce1bf35f32e37ec0c80c8e3d049341e9310f0464d4dfc9604a709730ae9b8142bd40d3fa7c9ea73f73aad9f82300e541b763faf702b0d8250e0f64ddf4825591a89f5500d6b3941d33e717bdaf7c9086e53f58fc3a1c14a99d7eafaf3e76971fd67d05e02ddfebd754283d90b13c347a129b2eff47bc99289d31123600ab75627a3f102013ca4a8d1f71cd395a91cf2245badb899971c2f1f78c1b3343fd44a7911f1034a59b0250205364015a650add2bcd7732e3a68fb631b2760018172cc747b08e410a9afd8ddae55fc7134665bb4622b7f271d39c9f3d5754cefef4d7a57fb45257caa0903b109784c7084f25570d156dcd2b81b92c42e3cb62f2d8a7fd6fea2ee1640a3ca3922189d21b6aa3a94f6df905280436a2b4b39ca67bef8cfa1eda8fd5578b0bb3f04c19474ff11504ce1e21b1546eb4835c8c3d566c28181e3be4e00f4d323e6e11f7aab964cd1fb4aaa0c91526648e52243258820d98f54d9649e6d12754f6acba95ee9b252d96c006fd9b91c8fa3cbfaa5535335e5189d1648eafff1ceddc3cb718347532eb09d487fbf2850ce08275dc6646c4d2a02561686d8d737680eb9adb5f4d1e6d3a8a8b52ca90c2ee7dde63e765dcb035343747326094193bc47fdaf1dac1bd66a9d439b244323e29a1c7516e8232d25c188565fb477274f72c15877ed14e5bef8e6dec208666cc2bf6e5a29c2c2e48b3dc763d38e7c4ad9519baeb3b43da265b9d87f0ef7ca2cd4d07f0a6dd492b6ae5d35dd009e571a00afb65f1bcd744452c42027733541eb11093c6cc66ed4e0a0cb37a46865fc820b49bc9ad641419b578b1a7888ccc98d911ddd84eca7c69e191c603e898cdd8d7fbd171eb896f5a0d10a850824bcd6b35608ef692f026b66643aa24f69c25b5fc36cfb27ed6974fbebc5cbc1b16f7be4fb23f6094be456e95f8e4cc6c034ec3ac75efcdc24e1f2e945d7093b36306946f29dd5298d53d70ffe0377d8366848d8f89148bef8072e53fcbaba422f8b16190be1cbbaafec7a286046addaaa84cf39375e5e1847859b5e100523621de6d358d8bbb77f8de575bf850b3bd0a4d1c3b6a842b6a1f816cfbe6756a7f15ef077ca9beaad5e2270613e5e74d9b8edfa5e3332ae9730c097c17b9aa52821dc08b92384e08b18b118156c9daaf0bed66ff82bb549e479557d689bb4c45ac568c1b8ee6afd085e6b78fde762f19e7d90d366b47fc3da44226d64b657ef48de3022b573e232b8a921a6e105b79c6892c693985b135a0fd6a338fd9d54c7fe5bf39e569b1366f691c9cef3d71b83d4d6f206fdaa130a231b9a299bc984b4f31d45312d9131af4ada0523cf192e8a1703f7794a80560365e5fdb2b5492daf2ad1fe560f65211ba722cc4261f6dbd9ee9573c7bf3be8eedd52853a1672de6721cc740cf5bbc38a539f43d0ff45fd3ed4f2cc49e58071e9441e6452998c6f7d5a97a4509394e2c55d07404ab62ff6c06872eb47ddca17c9514593ebee69152dd185ad1c2005d8ff2856e224351bff86d9d01e473438c6a0de7f7fe13b35e8ef71060b231a308a7c10ac412e1be1e5122a7660ed71716bd4a692aa3f3665bada0b256e20992e48ec44a70bc1bc1571a65b7a47889fa79dfc5cd94e7b1f01010cae9bb54d34e9311ab4ba4f0d354796f9eaeaacb2c8ce3e9cc721212597e66ea954ba4910e1ae917fbede5a61ed69ff4f021a0cf1e5f0546afafd5f7fc97bbb72b565ead168ad072eab6e194e876935f08b5e704fdb5b99ebcd8d69c20c5ef5ce20d8ce68a076e9bf2723a8b3098b7d0b5de306d9a9ae3cc57fe7eb076b5bfb87288510f8918ab5f6602f4d47fe490aa0fe5fa0008d004353b0213dba8e1a9126763ab4eff71550b59bd90a28b78e874d0f60645c218176b80b1cd2302d03150d0c9b860c6c5c7bf70fdfe7f47c55d227147868234070551da77c36053b50aa14d8ae90632a9515d344995dd82e3e41d7585748abedc6cb90c75662fd6da81efe335b33bdf4321ceceb338cea784debdece460ce78f54362729b25365efc1b49434c7d9db58248eda2a79809367e3fa8025b7c020d6b8b612549d6b6e63a4b89d2090f1293228e231fa9ac1b1b32d783ccf604fccacd43fdc710ca8f3d10e8d634ed6d91e07e7a57e31ba4f788a8d32d97e022719d2e85647945e29e56a84348d87777fe33649f380afaf4c31049690e0f30ffa998b3d08ab99c2ea094a8111881efebbba0072a0e2c99c222e33ee5c925fe5ba4d1ba39c15bbb8f544d3cd82e35d77d2489ac812df362b996e4d232b9c5dd3fcacd76588f9dc967ff7d3a7173a8a6e12a411335f0f7e7512cd7f28d11a9f5662cced0f6c06f86ce0b63325f825a30041d44a30c2f55a056504c04bf07d38ec3fd12437f2f0d4722cfa5268ed82f25cbee6ff2d439da640a019cd173affc1f103a33522ae3b8fa64de46251eb47b6d19e549bdee0d9ace0f2e2abb0e7cf9ad5d3956ecf82670a125120d30fdc1970e8b31dd4169096864fa7bba4d8463dc5fac515fe001afe8a3c1bc1c7809c0f7134decabfeb4583fa6744c034c72ad1651b228429595706abb4d8ccc0f65f70ccd45c7e325e69efe8662a272549ec3951cbe1b502b9dad488b93c3fe6afac716df4ee22b0b9af0ce2fdc1ab3c74a65e385f2384c2de1a9a84ee915b886728b4dead6b631d16202ffb165c348407c1227e56312f0c9019b23220b80d597bd74249ea4112819ffba615a8c5376c3efbb265ebc53043fd323b4dbec50140445d5940f3239080860581e7fe181df18b76ff4423fa0a35c3c1a54b160247ac08d9feec60444f6c823febd1c330f0c534c7ab926d0c2037eec57740a1df477d3b94aaa8ae02fe42579d3c3e3b51fee22cfae86149172714bc6cb7decf529fc5f9c2bfc2ab153ba7e2f9531841c4b2c85d86ceb37aaaca7665b63328547ebee619358bef5051c515f9602218b9af38f51392d228bed22486e29b656b6a19c6dbdab45b43513bc34adf68f456f7a05b8d9a39a39dba504cfe6213aa2d023eea4858259d5d9d9d9f1b39ee03a34c486b872b49f468c8c852495f1efbe70289aabe1f5fbd4ad765368d11dda6494377e53f6b79d922d10b6cc02214b1fea45476edece8d5419023831bed5415432c238bb45872c2b61d3595184c53aaa59cde84b3b439ea6e114c69d63cc512ba20c41712f0e658ff02dc377e21e599e87aad192dd2fe1b0d0a23f3791aa81a7934f21eb9f3bca3aa5fcb70f1e6ef20afae32d65b2cd5e28db356592931d77006f691cf8f2cca8facedd04873fba7fb250b5613191423b064d4ac5493190c36e8fa6b5deea2030905d648e8a61ed95d21d31b084d13887a4c33605c2cb427ce3425963fa25f841eb4f211dcf6736103606682a7820fb776bba0898cabc23b9dac7c7d9c97542f758d465ed8d759b92365de83d97d2aab96846e4d496e4b8148cc6d4c010c34516f9737b1044cb4db666c93139a96fa47f62a94f20955829e355cfbc73cab58b878cfd4ee188a804c941106f9bd8b16ae759df9acd8e6bced10e470b36b7462d91e32d2986df53c19e9d6f308a96573e28f9fc307d72caf8867f45dad9c46a8f6f87741aaa8b171bea9b268b8e81975860b90172c15c758eb9a7915dd057bfaeebc8bb48ffa160d40b538679469cfea31fbe4f24160040beb672fa0c18f7560c70152049234d4e830e69dd4846f5a48a1537357fad10aadaea853d14bd070d383e97b0e53cb5422ca3f74ee6a0482533ead9447616a79d6a5f106be125467197b0d497c8df3f559d548fca1ef8dfe57d586d6de797bd0c86ae0c9948b16798b44e50a37be8fc86d2cf1bf985af7b8f40ea43a6144485c6ab57be3c2aec69a2cd4056ea11d75ef85d41efad25f3ded3658565d8845a3c4eb1698094adf5108a4a0f0fbf4492e36ffd1e38693f1f74e01f01759a38a89bb82e906310cebbbf60c85ce47dd86c6501b211def4c6f2ce78bed56e67e55b816e51c4f686bf7d4bce2080c9519e43923f81ae5f6fca6c1981c88d498a7018b553cc0eb047a6176f1af8215a0df40f5b1c0a110056b9dadd376dfcc9a0102f3b79613b19bc8f5f39a948464dac4529c3d7c7c2baeb4dc062aec98b71f5ce03f30d09d75e667eb64ce98a46b92a6abaf66095c360b5e926136d386b0abd109cb81caf5842b7ca27dadb4abe383fead352de7acbcb25cb70dc1f438d1d3b7a262321c6ade34a5208e1c3749f833869249e850e5904ab4dfccc167530fedd07d6ac1b3bd05d6e265a4a8a5770a95ba228e36f5f611de3949a09f519e29707b0df84d735c7cc6d0246a68cb2216112898ad87548a3d113c136d0a7c78f878a8e1680b9db6af922300a1a2b0f9135e434849481da960cde5e0b088df253a04189fa3d57ec687afab8aab3ae14b3c10a7f7b4c3c4707e32a29d0372ab52220ae234f51d8a3584170bfbf2c477c11bd6538abc5d0b0c211693fa68477832a5eff5f7310451a495ee72fd947167fe328fa60c9881452eb9330a1da5992434c0490290b36a370b007b70a89295fc3edd10b9ab2260951e3166f62fc2dbaf76104523c292f62c3883ee1a79b94d6a756df51da26eacc6469beadfa2007e678fa9fa8ee3aadfd1e7ba6a42ea713113b39179c3912b729f6ccf3b92f15f9f445bb9b64baf9e172048729006e82ca15b2179212c3e2f7588db63f81a77412c0ec7be315af095c281d47b1779160777efb08912cc3ce94c42378d99f1f8d3fb003e84dba0aa3c605e027a180b7c3dc0190db8f81fac2225f22bb8fb81e3de56c7516b5026287043ff4cffce3d54aea5fc1ea9bdb9948caa654f0e38d89e7aeb788ffed8767d67bd9ae574838a8a8019c69a72fafcabf96422f25d3cd8797e257c9975619d1dd6bd0092fe0ea8f3225b0a3eefd8125121954bf32ae23c72addf0dc8b64d94e4bd5f49585a050ff926033b67eb9b1940f4ad2baa5fe93e7eed50d969b9fdb7c4aeb48e3b7c5f60519e7602843bf9338f2e0d5dc5f6df3ba06bd08f58db367302b63bbde32696f5dd52d155b782aa63f45b60c12b962701a98aabcf18e233b44ea5543b544d5680e01d764028b120d465af5da9109cd82d2ea4ec75c4adada4ebbb8d58d469e31477b66ff06a8a28aba6386c58e7b890df9081a701130b2a8444c271d349501d55bd246fc11a61826691db53f59ce591760c961cbb8d1f942d3071da2f08084edcf0a9d3cb5da8976f531f2a9201b13e504cb071785a4446c70e77b38b30ca82eb6e1dc4886252c64fa6c556ab99f4f066dc51a661a8ec649de0f4357db4c9e187961b4018b29a111ec85b2c53ab9825242c397affd890736e07259a09b83f5583778cc0059890b8adbfb8b9bc1e7aa03b5d6ad4c2d65d3324f7d98b89064f6715887a8f0ffdadd5289703cdbff8ed9d3d642df74371421a8b48c72c76ddcce89aa0891607c0786e85e39802bb2ed38ba07b8706c9bd72478315a5786939c0555a87ef73476fa59d0a6eed81bca495d404e67cc4d275c179cda81b58b5a6b4f7a5fba1b9c980df1b2fc2d4940887dc27bc91ba78cacc9d213ec1f5577b6edde8db4fe230b889a794dc97c24ee7320693eb6e8501db1c2c622b98a550fcaf1f91f8e444121a2e668e653d8d3b31da8ed9f68a201e5a6bfbe1a63440c0a620e14686b4e364078f7bad92badef352b60d02d4f4036eb377e558d866da7915cf91460ff07c343ec897eff467695cb4108a9feba806a053a101dbd67b54ea35f52b13ed9e4e5bb61f7b72d7e5dc3afb92285993fa312c8d6a2dbd8885eb4b6edc27e2cafe3633459287f3f7c331b563bc24bf612217cc58d21fe8d2f028c12bd404f271d19bc99ce368d61e44b4589f0612af545a1f84951844f04405f8b0aebeb4c43d547483b3733ad942ca64ab8d63150a88f175e844d3f477286b04a0faa86900bc7a396942185e331d954efbd03a614e16b3dc6b0190f42782d56eff51b4ce74ff94a5b1ea76b04a48976f67fc0cc9fd8a2c9ee5f363428b7d12ae0502a6d75d454272c061b876c0c40d3a7573d385652b96ba97ea847dbc20b9cf90af1b6cf964d6ebb915cb0fb2f45c075a9274bb970c5c5108097e1402461eb8f4e28a579ebc416c5ec30aa4840eed70dd62ddf435799c51df49ec1f82ecf723a7b3b284df7ef07d7cb9d75caa3f49690a1aef0c2d796338bff0bde6b099facbed54a7282ab90f867e1803b946ae939a99b0b7a7811a2f89521b5df4d12e22147e9dfed8c72f01da654f1829f805c2682674dff2d240e37bb2c0b01e44c7492231f94a1312d9ae93bcbd7583688cb38fea6e8ac61a40c2380c997cfd0c02b5411a990141c126945674fe105a15629b9d29edb6c829ab2ad0ff8fb7dd7b687c40d0394fe1fd245a76873c311f9048f204edfecfb9fbda7a15fd8d4aa246953a26235283240b9bfe1dfd09ee3ba5649c9b03f8a4db77e613283832b849129257d2948aeb52ee49524b666780ad6af2824425691a701ce3307bb55e1ea19b9401edc852658576d41549fbaa84d629b324c58a50003d9723032ea28c240b0ba2809cbe0879b58f6f2733aedff1ccf0d01e4082577adf809116d83a95222fecaabd5e7fedb16cbc34d45d0fd73694deec610b3611067bb6f3302e8fbc521c1246f3a013a82edb211c4ae21603cc840105f7bfcfe61e18a0e9d4b3af1fee5db9b1c892ba6c22f8ac7e6dc81348e8f997d435c42eaf3a49c7f2deacd0b16be4b6669715fec8b6ee08a4a4d19251ad837fca56e8978b7f030a35858e4f008ede82bde9605fd28e9c89365ab2ff015dc56a5eec0b5675fbc72d531febc7e1fa89ac8d6f7a2671638af18282467ed2b6276c40d06bdc5f4a80727eddeb3b715b2b50c2bddf5eb99ea5fd6cc438b491b61357b20469c8d9f13aaa7945d729d31496b82c13bcfe5525a736361d87b4fc5113dddfe07556b4bcded982b5b3ee984f5225ad1e82a3e1aec8e9067211d3e1007600f7ea5daf884eff6fe3c98ef3a3b0b05b8e91a55f52c4590423c004c3b1a1b12b622654619c93ebd4e51380a6a8d3ef57903f6371379737380b5343a6e34b8e4574a05fbf9c6edb4eeaab270bcc3d3bc9aac99a33e42588d736c6373357c7e5dbf0fcb2a1982f503cdbd277234ada74d19026e4c80e80007abde3c0578e041e10d6070868801c867b32424bb3bdebc63af391bc8d4fbc8f61c0322a9ebacac8e5fded35d6b648aadea51678d3de370503b3d838a65e1c07c8522fad33dff25c917297596e3fccecde741992dbb3949d3d2b0255bb1014ff0ed470c8be8c1fe59a792937166d062318b92b4d3f8e60af6bf84854975d1ecb270bc022d97f349f5b036ec2cd8ac332f24f00a87c17fd0ec0cd84368001dbe11177c06de8469134bead9ec418820bfa601ca02b49d1f9cbc84e9fa8457da5f0cbd3c2eb2c430df7b4abf30efbd4e6207eb592022b48775dfaa2cbb24ce5d9f8dfdcc08798901ee2008eada275b5fcd73eb69daf3bfbce7d643deb151b1a2bbafb5444442241d721c96058a317630d2ed387656fb3c88a266b5428157ecce3b6ba810a7b6904d9930e41ad36364c80b6c04e0cc3a0de93fedab3c21396643885eb2c2404c4bb00f9b2b3edfffbc692fd5f44c60ff78c90fa7b6de30c05b9e82a0d7d426a44124e20967a4be0af792e33affa04a8f1da5f0e25cbebcf83f90e4c51d509966639cd2780bd36a3f13388d1397bbaf9d413b1de1be0bbda26708d90b1d9133dced5e0794e5b41f5c389d94a1762b86fa818b8bf8d9bc3f4f6b50b47af55309dc66ec21ec3c8dd43d13c5f3708cc7908394cdd0e42baa2ca38e72f3e84f830704eeee471fa40270a8afb1d8c468ae4a7798d7c08c762d6c4623dc85065a8bdc3873f2fe4a9f765597392f3a8eaff69284efb5850f501f716e987458ffda5980b9451a05b5c513ed2c904dffc380f9ad5416937a4e5dce77040a91e800088781293b0f76d6840b427e6ea088b34b98283f499f60640b0f6b138d42cf807cdad1cad62f8b1ed091949e3f10613f11b039526d43c4df4098741ea5f6810c391142123f8c0419518f65684bfe7e1641fcb487b3474e935754a6855c46d1ddc36b41c6cc6f6b75c14c435be7ca29a2cebb753be34f418d54102e673e0d158c15f2e72eef145b58f281314cae0e578eb704da7476ffac6f82927ce49e86334f099fed0bb40b41f2fb06f2a811345ff1e8ad154562c08d21be14fe61d80c38770f62229435fc0a72073d8b31065f1998c2337a05187b9f7d12629d929d16258996d4b28519a1f4aa018808db6f926acbabfd22e725da63786623c837dc5e85d6d2ea2a9a491aa77887c964cfcecddb420d62cad63303d1664622bf6131f0b231b3679dc4fc453ef83af34d97425d7210918ad68b71f83dca6c7d70a156e06826717c4245bc24b392889056218b2a4c8c279c1c28d71e4d3236c25afc78a33a05652cf515bc00cc4a5b0d5d69ac49fb722bccd1bdbe9d2229838dda6c26aa833faadc0ad6f03c8c3c81a58d104fcfad82f562df7673577f35791915fb942e8ccb6667d861d353bc9493ae6079854652ab90d7fac67aed55f3734c5bd829ad1976693e21b58bd33daaea14e706b1d129b36bf8e2ad29e1d9842019ed93ff341ab49d0d038171d3987b47dfe50f3fca38cb985475f06ace62bff8e2fb5772bc851715844c97e0151a89be335f4633abc5f43c77806d274ed3db9aaaa3e48a42c22a1d61ba54545fa36ffe5a484485a7a9c397579e85aaba4351e2ad3b490d38edc33ce54ba053bf7c37eaa043ba3c8dc73d6414b8b6631dc7108edefc62d582e0c4f682c2d9aa19a4a5e076534ce3cfb8a8c002e79ddd5fa05cddcb2f1f3ef13d3db973c07a5969e9de303513a57bd7790a0943d7b8e56c973767de3871480588ad7d27c8ebec37597f80c284bab6cfcebff6e950c4b5e74493decd14018e868cc78c96938135ead779a090c6da9a62994de1f1a1d6de634f4c70b1a471c2fb8f6129c8082f96c72e7f57a33b8a7334cd9b19182bba998a3f77a64e35f4d6d5d24f4ee0d22749d55921d141c2c222d2579088eef96e207320dec045c9e72bcbe2abc48d3498ebd2659720659fea6cda589c0ecd4b8d1156a9ad6051b7d86d479e3607dc7157815e467e402fafaec405c679e3bb803d6148ae58b7fcd56b528c395edbcc079e20edcf530778d11dd42ef900be651ce62b7c49110233c5bbe2f7ffaa7574a9e0239ab39d116a19b7aa7fd9afae7098187009d7050205149270c71df809bf4e9d1cf49692f6a9d985b61df80726d7dbbad577456b6f6f466ad8be9ae3ff172fbf29adfc7fd21dfcbfba0b3f5fe82ba2c575c980334f02aefe8ce46d1a5f1843b42d4153cd6e736a60d6931df61a8a332ca487a15187b71a79df6abd70a48cfff68f958604e9baf6df8b4f5df51fa168c2019b135f7a72bc91a838eb269ee1d3230847bac3076453d4c3147fe54b407fe16871bc6ab28c8d07188639910e964e6c0afd116845ace4bed9c62444275919653e81858451874d5cc83e45e5c4e640429704be65699a9697c394d3e7e657354c4089c6b64982b2a729b0e1c0bdad853e9109ead42fe337f95218efe8d404a3b73818056eff76a80003500c05193020a9e3b198c0f3c84455bdeb44fea9868d34a6b3ca7d6ac0d14261e75a150f89c5de45873a8b006e9e6ab343aca0b4a2f13846451481832286c929c65a44d42d9158bf7ee01d58e3a2a3b77356c4a017ead608008de55fd87161a19f8423fbff3a90c4be02d00d59e8ec9029fc8150ea78058ee35a8fb8ae4f50b56bb6d8927707814bae3de07faaf086412d289331a93f37256d710ca4ef8720d056fa892668ddd1c7bf70b6f80f03811235269549bfd47b64882dd235236a020ecf3eaf3f1c22bbd73f14e54bad8eb9845da48fda094737dd920ea309fda4457b96dfdee53fecbabcdd21c118124bca0feb22232f5cddc67f413a33b7cf3297b76e43d4b1cfc76ac40662a5ce27e8ddb53b9e61784380a47e59fd2336fc5eb85dbc5647d6014823aa4aa54ede71cdea9bded9692bae3694eee86ef46eb584ee4216f2d86b022d9741b1a5e80a5a1081a26b6a316f45e3b36779650c6ff5f7ecee873c900ae14461942132a8311c0dd5e091b576df9d893ea1b04d2081d975052583c2198099331d27b794948428276f517afab73994041a782c63d40308c87fc7d1b027746f9092f763004f36b51f9da832cf69789aa950699c78a97efd917789e965d3985f0a35c7e9a7207809a71310e92db02371702aece154409c6fba4ea23bbe883c6b7c718aad031f4eb9f953318f714c1904569dfebcb46291234e037c2ec1ef8bc92d15e99b73d9fc8c2086ea7331e3670c9bcce53cf99bb8e027bc9ea3c6d1fb7582f9c3a7e18b3ba09713cd49b401bad195d2a2dd322bc786f3d14413656e8586818586c4d54e77508e6ac10a158c3845a8114021a9b0abbc163a3a19765769f80337454cf9d1c94f19f4a6c05341abed869af984397d5b6720d5dd4078682838ddfd617848a4e4073da8ef74be94f6b05e341f23e21261eaeb0e3013d5028d745d9c3a41238f403411d26399b03657a46ab8335b261ad31401ddf3c0ae710285bf3084e7e84c48060504d4eb6cf407a41d90903ccfa11460547397f21717fbe8f4944f7fdf5959d62710825ca06e0bbab5ac5ae1791189e41867bde97a3a4187d238989024ba969785ff8deb1514af1ef2004f67f99f68edc3da0a0f403f331d9cc41bcce24c447e20d05fe0fc74719b7fbd90acea44dae84f9b9d00216e9dc885c9a9edde4c173abc08bee5a984bdbe882bf226672c05f3c301d1c09f10c9297fea2a0331912570fb75e7d97c41b01df3d25ed6412b471837cff4dbc0e4435ae0bd3a0072abd8c4cb58918743eb24e9226bd80707ee0c258f924614d10eb616c2669eac3922ba466ac8604eb510da8e5ba5765553432ecfc9fc7c11bfd164e188886fff00c72370050194201490139c9115d4558430fe4c3fd4bdd30aa3cee711f3220517fcb730dd9cf9a4f9aa353ff6689ee242225e327f92f9511dc30772c1a87209f078fa3e3e21804b0b8549fc22206014e1c4b7ccc7cfbc8c512a66808667279056bb9d514ba26d188745750188043991e87ee016f3b9cc0c23b37a48d330f31c6bf3eec3d327920776c686cff9e37adf1832718b0fe7109113c794cdde91e3ca6cd2245eace00a2b566ad12990bc22a7dc242b8e2f54e1eeddf39a7ba38212537a51790c1bb99049c9d837f36f03a939ed3a836646bc496ec2f3e823a2cf9363771b23bcd64243cce82334e85cca7ed5311cc348462ddc9131e569bfb5d4ed8bb3d877da10508719fe25578deaa47415664a3638603d1dd80a2e70295959664f1194aa2cf8cfa1b0a54ffff154c53b8b9c82d4ebc364dbc382e8ed027954ebe4a355fc739db4fe4d49359ccfb45e78c5c8d75d4410529f81c63802974f8ba58cf6305c2491924a06d12bd98a058ee92a2249c30f8b08cc8e718fe99e363a97f15321c6bf4dba2289a63e0c39a34d7700ef30b800d32bdb41d97ae87b3c6ec3382d666fb5815612a43a09dafe48ad1132bba4a18e81313414360e4c396602c41a4584c7c26255d841c5281629c5fb8ac4e7f5f6a7125e68e08f5dccc588f61fca8642632acfc26c85dd9f39a07757193a5e7e9dda290ba1a97415e4c387316be57d2d3ee07acbf42ff75e14762ecc429c5336a356d1736f486435c4ae29412fdb97c436f607685e6caeebf53502e8be52829c570b5f11d4d96899576cef474e2d0497909a445749fc8d6ab01bd2cf93dbb333b5ffa32fa8a587e4866e777f1bea7d116bbf5eab4f487e4280075ab2539b137bdb989575c5ba2f28c114e3c021143b0b51157e84d33944e36a398574ef2a5045547dda80a753578383693b293e14a19720b1033f46c055012cdd4f807296690d9c3113209798e6c94c55f74788d0ee3386ba2f9c4999b27ed88d05d998339111b9fe5fe48531a7a1c24cf534a0199072edaecdfac66db644889c0e119d134e14d59e34cd29cea5454dbc121a43b32aa247e82fa6a1a6ee380e8280dd1cfa718ec2953fba7cf34463f65f5d155e3f103a701e9bbb50d23d7fa2de53a71139576629b33b33188cbabe11939b7b087718522f92295274d75838885c08a8bd7673848d2828816a0d674f6c74d70cc7216480b68e7d5b067aa53a4a2a6bbdb7713cfc39b23a192b9994234fa06c8f9ae9ba736acc9b557091a077e7aa94c01f566def86bbac66f6d6b3f309f0cade7dbe19f7e1314216ac0a8ffbf35acb0ba0f9ffab96361738e1c9395599c2c13088d89460805de6a50b42cd89fc6dded22597fdafd6c1ef777791d53ed19fb2640e4aa462717d28fbb5e9f27e0d8758d9e79bc8d35ecccec0f3b1c805e553a722c1d384959af247c239d866d78656401d91f16514a178d8ef76d6dc2046d20648b368ba3c8cb864b6a5681c3557fe882a59a1e4b81853b60265fca9e293467eafaa75c27ed7426edb8253fb95f08379e9363ceb8b3d50703562c43157af444e21aa128e041c4bdb793694184cf4b9b9cef8bb1d88bb4f5ead2064aa6caf091534285d0596f9cd4f54421ebba4c4cb2e1dcdd8d73cc363478447b9b419f8042025f307d165f132b4992a292bf35c78d2e53a674ccf0994e328328280e31052b533902a5db6a160501e5d0e126d258232088abf1dc6201086d252c05ab3c9a1938eca0f725e05aba7f16db97a06b1461ca6facc72189b6e1c335b01cb166b1e446adf74ed2748d7ba89544df73babca3c2ca353815ff246212c55b67fd523d11a8d3429945c82eb6dd14ea7197454fdecd5ac6832c5aef7b94dce432cb5040cc1da81a9ec4d8ddc9afde26c0703a1a9b58fbf50c2a093cdbcd3dc12cb8093ee7f95672502612de9b4d19bc703e28b8a3cb39bedeeffe1c9ef2e325144ef90b1e4146fcefd3b1874e8af350cfdcc9b611becb7d3aed87400579f742c13387819ab7b39107fac08b50dc4c29fbcf96979e1d603c2a24b653352558107d3a06b1b4f5e986ddbaad3b879fb8bee149beab1de13a7fa01c9240117b90d6ab3a8b05d79a4ae4faa619c9a36e123ca5cd3b628672cacb8cad163ed1659f93abcd32d2b535263ab6aa5c58a309085b79bb657d6a9d341dcbdae08a0deafaaf6c581efc9e0b06189ac355e74bcbf19badcb50b69a6f34a2f5d149f5fe48f4504a065bb6580bbd9eeadda48a4d691df5b54f9b22d8342101d619f3e9b4e6336c80ba964c3905c84c2468ceb0d63ffb8d3f60fc4fbbe727ebac1a86528f4dd2d956e5d643e7e5f9298d03aa7ddd6a38cfb19d4782fcf8b361f5e25348551bf2b87a8a86b4fd57b96944e89e253d409232c4d72448ac58235210b8b73a71e9dd4ef0a0b0c18f5443aee0950446b18eed240b8d78ca731ddc8ed559ca62881527907ca0520faaa1bf613bb58b46522f588a7ef602d5888b2328fb157059c14f79af5c2ad8b57cad28d2fd76aa016149d400cde5464d64f41ced57d50f4135a4c09fa18c4e274e6bc45cf7919824c74727022ba5cb44cbeb837da383ba823db4fb1728980471594952540bb86454c2e1a202e49242905562faa519da2886943d56f624d700e69d384511e24863832335fa6711a4e419150c265e24f12c51322c8fd4ecae7fc1772b80f49da4b65203269b1f4ccc55ce5a2ce7a7a49f70aa41625ed3e74a7e0e849291fa75b9b8360a18e626ad8ba389594ebc8637c8c810e5169c1cbae86a523d9e335f83b899d129a277776d154fe8c80f71af1a01f98b7ed976b4f01ba0d5a86ece69e63b44d254ba75abfa1915175c62229cbd953e07732e4a506a415c04e80f5af4a0b48bd942ec8c2fc935797248583fdccc251cca790ca204045836df7353cf4091bc238e6dce2cb2f3616fa66ce6b43eee3c15b5665161d1e3a6caff7433c9dcbfc5af585f50c92f34b5d602ddfb2046863076ffae39ea63218f236745ecd3de29c1a01a4cb3fa6096d700fc6261acb273b58e0951ec73c55ef46902bcdecac1b0be0c8a17281bf8d9cdce74dd631b339da9b16e079502558c2991158bc097d26e35f9eddf518033c701d1caa86cb834ae4a2d9513ebabe0fa754265fde91ef0de9670ea7e90c4f94a1235711f6fe7682f91fb33b6e9ec2cd1c512e54e341c9c311ec81ed05db13e0e65764038deacc9ab651abbd5cc355bf4eb93dadd8afcf786a5a34b141ab48218bef7e34b670228bcf40407ebf3f1fd2966336b940a6baa80b5c43afd0312d3c8d65cfac0adb5b6db0ad42761a5015e80b420163d570641618494ea9006fbeb0ebb683a24c00672254328920cbfec4e0f16783f4b73b31af98dab1e464ee21895a6c4e4d4228b45eab315b731f581d69170e9a10c6694c60e701ecfd4a241eacf69742637b67ad1e6811c0c9f56b3456e63b4420e3b7f1931d4ba0fd49e167b9ae8a406fc66abb16ce6f27b74709eeddf2184bc35726c15cc3d71858a79728f603d43cf9a1711a2375fc8d63f285e00161dac28dbe95962d4e3b01e2b3fb8bf1062f84269252793d483eda0e7ea0555e10f593a15c44a20a9bce43bd9b856972c71ef43349f217c9e33ee159ff5327866ed5a6629ddad0736d54b213152f09c90ec95ffcf592818895138bfe1b1d85a7c3bde7c86e0ba301a3719c0d013afc23cae3b9c3863904706af463b533d69e9934ec9f09c43f95eae08f88c6954e35ec7f05fe1e03c99708e77cdfb88940b0e09e629c10592f5d24d2b2377445ce6f8ff6d6af2a3eede3e4a7d62737d039ab46b3b11954d3ba7382a11ac8dcf0b9b1b9fe2e5a89022c508827106ccca56e81e9eccf72faeb7a3d92244cbeff32c969cc0f58c1ccc5767ea455633c0151036291a26e3e3dcb6bbd78e0b5f17c9fbf6fe3ca728178172d840c5906911d2af50c297104bd9342de46501075f5c850f17890947e088cc7bf9765073d15a2a7c75d6e9615a6c81a8cd3d8da4cb911aac9dcb04f75fe07ae307122a510df387ea51b4015b97164103bd174255fe48cd3e3116ef6bb5f2f2fb112cf0eceeca6a5086acd81d74531b8b8ae7a01c30c295d676ce7f350413a0ebb27fd824051bf038e4c9e8e01ddb7a9702f4c7f2cb6dd6e46d974c299a5f7c6f222dad17c425e487cdd32b52560609fb4b37f488e5bb7651c61eb70543ec282f76c5475306a2427764dccd96ef5793659b0bde5e0b4a3444d9a039be9a46e7066cd4d5edd1aaccd36fe3b75fbd6ca4df7eab71fd4e1534435540d029806eb52f23ab6d554efc744021adc8756f8a00d6764d880d8d16cf1358b1bee0b1ba8f97146e53a36ae1362fca5e1c5b69b5f56fe569e27f96e2b831aa95b3c9821ea522e7c54d425f4271f65d9fcdda73fdebf74bc622ebed6a5a180a29e3bc59eb7c09f50ef426830ea7661d9568b66f51acc90b2d786626fa492b373167454be6231187623ef4116e38e07c7d8894131d629febfda9694c75ddb9c4b5c039142de19423b9d5c556e39d96213c55d20ee549fa2bd5b85f7c4ac4ca7107dc5c6c0aa68fe4d4a76e19bf3279bad31fa62f8e998fd7d6e66ed532782b717af828167ea5e47a349275093e261bf6bcebff384145f9898a24cdda636e7f6a4cf8b4727007855bc6bbc8cd60da4ab4ee2cf74da7684606938b1207fae516b4721c44442d5506392548405a9c555bc7865150d4f8470c99e2e93af5f3e09213213a9bc330e8c6903207fc440a06a10f604b085691a323049a35761717636d92a2c3c975fe17fba9c8882159be1f99f77550f3035aa4377e0b3cf4b11caf0decbe823abf39b71bf11bc63046fa5eba985bb8d511166de61f53b3746cd8328f9e83f386436d5414de71adf90083d3e4db68cf6d95e8abd030daae4ddf996ffc1826e3326808dabd801beadae04d9d483a9b5d278d5a63bc1803efd553f422cafe1c766485f78300fd66f75cb771017b08e08fc16d90d8e21f3ac7d05712f479f4efd3a464a848dbbb6563b193b0959fd64507b36b4a03671472ac3b4148ad7f4266c21960d65da968f09620743d31e16a55b62380df30d1b93abee659f4fbd59b13992b89ccadc2e2e3bc4bce25da00075f566f62787d0f61402a3db27924dfa59f43c928c3ddd77535096c00ccea28f2f21b4dcd5e9da972c2d8cb1ec2dffa29a7ad56d831d1f4d5c3444654cc6d3b3943aebfcca2dcc1eb840953be27eeed8a652816280a2611456a78987db99dd76eb9deef721e3ff578f5f9f7706a024962a5651240025b15beef01a5e7f596147e6faccf76942fc96ef8a0bd65045df021fa993bd2b7ef4521ef2a29f7734975c7e9539bd9569b3799d96a9948af19dd3d5244971b5b58bdb8edcf6a24064aa692c93dbec9036b87dde04e7c7dfca8f25bed8c94d6aa856c2ef4405c57e5f02c12590d80cd0585a9b284031eb82345749ea69556f54393d88733eace5028c28dcf3af62b46d66de1a7e69169df8443db043a2a64ef5e3db130a1b242190981360c7b278163ec2c78c9f6a2b5e0af3d5166c99ee09db4c7af6a54c878bda5833b9e7dd47e71caf0d5d752c7601153dbf49c89e6616ab5d841d6a6273708cdd52228765736ae0150f0732100f3515dca9a7ec2125bb7a4606d581d852642c2b59e8b60080be3e5a72e8a1f5f350bc98509fe6d9f03b0f74aef52c325cbe20416c4e1385799166fa2cd344aba95f7e0d2ae232d0f8714dccbc863db54592db65db025dc40d6b92eee0e611da5f5a52d33bbb7cf73c260a315a8347e37bdaeffecbf84ea8f85dbc0c86556759ee20fc77115d15f85e0f8d7632ebccc035d045c789bada065c89e0f432f4aeeb28a3e8c89261e227440233b42db34dea54cefe85a75e4aec2ed3ddd277633bdc4237353d56b4ab2f1b8153d4ac71aa08f93cd7de71ed611a98aad728dad8808e607e1ed7266cbe595760f86fdbcb875129874b4891e4b0feb689fd30afda409f9db1775f88e358992aefbfcbd6f5e9114529c0d9667edd3ff155d12e87c64d8f8b879aca4f3b405d66f7236fbd84fd375c9ec202d9fd8a7e17d75a9cf08728bfc857e37adb74440848a40b0e77aacbf48ae80331ddcd63b53573fd1265e9d643d580d7c697b8039d5f0ac4bb22f8d738f099799d54ee28c4211765ffdb86fc92855631fe576084cb8f278290cb30a1e713dbaa5fbc8d1823db02c9acf9e0c4a60439cc491e9ae839c9b9367561bf7973d3a72a2b865553dab2fbf303ad0f1f839cdac11b005dc16a10733cd6f0263964975a1c32b6d17dcc48cfb8137c4946dffb8efb42f643e3bee62057df8e492c4ea7436281f4ee4e0662725caf8f0c6283a11f64324b5583bb69325cbb6539f73070e5fbf51616ae6c97d301a8a3cc9bbe2beb4480a9c861528e0db52a399429b7168e15497ab07c8bde88083b52b519eb0096ad50fd7c6bba1c93af5518b5af8ea1ca9c6fb2a0932dfb3c1d9076bde4da467be14a1bd3268949791e2032285ed5c3c3e6fe37788c78eed3fd14714ad96a9cd277fdcb56ac288d983e097c3a900cdadb4abc46fe0d802e2a5a7adfe1de32259c1e83bbc6491e83a70d9e865784078740332ab1280ad9652a698cf507af799d768ed7e2303db083908bdf182adc0a5b931e14a8005027417dd69cd5560af91c9fef33c92f386be35b6426f9ecad19c99f39014c4ec01484c6e6b77ebf54155b6fdcfc06d2ff11f6bf44308a7074b71bd01d1bc2492a5105b60bfd6a14fe533888e2021212fbbd4996bd519d5f2b8f8a28b8f89b8b03e53a72b5642d2b620e1d1518832464dcdb1cf14f8229e986adb35cb74fc3e05fcdc4c480a95cef585d3982e869cd1983dae676040f07866d6ead76adb108f15fcffd1b42f1edb88ea6c40b5d0b89d3c5579f3ac3d4361d4e9dbe68f391a142abf6261561c701d00bb74c5fc70f1e0e0cb8dbfef2cf94dcf3d5d10c5ab7bd7ce35521a8f7246d7432a759d6f76c74ea07cab4b24e4ac04ef6dbc0d218bfa6674d4a247f28f5e34af6b6d30ca507ce08bcb81bbabac6aeec9c9e8f373ff1807bda198aa195cbf11be4a73ef909a44c19d170a1ee548aec1d4edb72973dd2261def388fa3aa024a4f77d8c0e2681ebe0011857c3c5ef48845e0b20c0ff23383d50edf64102488e80eddcea4045a8f4abad2baa2bbb9dea50feb24ed4230e176e535cbf783d0a1cc5fc72ed3aa3def114a9ac453ae4531cff4e09c70d549ab85166bf760563024476dacf9d576367c269957f98f5ac6a2155635daaf0770c03f7441831153dab82cc18dd16248e570bd520f4437eb4c869ae3305caf8384667bffb4b1658deaa73e2667434fb7afb9411375d8f1b7daa3b606e4d0a94a6702b3e5382685a3f595b590a35b58938afb6e455112e1500e1cd58c8b3e44ec735b916819e0b4a40b0f3aaf8303a25dcf5f4752c9329088950636c6672dc8e84902b2e3175260615772ee683b05ac70aba6eaa0f5fde5b8f2dfc038f5624d200a1f651cb0a3d2c0be8e5cd843ec0a7cc81cfbd2e75bdc8d51dfb730cef63b80e4f98838dcf4ee0b8ac9241ea83c833368a112b28f817c746e0e0fe364c03a87b2d34caf7f2a192693ad1eaa64db27243d5ae4bff17f0025ccb6c7c4cd6da085273def2c5d43270e61d1c3a26ff2ec5fa1bc7ccd1d78a3f295974d212723776187225a83a51cf832263fef8bd9a0bcead9de2aff0fbbf8772922b5b2befe001432c8740232cf66e7952a175ba21c498eb38633a39b87893d410914c9c2ae2ad9773e843f4ad704eae5200b08299c9e44e0351cd8911f1bed5bf05fc9b93d18a1e634d76a6d8243f5f68cfdf5b744d72a4e9eb0b60e0e65d726c013bfde0041ec228e635f2d50d8ab7ba13f3fb8956d4c20a2b2ceae9c327a8e73cee27100a8909a0847afa9da2963f4982151aa5ea697f907ebbeb6e1a2853d452e6e53fd8cc49c78a643b50f3d5c155da16d7774c15b20c081b9fbaf0349b671094ebe3da38171a8eca028b02480f51373e4cbc385a101344d0869ffbb803afc72cceeccb19201df6d41ae5c174d16fcbd45ff63daf20a275510a38f673f3147b8becf37b912637c44f0b07e8100a7e488a6a16e0b26b5dd43143887a6c4337c4f5feaaa378090d9c7c3744579e136cff1939e882a1423cac46ff8e8dac7ccd25d762a5209822897873689b078f075e3bc7f14396751595d650441ab65816fb671fb68d9726daa1fc686195d47872cd53b97cf59df846277ca43a9a82b283916e7f898d0d9cec657e35c28b86a7e41885bcb984520320089e7021b425d002edcd4bbcbd4156f1301603dacf3207506ce5b6498275b396c6a3a60a28aed5b8bdc85067e5fd3ebba7b5ffefa209c96d12c57b5702baeb75ea3fa7f6517e05dd70d5bdb651a0c15520fa89cec71cb869db009900608e750c84571ca267adaa334b7d4d2a8f32c4c5c1db00386e93644dfa8304a5bee63d9d7f61b963df976b049d42f44176c0703b380b795c628170fcb09301d5a160823df877fc33be2068fc0caed473c4a0e946798eaeacc5ba0bf582527abcad7fc9c1898a95e4a4f6c8198f4fb958c61190223415ba4b2d4ed53a597a92a54066995553d3140273cda81ed60c6af2378a8cfb5b0d28f400d1a8f10fa6ff01e7279b57f1da17756f279273eba07960dcc048a54a8bbb40155e068e62583b7cf749f07f373badc851c0a750204a2cd6de99b1492610c15ac0293c48580f353e01bf3605d317c09cb576ea4bbc017b7cb3157c8573ca3110f8e10817d355d9bc5205cb375699bed5d577bc5e86ec0184bf13b38a0904adcabd2e49095df03e3eddf18e50d9b80787cab43c1c4bc37a0496dbd09feb8c41dfbb762c4c4bb8919e07b3b00ce74975842f8f4cf5d76721b1c75d6bedaaf33ffcfa0f65871fc8f912dbb628efe1a8efcfe880902b160692703ebaa545ab0cea437b18f0719cf34d9c464461209075b20b3e6468552bfc24c451634038cb0f229585688b80ae81b0c8e0eac04c227303e34cfd44c3992e74e72b2c774d65a065c03c49b463187753c43c52d272422d8cbe3ba8d49b1c2ffdb4750d43c0b0da50aa6a3bc5d6f12d53a2ce9d1f7048455413b9ee961d1b35ff76e3c02139fbdfc5e3427815fa2415813cea9bcd526fd76ae826b3b7462b174f241c1ce88264f48aa21cd9ec17502939322a2a8822d25b470a60f8dca6b1db28d0b17018ab6765f8f7557e103ccdf06a5356286eeac74529bb4d9e070fc08d3cfea32dcc8c1a236b951103f17a2277687e4c5beff50bb58c114335e9b73f54c294460a81628cd00b2536e741e178390eaaccb3f3674fec3e15474ba8715f0ed47d483a71a5c15fd54f548b8926c2398f80508be0778aab702683ae8e221c2056072f9550a5535c23252b134209c9d313a3bb3f4662fdab94b12f0a65c04e70814c108706b5925613c4f012be5ec4b2c2c70d51cf8b2f9245f7d1f5515e5f47d1f9e7fdb21ed41aa3a2b1a9f1cc1ad12f9d2df205eda389008a87f9cdf3e40468125b5d2fb3a620b8921d103d28123418e8a9daf2e42b89ca76f54b601e7b8635c0bf6c8802c2e201a4b12df49fc4920bd8bacd90e08863fba1034453c8789407814eaa597193d2e799cc0881eb4f457e8a4f93a22560bb4ddd8f258b8149a5d85b9267c23bf5604afe5f00a323ab99e3d06bd772339c0a533a82959c382534a6c3799e71783d7e3c5531a7a014309ed56c619ac5d6d4102d8cfcdb4069ca21f613e4f2cb78465a6d26f30d809c203fbabf93fae76d34f3829a489bd78b309ef2e676dc2c128c63267dabc665b28eb9490acde77613523e58651a0a6de6368ba9f6ab3e9a0d043d9c1bb3d37c6cbc8c159af295442217b28c6235b005134e88adf269da46a357a2c683029d531880b63b248c618a5bce0020636a206558e8ecdf431587bca2f0fbbf02d8e36085c8f2b79e6b14f98e4a3d68d40228271aa35a2110e21a8d0b370bb18083d67be3b4d00875f0fc84eb67888c51b06be8617ab4f01f748978258aa93f5c0015bde7d242dbca45531204472f54f4b2059a452bfcbefaafcd243e2c0a21796251399bf6b1f1df41b7842ce57cc37070dcdc4a6f502763f40db837230176964ae2488fbaa6099164e40170e3ae9f6b623b81b56879df3ccad5a513d4296f28691c55def661325e065ad6d2541e0c5c5bebaafaef225bd1836362bf451228f0a9a3a813acbec2d410284a64bf1224a6fc8c70d764189f798cf61a1964adb9786d64b75f150b45ad90bae7591c1ff9bb1e98839c57d99c80b1480a0d9e31c90c09bfa6ad8a3f95e258532dbdff4453f9ed6c4e509f542975843c580c89ee8519309a7e5442e683c64d969b387afaf73ee5f899707ee2f7e9dd37984fe951d924e1898cf9fb18acc8940e16e7a00d63c484c312dff31149d8b852af108ab14af57a57a07466b77d148945ccc5430e2482150fd8b3eb806ddc7408b8100751ffe1f6120ba2155be0fdd22860c172c5c152131f123b7adb403bd6759e55fa745ce2adde726b2598c6ed5f85656680a2796d824f5300868e09aadd5e59a11af3db6b85235fe9a975682019cb9bcb984f730f7c47e87ae17daed4e8fe6986333db252422429be937177eae8421c4057735c978a0bc27b63429e5a7ba5c37b8013f1220a6a272b571570a1267cbbf89dd4b38a299803f0521aeb2bbd4fc8fd2b2f11de0d7c3cb5be6c549c7115b2691c1e7d4e1bb0693668df722df24a174b76bdb722e4d6b0aa9d59ababf1a987cf890b202290d6dcead0457996ce8ec4876c840bd0103bcbe4ad62caf51a74cfe97c21ac5e150fec0b83a2bd22976f445f1501b1e8c1e317abd46fb771740ef5946eb30e200b4d8d15d2697a32751069908c44be7a595f76dfb24222a2219c6416f6b01c4651b9fcef11343ea4e2991ac8ecaeb741fb96873a6a159a1342045e68f94e43b3245afc800b7f55b49bced65db2f0306384e118354978d6ccd4ef707434af00bb9cb400f20ad5ebfb21bd6141301c0b07ffc0a76f785e1c826d6a1ac38415af3db90d3fa22be05ed479f04aa16378731f16bd72a730cc1390d13d9e97d93fa8d6263136166799d090a6f1cc0f93276bf2ca2f86f122265a8615210fe6a16f6424c40a9c753893c235b644784d02d0f7c9530c693c99fa7de04e24b4cb26c5b3814f0d7bf20cfeee105fdf99c0ed8f135a313112e62e41451415d788eedfec130175e524aa84abe66cbce8df9319521a036aae34ad2b98a0de7a912e869b57334ba5063328f68b41ea5533ea3c8150e3f186d2352589b933c7c2a8892d8828ee2432f829cb15850d76dc1dffc5318f38daa06390f241b7a82a4e90947a1a694613f69a6e6b80e4b2df98c50e08d1a7421262c953480c7f3a471e163d87b40b210889e6f15477aabaded6e6650e8a8c66062059a1ec618f7e2e41f2ad8d411b447c09cbc673912e0229941a00774605a5de8d921d38f518a4418d3b2f27c80ac592b7f38f7865dea8e4b13bc0525ae8d46025e62aeb918dca6465bd3b27a697ccf9394290fdf2cf1017d7aa46c491ae93729b4cf71ee990146d9bd3a46608d5de18e3b94b4fb391a57f668fef26959e00d2678aec0976fbac8e9287e1a35e87456999e2e06a54d1e959d4148e80a363e88dbce78c86e19ef9b9722e3a5674047c000fdc959a55f89f86faa11ede7d60d595d678898e96f4a828fb16379eb45c2e6ad141aa0ba2c525564520d337139241439665571a86014a13adfab2f1341158123fdd88e3cf9c2205bcf22495fa2d12eff42adba3a15e0c51bb2d861c69784440579f7dbc412cf2a0b853a865c1e55be6293ae269444c3ba4176de43b70a26f6a8d128ecc70202d578d805f283583e1a84a2f431f82bd31ee90d9d0db8fcc01d6252287f93e1d7015d1b4d0a377a50e4e55c1c3920700aa274be398437395e2980675ede353cece26d6fcf1ad5e2b8fe12ab7be2f01369df78f69253f03be08db411b4d58c9c2e77922be3efdc3b6962993a528efde82eb0d90abad0fef71eee632a4f100c1dcfe18925b021258e6bd0c6a9fbc613a95b3479897c5619e3cec9bff6f44daf7308b363912b5fbb2467f01cd53ec66d978f0f400fd5fd0583210138afc3796705b6ef39dad33d22ec41fe5334f77431d2246b1a2f33a0d330395a5f8465a789f50dfcaa5eebfe89e547bfbcb69ff465fe66f2960cc0c82df2cf914ee2f85e2fc2ff349d23a41c8242b08fda14f2e84c7ba2ce7eddcc9280322bd949ed13d17788f712a37f187bb510054c6228d274c4c8d282cfc1bdde54c1567aeb2f7be801bc8438706297a1153d38fa60f7fbc1d87e42ad584af67a03af2509ecd5471c410e91f135679870fd02c1b2317eac4f25bd721c350899fb54485dc3cb0b7e5dbc0b999a0d2e3652aa80be06945909c2f4b0c06918401ece9cfdb2628549cae768a25c889f70aa63ca3fc67f0004e9c0af748f5b02d1efbb33762ded71bdc2093c5397216bb89245fd7546089c99309c7a2d8817b2b4645e69c00c1735ea294f2a70f1a8b339bc928522a68c7a34c55961f3c409168fb205f855e64bb2ea47f40badf2eec1ad0dcd945e92a53167a31834690079e5e4924c1ffeb0020f5662c4dbd8efb2ce6d993e4c5b16bb82655e07f49f18bf4db1052fa9540bb2b98450e7a2ebfdeeb800ae70d229d4a3c4e4b464d79cbc2f3feaa08b01647dfdae620eb0abf25430cdc9814e0658c44ab31209c142fba3c86c3798a01ba1393c7d0e8f94a1ff683c24a2db2601a7926797fd40c284c65d500583eed9cfabf3bf30907b7e6632720fac764c893eb1d559e261bad7eb0e2ad885a563634fd88ef04e78bc7ac7d46a0954f2201a8028b545fe28cdea2b01e7912ce3e9a0bcb1ab2435144ec15403441442b1977fa523745e88da3454875356a060b1ee8f967b84bcf286a38a5c7469438b4ae3355b9369163d87f9b2f7492068366ddb49aac48d22978fdd08cea18c94443aab2d16599019b860930df1442f7b5924213a31acf3838325a408e9e31d32094b7df8971906cde1f52c16f5ff8cd8a19af91a4142fcc9c60176815c1fe50434b8719c46bf344696c2b280915951c4e640d9e7020bba46aa0301fd4aaf859c9a4bd6ac0048a5c7aa4110e5be34682de51cbc5f027d414c6d4b2d9295cace00ddf3ebc71b88575092caa74fabc1c055ed2cd975e0f3a957d66e5e1eeed11beb530a131d8e9665b2cf1ed9aec1c60e45c808b0811c53951e2a930f0ab634a4d1d252b6f6162ecb2d1d97f336d7a00b0f5373a95e82f8bb5b9a225e21080d4589a32ba3547af710dc5f75cd3f92ecbce7bc21d65537df35ea1da8bf4e327b842d0e538142eaf2249e71950e6b591d4b939320f9e1dbb9d50c7a642f78850225bb17a56fa6ad8f6c56bc84a688ead3cc090a6e188f67ca8e6e8b0d3c1656d4e14766bf930592144e692480602e0c5e65eb3fd6677dceb85e1bd6593ecc05b64beb75faf78e9b738df5c3acabf28feb1906d55b03cf2fc104dedd0dc49795d267bb1e53d5682a52413a405898a9fd3be55c244998b9117bc72398e8112243022a9ceca193ee4f73991e54bcb693f772b476ffe5722095f55477deebb0eeb0f4a23d6899004ad2022617c2c2f19a185914557984f49735f8dfb5849c0999de8472e0261af8d7e2406a920a9b4c4a774a5ef5fa29ac6986f95c307482826d21e21be88d8e659406c621b69fcc1779d76cc5d1d39a4fbfc3ebd4b0056b3df574fe5740ae9f29c6b260f32e24de087fff5015596907f78377db610f19bfaa3866bab84d50fd66f3a219aa941bf288797c4963ebc2e3ee03ad35eca75968eea183288d074ecff13191515978b6501eb58f3718308a3511ebac017641f6de50093129318760192eccfa82b6ac57a1a407b0aaabd2cdee98b5ad4d29922402c55f2242289556a8ce33651ff0fc32797969c809ac0f09ba0b5c83590bc8ed882fde7031bf60ee4ba41acee1660985b787cd8f57e2815dc86225b92fb4e3db9dea087b530aff732e919cc4299b0967e6724b0c9cd5ede9a8a5ba2b2fc894d28379879f3349a3c8a3fc6bc14a6a882308f4e3fa2317d22dbe6fc33ae7b597ef54d6434c7cb251d4d2a938d679a5e5afa7dfc324960a7d3323b21f5b4fcaa0def2a11d56b6f781ac28c075e170cdf6e6c40959bf42b1193b3c094a1d729650575e9e14ba6e8a4a2770a6ca246cb74d97e989947d69799e54e6f6a5af31cc22690f2b2b9e8671f6f55e3a5885fc45b0f6af1fd5adad092459bac897463179830776d4f080ddba60d41178307b0f55c5137e0f9e6461e3e0d97d0a1de249884a96c2a4ab5fa905b66d15f3d9c803162fbb3920a65671bd1f342276ddc7e391f4031d1ad63c06e36a385de78a3ee5d64a3d05d8961c0d379fe821b063e3cbf9e92b6481a6d58a333f754770acf0470dec3beb870029607bd0a8a6c953930452150da30b788ceff97d93dc2054c8442253ac2890b050b5b1de3809fdf38defdf9b945346688546d482099f83575922d34cb923787fd998d819e746ce6ce7ed1206f667135fa8b575ac041f22d68001132b94d5c48eb6f1af6bafd69da41703b239b08669766ea4b4d02696e66ad82b30580bac3041c43073cf515e29adf46e69a8aff93ea9ac16077aff6f3c43b4b0ec92e3cb5dc7f28763b8e0e0adc09176fa45553e8429fb32c9be997d804fad57ed39c117150a4869a3888e4ec0fb5b926b88f5d5dead35acb36b539e58d115dd0a9a5f62f35b5944e6666da5ab5c18f71212b632d72d0886bb998978762def7904cc63f60651a57164884948bad3ea681fcc5eff732f8a97d42a9ffd0fb64a84ad7f7f706e7cbdada167312c0af041dc95058ed0cab5ac3e52cdb57e309deb2adc676f89b50a4d2548ddbc88f6a8400423cfdadbdb812b8ff985562b1275812821f2f4a8f8fb961f8057ebde69cdce29527124b3caa82d53df40b46b4b7cb5aa8366ca0b1fb62fb33cfbf37adfa30844c1b6064a82a2baf6f4f9ef8a7354ad28a77c2c4bcd0538c32e6d25688ef08fc4ecf1d58f8564a66bf350874e97ba0899d955a374ed7fdb77110df4deabe197dfd07c66bab8b156948c9dc45a0af49c7fbdd16dc81a488910588f1ef2802d0f105646c4b0b7e4469e0e8a40b4173d0c6e9a945267fd51fc248e871a824a91dfeeb03b0e627dbe955acf7feb724e09d2199a7eb502156818e9400a3b98890d4e3eeff0df7c857363c68637d361a7f418af39f89940e5b3d910995053b5d571e617c495826d241948f70a081036a00c50431f3d3ce6970835b4d64116a8d2ad48a5a29144de408f301f8ce548caabed85d0d4b904831225764015f56291d089d99acdd4efa7986a759df3cd742d73d424cefe6f30fe96c794737bbf9ea349d42e1198298c86900dd5f1969854e6841a4ce842b1b656737a7e6b4ddb260c31e3613fa6a06fe890f0217af1d33a950313cc59c6a826728efdbcf5229486d134d1b706c3977dd6f33d0ca28368e8b67cef33867426042b98e394373c75d19081ed434d10076623796d3322957357db69127405537ab57e3d26ddd2012d85300640bfac573e2111539ff7868eecbcbe3ad632c0e7397dd3ebbca811bbef43a4b2aab3e2eb4b51cfc4e3cbc28881bae18117aa38e5c82a65656ab17bbe1a8f1e49cb8138292e1527bfe78f64980c44d6653639ad587ce479f6ceb9afea95dc204ff8154b666283d58cecadab5c8d0a67049affb07ed569e7d16b34dbde3e36587db2fa1892705d9935e9f8da2d2cc5401b597d0311829a9d52ffe4efcf52a547b7aeaa58aeb9f78df2f1b2d2970225c1fd67a67aff52fa699891ad18faf16a09832c1cfe9e897b9a40b21a3e2498edab940d77cd01afa5fe1e3d191166777e1c5eae5bceb78c4ca184e70fa954bae5cf0526f44029adc2d80dfd33d6f488b5e2e3a4164b271f223926ff63dc65971c1dd51dcfee2b5cec1953d12b384b82c553ef3b5c13ff71214ce6a3e0b05cf52203e8648f7a93ea08d5ea03e14b375fe96809bb4e1fcef9a9faa3d39eade3bab05695424ce92322e07369534153a828dc47564d26681991137b4641f10676bde4469de8d683c95d96f8a0fd9a589ba88c50e73f4ad0d4f307d245867c479f2aad799078935b25394060b11fdeb56ab273547ece63ee17b3fcafdad7f8f42ba62362d5f991834d55f4e6bf0754c5f387d194062753f47c697d09625c43c0570310dc10a7966c0b8b7d01ab54df21d1e1daaba6a8007cdb198304d00081c0624ff0d0145c288bcd77ea3d95e80a36f5b0ac7e306eef8c665ad63f30dbb7285e4e734a38b48556b099471ce834b5450e96c10981ebffc3ea48602c457bffbf5ac01cc97f086592a394a6dce28f35b76f87f7e3f75b1b258925c415a44ea930a5cb185890edbb29299b4cdb536c1d30d48d495e7c6df1171c5d8aec7f40d15249c95fe2fd3cf801f4f93d4436004d6059c7da7b518c5d132d99f330705f5543607be3cdee54028801c8bc52ff5a8bde2e4b3a41ad8b4291d7ccacf3a3c7c2237b9b9d55887a764363a2bb3317dccb011e91c880e398c6ee8f64078469b2c1419008c83fd048ff578ddfd5e987605fa74b79d0b68a8f3a7e48b45174a5c0c7d3460cfe8165aeb81fd01420f217774e9f39fefbcf6455b715e8b65c48e080188030c4f1722b23f55a094b3e1a8dd48c1b2fcb5932b1e208819da5338346000884657065f273f62866ed0df32ce7405f6752dcdbf555bf0d0487e3e10c716aa75ecf519ddba5a1aafd5f8deefd607a2411c241ef6269c298d28e4ffb2c5558602c76adbb1296a13ccd5e867fbc42079b01202fce367ff1c39962317a7da46c631a32ac289580b2e2c4c3dd4da60786ad56056089dd8cc1e9ac526d09ed796c38723e4acb90478827b60ddd9887b61aa2ff084027ddb5a951cfcd91c0fc0a0c260509a0bbee11d3b7da388b243d8243d39d8a1083b21eb82b81960d5d832e4b7c7da97f396cfb7e3ad542f2a72ad0b4d04316bc72093468e0155290782067d36e451f62ac047b0888bdcfb954e051b633c26c83e0e8818fc72ee2068dc2a287165be7e9808b722b0d55ba7a7a8348cb151502def7e8eb90f4941fd59be2f1918c769cbd2a1d52b231cd685efdf7eccf0572c97a2dcccd23bdf8b91380d2a74e6c05b342e6878ead400face3130b14346019c1a5a4895a8acf2b197aa9b7571635952219264b2118ce9d59c098ad26ed8df9a87bd5a2aa4c35df173cbb25730ad2d80dddda3ada232d9c2df82477a69702e974f3a24e452dfded49e506df67bbe6d48204e7088725ee9309bc922cf1cb4de687ab00184dd0498578a0b4724cf6742350fef8a80d3fa98d8a314d3ac09667b9c08199ea00cd875c6484086c03e52d40f6bb3c734b93bbc5b198780a4c4002047222b06bafc1fcf5ae7db50033bcb12c26fc29a2c00db96d8b8851e214786eed50f92d658d95d546f987207caa716ba353a78a9a8fa59136a2c93bc21b9ee02ba7f228b556ed96ddaa1ed586746c6f3d4c0c866847ea4334843ae01c2f6a222b8d0495bcb8c3de0a0be684b7103bc98b5308dd021ea5042ec8d286a2db180a61dae39473722407b6cb633f881b3608e05134cd6ed79538de3241cce73a6d6347be5d5e6e9095bd2cd0736dab32b14fdae4403036174d4553d7b8ed98e7423ffea9dcccd281d687101aceb7abd68679eb5ab76f35b0be7d4f70ecde7ea0b33c986e09f384b614c2acf0b79af291e9e9766ce507793dfd16300cf1ea28f64dd845ba0df06860356fc4e58cb577ba8d5c8f451a1721f1e10caf6b99f5cbddc80099fb8b581992a9f75954d5a41afde440f9d4db7d3e8887eeef174c4faf856b08dd7c2f8ca20c185516c819725f762cfd410e0c8be6deab68b627384341d22c5bbf62437332d121a9e2b78b0569cc3a38b25261a772c9e46f5a6fc4ecfb4d19d3584f974ee7b88b8b02a165640394f9bc2c96a8c40408f047a7e0706fad61e4d36741dd90692e93e3d3739359ef2c52dd615d8419669df3df22ebda9283285e2a566e1be1142be9b3edc23e953d35bbd702a345bc505264c4445836f8b3ac84c174e3381a3c522b0e83c6994ba731ddb5f95d115ea718b9ea750776c429114c5c7936387f69ef222e3038d04258ca5219530560552a0a174fcf41c4607a20f65b1b8c964304d39b7eee25d8807b9261e73f356644203ef4bb64a179e16226e9526d8ca2f18c67248907485022624f5dcb233bd27eef0539af233a73a088ec7eaa79408074de9696b8b86258d55781a31c2bab011c2151a88e6a5467205029be7fce62f0a00784798b4ba41295517b2c6377cc8528dcf68076b9d1ecacf5ef718fc14db87ed5b5790e485ecc1e4f6855638bb7f03b58e62aaff9062c2d9ea3f08894ec5d895a6c268025f59a069a9ec4a90cf01956e326922f42a1f77ef146524c642b71aa56b49cbd3c2570c3391ca883da345f0048828cca735c58e4426c9477b6975b6c649644bbdf591ffe5b50489ff2489250eaf55d255a38570ca94effebac16d8a4283621349552285684ce8b46862c3cba6ce8de25c6739340a6a5556b3a1c546aa97d8f6c66b49295be6489a257685dc3fdbb1d166e7ad1c8bf45ec9ac8eeed6a9163b3a5b0a21f3228e8708dc5964f52bc342c55bb2f0e148abea75e52aaab2b36f516b46c99cb5924fda0bb759cad0ca94b2eb03ab91b3d1f73b9b9a0e43ca6868048f3692bb42a47d6f2534f05cdf106d00a69d6030fb3e659793dec1656775a79af37f4f4bd0a4fce0bf17dae0ce80c6c005b0804956dec0489b0056f0c9112c82441c0937dd4b0233d257c814b41ae77c18072f3f3e3dbf8f0cc8c750b1751007bb7a302b2e060d24f2ae7861e880575ee018a94f1b0bfa6cbe30139e2e676d2a0bf64af061975cab666abd889323f4a53bd21ba6a2659607f516cafe51fb69bc50437efec608b88a59875bd119fc41c94457205fd3beaf0d7c2d40e61aa30423b06afde45676c588830108452452e18e549d05e9434dbb9711524ad60529d690e52f3d075072c9064fa556728538f01a9a55025ccc6d17822354e4ba9d28bdd30319eda05e92396c08ebcdb3b001400afd71d1068984de8f93e55841659e9bc7065c7858fdfc1e87161ed1fa7d6f09de6d607b14d6723381851dae06a29878a6be69d6b370b0466ef191643a99d2ba4d50f44f2f751ae0e887aa2883f5839489c20afaa17cffd494bb85d4de7ed51fb948b482402acddebbe4d9587b026f91d6bde6ddbca16956291126398315689f49dd6dda44628573e62a5e8dda81a4e44d60dd1157eaec8e12c409eb4f0506402a19cf2269c412300b443fdcee9f49323a17d1eb5d5c6ba27ab78efe74c3f2c09610fc03bb4a5a447116db1212fa059e8dad3fec979430c25e9939e3492150c5102728a12de2e86103d58aab3bd51c49459835ed7d2987ddc97dbe608fe23d9de99f14dfa5803f11cb920ac2fe4252b5693b7c9314ecfe5985ac64de77edf2ee111fefc5e7dfafc68df040c6c0b35b6980142b3295b58048345afe574102573f5f3fc943e37a582ebe884492655251d4438dcc3f9f1f5843f7f2b4eabeb8cbdcb810c486c597e7170f7587f850b9d12e8c27269436f00e19068fae90213262959b23a546acf29b661f72e7db419ced65d7b8432ffa7c46e4a16d3a10597c280f48dce0a060edb1a15311a299ff8d6b790333ec4ba5d36ed47227439f8946c4b09a38516837e17b31b2525d007b38288de70430fdb63b06c409524ca5be1d1addfc5bcd09b90603fe758d480fd9b22ef43eac5915671ae5488e0d37d6bbb657c804bd3bcafd5a347cc861fd992da963eb3122a3aafd6ba009119c60942fae557f4774568c52eca28aca117875c95d032602e2b2af64f18870754b868d5c6981fe72c8a0d6b4350bfdb1b5508e7baf79a1e1b867e985c89e1c37bd2d96a6df9452773f8d322aef3c0c026a00eb5d6cc0511b3e5b694c1312cd9b5ebac49ba956224d6379848761ce4a5237fe589e8a52e4dc1e389d2115cbefba2258a4c39c3ab751bd92f391d014eaba100982e7dd98c4d1bcad4ea52ab8d59a458ad9bb4f7f1a9e05f3010e5158f662c597aaa838a39ae58e4a8fc34fecd08241596d66e5e1a083deb20aa2d47f3f3ff600ea453e97f4eeaed17345587ee463e15781bfccca8aee35b0246b81dffc1a74b85c04c0d87e9c13335d225295f4240f4451bf0fc3b5efdd969415d7c567ea3dd439ef41b90a036b2a8370ada34c110baaae4b82fcba5a18648f67bde172dd842cefa35f6c0383ca5f4dd00228e838b73ea4b26f9048c61f50730f17aaff16aea6560d949ee235c98ec0b41bf07d666ba7e46fde5791de0fa285f21800764244eaa76206952af58a40d9808c521e6f1c06267268968304b576119a7935c9baad71d1c4cb0e3c5f294d069adbf9ff163ee77a8200b8e6a6b3f472d05c07c7db536947afe70ac03437dbb36fdf4fbfbead4ea2604274addbcf8d36af7263cc46c0252bfbbd338780b1a4577eb29a1c28a8bcf6820012feeb8f1a0d0d5c46f79d5b0a81282d2767187abfabe38574e079ce41dfcd8c08e3cbe52c3eb21b77914fffd10cd40d107ed2667b593302e7a01173e8f32f9a01b4d57a4e4b85661aefe0446f27689ad39a0f420a7fbd3ca671535b43a488472d83a4c28363c74f831ce1d8bdb4972fe7289951cdf445671cec3d082c78a5407b4ffb36e6cb6719447d723f41cbd54bed853ba714ed56584bed113b05640d55fd94e3a4d2f063222aedeaff8016b97dae0377c43bc158dbd539932f81b02e758e66b6bdef37c23c23897c47ac8c095a701f882f0c9c14b8223a9daee7473ff5279da9932b4c1181ef3166045aa5eb1b53e6cff25d39d8f76a0f680c1a6296e220ea09ea8812437f5e535b5bba9c9a1ac0a0cdfc29f850387514e9bda90be2621ee825a28b279cda5468bae9361e1cc972236856907ae234d84048f6d5095ba20edaedc0140b7fb985a85831ccb901024a935af1849a671140e47765fe70155ca2563a61a6c12915dda702f63bdcbea4bc838123f4be489870fe4f5b7b2f2d1d5ea6a0b0bdf6420595b56ffead54006c0e272aa32d45d7fe1ad79bf5bcbca158c4a780cb34b9141bf3ae05fa6457da8c5fc1dcb7eea8f73a89d6036b532be45b7d3d651cc4c9ae1ea7d00aa4f19790290f63b779eee0b260d6ce1715c335b90ecfb8565027becb0907d3e4dd0d63013273b4737afb0474a1d84eac8f85018e5e8031e228ce77421f85aad4f1921a24b75609d0025c548542b9ac5341a79f62def48944caef59e63a7f40fe4558adf739c5048aa7491e83b75e86cf3d0d7354f22b377c3a47ad16667b8c3c9796cf40ecbd04e8d55739e8bcd53f934d8bbbea3c05035eccc1103c8f65631384ce34a254aac468664675ea56758b66d1767dec68fa484976bdda05d83eddd7ac9c3955c670998b3807c6ab396a22fd77233d247abc39264930beccd6ebd64a49e9a1cdcf40f1c354804f36b85713862d38849899a1a58c9657742abf00d593af21ef2ee068481035e81272185caf6bf0eb1fa748056c6345ab30f86c4b198deef51592ebf668257dae23adf5a717b6e7b992e6b98858361fdf611cca3cc5fc891959a9e693ae7eecb0b1ede281e6c441331cdd8b711bd06075d9dde0d2a2440e2b146c49f6ffe22e54f522cb8b7a9a8b149ccb6130a8cf2e98a8db8503684e77f3ec283183c8cf2d301cc773957568d11e74944e8b76ed079f2172068d0ad41f30928585374513b788fb902dc4d5875c493e382eac91395d5793a25d0faccd8ccb025589749c744401ec2c695e779efaa32ff95d10a093906890c687825b2bdbe662c4957c98a85a5718d75fc90376d301b619916d770025c84b1bfeccfffb7f6280e55d18c3cb641496f15f700b08d54424c6d8198b181cfbdfbc6273731a36edb35b33545dee6396cb50d264a7a5ad2a535a8ccf50c6b76e75946eafe8848dd4660c266d49d0629988dcac4916dc6223a039b2f2117e2ea29015ddca65c28935dbe57769620701c2bf37b631dc64f9eb98b5973d2aa9c953ebd076745cd5171b13753c82b4f7ff66d9e8ebd7e8cf0b0c194ef8a193fedde5418baf836dec513f630080eff2c4e5629fbbe6ce1f69ab9a76f003dbb390b6e248999c4e470f49c9e63832e05feeff54bc3f153451d16fa79ec3873f1479c60e1e3d025cc03519e8a439d6c82d48d3f8778422e1f2fc7aea3755deff7b6939e604f652e3d21bf86cad04530476d5d7bb39454b38724f066a3b5d07f80cde579183eae68b85e5b4eec0494aaf956174d4a3b9c9c33d06948ccaa57a408256b66b9041c2093ef3c880af26dfe829354c6e6d9dfc1e1f8b53a62cb457875a7f7684be7f73284e5837f0448416c685d41d11011894d695fbf0bdd3198605fb9855468141f36ea5654d00dfa68135dd4d11df8ace3623c17c62dbc1cc871791de661161b70b549d6a94ed1e1cb60d1abf138fe614994c72632e4997188678788065407f6573cfa6da6b0dee2e356144057de63a98afb662306d93304f61cf34dcfe4ff6903cbf964d91c41f2567aa2b09aaccdbaebcc6e93a56bc9d7f317c1ffba76072570de2ce6208378ac23c37d05be4f74e9c8deb009193fe3e19d5cbd3f540d83bfdecbcfec5bbc1c89ca4bfa9cc0aa7efd4e994f10d1a5a743b639b4ba83895acd9fb770a9213ab06678c710f3e5671c780d43574c5cba5a5c2d2094772a86850e13eed8a55ef7a8cf62bd5b31dd57f4d81bee67ba1f0438f201de2a671fb7beeb195e87d7fad51b5aed4e71d77ad014c5107d3f9e3bf8cbc1f5cb71c2a4e0a68981181d1fbbcd5efe00bd5f32df64c71a41b447afd18628f1604e7c807d7a95f43d3980aced6f45b83701f3a0f7656b80e87815b9d86e7659192a11d162d49f168b64d9b53b442c8845745c84fbba003e140602f2fb83025359c7cbfd9a932a40abc29f8386000765216b20e1016be16438032bc272196cfca196d1eeb125a1f7fa6545df5a8c5bbdc3806104bb331f41e71cd73f3541d42dff780ebbac525b453d1a76624be8d502727c0465c4f18cdb7b067c8d7be906da3c7258c837e4e2f1c08dffb5694ba54b162b9f04afe36d3763fe9c120dc56db42153c7bcef393a962a1c198779d0e851b3e8c35eb3972de1b7700e46060fa8ffe1fddc69ec3ac94a9eed2a84a3b3effb2d5a1215a5883250b08398a2ab4c95c87548d3cf8717e09073ed4d89963af296155c22b56c43d8bd785af202b1043f94a1dc148c89112659f2c14fe649b232456368030c61abab65848dfbfae778d0141a52933321e3201a243aa5acffbbe8111514a9f13dd631880489bf7b292f31cd5991a4d8b5421a51a97c240a278b0323b10bbe183819ede770bd23405f922db83df8cfb68b41c70ced80f6ca14277b495342cb2354525dbd61b6ebf1b92b7612ad3831f2f62a1298314b37b9208d69e7376ba5b12d048d2e5d21c1e01671c333644b3d6dbc499c76356fb57049836ba1806c98dd7ca90b4cdaeabcbe87ed90915cdb358016ee6ab3184698c262c26121c5f268c7385e57337173fb503a8655ee0693fa51b6044af3455094c2e31ccba1fc4b863198253d135831baf6eabdff7cb08792136b25af989024cdcb5ceda47636569378ec3349a9224b6a0b61a75f40a37e8ff6434c5f38cba1d73fbaaeb1a5253ea05f121dea3355bf9e5625f03506304cc78542ea203ebaf4761db5afbf20d57592e1fb46419af7469606dbc9ca3fcc5cd7229aa47f35ae39e720fcf510433c0a7d20197a5e682a58674b569c278fcba380b47177ce29913a9641f365a8ceb544886ed559bd54fc1080199aab57c7134ba21dac426938eecee222860a8ae7e0ddf592d93b3a8ba52db989c0b80f4b9c503e1faacdf9afe84e2c4acc5a5b3712d3e99e6ba7fa980429074fbdcf0d1a9c83eda543ef9a29c07b2fe4ba2578f9d59bf5856f41247b2c26b405493f14a17aae8d9cfb173d37d8625dfcf6b237765a04d3b82e1df98ce3e1c36d963aa64c9945c4dfb4b83e90713312bad2475f0b1fdad65de531930cbceadab01d64c7b609877f107b84b7497e9840c55992bf5e15190518ae9435ae60c58e8300de02ca2738f7cd7d0faa4bbd56ef23ab5da3c63eacfe5d0249c6d02b4251d0e1153fdac9a37c680e446a4ede8568541ec8643290af0546504f01cf2307c53d66f56650950178e0ffd316a292671690348a4bfe62362b222515fe7484db736624c81a38ff0fac811d594dcfa6598a427de50c5a6fed1854e6fc9cd5ef9d890d73dbd9c9fcdefe239ea754ca2ef11d5e27e34340a383956c805908796d3efbb2bb013e8806e2134313d20f6501da6f95465a25c90e80472ffd87a8c7f32cca3360515739906d8da0381a3e9602fb33084f67bdb4b001bb0991b5783b808491ef31fd3a735a9f4c2a04a122efe469d6bf5906d6b77669ecfd1ca907f693d4bc9d83dd0992c667b264f6d042a10f43877926765727043d36f8b61933d58ec89f374ad8f73814e7c8b48261a72b4cd3a29776dfe65af651eea1a8491a9b5e0235dfe60846db4926a4ae4bfd7103752eb032810086bd8689668ff55a795e0f4c854224ef47d86109bfa03b33a0806d052afb6413701c2f7d72df9d7d55e3f42a20c8e4cfdb29881b8b08d393e02b84a7d62cae3ae45421a61e1e71d9a059a0afa71b09d01d471e3dd3a2e2e3f6447b74b1193bf3d0b80829b702bcf2f8323667224527524f0d4b32df13ae1b2df554a8f79b687eaad1d125b5c768f7cd97125d337219f07d9b3648a43b9cb79836151c70a7b3f998ab259a92a14884e586b4d192bfdebbcad8794c907b4679d40210efca9cfcf8875f2df416dc3f9fac7dfce191c5b0ae200a48a6ea3969ba2d765917df648e416c19256c1142638757c4bbc62b4f6c77478416a107333c6fae29cd67cf643116ab99d7af97c3956658b9540d3892f4d676ca1519762242db4ced81591b4e434eea35b4f87f075c474438cbae348f7fe07bfdb71cbfe6977a5eef08a7576e570a9eb8a878b97aab81a7a2b5d2dc9bb7eeb21c85a910cc667d6d97e4940eb49d324166caa16c0bdf725b4bf4e8d66b788ba3c3f165f473ff76adf66f78baf951e843e71d3f55e913b9b467ea0f76df185155e3ffd99ac0a856852d4732caa23cc2f441ba0f8e7a773a649e0d40f95e841ef93479036d44c781a87554992688cbb86e895d4f0c2d20d7ff1da5b58083a91d034bc54558c933f8d1ca95a8a69fc5c372231f57c0eec07c739e26ba29aaf33210138118dfc4b163aa7a93ee55d380a22e548ae03d52c9901768791c17ccc37fb3e7964fb1355ec5a632f83157ed191bc6542f25178187930569f4443896e5d166ae270d3bb3cd5e8ff7c9e9f84b4dcb5c443d1cbaf173817247ac1f055d0d74cbf429d8b2572eb8635728838c4099d2821bf5e8fdb97e42d079c1acbbd631cb6cdbc87c3c63bb202b8743f2338eb8ac89e41a5c4e4c7ba0551af7df940830312ea04967f723faad2525e67ff61f033c380cbe443d9ee4a3762772829c7fc035466e5a045edbe29d9d5cdd0ac525855d55f5f763e9d44dfb5019d940f2ebbd64063ca14b6e35c8a3fa354412adce8ef3acb1955c7ee4d2e3703f0717fe1bd42dd0cf752d4de1044e612c131bffdc2b1449575</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>å…«è‚¡æ–‡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>javaé”å¸¸è§é¢è¯•é¢˜</title>
    <link href="/java%E9%94%81%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/java%E9%94%81%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-sychronized"><a href="#1-sychronized" class="headerlink" title="1. sychronized"></a>1. sychronized</h1><p>Synchronizedæ˜¯Javaä¸­è§£å†³å¹¶å‘é—®é¢˜çš„ä¸€ç§æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼ŒSynchronizedçš„ä½œç”¨ä¸»è¦æœ‰ä¸‰ä¸ªï¼š</p><ul><li><strong>ç¡®ä¿äº’æ–¥è®¿é—®</strong>ã€‚ç¡®ä¿è¢«åŒæ­¥çš„æ–¹æ³•æˆ–ä»£ç å—åœ¨åŒä¸€æ—¶åˆ»åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œå…¶ä»–çº¿ç¨‹å¿…é¡»ç­‰å¾…è¯¥çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åæ‰èƒ½è¿›å…¥ã€‚</li><li><strong>ä¿è¯å¯è§æ€§</strong>ã€‚ä¿è¯çº¿ç¨‹é—´å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹æ˜¯å¯è§çš„ã€‚å…·ä½“æ¥è¯´ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼åï¼Œ<code>synchronized</code> å…³é”®å­—ç¡®ä¿å…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³çœ‹åˆ°è¿™ä¸ªä¿®æ”¹ã€‚</li><li><strong>é˜²æ­¢æŒ‡ä»¤é‡æ’åº</strong>ã€‚æŒ‡ä»¤é‡æ’åºæ˜¯ä¸€ç§ä¼˜åŒ–æŠ€æœ¯ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯èƒ½ä¼šé‡æ–°æ’åˆ—æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºï¼Œä»¥æé«˜æ€§èƒ½ã€‚ä½†æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼ŒæŒ‡ä»¤é‡æ’åºå¯èƒ½ä¼šå¯¼è‡´çº¿ç¨‹é—´çš„æ‰§è¡Œé¡ºåºå’Œé¢„æœŸçš„ä¸ä¸€è‡´ã€‚<code>synchronized</code> é€šè¿‡å†…å­˜å±éšœï¼ˆMemory Barrierï¼‰æœºåˆ¶ï¼Œç¡®ä¿åœ¨è¿›å…¥å’Œé€€å‡ºåŒæ­¥å—æ—¶ï¼Œå†…å­˜çš„è¯»å†™æ“ä½œä¸ä¼šè¢«é‡æ’åºã€‚</li></ul><h2 id="1-åº”ç”¨æ–¹å¼"><a href="#1-åº”ç”¨æ–¹å¼" class="headerlink" title="1. åº”ç”¨æ–¹å¼"></a>1. åº”ç”¨æ–¹å¼</h2><p>synchronizedå…³é”®å­—æœ€ä¸»è¦æœ‰ä»¥ä¸‹3ç§åº”ç”¨æ–¹å¼ï¼Œä¸‹é¢åˆ†åˆ«ä»‹ç»</p><p>1.ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼Œä½œç”¨äºå½“å‰å®ä¾‹åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å‰è¦è·å¾—å½“å‰å®ä¾‹çš„é”</p><p>2.ä¿®é¥°é™æ€æ–¹æ³•ï¼Œä½œç”¨äºå½“å‰ç±»å¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å‰è¦è·å¾—å½“å‰ç±»å¯¹è±¡çš„é”</p><p>3.ä¿®é¥°ä»£ç å—ï¼ŒæŒ‡å®šåŠ é”å¯¹è±¡ï¼Œå¯¹ç»™å®šå¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç åº“å‰è¦è·å¾—ç»™å®šå¯¹è±¡çš„é”ã€‚</p><h2 id="2-å®ç°åŸç†"><a href="#2-å®ç°åŸç†" class="headerlink" title="2. å®ç°åŸç†"></a>2. å®ç°åŸç†</h2><p>åŸºäºå¯¹è±¡é”ï¼ˆmonitorï¼‰æœºåˆ¶ã€‚ç¼–è¯‘ç”¨sychronizedä¿®é¥°çš„åŒæ­¥ä»£ç å—ï¼Œå†ç”¨javap -væŸ¥çœ‹å­—èŠ‚ç æ–‡ä»¶ï¼šæ‰§è¡ŒåŒæ­¥ä»£ç å—åé¦–å…ˆè¦å…ˆæ‰§è¡ŒmonitorenteræŒ‡ä»¤ï¼Œé€€å‡ºçš„æ—¶å€™monitorexitæŒ‡ä»¤ã€‚ä½¿ç”¨Synchronizedè¿›è¡ŒåŒæ­¥ï¼Œå…¶å…³é”®å°±æ˜¯å¿…é¡»è¦å¯¹å¯¹è±¡çš„ç›‘è§†å™¨monitorè¿›è¡Œè·å–ï¼Œå½“çº¿ç¨‹è·å–monitoråæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œå¦åˆ™å°±åªèƒ½ç­‰å¾…ã€‚è€Œè¿™ä¸ªè·å–çš„è¿‡ç¨‹æ˜¯äº’æ–¥çš„ï¼Œå³åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè·å–åˆ°monitorã€‚æ¯ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå½“çº¿ç¨‹è·å–è¯¥å¯¹è±¡é”åï¼Œè®¡æ•°å™¨å°±ä¼šåŠ ä¸€ï¼Œé‡Šæ”¾é”åå°±ä¼šå°†è®¡æ•°å™¨å‡ä¸€ã€‚</p><h2 id="3-Javaè™šæ‹Ÿæœºå¯¹synchronizedçš„ä¼˜åŒ–"><a href="#3-Javaè™šæ‹Ÿæœºå¯¹synchronizedçš„ä¼˜åŒ–" class="headerlink" title="3. Javaè™šæ‹Ÿæœºå¯¹synchronizedçš„ä¼˜åŒ–"></a>3. Javaè™šæ‹Ÿæœºå¯¹synchronizedçš„ä¼˜åŒ–</h2><p>Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰å¯¹<code>synchronized</code>å…³é”®å­—è¿›è¡Œäº†å¤šç§ä¼˜åŒ–ï¼Œæ—¨åœ¨æé«˜å¹¶å‘æ€§èƒ½å’Œå‡å°‘çº¿ç¨‹é˜»å¡çš„å¼€é”€ã€‚</p><ol><li>åå‘é”ï¼ˆBiased Lockingï¼‰ï¼šå½“ä¸€ä¸ªçº¿ç¨‹è·å–å¯¹è±¡çš„é”æ—¶ï¼ŒJVMä¼šå°†å¯¹è±¡æ ‡è®°ä¸ºåå‘é”ã€‚è¿™æ ·ï¼Œåœ¨åç»­çš„è®¿é—®ä¸­ï¼Œè¯¥çº¿ç¨‹å¯ä»¥æ— éœ€ç«äº‰é”è€Œç›´æ¥è·å–èµ„æºï¼Œé¿å…äº†ä¸å¿…è¦çš„é”ç«äº‰ï¼Œæé«˜äº†å•çº¿ç¨‹åœºæ™¯ä¸‹çš„æ€§èƒ½ã€‚</li><li>è½»é‡çº§é”ï¼ˆLightweight Lockingï¼‰ï¼šå½“å¤šä¸ªçº¿ç¨‹ç«äº‰åŒä¸€ä¸ªå¯¹è±¡çš„é”æ—¶ï¼ŒJVMä¼šå°†é”ä»åå‘é”å‡çº§ä¸ºè½»é‡çº§é”ã€‚åœ¨è½»é‡çº§é”çŠ¶æ€ä¸‹ï¼ŒJVMä¼šä½¿ç”¨CASï¼ˆCompare and Swapï¼‰æ“ä½œæ¥å®ç°å¯¹é”çš„è·å–å’Œé‡Šæ”¾ï¼Œé¿å…äº†çº¿ç¨‹é˜»å¡å’Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ã€‚</li><li>è‡ªæ—‹é”ï¼ˆSpin Lockingï¼‰ï¼šå½“çº¿ç¨‹å°è¯•è·å–è½»é‡çº§é”æ—¶ï¼Œå¦‚æœå‘ç°é”è¢«å…¶ä»–çº¿ç¨‹å ç”¨ï¼Œå®ƒä¸ä¼šç«‹å³é˜»å¡ï¼Œè€Œæ˜¯è¿›è¡Œä¸€å®šæ¬¡æ•°çš„è‡ªæ—‹å°è¯•è·å–é”ã€‚è‡ªæ—‹é”å¯ä»¥å‡å°‘çº¿ç¨‹é˜»å¡å’Œæ¢å¤çš„å¼€é”€ï¼Œé€‚ç”¨äºé”å ç”¨æ—¶é—´çŸ­æš‚çš„æƒ…å†µã€‚</li><li>é”æ¶ˆé™¤ï¼ˆLock Eliminationï¼‰ï¼šJVMä¼šé€šè¿‡é€ƒé€¸åˆ†ææŠ€æœ¯åˆ†æä»£ç ï¼Œåˆ¤æ–­æŸäº›å¯¹è±¡çš„é”å¹¶ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹è®¿é—®ï¼Œä»è€Œå¯ä»¥å®‰å…¨åœ°æ¶ˆé™¤å¯¹è¿™äº›é”çš„ä½¿ç”¨ã€‚è¿™æ ·å¯ä»¥é¿å…ä¸å¿…è¦çš„é”ç«äº‰ï¼Œæé«˜å¹¶å‘æ€§èƒ½ã€‚</li><li>é”ç²—åŒ–ï¼ˆLock Coarseningï¼‰ï¼šJVMä¼šå°†å¤šä¸ªè¿ç»­çš„é”æ“ä½œåˆå¹¶ä¸ºä¸€ä¸ªè¾ƒå¤§çš„é”æ“ä½œï¼Œå‡å°‘é”çš„è·å–å’Œé‡Šæ”¾æ¬¡æ•°ã€‚è¿™æ ·å¯ä»¥å‡å°‘é”ç«äº‰å’Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼Œæé«˜å¹¶å‘æ€§èƒ½ã€‚</li></ol><h2 id="4-synchronized-é”å‡çº§çš„é¡ºåº"><a href="#4-synchronized-é”å‡çº§çš„é¡ºåº" class="headerlink" title="4. synchronized é”å‡çº§çš„é¡ºåº"></a>4. synchronized é”å‡çº§çš„é¡ºåº</h2><p>åœ¨ Java è™šæ‹Ÿæœº (JVM) ä¸­ï¼Œé”çš„å‡çº§æ˜¯æŒ‡åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå½“çº¿ç¨‹è®¿é—®å…±äº«èµ„æºæ—¶ï¼Œé”çš„çŠ¶æ€ä»æ— é”åˆ°åå‘é”ï¼Œå†åˆ°è½»é‡çº§é”ï¼Œæœ€åå¯èƒ½å‡çº§ä¸ºé‡é‡çº§é”çš„è¿‡ç¨‹ã€‚</p><ol><li>æ— é”çŠ¶æ€ï¼ˆUnlockedï¼‰ï¼šå½“æ²¡æœ‰çº¿ç¨‹è®¿é—®å…±äº«èµ„æºæ—¶ï¼Œè¯¥çŠ¶æ€ä¸ºæ— é”çŠ¶æ€ã€‚</li><li>åå‘é”çŠ¶æ€ï¼ˆBiased Lockingï¼‰ï¼šå½“åªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®å…±äº«èµ„æºæ—¶ï¼ŒJVM ä¼šåå‘äºè¯¥çº¿ç¨‹ï¼Œå°†å¯¹è±¡çš„æ ‡è®°è®¾ç½®ä¸ºåå‘é”çŠ¶æ€ã€‚è¿™æ ·ï¼Œåœ¨åç»­çš„è®¿é—®ä¸­ï¼Œè¯¥çº¿ç¨‹å¯ä»¥æ— éœ€ç«äº‰é”è€Œç›´æ¥è·å–èµ„æºï¼Œæé«˜äº†æ€§èƒ½ã€‚</li><li>è½»é‡çº§é”çŠ¶æ€ï¼ˆLightweight Lockingï¼‰ï¼šå½“å¤šä¸ªçº¿ç¨‹ç«äº‰åŒä¸€ä¸ªåå‘é”æ—¶ï¼Œåå‘é”ä¼šå‡çº§ä¸ºè½»é‡çº§é”ã€‚åœ¨è½»é‡çº§é”çŠ¶æ€ä¸‹ï¼ŒJVM ä¼šå°è¯•ä½¿ç”¨ CASï¼ˆCompare and Swapï¼‰æ“ä½œæ¥å®ç°å¯¹é”çš„è·å–å’Œé‡Šæ”¾ï¼Œé¿å…äº†çº¿ç¨‹é˜»å¡ã€‚å¦‚æœ CAS æ“ä½œæˆåŠŸï¼Œçº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œä¸´ç•ŒåŒºä»£ç ã€‚å¦‚æœ CAS æ“ä½œå¤±è´¥ï¼Œè¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹ç«äº‰é”ï¼Œé‚£ä¹ˆé”ä¼šå‡çº§ä¸ºé‡é‡çº§é”ã€‚</li><li>é‡é‡çº§é”çŠ¶æ€ï¼ˆHeavyweight Lockingï¼‰ï¼šå½“è½»é‡çº§é”æ— æ³•æ»¡è¶³çº¿ç¨‹ç«äº‰çš„éœ€æ±‚æ—¶ï¼ŒJVM ä¼šå°†é”å‡çº§ä¸ºé‡é‡çº§é”ã€‚åœ¨é‡é‡çº§é”çŠ¶æ€ä¸‹ï¼Œçº¿ç¨‹åœ¨è·å–é”æ—¶ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå¯èƒ½ä¼šå¯¼è‡´çº¿ç¨‹åˆ‡æ¢å’Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€å¢åŠ ã€‚</li></ol><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20240703102856049.png" alt="image-20240703102856049" style="zoom:50%;" /><h2 id="4-Lockå’ŒsynchronizedåŒºåˆ«"><a href="#4-Lockå’ŒsynchronizedåŒºåˆ«" class="headerlink" title="4. Lockå’ŒsynchronizedåŒºåˆ«"></a>4. Lockå’ŒsynchronizedåŒºåˆ«</h2><ol><li><p>Lockæ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€Œsynchronizedæ˜¯Javaä¸­çš„å…³é”®å­—,synchronizedæ˜¯å†…ç½®çš„è¯­è¨€å®ç°ï¼Œ lockæ˜¯é€šè¿‡ä»£ç å®ç°çš„.</p></li><li><p>synchronizedåœ¨å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¼šè‡ªåŠ¨é‡Šæ”¾çº¿ç¨‹å æœ‰çš„é”ï¼Œå› æ­¤ä¸ä¼šå¯¼è‡´æ­»é”ç°è±¡å‘ç”Ÿï¼›è€ŒLockåœ¨å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¦‚æœæ²¡æœ‰ä¸»åŠ¨é€šè¿‡unLock()å»é‡Šæ”¾é”ï¼Œåˆ™å¾ˆå¯èƒ½é€ æˆæ­»é”ç°è±¡ï¼Œå› æ­¤ä½¿ç”¨Lockæ—¶éœ€è¦åœ¨finallyå—ä¸­é‡Šæ”¾é”ï¼›</p></li><li><p>é€šè¿‡Lockå¯ä»¥çŸ¥é“æœ‰æ²¡æœ‰æˆåŠŸè·å–é”ï¼Œè€Œsynchronizedå´æ— æ³•åŠåˆ°ã€‚</p></li><li><p>Lockå¯ä»¥æé«˜å¤šä¸ªçº¿ç¨‹è¿›è¡Œè¯»æ“ä½œçš„æ•ˆç‡ã€‚</p></li><li><p>Lockå¯ä»¥è®©ç­‰å¾…é”çš„çº¿ç¨‹å“åº”ä¸­æ–­ï¼Œçº¿ç¨‹å¯ä»¥ä¸­æ–­å»å¹²åˆ«çš„äº‹åŠ¡ï¼Œè€Œsynchronizedå´ä¸è¡Œï¼Œä½¿ç”¨synchronizedæ—¶ï¼Œç­‰å¾…çš„çº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…ä¸‹å»ï¼Œä¸èƒ½å¤Ÿå“åº”ä¸­æ–­ï¼›</p><p><strong>åœ¨æ€§èƒ½ä¸Šæ¥è¯´ï¼Œå¦‚æœç«äº‰èµ„æºä¸æ¿€çƒˆï¼Œä¸¤è€…çš„æ€§èƒ½æ˜¯å·®ä¸å¤šçš„ï¼Œè€Œå½“ç«äº‰èµ„æºéå¸¸æ¿€çƒˆæ—¶ï¼ˆå³æœ‰å¤§é‡çº¿ç¨‹åŒæ—¶ç«äº‰ï¼‰ï¼Œæ­¤æ—¶Lockçš„æ€§èƒ½è¦è¿œè¿œä¼˜äºsynchronizedã€‚æ‰€ä»¥è¯´ï¼Œåœ¨å…·ä½“ä½¿ç”¨æ—¶è¦æ ¹æ®é€‚å½“æƒ…å†µé€‰æ‹©ã€‚</strong></p></li></ol><h1 id="2-AQS"><a href="#2-AQS" class="headerlink" title="2. AQS"></a>2. AQS</h1><h2 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a>1 æ¦‚å¿µ</h2><p>AQSï¼Œå…¨ç§°ä¸º <strong>AbstractQueuedSynchronizer</strong>ï¼Œæ˜¯ Java ä¸­æä¾›çš„ä¸€ç§å®ç°åŒæ­¥å™¨çš„æ¡†æ¶ã€‚å®ƒæ˜¯ <code>java.util.concurrent.locks</code> åŒ…çš„ä¸€éƒ¨åˆ†ã€‚å…¶æ ¸å¿ƒæ˜¯ç»´æŠ¤ä¸€ä¸ªåŒæ­¥çŠ¶æ€ <code>state</code> ä»¥åŠä¸€ä¸ª FIFO ç­‰å¾…é˜Ÿåˆ—ã€‚å®ƒæä¾›äº†å¤šç§æ–¹æ³•æ¥æ“çºµåŒæ­¥çŠ¶æ€ï¼Œå¹¶ç®¡ç†è¿›å…¥ç­‰å¾…é˜Ÿåˆ—çš„çº¿ç¨‹ã€‚</p><h4 id="åŒæ­¥çŠ¶æ€"><a href="#åŒæ­¥çŠ¶æ€" class="headerlink" title="åŒæ­¥çŠ¶æ€"></a>åŒæ­¥çŠ¶æ€</h4><p>åŒæ­¥çŠ¶æ€æ˜¯ä¸€ä¸ª <code>int</code> ç±»å‹çš„å˜é‡ï¼Œé€šå¸¸ç”¨äºè¡¨ç¤ºèµ„æºçš„å¯ç”¨æ€§ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç‹¬å é”ä¸­ï¼Œ<code>state</code> ä¸º 0 è¡¨ç¤ºé”æ˜¯å¯ç”¨çš„ï¼Œ1 è¡¨ç¤ºé”å·²è¢«æŒæœ‰ã€‚</p><h4 id="ç­‰å¾…é˜Ÿåˆ—"><a href="#ç­‰å¾…é˜Ÿåˆ—" class="headerlink" title="ç­‰å¾…é˜Ÿåˆ—"></a>ç­‰å¾…é˜Ÿåˆ—</h4><p>å½“ä¸€ä¸ªçº¿ç¨‹å°è¯•è·å–é”ä½†å¤±è´¥æ—¶ï¼Œå®ƒä¼šè¢«åŠ å…¥åˆ° AQS çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚è¿™ä¸ªç­‰å¾…é˜Ÿåˆ—æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œæ‰€æœ‰å°è¯•è·å–é”çš„çº¿ç¨‹éƒ½æ’æˆé˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’å¹¶å†æ¬¡å°è¯•è·å–é”ã€‚</p><h2 id="2-ä½¿ç”¨"><a href="#2-ä½¿ç”¨" class="headerlink" title="2. ä½¿ç”¨"></a>2. ä½¿ç”¨</h2><p>AQS é€šå¸¸ä¸ä¼šç›´æ¥ä½¿ç”¨ï¼Œè€Œæ˜¯é€šè¿‡å­ç±»å®ç°å…·ä½“çš„åŒæ­¥å™¨ï¼Œå¦‚ <code>ReentrantLock</code>ã€<code>CountDownLatch</code>ã€<code>Semaphore</code> ç­‰ã€‚</p><h1 id="3-ReentrantLock"><a href="#3-ReentrantLock" class="headerlink" title="3.  ReentrantLock"></a>3.  ReentrantLock</h1><h2 id="1-å…¬å¹³é”çš„åŠ é”å®ç°ï¼š"><a href="#1-å…¬å¹³é”çš„åŠ é”å®ç°ï¼š" class="headerlink" title="1. å…¬å¹³é”çš„åŠ é”å®ç°ï¼š"></a>1. å…¬å¹³é”çš„åŠ é”å®ç°ï¼š</h2><p>å…¬å¹³é”ä¿è¯çº¿ç¨‹æŒ‰ç…§è¯·æ±‚é”çš„é¡ºåºæ¥è·å–é”.</p><p>1.åŠ é”æ—¶ä¼šè°ƒç”¨lock()æ–¹æ³•å»è·å–é”ï¼Œlock()ä¼šè°ƒç”¨ç”¨acquire()(AQSä¸­)ï¼Œè€Œè¿™ä¸ªacquireæ–¹æ³•å†…éƒ¨åˆå»è°ƒç”¨äº†tryAcquireçš„æ–¹æ³•</p><ol><li><p>tryAcquireæ–¹æ³•é€šè¿‡getStateè·å–å½“å‰åŒæ­¥çŠ¶æ€</p><ul><li><p>å‘ç°stateä¸º0ã€‚</p><ol><li><strong>åˆ¤æ–­æ˜¯å¦æœ‰æ¯”å½“å‰çº¿ç¨‹ç­‰å¾…æ—¶é—´æ›´é•¿çš„çº¿ç¨‹</strong>ã€‚å¦‚æœæœ‰ï¼Œå½“å‰çº¿ç¨‹å°†ç­‰å¾…ã€‚</li><li>æ²¡æœ‰çš„è¯ï¼Œä½¿ç”¨åŸå­æ“ä½œå°è¯•å°†é”çš„çŠ¶æ€ä» 0 æ”¹ä¸º 1ï¼Œè¡¨ç¤ºè·å–é”æˆåŠŸï¼Œè®¾ç½®é”çš„æ‹¥æœ‰è€…ä¸ºå½“å‰çº¿ç¨‹ï¼Œ è·å–æˆåŠŸï¼Œ</li></ol></li><li><p>ä¸ä¸º0ï¼Œæ£€æŸ¥å½“å‰çº¿ç¨‹æ˜¯å¦å·²ç»æŒæœ‰é”ï¼Œåˆ¤æ–­é‡å…¥é”çš„é€»è¾‘ã€‚</p><ol><li>æ˜¯é‡å…¥é”çš„è¯ï¼Œå¢åŠ é‡å…¥æ¬¡æ•°ï¼Œ ä¹Ÿæ˜¯è·å–æˆåŠŸï¼Œ</li></ol></li></ul></li><li><p>è·å–å¤±è´¥æ—¶ï¼Œè°ƒç”¨ <code>addWaiter</code> å°†å½“å‰çº¿ç¨‹åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚å°è¯•é€šè¿‡CASæŠŠå½“å‰ç°åœ¨è¿½åŠ åˆ°é˜Ÿå°¾ï¼Œä¿®æ”¹ä¸ºèŠ‚ç‚¹ä¸ºæœ€æ–°çš„èŠ‚ç‚¹ï¼Œå¦‚æœä¿®æ”¹å¤±è´¥ï¼Œæ„å‘³ç€æœ‰å¹¶å‘ï¼Œè¿™ä¸ªæ—¶å€™è¿›å…¥enqä¸­çš„æ­»å¾ªç¯ï¼Œè¿›è¡Œâ€œè‡ªæ—‹â€çš„æ–¹å¼ä¿®æ”¹</p></li></ol><h2 id="2-å…¬å¹³é”çš„é‡Šæ”¾é”å®ç°ï¼š"><a href="#2-å…¬å¹³é”çš„é‡Šæ”¾é”å®ç°ï¼š" class="headerlink" title="2. å…¬å¹³é”çš„é‡Šæ”¾é”å®ç°ï¼š"></a>2. å…¬å¹³é”çš„é‡Šæ”¾é”å®ç°ï¼š</h2><ol><li><p>å¤´èŠ‚ç‚¹åœ¨é‡Šæ”¾åŒæ­¥çŠ¶æ€çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨unlockï¼ˆï¼‰ï¼Œè€Œunlockä¼šè°ƒç”¨release()ï¼Œrelease()ä¼šè°ƒç”¨tryReleaseæ–¹æ³•å°è¯•é‡Šæ”¾å½“å‰çº¿ç¨‹æŒæœ‰çš„é”,å…ˆåˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦ä¸ºæŒæœ‰é”çš„çº¿ç¨‹ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ‰§è¡Œå‡å‡æ“ä½œï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼ˆåŒæ­¥çŠ¶æ€ï¼‰</p></li><li><p>æˆåŠŸçš„è¯è°ƒç”¨unparkSuccessor() å”¤é†’åç»§çº¿ç¨‹ï¼Œå¹¶è¿”å›trueï¼Œå¦åˆ™ç›´æ¥è¿”å›falseï¼Œ</p><p>æ³¨æ„ï¼š</p><ul><li>åªæœ‰çº¿ç¨‹AæŠŠæ­¤é”å…¨éƒ¨é‡Šæ”¾äº†ï¼ŒçŠ¶æ€å€¼å‡åˆ°0äº†ï¼Œå…¶ä»–çº¿ç¨‹æ‰æœ‰æœºä¼šè·å–é”ï¼Œå½“AæŠŠé”å®Œå…¨é‡Šæ”¾åï¼Œstateæ¢å¤ä¸º0</li><li>é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹åœ¨è¢«å”¤é†’ä¹‹å‰éƒ½å¤„äºé˜»å¡çŠ¶æ€ã€‚å½“ä¸€ä¸ªçº¿ç¨‹èŠ‚ç‚¹è¢«å”¤é†’ç„¶åå–å¾—äº†é”ï¼Œå¯¹åº”èŠ‚ç‚¹ä¼šä»é˜Ÿåˆ—ä¸­åˆ é™¤</li></ul></li></ol><h2 id="3-éå…¬å¹³é”çš„åŠ é”å®ç°ï¼š"><a href="#3-éå…¬å¹³é”çš„åŠ é”å®ç°ï¼š" class="headerlink" title="3. éå…¬å¹³é”çš„åŠ é”å®ç°ï¼š"></a>3. éå…¬å¹³é”çš„åŠ é”å®ç°ï¼š</h2><ul><li>éå…¬å¹³é”åœ¨å°è¯•è·å–é”æ—¶ï¼Œæ˜¯å…ˆç›´æ¥ CAS è®¾ç½® state å˜é‡ï¼Œå¦‚æœè®¾ç½®æˆåŠŸï¼Œè¡¨æ˜åŠ é”æˆåŠŸï¼Œå½“å‰çº¿ç¨‹å°±æˆä¸ºäº†é”çš„æŒæœ‰è€…ã€‚</li><li>æŠ¢å å¤±è´¥,å†è°ƒç”¨ acquire æ–¹æ³•å°†çº¿ç¨‹ç½®äºé˜Ÿåˆ—å°¾éƒ¨æ’é˜Ÿã€‚</li></ul><blockquote><p>éå…¬å¹³é”çš„æœºåˆ¶ï¼šå¦‚æœæ–°æ¥äº†ä¸€ä¸ªçº¿ç¨‹ï¼Œè¯•å›¾è®¿é—®ä¸€ä¸ªåŒæ­¥èµ„æºï¼Œåªéœ€è¦ç¡®è®¤å½“å‰æ²¡æœ‰å…¶ä»–çº¿ç¨‹æŒæœ‰è¿™ä¸ªåŒæ­¥çŠ¶æ€ï¼Œå³å¯è·å–åˆ°ã€‚</p></blockquote><p>è¿™ä¸ªåŒºåˆ«å¾ˆé‡è¦ï¼Œå› ä¸ºçº¿ç¨‹åœ¨é˜»å¡å’Œéé˜»å¡ä¹‹é—´åˆ‡æ¢æ—¶éœ€è¦æ¯”è¾ƒé•¿çš„æ—¶é—´ï¼Œå¦‚æœåˆšå¥½çº¿ç¨‹Aé‡Šæ”¾äº†èµ„æºï¼ŒAä¼šå»å”¤é†’ä¸‹ä¸€ä¸ªæ’ç€é˜Ÿçš„NodeèŠ‚ç‚¹ï¼Œå½“è¿™ä¸ªå”¤é†’æ“ä½œè¿˜æ²¡å®Œæˆçš„æ—¶å€™ï¼Œè¿™æ—¶åˆæ¥äº†ä¸€ä¸ªçº¿ç¨‹Bï¼Œçº¿ç¨‹Bå‘ç°å½“å‰æ²¡äººæŒæœ‰è¿™ä¸ªèµ„æºï¼Œäºæ˜¯è‡ªå·±å°±è¿…é€Ÿæ‹¿åˆ°äº†è¿™ä¸ªèµ„æºï¼Œå……åˆ†åˆ©ç”¨äº†çº¿ç¨‹Aå»å”¤é†’Bçš„è¿™ä¸€æ®µæ—¶é—´ï¼Œè¿™å°±æ˜¯å…¬å¹³é”å’Œéå…¬å¹³é”ä¹‹é—´çš„å·®å¼‚ï¼Œè¿™é‡Œä¹Ÿä½“ç°äº†éå…¬å¹³é”æ€§èƒ½è¾ƒé«˜çš„åœ°æ–¹ã€‚</p><h1 id="4-ReentrantReadWriteLock"><a href="#4-ReentrantReadWriteLock" class="headerlink" title="4. ReentrantReadWriteLock"></a>4. ReentrantReadWriteLock</h1><p>ReentrantReadWriteLockæ˜¯ Lock çš„å¦ä¸€ç§å®ç°æ–¹å¼ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº† ReentrantLock æ˜¯ä¸€ä¸ªæ’ä»–é”ï¼ŒåŒä¸€æ—¶é—´åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œè€Œ ReentrantReadWriteLock å…è®¸å¤šä¸ªè¯»çº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œä½†ä¸å…è®¸å†™çº¿ç¨‹å’Œè¯»çº¿ç¨‹ã€å†™çº¿ç¨‹å’Œå†™çº¿ç¨‹åŒæ—¶è®¿é—®ã€‚ç›¸å¯¹äºæ’ä»–é”ï¼Œæé«˜äº†å¹¶å‘æ€§ã€‚</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h1 id="5-CountDownLatch-amp-CyclicBarrier"><a href="#5-CountDownLatch-amp-CyclicBarrier" class="headerlink" title="5. CountDownLatch &amp; CyclicBarrier"></a>5. CountDownLatch &amp; CyclicBarrier</h1><h2 id="1-CountDownLatch"><a href="#1-CountDownLatch" class="headerlink" title="1. CountDownLatch"></a>1. CountDownLatch</h2><p>CountDownLatchæ˜¯ä¸€ä¸ªè®¡æ•°å™¨é—­é”ï¼Œé€šè¿‡å®ƒå¯ä»¥å®Œæˆç±»ä¼¼äºé˜»å¡å½“å‰çº¿ç¨‹çš„åŠŸèƒ½ï¼Œå³ï¼šä¸€ä¸ªçº¿ç¨‹æˆ–å¤šä¸ªçº¿ç¨‹ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹æ‰§è¡Œçš„æ“ä½œå®Œæˆã€‚</p><p>CountDownLatchç”¨ä¸€ä¸ªç»™å®šçš„è®¡æ•°å™¨æ¥åˆå§‹åŒ–ï¼Œè¯¥è®¡æ•°å™¨çš„æ“ä½œæ˜¯åŸå­æ“ä½œï¼Œå³åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å»æ“ä½œè¯¥è®¡æ•°å™¨ã€‚è°ƒç”¨è¯¥ç±»awaitæ–¹æ³•çš„çº¿ç¨‹ä¼šä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨countDownæ–¹æ³•ä½¿å½“å‰è®¡æ•°å™¨çš„å€¼å˜ä¸ºé›¶ï¼Œæ¯æ¬¡è°ƒç”¨countDownè®¡æ•°å™¨çš„å€¼å‡1ã€‚å½“è®¡æ•°å™¨å€¼å‡è‡³é›¶æ—¶ï¼Œæ‰€æœ‰å› è°ƒç”¨await()æ–¹æ³•è€Œå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹å°±ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚è¿™ç§ç°è±¡åªä¼šå‡ºç°ä¸€æ¬¡ï¼Œå› ä¸ºè®¡æ•°å™¨ä¸èƒ½è¢«é‡ç½®ï¼Œå¦‚æœä¸šåŠ¡ä¸Šéœ€è¦ä¸€ä¸ªå¯ä»¥é‡ç½®è®¡æ•°æ¬¡æ•°çš„ç‰ˆæœ¬ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨CycliBarrierã€‚</p><h2 id="2-CyclicBarrier"><a href="#2-CyclicBarrier" class="headerlink" title="2 CyclicBarrier"></a>2 CyclicBarrier</h2><p>CyclicBarrierä¹Ÿæ˜¯ä¸€ä¸ªåŒæ­¥è¾…åŠ©ç±»ï¼Œå®ƒå…è®¸ä¸€ç»„çº¿ç¨‹ç›¸äº’ç­‰å¾…ï¼Œç›´åˆ°åˆ°è¾¾æŸä¸ªå…¬å…±å±éšœç‚¹ï¼ˆcommon barrier pointï¼‰ã€‚</p><p>é€šè¿‡å®ƒå¯ä»¥å®Œæˆå¤šä¸ªçº¿ç¨‹ä¹‹é—´ç›¸äº’ç­‰å¾…ï¼Œåªæœ‰å½“æ¯ä¸ªçº¿ç¨‹éƒ½å‡†å¤‡å°±ç»ªåï¼Œæ‰èƒ½å„è‡ªç»§ç»­å¾€ä¸‹æ‰§è¡Œåé¢çš„æ“ä½œã€‚ç±»ä¼¼äºCountDownLatchï¼Œå®ƒä¹Ÿæ˜¯é€šè¿‡è®¡æ•°å™¨æ¥å®ç°çš„ã€‚å½“æŸä¸ªçº¿ç¨‹è°ƒç”¨awaitæ–¹æ³•æ—¶ï¼Œè¯¥çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œä¸”è®¡æ•°å™¨åŠ 1ï¼Œå½“è®¡æ•°å™¨çš„å€¼è¾¾åˆ°è®¾ç½®çš„åˆå§‹å€¼æ—¶ï¼Œæ‰€æœ‰å› è°ƒç”¨awaitè¿›å…¥ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹è¢«å”¤é†’ï¼Œç»§ç»­æ‰§è¡Œåç»­æ“ä½œã€‚å› ä¸ºCycliBarrieråœ¨é‡Šæ”¾ç­‰å¾…çº¿ç¨‹åå¯ä»¥é‡ç”¨ï¼Œæ‰€ä»¥ç§°ä¸ºå¾ªç¯barrierã€‚CycliBarrieræ”¯æŒä¸€ä¸ªå¯é€‰çš„Runnableï¼Œåœ¨è®¡æ•°å™¨çš„å€¼åˆ°è¾¾è®¾å®šå€¼åï¼ˆä½†åœ¨é‡Šæ”¾æ‰€æœ‰çº¿ç¨‹ä¹‹å‰ï¼‰ï¼Œè¯¥Runnableè¿è¡Œä¸€æ¬¡ï¼Œæ³¨ï¼ŒRunnableåœ¨æ¯ä¸ªå±éšœç‚¹åªè¿è¡Œä¸€ä¸ªã€‚</p><h2 id="3-åŒºåˆ«"><a href="#3-åŒºåˆ«" class="headerlink" title="3. åŒºåˆ«"></a>3. åŒºåˆ«</h2><p>CountDownLatchä¸»è¦æ˜¯å®ç°äº†1ä¸ªæˆ–Nä¸ªçº¿ç¨‹éœ€è¦ç­‰å¾…å…¶ä»–çº¿ç¨‹å®ŒæˆæŸé¡¹æ“ä½œä¹‹åæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œæ“ä½œï¼Œæè¿°çš„æ˜¯1ä¸ªçº¿ç¨‹æˆ–Nä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹çš„å…³ç³»ã€‚CyclicBarrierä¸»è¦æ˜¯å®ç°äº†å¤šä¸ªçº¿ç¨‹ä¹‹é—´ç›¸äº’ç­‰å¾…ï¼Œç›´åˆ°æ‰€æœ‰çš„çº¿ç¨‹éƒ½æ»¡è¶³äº†æ¡ä»¶ä¹‹åå„è‡ªæ‰èƒ½ç»§ç»­æ‰§è¡Œåç»­çš„æ“ä½œï¼Œæè¿°çš„å¤šä¸ªçº¿ç¨‹å†…éƒ¨ç›¸äº’ç­‰å¾…çš„å…³ç³»ã€‚<br>CountDownLatchæ˜¯ä¸€æ¬¡æ€§çš„ï¼Œè€ŒCyclicBarrieråˆ™å¯ä»¥è¢«é‡ç½®è€Œé‡å¤ä½¿ç”¨ã€‚</p><h1 id="6-CAS"><a href="#6-CAS" class="headerlink" title="6 CAS"></a>6 CAS</h1><p>CASï¼ˆCompare and Swapï¼‰æœ‰3ä¸ªæ“ä½œæ•°ï¼Œå†…å­˜å€¼Vï¼Œæ—§çš„é¢„æœŸå€¼Aï¼Œè¦ä¿®æ”¹çš„æ–°å€¼Bã€‚å½“ä¸”ä»…å½“é¢„æœŸå€¼Aå’Œå†…å­˜å€¼Vç›¸åŒæ—¶ï¼Œå°†å†…å­˜å€¼Vä¿®æ”¹ä¸ºBï¼Œå¦åˆ™ä»€ä¹ˆéƒ½ä¸åšã€‚</p><p>java.util.concurrent(J.U.C)ç§æä¾›çš„atomicåŒ…ä¸­çš„ç±»ï¼Œä½¿ç”¨çš„æ˜¯ä¹è§‚é”ï¼Œç”¨åˆ°çš„æœºåˆ¶å°±æ˜¯CASï¼Œå½“å¤šä¸ªçº¿ç¨‹å°è¯•ä½¿ç”¨CASåŒæ—¶æ›´æ–°ä¸€ä¸ªå˜é‡æ—¶ï¼Œåªæœ‰å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹å¯èƒ½æ›´æ–°å˜é‡çš„å€¼ï¼Œè€Œå…¶ä»–çº¿ç¨‹éƒ½å¤±è´¥ï¼Œå¤±è´¥çš„çº¿ç¨‹ä¸ä¼šè¢«æŒ‚èµ·ï¼Œè€Œæ˜¯è¢«å‘ŠçŸ¥è¿™æ¬¡ç«äº‰å¤±è´¥ï¼Œå¹¶å¯ä»¥å†æ¬¡å°è¯•ã€‚</p><h2 id="1-AtomicInteger"><a href="#1-AtomicInteger" class="headerlink" title="1. AtomicInteger"></a>1. AtomicInteger</h2><p>ä»¥AtomicIntegerä¸ºä¾‹ï¼Œç ”ç©¶åœ¨æ²¡æœ‰é”çš„æƒ…å†µä¸‹æ˜¯å¦‚ä½•åšåˆ°æ•°æ®æ­£ç¡®æ€§çš„ã€‚<br>ä¾‹å¦‚ AtomicInteger ä¸­æœ‰ä¸€ä¸ªåŸå­æ–¹å¼ i++ æ“ä½œï¼Œå³</p><ol><li>è°ƒç”¨incrementAndGet(),è€ŒincrementAndGet() è°ƒç”¨ unsafeä¸‹çš„æ–¹æ³•getAndAddInt()</li><li>getAndAddInt()ä¸­æœ‰ä¸€ä¸ª valueOffset å‚æ•°ï¼Œè¿™ä¸ªå€¼æ˜¯ value å€¼åœ¨ AtomicInteger ç±»å‹ä¸­å†…å­˜çš„åç§»åœ°å€ã€‚ä¼ å…¥çš„ valueOffset å‚æ•°ä¼šåœ¨åç»­æ–¹æ³•ä¸­ï¼Œç›´æ¥ä»å†…å­˜ä½ç½®è¯»å–è¿™ä¸ªå­—æ®µçš„å€¼ã€‚</li><li>å¾—åˆ°æœ€æ–°å€¼åï¼Œè°ƒç”¨ compareAndSwapInt æ¥æ›´æ–°æœ€æ–°å€¼ï¼Œå¦‚æœå¯¹è±¡ o ä¸­ offset åç§»ä½ç½®çš„å€¼ç­‰äºæœŸæœ›å€¼(expected)ï¼Œå°±å°†è¯¥ offset å¤„çš„å€¼æ›´æ–°ä¸º xï¼Œå½“æ›´æ–°æˆåŠŸæ—¶ï¼Œè¿”å› trueã€‚ç»“åˆå‰é¢è°ƒç”¨æ¥çœ‹ï¼Œå¦‚æœå½“å‰å€¼æ˜¯ vï¼Œå°±è®¾ç½®ä¸º v+1ã€‚å¦åˆ™é‡è¯•ç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚</li></ol><h2 id="2-CASé—®é¢˜"><a href="#2-CASé—®é¢˜" class="headerlink" title="2. CASé—®é¢˜"></a>2. CASé—®é¢˜</h2><ol><li><p><strong>ABAé—®é¢˜</strong>ã€‚<br>å› ä¸ºCASéœ€è¦åœ¨æ“ä½œå€¼çš„æ—¶å€™æ£€æŸ¥ä¸‹å€¼æœ‰æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿå˜åŒ–åˆ™æ›´æ–°ï¼Œä½†æ˜¯å¦‚æœä¸€ä¸ªå€¼åŸæ¥æ˜¯Aï¼Œå˜æˆäº†Bï¼Œåˆå˜æˆäº†Aï¼Œé‚£ä¹ˆä½¿ç”¨CASè¿›è¡Œæ£€æŸ¥æ—¶ä¼šå‘ç°å®ƒçš„å€¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯å®é™…ä¸Šå´å˜åŒ–äº†ã€‚<br>ABAé—®é¢˜çš„è§£å†³æ€è·¯å°±æ˜¯ä½¿ç”¨ç‰ˆæœ¬å·ã€‚åœ¨å˜é‡å‰é¢è¿½åŠ ä¸Šç‰ˆæœ¬å·ï¼Œæ¯æ¬¡å˜é‡æ›´æ–°çš„æ—¶å€™æŠŠç‰ˆæœ¬å·åŠ ä¸€ï¼Œé‚£ä¹ˆAï¼Bï¼A å°±ä¼šå˜æˆ1A-2Bï¼3Aã€‚<br>ä»Java1.5å¼€å§‹JDKçš„atomicåŒ…é‡Œæä¾›äº†ä¸€ä¸ªç±»AtomicStampedReferenceæ¥è§£å†³ABAé—®é¢˜ã€‚è¿™ä¸ªç±»çš„compareAndSetæ–¹æ³•ä½œç”¨æ˜¯é¦–å…ˆæ£€æŸ¥å½“å‰å¼•ç”¨æ˜¯å¦ç­‰äºé¢„æœŸå¼•ç”¨ï¼Œå¹¶ä¸”å½“å‰æ ‡å¿—æ˜¯å¦ç­‰äºé¢„æœŸæ ‡å¿—ï¼Œå¦‚æœå…¨éƒ¨ç›¸ç­‰ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å¼•ç”¨å’Œè¯¥æ ‡å¿—çš„å€¼è®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼ã€‚</p></li><li><p><strong>å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§ã€‚</strong><br>è‡ªæ—‹CASå¦‚æœé•¿æ—¶é—´ä¸æˆåŠŸï¼Œä¼šç»™CPUå¸¦æ¥éå¸¸å¤§çš„æ‰§è¡Œå¼€é”€ã€‚å¦‚æœJVMèƒ½æ”¯æŒå¤„ç†å™¨æä¾›çš„pauseæŒ‡ä»¤é‚£ä¹ˆæ•ˆç‡ä¼šæœ‰ä¸€å®šçš„æå‡ï¼ŒpauseæŒ‡ä»¤æœ‰ä¸¤ä¸ªä½œç”¨ï¼Œç¬¬ä¸€å®ƒå¯ä»¥å»¶è¿Ÿæµæ°´çº¿æ‰§è¡ŒæŒ‡ä»¤ï¼ˆde-pipelineï¼‰,ä½¿CPUä¸ä¼šæ¶ˆè€—è¿‡å¤šçš„æ‰§è¡Œèµ„æºï¼Œå»¶è¿Ÿçš„æ—¶é—´å–å†³äºå…·ä½“å®ç°çš„ç‰ˆæœ¬ï¼Œåœ¨ä¸€äº›å¤„ç†å™¨ä¸Šå»¶è¿Ÿæ—¶é—´æ˜¯é›¶ã€‚ç¬¬äºŒå®ƒå¯ä»¥é¿å…åœ¨é€€å‡ºå¾ªç¯çš„æ—¶å€™å› å†…å­˜é¡ºåºå†²çªï¼ˆmemory order violationï¼‰è€Œå¼•èµ·CPUæµæ°´çº¿è¢«æ¸…ç©ºï¼ˆCPU pipeline flushï¼‰ï¼Œä»è€Œæé«˜CPUçš„æ‰§è¡Œæ•ˆç‡ã€‚</p></li><li><p><strong>åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œã€‚</strong><br>å½“å¯¹ä¸€ä¸ªå…±äº«å˜é‡æ‰§è¡Œæ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¾ªç¯CASçš„æ–¹å¼æ¥ä¿è¯åŸå­æ“ä½œï¼Œä½†æ˜¯å¯¹å¤šä¸ªå…±äº«å˜é‡æ“ä½œæ—¶ï¼Œå¾ªç¯CASå°±æ— æ³•ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨é”ï¼Œæˆ–è€…æœ‰ä¸€ä¸ªå–å·§çš„åŠæ³•ï¼Œå°±æ˜¯æŠŠå¤šä¸ªå…±äº«å˜é‡åˆå¹¶æˆä¸€ä¸ªå…±äº«å˜é‡æ¥æ“ä½œã€‚æ¯”å¦‚æœ‰ä¸¤ä¸ªå…±äº«å˜é‡iï¼2,j&#x3D;aï¼Œåˆå¹¶ä¸€ä¸‹ij&#x3D;2aï¼Œç„¶åç”¨CASæ¥æ“ä½œijã€‚ä»Java1.5å¼€å§‹JDKæä¾›äº†AtomicReferenceç±»æ¥ä¿è¯å¼•ç”¨å¯¹è±¡ä¹‹é—´çš„åŸå­æ€§ï¼Œä½ å¯ä»¥æŠŠå¤šä¸ªå˜é‡æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œæ¥è¿›è¡ŒCASæ“ä½œã€‚</p></li></ol><h1 id="7-ThreadLocal"><a href="#7-ThreadLocal" class="headerlink" title="7 ThreadLocal"></a>7 ThreadLocal</h1><p>ThreadLocal æä¾›çº¿ç¨‹å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œåœ¨æœ¬çº¿ç¨‹å†…éšæ—¶éšåœ°å¯å–ï¼Œéš”ç¦»å…¶ä»–çº¿ç¨‹</p><p><strong>æ—©æœŸè®¾è®¡ï¼š</strong></p><p>æ¯ä¸ª ThreadLocalç±»éƒ½åˆ›å»ºä¸€ä¸ª Mapï¼Œç„¶åç”¨çº¿ç¨‹çš„ ID threadID ä½œä¸º Map çš„ keyï¼Œè¦å­˜å‚¨çš„å±€éƒ¨å˜é‡ä½œä¸º Map çš„ valueï¼Œè¿™æ ·å°±èƒ½è¾¾åˆ°å„ä¸ªçº¿ç¨‹çš„å€¼éš”ç¦»çš„æ•ˆæœã€‚</p><p> <strong>JDK8 ThreadLocal çš„è®¾è®¡ï¼š</strong></p><p>æ¯ä¸ª Thread ç»´æŠ¤ä¸€ä¸ª ThreadLocalMap å“ˆå¸Œè¡¨ï¼Œè¿™ä¸ªå“ˆå¸Œè¡¨çš„ key æ˜¯ ThreadLocal å®ä¾‹æœ¬èº«ï¼Œvalueæ‰æ˜¯çœŸæ­£è¦å­˜å‚¨çš„å€¼ Objectã€‚</p><p><strong>è¿™æ ·è®¾è®¡æœ‰å¦‚ä¸‹å‡ ç‚¹ä¼˜åŠ¿ï¼š</strong><br>1ï¼‰ è¿™æ ·è®¾è®¡ä¹‹åæ¯ä¸ª Map å­˜å‚¨çš„ Entry æ•°é‡å°±ä¼šå˜å°ï¼Œå› ä¸ºä¹‹å‰çš„å­˜å‚¨æ•°é‡ç”±Thread çš„æ•°é‡å†³å®šï¼Œç°åœ¨æ˜¯ç”± ThreadLocal çš„æ•°é‡å†³å®šã€‚<br>2ï¼‰ å½“ Thread é”€æ¯ä¹‹åï¼Œå¯¹åº”çš„ ThreadLocalMap ä¹Ÿä¼šéšä¹‹é”€æ¯ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒï¼Œèƒ½å‡å°‘å†…å­˜çš„ä½¿ç”¨ã€‚<br>æ³¨ï¼šThreadLocalMapå…¶å®æ˜¯çº¿ç¨‹è‡ªèº«çš„ä¸€ä¸ªæˆå‘˜å±æ€§threadLocalsçš„ç±»å‹ã€‚ä¹Ÿå°±æ˜¯çº¿ç¨‹æœ¬åœ°æ•°æ®éƒ½å­˜åœ¨è¿™ä¸ªthreadLocalsåº”ç”¨çš„ThreadLocalMapä¸­ã€‚</p><h2 id="1-åº•å±‚å®ç°"><a href="#1-åº•å±‚å®ç°" class="headerlink" title="1. åº•å±‚å®ç°"></a>1. åº•å±‚å®ç°</h2><h2 id="1-set-Tvalue"><a href="#1-set-Tvalue" class="headerlink" title="1. set(Tvalue)"></a>1. set(Tvalue)</h2><p>1 ) è·å–å½“å‰çº¿ç¨‹ Thread å¯¹è±¡ï¼Œè¿›è€Œè·å–æ­¤çº¿ç¨‹å¯¹è±¡ä¸­ç»´æŠ¤çš„ ThreadLocalMap å¯¹è±¡ã€‚<br>2 ) åˆ¤æ–­å½“å‰çš„ ThreadLocalMap æ˜¯å¦å­˜åœ¨ï¼š<br>å¦‚æœå­˜åœ¨ï¼Œåˆ™è°ƒç”¨ map.set è®¾ç½®æ­¤å®ä½“ entryã€‚<br>å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è°ƒç”¨ createMap è¿›è¡Œ ThreadLocalMap å¯¹è±¡çš„åˆå§‹åŒ–ï¼Œå¹¶å°†æ­¤å®ä½“ entry ä½œä¸ºç¬¬ä¸€ä¸ªå€¼å­˜æ”¾è‡³ ThreadLocalMap ä¸­ã€‚</p><h2 id="2-get"><a href="#2-get" class="headerlink" title="2. get()"></a>2. get()</h2><ol><li><p>è·å–å½“å‰çº¿ç¨‹ Thread å¯¹è±¡ï¼Œè¿›è€Œè·å–æ­¤çº¿ç¨‹å¯¹è±¡ä¸­ç»´æŠ¤çš„ ThreadLocalMap å¯¹è±¡ã€‚</p></li><li><p>åˆ¤æ–­å½“å‰çš„ ThreadLocalMap æ˜¯å¦å­˜åœ¨ï¼š</p><ul><li><p>å¦‚æœå­˜åœ¨ï¼Œåˆ™ä»¥å½“å‰çš„ ThreadLocal ä¸º keyï¼Œè°ƒç”¨ ThreadLocalMap ä¸­çš„ getEntry æ–¹æ³•è·å–å¯¹åº”çš„å­˜å‚¨å®ä½“ eã€‚æ‰¾åˆ°å¯¹åº”çš„å­˜å‚¨å®ä½“ eï¼Œè·å–å­˜å‚¨å®ä½“ e å¯¹åº”çš„ value å€¼ï¼Œå³ä¸ºæˆ‘ä»¬æƒ³è¦çš„å½“å‰çº¿ç¨‹å¯¹åº”æ­¤ ThreadLocal çš„å€¼ï¼Œè¿”å›ç»“æœå€¼ã€‚</p></li><li><p>å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¯æ˜æ­¤çº¿ç¨‹æ²¡æœ‰ç»´æŠ¤çš„ ThreadLocalMap å¯¹è±¡ï¼Œè°ƒç”¨ setInitialValue æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ã€‚è¿”å› setInitialValue åˆå§‹åŒ–çš„å€¼ã€‚</p></li></ul></li><li><p>setInitialValue æ–¹æ³•çš„æ“ä½œå¦‚ä¸‹ï¼š</p><ol><li>è°ƒç”¨ initialValue è·å–åˆå§‹åŒ–çš„å€¼ã€‚</li><li>è·å–å½“å‰çº¿ç¨‹ Thread å¯¹è±¡ï¼Œè¿›è€Œè·å–æ­¤çº¿ç¨‹å¯¹è±¡ä¸­ç»´æŠ¤çš„ ThreadLocalMap å¯¹è±¡ï¼Œå¹¶åˆ¤æ–­å½“å‰çš„ ThreadLocalMap æ˜¯å¦å­˜åœ¨ï¼š<ul><li>å¦‚æœå­˜åœ¨ï¼Œåˆ™è°ƒç”¨ map.set è®¾ç½®æ­¤å®ä½“ entryã€‚</li><li>å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è°ƒç”¨ createMap è¿›è¡Œ ThreadLocalMap å¯¹è±¡çš„åˆå§‹åŒ–ï¼Œå¹¶å°†æ­¤å®ä½“ entry ä½œä¸ºç¬¬ä¸€ä¸ªå€¼å­˜æ”¾è‡³ ThreadLocalMap ä¸­ã€‚</li></ul></li></ol></li></ol><h1 id="8-volatile"><a href="#8-volatile" class="headerlink" title="8. volatile"></a>8. volatile</h1><h2 id="1-volatile-å…³é”®å­—çš„ä½œç”¨"><a href="#1-volatile-å…³é”®å­—çš„ä½œç”¨" class="headerlink" title="1. volatile å…³é”®å­—çš„ä½œç”¨"></a>1. volatile å…³é”®å­—çš„ä½œç”¨</h2><p>volatile å…³é”®å­—çš„ä¸»è¦ä½œç”¨æ˜¯ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§,ç¦æ­¢ç¼–è¯‘å™¨ä¼˜åŒ–ã€‚</p><ul><li>ä¿è¯å¯è§æ€§:å½“ä¸€ä¸ªå˜é‡è¢«å£°æ˜ä¸º volatile ä¹‹å,æ¯æ¬¡è¯»å–è¿™ä¸ªå˜é‡çš„å€¼éƒ½ä¼šä»ä¸»å†…å­˜ä¸­è¯»å–,è€Œä¸æ˜¯ä»ç¼“å­˜ä¸­è¯»å–,è¿™å°±ä¿è¯äº†ä¸åŒçº¿ç¨‹å¯¹è¿™ä¸ªå˜é‡æ“ä½œçš„å¯è§æ€§ã€‚</li><li>æœ‰åºæ€§:volatile å…³é”®å­—ä¿è¯äº†ä¸åŒçº¿ç¨‹å¯¹ä¸€ä¸ª volatile å˜é‡çš„è¯»å†™æ“ä½œçš„æœ‰åºæ€§ã€‚</li><li>ç¦æ­¢ç¼–è¯‘å™¨ä¼˜åŒ–:ç¼–è¯‘å™¨ä¼šå¯¹ä»£ç è¿›è¡Œå„ç§ä¼˜åŒ–æ¥æé«˜æ€§èƒ½,ä½†æ˜¯è¿™äº›ä¼˜åŒ–ä¹Ÿå¯èƒ½è®©åŒæ­¥ä»£ç å¤±æ•ˆã€‚volatile å…³é”®å­—å‘Šè¯‰ç¼–è¯‘å™¨ä¸è¦å¯¹è¿™æ®µä»£ç åšä¼˜åŒ–,ä»è€Œé¿å…ä¸€äº›ä¸æ­£ç¡®çš„ä¼˜åŒ–ã€‚</li></ul><h2 id="2-volatile-å®ç°åŸç†"><a href="#2-volatile-å®ç°åŸç†" class="headerlink" title="2. volatile å®ç°åŸç†"></a>2. volatile å®ç°åŸç†</h2><p>volatile å…³é”®å­—åº•å±‚åŸç†ä¾èµ–äºå†…å­˜å±éšœå’Œç¼“å­˜ä¸€è‡´æ€§åè®®ã€‚</p><ul><li>å†…å­˜å±éšœ:å†…å­˜å±éšœä¼šå¼ºåˆ¶è®©è¯»å’Œå†™æ“ä½œéƒ½è®¿é—®ä¸»å†…å­˜,ä»è€Œå®ç°å¯è§æ€§ã€‚volatile å†™æ“ä½œåä¼šåŠ å…¥å†™å±éšœ,volatile è¯»æ“ä½œå‰ä¼šåŠ å…¥è¯»å±éšœã€‚</li><li>ç¼“å­˜ä¸€è‡´æ€§åè®®:æ¯ä¸ªå¤„ç†å™¨éƒ½æœ‰è‡ªå·±çš„é«˜é€Ÿç¼“å­˜,å½“æŸä¸ªå¤„ç†å™¨ä¿®æ”¹äº†å…±äº«å˜é‡,éœ€è¦ç¼“å­˜ä¸€è‡´æ€§åè®®æ¥ä¿è¯å…¶ä»–å¤„ç†å™¨ä¹Ÿçœ‹åˆ°ä¿®æ”¹åçš„å€¼ã€‚ç¼“å­˜ä¸€è‡´æ€§åè®®ä¼šåœ¨è¯»æ“ä½œåå’Œå†™æ“ä½œå‰åŠ å…¥ç¼“å­˜åˆ·æ–°æ“ä½œ,ä¿è¯å…¶ä»–å¤„ç†å™¨çš„ç¼“å­˜æ˜¯æœ€æ–°å€¼ã€‚</li></ul><h1 id="9-æ‚²è§‚é”ä¸ä¹è§‚é”"><a href="#9-æ‚²è§‚é”ä¸ä¹è§‚é”" class="headerlink" title="9 æ‚²è§‚é”ä¸ä¹è§‚é”"></a>9 æ‚²è§‚é”ä¸ä¹è§‚é”</h1><h2 id="1-æ‚²è§‚é”"><a href="#1-æ‚²è§‚é”" class="headerlink" title="1. æ‚²è§‚é”"></a>1. æ‚²è§‚é”</h2><p>è¿™æ˜¯ä¸€ç§å¯¹æ•°æ®çš„ä¿®æ”¹æŒæœ‰æ‚²è§‚æ€åº¦çš„å¹¶å‘æ§åˆ¶æ–¹å¼ã€‚æ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡è¯»å–æ•°æ®çš„æ—¶å€™éƒ½é»˜è®¤å…¶ä»–çº¿ç¨‹ä¼šæ›´æ”¹æ•°æ®ï¼Œå› æ­¤éœ€è¦è¿›è¡ŒåŠ é”æ“ä½œï¼Œå½“å…¶ä»–çº¿ç¨‹æƒ³è¦è®¿é—®æ•°æ®æ—¶ï¼Œéƒ½éœ€è¦é˜»å¡æŒ‚èµ·ã€‚æ‚²è§‚é”çš„å®ç°ï¼š</p><ol><li>ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ä½¿ç”¨è¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚</li><li>Java é‡Œé¢çš„åŒæ­¥ synchronized å…³é”®å­—çš„å®ç°ã€‚</li></ol><p>æ‚²è§‚é”ä¸»è¦åˆ†ä¸ºå…±äº«é”å’Œæ’ä»–é”ï¼š</p><ul><li>å…±äº«é”ã€shared locksã€‘åˆç§°ä¸ºè¯»é”ï¼Œç®€ç§°Sé”ã€‚é¡¾åæ€ä¹‰ï¼Œå…±äº«é”å°±æ˜¯å¤šä¸ªäº‹åŠ¡å¯¹äºåŒä¸€æ•°æ®å¯ä»¥å…±äº«ä¸€æŠŠé”ï¼Œéƒ½èƒ½è®¿é—®åˆ°æ•°æ®ï¼Œä½†æ˜¯åªèƒ½è¯»ä¸èƒ½ä¿®æ”¹ã€‚</li><li>æ’ä»–é”ã€exclusive locksã€‘åˆç§°ä¸ºå†™é”ï¼Œç®€ç§°Xé”ã€‚é¡¾åæ€ä¹‰ï¼Œæ’ä»–é”å°±æ˜¯ä¸èƒ½ä¸å…¶ä»–é”å¹¶å­˜ï¼Œå¦‚æœä¸€ä¸ªäº‹åŠ¡è·å–äº†ä¸€ä¸ªæ•°æ®è¡Œçš„æ’ä»–é”ï¼Œå…¶ä»–äº‹åŠ¡å°±ä¸èƒ½å†è·å–è¯¥è¡Œçš„å…¶ä»–é”ï¼ŒåŒ…æ‹¬å…±äº«é”å’Œæ’ä»–é”ï¼Œä½†æ˜¯è·å–æ’ä»–é”çš„äº‹åŠ¡æ˜¯å¯ä»¥å¯¹æ•°æ®è¡Œè¯»å–å’Œä¿®æ”¹ã€‚</li></ul><h2 id="2-ä¹è§‚é”"><a href="#2-ä¹è§‚é”" class="headerlink" title="2. ä¹è§‚é”"></a>2. ä¹è§‚é”</h2><p>ä¹è§‚é”æ˜¯ç›¸å¯¹æ‚²è§‚é”è€Œè¨€çš„ï¼Œä¹è§‚é”å‡è®¾æ•°æ®ä¸€èˆ¬æƒ…å†µä¸‹ä¸ä¼šé€ æˆå†²çªï¼Œæ‰€ä»¥<strong>åœ¨æ•°æ®è¿›è¡Œæäº¤æ›´æ–°çš„æ—¶å€™ï¼Œæ‰ä¼šæ­£å¼å¯¹æ•°æ®çš„å†²çªä¸å¦è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœå‘ç°å†²çªäº†ï¼Œåˆ™è¿”å›ç»™ç”¨æˆ·é”™è¯¯çš„ä¿¡æ¯ï¼Œè®©ç”¨æˆ·å†³å®šå¦‚ä½•å»åšã€‚ä¹è§‚é”é€‚ç”¨äºè¯»æ“ä½œå¤šçš„åœºæ™¯ï¼Œè¿™æ ·å¯ä»¥æé«˜ç¨‹åºçš„ååé‡ã€‚</strong></p><p>ä¹è§‚é”çš„å®ç°ï¼šCAS</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æŠ€æœ¯é€‰å‹</title>
    <link href="/%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B/"/>
    <url>/%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æŠ€æœ¯é€‰å‹æ‰€è¦è€ƒè™‘çš„"><a href="#1-æŠ€æœ¯é€‰å‹æ‰€è¦è€ƒè™‘çš„" class="headerlink" title="1. æŠ€æœ¯é€‰å‹æ‰€è¦è€ƒè™‘çš„"></a>1. æŠ€æœ¯é€‰å‹æ‰€è¦è€ƒè™‘çš„</h1><ul><li>åˆ‡åˆä¸šåŠ¡ï¼šåœ¨å½“å‰çš„åœºæ™¯ä»¥åŠåç»­çš„ä¸€äº›æ¨¡å—çš„è®¾è®¡ï¼Œéƒ½å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„ä¸šåŠ¡</li><li>ç¤¾åŒºæ´»è·ƒåº¦ï¼šæ´»è·ƒå¤šï¼Œä½¿ç”¨çš„äººå¤šï¼Œä¼˜ç‚¹ç¼ºç‚¹éƒ½å¯ä»¥å‘ˆç°å‡ºæ¥ï¼ŒåŒ…æ‹¬ä¼šé‡åˆ°çš„é—®é¢˜</li><li>å›¢é˜ŸæŠ€æœ¯æ°´å¹³ï¼šé’ˆå¯¹å¼€å‘å‘¨æœŸçš„é•¿çŸ­ï¼Œéœ€è¦è€ƒè™‘æˆ‘ä»¬æ˜¯é‡‡ç”¨è€æŠ€æœ¯è¿˜æ˜¯æ–°æŠ€æœ¯ã€‚å¦‚æœæ˜¯æ–°æŠ€æœ¯ï¼Œå›¢é˜Ÿæ²¡æœ‰å‡ ä¸ªäººæ¥è§¦è¿‡çš„è¯ï¼Œé‚£ä¹ˆå°±éœ€è¦æ•´ä½“çš„ä¸€ä¸ªåŸ¹è®­ï¼Œæ¥æé«˜å›¢é˜Ÿçš„æŠ€æœ¯æ°´å¹³ã€‚</li><li>ç‰ˆæœ¬æ›´æ–°è¿­ä»£å‘¨æœŸï¼šå¦‚æœç‰ˆæœ¬æ›´æ–°è¿­ä»£çš„æ¯”è¾ƒå¿«ï¼Œå¯ä»¥ä¼˜å…ˆè€ƒè™‘ï¼Œå› ä¸ºå¦‚æœä½ é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯ç‰ˆæœ¬åœæ›´äº†ï¼Œå°±ä¼šå¯¹å…¬å¸çš„ä¸šåŠ¡å¤šå¤šå°‘å°‘é€ æˆä¸€å®šçš„å½±å“</li><li>è¯•é”™ç²¾ç¥ï¼šå¹³æ—¶å¤šæ¥è§¦å„ç±»æŠ€æœ¯ï¼Œå°±å¯ä»¥æœ‰å¤šç§å¤‡é€‰æ–¹æ¡ˆ</li><li>å®‰å…¨æ€§ï¼šæŸäº›æŠ€æœ¯æ›¾ç»æœ‰å®‰å…¨é—®é¢˜ï¼Œå®‰å…¨æ¼æ´çš„è¯ï¼Œè¦å¤šæ–Ÿé…Œå†ä½¿ç”¨</li><li>æˆåŠŸæ¡ˆä¾‹ï¼šå¯ä»¥å¤šä½¿ç”¨ä¸€äº›æœ‰æˆåŠŸæ¡ˆä¾‹çš„</li><li>å¼€æºç²¾ç¥ï¼šå¦‚æœè¿™ä¸ªæŠ€æœ¯ä¼šé—­æºçš„ï¼Œéœ€è¦è€ƒè™‘åæœŸä¼šæ”¶è´¹çš„åœºæ™¯</li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å¹‚ç­‰æ€§</title>
    <link href="/%E5%B9%82%E7%AD%89%E6%80%A7/"/>
    <url>/%E5%B9%82%E7%AD%89%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å¹‚ç­‰æ€§æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-å¹‚ç­‰æ€§æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. å¹‚ç­‰æ€§æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. å¹‚ç­‰æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªæ¥å£ï¼Œè¿è¡Œå¤šæ¬¡å’Œè¿è¡Œä¸€æ¬¡çš„ç»“æœæ˜¯ä¸€è‡´çš„ã€‚</p><p>ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¹‚ç­‰æ€§ï¼Ÿ</p><p>é‡å¤æäº¤ã€æ¥å£é‡è¯•ã€å‰ç«¯çª—å£æŠ–åŠ¨ç­‰</p><p>ä¸šåŠ¡åœºæ™¯ï¼š</p><ol><li>ç”¨æˆ·å¤šæ¬¡ç‚¹å‡»æäº¤è®¢å•ï¼Œåå°åº”è¯¥åªç”Ÿæˆä¸€ä¸ªè®¢å•ã€‚</li><li>æ”¯ä»˜æ—¶ï¼Œç”±äºå‘ç”Ÿç½‘ç»œé—®é¢˜é‡è¯•ï¼Œåº”è¯¥åªæ‰£ä¸€æ¬¡é’±ã€‚</li></ol><p>ä¿è¯å¹‚ç­‰æ€§çš„æ ¸å¿ƒæ€æƒ³ï¼šé€šè¿‡å”¯ä¸€çš„ä¸šåŠ¡å•å·ä¿è¯å¹‚ç­‰ã€‚</p><p>å®ç°ï¼š</p><ul><li>éå¹¶å‘çš„æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢ä¸šåŠ¡å•å·æœ‰æ²¡æœ‰æ“ä½œè¿‡ï¼Œæ²¡æœ‰åˆ™æ‰§è¡Œæ“ä½œ</li><li>å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œæ•´ä¸ªè¿‡ç¨‹åŠ é”</li></ul><h1 id="2-å…·ä½“CRUDæ“ä½œçš„å¹‚ç­‰æ€§"><a href="#2-å…·ä½“CRUDæ“ä½œçš„å¹‚ç­‰æ€§" class="headerlink" title="2 å…·ä½“CRUDæ“ä½œçš„å¹‚ç­‰æ€§"></a>2 å…·ä½“CRUDæ“ä½œçš„å¹‚ç­‰æ€§</h1><h2 id="1-selectæ“ä½œçš„å¹‚ç­‰æ€§"><a href="#1-selectæ“ä½œçš„å¹‚ç­‰æ€§" class="headerlink" title="1. selectæ“ä½œçš„å¹‚ç­‰æ€§"></a>1. selectæ“ä½œçš„å¹‚ç­‰æ€§</h2><p>æŸ¥è¯¢æ“ä½œå¤©ç„¶å¹‚ç­‰ã€‚</p><h2 id="2-deleteæ“ä½œçš„å¹‚ç­‰æ€§"><a href="#2-deleteæ“ä½œçš„å¹‚ç­‰æ€§" class="headerlink" title="2 deleteæ“ä½œçš„å¹‚ç­‰æ€§"></a>2 deleteæ“ä½œçš„å¹‚ç­‰æ€§</h2><ul><li>æœ‰å”¯ä¸€çš„ä¸šåŠ¡å·ï¼Œå¦‚idã€‚<ul><li>ç¬¬ä¸€æ¬¡æ“ä½œï¼šæ ¹æ®å”¯ä¸€ä¸šåŠ¡å·åˆ é™¤</li><li>ç¬¬äºŒæ¬¡æ“ä½œï¼šç”±äºæ‰¾ä¸åˆ°è®°å½•ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›ã€‚å¯åœ¨åˆ é™¤å‰è¿›è¡Œæ•°æ®çš„æŸ¥è¯¢ã€‚</li></ul></li><li>æ²¡æœ‰å”¯ä¸€çš„ä¸šåŠ¡å·ï¼Œæ¯”å¦‚å°†å®¡æ ¸æœªé€šè¿‡çš„å•†å“åˆ é™¤ã€‚<ul><li>ç¬¬ä¸€æ¬¡æ“ä½œï¼šå°†æ‰€æœ‰å®¡æ ¸æœªé€šè¿‡çš„å•†å“åˆ é™¤</li><li>ç¬¬äºŒæ¬¡æ“ä½œå‰ï¼šåˆäº§ç”Ÿäº†æ–°çš„å®¡æ ¸æœªé€šè¿‡çš„å•†å“ã€‚è¿™æ—¶å€™éœ€è¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚å»å¤„ç†ï¼Œæ–°å¢çš„å®¡æ ¸æœªé€šè¿‡çš„å•†å“æ˜¯å¦éœ€è¦åˆ é™¤ã€‚</li></ul></li></ul><h2 id="3-updateæ“ä½œçš„å¹‚ç­‰æ€§"><a href="#3-updateæ“ä½œçš„å¹‚ç­‰æ€§" class="headerlink" title="3 updateæ“ä½œçš„å¹‚ç­‰æ€§"></a>3 updateæ“ä½œçš„å¹‚ç­‰æ€§</h2><p>updateæ“ä½œéœ€è¦åŒºåˆ†åœºæ™¯ï¼š</p><ul><li><p>æ¯”å¦‚æ˜¯setå»æ›´æ–°ï¼Œé‚£ä¹ˆå¤šæ¬¡setä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜</p></li><li><p>å¦‚æœæ˜¯åœ¨å½“å‰åŸºç¡€ä¸Šè‡ªå¢ï¼Œé‚£ä¹ˆå°±éœ€è¦å¤„ç† ï¼Œåˆ†åœºæ™¯ï¼š</p><ul><li><p>æœ‰å”¯ä¸€çš„ä¸šåŠ¡å·ï¼Œå¦‚idã€‚æ›´æ–°æ“ä½œä¼ å…¥æ•°æ®ç‰ˆæœ¬å·ï¼Œé€šè¿‡ä¹è§‚é”å®ç°ã€‚</p><ul><li><p>æ•°æ®åº“å¢åŠ ç‰ˆæœ¬versionå­—æ®µï¼Œç”¨æˆ·åœ¨æŸ¥è¯¢å¹¶å±•ç¤ºå½“å‰æ•°æ®æ—¶ï¼Œå°†versionæ”¾å…¥éšè—åŸŸã€‚å½“ç”¨æˆ·ç‚¹å‡»æäº¤æ—¶ï¼Œå°†ç‰ˆæœ¬å·ä¹Ÿä¸€åŒæäº¤ã€‚</p></li><li><p>åå°å»åˆ¤æ–­ç‰ˆæœ¬å·ï¼Œå¹¶ä¸”è¿›è¡Œç‰ˆæœ¬å·+1æ“ä½œ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">update <span class="hljs-keyword">user</span> <span class="hljs-keyword">set</span> xxx<span class="hljs-operator">=</span>$&#123;xxx&#125;, version<span class="hljs-operator">=</span>$&#123;version&#125;<span class="hljs-operator">+</span><span class="hljs-number">1</span> <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span>xxx <span class="hljs-keyword">and</span> version<span class="hljs-operator">=</span>$&#123;version&#125;<br></code></pre></td></tr></table></figure></li></ul></li><li><p>æ²¡æœ‰å”¯ä¸€çš„ä¸šåŠ¡å·ï¼Œæ¯”å¦‚ç”¨æˆ·ç™»å½•ï¼Œæ³¨å†Œ</p><ul><li>é‡‡ç”¨tokenæœºåˆ¶</li></ul></li></ul></li></ul><h2 id="4-insertæ“ä½œçš„å¹‚ç­‰æ€§"><a href="#4-insertæ“ä½œçš„å¹‚ç­‰æ€§" class="headerlink" title="4 insertæ“ä½œçš„å¹‚ç­‰æ€§"></a>4 insertæ“ä½œçš„å¹‚ç­‰æ€§</h2><ul><li><p>æœ‰å”¯ä¸€çš„ä¸šåŠ¡å·ï¼Œå¦‚ç§’æ€åœºæ™¯ï¼Œå•†å“ID+ç”¨æˆ·IDã€‚</p><ul><li>è§£å†³æ–¹å¼ï¼šåˆ†å¸ƒå¼é”ä¸šåŠ¡æ‰§è¡Œå®Œæˆåï¼Œä¸è®©é”é‡Šæ”¾ï¼Œè€Œæ˜¯è®©å…¶è¿‡æœŸåé‡Šæ”¾ã€‚æ¯”å¦‚è®¾ç½®30sï¼Œåˆ™30så†…åªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹è·å–åˆ°é”ï¼Œå½“ç”¨æˆ·ç‚¹å‡»å¤šæ¬¡ï¼Œè§¦å‘äº†å…¶ä»–çº¿ç¨‹ï¼Œè·å–ä¸åˆ°é”ï¼Œç›´æ¥è¿”å›ã€‚</li></ul></li><li><p>æ²¡æœ‰å”¯ä¸€ä¸šåŠ¡å•å·ï¼Œä½¿ç”¨tokenä¿è¯å¹‚ç­‰ã€‚</p><ul><li><p>å…·ä½“æµç¨‹</p><ul><li><p>å½“ç”¨æˆ·è¿›å…¥æ³¨å†Œé¡µé¢æ—¶ï¼Œåç«¯ç”Ÿæˆä¸€ä¸ªéšæœºtokenï¼Œå®¢æˆ·ç«¯å°†tokenæ”¾åœ¨éšè—åŸŸä¸‹ï¼Œå¸¦ç€tokenæäº¤ã€‚ï¼ˆåˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œéœ€è¦ç±»ä¼¼åˆ†å¸ƒå¼IDçš„å¤„ç†æ–¹å¼ï¼Œä¿è¯tokenå”¯ä¸€ï¼‰</p></li><li><p>æ ¹æ®tokenå»è·å–åˆ†å¸ƒå¼é”ï¼Œå®Œæˆinsertåï¼Œä¸è®©é”é‡Šæ”¾ï¼Œè€Œæ˜¯è®©å…¶è¿‡æœŸåé‡Šæ”¾</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">insertUser</span><span class="hljs-params">(SysUser user, String token)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>  InterProcessMutex lock =  <span class="hljs-keyword">new</span> InterProcessMutex(zkClient, <span class="hljs-string">&quot;/&quot;</span>+token);<br>  val isLock = lock.acquire(<span class="hljs-number">30</span>, TimeUnit.SECONDS);<br>  <span class="hljs-keyword">if</span>(isLock)&#123;<br>    <span class="hljs-keyword">return</span> sysUserMapper.insert(user);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul></li></ul></li></ul><h2 id="5-æ··åˆæ“ä½œçš„å¹‚ç­‰æ€§"><a href="#5-æ··åˆæ“ä½œçš„å¹‚ç­‰æ€§" class="headerlink" title="5 æ··åˆæ“ä½œçš„å¹‚ç­‰æ€§"></a>5 æ··åˆæ“ä½œçš„å¹‚ç­‰æ€§</h2><p>æ‰¾åˆ°æ“ä½œçš„å”¯ä¸€ä¸šåŠ¡å•å·ï¼Œæœ‰åˆ™ä½¿ç”¨åˆ†å¸ƒå¼é”ï¼Œæ— åˆ™é€šè¿‡tokenä¿è¯</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>postgresql å¸¸ç”¨SQLæ•´ç†</title>
    <link href="/postgresql-%E6%9F%A5%E8%AF%A2%E5%88%A0%E9%99%A4%E9%87%8D%E5%A4%8D%E8%A1%8C/"/>
    <url>/postgresql-%E6%9F%A5%E8%AF%A2%E5%88%A0%E9%99%A4%E9%87%8D%E5%A4%8D%E8%A1%8C/</url>
    
    <content type="html"><![CDATA[<ol><li>åˆ é™¤idæœ€å°çš„é‡å¤è¡Œ</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> mes.stool_po <span class="hljs-keyword">where</span> id <span class="hljs-keyword">in</span>(<br>    <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MIN</span>(id) <span class="hljs-keyword">FROM</span> mes.stool_po <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> purchasing_doc_number, purchasing_doc_item_number <span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">COUNT</span>(id) <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span><br>)<br></code></pre></td></tr></table></figure><ol start="2"><li>æŸ¥è¯¢æ ¹æ®purchasing_doc_number, purchasing_doc_item_numberåˆ†ç»„åï¼Œé‡å¤çš„æ•°æ®id</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">array_agg</span>(id) <span class="hljs-keyword">FROM</span> mes.stool_po <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> purchasing_doc_number, purchasing_doc_item_number <span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">COUNT</span>(id) <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>docker</title>
    <link href="/docker/"/>
    <url>/docker/</url>
    
    <content type="html"><![CDATA[<h1 id="1-dockerè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#1-dockerè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="1 dockerè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>1 dockerè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h1><p>æ¯”å¦‚æˆ‘ä»¬ç°åœ¨å¼€å‘äº†ä¸€ä¸ªåº”ç”¨ç¨‹åºæ¯”å¦‚æ·˜å®Appï¼Œç¨‹åºå‘˜ä»å¤´åˆ°å°¾æ­å»ºäº†ä¸€å¥—ç¯å¢ƒå¼€å§‹å†™ä»£ç ï¼Œæ¯”å¦‚å®‰è£…JDKç­‰ï¼Œä»£ç å†™å®Œåéœ€è¦äº¤ç»™æµ‹è¯•åŒäº‹å»è¿è¡Œï¼Œè¿™äº‹æµ‹è¯•åŒå­¦ä¹Ÿéœ€è¦ä»å¤´åˆ°å°¾æ­å»ºä¸€å¥—ç¯å¢ƒï¼Œä½†æ¯”å¦‚JDKç‰ˆæœ¬å’Œä½ å®‰è£…çš„ä¸åŒï¼Œå¯¼è‡´æ— æ³•åœ¨æµ‹è¯•åŒå­¦çš„æœºå™¨ä¸Šè¿è¡Œèµ·æ¥ï¼Œæ‰¾å¼€å‘å»çœ‹é—®é¢˜ï¼Œæ­¤æ—¶å¼€å‘ä¹Ÿå¾ˆæ— è¾œï¼Œâ€œæ˜æ˜åœ¨æˆ‘çš„æœºå™¨ä¸Šæ˜¯å¯ä»¥è·‘èµ·æ¥çš„â€ã€‚</p><p>åœ¨æ²¡æœ‰å®¹å™¨æŠ€æœ¯ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ­å»ºè™šæ‹Ÿæœºï¼Œç„¶åæµ‹è¯•äººå‘˜å…‹éš†ä¸€ä¸ªåŒæ ·çš„è™šæ‹Ÿæœºã€‚</p><p>ä½†æ˜¯è™šæ‹Ÿæœºé‡Œé¢æ˜¯æœ‰ä¸€å¥—å®Œæ•´çš„æ“ä½œç³»ç»Ÿçš„ã€‚å•å•è¿è¡Œèµ·æ¥éƒ½éœ€è¦è€—è´¹å¾ˆå¤šèµ„æºã€‚æ¯”å¦‚æˆ‘ä»¬æ–°è£…çš„ç³»ç»Ÿï¼Œè¿˜æ²¡æœ‰è£…ä»»ä½•çš„è½¯ä»¶ï¼Œç£ç›˜å·²ç»è¢«å ç”¨äº†å¥½å‡ ä¸ªGï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•éƒ¨ç½²æ›´å¤šçš„åº”ç”¨ç¨‹åºï¼Œæ­¤å¤–ï¼Œæ“ä½œç³»ç»Ÿçš„å¯åŠ¨ä¹Ÿå¾ˆç¼“æ…¢ã€‚</p><p>å› æ­¤å‡ºç°äº†å®¹å™¨æŠ€æœ¯ã€‚å®¹å™¨å’Œé›†è£…ç®±åœ¨æ¦‚å¿µä¸Šæ˜¯å¾ˆç›¸ä¼¼çš„ã€‚éœ€è¦å®ç°éš”ç¦»ï¼Œä¹Ÿå°±æ˜¯å¤šä¸ªåº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ—¶äº’ç›¸ä¸å¹²æ‰°ã€‚</p><p>å®¹å™¨æŠ€æœ¯åªéš”ç¦»åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ç¯å¢ƒï¼Œä½†æ˜¯å…±äº«åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿã€‚è¿™é‡Œçš„è¿è¡Œæ—¶ç¯å¢ƒæŒ‡çš„æ˜¯ç¨‹åºè¿è¡Œä¾èµ–çš„å„ç§åº“ä»¥åŠé…ç½®ã€‚</p><p>å› æ­¤ï¼Œç›¸æ¯”è¾ƒè™šæ‹Ÿæœºï¼Œå®¹å™¨æ›´åŠ çš„è½»é‡ä¸”å ç”¨çš„èµ„æºæ›´å°‘ã€‚æˆ‘ä»¬å¯ä»¥éƒ¨ç½²æ›´å¤šçš„åº”ç”¨ç¨‹åºï¼ŒåŒæ—¶å¯åŠ¨çš„é€Ÿåº¦ä¹Ÿå¾ˆå¿«ã€‚</p><p>dockerå°±æ˜¯å®¹å™¨æŠ€æœ¯çš„ä¸€ç§å®ç°ã€‚</p><h1 id="2-dockeræ˜¯ä»€ä¹ˆ"><a href="#2-dockeræ˜¯ä»€ä¹ˆ" class="headerlink" title="2 dockeræ˜¯ä»€ä¹ˆ"></a>2 dockeræ˜¯ä»€ä¹ˆ</h1><p>dockeræ˜¯ä¸€ä¸ªç”¨Goè¯­è¨€å®ç°çš„å¼€æºé¡¹ç›®ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ–¹ä¾¿çš„åˆ›å»ºå’Œä½¿ç”¨å®¹å™¨ï¼Œdockerå°†ç¨‹åºä»¥åŠç¨‹åºæ‰€æœ‰çš„ä¾èµ–éƒ½æ‰“åŒ…åˆ°docker containerï¼Œè¿™æ ·ä½ çš„ç¨‹åºå¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒéƒ½ä¼šæœ‰ä¸€è‡´çš„è¡¨ç°ã€‚</p><p>è¿™é‡Œç¨‹åºè¿è¡Œçš„ä¾èµ–ä¹Ÿå°±æ˜¯å®¹å™¨å°±å¥½æ¯”é›†è£…ç®±ï¼Œå®¹å™¨æ‰€å¤„çš„æ“ä½œç³»ç»Ÿç¯å¢ƒå°±å¥½æ¯”è´§èˆ¹æˆ–æ¸¯å£ï¼Œ<strong>ç¨‹åºçš„è¡¨ç°åªå’Œé›†è£…ç®±æœ‰å…³ç³»(å®¹å™¨)ï¼Œå’Œé›†è£…ç®±æ”¾åœ¨å“ªä¸ªè´§èˆ¹æˆ–è€…å“ªä¸ªæ¸¯å£(æ“ä½œç³»ç»Ÿ)æ²¡æœ‰å…³ç³»</strong>ã€‚</p><p><strong>dockerçš„åº•å±‚å®ç°</strong></p><p>dockeråŸºäº<strong>Linuxå†…æ ¸</strong>æä¾›è¿™æ ·å‡ é¡¹åŠŸèƒ½å®ç°çš„ï¼š</p><ul><li><strong>NameSpace</strong>ï¼š æˆ‘ä»¬çŸ¥é“Linuxä¸­çš„PIDã€IPCã€ç½‘ç»œç­‰èµ„æºæ˜¯å…¨å±€çš„ï¼Œè€ŒNameSpaceæœºåˆ¶æ˜¯ä¸€ç§èµ„æºéš”ç¦»æ–¹æ¡ˆï¼Œåœ¨è¯¥æœºåˆ¶ä¸‹è¿™äº›èµ„æºå°±ä¸å†æ˜¯å…¨å±€çš„äº†ï¼Œè€Œæ˜¯å±äºæŸä¸ªç‰¹å®šçš„NameSpaceï¼Œå„ä¸ªNameSpaceä¸‹çš„èµ„æºäº’ä¸å¹²æ‰°ï¼Œè¿™å°±ä½¿å¾—æ¯ä¸ªNameSpaceçœ‹ä¸Šå»å°±åƒä¸€ä¸ªç‹¬ç«‹çš„æ“ä½œç³»ç»Ÿä¸€æ ·ï¼Œä½†æ˜¯åªæœ‰NameSpaceæ˜¯ä¸å¤Ÿã€‚</li><li><strong>Control groups</strong>ï¼šè™½ç„¶æœ‰äº†NameSpaceæŠ€æœ¯å¯ä»¥å®ç°èµ„æºéš”ç¦»ï¼Œä½†è¿›ç¨‹è¿˜æ˜¯å¯ä»¥ä¸å—æ§çš„è®¿é—®ç³»ç»Ÿèµ„æºï¼Œæ¯”å¦‚CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œç­‰ï¼Œä¸ºäº†æ§åˆ¶å®¹å™¨ä¸­è¿›ç¨‹å¯¹èµ„æºçš„è®¿é—®ï¼ŒDockeré‡‡ç”¨control groupsæŠ€æœ¯(ä¹Ÿå°±æ˜¯cgroup)ï¼Œæœ‰äº†cgroupå°±å¯ä»¥æ§åˆ¶å®¹å™¨ä¸­è¿›ç¨‹å¯¹ç³»ç»Ÿèµ„æºçš„æ¶ˆè€—äº†ï¼Œæ¯”å¦‚ä½ å¯ä»¥é™åˆ¶æŸä¸ªå®¹å™¨ä½¿ç”¨å†…å­˜çš„ä¸Šé™ã€å¯ä»¥åœ¨å“ªäº›CPUä¸Šè¿è¡Œç­‰ç­‰ã€‚</li></ul><h1 id="3-Dockerå®¹å™¨å’Œè™šæ‹Ÿæœºçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-Dockerå®¹å™¨å’Œè™šæ‹Ÿæœºçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. Dockerå®¹å™¨å’Œè™šæ‹Ÿæœºçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3. <strong>Dockerå®¹å™¨å’Œè™šæ‹Ÿæœºçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h1><p>Dockerå®¹å™¨åœ¨æ“ä½œç³»ç»Ÿçº§åˆ«è¿›è¡Œè™šæ‹ŸåŒ–ï¼Œå…±äº«å®¿ä¸»æœºçš„å†…æ ¸ã€‚</p><p>è™šæ‹Ÿæœºåœ¨ç¡¬ä»¶çº§åˆ«è¿›è¡Œè™šæ‹ŸåŒ–ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„å†…æ ¸ã€‚</p><p>å®¹å™¨é€šå¸¸æ›´è½»é‡çº§ã€å¯åŠ¨æ›´å¿«ï¼Œèµ„æºå ç”¨æ›´å°‘ã€‚</p><h1 id="4-ä»€ä¹ˆæ˜¯Dockeré•œåƒï¼Ÿ"><a href="#4-ä»€ä¹ˆæ˜¯Dockeré•œåƒï¼Ÿ" class="headerlink" title="4. ä»€ä¹ˆæ˜¯Dockeré•œåƒï¼Ÿ"></a>4. <strong>ä»€ä¹ˆæ˜¯Dockeré•œåƒï¼Ÿ</strong></h1><p>Dockeré•œåƒæ˜¯ä¸€ä¸ªè½»é‡çº§ã€åªè¯»çš„æ¨¡æ¿ï¼Œç”¨äºåˆ›å»ºDockerå®¹å™¨ã€‚å®ƒåŒ…å«è¿è¡Œå®¹å™¨æ‰€éœ€çš„ä»£ç ã€åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚</p><h1 id="5-Dockeré•œåƒå’Œå®¹å™¨ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#5-Dockeré•œåƒå’Œå®¹å™¨ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="5. Dockeré•œåƒå’Œå®¹å™¨ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>5. <strong>Dockeré•œåƒå’Œå®¹å™¨ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong></h1><p>Dockeré•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œç±»ä¼¼äºç±»ï¼›è€Œå®¹å™¨æ˜¯é•œåƒçš„å®ä¾‹ï¼Œç±»ä¼¼äºå¯¹è±¡ã€‚</p><h1 id="6-ä»€ä¹ˆæ˜¯-DockerFileï¼Ÿ"><a href="#6-ä»€ä¹ˆæ˜¯-DockerFileï¼Ÿ" class="headerlink" title="6. ä»€ä¹ˆæ˜¯ DockerFileï¼Ÿ"></a>6. ä»€ä¹ˆæ˜¯ DockerFileï¼Ÿ</h1><p>Dockerfile æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬éœ€è¦è¿è¡Œä»¥æ„å»º Docker æ˜ åƒçš„æ‰€æœ‰å‘½ä»¤ã€‚Docker ä½¿ç”¨ Dockerfile ä¸­çš„æŒ‡ä»¤è‡ªåŠ¨æ„å»ºé•œåƒã€‚æˆ‘ä»¬å¯ä»¥<code>docker build</code>ç”¨æ¥åˆ›å»ºæŒ‰é¡ºåºæ‰§è¡Œå¤šä¸ªå‘½ä»¤è¡ŒæŒ‡ä»¤çš„è‡ªåŠ¨æ„å»ºã€‚</p><h1 id="3-å®‰è£…ä¸‹è½½"><a href="#3-å®‰è£…ä¸‹è½½" class="headerlink" title="3 å®‰è£…ä¸‹è½½"></a>3 å®‰è£…ä¸‹è½½</h1><h2 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1. å®‰è£…"></a>1. å®‰è£…</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">brew cask install docker<br></code></pre></td></tr></table></figure><h2 id="2-ä¿®æ”¹é•œåƒæº"><a href="#2-ä¿®æ”¹é•œåƒæº" class="headerlink" title="2. ä¿®æ”¹é•œåƒæº"></a>2. ä¿®æ”¹é•œåƒæº</h2><p>è¿™é‡Œæ˜¯ç½‘æ˜“çš„é•œåƒæº</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs prolog"><span class="hljs-string">&quot;registry-mirrors&quot;</span>: [<br>   <span class="hljs-string">&quot;http://hub-mirror.c.163.com&quot;</span><br> ]<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230418145138450.png" alt="image-20230418145138450"></p><h1 id="4-dockerå®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†"><a href="#4-dockerå®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†" class="headerlink" title="4 dockerå®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†"></a>4 dockerå®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†</h1><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230418150102287.png" alt="image-20230418150102287"></p><ul><li><p>ä»é•œåƒä»“åº“ä¸­æ‹‰å–æˆ–è€…æ›´æ–°æŒ‡å®šé•œåƒ</p><p><code>docker pull nginx</code></p></li><li><p>åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ä½†ä¸å¯åŠ¨å®ƒ</p><p><code>docker create nginx</code></p></li><li><p>åˆ—å‡ºæ‰€æœ‰åœ¨è¿è¡Œçš„å®¹å™¨ä¿¡æ¯ã€‚</p><p><code>docker ps</code></p></li><li><p>æ˜¾ç¤ºæ‰€æœ‰çš„å®¹å™¨ï¼ŒåŒ…æ‹¬æœªè¿è¡Œçš„</p><p><code>docker ps -a</code><br><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230418151220544.png" alt="image-20230418151220544"></p></li><li><p>å¯åŠ¨ä¸€ä¸ªåœæ­¢çš„å®¹å™¨</p></li></ul><p>  <code>docker start d7e105501d1f</code></p><ul><li><p>ç™»å½•å®¹å™¨ï¼Œåœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤</p><p><code> docker exec -it d7e105501d1f /bin/bash</code></p></li><li><p>æš‚åœå®¹å™¨ä¸­æ‰€æœ‰çš„è¿›ç¨‹</p><p><code>docker pause d7e105501d1f</code></p></li><li><p>æ¢å¤å®¹å™¨ä¸­æ‰€æœ‰çš„è¿›ç¨‹ã€‚</p><p><code>docker unpause d7e105501d1f</code></p></li><li><p>åœæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨</p><p><code>docker stop d7e105501d1f</code></p></li><li><p>æ€æ‰ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ã€‚</p><p><code>docker kill d7e105501d1f</code></p></li><li><p>åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨</p><p><code>docker rm -f d7e105501d1f</code></p></li><li><p>åœ¨åå°å¯åŠ¨ä¸€ä¸ªå®¹å™¨</p><p><code>docker run -d redis</code></p></li><li><p>å¯åŠ¨ä¸€ä¸ªæ˜ å°„ç«¯å£çš„å®¹å™¨</p><p><code>docker run -p 80:80 -d nginx </code></p></li></ul><h1 id="5-dockeré•œåƒæ„å»º"><a href="#5-dockeré•œåƒæ„å»º" class="headerlink" title="5 dockeré•œåƒæ„å»º"></a>5 dockeré•œåƒæ„å»º</h1><ol><li><p>åˆ›å»ºå¹¶ç¼–è¾‘Dockerfile</p><p><code> vim Dockerfile</code></p></li></ol><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment">#Owner by Pan Yu Rou</span><br><span class="hljs-keyword">FROM</span> redis<br><span class="hljs-keyword">MAINTAINER</span> pyr<br><span class="hljs-keyword">RUN</span><span class="bash"> mkdir test01</span><br><span class="hljs-keyword">RUN</span><span class="bash"> touch test02</span><br><span class="hljs-keyword">COPY</span><span class="bash"> test3 .</span><br><span class="hljs-keyword">ADD</span><span class="bash"> test4.tar.gz .</span><br><span class="hljs-keyword">ENTRYPOINT</span><span class="bash"> [<span class="hljs-string">&quot;/bin/sh&quot;</span>]</span><br><span class="hljs-keyword">CMD</span><span class="bash"> [<span class="hljs-string">&quot;-c&quot;</span>,<span class="hljs-string">&quot;ls -l&quot;</span>]</span><br></code></pre></td></tr></table></figure><ol start="2"><li>åœ¨Dockerfileæ‰€åœ¨è·¯å¾„ä¸‹ï¼Œè¿è¡Œ<code>docker build -t your-image-name .</code></li></ol><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs ruby">âœ  docker_dir docker build -t mysh .<br>[+] Building <span class="hljs-number">0</span>.5s (<span class="hljs-number">10</span>/<span class="hljs-number">10</span>) FINISHED<br> =&gt; [internal] load build definition from Dockerfile                                                                                                                                                                                                                                              <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; transferring <span class="hljs-symbol">dockerfile:</span> 199B                                                                                                                                                                                                                                                              <span class="hljs-number">0</span>.0s<br> =&gt; [internal] load .dockerignore                                                                                                                                                                                                                                                                 <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; transferring <span class="hljs-symbol">context:</span> 2B                                                                                                                                                                                                                                                                   <span class="hljs-number">0</span>.0s<br> =&gt; [internal] load metadata for docker.io/library/<span class="hljs-symbol">redis:</span>latest                                                                                                                                                                                                                                   <span class="hljs-number">0</span>.0s<br> =&gt; [internal] load build context                                                                                                                                                                                                                                                                 <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; transferring <span class="hljs-symbol">context:</span> 176B                                                                                                                                                                                                                                                                 <span class="hljs-number">0</span>.0s<br> =&gt; [<span class="hljs-number">1</span>/<span class="hljs-number">5</span>] FROM docker.io/library/redis                                                                                                                                                                                                                                                            <span class="hljs-number">0</span>.0s<br> =&gt; [<span class="hljs-number">2</span>/<span class="hljs-number">5</span>] RUN mkdir test01                                                                                                                                                                                                                                                                        <span class="hljs-number">0</span>.2s<br> =&gt; [<span class="hljs-number">3</span>/<span class="hljs-number">5</span>] RUN touch test02                                                                                                                                                                                                                                                                        <span class="hljs-number">0</span>.1s<br> =&gt; [<span class="hljs-number">4</span>/<span class="hljs-number">5</span>] COPY test3 .                                                                                                                                                                                                                                                                            <span class="hljs-number">0</span>.0s<br> =&gt; [<span class="hljs-number">5</span>/<span class="hljs-number">5</span>] ADD test4.tar.gz .                                                                                                                                                                                                                                                                      <span class="hljs-number">0</span>.0s<br> =&gt; exporting to image                                                                                                                                                                                                                                                                            <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; exporting layers                                                                                                                                                                                                                                                                           <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; writing image <span class="hljs-symbol">sha256:</span>679e723aa319cdb9d1aeb923534c200b6ddb60eb9a87c8e7a3814145f716b3ff                                                                                                                                                                                                      <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; naming to docker.io/library/mysh<br></code></pre></td></tr></table></figure><ol start="3"><li>é€šè¿‡<code>docker run your-image-name</code>è¿è¡Œå®¹å™¨</li></ol><p>å¯ä»¥çœ‹åˆ°test01ï¼Œtest02ï¼Œ test4 éƒ½å·²ç»å‡ºç°åœ¨äº†å®¹å™¨ç›®å½•ä¸­ï¼Œå½“ä¸æŒ‡å®šå‚æ•°å‘½ä»¤è¿è¡Œæ—¶ï¼Œé»˜è®¤è¿è¡ŒCMDé‡Œé…ç½®çš„å‘½ä»¤ï¼Œå¦åˆ™æ‰§è¡Œå‚æ•°ä¸­çš„å‘½ä»¤</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs tap">âœ  docker_dir docker run mysh<br>total 8<br>drwxr-xr-x<span class="hljs-number"> 2 </span>root root   <span class="hljs-number"> 4096 </span>Apr<span class="hljs-number"> 18 </span>08:14 test01<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root      <span class="hljs-number"> 0 </span>Apr<span class="hljs-number"> 18 </span>08:14 test02<br>drwxr-xr-x<span class="hljs-number"> 2 </span><span class="hljs-number"> 501 </span>dialout<span class="hljs-number"> 4096 </span>Apr<span class="hljs-number"> 18 </span>08:11 test4<br></code></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">âœ  docker_dir docker <span class="hljs-built_in">run</span> mysh -c <span class="hljs-built_in">date</span><br>Tue Apr <span class="hljs-number">18</span> <span class="hljs-number">08</span>:<span class="hljs-number">16</span>:<span class="hljs-number">51</span> UTC <span class="hljs-number">2023</span><br></code></pre></td></tr></table></figure><h1 id="4-Dockerfileå¸¸ç”¨æŒ‡ä»¤"><a href="#4-Dockerfileå¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="4 Dockerfileå¸¸ç”¨æŒ‡ä»¤"></a>4 Dockerfileå¸¸ç”¨æŒ‡ä»¤</h1><ul><li><p><strong>FROM</strong>ï¼šå®šåˆ¶çš„é•œåƒéƒ½æ˜¯åŸºäº æŸä¸ª åŸºç¡€é•œåƒï¼Œè¿™é‡Œçš„FROMå°±æ˜¯æŒ‡å®šåŸºç¡€é•œåƒã€‚å› æ­¤åœ¨Dockerfileä¸­ï¼ŒFORMæ˜¯å¿…å¤‡æŒ‡ä»¤ï¼Œå¹¶ä¸”å¿…é¡»æ˜¯ç¬¬ä¸€æ¡æŒ‡ä»¤ã€‚</p></li><li><p><strong>RUN</strong>ï¼šç”¨äºæ‰§è¡Œåé¢è·Ÿç€çš„å‘½ä»¤è¡Œå‘½ä»¤ã€‚</p></li><li><p><strong>COPY</strong>: å¤åˆ¶æŒ‡ä»¤ï¼Œä»ä¸Šä¸‹æ–‡ç›®å½•ä¸­å¤åˆ¶æ–‡ä»¶æˆ–è€…ç›®å½•åˆ°å®¹å™¨é‡ŒæŒ‡å®šè·¯å¾„ã€‚</p></li><li><p><strong>ADD</strong>: ADD æŒ‡ä»¤å’Œ COPY çš„ä½¿ç”¨æ ¼ç±»ä¼¼ï¼ˆåŒæ ·éœ€æ±‚ä¸‹ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ COPYï¼‰ã€‚åŠŸèƒ½ä¹Ÿç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„å¦‚ä¸‹ï¼š</p><ul><li><p>ADD çš„ä¼˜ç‚¹ï¼šåœ¨æ‰§è¡Œ &lt;æºæ–‡ä»¶&gt; ä¸º tar å‹ç¼©æ–‡ä»¶çš„è¯ï¼Œå‹ç¼©æ ¼å¼ä¸º gzip, bzip2 ä»¥åŠ xz çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨å¤åˆ¶å¹¶è§£å‹åˆ° &lt;ç›®æ ‡è·¯å¾„&gt;ã€‚</p></li><li><p>ADD çš„ç¼ºç‚¹ï¼šåœ¨ä¸è§£å‹çš„å‰æä¸‹ï¼Œæ— æ³•å¤åˆ¶ tar å‹ç¼©æ–‡ä»¶ã€‚ä¼šä»¤é•œåƒæ„å»ºç¼“å­˜å¤±æ•ˆï¼Œä»è€Œå¯èƒ½ä¼šä»¤é•œåƒæ„å»ºå˜å¾—æ¯”è¾ƒç¼“æ…¢ã€‚å…·ä½“æ˜¯å¦ä½¿ç”¨ï¼Œå¯ä»¥æ ¹æ®æ˜¯å¦éœ€è¦è‡ªåŠ¨è§£å‹æ¥å†³å®šã€‚</p></li></ul></li><li><p><strong>CMD</strong>: </p><ul><li>ç±»ä¼¼äº RUN æŒ‡ä»¤ï¼Œç”¨äºè¿è¡Œç¨‹åºï¼Œä½†äºŒè€…è¿è¡Œçš„æ—¶é—´ç‚¹ä¸åŒ: CMD åœ¨docker run æ—¶è¿è¡Œï¼ŒRUN æ˜¯åœ¨ docker buildã€‚</li><li>CMD æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºå¯è¢« docker run å‘½ä»¤è¡Œå‚æ•°ä¸­æŒ‡å®šè¦è¿è¡Œçš„ç¨‹åºæ‰€è¦†ç›–ã€‚</li><li>å¦‚æœ Dockerfile ä¸­å¦‚æœå­˜åœ¨å¤šä¸ª CMD æŒ‡ä»¤ï¼Œä»…æœ€åä¸€ä¸ªç”Ÿæ•ˆã€‚</li></ul></li><li><p><strong>ENTRYPOINT</strong></p><ul><li>ç±»ä¼¼äº CMD æŒ‡ä»¤ï¼Œä½†å…¶ä¸ä¼šè¢« docker run çš„å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šçš„æŒ‡ä»¤æ‰€è¦†ç›–ï¼Œè€Œä¸”è¿™äº›å‘½ä»¤è¡Œå‚æ•°ä¼šè¢«å½“ä½œå‚æ•°é€ç»™ ENTRYPOINT æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºã€‚</li><li>å¦‚æœè¿è¡Œ docker run æ—¶ä½¿ç”¨äº† â€“entrypoint é€‰é¡¹ï¼Œå°†è¦†ç›– ENTRYPOINT æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºã€‚</li><li>å¦‚æœ Dockerfile ä¸­å¦‚æœå­˜åœ¨å¤šä¸ª ENTRYPOINT æŒ‡ä»¤ï¼Œä»…æœ€åä¸€ä¸ªç”Ÿæ•ˆã€‚</li></ul></li><li><p><strong>ENV</strong></p><ul><li><p>è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå®šä¹‰äº†ç¯å¢ƒå˜é‡ï¼Œé‚£ä¹ˆåœ¨åç»­çš„æŒ‡ä»¤ä¸­ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªç¯å¢ƒå˜é‡ã€‚</p></li><li><p>æ ¼å¼ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml">ENV <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span><br>ENV <span class="hljs-tag">&lt;<span class="hljs-name">key1</span>&gt;</span>=<span class="hljs-tag">&lt;<span class="hljs-name">value1</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">key2</span>&gt;</span>=<span class="hljs-tag">&lt;<span class="hljs-name">value2</span>&gt;</span>...<br></code></pre></td></tr></table></figure></li></ul></li><li><p><strong>ARG</strong></p><ul><li>æ„å»ºå‚æ•°ï¼Œä¸ ENV ä½œç”¨ä¸€è‡´ã€‚ä¸è¿‡ä½œç”¨åŸŸä¸ä¸€æ ·ã€‚ARG è®¾ç½®çš„ç¯å¢ƒå˜é‡ä»…å¯¹ Dockerfile å†…æœ‰æ•ˆï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰ docker build çš„è¿‡ç¨‹ä¸­æœ‰æ•ˆï¼Œæ„å»ºå¥½çš„é•œåƒå†…ä¸å­˜åœ¨æ­¤ç¯å¢ƒå˜é‡ã€‚</li><li>æ„å»ºå‘½ä»¤ docker build ä¸­å¯ä»¥ç”¨ â€“build-arg &lt;å‚æ•°å&gt;&#x3D;&lt;å€¼&gt; æ¥è¦†ç›–ã€‚</li><li>æ ¼å¼ï¼š<code>ARG &lt;å‚æ•°å&gt;[=&lt;é»˜è®¤å€¼&gt;]</code></li></ul></li><li><p><strong>EXPOSE</strong></p><ul><li>ä»…ä»…åªæ˜¯å£°æ˜ç«¯å£ã€‚</li></ul></li></ul><h1 id="6-dockeræ•°æ®æŒä¹…åŒ–"><a href="#6-dockeræ•°æ®æŒä¹…åŒ–" class="headerlink" title="6 dockeræ•°æ®æŒä¹…åŒ–"></a>6 dockeræ•°æ®æŒä¹…åŒ–</h1><p>æ‘†æ”¾æ•°æ®çš„æŒä¹…åŒ–å·æœ‰ä¸¤ç§å¸¸è§çš„ä½¿ç”¨æ–¹æ³•ï¼šBing mounts å’Œ Volume</p><h2 id="1-Bind-Mountsï¼ˆç‹©çŒæ¨¡å¼ï¼‰"><a href="#1-Bind-Mountsï¼ˆç‹©çŒæ¨¡å¼ï¼‰" class="headerlink" title="1. Bind Mountsï¼ˆç‹©çŒæ¨¡å¼ï¼‰"></a>1. Bind Mountsï¼ˆç‹©çŒæ¨¡å¼ï¼‰</h2><p>Bind mounts æ˜¯ç”±ç”¨æˆ·åœ¨ä¸»æœºä¸Šè¿›è¡Œé€‰æ‹©ç›®å½•è¿›è¡Œå­˜å‚¨ï¼Œæ–¹ä¾¿æŒ‡å®šç‰¹å®šæ–‡ä»¶æˆ–è€…ç›®å½•</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">docker run -v <span class="hljs-tag">&lt;<span class="hljs-name">host_path:</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">container_path</span>&gt;</span> -d <br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs awk">âœ  docker docker run -v <span class="hljs-variable">$PWD</span><span class="hljs-regexp">/data:/</span>data -d redis:<span class="hljs-number">3.2</span> redis-server<br>d7a6e3dccf100ea42bb1a8168dbf9ea27ed71b0b2837d19239f3eff8497fedd5<br>âœ  docker docker ps<br>CONTAINER ID   IMAGE       COMMAND                  CREATED         STATUS         PORTS      NAMES<br>d7a6e3dccf10   redis:<span class="hljs-number">3.2</span>   <span class="hljs-string">&quot;docker-entrypoint.sâ€¦&quot;</span>   <span class="hljs-number">5</span> seconds ago   Up <span class="hljs-number">4</span> seconds   <span class="hljs-number">6379</span>/tcp   quizzical_swartz<br><span class="hljs-number">2</span>e3ce4212a25   redis       <span class="hljs-string">&quot;docker-entrypoint.sâ€¦&quot;</span>   <span class="hljs-number">2</span> hours ago     Up <span class="hljs-number">2</span> hours     <span class="hljs-number">6379</span>/tcp   charming_ritchie<br>âœ  docker docker exec -it d7a6e3dccf10 <span class="hljs-regexp">/bin/</span>bash<br>root@d7a6e3dccf10:/data<span class="hljs-comment"># touch redis-logs</span><br>root@d7a6e3dccf10:/data<span class="hljs-comment"># exit</span><br><span class="hljs-keyword">exit</span><br>âœ  docker ls<br>data         dockerfile01 dockerfile02<br>âœ  docker cd data<br>âœ  data ls<br>redis-logs<br></code></pre></td></tr></table></figure><h2 id="2-Volumesï¼ˆé¶åœºæ¨¡å¼ï¼‰"><a href="#2-Volumesï¼ˆé¶åœºæ¨¡å¼ï¼‰" class="headerlink" title="2. Volumesï¼ˆé¶åœºæ¨¡å¼ï¼‰"></a>2. Volumesï¼ˆé¶åœºæ¨¡å¼ï¼‰</h2><p>è€ŒVolumeåˆ™ç»Ÿä¸€å°†æ•°æ®æ”¾åˆ°ä¸»æœºçš„ã€var&#x2F;lib&#x2F;docker&#x2F;volumesä¸‹ï¼Œåªèƒ½å¯¹åº”ç‰¹å®šç›®å½•ä¸‹çš„å­ç›®å½•ï¼Œä¸æ”¯æŒæ–‡ä»¶ï¼Œä½†æ˜¯ä¸å®¹æ˜“ä¹±ï¼Œé€‚åˆå°ç™½è¿›è¡Œä½¿ç”¨ã€‚ä¸¤ç§ä¸»æµvolumnçš„åˆ›å»ºæ–¹å¼ï¼š</p><ul><li><p>éšå¼åˆ›å»ºå·ï¼š<code>docker run -v &lt;container_path&gt; -d </code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk">âœ  docker docker run -v data2 -d redis:<span class="hljs-number">3.2</span> redis-server<br><span class="hljs-number">829</span>ea54fbaeef20c7ea1f3f1e3a82d5dd7f7a73d099c74b758926a14b2c4f5ca<br>âœ  docker docker ps<br>CONTAINER ID   IMAGE       COMMAND                  CREATED              STATUS              PORTS      NAMES<br><span class="hljs-number">829</span>ea54fbaee   redis:<span class="hljs-number">3.2</span>   <span class="hljs-string">&quot;docker-entrypoint.sâ€¦&quot;</span>   <span class="hljs-number">4</span> seconds ago        Up <span class="hljs-number">3</span> seconds        <span class="hljs-number">6379</span>/tcp   awesome_euclid<br>d7a6e3dccf10   redis:<span class="hljs-number">3.2</span>   <span class="hljs-string">&quot;docker-entrypoint.sâ€¦&quot;</span>   About a minute ago   Up About a minute   <span class="hljs-number">6379</span>/tcp   quizzical_swartz<br><span class="hljs-number">2</span>e3ce4212a25   redis       <span class="hljs-string">&quot;docker-entrypoint.sâ€¦&quot;</span>   <span class="hljs-number">2</span> hours ago          Up <span class="hljs-number">2</span> hours          <span class="hljs-number">6379</span>/tcp   charming_ritchie<br>âœ  docker docker exec -it <span class="hljs-number">829</span>ea54fbaee <span class="hljs-regexp">/bin/</span>bash<br>root@<span class="hljs-number">829</span>ea54fbaee:/data<span class="hljs-comment"># touch redis-log2</span><br>root@<span class="hljs-number">829</span>ea54fbaee:/data<span class="hljs-comment"># exit</span><br><span class="hljs-keyword">exit</span><br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">âœ  docker docker run -it --privileged --pid=host justincormack/nsenter1<br><br><span class="hljs-regexp">/ # cd var/</span>lib<span class="hljs-regexp">/docker/</span>volumes<span class="hljs-regexp">/b4778654451afef91ac2dbf8e6ce7881c065404ebc749d1bc7ea50fa93122e3d/</span>_data<br><span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/docker/</span>volumes<span class="hljs-regexp">/b4778654451afef91ac2dbf8e6ce7881c065404ebc749d1bc7ea50fa93122e3d/</span>_data <span class="hljs-comment"># ls</span><br>redis-log2<br></code></pre></td></tr></table></figure></li><li><p>æ˜¾å¼åˆ›å»ºå·ï¼š(å…ˆåˆ›å»ºå·ï¼Œå†åˆ›å»ºå®¹å™¨ç»‘å®šå·)        <code>docker volume create data3</code></p></li></ul><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs llvm"> âœ  docker docker volume create data<span class="hljs-number">3</span><br> âœ  docker docker run -v data<span class="hljs-number">3</span>:/data<span class="hljs-number">3</span> -d redis:<span class="hljs-number">3.2</span> redis-server<br>da<span class="hljs-number">981</span>af<span class="hljs-number">699805</span>bf<span class="hljs-number">18e87</span>ed<span class="hljs-number">7</span>d<span class="hljs-number">986e2</span>e<span class="hljs-number">9</span><span class="hljs-keyword">c</span><span class="hljs-number">6</span><span class="hljs-keyword">c</span><span class="hljs-number">08220</span><span class="hljs-keyword">c</span><span class="hljs-number">67</span>f<span class="hljs-number">111</span><span class="hljs-keyword">c</span><span class="hljs-number">136597</span><span class="hljs-keyword">c</span><span class="hljs-number">62</span>d<span class="hljs-number">15</span>f<span class="hljs-number">144</span><span class="hljs-keyword">c</span><br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">âœ  docker docker run -it --privileged --pid=host justincormack/nsenter1<br><span class="hljs-regexp">/ #  ls -ld /</span>var<span class="hljs-regexp">/lib/</span>docker<span class="hljs-regexp">/volumes/</span>data3<br>drwx-----x    <span class="hljs-number">3</span> root     root          <span class="hljs-number">4096</span> Apr <span class="hljs-number">18</span> <span class="hljs-number">09</span>:<span class="hljs-number">31</span> <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/docker/</span>volumes/data3<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230418170422909.png" alt="image-20230418170422909"></p><h1 id="7-Dockerä»“åº“"><a href="#7-Dockerä»“åº“" class="headerlink" title="7 Dockerä»“åº“"></a>7 Dockerä»“åº“</h1><p>ä»“åº“ï¼ˆRepositoryï¼‰æ˜¯é›†ä¸­å­˜æ”¾é•œåƒçš„åœ°æ–¹ã€‚ æ€»ä½“æ¥çœ‹Docker ä»“åº“å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p><ul><li>å…¬å…±ä»“åº“ï¼šæœ€ç»å…¸çš„å…¬å…±ä»“åº“å°±æ˜¯Docker Hubã€‚å½“Dockerè£…å¥½åï¼Œå…¶é»˜è®¤çš„é•œåƒæºå¤´å°±æ˜¯è¿™ä¸ªåŠŸèƒ½ä»“åº“ã€‚å½“è¿è¡ŒDocker runç­‰å‘½ä»¤æ—¶ç³»ç»Ÿä¼šè‡ªåŠ¨ä»Docker Hubä¸‹è½½ç°æœ‰é•œåƒåˆ°æœ¬åœ°ã€‚é™¤äº†Docker Hubä¹‹å¤–è¿˜æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹çš„å…¬å…±ä»“åº“ï¼Œå¯¹å¤–æä¾›æœåŠ¡ï¼Œæ¯”å¦‚Quayã€é˜¿é‡Œäº‘ç­‰ã€‚</li><li>ç§æœ‰ä»“åº“ï¼šç§æœ‰ä»“åº“æ˜¯äº’è”ç½‘ä¼ä¸šçš„ç”Ÿäº§ä¸­å¿ƒçš„å®é™…æ“ä½œä¸­çš„ä¸»æµé€‰æ‹©ã€‚ä¸é‡‡ç”¨å…¬å…±ä»“åº“é€šå¸¸å‡ºäºä»¥ä¸‹ä¸¤ä¸ªåŸå› ï¼š<ul><li>å…¬å…±ä»“åº“é€šå¸¸å»ºäºæµ·å¤–ï¼Œä¸‹è½½é€Ÿåº¦å—é™ï¼Œå¯¹äºå¤§é‡èŠ‚ç‚¹é¢‘ç¹æ›´æ–°çš„äº’è”ç½‘åº”ç”¨åœºæ™¯ä¸å¤ªå‹å¥½ã€‚</li><li>å…¬å…±ä»“åº“ä½äºå¤–ç½‘ï¼Œç›´æ¥å°†ç”Ÿäº§ä¸­å¿ƒçš„åº”ç”¨å’Œå¤–ç½‘ç›¸è¿ï¼Œå­˜åœ¨æ˜æ˜¾å®‰å…¨éšæ‚£ã€‚é»‘å®¢ç­‰å®¹æ˜“é€šè¿‡ç½‘ç»œæ¼æ´æ¸—é€åˆ°ä¼ä¸šå†…ç½‘ï¼›å¹¶ä¸”å…¬å…±ä»“åº“å†…çš„å®¹å™¨é•œåƒæœªé€šè¿‡ä¼ä¸šå†…éƒ¨çš„é™æ€æ–‡ä»¶æ‰«æï¼Œæ— æ³•ä¿è¯é•œåƒä¸­æ‰€é‡‡ç”¨çš„è¿è¡Œæ—¶å’Œä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚</li></ul></li></ul><h1 id="8-ä¿®æ”¹Dockeré»˜è®¤é•œåƒå’Œå®¹å™¨å­˜å‚¨ä½ç½®"><a href="#8-ä¿®æ”¹Dockeré»˜è®¤é•œåƒå’Œå®¹å™¨å­˜å‚¨ä½ç½®" class="headerlink" title="8 ä¿®æ”¹Dockeré»˜è®¤é•œåƒå’Œå®¹å™¨å­˜å‚¨ä½ç½®"></a>8 ä¿®æ”¹Dockeré»˜è®¤é•œåƒå’Œå®¹å™¨å­˜å‚¨ä½ç½®</h1><p><a href="https://so.csdn.net/so/search?q=Docker&spm=1001.2101.3001.7020">Docker</a> é»˜è®¤å®‰è£…çš„æƒ…å†µä¸‹ï¼Œä¼šä½¿ç”¨ <code>/var/lib/docker/</code> ç›®å½•ä½œä¸ºå­˜å‚¨ç›®å½•ï¼Œç”¨ä»¥å­˜æ”¾æ‹‰å–çš„é•œåƒå’Œåˆ›å»ºçš„å®¹å™¨ç­‰ã€‚ä¸è¿‡ç”±äºæ­¤ç›®å½•ä¸€èˆ¬éƒ½ä½äºç³»ç»Ÿç›˜ï¼Œé‡åˆ°ç³»ç»Ÿç›˜æ¯”è¾ƒå°ï¼Œè€Œé•œåƒå’Œå®¹å™¨å¤šäº†åå°±å®¹æ˜“ç£ç›˜ç©ºé—´ä¸è¶³</p><ul><li><p>æŸ¥çœ‹å½“å‰<a href="https://so.csdn.net/so/search?q=docker&spm=1001.2101.3001.7020">docker</a>çš„é»˜è®¤å­˜å‚¨ç›®å½• <code>docker info</code> ,é»˜è®¤ä¸º<code>/var/lib/docker/</code> </p></li><li><p>ç¼–è¾‘ <code>/etc/docker/daemon.json</code> æ–‡ä»¶</p><p><code>sudo vim /etc/docker/daemon.json </code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;data-root&quot;</span>: <span class="hljs-string">&quot;/home/docker&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>é‡å¯docker, å¹¶æŸ¥çœ‹ <code>docker info</code></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>docker</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å•ç‚¹ç™»å½•</title>
    <link href="/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/"/>
    <url>/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="1-è·¨åŸŸè®¤è¯çš„é—®é¢˜"><a href="#1-è·¨åŸŸè®¤è¯çš„é—®é¢˜" class="headerlink" title="1 è·¨åŸŸè®¤è¯çš„é—®é¢˜"></a>1 è·¨åŸŸè®¤è¯çš„é—®é¢˜</h1><p>äº’è”ç½‘æœåŠ¡ç¦»ä¸å¼€ç”¨æˆ·è®¤è¯ã€‚ä¸€èˆ¬æµç¨‹æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p><p>1ã€ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€ç”¨æˆ·åå’Œå¯†ç ã€‚</p><p>2ã€æœåŠ¡å™¨éªŒè¯é€šè¿‡åï¼Œåœ¨å½“å‰å¯¹è¯ï¼ˆsessionï¼‰é‡Œé¢ä¿å­˜ç›¸å…³æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·è§’è‰²ã€ç™»å½•æ—¶é—´ç­‰ç­‰ã€‚</p><p>3ã€æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›ä¸€ä¸ª session_idï¼Œå†™å…¥ç”¨æˆ·çš„ Cookieã€‚</p><p>4ã€ç”¨æˆ·éšåçš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½ä¼šé€šè¿‡ Cookieï¼Œå°† session_id ä¼ å›æœåŠ¡å™¨ã€‚</p><p>5ã€æœåŠ¡å™¨æ”¶åˆ° session_idï¼Œæ‰¾åˆ°å‰æœŸä¿å­˜çš„æ•°æ®ï¼Œç”±æ­¤å¾—çŸ¥ç”¨æˆ·çš„èº«ä»½ã€‚</p><p>è¿™ç§æ¨¡å¼çš„é—®é¢˜åœ¨äºï¼Œæ‰©å±•æ€§ï¼ˆscalingï¼‰ä¸å¥½ã€‚å•æœºå½“ç„¶æ²¡æœ‰é—®é¢˜ï¼Œå¦‚æœæ˜¯æœåŠ¡å™¨é›†ç¾¤ï¼Œæˆ–è€…æ˜¯è·¨åŸŸçš„æœåŠ¡å¯¼å‘æ¶æ„ï¼Œå°±è¦æ±‚ session æ•°æ®å…±äº«ï¼Œæ¯å°æœåŠ¡å™¨éƒ½èƒ½å¤Ÿè¯»å– sessionã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼ŒA ç½‘ç«™å’Œ B ç½‘ç«™æ˜¯åŒä¸€å®¶å…¬å¸çš„å…³è”æœåŠ¡ã€‚ç°åœ¨è¦æ±‚ï¼Œç”¨æˆ·åªè¦åœ¨å…¶ä¸­ä¸€ä¸ªç½‘ç«™ç™»å½•ï¼Œå†è®¿é—®å¦ä¸€ä¸ªç½‘ç«™å°±ä¼šè‡ªåŠ¨ç™»å½•ï¼Œè¯·é—®æ€ä¹ˆå®ç°ï¼Ÿ</p><ul><li>ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ session æ•°æ®æŒä¹…åŒ–ï¼Œå†™å…¥æ•°æ®åº“æˆ–åˆ«çš„æŒä¹…å±‚ã€‚å„ç§æœåŠ¡æ”¶åˆ°è¯·æ±‚åï¼Œéƒ½å‘æŒä¹…å±‚è¯·æ±‚æ•°æ®ã€‚è¿™ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯æ¶æ„æ¸…æ™°ï¼Œç¼ºç‚¹æ˜¯å·¥ç¨‹é‡æ¯”è¾ƒå¤§ã€‚å¦å¤–ï¼ŒæŒä¹…å±‚ä¸‡ä¸€æŒ‚äº†ï¼Œå°±ä¼šå•ç‚¹å¤±è´¥ã€‚</li><li>å¦ä¸€ç§æ–¹æ¡ˆæ˜¯æœåŠ¡å™¨ç´¢æ€§ä¸ä¿å­˜ session æ•°æ®äº†ï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½å‘å›æœåŠ¡å™¨ã€‚JWT å°±æ˜¯è¿™ç§æ–¹æ¡ˆçš„ä¸€ä¸ªä»£è¡¨ã€‚</li></ul><h1 id="2-JWTæ¦‚è¿°"><a href="#2-JWTæ¦‚è¿°" class="headerlink" title="2 JWTæ¦‚è¿°"></a>2 JWTæ¦‚è¿°</h1><p>JSON Web Tokenï¼ˆç¼©å†™ JWTï¼‰æ˜¯ç›®å‰æœ€æµè¡Œçš„è·¨åŸŸè®¤è¯è§£å†³æ–¹æ¡ˆï¼ŒJWT çš„åŸç†æ˜¯ï¼ŒæœåŠ¡å™¨è®¤è¯ä»¥åï¼Œç”Ÿæˆä¸€ä¸ª JSON å¯¹è±¡ï¼Œå‘å›ç»™ç”¨æˆ·ï¼Œå°±åƒä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>  <span class="hljs-string">&quot;å§“å&quot;</span>: <span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>,<br>  <span class="hljs-string">&quot;è§’è‰²&quot;</span>: <span class="hljs-string">&quot;ç®¡ç†å‘˜&quot;</span>,<br>  <span class="hljs-string">&quot;åˆ°æœŸæ—¶é—´&quot;</span>: <span class="hljs-string">&quot;2018å¹´7æœˆ1æ—¥0ç‚¹0åˆ†&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥åï¼Œç”¨æˆ·ä¸æœåŠ¡ç«¯é€šä¿¡çš„æ—¶å€™ï¼Œéƒ½è¦å‘å›è¿™ä¸ª JSON å¯¹è±¡ã€‚æœåŠ¡å™¨å®Œå…¨åªé è¿™ä¸ªå¯¹è±¡è®¤å®šç”¨æˆ·èº«ä»½ã€‚ä¸ºäº†é˜²æ­¢ç”¨æˆ·ç¯¡æ”¹æ•°æ®ï¼ŒæœåŠ¡å™¨åœ¨ç”Ÿæˆè¿™ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œä¼šåŠ ä¸Šç­¾åï¼ˆè¯¦è§åæ–‡ï¼‰ã€‚</p><p>æœåŠ¡å™¨å°±ä¸ä¿å­˜ä»»ä½• session æ•°æ®äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒæœåŠ¡å™¨å˜æˆæ— çŠ¶æ€äº†ï¼Œä»è€Œæ¯”è¾ƒå®¹æ˜“å®ç°æ‰©å±•</p><h1 id="3-JWT-çš„æ•°æ®ç»“æ„"><a href="#3-JWT-çš„æ•°æ®ç»“æ„" class="headerlink" title="3 JWT çš„æ•°æ®ç»“æ„"></a>3 JWT çš„æ•°æ®ç»“æ„</h1><p>å®é™…çš„ JWT å¤§æ¦‚å°±åƒä¸‹é¢è¿™æ ·ã€‚<a href="https://jwt.io/">https://jwt.io/</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230320140654212.png" alt="image-20230320140654212"></p><p>å®ƒæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œä¸­é—´ç”¨ç‚¹ï¼ˆ<code>.</code>ï¼‰åˆ†éš”æˆä¸‰ä¸ªéƒ¨åˆ†ã€‚ä¾æ¬¡æ˜¯ï¼š</p><ul><li>Headerï¼ˆå¤´éƒ¨ï¼‰ï¼šHeader éƒ¨åˆ†æ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œæè¿° JWT çš„å…ƒæ•°æ®ã€‚ä¸Šå›¾ä¸­ï¼Œ<code>alg</code>å±æ€§è¡¨ç¤ºç­¾åçš„ç®—æ³•ï¼ˆalgorithmï¼‰ï¼Œé»˜è®¤æ˜¯ HMAC SHA256ï¼ˆå†™æˆ HS256ï¼‰ï¼›<code>typ</code>å±æ€§è¡¨ç¤ºè¿™ä¸ªä»¤ç‰Œï¼ˆtokenï¼‰çš„ç±»å‹ï¼ˆtypeï¼‰ï¼ŒJWT ä»¤ç‰Œç»Ÿä¸€å†™ä¸º<code>JWT</code>ã€‚</li><li>Payloadï¼ˆè´Ÿè½½ï¼‰ï¼šPayload éƒ¨åˆ†ä¹Ÿæ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œç”¨æ¥å­˜æ”¾å®é™…éœ€è¦ä¼ é€’çš„æ•°æ®ã€‚é™¤äº†å®˜æ–¹å­—æ®µï¼Œä½ è¿˜å¯ä»¥åœ¨è¿™ä¸ªéƒ¨åˆ†å®šä¹‰ç§æœ‰å­—æ®µ</li><li>Signatureï¼ˆç­¾åï¼‰ï¼šSignature éƒ¨åˆ†æ˜¯å¯¹å‰ä¸¤éƒ¨åˆ†çš„ç­¾åï¼Œé˜²æ­¢æ•°æ®ç¯¡æ”¹ã€‚é¦–å…ˆï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªå¯†é’¥ï¼ˆsecretï¼‰ã€‚è¿™ä¸ªå¯†é’¥åªæœ‰æœåŠ¡å™¨æ‰çŸ¥é“ï¼Œä¸èƒ½æ³„éœ²ç»™ç”¨æˆ·ã€‚ç„¶åï¼Œä½¿ç”¨ Header é‡Œé¢æŒ‡å®šçš„ç­¾åç®—æ³•ï¼ˆé»˜è®¤æ˜¯ HMAC SHA256ï¼‰ï¼ŒæŒ‰ç…§ä¸‹é¢çš„å…¬å¼äº§ç”Ÿç­¾åã€‚</li></ul><p>ç®—å‡ºç­¾åä»¥åï¼ŒæŠŠ Headerã€Payloadã€Signature ä¸‰ä¸ªéƒ¨åˆ†æ‹¼æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¹‹é—´ç”¨â€ç‚¹â€ï¼ˆ<code>.</code>ï¼‰åˆ†éš”ï¼Œå°±å¯ä»¥è¿”å›ç»™ç”¨æˆ·ã€‚</p><p><strong>Base64URL</strong></p><p>Header å’Œ Payload ä¸²å‹åŒ–çš„ç®—æ³•æ˜¯ Base64URLã€‚è¿™ä¸ªç®—æ³•è·Ÿ Base64 ç®—æ³•åŸºæœ¬ç±»ä¼¼ï¼Œä½†æœ‰ä¸€äº›å°çš„ä¸åŒã€‚</p><p>JWT ä½œä¸ºä¸€ä¸ªä»¤ç‰Œï¼ˆtokenï¼‰ï¼Œæœ‰äº›åœºåˆå¯èƒ½ä¼šæ”¾åˆ° URLï¼ˆæ¯”å¦‚ api.example.com&#x2F;?token&#x3D;xxxï¼‰ã€‚Base64 æœ‰ä¸‰ä¸ªå­—ç¬¦<code>+</code>ã€<code>/</code>å’Œ<code>=</code>ï¼Œåœ¨ URL é‡Œé¢æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œæ‰€ä»¥è¦è¢«æ›¿æ¢æ‰ï¼š<code>=</code>è¢«çœç•¥ã€<code>+</code>æ›¿æ¢æˆ<code>-</code>ï¼Œ<code>/</code>æ›¿æ¢æˆ<code>_</code> ã€‚è¿™å°±æ˜¯ Base64URL ç®—æ³•ã€‚</p><h1 id="4-JWT-çš„ä½¿ç”¨æ–¹å¼"><a href="#4-JWT-çš„ä½¿ç”¨æ–¹å¼" class="headerlink" title="4 JWT çš„ä½¿ç”¨æ–¹å¼"></a>4 JWT çš„ä½¿ç”¨æ–¹å¼</h1><p>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„ JWTï¼Œå¯ä»¥å‚¨å­˜åœ¨ Cookie é‡Œé¢ï¼Œä¹Ÿå¯ä»¥å‚¨å­˜åœ¨ localStorageã€‚</p><p>æ­¤åï¼Œå®¢æˆ·ç«¯æ¯æ¬¡ä¸æœåŠ¡å™¨é€šä¿¡ï¼Œéƒ½è¦å¸¦ä¸Šè¿™ä¸ª JWTã€‚ä½ å¯ä»¥æŠŠå®ƒæ”¾åœ¨ Cookie é‡Œé¢è‡ªåŠ¨å‘é€ï¼Œä½†æ˜¯è¿™æ ·ä¸èƒ½è·¨åŸŸï¼Œæ‰€ä»¥æ›´å¥½çš„åšæ³•æ˜¯æ”¾åœ¨ HTTP è¯·æ±‚çš„å¤´ä¿¡æ¯<code>Authorization</code>å­—æ®µé‡Œé¢ã€‚</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">Authorization:</span> Bearer <span class="hljs-params">&lt;token&gt;</span><br></code></pre></td></tr></table></figure><p>å¦ä¸€ç§åšæ³•æ˜¯ï¼Œè·¨åŸŸçš„æ—¶å€™ï¼ŒJWT å°±æ”¾åœ¨ POST è¯·æ±‚çš„æ•°æ®ä½“é‡Œé¢ã€‚</p><h1 id="5-JWTç‰¹ç‚¹"><a href="#5-JWTç‰¹ç‚¹" class="headerlink" title="5 JWTç‰¹ç‚¹"></a>5 JWTç‰¹ç‚¹</h1><p>ï¼ˆ1ï¼‰JWT é»˜è®¤æ˜¯ä¸åŠ å¯†ï¼Œä½†ä¹Ÿæ˜¯å¯ä»¥åŠ å¯†çš„ã€‚ç”ŸæˆåŸå§‹ Token ä»¥åï¼Œå¯ä»¥ç”¨å¯†é’¥å†åŠ å¯†ä¸€æ¬¡ã€‚</p><p>ï¼ˆ2ï¼‰JWT ä¸åŠ å¯†çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½å°†ç§˜å¯†æ•°æ®å†™å…¥ JWTã€‚</p><p>ï¼ˆ3ï¼‰JWT ä¸ä»…å¯ä»¥ç”¨äºè®¤è¯ï¼Œä¹Ÿå¯ä»¥ç”¨äºäº¤æ¢ä¿¡æ¯ã€‚æœ‰æ•ˆä½¿ç”¨ JWTï¼Œå¯ä»¥é™ä½æœåŠ¡å™¨æŸ¥è¯¢æ•°æ®åº“çš„æ¬¡æ•°ã€‚</p><p>ï¼ˆ4ï¼‰JWT çš„æœ€å¤§ç¼ºç‚¹æ˜¯ï¼Œç”±äºæœåŠ¡å™¨ä¸ä¿å­˜ session çŠ¶æ€ï¼Œå› æ­¤æ— æ³•åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­åºŸæ­¢æŸä¸ª tokenï¼Œæˆ–è€…æ›´æ”¹ token çš„æƒé™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ JWT ç­¾å‘äº†ï¼Œåœ¨åˆ°æœŸä¹‹å‰å°±ä¼šå§‹ç»ˆæœ‰æ•ˆï¼Œé™¤éæœåŠ¡å™¨éƒ¨ç½²é¢å¤–çš„é€»è¾‘ã€‚</p><p>ï¼ˆ5ï¼‰JWT æœ¬èº«åŒ…å«äº†è®¤è¯ä¿¡æ¯ï¼Œä¸€æ—¦æ³„éœ²ï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—è¯¥ä»¤ç‰Œçš„æ‰€æœ‰æƒé™ã€‚ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT çš„æœ‰æ•ˆæœŸåº”è¯¥è®¾ç½®å¾—æ¯”è¾ƒçŸ­ã€‚å¯¹äºä¸€äº›æ¯”è¾ƒé‡è¦çš„æƒé™ï¼Œä½¿ç”¨æ—¶åº”è¯¥å†æ¬¡å¯¹ç”¨æˆ·è¿›è¡Œè®¤è¯ã€‚</p><p>ï¼ˆ6ï¼‰ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT ä¸åº”è¯¥ä½¿ç”¨ HTTP åè®®æ˜ç ä¼ è¾“ï¼Œè¦ä½¿ç”¨ HTTPS åè®®ä¼ è¾“ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>åˆ†å¸ƒå¼ID</title>
    <link href="/%E5%88%86%E5%B8%83%E5%BC%8FID/"/>
    <url>/%E5%88%86%E5%B8%83%E5%BC%8FID/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ID"><a href="#1-ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ID" class="headerlink" title="1. ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ID"></a>1. ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ID</h1><p>åœ¨å•ä½“ç»“æ„çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ MySQL æ•°æ®åº“çš„ä¸»é”®è‡ªå¢æ¥ä¸ºæˆ‘ä»¬çš„æ•°æ®è®¾ç½®å”¯ä¸€æ ‡è¯† IDï¼Œä½†æ˜¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œå•ä¸ªæ•°æ®åº“çš„ååé‡æˆä¸ºæ•´ä¸ªåº”ç”¨çš„æ€§èƒ½ç“¶é¢ˆï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­å»ºæ•°æ®åº“é›†ç¾¤æ¥æå‡æ•°æ®åº“çš„æ€§èƒ½ï¼Œæ­¤æ—¶å¦‚æœè¿˜ä½¿ç”¨ MySQL çš„ä¸»é”®è‡ªå¢æ¥è®¾ç½®æ•°æ® ID çš„è¯ï¼Œå°±ä¼šå‡ºç°é‡å¤çš„ IDï¼Œè¿™æ ·å°±ä¼šå‡ºç°ä¸»é”®å†²çªçš„æƒ…å†µã€‚</p><p>å¦‚æœä½¿ç”¨åˆ†å¸ƒå¼çš„å…¨å±€å”¯ä¸€ ID å°±ä¸ç”¨æ‹…å¿ƒä¼šå‡ºç°è¿™ä¸ªé—®é¢˜äº†</p><h1 id="2-åˆ†å¸ƒå¼ID"><a href="#2-åˆ†å¸ƒå¼ID" class="headerlink" title="2 åˆ†å¸ƒå¼ID"></a>2 åˆ†å¸ƒå¼ID</h1><p>ä¸€ä¸ªå¥½çš„åˆ†å¸ƒå¼IDï¼Œä¸€èˆ¬è¦æ»¡è¶³ä¸‹åˆ—ç‰¹æ€§ï¼š</p><ul><li><strong>å”¯ä¸€æ€§</strong>ï¼šä¿è¯å…¨å±€å”¯ä¸€</li><li><strong>é«˜å¯ç”¨</strong>ï¼Œå¯ä»¥ç”±ä¸»ä»ã€é›†ç¾¤ç­‰æ¨¡å¼ä¿è¯å¯ç”¨æ€§</li><li><strong>é«˜æ€§èƒ½</strong>ï¼Œæ¯”å¦‚åŸºäºå†…å­˜</li><li><strong>é€’å¢æ€§</strong>ï¼šé€‚åˆä½œä¸ºæ•°æ®åº“ç´¢å¼•</li><li><strong>å®‰å…¨æ€§</strong>ï¼šidå¦‚æœæ˜¯é¡ºåºé€’å¢ï¼Œåˆ™å®¹æ˜“æš´éœ²ä¸šåŠ¡ä¿¡æ¯</li></ul><h1 id="3-å…¨å±€å”¯ä¸€IDç”Ÿæˆç­–ç•¥"><a href="#3-å…¨å±€å”¯ä¸€IDç”Ÿæˆç­–ç•¥" class="headerlink" title="3 å…¨å±€å”¯ä¸€IDç”Ÿæˆç­–ç•¥"></a>3 å…¨å±€å”¯ä¸€IDç”Ÿæˆç­–ç•¥</h1><h3 id="1-æ•°æ®åº“è‡ªå¢ID"><a href="#1-æ•°æ®åº“è‡ªå¢ID" class="headerlink" title="1. æ•°æ®åº“è‡ªå¢ID"></a>1. æ•°æ®åº“è‡ªå¢ID</h3><p>åˆ©ç”¨æ•°æ®åº“çš„è‡ªå¢ä¸»é”®ç‰¹æ€§ï¼Œæ¯æ¬¡æ’å…¥è®°å½•æ—¶ï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„IDã€‚</p><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>ç®€å•æ˜“ç”¨ï¼Œç›´æ¥ä½¿ç”¨æ•°æ®åº“æä¾›çš„åŠŸèƒ½ã€‚</li><li>ä¿è¯å”¯ä¸€æ€§ã€‚</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>å­˜åœ¨å•ç‚¹æ•…éšœï¼Œæ•°æ®åº“æˆä¸ºç“¶é¢ˆã€‚</li><li>è€ƒè™‘æ•°æ®é‡å¤§æ—¶ï¼Œå¯èƒ½éœ€è¦åˆ†åº“åˆ†è¡¨.</li></ul><h3 id="2-UUIDï¼ˆUniversally-Unique-Identifierï¼‰"><a href="#2-UUIDï¼ˆUniversally-Unique-Identifierï¼‰" class="headerlink" title="2. UUIDï¼ˆUniversally Unique Identifierï¼‰"></a>2. UUIDï¼ˆUniversally Unique Identifierï¼‰</h3><p>UUID æ˜¯ä¸€ç§æ ‡å‡†çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œé€šå¸¸ä¸º128ä½é•¿ï¼Œå¯ä»¥ä¿è¯å…¨å±€å”¯ä¸€æ€§ã€‚åœ¨ Java ä¸­å¯ä»¥ä½¿ç”¨ java.util.UUID çš„ randomUUID() æ–¹æ³•æ¥è·å¾—ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">java.util.UUID.randomUUID().toString();<br></code></pre></td></tr></table></figure><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>ç”Ÿæˆç®€å•ï¼Œä¸ä¾èµ–ä¸­å¿ƒåŒ–æœåŠ¡ã€‚</li><li>å”¯ä¸€æ€§å¼ºã€‚</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>è¾ƒé•¿ï¼Œå ç”¨ç©ºé—´å¤§ï¼Œä¸é€‚åˆä½œä¸ºæ•°æ®åº“ç´¢å¼•ã€‚</li><li>æ— åºï¼Œæ— æ³•å®ç°èŒƒå›´æŸ¥è¯¢</li><li>æ’å…¥æ—¶éœ€è¦ç»´æŠ¤Bï¼‹æ ‘ï¼Œè€ŒBï¼‹æ ‘æ˜¯æœ‰åºçš„ï¼Œå› æ­¤æ’å…¥æ“ä½œçš„æ€§èƒ½æ¯”è‡ªå¢IDè¦å·®ï¼Œæœ‰äº›åšå®¢æµ‹è¯„æ’å…¥æ€§èƒ½è¦å·®ï¼”å€</li></ul><blockquote><p>å»ºè®®ç”¨è‡ªå¢IDä½œä¸ºä¸»é”®ï¼Œä¸šåŠ¡ä¸Šé‡‡å–UUIDä½œä¸ºå”¯ä¸€æ ‡è¯†</p></blockquote><h3 id="3-Twitterçš„Snowflakeç®—æ³•"><a href="#3-Twitterçš„Snowflakeç®—æ³•" class="headerlink" title="3. Twitterçš„Snowflakeç®—æ³•"></a>3. Twitterçš„Snowflakeç®—æ³•</h3><p>Snowflake æ˜¯ Twitter å¼€æºçš„åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•ï¼Œé€šè¿‡ç»„åˆæ—¶é—´æˆ³ã€æœºå™¨IDå’Œåºåˆ—å·ç”ŸæˆIDã€‚</p><p><strong>IDç»“æ„</strong>ï¼š</p><ul><li>1ä½ç¬¦å·ä½ï¼šå§‹ç»ˆä¸º0ã€‚</li><li>41ä½æ—¶é—´æˆ³ï¼šæ¯«ç§’çº§æ—¶é—´æˆ³ï¼Œå¯ä½¿ç”¨69å¹´ã€‚</li><li>10ä½æœºå™¨IDï¼šæ”¯æŒ1024å°æœºå™¨ã€‚</li><li>12ä½åºåˆ—å·ï¼šæ¯æ¯«ç§’æ”¯æŒç”Ÿæˆ4096ä¸ªIDã€‚</li></ul><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>é«˜æ€§èƒ½ï¼Œä½å»¶è¿Ÿã€‚</li><li>æ—¶é—´æœ‰åºç”Ÿæˆï¼Œé€‚åˆæ•°æ®åº“ç´¢å¼•ã€‚</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>ä¾èµ–æœºå™¨æ—¶é—´ï¼Œæ—¶é’Ÿå›æ‹¨å¯èƒ½å¯¼è‡´IDé‡å¤æˆ–å†²çªã€‚</li></ul><blockquote><p>æ—¶é’Ÿå›æ‹¨é—®é¢˜ï¼Œåœ¨ä¸€äº›Snowflakeçš„å˜ç§å·²ç»è§£å†³æ‰äº†ï¼Œå¦‚ç™¾åº¦çš„uid-generator</p></blockquote><h3 id="4-ä½¿ç”¨Redisç”ŸæˆID"><a href="#4-ä½¿ç”¨Redisç”ŸæˆID" class="headerlink" title="4. ä½¿ç”¨Redisç”ŸæˆID"></a>4. ä½¿ç”¨Redisç”ŸæˆID</h3><p>åˆ©ç”¨Redisçš„åŸå­æ€§é€’å¢æ“ä½œï¼Œç”Ÿæˆåˆ†å¸ƒå¼å”¯ä¸€IDã€‚ä½¿ç”¨ Redis çš„ Incr å‘½ä»¤æ¥æŠŠ &lt;key,value&gt; ä¸­ key çš„æ•°å€¼åŠ  1 å¹¶è¿”å›ï¼Œå¦‚æœè¿™ä¸ª key ä¸å­˜åœ¨ï¼Œåˆ™ key å€¼ä¼šè¢«åˆå§‹åŒ–ä¸º 0ï¼Œå†æ‰§è¡Œ Incr å‘½ä»¤æ¥è¿›è¡ŒåŠ  1 æ“ä½œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä½¿ç”¨ incr(key) æ¥è®© key åŠ  1</span><br><span class="hljs-keyword">long</span> id = jedis.incr(<span class="hljs-string">&quot;id&quot;</span>);<br></code></pre></td></tr></table></figure><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>ç®€å•ï¼Œåˆ©ç”¨Redisçš„åŸå­æ“ä½œä¿è¯å”¯ä¸€æ€§ã€‚</li><li>æ€§èƒ½é«˜ï¼ŒRedisæ“ä½œé€Ÿåº¦å¿«ã€‚</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>ä¾èµ–RedisæœåŠ¡ï¼Œå¯èƒ½æˆä¸ºç“¶é¢ˆã€‚</li><li>éœ€è¦å¤„ç†Redisçš„æŒä¹…åŒ–å’Œé«˜å¯ç”¨æ€§ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>åˆ†å¸ƒå¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>jenkinséƒ¨ç½²vueé¡¹ç›®</title>
    <link href="/jenkins%E9%83%A8%E7%BD%B2vue%E9%A1%B9%E7%9B%AE/"/>
    <url>/jenkins%E9%83%A8%E7%BD%B2vue%E9%A1%B9%E7%9B%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="1-é…ç½®nodeJs"><a href="#1-é…ç½®nodeJs" class="headerlink" title="1 é…ç½®nodeJs"></a>1 é…ç½®nodeJs</h1><p>å› ä¸ºJenkinså®¹å™¨ä¸­åªæœ‰javaç¯å¢ƒæ”¯æŒè¿è¡Œjenkinsï¼Œæ²¡æœ‰nodeç¯å¢ƒï¼Œä½†æ˜¯jenkinsæä¾›åœ¨çº¿å®‰è£…nodejsã€‚<a href="https://plugins.jenkins.io/nodejs">å®˜æ–¹æ–‡æ¡£</a></p><ol><li>ç³»ç»Ÿç®¡ç†â€”&gt;ç®¡ç†æ’ä»¶â€”&gt;ä¸‹è½½NodeJSæ’ä»¶</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230315155958382.png" alt="image-20230315155958382"></p><ol start="2"><li>ç³»ç»Ÿç®¡ç†â€”&gt;å…¨å±€å·¥å…·é…ç½®â€”&gt;é€‰æ‹©éœ€è¦å®‰è£…çš„nodejsç‰ˆæœ¬</li></ol><p>Jenkins ä¼šä»nodejså®˜ç½‘ä¸‹è½½å®‰è£…ï¼Œnodejså®‰è£…åŒ…åœ¨ï¼š$JENKINS_HOME&#x2F;toolsç›®å½•ä¸‹</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230315155909887.png" alt="image-20230315155909887"></p><p>æ³¨ï¼šè¿™é‡Œä¹Ÿéœ€è¦é…ç½®git</p><h1 id="2-æ–°å»ºä¸€ä¸ªä»»åŠ¡"><a href="#2-æ–°å»ºä¸€ä¸ªä»»åŠ¡" class="headerlink" title="2 æ–°å»ºä¸€ä¸ªä»»åŠ¡"></a>2 æ–°å»ºä¸€ä¸ªä»»åŠ¡</h1><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230315160310957.png" alt="image-20230315160310957"></p><h1 id="3-é…ç½®ä»“åº“åœ°å€å’Œåˆ†æ”¯å"><a href="#3-é…ç½®ä»“åº“åœ°å€å’Œåˆ†æ”¯å" class="headerlink" title="3 é…ç½®ä»“åº“åœ°å€å’Œåˆ†æ”¯å"></a>3 é…ç½®ä»“åº“åœ°å€å’Œåˆ†æ”¯å</h1><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230315160535916.png" alt="image-20230315160535916"></p><h1 id="4-é…ç½®æ„å»ºç¯å¢ƒ"><a href="#4-é…ç½®æ„å»ºç¯å¢ƒ" class="headerlink" title="4 é…ç½®æ„å»ºç¯å¢ƒ"></a>4 é…ç½®æ„å»ºç¯å¢ƒ</h1><p>æ„å»ºç¯å¢ƒå‹¾é€‰ Provide Node &amp; npm bin&#x2F;folder to PATH</p><ul><li>æ¯æ¬¡buildï¼Œéƒ½ä¼šé¦–å…ˆæ‰§è¡Œç¯å¢ƒæ„å»ºï¼Œç¯å¢ƒæ„å»ºæ— è¯¯åï¼Œæ‰ä¼šå¼€å§‹çœŸæ­£çš„æ„å»ºè¿‡ç¨‹</li><li>ä¼šä¸‹è½½nodejså¹¶å®‰è£…é…ç½®ï¼Œå¹¶æŠŠnodeæ·»åŠ åˆ°å½“å‰PATHç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·å°±æ”¯æŒnodeå’Œnpmå‘½ä»¤äº†</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230315160620905.png" alt="image-20230315160620905"></p><h1 id="5-é…ç½®shell"><a href="#5-é…ç½®shell" class="headerlink" title="5 é…ç½®shell"></a>5 é…ç½®shell</h1><p>æ‰§è¡Œï¼š</p><p><code>npm install &amp;&amp; npm run build &amp;&amp; npm run domain &amp;&amp; npm run aliyun</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230322152124371.png" alt="image-20230322152124371"></p><p>è‡³æ­¤ï¼Œå¯ä»¥ç‚¹å‡»ç«‹å³æ„å»ºäº†</p><h1 id="6-é…ç½®è¿œç«¯æœåŠ¡å™¨"><a href="#6-é…ç½®è¿œç«¯æœåŠ¡å™¨" class="headerlink" title="6 é…ç½®è¿œç«¯æœåŠ¡å™¨"></a>6 é…ç½®è¿œç«¯æœåŠ¡å™¨</h1><p>æ³¨æ„ï¼šå¦‚æœä½¿ç”¨äº†echo,éœ€è¦å‹¾é€‰Verbose output in consoleæ‰å¯ä»¥åœ¨æ§åˆ¶å°ï¼Œçœ‹åˆ°æ‰“å°çš„æ—¥å¿—</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230324163338300.png" alt="image-20230324163338300"></p><h1 id="7-ä½¿ç”¨æ‰“å¥½çš„åŒ…æ›¿æ¢æœåŠ¡å™¨ä¸Šçš„åŒ…"><a href="#7-ä½¿ç”¨æ‰“å¥½çš„åŒ…æ›¿æ¢æœåŠ¡å™¨ä¸Šçš„åŒ…" class="headerlink" title="7 ä½¿ç”¨æ‰“å¥½çš„åŒ…æ›¿æ¢æœåŠ¡å™¨ä¸Šçš„åŒ…"></a>7 ä½¿ç”¨æ‰“å¥½çš„åŒ…æ›¿æ¢æœåŠ¡å™¨ä¸Šçš„åŒ…</h1><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230322154215106.png" alt="image-20230322154215106"></p><h1 id="8-é‡åˆ°çš„é—®é¢˜"><a href="#8-é‡åˆ°çš„é—®é¢˜" class="headerlink" title="8 é‡åˆ°çš„é—®é¢˜"></a>8 é‡åˆ°çš„é—®é¢˜</h1><p>è®°å½•ä¸‹åœ¨windowsæ­å»ºæ—¶é‡åˆ°çš„é—®é¢˜</p><ol><li>Cannot run program â€œshâ€ (in directory â€œC:\ProgramData\Jenkins.jenkins\workspace\sith-frontâ€): CreateProcess error&#x3D;2, ç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šçš„æ–‡ä»¶ã€‚</li></ol><p>è§£å†³ï¼šManage Jenkins-&gt; Configure System-&gt; Shell-&gt; Shell execute </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">C:\Windows\system32\cmd.exe<br></code></pre></td></tr></table></figure><ol start="2"><li><p>ssh:&#x2F;&#x2F;&#x2F;<a href="mailto:&#103;&#105;&#x74;&#64;&#103;&#x69;&#116;&#x65;&#101;&#46;&#99;&#111;&#x6d;">&#103;&#105;&#x74;&#64;&#103;&#x69;&#116;&#x65;&#101;&#46;&#99;&#111;&#x6d;</a>:SIEMENS_MMF&#x2F;MMF.git +refs&#x2F;heads&#x2F;<em>:refs&#x2F;remotes&#x2F;origin&#x2F;</em>â€œ returned status code 128:<br>stdout:<br>stderr: ssh: connect to host  port 22: Connection refused<br>fatal: Could not read from remote repository.</p><p>Please make sure you have the correct access rights<br>and the repository exists.</p></li></ol><p>åŸå› ï¼šJenkinsç½‘é¡µç™»å½•æ—¶ï¼Œsshè¿æ¥ä½¿ç”¨çš„æ˜¯Jenkinsè‡ªèº«çš„è´¦æˆ·ï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬ç™»å½•ç”µè„‘æ‰€ä½¿ç”¨çš„çš„è´¦æˆ·ï¼Œè¯¥è´¦æˆ·ä¸‹å¹¶æ²¡æœ‰sshè¿æ¥æ‰€éœ€è¦çš„rsaæ–‡ä»¶ï¼Œ</p><p>è§£å†³ï¼š</p><p>æˆåŠŸæ‰§è¡Œgit pullç­‰å‘½ä»¤çš„è´¦æˆ·ï¼Œåœ¨C:\Users\xxxxxx.sshç›®å½•ä¸‹ï¼ˆxxxxxxæ˜¯ç™»å½•ç”µè„‘çš„ç”¨æˆ·åï¼Œä¸æ˜¯gitçš„ç”¨æˆ·åï¼‰ï¼Œä¼šæœ‰id_rsaï¼Œid_rsa.pubï¼Œknown_hostsæ–‡ä»¶ï¼ŒæŠŠè¿™3ä¸ªæ–‡ä»¶æ‹·è´åˆ°C:\Windows\System32\config\systemprofile.sshç›®å½•ä¸‹ï¼Œå†æ‰§è¡Œjenkinså°±OKäº†</p>]]></content>
    
    
    <categories>
      
      <category>jenkins</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æƒé™</title>
    <link href="/%E6%9D%83%E9%99%90/"/>
    <url>/%E6%9D%83%E9%99%90/</url>
    
    <content type="html"><![CDATA[<p>![image-20230227215016860](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230227215016860.png)</p><p>![image-20230227215417463](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230227215417463.png)</p><p>![image-20230227215912534](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230227215912534.png)</p><p>![image-20230227220350015](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230227220350015.png) </p><p>![image-20230227221024772](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230227221024772.png)</p><p>![image-20230227221142243](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230227221142243.png)</p><p>![image-20230227221149342](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230227221149342.png)</p><ul><li>æƒé™ç›¸å…³æ›´æ–°è®°å½•è¡¨</li></ul><p>![image-20230227221806073](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230227221806073.png)</p><p>![image-20230227223420765](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230227223420765.png)</p><ul><li>nullè¢«ç´¢å¼•çš„è¯ï¼Œéœ€è¦é¢å¤–çš„ä¸€ä¸ªå­—èŠ‚</li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Shiroå…¥é—¨</title>
    <link href="/Shiro%E5%85%A5%E9%97%A8/"/>
    <url>/Shiro%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-shiro-æ¦‚å¿µ"><a href="#1-shiro-æ¦‚å¿µ" class="headerlink" title="1. shiro æ¦‚å¿µ"></a>1. shiro æ¦‚å¿µ</h1><ul><li><strong>Apache Shiroâ„¢</strong>æ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”æ˜“ç”¨çš„Javaå®‰å…¨æ¡†æ¶,èƒ½å¤Ÿç”¨äºèº«ä»½éªŒè¯ã€æˆæƒã€åŠ å¯†å’Œä¼šè¯ç®¡ç†</li><li>Shiroæ‹¥æœ‰æ˜“äºç†è§£çš„API,æ‚¨å¯ä»¥å¿«é€Ÿã€è½»æ¾åœ°è·å¾—ä»»ä½•åº”ç”¨ç¨‹åºâ€”â€”ä»æœ€å°çš„ç§»åŠ¨åº”ç”¨ç¨‹åºåˆ°æœ€å¤§çš„ç½‘ç»œå’Œä¼ä¸šåº”ç”¨ç¨‹åºã€‚</li></ul><h1 id="2-shiroä¼˜ç¼ºç‚¹"><a href="#2-shiroä¼˜ç¼ºç‚¹" class="headerlink" title="2. shiroä¼˜ç¼ºç‚¹"></a>2. shiroä¼˜ç¼ºç‚¹</h1><p>ä¼˜ç‚¹ï¼š </p><ul><li>æä¾›äº†ä¸€å¥—æ¡†æ¶ï¼Œæ˜“äºä½¿ç”¨</li><li>æ›´çµæ´»ï¼Œåº”å¯¹éœ€æ±‚èƒ½åŠ›å¼ºï¼Œwebèƒ½åŠ›å¼º</li><li>å¯ä¸å¾ˆå¤šæ¡†æ¶è¿›è¡Œé›†æˆ</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>æ“ä½œçš„ç•Œé¢éœ€è¦è‡ªå·±å®ç°</li></ul><h1 id="3-springbooté›†æˆshiro"><a href="#3-springbooté›†æˆshiro" class="headerlink" title="3 springbooté›†æˆshiro"></a>3 springbooté›†æˆshiro</h1><ol><li>å¼•å…¥ä¾èµ–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.shiro<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>shiro-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.shiro<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>shiro-spring<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><ol start="2"><li>åˆ›å»ºè‡ªå®šä¹‰AuthRealmå’Œå¯†ç æ ¡éªŒè§„åˆ™</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AuthRealm</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AuthorizingRealm</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserService userService;<br><br>    <span class="hljs-comment">// è®¤è¯ç™»å½•</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> AuthenticationInfo <span class="hljs-title">doGetAuthenticationInfo</span><span class="hljs-params">(AuthenticationToken token)</span> <span class="hljs-keyword">throws</span> AuthenticationException </span>&#123;<br>        UsernamePasswordToken usernamePasswordToken = (UsernamePasswordToken) token;<br>        String username = usernamePasswordToken.getUsername();<br>        User user = userService.findByUsername(username);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SimpleAuthenticationInfo(user, user.getPassword(), <span class="hljs-keyword">this</span>.getClass().getName());<br>    &#125;<br><br>    <span class="hljs-comment">// æˆæƒ</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> AuthorizationInfo <span class="hljs-title">doGetAuthorizationInfo</span><span class="hljs-params">(PrincipalCollection principals)</span> </span>&#123;<br>        User user = (User) principals.fromRealm(<span class="hljs-keyword">this</span>.getClass().getName()).iterator().next();<br>        List&lt;String&gt; permissionList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        List&lt;String&gt; roleNameList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        Set&lt;Role&gt; roleSet = user.getRoles();<br>        <span class="hljs-keyword">if</span> (CollectionUtils.isNotEmpty(roleSet)) &#123;<br>            <span class="hljs-keyword">for</span> (Role role : roleSet) &#123;<br>                roleNameList.add(role.getRname());<br>                Set&lt;Permission&gt; permissionSet = role.getPermissions();<br>                <span class="hljs-keyword">if</span> (CollectionUtils.isNotEmpty(permissionSet)) &#123;<br>                    <span class="hljs-keyword">for</span> (Permission permission : permissionSet) &#123;<br>                        permissionList.add(permission.getName());<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>        SimpleAuthorizationInfo info = <span class="hljs-keyword">new</span> SimpleAuthorizationInfo();<br>        info.addStringPermissions(permissionList);<br>        info.addRoles(roleNameList);<br>        <span class="hljs-keyword">return</span> info;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è‡ªå·±å®ç°å¯†ç æ ¡éªŒè§„åˆ™</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CredentialMatcher</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SimpleCredentialsMatcher</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">doCredentialsMatch</span><span class="hljs-params">(AuthenticationToken token, AuthenticationInfo info)</span> </span>&#123;<br>        UsernamePasswordToken usernamePasswordToken = (UsernamePasswordToken) token;<br>        String password = <span class="hljs-keyword">new</span> String(usernamePasswordToken.getPassword());<br>        String dbPassword = (String) info.getCredentials();<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.equals(password, dbPassword);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><ol start="3"><li>æ·»åŠ é…ç½®ç±»</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.shiro.demo1.config;<br><br><span class="hljs-keyword">import</span> com.pyr.shiro.demo1.shiro.AuthRealm;<br><span class="hljs-keyword">import</span> com.pyr.shiro.demo1.shiro.CredentialMatcher;<br><span class="hljs-keyword">import</span> org.apache.shiro.cache.MemoryConstrainedCacheManager;<br><span class="hljs-keyword">import</span> org.apache.shiro.mgt.SecurityManager;<br><span class="hljs-keyword">import</span> org.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor;<br><span class="hljs-keyword">import</span> org.apache.shiro.spring.web.ShiroFilterFactoryBean;<br><span class="hljs-keyword">import</span> org.apache.shiro.web.filter.mgt.DefaultFilter;<br><span class="hljs-keyword">import</span> org.apache.shiro.web.mgt.DefaultWebSecurityManager;<br><span class="hljs-keyword">import</span> org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-keyword">import</span> java.util.LinkedHashMap;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShiroConfiguration</span> </span>&#123;<br><br>    <span class="hljs-comment">//ShiroFilterè¿‡æ»¤æ‰€æœ‰è¯·æ±‚</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ShiroFilterFactoryBean <span class="hljs-title">shiroFilter</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;securityManager&quot;)</span> SecurityManager manager)</span> </span>&#123;<br>        ShiroFilterFactoryBean bean = <span class="hljs-keyword">new</span> ShiroFilterFactoryBean();<br>        bean.setSecurityManager(manager);<br>        bean.setFilterChainDefinitionMap(filterChainDefinitionMap);<br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;<br><br>    <span class="hljs-comment">// åˆ›å»ºå®‰å…¨ç®¡ç†å™¨</span><br>    <span class="hljs-meta">@Bean(&quot;securityManager&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> SecurityManager <span class="hljs-title">securityManager</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;authRealm&quot;)</span> AuthRealm authRealm)</span> </span>&#123;<br>        DefaultWebSecurityManager manager = <span class="hljs-keyword">new</span> DefaultWebSecurityManager();<br>        manager.setRealm(authRealm);<br>        <span class="hljs-keyword">return</span> manager;<br>    &#125;<br><br>    <span class="hljs-comment">// åˆ›å»ºè‡ªå®šä¹‰Realm</span><br>    <span class="hljs-meta">@Bean(&quot;authRealm&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> AuthRealm <span class="hljs-title">authRealm</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;credentialMatcher&quot;)</span> CredentialMatcher matcher)</span> </span>&#123;<br>        AuthRealm authRealm = <span class="hljs-keyword">new</span> AuthRealm();<br>        authRealm.setCacheManager(<span class="hljs-keyword">new</span> MemoryConstrainedCacheManager());<br>        authRealm.setCredentialsMatcher(matcher);<br>        <span class="hljs-keyword">return</span> authRealm;<br>    &#125;<br><br>    <span class="hljs-meta">@Bean(&quot;credentialMatcher&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> CredentialMatcher <span class="hljs-title">credentialMatcher</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CredentialMatcher();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * shiroå’Œspringçš„é…ç½®</span><br><span class="hljs-comment">     * è®¾ç½®springä½¿ç”¨çš„securityManageræ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„securityManager</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> AuthorizationAttributeSourceAdvisor <span class="hljs-title">authorizationAttributeSourceAdvisor</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;securityManager&quot;)</span> SecurityManager securityManager)</span> </span>&#123;<br>        AuthorizationAttributeSourceAdvisor advisor = <span class="hljs-keyword">new</span> AuthorizationAttributeSourceAdvisor();<br>        advisor.setSecurityManager(securityManager);<br>        <span class="hljs-keyword">return</span> advisor;<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> DefaultAdvisorAutoProxyCreator <span class="hljs-title">defaultAdvisorAutoProxyCreator</span><span class="hljs-params">()</span> </span>&#123;<br>        DefaultAdvisorAutoProxyCreator creator = <span class="hljs-keyword">new</span> DefaultAdvisorAutoProxyCreator();<br>        creator.setProxyTargetClass(<span class="hljs-keyword">true</span>);<br>        <span class="hljs-keyword">return</span> creator;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="4-ä½¿ç”¨"><a href="#4-ä½¿ç”¨" class="headerlink" title="4. ä½¿ç”¨"></a>4. ä½¿ç”¨</h1><p>ä»£ç åœ°å€ï¼š <a href="https://github.com/pyr9/springboot-shiro-demo">https://github.com/pyr9/springboot-shiro-demo</a></p>]]></content>
    
    
    <categories>
      
      <category>æƒé™ç®¡ç†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Shiro</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>automation</title>
    <link href="/automation/"/>
    <url>/automation/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="4737e9db48166e363d2061002b5612af526733c1145cda8f56211600a401dda6">ffda66bfab181c2acf199c136e56147374682d524a8b022b9f8c35ea0638a7c0e0109cd9ac79b3c6e509264a3591d85521fe71ab04726f7d774f359aa9951ac91825ad99409a0fd3ec64390c3d6caf8f1eb2abbc552db377af521e225afc37e8958a5041b099eed991b14eb697e2865b081ff53160752dab586928c2ba7d2bfb9aee0ae37e112dc9f09b26ff714fe72d7fdca6a34b00e70970391d7966c5ee05df481bf12df468d2465844ffe6346d94e33ff083d718f063357f3de6ac6cdfa711be4c847cdbd921037cec33930bd1bb0e75c00b9a2c68aab9c2e4ebfc626cdbc2a7b84f6651488e1f83d9e86740fd923851f0ddba20766726a263727c4151f5b3172dc0b028e92590f9fddf32da0a22fccd5355f786646167cb4a5b55cc1b6c788fdf4017864ee0dff6677dcbcd5f43525fa2f20f67398c0c8e1a1599d12e025f19dbcb20c371dd4cd806c7128a1dd911e55ac22d5475277a2a27388661a6ef291fda5b4185a1a3cbf878448928cbc7bc79f0687499937b19413710c1fd53c52d9e0d5b53a22174d1b111eaa092e07ef0c656a0dc5b1d9c5e7ec346df6cc6a220087f4b096a159a526fa7979dac0a9237e48275895cd74eaacac56f7af909381b307595dfd19e88ecebc5bbaa9de962878eda87780ef37affc78aea5eb6fea06849fe67858b57389b5ddbcb9e7548639d74833ddf88160e3f11b71355d648625f0ae18a5378ef3ea5b440e7951396ad2da355b5392bf120b98e1b21c59ba37b851135418165afc5b6e859e463addd68cad21a3b6968c43ef56bbe21803ed85b303f3c3887917cd17b05b391b45fd84592fd3675914789c3df69f0c063a5ad7fd65b654e547185118749ca71cfbd5bb69281f651fb1ee450c1848d01598efbc4b818fbbb76f6a868534bf0895f02c27b5c9c4f87d75509d8da1a0a897c9dccea8d66ccdbe2ee6b69c4a1cda016c228accbdecb6c7073aad66d62961de277ab04c484fae88cccd82b2b64011a9c25c6d707c4e4301415538a4ddec84ffc30f61c88a125f5cae92c7d986d7fbdeaaa136d3dacb0a25e52d7859e18ed746e83e03f29fa15b7c7f85c7e9b73ec03678674f01c8617e18088c1871ad06f9fa945d760f21d2d480438803be67c23a5e7dbf7157fd2c58f1e999c129f120186b7113e9c51fee473c42bb6f3cdd3d316ce8e61008eaf74cc86ed117f2eda9acdabb5b2d56d4c97b5878570795573db3b0cde9e8c9f8eb165c5602fa3ed4894806814d83c5dea8d17ff52033ad529d13bd82e2e185abd06a4fce0fdfbbf7b1afeda63dc520cf21bc9ba0414ad7fa9bc81dcd43204</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>SpringSecurity</title>
    <link href="/springSecurity/"/>
    <url>/springSecurity/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æƒé™ç®¡ç†"><a href="#1-æƒé™ç®¡ç†" class="headerlink" title="1. æƒé™ç®¡ç†"></a>1. æƒé™ç®¡ç†</h1><h2 id="1-1-ä¸ºä»€ä¹ˆéœ€è¦æƒé™ç®¡ç†"><a href="#1-1-ä¸ºä»€ä¹ˆéœ€è¦æƒé™ç®¡ç†" class="headerlink" title="1.1. ä¸ºä»€ä¹ˆéœ€è¦æƒé™ç®¡ç†"></a>1.1. ä¸ºä»€ä¹ˆéœ€è¦æƒé™ç®¡ç†</h2><ul><li>å®‰å…¨æ€§ï¼šè¯¯æ“ä½œã€è®¤ä¸ºç ´åã€æ•°æ®æ³„æ¼ç­‰</li><li>æ•°æ®éš”ç¦»ï¼šä¸åŒçš„æƒé™å¯ä»¥çœ‹åˆ°ä¸åŒçš„æ•°æ®</li><li>æ˜ç¡®èŒè´£ï¼šé”€å”®ã€å¼€å‘ç­‰ä¸åŒè§’è‰²ï¼Œleaderå’Œdevä¸åŒçº§åˆ«ï¼Œä¸åŒèŒè´£å¯ä»¥çœ‹åˆ°ä¸åŒçš„æ•°æ®</li></ul><h2 id="1-2-ç†æƒ³çš„æƒé™ç®¡ç†"><a href="#1-2-ç†æƒ³çš„æƒé™ç®¡ç†" class="headerlink" title="1.2. ç†æƒ³çš„æƒé™ç®¡ç†"></a>1.2. ç†æƒ³çš„æƒé™ç®¡ç†</h2><ul><li>èƒ½å®ç°è§’è‰²çº§æƒé™</li><li>èƒ½å®ç°åŠŸèƒ½çº§ã€æ•°æ®çº§æƒé™</li><li>ç®€å•ã€æ˜“æ“ä½œã€èƒ½å¤Ÿåº”å¯¹å„ç§éœ€æ±‚</li></ul><h1 id="2-SpringSecurity"><a href="#2-SpringSecurity" class="headerlink" title="2. SpringSecurity"></a>2. SpringSecurity</h1><h2 id="2-1-æ¦‚å¿µ"><a href="#2-1-æ¦‚å¿µ" class="headerlink" title="2.1.  æ¦‚å¿µ"></a>2.1.  æ¦‚å¿µ</h2><ul><li><p>Spring Security æ˜¯ Spring å®¶æ—ä¸­çš„ä¸€ä¸ª<strong>å®‰å…¨ç®¡ç†æ¡†æ¶</strong>ã€‚ç›¸æ¯”ä¸å¦å¤–ä¸€ä¸ªå®‰å…¨æ¡†æ¶Shiroï¼Œå®ƒæä¾›äº†æ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼Œç¤¾åŒºèµ„æºä¹Ÿæ¯”Shiroä¸°å¯Œã€‚</p></li><li><p>ä¸€èˆ¬æ¥è¯´ä¸­å¤§å‹çš„é¡¹ç›®éƒ½æ˜¯ä½¿ç”¨SpringSecurity æ¥åšå®‰å…¨æ¡†æ¶ã€‚å°é¡¹ç›®æœ‰Shiroçš„æ¯”è¾ƒå¤šï¼Œå› ä¸ºç›¸æ¯”ä¸SpringSecurityï¼ŒShiroçš„ä¸Šæ‰‹æ›´åŠ çš„ç®€å•ã€‚</p></li><li><p>ä¸€èˆ¬Webåº”ç”¨çš„éœ€è¦è¿›è¡Œè®¤è¯å’Œæˆæƒã€‚è€Œ<strong>è®¤è¯å’Œæˆæƒä¹Ÿæ˜¯SpringSecurityä½œä¸ºå®‰å…¨æ¡†æ¶çš„æ ¸å¿ƒåŠŸèƒ½</strong>ã€‚</p><ul><li>è®¤è¯ï¼šéªŒè¯å½“å‰è®¿é—®ç³»ç»Ÿçš„æ˜¯ä¸æ˜¯æœ¬ç³»ç»Ÿçš„ç”¨æˆ·ï¼Œå¹¶ä¸”è¦ç¡®è®¤å…·ä½“æ˜¯å“ªä¸ªç”¨æˆ·</li><li>æˆæƒï¼šç»è¿‡è®¤è¯ååˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰æƒé™è¿›è¡ŒæŸä¸ªæ“ä½œ</li></ul></li></ul><h2 id="2-2-ä¼˜ç‚¹å’Œç¼ºç‚¹"><a href="#2-2-ä¼˜ç‚¹å’Œç¼ºç‚¹" class="headerlink" title="2.2 ä¼˜ç‚¹å’Œç¼ºç‚¹"></a>2.2 ä¼˜ç‚¹å’Œç¼ºç‚¹</h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>æä¾›äº†å¾ˆå¤šç”¨æˆ·è®¤è¯çš„åŠŸèƒ½ï¼Œå®ç°ç›¸å…³æ¥å£å³å¯ï¼ŒèŠ‚çœäº†å¤§é‡å¼€å‘å·¥ä½œ</li><li>åŸºäºspringï¼Œæ˜“äºé›†æˆ</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>é…ç½®æ–‡ä»¶å¤šï¼Œè§’è‰²è¢« â€œç¼–ç â€ åˆ°é…ç½®æ–‡ä»¶å’Œæºæ–‡ä»¶ä¸­</li><li>å¯¹äºç³»ç»Ÿä¸­çš„ç”¨æˆ·ã€è§’è‰²ã€æƒé™ä¹‹é—´çš„å…³ç³»ï¼Œæ²¡æœ‰å¯æ“ä½œçš„ç•Œé¢ã€‚åå°ç®¡ç†å‘˜æ²¡åŠæ³•çŸ¥é“æ¯ä¸ªäººçš„è§’è‰²æƒé™æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œå¢å¤§äº†ç®¡ç†çš„éš¾åº¦å’Œåˆ†é…æƒé™çš„é”™è¯¯ç‡ã€‚</li><li>ç”±äºé…ç½®å¤šï¼Œæ²¡æœ‰å¯æ“ä½œçš„ç•Œé¢ï¼Œå¤§æ•°æ®é‡æƒ…å†µä¸‹ï¼ŒåŸºæœ¬ä¸å¯ç”¨ã€‚</li></ul><h2 id="2-3-springboot-æ•´åˆ-springSecurity"><a href="#2-3-springboot-æ•´åˆ-springSecurity" class="headerlink" title="2.3  springboot æ•´åˆ springSecurity"></a>2.3  springboot æ•´åˆ springSecurity</h2><ol><li>æ·»åŠ ä¾èµ–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><ol start="2"><li>æ·»åŠ é…ç½®æ–‡ä»¶</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.security.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.builders.WebSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableWebSecurity</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringSecurityConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebSecurityConfigurerAdapter</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        http.authorizeRequests()<br>                .antMatchers(<span class="hljs-string">&quot;/&quot;</span>).permitAll()<br>                .anyRequest().authenticated()<br>                .and()<br>                .logout().permitAll()<br>                .and()<br>                .formLogin();<br>        http.csrf().disable();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(WebSecurity web)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        web.ignoring().antMatchers(<span class="hljs-string">&quot;/js/**&quot;</span>, <span class="hljs-string">&quot;/css/**&quot;</span>, <span class="hljs-string">&quot;/images/**&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li>æµ‹è¯•</li></ol><p>æ ¹æ®é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å¾—çŸ¥ï¼Œæ‰€æœ‰äººå¯è®¿é—®â€&#x2F;â€œï¼Œå…¶ä»–è¯·æ±‚éƒ½éœ€è¦ç™»å½•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloController</span> </span>&#123;<br>    <span class="hljs-meta">@RequestMapping(&quot;/&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;index!&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">hello</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello springboot!&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æµ‹è¯•è®¿é—® â€œ&#x2F;â€œ è·¯å¾„</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230226185258468.png" alt="image-20230226185258468"></p><ul><li><p>æµ‹è¯•è®¿é—® â€œ&#x2F;helloâ€ ï¼Œä¼š302é‡å®šå‘åˆ°shiroæ¡†æ¶ï¼Œé»˜è®¤çš„loginç•Œé¢ï¼ˆä¾èµ–ç‰ˆæœ¬ä¸åŒï¼Œloginé¡µé¢ä¼šæœ‰å·®å¼‚ï¼‰</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230226185524573.png" alt="image-20230226185524573"></p></li></ul><h2 id="2-4-å­˜å‚¨ç”¨æˆ·ä¿¡æ¯"><a href="#2-4-å­˜å‚¨ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="2.4 å­˜å‚¨ç”¨æˆ·ä¿¡æ¯"></a>2.4 å­˜å‚¨ç”¨æˆ·ä¿¡æ¯</h2><h3 id="2-4-1-ç›´æ¥å­˜å‚¨åœ¨å†…å­˜ä¸­"><a href="#2-4-1-ç›´æ¥å­˜å‚¨åœ¨å†…å­˜ä¸­" class="headerlink" title="2.4.1 ç›´æ¥å­˜å‚¨åœ¨å†…å­˜ä¸­"></a>2.4.1 ç›´æ¥å­˜å‚¨åœ¨å†…å­˜ä¸­</h3><p>åœ¨SpringSecurityConfigï¼Œä¸­é‡å†™configureæ–¹æ³•ï¼ŒæŒ‡å®šç”¨æˆ·å’Œè§’è‰²ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(AuthenticationManagerBuilder auth)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>  auth.inMemoryAuthentication().passwordEncoder(<span class="hljs-keyword">new</span> BCryptPasswordEncoder()).withUser(<span class="hljs-string">&quot;admin&quot;</span>).password(<span class="hljs-keyword">new</span> BCryptPasswordEncoder().encode(<span class="hljs-string">&quot;111&quot;</span>)).roles(<span class="hljs-string">&quot;USER&quot;</span>);<br>  auth.inMemoryAuthentication().passwordEncoder(<span class="hljs-keyword">new</span> BCryptPasswordEncoder()).withUser(<span class="hljs-string">&quot;pyr&quot;</span>).password(<span class="hljs-keyword">new</span> BCryptPasswordEncoder().encode(<span class="hljs-string">&quot;pyr&quot;</span>)).roles(<span class="hljs-string">&quot;ADMIN&quot;</span>);<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="2-4-2-å­˜å‚¨åœ¨æ•°æ®åº“ä¸­"><a href="#2-4-2-å­˜å‚¨åœ¨æ•°æ®åº“ä¸­" class="headerlink" title="2.4.2 å­˜å‚¨åœ¨æ•°æ®åº“ä¸­"></a>2.4.2 å­˜å‚¨åœ¨æ•°æ®åº“ä¸­</h3><ol><li>å®šä¹‰UserServiceå®ç°UserDetailsService</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyUserService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserDetailsService</span> </span>&#123;<br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> UserMapper userMapper;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> UserDetails <span class="hljs-title">loadUserByUsername</span><span class="hljs-params">(String username)</span> <span class="hljs-keyword">throws</span> UsernameNotFoundException </span>&#123;<br>        <span class="hljs-keyword">return</span>  userMapper.findByUsername(username);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-5-ä½¿ç”¨è§’è‰²æ§åˆ¶æ–¹æ³•çš„è®¿é—®æƒé™"><a href="#2-5-ä½¿ç”¨è§’è‰²æ§åˆ¶æ–¹æ³•çš„è®¿é—®æƒé™" class="headerlink" title="2.5 ä½¿ç”¨è§’è‰²æ§åˆ¶æ–¹æ³•çš„è®¿é—®æƒé™"></a>2.5 ä½¿ç”¨è§’è‰²æ§åˆ¶æ–¹æ³•çš„è®¿é—®æƒé™</h2><ol><li>å½“ADMINè§’è‰²çš„ç”¨æˆ·è®¿é—®&#x2F;roleAuthæ—¶ï¼Œæ­£å¸¸è®¿é—®ã€‚å½“å…¶ä»–è§’è‰²ç”¨æˆ·ï¼Œè®¿é—®&#x2F;roleAuthæ—¶ï¼Œè¿”å›403</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// RoleVoter é‡Œå®šä¹‰äº†è§’è‰²åï¼Œä½¿ç”¨çš„æ—¶å€™ï¼Œéƒ½å¿…é¡»ä½¿ç”¨ROLE_ä½œä¸ºå‰ç¼€</span><br><span class="hljs-meta">@PreAuthorize(&quot;hasRole(&#x27;ROLE_ADMIN&#x27;)&quot;)</span><br><span class="hljs-meta">@RequestMapping(&quot;/roleAuth&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">role</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;admin Auth!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li>å½“å‰ç™»å½•çš„ç”¨æˆ·ï¼Œæœ‰ADMINæˆ–è€…MANAGERçš„è§’è‰²</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PreAuthorize(&quot;hasRole(&#x27;ROLE_ADMIN&#x27;) or hasRole(&#x27;ROLE_MANAGER&#x27;)&quot;)</span><br><span class="hljs-meta">@RequestMapping(&quot;/roleAuth2&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">role2</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;admin Auth  222!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li>ä¼ è¿‡æ¥çš„idå°äº10 ä¸” ä¼ è¿‡æ¥çš„userNameå’Œæ•°æ®åº“æŸ¥å‡ºæ¥çš„usernameç›¸ç­‰</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PreAuthorize(&quot;#id&lt; 10 and principal.username.equals(#username)&quot;)</span><br><span class="hljs-meta">@RequestMapping(&quot;/roleAuth3&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">role3</span><span class="hljs-params">(Integer id, String username)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;admin Auth  33!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»£ç åœ°å€ï¼š</p><p><a href="https://github.com/pyr9/springboot-security-demo">https://github.com/pyr9/springboot-security-demo</a></p>]]></content>
    
    
    <categories>
      
      <category>æƒé™ç®¡ç†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringSecurity</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Activitiâ€”â€”ç½‘å…³</title>
    <link href="/%E7%BD%91%E5%85%B3/"/>
    <url>/%E7%BD%91%E5%85%B3/</url>
    
    <content type="html"><![CDATA[<blockquote><p> ç½‘å…³ç”¨æ¥æ§åˆ¶æµç¨‹çš„æµå‘</p></blockquote><h1 id="1-æ’ä»–ç½‘å…³ExclusiveGateway"><a href="#1-æ’ä»–ç½‘å…³ExclusiveGateway" class="headerlink" title="1. æ’ä»–ç½‘å…³ExclusiveGateway"></a>1. æ’ä»–ç½‘å…³ExclusiveGateway</h1><h2 id="1-1-æ¦‚å¿µ"><a href="#1-1-æ¦‚å¿µ" class="headerlink" title="1.1 æ¦‚å¿µ"></a>1.1 æ¦‚å¿µ</h2><p>æ’ä»–ç½‘å…³ï¼Œç”¨æ¥åœ¨æµç¨‹ä¸­å®ç°å†³ç­–ã€‚ å½“æµç¨‹æ‰§è¡Œåˆ°è¿™ä¸ªç½‘å…³ï¼Œæ‰€æœ‰åˆ†æ”¯éƒ½ä¼šåˆ¤æ–­æ¡ä»¶æ˜¯å¦ä¸ºtrueï¼Œå¦‚æœä¸ºtrueåˆ™æ‰§è¡Œè¯¥åˆ†æ”¯ï¼Œæ’ä»–ç½‘å…³åªä¼šé€‰æ‹©ä¸€ä¸ªä¸ºtrueçš„åˆ†æ”¯æ‰§è¡Œã€‚å¦‚æœæœ‰ä¸¤ä¸ªåˆ†æ”¯æ¡ä»¶éƒ½ä¸ºtrueï¼Œæ’ä»–ç½‘å…³ä¼šé€‰æ‹©idå€¼è¾ƒå°çš„ä¸€æ¡åˆ†æ”¯å»æ‰§è¡Œã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦ç”¨æ’ä»–ç½‘å…³ï¼Ÿ</strong></p><p>ä¸ç”¨æ’ä»–ç½‘å…³ä¹Ÿå¯ä»¥å®ç°åˆ†æ”¯ï¼Œå¦‚ï¼šåœ¨è¿çº¿çš„conditionæ¡ä»¶ä¸Šè®¾ç½®åˆ†æ”¯æ¡ä»¶ã€‚</p><p>åœ¨è¿çº¿è®¾ç½®conditionæ¡ä»¶çš„ç¼ºç‚¹ï¼šå¦‚æœæ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œæµç¨‹å°±ç»“æŸäº†(æ˜¯å¼‚å¸¸ç»“æŸ)ã€‚å¦‚æœä»ç½‘å…³å‡ºå»çš„çº¿æ‰€æœ‰æ¡ä»¶éƒ½ä¸æ»¡è¶³åˆ™ç³»ç»ŸæŠ›å‡ºå¼‚å¸¸ã€‚</p><h2 id="1-2-æ¡ˆä¾‹"><a href="#1-2-æ¡ˆä¾‹" class="headerlink" title="1.2 æ¡ˆä¾‹"></a>1.2 æ¡ˆä¾‹</h2><p>å‡ºå·®ç”³è¯·å¤§äºç­‰äº3å¤©éœ€è¦å…ˆç”±æ€»ç»ç†å®¡æ‰¹å†ç”±è´¢åŠ¡å®¡æ‰¹ï¼Œå°äº3å¤©ç›´æ¥ç”±è´¢åŠ¡å®¡æ‰¹ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230213225917585.png" alt="image-20230213225917585"></p><p>æµ‹è¯•ï¼š</p><p>å½“éƒ¨é—¨ç»ç†å®¡æ‰¹åï¼Œå½“å‡ºå·®å¤©æ•°ä¸º5æ—¶ï¼Œä¼šæ ¹æ®æ¡ä»¶åˆ¤æ–­ï¼Œå½“å‰éœ€è¦èµ°ã€æ€»ç»ç†å®¡æ‰¹ã€‘ï¼Œå½“å‰ä»»åŠ¡è¡¨ï¼šSELECT * FROM act_ru_task   </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230213232953567.png" alt="image-20230213232953567"></p><p>ä¸Šå›¾ä¸­ï¼šåªæœ‰æ€»ç»ç†å®¡æ‰¹æ˜¯å½“å‰çš„ä»»åŠ¡åœ¨æ‰§è¡Œã€‚</p><h1 id="2-å¹¶è¡Œç½‘å…³ParallelGateway"><a href="#2-å¹¶è¡Œç½‘å…³ParallelGateway" class="headerlink" title="2. å¹¶è¡Œç½‘å…³ParallelGateway"></a>2. å¹¶è¡Œç½‘å…³ParallelGateway</h1><h2 id="2-1-æ¦‚å¿µ"><a href="#2-1-æ¦‚å¿µ" class="headerlink" title="2.1 æ¦‚å¿µ"></a>2.1 æ¦‚å¿µ</h2><ul><li><p>å¹¶è¡Œç½‘å…³å…è®¸å°†æµç¨‹åˆ†æˆå¤šæ¡åˆ†æ”¯ï¼Œä¹Ÿå¯ä»¥æŠŠå¤šæ¡åˆ†æ”¯æ±‡èšåˆ°ä¸€èµ·ã€‚</p></li><li><p>å¹¶è¡Œç½‘å…³çš„åŠŸèƒ½æ˜¯åŸºäºè¿›å…¥å’Œå¤–å‡ºé¡ºåºæµçš„ï¼š</p><ul><li><p>åˆ†æ”¯ï¼šå¹¶è¡Œåçš„æ‰€æœ‰å¤–å‡ºé¡ºåºæµï¼Œä¸ºæ¯ä¸ªé¡ºåºæµéƒ½åˆ›å»ºä¸€ä¸ªå¹¶å‘åˆ†æ”¯ã€‚</p></li><li><p>joinæ±‡èšï¼š æ‰€æœ‰åˆ°è¾¾å¹¶è¡Œç½‘å…³ï¼Œåœ¨æ­¤ç­‰å¾…çš„è¿›å…¥åˆ†æ”¯ï¼Œ ç›´åˆ°æ‰€æœ‰è¿›å…¥é¡ºåºæµçš„åˆ†æ”¯éƒ½åˆ°è¾¾ä»¥åï¼Œ æµç¨‹å°±ä¼šé€šè¿‡æ±‡èšç½‘å…³ã€‚</p></li></ul></li></ul><p>æ³¨æ„ï¼Œå¦‚æœåŒä¸€ä¸ªå¹¶è¡Œç½‘å…³æœ‰å¤šä¸ªè¿›å…¥å’Œå¤šä¸ªå¤–å‡ºé¡ºåºæµï¼Œ å®ƒå°±åŒæ—¶å…·æœ‰åˆ†æ”¯å’Œæ±‡èšåŠŸèƒ½ã€‚ è¿™æ—¶ï¼Œç½‘å…³ä¼šå…ˆæ±‡èšæ‰€æœ‰è¿›å…¥çš„é¡ºåºæµï¼Œç„¶åå†åˆ‡åˆ†æˆå¤šä¸ªå¹¶è¡Œåˆ†æ”¯ã€‚</p><p><strong>ä¸å…¶ä»–ç½‘å…³çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼Œå¹¶è¡Œç½‘å…³ä¸ä¼šè§£ææ¡ä»¶ã€‚</strong> <strong>å³ä½¿é¡ºåºæµä¸­å®šä¹‰äº†æ¡ä»¶ï¼Œä¹Ÿä¼šè¢«å¿½ç•¥ã€‚</strong></p><h2 id="2-2-æ¡ˆä¾‹"><a href="#2-2-æ¡ˆä¾‹" class="headerlink" title="2.2 æ¡ˆä¾‹"></a>2.2 æ¡ˆä¾‹</h2><p>å‡ºå·®ç”³è¯·ç”±éƒ¨é—¨ç»ç†å®¡æ‰¹åï¼Œéœ€è¦åŒæ—¶ç”±æ€»ç»ç†å®¡æ‰¹å’Œè´¢åŠ¡å®¡æ‰¹ï¼Œæ‰å¯ä»¥ç»“æŸã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230213230034272.png" alt="image-20230213230034272"></p><p>æµ‹è¯•ï¼š</p><p>å½“éƒ¨é—¨ç»ç†å®¡æ‰¹åï¼Œå½“å‰éœ€è¦èµ°ã€è´¢åŠ¡å®¡æ‰¹+æ€»ç»ç†å®¡æ‰¹ã€‘ï¼Œå½“å‰ä»»åŠ¡è¡¨ï¼šSELECT * FROM act_ru_task   </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230213231916621.png" alt="image-20230213231916621"></p><p>ä¸Šå›¾ä¸­ï¼šè´¢åŠ¡å®¡æ‰¹ã€æ€»ç»ç†å®¡æ‰¹ éƒ½æ˜¯å½“å‰çš„ä»»åŠ¡ï¼Œåœ¨å¹¶è¡Œæ‰§è¡Œã€‚</p><h1 id="3-åŒ…å«ç½‘å…³InclusiveGateway"><a href="#3-åŒ…å«ç½‘å…³InclusiveGateway" class="headerlink" title="3.åŒ…å«ç½‘å…³InclusiveGateway"></a>3.åŒ…å«ç½‘å…³InclusiveGateway</h1><h2 id="3-1-æ¦‚å¿µ"><a href="#3-1-æ¦‚å¿µ" class="headerlink" title="3.1 æ¦‚å¿µ"></a>3.1 æ¦‚å¿µ</h2><ul><li><p>åŒ…å«ç½‘å…³å¯ä»¥çœ‹åšæ˜¯æ’ä»–ç½‘å…³å’Œå¹¶è¡Œç½‘å…³çš„ç»“åˆä½“ã€‚ </p></li><li><p>å’Œæ’ä»–ç½‘å…³ä¸€æ ·ï¼Œä½ å¯ä»¥åœ¨å¤–å‡ºé¡ºåºæµä¸Šå®šä¹‰æ¡ä»¶ï¼ŒåŒ…å«ç½‘å…³ä¼šè§£æå®ƒä»¬ã€‚ ä½†æ˜¯ä¸»è¦çš„åŒºåˆ«æ˜¯åŒ…å«ç½‘å…³å¯ä»¥é€‰æ‹©å¤šäºä¸€æ¡é¡ºåºæµï¼Œè¿™å’Œå¹¶è¡Œç½‘å…³ä¸€æ ·ã€‚</p></li><li><p>åŒ…å«ç½‘å…³çš„åŠŸèƒ½æ˜¯åŸºäºè¿›å…¥å’Œå¤–å‡ºé¡ºåºæµçš„ï¼š</p><ul><li>åˆ†æ”¯ï¼šæ‰€æœ‰å¤–å‡ºé¡ºåºæµçš„æ¡ä»¶éƒ½ä¼šè¢«è§£æï¼Œç»“æœä¸ºtrueçš„é¡ºåºæµä¼šä»¥å¹¶è¡Œæ–¹å¼ç»§ç»­æ‰§è¡Œï¼Œ ä¼šä¸ºæ¯ä¸ªé¡ºåºæµåˆ›å»ºä¸€ä¸ªåˆ†æ”¯ã€‚</li><li>æ±‡èšï¼šæ‰€æœ‰å¹¶è¡Œåˆ†æ”¯åˆ°è¾¾åŒ…å«ç½‘å…³ï¼Œä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œ ç›´åˆ°æ¯ä¸ªåŒ…å«æµç¨‹tokençš„è¿›å…¥é¡ºåºæµçš„åˆ†æ”¯éƒ½åˆ°è¾¾ã€‚ è¿™æ˜¯ä¸å¹¶è¡Œç½‘å…³çš„æœ€å¤§ä¸åŒã€‚æ¢å¥è¯è¯´ï¼ŒåŒ…å«ç½‘å…³åªä¼šç­‰å¾…è¢«é€‰ä¸­æ‰§è¡Œäº†çš„è¿›å…¥é¡ºåºæµã€‚ åœ¨æ±‡èšä¹‹åï¼Œæµç¨‹ä¼šç©¿è¿‡åŒ…å«ç½‘å…³ç»§ç»­æ‰§è¡Œã€‚</li></ul></li></ul><h2 id="3-2-æ¡ˆä¾‹"><a href="#3-2-æ¡ˆä¾‹" class="headerlink" title="3.2 æ¡ˆä¾‹"></a>3.2 æ¡ˆä¾‹</h2><p>å‡ºå·®ç”³è¯·å¤§äºç­‰äº3å¤©éœ€è¦ç”±æ€»ç»ç†å®¡æ‰¹ï¼Œå°äº3å¤©ç”±è´¢åŠ¡å®¡æ‰¹ï¼Œå‡ºå·®ç”³è¯·å¿…é¡»ç»è¿‡éƒ¨é—¨ç»ç†å®¡æ‰¹ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230213225657718.png" alt="image-20230213225657718"></p><p>æµ‹è¯•ï¼š</p><p>å½“å‡ºå·®å¤©æ•°ä¸º2æ—¶ï¼Œä¼šæ ¹æ®æ¡ä»¶åˆ¤æ–­ï¼Œå½“å‰éœ€è¦èµ°ã€è´¢åŠ¡å®¡æ‰¹+éƒ¨é—¨ç»ç†å®¡æ‰¹ã€‘ï¼Œå½“å‰ä»»åŠ¡è¡¨ï¼šSELECT * FROM act_ru_task   </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230213231023874.png" alt="image-20230213231023874"></p><p>ä¸Šå›¾ä¸­ï¼šè´¢åŠ¡å®¡æ‰¹ã€éƒ¨é—¨ç»ç†å®¡æ‰¹ éƒ½æ˜¯å½“å‰çš„ä»»åŠ¡ï¼Œåœ¨å¹¶è¡Œæ‰§è¡Œã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Activiti</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Activitiâ€”â€”ç»„ä»»åŠ¡</title>
    <link href="/%E7%BB%84%E4%BB%BB%E5%8A%A1/"/>
    <url>/%E7%BB%84%E4%BB%BB%E5%8A%A1/</url>
    
    <content type="html"><![CDATA[<p>åœ¨æµç¨‹å®šä¹‰ä¸­åœ¨ä»»åŠ¡ç»“ç‚¹çš„ assignee å›ºå®šè®¾ç½®ä»»åŠ¡è´Ÿè´£äººï¼Œåœ¨æµç¨‹å®šä¹‰æ—¶å°†å‚ä¸è€…å›ºå®šè®¾ç½®åœ¨.bpmn æ–‡ä»¶ä¸­ï¼Œå¦‚æœä¸´æ—¶ä»»åŠ¡è´Ÿè´£äººå˜æ›´åˆ™éœ€è¦ä¿®æ”¹æµç¨‹å®šä¹‰ï¼Œç³»ç»Ÿå¯æ‰©å±•æ€§å·®ã€‚</p><p>é’ˆå¯¹è¿™ç§æƒ…å†µå¯ä»¥ç»™ä»»åŠ¡è®¾ç½®å¤šä¸ªå€™é€‰äººï¼Œå¯ä»¥ä»å€™é€‰äººä¸­é€‰æ‹©å‚ä¸è€…æ¥å®Œæˆä»»åŠ¡ã€‚ </p><h1 id="1-è®¾ç½®ä»»åŠ¡å€™é€‰äºº"><a href="#1-è®¾ç½®ä»»åŠ¡å€™é€‰äºº" class="headerlink" title="1. è®¾ç½®ä»»åŠ¡å€™é€‰äºº"></a>1. è®¾ç½®ä»»åŠ¡å€™é€‰äºº</h1><p>åœ¨æµç¨‹å›¾ä¸­ä»»åŠ¡èŠ‚ç‚¹çš„é…ç½®ä¸­è®¾ç½® candidate-users(å€™é€‰äºº)ï¼Œå¤šä¸ªå€™é€‰äººä¹‹é—´ç”¨é€—å·åˆ†å¼€ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Activiti</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Activitiâ€”â€”åˆ†é…ä»»åŠ¡è´Ÿè´£äºº</title>
    <link href="/Activiti%E2%80%94%E2%80%94%E5%88%86%E9%85%8D%E4%BB%BB%E5%8A%A1%E8%B4%9F%E8%B4%A3%E4%BA%BA/"/>
    <url>/Activiti%E2%80%94%E2%80%94%E5%88%86%E9%85%8D%E4%BB%BB%E5%8A%A1%E8%B4%9F%E8%B4%A3%E4%BA%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å›ºå®šåˆ†é…"><a href="#1-å›ºå®šåˆ†é…" class="headerlink" title="1 å›ºå®šåˆ†é…"></a>1 å›ºå®šåˆ†é…</h1><p>åœ¨è¿›è¡Œä¸šåŠ¡æµç¨‹å»ºæ¨¡æ—¶æŒ‡å®šå›ºå®šçš„ä»»åŠ¡è´Ÿè´£äººï¼Œ å¦‚å›¾ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230210163130769.png" alt="image-20230210163130769"></p><h1 id="2-è¡¨è¾¾å¼åˆ†é…"><a href="#2-è¡¨è¾¾å¼åˆ†é…" class="headerlink" title="2 è¡¨è¾¾å¼åˆ†é…"></a>2 è¡¨è¾¾å¼åˆ†é…</h1><p>Activiti ä½¿ç”¨ UEL è¡¨è¾¾å¼ï¼Œ UEL æ˜¯ java EE6 è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œ UELï¼ˆUnified Expression Languageï¼‰å³ ç»Ÿä¸€è¡¨è¾¾å¼è¯­è¨€ï¼Œ activiti æ”¯æŒä¸¤ä¸ª UEL è¡¨è¾¾å¼ï¼š UEL-value å’Œ UEL-methodã€‚ </p><h2 id="2-1-UEL-value"><a href="#2-1-UEL-value" class="headerlink" title="2.1  UEL-value"></a>2.1  UEL-value</h2><ul><li>assignee è¿™ä¸ªå˜é‡æ˜¯ activiti çš„ä¸€ä¸ªæµç¨‹å˜é‡ï¼Œ</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230210163518444.png" alt="image-20230210163518444"></p><ul><li>user ä¹Ÿæ˜¯ activiti çš„ä¸€ä¸ªæµç¨‹å˜é‡ï¼Œ user.name è¡¨ç¤ºé€šè¿‡è°ƒç”¨ user çš„ getter æ–¹æ³•è·å–å€¼</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230210163909807.png" alt="image-20230210163909807"></p><h2 id="2-2-UEL-method"><a href="#2-2-UEL-method" class="headerlink" title="2.2  UEL-method"></a>2.2  UEL-method</h2><p>userBean æ˜¯ spring å®¹å™¨ä¸­çš„ä¸€ä¸ª beanï¼Œè¡¨ç¤ºè°ƒç”¨è¯¥ bean çš„ getUserId()æ–¹æ³•ã€‚ </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230210164303115.png" alt="image-20230210164303115"></p><h2 id="2-3-å…¶ä»–"><a href="#2-3-å…¶ä»–" class="headerlink" title="2.3 å…¶ä»–"></a>2.3 å…¶ä»–</h2><p>è¡¨è¾¾å¼æ”¯æŒè§£æåŸºç¡€ç±»å‹ã€ beanã€ listã€ array å’Œ mapï¼Œä¹Ÿå¯ä½œä¸ºæ¡ä»¶åˆ¤æ–­ã€‚å¦‚ä¸‹ï¼š<br>${order.price &gt; 100 &amp;&amp; order.price &lt; 250} </p><h1 id="3-ç›‘å¬å™¨åˆ†é…"><a href="#3-ç›‘å¬å™¨åˆ†é…" class="headerlink" title="3 ç›‘å¬å™¨åˆ†é…"></a>3 ç›‘å¬å™¨åˆ†é…</h1><p>å¯ä»¥ä½¿ç”¨ç›‘å¬å™¨æ¥å®Œæˆå¾ˆå¤šActivitiæµç¨‹çš„ä¸šåŠ¡ã€‚</p><p>ä»»åŠ¡ç›‘å¬å™¨æ˜¯å‘ç”Ÿå¯¹åº”çš„ä»»åŠ¡ç›¸å…³äº‹ä»¶æ—¶æ‰§è¡Œè‡ªå®šä¹‰ java é€»è¾‘ æˆ–è¡¨è¾¾å¼ã€‚</p><p>ä»»åŠ¡ç›¸å½“äº‹ä»¶åŒ…æ‹¬ï¼š  </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/1577506842889.png" alt="1577506842889"></p>]]></content>
    
    
    <categories>
      
      <category>Activiti</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Activitiâ€”â€”æµç¨‹å®šä¹‰æ“ä½œ</title>
    <link href="/%E6%B5%81%E7%A8%8B%E5%AE%9A%E4%B9%89%E6%93%8D%E4%BD%9C/"/>
    <url>/%E6%B5%81%E7%A8%8B%E5%AE%9A%E4%B9%89%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æµç¨‹å®šä¹‰ä¿¡æ¯æŸ¥è¯¢"><a href="#1-æµç¨‹å®šä¹‰ä¿¡æ¯æŸ¥è¯¢" class="headerlink" title="1 æµç¨‹å®šä¹‰ä¿¡æ¯æŸ¥è¯¢"></a>1 æµç¨‹å®šä¹‰ä¿¡æ¯æŸ¥è¯¢</h1><p>æŸ¥è¯¢æµç¨‹ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…å«æµç¨‹å®šä¹‰ï¼Œæµç¨‹éƒ¨ç½²ï¼Œæµç¨‹å®šä¹‰ç‰ˆæœ¬    -&gt; ACT_RE_PROCDEF</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">queryProcessDefinition</span><span class="hljs-params">()</span></span>&#123;<br>       ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br>       RepositoryService repositoryService = processEngine.getRepositoryService();<br>       ProcessDefinitionQuery processDefinitionQuery = repositoryService.createProcessDefinitionQuery();<br>       List&lt;ProcessDefinition&gt; definitionList = processDefinitionQuery.processDefinitionKey(<span class="hljs-string">&quot;myProcess&quot;</span>)<br>               .orderByProcessDefinitionVersion()<br>               .desc()<br>               .list();<br>       <span class="hljs-keyword">for</span> (ProcessDefinition processDefinition : definitionList) &#123;<br>           System.out.println(<span class="hljs-string">&quot;æµç¨‹å®šä¹‰ id=&quot;</span>+processDefinition.getId());<br>           System.out.println(<span class="hljs-string">&quot;æµç¨‹å®šä¹‰ name=&quot;</span>+processDefinition.getName());<br>           System.out.println(<span class="hljs-string">&quot;æµç¨‹å®šä¹‰ key=&quot;</span>+processDefinition.getKey());<br>           System.out.println(<span class="hljs-string">&quot;æµç¨‹å®šä¹‰ Version=&quot;</span>+processDefinition.getVersion());<br>           System.out.println(<span class="hljs-string">&quot;æµç¨‹éƒ¨ç½²ID =&quot;</span>+processDefinition.getDeploymentId());<br>       &#125;<br>   &#125;<br></code></pre></td></tr></table></figure><h1 id="2-æµç¨‹å®šä¹‰åˆ é™¤"><a href="#2-æµç¨‹å®šä¹‰åˆ é™¤" class="headerlink" title="2. æµç¨‹å®šä¹‰åˆ é™¤"></a>2. æµç¨‹å®šä¹‰åˆ é™¤</h1><p>è¯´æ˜ï¼š</p><ol><li><pre><code class="hljs">  ä½¿ç”¨repositoryServiceåˆ é™¤æµç¨‹å®šä¹‰ï¼Œå†å²è¡¨ä¿¡æ¯ä¸ä¼šè¢«åˆ é™¤</code></pre></li><li><pre><code class="hljs">  å¦‚æœè¯¥æµç¨‹å®šä¹‰ä¸‹æ²¡æœ‰æ­£åœ¨è¿è¡Œçš„æµç¨‹ï¼Œåˆ™å¯ä»¥ç”¨æ™®é€šåˆ é™¤ã€‚</code></pre></li></ol><p>å¦‚æœè¯¥æµç¨‹å®šä¹‰ä¸‹å­˜åœ¨å·²ç»è¿è¡Œçš„æµç¨‹ï¼Œä½¿ç”¨æ™®é€šåˆ é™¤æŠ¥é”™ï¼Œå¯ç”¨çº§è”åˆ é™¤æ–¹æ³•å°†æµç¨‹åŠç›¸å…³è®°å½•å…¨éƒ¨åˆ é™¤ã€‚</p><p>å…ˆåˆ é™¤æ²¡æœ‰å®Œæˆæµç¨‹èŠ‚ç‚¹ï¼Œæœ€åå°±å¯ä»¥å®Œå…¨åˆ é™¤æµç¨‹å®šä¹‰ä¿¡æ¯</p><p>é¡¹ç›®å¼€å‘ä¸­çº§è”åˆ é™¤æ“ä½œä¸€èˆ¬åªå¼€æ”¾ç»™è¶…çº§ç®¡ç†å‘˜ä½¿ç”¨.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">deleteDeployment</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// æµç¨‹éƒ¨ç½²id</span><br>    String deploymentId = <span class="hljs-string">&quot;1&quot;</span>;<br><br>    ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br>    <span class="hljs-comment">// é€šè¿‡æµç¨‹å¼•æ“è·å–repositoryService</span><br>    RepositoryService repositoryService = processEngine<br>            .getRepositoryService();<br>    <span class="hljs-comment">//åˆ é™¤æµç¨‹å®šä¹‰ï¼Œå¦‚æœè¯¥æµç¨‹å®šä¹‰å·²æœ‰æµç¨‹å®ä¾‹å¯åŠ¨åˆ™åˆ é™¤æ—¶å‡ºé”™</span><br>    <span class="hljs-comment">//repositoryService.deleteDeployment(deploymentId);</span><br>    <span class="hljs-comment">//è®¾ç½®true çº§è”åˆ é™¤æµç¨‹å®šä¹‰ï¼Œå³ä½¿è¯¥æµç¨‹æœ‰æµç¨‹å®ä¾‹å¯åŠ¨ä¹Ÿå¯ä»¥åˆ é™¤ï¼Œè®¾ç½®ä¸ºfalseéçº§åˆ«åˆ é™¤æ–¹å¼ï¼Œå¦‚æœæµç¨‹</span><br>    repositoryService.deleteDeployment(deploymentId, <span class="hljs-keyword">true</span>);<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Activiti</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Activitiâ€”â€”æµç¨‹å®ä¾‹</title>
    <link href="/%E6%B5%81%E7%A8%8B%E5%AE%9E%E4%BE%8B%E6%93%8D%E4%BD%9C/"/>
    <url>/%E6%B5%81%E7%A8%8B%E5%AE%9E%E4%BE%8B%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h2 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1. æ¦‚å¿µ"></a>1. æ¦‚å¿µ</h2><p><strong>æµç¨‹å®ä¾‹</strong>ï¼ˆProcessInstanceï¼‰ä»£è¡¨æµç¨‹å®šä¹‰çš„æ‰§è¡Œå®ä¾‹ã€‚ä¾‹å¦‚ï¼šç”¨æˆ·æˆ–ç¨‹åºæŒ‰ç…§æµç¨‹å®šä¹‰å†…å®¹å‘èµ·ä¸€ä¸ªæµç¨‹ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªæµç¨‹å®ä¾‹ã€‚</p><p>æµç¨‹å®šä¹‰å’Œæµç¨‹å®ä¾‹çš„å›¾è§£ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230209223705740.png" alt="image-20230209223705740"></p><h2 id="2-å¯åŠ¨æµç¨‹å®ä¾‹-å¹¶æ·»åŠ Businesskey"><a href="#2-å¯åŠ¨æµç¨‹å®ä¾‹-å¹¶æ·»åŠ Businesskey" class="headerlink" title="2. å¯åŠ¨æµç¨‹å®ä¾‹ å¹¶æ·»åŠ Businesskey"></a>2. å¯åŠ¨æµç¨‹å®ä¾‹ å¹¶æ·»åŠ Businesskey</h2><ul><li>Businesskeyï¼šä¸šåŠ¡æ ‡è¯†ï¼Œé€šå¸¸ä¸ºä¸šåŠ¡è¡¨çš„ä¸»é”®ï¼Œä¸šåŠ¡æ ‡è¯†å’Œæµç¨‹å®ä¾‹ä¸€ä¸€å¯¹åº”ã€‚ä¸šåŠ¡æ ‡è¯†æ¥æºäºä¸šåŠ¡ç³»ç»Ÿã€‚å­˜å‚¨ä¸šåŠ¡æ ‡è¯†å°±æ˜¯æ ¹æ®ä¸šåŠ¡æ ‡è¯†æ¥å…³è”æŸ¥è¯¢ä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®ã€‚</li><li>å¯åŠ¨æµç¨‹å®ä¾‹æ—¶ï¼ŒæŒ‡å®šçš„businesskeyï¼Œå°±ä¼šåœ¨act_ru_execution #æµç¨‹å®ä¾‹çš„æ‰§è¡Œè¡¨ä¸­å­˜å‚¨businesskeyã€‚</li><li>æ¯”å¦‚ï¼šå‡ºå·®æµç¨‹å¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹ï¼Œå°±å¯ä»¥å°†å‡ºå·®å•çš„idä½œä¸ºä¸šåŠ¡æ ‡è¯†å­˜å‚¨åˆ°activitiä¸­ï¼Œå°†æ¥æŸ¥è¯¢activitiçš„æµç¨‹å®ä¾‹ä¿¡æ¯å°±å¯ä»¥è·å–å‡ºå·®å•çš„idä»è€Œå…³è”æŸ¥è¯¢ä¸šåŠ¡ç³»ç»Ÿæ•°æ®åº“å¾—åˆ°å‡ºå·®å•ä¿¡æ¯ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¯åŠ¨æµç¨‹å®ä¾‹ï¼Œæ·»åŠ businessKey</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addBusinessKey</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-comment">//        1ã€å¾—åˆ°ProcessEngine</span><br>        ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br><span class="hljs-comment">//        2ã€å¾—åˆ°RunTimeService</span><br>        RuntimeService runtimeService = processEngine.getRuntimeService();<br><span class="hljs-comment">//        3ã€å¯åŠ¨æµç¨‹å®ä¾‹ï¼ŒåŒæ—¶è¿˜è¦æŒ‡å®šä¸šåŠ¡æ ‡è¯†businessKeyï¼Œä¹Ÿå°±æ˜¯å‡ºå·®ç”³è¯·å•idï¼Œè¿™é‡Œæ˜¯1001</span><br>        ProcessInstance processInstance = runtimeService.<br>                startProcessInstanceByKey(<span class="hljs-string">&quot;myProcess&quot;</span>,<span class="hljs-string">&quot;0001&quot;</span>);<br><span class="hljs-comment">//        4ã€è¾“å‡ºprocessInstanceç›¸å…³å±æ€§</span><br>        System.out.println(<span class="hljs-string">&quot;ä¸šåŠ¡id==&quot;</span>+processInstance.getBusinessKey());<br>    &#125;<br></code></pre></td></tr></table></figure><h2 id="3-æŒ‚èµ·ã€æ¿€æ´»æµç¨‹å®ä¾‹"><a href="#3-æŒ‚èµ·ã€æ¿€æ´»æµç¨‹å®ä¾‹" class="headerlink" title="3. æŒ‚èµ·ã€æ¿€æ´»æµç¨‹å®ä¾‹"></a>3. æŒ‚èµ·ã€æ¿€æ´»æµç¨‹å®ä¾‹</h2><p>æŸäº›æƒ…å†µå¯èƒ½ç”±äºæµç¨‹å˜æ›´éœ€è¦å°†å½“å‰è¿è¡Œçš„æµç¨‹æš‚åœè€Œä¸æ˜¯ç›´æ¥åˆ é™¤ï¼Œæµç¨‹æš‚åœåå°†ä¸ä¼šç»§ç»­æ‰§è¡Œã€‚</p><h3 id="3-1-å…¨éƒ¨æµç¨‹å®ä¾‹æŒ‚èµ·"><a href="#3-1-å…¨éƒ¨æµç¨‹å®ä¾‹æŒ‚èµ·" class="headerlink" title="3.1 å…¨éƒ¨æµç¨‹å®ä¾‹æŒ‚èµ·"></a>3.1 å…¨éƒ¨æµç¨‹å®ä¾‹æŒ‚èµ·</h3><p>æµç¨‹å®šä¹‰ä¸ºæŒ‚èµ·çŠ¶æ€æ—¶ï¼š</p><ol><li>è¯¥æµç¨‹å®šä¹‰å°†ä¸å…è®¸å¯åŠ¨æ–°çš„æµç¨‹å®ä¾‹ï¼Œ</li><li>è¯¥æµç¨‹å®šä¹‰ä¸‹æ‰€æœ‰çš„æµç¨‹å®ä¾‹å°†å…¨éƒ¨æŒ‚èµ·æš‚åœæ‰§è¡Œã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java">    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SuspendAllProcessInstance</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-comment">//        è·å–processEngine</span><br>        ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br><span class="hljs-comment">//        è·å–repositoryService</span><br>        RepositoryService repositoryService = processEngine.getRepositoryService();<br><span class="hljs-comment">//        æŸ¥è¯¢æµç¨‹å®šä¹‰çš„å¯¹è±¡</span><br>        ProcessDefinition processDefinition = repositoryService.createProcessDefinitionQuery().<br>                processDefinitionKey(<span class="hljs-string">&quot;myProcess&quot;</span>).<br>                singleResult();<br><span class="hljs-comment">//        å¾—åˆ°å½“å‰æµç¨‹å®šä¹‰çš„å®ä¾‹æ˜¯å¦éƒ½ä¸ºæš‚åœçŠ¶æ€</span><br>        <span class="hljs-keyword">boolean</span> suspended = processDefinition.isSuspended();<br><span class="hljs-comment">//        æµç¨‹å®šä¹‰id</span><br>        String processDefinitionId = processDefinition.getId();<br><span class="hljs-comment">//        åˆ¤æ–­æ˜¯å¦ä¸ºæš‚åœ</span><br>        <span class="hljs-keyword">if</span>(suspended)&#123;<br><span class="hljs-comment">//         å¦‚æœæ˜¯æš‚åœï¼Œå¯ä»¥æ‰§è¡Œæ¿€æ´»æ“ä½œ ,å‚æ•°1 ï¼šæµç¨‹å®šä¹‰id ï¼Œå‚æ•°2ï¼šæ˜¯å¦æ¿€æ´»ï¼Œå‚æ•°3ï¼šæ¿€æ´»æ—¶é—´</span><br>            repositoryService.activateProcessDefinitionById(processDefinitionId,<br>                    <span class="hljs-keyword">true</span>,<br>                    <span class="hljs-keyword">null</span><br>            );<br>            System.out.println(<span class="hljs-string">&quot;æµç¨‹å®šä¹‰ï¼š&quot;</span>+processDefinitionId+<span class="hljs-string">&quot;,å·²æ¿€æ´»&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-comment">//          å¦‚æœæ˜¯æ¿€æ´»çŠ¶æ€ï¼Œå¯ä»¥æš‚åœï¼Œå‚æ•°1 ï¼šæµç¨‹å®šä¹‰id ï¼Œå‚æ•°2ï¼šæ˜¯å¦æš‚åœï¼Œå‚æ•°3ï¼šæš‚åœæ—¶é—´</span><br>            repositoryService.suspendProcessDefinitionById(processDefinitionId,<br>                    <span class="hljs-keyword">true</span>,<br>                    <span class="hljs-keyword">null</span>);<br>            System.out.println(<span class="hljs-string">&quot;æµç¨‹å®šä¹‰ï¼š&quot;</span>+processDefinitionId+<span class="hljs-string">&quot;,å·²æŒ‚èµ·&quot;</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="3-2-å•ä¸ªæµç¨‹å®ä¾‹æŒ‚èµ·"><a href="#3-2-å•ä¸ªæµç¨‹å®ä¾‹æŒ‚èµ·" class="headerlink" title="3.2 å•ä¸ªæµç¨‹å®ä¾‹æŒ‚èµ·"></a>3.2 å•ä¸ªæµç¨‹å®ä¾‹æŒ‚èµ·</h3><p>å•ä¸ªæµç¨‹å®ä¾‹æŒ‚èµ·ï¼Œåˆ™æ­¤æµç¨‹ä¸å†ç»§ç»­æ‰§è¡Œï¼Œå®Œæˆè¯¥æµç¨‹å®ä¾‹çš„å½“å‰ä»»åŠ¡å°†æŠ¥å¼‚å¸¸</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java">    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SuspendSingleProcessInstance</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-comment">//        è·å–processEngine</span><br>        ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br><span class="hljs-comment">//        RuntimeService</span><br>        RuntimeService runtimeService = processEngine.getRuntimeService();<br><span class="hljs-comment">//        æŸ¥è¯¢æµç¨‹å®šä¹‰çš„å¯¹è±¡</span><br>        ProcessInstance processInstance = runtimeService.<br>                createProcessInstanceQuery().<br>                processInstanceId(<span class="hljs-string">&quot;15001&quot;</span>).<br>                singleResult();<br><span class="hljs-comment">//        å¾—åˆ°å½“å‰æµç¨‹å®šä¹‰çš„å®ä¾‹æ˜¯å¦éƒ½ä¸ºæš‚åœçŠ¶æ€</span><br>        <span class="hljs-keyword">boolean</span> suspended = processInstance.isSuspended();<br><span class="hljs-comment">//        æµç¨‹å®šä¹‰id</span><br>        String processDefinitionId = processInstance.getId();<br><span class="hljs-comment">//        åˆ¤æ–­æ˜¯å¦ä¸ºæš‚åœ</span><br>        <span class="hljs-keyword">if</span>(suspended)&#123;<br><span class="hljs-comment">//         å¦‚æœæ˜¯æš‚åœï¼Œå¯ä»¥æ‰§è¡Œæ¿€æ´»æ“ä½œ ,å‚æ•°ï¼šæµç¨‹å®šä¹‰id</span><br>            runtimeService.activateProcessInstanceById(processDefinitionId);<br>            System.out.println(<span class="hljs-string">&quot;æµç¨‹å®šä¹‰ï¼š&quot;</span>+processDefinitionId+<span class="hljs-string">&quot;,å·²æ¿€æ´»&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-comment">//          å¦‚æœæ˜¯æ¿€æ´»çŠ¶æ€ï¼Œå¯ä»¥æš‚åœï¼Œå‚æ•°ï¼šæµç¨‹å®šä¹‰id</span><br>            runtimeService.suspendProcessInstanceById( processDefinitionId);<br>            System.out.println(<span class="hljs-string">&quot;æµç¨‹å®šä¹‰ï¼š&quot;</span>+processDefinitionId+<span class="hljs-string">&quot;,å·²æŒ‚èµ·&quot;</span>);<br>        &#125;<br><br>    &#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Activiti</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SSHå…å¯†ç™»å½•</title>
    <link href="/SSH%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95/"/>
    <url>/SSH%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å®¢æˆ·ç«¯ç”Ÿæˆå…¬ç§é’¥"><a href="#1-å®¢æˆ·ç«¯ç”Ÿæˆå…¬ç§é’¥" class="headerlink" title="1. å®¢æˆ·ç«¯ç”Ÿæˆå…¬ç§é’¥"></a>1. å®¢æˆ·ç«¯ç”Ÿæˆå…¬ç§é’¥</h1><ol><li><p>æ‰§è¡Œ<code>ssh-keygen</code>åœ¨ç”¨æˆ·ç›®å½•.sshæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºå…¬ç§é’¥:</p><ul><li><p>id_rsa ï¼ˆç§é’¥ï¼‰</p></li><li><p>id_rsa.pub (å…¬é’¥)</p></li></ul></li></ol><h1 id="2-ä¸Šä¼ å…¬é’¥åˆ°æœåŠ¡å™¨"><a href="#2-ä¸Šä¼ å…¬é’¥åˆ°æœåŠ¡å™¨" class="headerlink" title="2. ä¸Šä¼ å…¬é’¥åˆ°æœåŠ¡å™¨"></a>2. ä¸Šä¼ å…¬é’¥åˆ°æœåŠ¡å™¨</h1><ol><li><p>è¿›å…¥æœåŠ¡ç«¯.sshç›®å½•ä¸‹ <code>cd ~/.ssh</code></p></li><li><p>å°†å®¢æˆ·ç«¯ç”Ÿæˆçš„id_rsa.pub å¤åˆ¶åˆ° authorized_keys é‡Œ <code>vim authorized_keys</code></p></li></ol><h1 id="3-æµ‹è¯•å…å¯†ç™»å½•"><a href="#3-æµ‹è¯•å…å¯†ç™»å½•" class="headerlink" title="3. æµ‹è¯•å…å¯†ç™»å½•"></a>3. æµ‹è¯•å…å¯†ç™»å½•</h1><p><code>ssh root@localhost</code></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Activitiâ€”â€”æ•°æ®è¡¨ä»‹ç»</title>
    <link href="/Activiti%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%BB%8B%E7%BB%8D/"/>
    <url>/Activiti%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%BB%8B%E7%BB%8D/</url>
    
    <content type="html"><![CDATA[<p>Activiti çš„è¡¨éƒ½ä»¥   ACT_   å¼€å¤´ã€‚ ç¬¬äºŒéƒ¨åˆ†æ˜¯è¡¨ç¤ºè¡¨çš„ç”¨é€”çš„ä¸¤ä¸ªå­—æ¯æ ‡è¯†ã€‚ ç”¨é€”ä¹Ÿå’ŒæœåŠ¡çš„ API å¯¹åº”</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230202215607751.png" alt="image-20230202215607751"></p><h3 id="è¡¨çš„å‘½åè§„åˆ™å’Œä½œç”¨"><a href="#è¡¨çš„å‘½åè§„åˆ™å’Œä½œç”¨" class="headerlink" title="è¡¨çš„å‘½åè§„åˆ™å’Œä½œç”¨"></a>è¡¨çš„å‘½åè§„åˆ™å’Œä½œç”¨</h3><ul><li><strong>ACT_RE</strong> ï¼šâ€™REâ€™è¡¨ç¤º repositoryã€‚ è¿™ä¸ªå‰ç¼€çš„è¡¨åŒ…å«äº†æµç¨‹å®šä¹‰å’Œæµç¨‹é™æ€èµ„æº ï¼ˆå›¾ç‰‡ï¼Œè§„åˆ™ï¼Œç­‰ç­‰ï¼‰ã€‚</li><li><strong>ACT_RU</strong>ï¼šâ€™RUâ€™è¡¨ç¤º runtimeã€‚ è¿™äº›è¿è¡Œæ—¶çš„è¡¨ï¼ŒåŒ…å«æµç¨‹å®ä¾‹ï¼Œä»»åŠ¡ï¼Œå˜é‡ï¼Œå¼‚æ­¥ä»»åŠ¡ï¼Œç­‰è¿è¡Œä¸­çš„æ•°æ®ã€‚ Activiti åªåœ¨æµç¨‹å®ä¾‹æ‰§è¡Œè¿‡ç¨‹ä¸­ä¿å­˜è¿™äº›æ•°æ®ï¼Œ åœ¨æµç¨‹ç»“æŸæ—¶å°±ä¼šåˆ é™¤è¿™äº›è®°å½•ã€‚ è¿™æ ·è¿è¡Œæ—¶è¡¨å¯ä»¥ä¸€ç›´å¾ˆå°é€Ÿåº¦å¾ˆå¿«ã€‚</li><li><strong>ACT_HI</strong>ï¼šâ€™HIâ€™è¡¨ç¤º historyã€‚ è¿™äº›è¡¨åŒ…å«å†å²æ•°æ®ï¼Œæ¯”å¦‚å†å²æµç¨‹å®ä¾‹ï¼Œ å˜é‡ï¼Œä»»åŠ¡ç­‰ç­‰ã€‚</li><li><strong>ACT_GE</strong> ï¼š GE è¡¨ç¤º generalã€‚ é€šç”¨æ•°æ®ï¼Œ ç”¨äºä¸åŒåœºæ™¯ä¸‹</li></ul><table><thead><tr><th><strong>è¡¨åˆ†ç±»</strong></th><th><strong>è¡¨å</strong></th><th><strong>è§£é‡Š</strong></th></tr></thead><tbody><tr><td>ä¸€èˆ¬æ•°æ®</td><td></td><td></td></tr><tr><td></td><td>[ACT_GE_BYTEARRAY]</td><td>é€šç”¨çš„æµç¨‹å®šä¹‰å’Œæµç¨‹èµ„æº</td></tr><tr><td></td><td>[ACT_GE_PROPERTY]</td><td>ç³»ç»Ÿç›¸å…³å±æ€§</td></tr><tr><td>æµç¨‹å†å²è®°å½•</td><td></td><td></td></tr><tr><td></td><td>[ACT_HI_ACTINST]</td><td>å†å²çš„æµç¨‹å®ä¾‹</td></tr><tr><td></td><td>[ACT_HI_ATTACHMENT]</td><td>å†å²çš„æµç¨‹é™„ä»¶</td></tr><tr><td></td><td>[ACT_HI_COMMENT]</td><td>å†å²çš„è¯´æ˜æ€§ä¿¡æ¯</td></tr><tr><td></td><td>[ACT_HI_DETAIL]</td><td>å†å²çš„æµç¨‹è¿è¡Œä¸­çš„ç»†èŠ‚ä¿¡æ¯</td></tr><tr><td></td><td>[ACT_HI_IDENTITYLINK]</td><td>å†å²çš„æµç¨‹è¿è¡Œè¿‡ç¨‹ä¸­ç”¨æˆ·å…³ç³»</td></tr><tr><td></td><td>[ACT_HI_PROCINST]</td><td>å†å²çš„æµç¨‹å®ä¾‹</td></tr><tr><td></td><td>[ACT_HI_TASKINST]</td><td>å†å²çš„ä»»åŠ¡å®ä¾‹</td></tr><tr><td></td><td>[ACT_HI_VARINST]</td><td>å†å²çš„æµç¨‹è¿è¡Œä¸­çš„å˜é‡ä¿¡æ¯</td></tr><tr><td>æµç¨‹å®šä¹‰è¡¨</td><td></td><td></td></tr><tr><td></td><td>[ACT_RE_DEPLOYMENT]</td><td>éƒ¨ç½²å•å…ƒä¿¡æ¯</td></tr><tr><td></td><td>[ACT_RE_MODEL]</td><td>æ¨¡å‹ä¿¡æ¯</td></tr><tr><td></td><td>[ACT_RE_PROCDEF]</td><td>å·²éƒ¨ç½²çš„æµç¨‹å®šä¹‰ -&gt; åŒä¸€ä¸ªæµç¨‹ï¼Œéƒ¨ç½²ä¸€æ¬¡å¢åŠ ä¸€æ¡è®°å½•</td></tr><tr><td>è¿è¡Œå®ä¾‹è¡¨</td><td></td><td></td></tr><tr><td></td><td>[ACT_RU_EVENT_SUBSCR]</td><td>è¿è¡Œæ—¶äº‹ä»¶</td></tr><tr><td></td><td>[ACT_RU_EXECUTION]</td><td>è¿è¡Œæ—¶æµç¨‹æ‰§è¡Œå®ä¾‹</td></tr><tr><td></td><td>[ACT_RU_IDENTITYLINK]</td><td>è¿è¡Œæ—¶ç”¨æˆ·å…³ç³»ä¿¡æ¯ï¼Œå­˜å‚¨ä»»åŠ¡èŠ‚ç‚¹ä¸å‚ä¸è€…çš„ç›¸å…³ä¿¡æ¯</td></tr><tr><td></td><td>[ACT_RU_JOB]</td><td>è¿è¡Œæ—¶ä½œä¸š</td></tr><tr><td></td><td>[ACT_RU_TASK]</td><td>è¿è¡Œæ—¶ä»»åŠ¡</td></tr><tr><td></td><td>[ACT_RU_VARIABLE]</td><td>è¿è¡Œæ—¶å˜é‡è¡¨</td></tr></tbody></table><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230207214202834.png" alt="image-20230207214202834"></p><p>ä¸‹é¢çš„æ•°æ®æ˜¯ï¼šä¸€ä¸ªæµç¨‹ï¼Œéƒ¨ç½²åï¼Œå¼€å¯äº†ä¸¤ä¸ªassgineeä¸åŒçš„æµç¨‹å®ä¾‹ï¼š</p><ul><li>act_re_deploymentï¼š</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230207221224629.png" alt="image-20230207221224629"></p><ul><li>act_re_procdefï¼š</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230207221402715.png" alt="image-20230207221402715"></p><ul><li>act_hi_procinstï¼š</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230207221437355.png" alt="image-20230207221437355"></p><ul><li>act_hi_actinstï¼š</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230207221609189.png" alt="image-20230207221609189"></p><ul><li>act_hi_taskinstï¼š</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230207221658209.png" alt="image-20230207221658209"></p><ul><li>act_hi_varinstï¼š</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230207221801474.png" alt="image-20230207221801474"></p><ul><li>act_hi_identitylinkï¼š</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230207221833964.png" alt="image-20230207221833964"></p><ul><li>act_ru_taskï¼š</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230207221951039.png" alt="image-20230207221951039"></p>]]></content>
    
    
    <categories>
      
      <category>Activiti</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Activitiâ€”â€”åŸºæœ¬æ“ä½œ</title>
    <link href="/activiti%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
    <url>/activiti%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æµç¨‹å®šä¹‰"><a href="#1-æµç¨‹å®šä¹‰" class="headerlink" title="1 æµç¨‹å®šä¹‰"></a>1 æµç¨‹å®šä¹‰</h1><ul><li><p>ä½¿ç”¨activitiæµç¨‹å»ºæ¨¡å·¥å…·(activity-designer)å®šä¹‰ä¸šåŠ¡æµç¨‹(.bpmnæ–‡ä»¶) ã€‚</p></li><li><p>.bpmnæ–‡ä»¶å°±æ˜¯ä¸šåŠ¡æµç¨‹å®šä¹‰æ–‡ä»¶ï¼Œé€šè¿‡xmlå®šä¹‰ä¸šåŠ¡æµç¨‹ã€‚</p></li><li><p>ä½¿ç”¨ideaæ’ä»¶è®¾ç½®æµç¨‹å›¾ï¼Œ è®¾ç½®æµç¨‹ä¸­éœ€è¦çš„èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹è´Ÿè´£äººã€‚å…·ä½“æ­¥éª¤å‚è€ƒï¼š</p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230128164658.png"></p><h1 id="2-æµç¨‹å®šä¹‰éƒ¨ç½²"><a href="#2-æµç¨‹å®šä¹‰éƒ¨ç½²" class="headerlink" title="2 æµç¨‹å®šä¹‰éƒ¨ç½²"></a>2 æµç¨‹å®šä¹‰éƒ¨ç½²</h1><ul><li>activitiéƒ¨ç½²ä¸šåŠ¡æµç¨‹å®šä¹‰ï¼ˆ.bpmnæ–‡ä»¶ï¼‰ã€‚å³ï¼šå°†æµç¨‹å›¾çš„å†…å®¹å­˜å‚¨åˆ°æ•°æ®åº“</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr;<br><br><span class="hljs-keyword">import</span> org.activiti.engine.ProcessEngine;<br><span class="hljs-keyword">import</span> org.activiti.engine.ProcessEngines;<br><span class="hljs-keyword">import</span> org.activiti.engine.RepositoryService;<br><span class="hljs-keyword">import</span> org.activiti.engine.repository.Deployment;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActivitiDemo</span> </span>&#123;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDeployment</span><span class="hljs-params">()</span></span>&#123;<br>      <span class="hljs-comment">// 1. åˆ›å»ºProcessEngine</span><br>        ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br>      <span class="hljs-comment">// 2. è·å–RepositoryService</span><br>        RepositoryService repositoryService = processEngine.getRepositoryService();<br>      <span class="hljs-comment">// 3. ä½¿ç”¨serviceè¿›è¡Œæµç¨‹çš„éƒ¨ç½²ï¼Œå®šä¹‰æµç¨‹åå­—ï¼ŒæŠŠbpmnéƒ¨ç½²åˆ°æ•°æ®åº“ä¸­</span><br>        Deployment deploy = repositoryService.createDeployment()<br>                .name(<span class="hljs-string">&quot;è¯è´¹æŠ¥é”€&quot;</span>)<br>                .addClasspathResource(<span class="hljs-string">&quot;bpmn/phoneExpense.bpmn20.xml&quot;</span>)<br>                .deploy();<br>      <span class="hljs-comment">// 4. è¾“å‡ºéƒ¨ç½²ä¿¡æ¯</span><br>        System.out.println(<span class="hljs-string">&quot;æµç¨‹éƒ¨ç½²id=&quot;</span>+deploy.getId());<br>        System.out.println(<span class="hljs-string">&quot;æµç¨‹éƒ¨ç½²åå­—=&quot;</span>+deploy.getName());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230128210614102.png" alt="image-20230128210614102"></p><p>æµç¨‹å®šä¹‰éƒ¨ç½²åæ“ä½œactivitiçš„3å¼ è¡¨å¦‚ä¸‹ï¼š</p><ul><li><p>act_re_deployment æµç¨‹å®šä¹‰éƒ¨ç½²è¡¨ï¼Œæ¯éƒ¨ç½²ä¸€æ¬¡å¢åŠ ä¸€æ¡è®°å½•</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230128204308.png"></p></li><li><p>act_re_procdef æµç¨‹å®šä¹‰è¡¨ï¼Œéƒ¨ç½²æ¯ä¸ªæ–°çš„æµç¨‹å®šä¹‰éƒ½ä¼šåœ¨è¿™å¼ è¡¨ä¸­å¢åŠ ä¸€æ¡è®°å½•ã€‚æ¯”å¦‚ç« ä¸‰çš„è¯è´¹æŠ¥é”€æ˜¯ä¸€æ¡è®°å½•ï¼Œæå››çš„è¯è´¹æŠ¥é”€æ˜¯ä¸€æ¡è®°å½•ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230128204451742.png" alt="image-20230128204451742"> <img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230128204449359.png" alt="image-20230128204449359"></p></li><li><p>act_ge_bytearray æµç¨‹èµ„æºè¡¨</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230128204546011.png" alt="image-20230128204546011"></p></li></ul><h1 id="3-å¯åŠ¨æµç¨‹å®ä¾‹"><a href="#3-å¯åŠ¨æµç¨‹å®ä¾‹" class="headerlink" title="3 å¯åŠ¨æµç¨‹å®ä¾‹"></a>3 å¯åŠ¨æµç¨‹å®ä¾‹</h1><p>å¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹è¡¨ç¤ºå¼€å§‹ä¸€æ¬¡ä¸šåŠ¡æµç¨‹çš„è¿è¡Œã€‚</p><p>åœ¨å‘˜å·¥è¯·å‡æµç¨‹å®šä¹‰éƒ¨ç½²å®Œæˆåï¼Œå¦‚æœå¼ ä¸‰è¦è¯·å‡å°±å¯ä»¥å¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹ï¼Œå¦‚æœæå››è¦è¯·å‡ä¹Ÿå¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹ï¼Œä¸¤ä¸ªæµç¨‹çš„æ‰§è¡Œäº’ç›¸ä¸å½±å“ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testStartProcess</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// 1. åˆ›å»ºProcessEngine</span><br>    ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br>    <span class="hljs-comment">// 2. è·å–RuntimeService</span><br>    RuntimeService runtimeService = processEngine.getRuntimeService();<br>    <span class="hljs-comment">// 3. æ ¹æ®æµç¨‹IDå¯åŠ¨æµç¨‹</span><br>    ProcessInstance instance = runtimeService.startProcessInstanceByKey(<span class="hljs-string">&quot;myProcess&quot;</span>);<br>    <span class="hljs-comment">// 4. è¾“å‡º</span><br>    System.out.println(<span class="hljs-string">&quot;æµç¨‹å®šä¹‰id=&quot;</span>+instance.getProcessDefinitionId());<br>    System.out.println(<span class="hljs-string">&quot;æµç¨‹å®ä¾‹id=&quot;</span>+instance.getId());<br>    System.out.println(<span class="hljs-string">&quot;å½“å‰æ´»åŠ¨çš„id=&quot;</span>+instance.getActivityId());<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230128210529180.png" alt="image-20230128210529180"></p><p> æ“ä½œactivitiçš„è¡¨å¦‚ä¸‹ï¼š</p><p>â€‹     act_hi_actinst æµç¨‹å®ä¾‹æ‰§è¡Œå†å²</p><p>â€‹act_hi_identitylink æµç¨‹çš„å‚ä¸ç”¨æˆ·å†å²ä¿¡æ¯</p><p>â€‹act_hi_procinst æµç¨‹å®ä¾‹å†å²ä¿¡æ¯</p><p>â€‹act_hi_taskinst å·²ç»å®Œæˆçš„ä»»åŠ¡ä¿¡æ¯</p><p>â€‹act_ru_execution æµç¨‹æ‰§è¡Œä¿¡æ¯</p><p>â€‹act_ru_identitylink æµç¨‹çš„å‚ä¸ç”¨æˆ·ä¿¡æ¯</p><p>â€‹act_ru_task å½“å‰ä»£åŠçš„ä»»åŠ¡ä¿¡æ¯</p><h1 id="4-ç”¨æˆ·æŸ¥è¯¢å¾…åŠä»»åŠ¡-Task"><a href="#4-ç”¨æˆ·æŸ¥è¯¢å¾…åŠä»»åŠ¡-Task" class="headerlink" title="4 ç”¨æˆ·æŸ¥è¯¢å¾…åŠä»»åŠ¡(Task)"></a>4 ç”¨æˆ·æŸ¥è¯¢å¾…åŠä»»åŠ¡(Task)</h1><ul><li>å› ä¸ºç°åœ¨ç³»ç»Ÿçš„ä¸šåŠ¡æµç¨‹å·²ç»äº¤ç»™activitiç®¡ç†ï¼Œé€šè¿‡activitiå°±å¯ä»¥æŸ¥è¯¢å½“å‰æµç¨‹æ‰§è¡Œåˆ°å“ªäº†ï¼Œå½“å‰ç”¨æˆ·éœ€è¦åŠç†ä»€ä¹ˆä»»åŠ¡äº†ï¼Œè¿™äº›activitiå¸®æˆ‘ä»¬ç®¡ç†äº†ï¼Œè€Œä¸éœ€è¦å¼€å‘äººå‘˜è‡ªå·±ç¼–å†™åœ¨sqlè¯­å¥æŸ¥è¯¢ã€‚</li></ul><p>æŸ¥è¯¢è‡ªå·±æ‰€èƒ½å¤„ç†çš„ä»»åŠ¡ </p><pre><code class="hljs">   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindPersonalTasks</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// 1. åˆ›å»ºProcessEngine</span><br>    ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br>    <span class="hljs-comment">// 2. è·å–taskService</span><br>    TaskService taskService = processEngine.getTaskService();<br>    <span class="hljs-comment">// 3. æ ¹æ®æµç¨‹keyå’Œä»»åŠ¡è´Ÿè´£äºº æŸ¥è¯¢ä»»åŠ¡</span><br>    List&lt;Task&gt; tasks = taskService.createTaskQuery()<br>            .processDefinitionKey(<span class="hljs-string">&quot;myProcess&quot;</span>)<br>            .taskAssignee(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>)<br>            .list();<br>    <span class="hljs-comment">// 4. è¾“å‡º</span><br>    tasks.forEach(task -&gt; &#123;<br>        System.out.println(<span class="hljs-string">&quot;æµç¨‹å®ä¾‹id=&quot;</span>+task.getProcessInstanceId());<br>        System.out.println(<span class="hljs-string">&quot;ä»»åŠ¡id=&quot;</span>+task.getId());<br>        System.out.println(<span class="hljs-string">&quot;ä»»åŠ¡è´Ÿè´£äºº=&quot;</span>+task.getAssignee());<br>        System.out.println(<span class="hljs-string">&quot;ä»»åŠ¡åç§°=&quot;</span>+task.getName());<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230128210841640.png" alt="image-20230128210841640"></p><h1 id="5-ç”¨æˆ·å¤„ç†ä»»åŠ¡"><a href="#5-ç”¨æˆ·å¤„ç†ä»»åŠ¡" class="headerlink" title="5 ç”¨æˆ·å¤„ç†ä»»åŠ¡"></a>5 ç”¨æˆ·å¤„ç†ä»»åŠ¡</h1><p>ç”¨æˆ·æŸ¥è¯¢å¾…åŠä»»åŠ¡åï¼Œå°±å¯ä»¥åŠç†æŸä¸ªä»»åŠ¡ï¼Œå¦‚æœè¿™ä¸ªä»»åŠ¡åŠç†å®Œæˆè¿˜éœ€è¦å…¶å®ƒç”¨æˆ·åŠç†ï¼Œæ¯”å¦‚é‡‡è´­å•åˆ›å»ºåç”±éƒ¨é—¨ç»ç†å®¡æ ¸ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯ç”±activitiå¸®æˆ‘ä»¬å®Œæˆäº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testCompleteTask</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// 1. åˆ›å»ºProcessEngine</span><br>    ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br>    <span class="hljs-comment">// 2. è·å–taskService</span><br>    TaskService taskService = processEngine.getTaskService();<br>    <span class="hljs-comment">// 3. æ ¹æ®ä»»åŠ¡idå®Œæˆä»»åŠ¡</span><br>    taskService.complete(<span class="hljs-string">&quot;2505&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ“ä½œactivitiçš„è¡¨å¦‚ä¸‹ï¼š</p><p>act_hi_taskinst:  å·²ç»å®Œæˆçš„å†å²ä»»åŠ¡ä¿¡æ¯ -&gt; æ’å…¥æ–°æ•°æ®; æ›´æ–°å®Œæˆä»»åŠ¡çš„ç»“æŸæ—¶é—´</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230128213152660.png" alt="image-20230128213152660"></p><p>act_ru_taskï¼šå½“å‰ä»£åŠçš„ä»»åŠ¡ä¿¡æ¯ -&gt; åˆ é™¤æ—§æ•°æ®ï¼Œæ’å…¥æ–°æ•°æ®</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230128213015838.png" alt="image-20230128213015838"></p><p>â€‹       act_hi_identitylink: æµç¨‹çš„å‚ä¸ç”¨æˆ·å†å²ä¿¡æ¯  -&gt; æ’å…¥æ–°æ•°æ®</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230128213626199.png" alt="image-20230128213626199"></p><p>â€‹  </p><p><strong>æ›´åŠ çµæ´»çš„å®Œæˆä¸ªäººä»»åŠ¡ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testCompleteTask2</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// 1. åˆ›å»ºProcessEngine</span><br>    ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br>    <span class="hljs-comment">// 2. è·å–taskService</span><br>    TaskService taskService = processEngine.getTaskService();<br>    <span class="hljs-comment">// 3. å¦‚æœå¯ä»¥ç¡®å®šæ˜¯ä¸€ä¸ªä»»åŠ¡ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡singleResultè·å¾—ï¼Œä¾æ¬¡ä¿®æ”¹taskAssigneeä¸ºç›´çº¿ç»ç†ï¼Œéƒ¨é—¨ç»ç†ï¼Œè´¢åŠ¡äººå‘˜</span><br>    Task task = taskService.createTaskQuery()<br>            .processDefinitionKey(<span class="hljs-string">&quot;myProcess&quot;</span>)<br>            .taskAssignee(<span class="hljs-string">&quot;è´¢åŠ¡äººå‘˜&quot;</span>)<br>            .singleResult();<br>    <span class="hljs-comment">// 3. æ ¹æ®ä»»åŠ¡idå®Œæˆä»»åŠ¡</span><br>    taskService.complete(task.getId());<br>    System.out.println(<span class="hljs-string">&quot;DONE!&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶æŸ¥çœ‹act_ru_taskè¡¨ï¼Œå·²ç»æ²¡æœ‰æ•°æ®äº†ï¼Œå› ä¸ºä»»åŠ¡æ‰§è¡Œå®Œäº†</p><p>æŸ¥çœ‹act_hi_actinstï¼Œå¯ä»¥çœ‹åˆ°END_TIMEéƒ½å·²ç»å¡«å……ä¸Šäº†</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230128231354324.png" alt="image-20230128231354324"></p><h1 id="6-æµç¨‹ç»“æŸ"><a href="#6-æµç¨‹ç»“æŸ" class="headerlink" title="6 æµç¨‹ç»“æŸ"></a>6 æµç¨‹ç»“æŸ</h1><p>å½“ä»»åŠ¡åŠç†å®Œæˆæ²¡æœ‰ä¸‹ä¸€ä¸ªä»»åŠ¡ç»“ç‚¹äº†ï¼Œè¿™ä¸ªæµç¨‹å®ä¾‹å°±å®Œæˆäº†ã€‚</p><h1 id="7-æµç¨‹å†å²ä¿¡æ¯çš„æŸ¥çœ‹"><a href="#7-æµç¨‹å†å²ä¿¡æ¯çš„æŸ¥çœ‹" class="headerlink" title="7. æµç¨‹å†å²ä¿¡æ¯çš„æŸ¥çœ‹"></a>7. æµç¨‹å†å²ä¿¡æ¯çš„æŸ¥çœ‹</h1><p>å³ä½¿æµç¨‹å®šä¹‰å·²ç»åˆ é™¤äº†ï¼Œæµç¨‹æ‰§è¡Œçš„å†å²ä¿¡æ¯é€šè¿‡å‰é¢çš„åˆ†æï¼Œä¾ç„¶ä¿å­˜åœ¨activitiçš„act_hi_*ç›¸å…³çš„è¡¨ä¸­ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥æŸ¥è¯¢æµç¨‹æ‰§è¡Œçš„å†å²ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡HistoryServiceæ¥æŸ¥çœ‹ç›¸å…³çš„å†å²è®°å½•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java">    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">findHistoryInfo</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-comment">//      è·å–å¼•æ“</span><br>        ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br><span class="hljs-comment">//        è·å–HistoryService</span><br>        HistoryService historyService = processEngine.getHistoryService();<br><span class="hljs-comment">//        è·å– actinstè¡¨çš„æŸ¥è¯¢å¯¹è±¡</span><br>        HistoricActivityInstanceQuery instanceQuery = historyService.createHistoricActivityInstanceQuery();<br><span class="hljs-comment">//        æŸ¥è¯¢ actinstè¡¨ï¼Œæ¡ä»¶ï¼šæ ¹æ® InstanceId æŸ¥è¯¢</span><br><span class="hljs-comment">//        instanceQuery.processInstanceId(&quot;2501&quot;);</span><br><span class="hljs-comment">//        æŸ¥è¯¢ actinstè¡¨ï¼Œæ¡ä»¶ï¼šæ ¹æ® DefinitionId æŸ¥è¯¢</span><br>        instanceQuery.processDefinitionId(<span class="hljs-string">&quot;process-variable:3:c8b43296-a886-11ed-90d9-9ec8af959357&quot;</span>);<br><span class="hljs-comment">//        å¢åŠ æ’åºæ“ä½œ,orderByHistoricActivityInstanceStartTime æ ¹æ®å¼€å§‹æ—¶é—´æ’åº asc å‡åº</span><br>        instanceQuery.orderByHistoricActivityInstanceStartTime().asc();<br><span class="hljs-comment">//        æŸ¥è¯¢æ‰€æœ‰å†…å®¹</span><br>        List&lt;HistoricActivityInstance&gt; activityInstanceList = instanceQuery.list();<br><span class="hljs-comment">//        è¾“å‡º</span><br>        <span class="hljs-keyword">for</span> (HistoricActivityInstance hi : activityInstanceList) &#123;<br>            System.out.println(hi.getActivityId());<br>            System.out.println(hi.getActivityName());<br>            System.out.println(hi.getProcessDefinitionId());<br>            System.out.println(hi.getProcessInstanceId());<br>            System.out.println(<span class="hljs-string">&quot;&lt;==========================&gt;&quot;</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230209233245014.png" alt="image-20230209233245014"></p><h1 id="8-å®æˆ˜ä½¿ç”¨"><a href="#8-å®æˆ˜ä½¿ç”¨" class="headerlink" title="8 å®æˆ˜ä½¿ç”¨"></a>8 å®æˆ˜ä½¿ç”¨</h1><p><strong>å‡†å¤‡å·¥ä½œï¼š</strong></p><ol><li><p>å®šä¹‰BPMNæ–‡ä»¶</p></li><li><p>myActProcessDefinitionRegisteræ³¨å†Œentityå¯¹åº”çš„å·¥ä½œæµä¿¡æ¯ï¼šentityName, definitionKeyï¼Œname</p></li><li><p>EmActProcessStatus: entityä¸Šå­˜å‚¨çš„taskDefinitionKeyï¼Œå¯åœ¨è¿™å¼ è¡¨æŸ¥è¯¢åˆ°å¯¹åº”çš„ä¸­æ–‡ç¿»è¯‘</p><ul><li><p>processRegisterId</p></li><li><p>taskDefinitionKey</p></li><li><p>name</p></li></ul></li><li><p>entityä¸Šå†—ä½™äº†å·¥ä½œæµå­—æ®µï¼š</p><ul><li><p>task1Assigneeï¼ŒtaskAssignee2:   ä»»åŠ¡å—ç†äººï¼Œæ ¹æ®bpmnæ–‡ä»¶å®šä¹‰çš„taskæ•°é‡å®šä¹‰ï¼Œæ¯ä¸ªtaskå¯¹åº”ä¸€ä¸ªå—ç†äºº</p></li><li><p>currentTaskDefinitionKey:  å½“å‰è®°å½•çš„æµç¨‹çŠ¶æ€ï¼Œå³taskçš„æ ‡è¯†</p></li></ul></li></ol><p><strong>æµç¨‹ï¼š</strong></p><ol><li>æ–°å¢entityï¼ŒafterSaveTriggerå‘é€mqå¯åŠ¨æµç¨‹å®ä¾‹ <ul><li>definitionKey: æ ¹æ®entityNameæŸ¥è¯¢emActProcessDefinitionRegister</li><li>businessKey: entityId</li><li>variablesï¼š entityå¤å†™è‡ªå·±çš„</li></ul></li><li>æŸ¥çœ‹è®¤é¢†ä»»åŠ¡ï¼šæ ¹æ®å‰ç«¯ä¼ è¿‡æ¥çš„loginName, processDefinitionKeyListæŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨</li><li>å€™é€‰äººè®¤é¢†ä»»åŠ¡ï¼ˆå¦‚æœæœ‰callBack,è°ƒç”¨callbackï¼‰: taskService.claim(task.getId(), claimTaskForm.getUserLoginName());</li><li>æŸ¥çœ‹å¾…åŠä»»åŠ¡ï¼šæ ¹æ®å‰ç«¯ä¼ è¿‡æ¥çš„loginName, processDefinitionKeyListæŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨</li><li>å®Œæˆä»»åŠ¡ï¼šcompleteTask</li><li>æ‰§è¡Œå®Œæˆä»»åŠ¡å›è°ƒcompleteFeedbackï¼Œ æ¯”å¦‚ï¼šå½“å‰æµç¨‹çš„å¡«å……å®¡æ‰¹å®Œæˆæ—¶é—´</li></ol>]]></content>
    
    
    <categories>
      
      <category>Activiti</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Activiti BPMN visualizer çš„å®‰è£…å’Œä½¿ç”¨</title>
    <link href="/Activiti-BPMN-visualizer-%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/"/>
    <url>/Activiti-BPMN-visualizer-%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1 å®‰è£…"></a>1 å®‰è£…</h1><p>æ’ä»¶é‡Œæœç´¢Activiti BPMN visualizerå®‰è£…</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230128163406.png"></p><h1 id="2-ç”»ä¸€ä¸ªæµç¨‹å›¾"><a href="#2-ç”»ä¸€ä¸ªæµç¨‹å›¾" class="headerlink" title="2 ç”»ä¸€ä¸ªæµç¨‹å›¾"></a>2 ç”»ä¸€ä¸ªæµç¨‹å›¾</h1><h2 id="1-å³é”®ç”Ÿæˆä¸€ä¸ªbpmn20-xmlæ–‡ä»¶"><a href="#1-å³é”®ç”Ÿæˆä¸€ä¸ªbpmn20-xmlæ–‡ä»¶" class="headerlink" title="1. å³é”®ç”Ÿæˆä¸€ä¸ªbpmn20.xmlæ–‡ä»¶"></a>1. å³é”®ç”Ÿæˆä¸€ä¸ªbpmn20.xmlæ–‡ä»¶</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230128163554.png"></p><h2 id="2-åœ¨æ–‡ä»¶çš„ä»»æ„ä½ç½®ç‚¹å‡»å³é”®ï¼šview-bpmn-Activiti-Diagram"><a href="#2-åœ¨æ–‡ä»¶çš„ä»»æ„ä½ç½®ç‚¹å‡»å³é”®ï¼šview-bpmn-Activiti-Diagram" class="headerlink" title="2. åœ¨æ–‡ä»¶çš„ä»»æ„ä½ç½®ç‚¹å‡»å³é”®ï¼šview bpmn(Activiti)Diagram"></a>2. åœ¨æ–‡ä»¶çš„ä»»æ„ä½ç½®ç‚¹å‡»å³é”®ï¼šview bpmn(Activiti)Diagram</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/202301281638479.png"></p><h2 id="3-æ‰“å¼€å¯è§†åŒ–ç¼–è¾‘å™¨ï¼Œ"><a href="#3-æ‰“å¼€å¯è§†åŒ–ç¼–è¾‘å™¨ï¼Œ" class="headerlink" title="3. æ‰“å¼€å¯è§†åŒ–ç¼–è¾‘å™¨ï¼Œ"></a>3. æ‰“å¼€å¯è§†åŒ–ç¼–è¾‘å™¨ï¼Œ</h2><ol><li>å³é”®start events â€“&gt;start eventç”»ä¸€ä¸ªå¼€å§‹äº‹ä»¶ã€‚</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230128163950.png"></p><ol start="2"><li><p>ç”¨æˆ·ä»»åŠ¡</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230128164045.png"></p></li><li><p>æ·»åŠ ç»“æŸ</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230128164125.png"></p></li><li><p>è¿çº¿</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230128164453.png"></p></li><li><p>æŸ¥çœ‹æ›´æ–°åçš„xmlæ–‡ä»¶</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230128164612.png"></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>Activiti</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>jenkinsé›†æˆéƒ¨ç½²ç¯å¢ƒæ„å»º</title>
    <link href="/jenkins%E9%9B%86%E6%88%90%E9%83%A8%E7%BD%B2%E7%8E%AF%E5%A2%83%E6%9E%84%E5%BB%BA/"/>
    <url>/jenkins%E9%9B%86%E6%88%90%E9%83%A8%E7%BD%B2%E7%8E%AF%E5%A2%83%E6%9E%84%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<p>æ›´æ–°æœºåˆ¶æ˜¯æŒ‡é¡¹ç›®å¦‚ä½•è¿›è¡Œæ›´æ–°ï¼Œä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼šä¸€ç§æ˜¯è‡ªåŠ¨æ¨é€ï¼Œå¦å¤–ä¸€ç§æ˜¯æ‰‹åŠ¨æ‹‰å–ã€‚å‰è€…ç”¨äºå¼€å‘ç¯å¢ƒã€åè€…å¯ä»¥ç”¨äºæ‰€æœ‰ç¯å¢ƒ</p><h1 id="1-æ‰‹åŠ¨æ‹‰å–"><a href="#1-æ‰‹åŠ¨æ‹‰å–" class="headerlink" title="1. æ‰‹åŠ¨æ‹‰å–"></a>1. æ‰‹åŠ¨æ‹‰å–</h1><p>æ‹‰å–æ›´æ–°æµç¨‹ï¼š</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230126125309.png" style="zoom:40%;" /><ol><li>sudo -i è¾“å…¥å¯†ç ï¼Œè¿›å…¥rootç›®å½•</li><li>ä¸Šè¿°æµç¨‹ç”± deploy.sh è„šæœ¬å®ç°ï¼š</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash -e</span><br><span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;`dirname <span class="hljs-variable">$0</span>`&quot;</span><br>. ./pom.sh<br><br><span class="hljs-comment">#1. download war, ready env</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;deploy time: <span class="hljs-variable">$work_time</span>&quot;</span><br>mkdir -p war/<br>war=war/<span class="hljs-variable">$pom_a</span>-<span class="hljs-variable">$pom_v</span>.war<br>download_path=<span class="hljs-string">&quot;<span class="hljs-variable">$nexus_redirect</span>?r=<span class="hljs-variable">$pom_r</span>&amp;g=<span class="hljs-variable">$pom_g</span>&amp;a=<span class="hljs-variable">$pom_a</span>&amp;v=<span class="hljs-variable">$pom_v</span>&amp;e=war&quot;</span><br>wget  <span class="hljs-variable">$download_path</span> -O <span class="hljs-variable">$war</span><br><br>deploy_war<br></code></pre></td></tr></table></figure><p>pom.sh è„šæœ¬å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs xml">#!/bin/bash -e<br>. ../bin/env-set.sh<br><br>pom_g=org.example<br>pom_a=test-jenkins<br>pom_v=1.0-SNAPSHOT<br>pom_r=snapshots<br><br><br>deploy_war() &#123;<br>        target_d=war/$&#123;pom_a&#125;-$&#123;pom_v&#125;-$work_time<br>        target_dir=`pwd`/$target_d<br>        if [ ! -f &quot;$war&quot; ]; then<br>                echo &quot;war not exist: $war&quot;<br>                exit 1<br>        fi<br>        unzip -q $war -d $target_dir<br>        rm -rf appwar<br>        ln -sf $target_d appwar<br><br>        ./tomcat.sh stop<br><br>        target_ln=`pwd`/appwar<br>        echo &#x27;<span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Context</span> <span class="hljs-attr">docBase</span>=<span class="hljs-string">&quot;&#x27;$target_ln&#x27;&quot;</span> <span class="hljs-attr">allowLinking</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Context</span>&gt;</span>&#x27; &gt; conf/Catalina/localhost/ROOT.xml<br>        ./tomcat.sh start<br>&#125;<br></code></pre></td></tr></table></figure><p>tomcat.sh å†…å®¹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;`whoami`&quot;</span> != <span class="hljs-string">&quot;root&quot;</span> ];<span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Error: You must be apps to run this command.&quot;</span><br><span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br><span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;`dirname <span class="hljs-variable">$0</span>`&quot;</span><br>. ../bin/env-set.sh<br>. ./pom.sh<br><br><span class="hljs-built_in">export</span> CATALINA_BASE=<span class="hljs-string">&quot;`pwd`&quot;</span><br>tomcat <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;pom_a&#125;</span>-<span class="hljs-variable">$&#123;pom_v&#125;</span>&quot;</span><br></code></pre></td></tr></table></figure><p> env-set.shå†…å®¹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash -e</span><br><span class="hljs-comment">#å½“å‰æ—¶é—´</span><br><span class="hljs-built_in">export</span> now_time=$(date +%Y-%m-%d_%H-%M-%S)<br><span class="hljs-comment">#æ•´ä¸ªæœŸé—´çš„å¼€å§‹æ—¶é—´</span><br>[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$work_time</span>&quot;</span> ] &amp;&amp; <span class="hljs-built_in">export</span> work_time=$(date +%Y-%m-%d_%H-%M-%S)<br><br><span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$g_env_set</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">unset</span> JRE_HOME JAVA_HOME CLASSPATH<br><span class="hljs-built_in">export</span> nexus_redirect=<span class="hljs-string">&quot;http://localhost:8081/nexus/service/local/artifact/maven/redirect&quot;</span><br><span class="hljs-built_in">export</span> data_home=<span class="hljs-string">&quot;/var/root/svr&quot;</span><br><span class="hljs-built_in">export</span> server_home=<span class="hljs-string">&quot;<span class="hljs-variable">$data_home</span>/services&quot;</span><br><span class="hljs-built_in">export</span> JAVA_HOME=<span class="hljs-string">&quot;<span class="hljs-variable">$data_home</span>/jdk&quot;</span><br><span class="hljs-built_in">export</span> CATALINA_HOME=<span class="hljs-string">&quot;<span class="hljs-variable">$data_home</span>/apache-tomcat&quot;</span><br><span class="hljs-built_in">export</span> CATALINA_BASE=<span class="hljs-string">&quot;<span class="hljs-variable">$CATALINA_HOME</span>&quot;</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$JAVA_HOME</span>/bin:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> g_env_set=<span class="hljs-literal">true</span><br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment">#èƒ½å¤Ÿè¾“å…¥2ä¸ªgrepçš„å­—ç¬¦ä¸²ç”¨æ¥æŸ¥æ‰¾</span><br><span class="hljs-function"><span class="hljs-title">proc_find</span></span>() &#123;<br>        <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$#</span>&quot;</span> = 2 ]; <span class="hljs-keyword">then</span><br>                ps -eo pid,cmd|grep -v <span class="hljs-string">&#x27;cmd\|grep&#x27;</span>|grep <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>|grep <span class="hljs-string">&quot;<span class="hljs-variable">$2</span>&quot;</span>|sed <span class="hljs-string">&#x27;s/^ *\(.*\) *$/\1/&#x27;</span><br>        <span class="hljs-keyword">else</span><br>                ps -eo pid,cmd|grep -v <span class="hljs-string">&#x27;cmd\|grep&#x27;</span>|grep <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>|sed <span class="hljs-string">&#x27;s/^ *\(.*\) *$/\1/&#x27;</span><br>        <span class="hljs-keyword">fi</span><br>&#125;<br><span class="hljs-comment">#èƒ½å¤Ÿè¾“å…¥2ä¸ªgrepçš„å­—ç¬¦ä¸²ç”¨æ¥æŸ¥æ‰¾</span><br><span class="hljs-function"><span class="hljs-title">proc_pid</span></span>() &#123;<br>        proc_find <span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span> | cut -d <span class="hljs-string">&#x27; &#x27;</span> -f1<br>&#125;<br><span class="hljs-comment">#$1: è¦é‡è¯•çš„æ¬¡æ•°ï¼Œè¶…è¿‡æ­¤æ¬¡æ•°åä½¿ç”¨kill -9</span><br><span class="hljs-comment">#$2: èƒ½å¤Ÿè¾“å…¥2ä¸ªgrepçš„å­—ç¬¦ä¸²ç”¨æ¥æŸ¥æ‰¾</span><br><span class="hljs-function"><span class="hljs-title">proc_kill</span></span>() &#123;<br>        grep_args=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;@:2&#125;</span>&quot;</span><br>        <span class="hljs-keyword">for</span> ((i=1;i&lt;=<span class="hljs-variable">$1</span>;++i))<br>        <span class="hljs-keyword">do</span><br>                pids=(`proc_pid <span class="hljs-string">&quot;<span class="hljs-variable">$grep_args</span>&quot;</span>`)<br>                [ <span class="hljs-variable">$&#123;#pids[@]&#125;</span> = 0 ] &amp;&amp; <span class="hljs-built_in">return</span> 0<br><br>                <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;n=<span class="hljs-variable">$i</span> kill <span class="hljs-variable">$&#123;pids[@]&#125;</span>&quot;</span><br>                <span class="hljs-built_in">kill</span> <span class="hljs-variable">$&#123;pids[@]&#125;</span><br>                sleep 1s<br>        <span class="hljs-keyword">done</span><br>        pids=(`proc_pid <span class="hljs-string">&quot;<span class="hljs-variable">$grep_args</span>&quot;</span>`)<br>        [ <span class="hljs-variable">$&#123;#pids[@]&#125;</span> = 0 ] || <span class="hljs-built_in">kill</span> -9 <span class="hljs-variable">$&#123;pids[@]&#125;</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">tomcat_start0</span></span>() &#123;<br><br>[ <span class="hljs-string">&quot;<span class="hljs-variable">$JAVA_OPTS</span>&quot;</span> = <span class="hljs-string">&quot;&quot;</span> ] &amp;&amp; <span class="hljs-built_in">export</span> JAVA_OPTS=<span class="hljs-string">&quot;-server -XX:MaxPermSize=128m -Xms512m -Xmx512m&quot;</span><br>[ <span class="hljs-string">&quot;`echo &quot;</span><span class="hljs-variable">$JAVA_OPTS</span><span class="hljs-string">&quot;|grep &#x27;\-Djava.security.egd=&#x27;`&quot;</span> = <span class="hljs-string">&quot;&quot;</span> ] &amp;&amp; <span class="hljs-built_in">export</span> JAVA_OPTS=<span class="hljs-string">&quot;<span class="hljs-variable">$JAVA_OPTS</span> -Djava.security.egd=file:/dev/./urandom&quot;</span><br><span class="hljs-comment">#é˜²æ­¢X11å¯¼è‡´awtåœ¨X11å…³é—­åå¼‚å¸¸</span><br><span class="hljs-built_in">export</span> JAVA_OPTS=<span class="hljs-string">&quot;-Djava.awt.headless=true <span class="hljs-variable">$JAVA_OPTS</span> -<span class="hljs-variable">$grep_server</span>&quot;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;START <span class="hljs-variable">$grep_server</span>: JAVA_OPTS=<span class="hljs-variable">$JAVA_OPTS</span>&quot;</span><br><span class="hljs-string">&quot;<span class="hljs-variable">$CATALINA_HOME</span>&quot;</span>/bin/startup.sh<br>&#125;<br><span class="hljs-function"><span class="hljs-title">tomcat_stop0</span></span>() &#123;<br>proc_kill 3 <span class="hljs-string">&quot;<span class="hljs-variable">$grep_server</span>&quot;</span><br>&#125;<br><span class="hljs-function"><span class="hljs-title">tomcat_status0</span></span>() &#123;<br>tmp=`proc_find <span class="hljs-string">&quot;<span class="hljs-variable">$grep_server</span>&quot;</span>`<br><span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$tmp</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$grep_server</span> stopped.&quot;</span><br><span class="hljs-keyword">else</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$grep_server</span> running: <span class="hljs-variable">$tmp</span>&quot;</span><br><span class="hljs-keyword">fi</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">tomcat</span></span>() &#123;<br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> = <span class="hljs-string">&quot;&quot;</span> ]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;Usage: %s &#123;start|stop|restart|status&#125; ????\n&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$prog</span>&quot;</span><br><span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$2</span>&quot;</span> = <span class="hljs-string">&quot;&quot;</span> ]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;java -Dmykey=$&#123;mykey&#125; miss: mykey&#x27;</span><br><span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$CATALINA_BASE</span>&quot;</span> = <span class="hljs-string">&quot;&quot;</span> ]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;miss: $CATALINA_BASE=&#x27;</span><br><span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br><span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;<span class="hljs-variable">$CATALINA_BASE</span>&quot;</span><br><span class="hljs-built_in">export</span> grep_server=<span class="hljs-string">&quot;Dmykey=<span class="hljs-variable">$&#123;2&#125;</span>x&quot;</span><br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> <span class="hljs-keyword">in</span><br>start)<br>tmp=`proc_find <span class="hljs-string">&quot;<span class="hljs-variable">$grep_server</span>&quot;</span>`<br><span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$tmp</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>tomcat_start0<br><span class="hljs-keyword">else</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$grep_server</span> already running: <span class="hljs-variable">$tmp</span>&quot;</span><br><span class="hljs-keyword">fi</span><br>sleep 1s<br><span class="hljs-comment">#tomcat_status0</span><br>;;<br>stop)<br>tomcat_stop0<br>tomcat_status0<br>;;<br>status)<br>tomcat_status0<br>;;<br>restart)<br>tomcat_stop0<br>tomcat_start0<br>sleep 1s<br>tomcat_status0<br>;;<br>*)<br><span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;Usage: %s &#123;start|stop|restart|status&#125; ????\n&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$prog</span>&quot;</span><br><span class="hljs-built_in">exit</span> 1<br>;;<br><span class="hljs-keyword">esac</span><br>&#125;<br></code></pre></td></tr></table></figure><p>é¡¹ç›®æ‰“åŒ…å®Œæˆåï¼Œè¿è¡Œ<code>deploy.sh</code>å®Œæˆæ›´æ–°</p><p><strong>ä»£ç åœ°å€</strong>ï¼š<a href="https://github.com/pyr9/jenkins-script">pyr9&#x2F;jenkins-script (github.com)</a></p><h1 id="2-è‡ªåŠ¨æ¨é€"><a href="#2-è‡ªåŠ¨æ¨é€" class="headerlink" title="2 è‡ªåŠ¨æ¨é€"></a>2 è‡ªåŠ¨æ¨é€</h1><p>è‡ªåŠ¨æ¨é€æ–¹å¼é‡‡ç”¨åœ¨ jenkins æ„å»ºå®Œæˆä¹‹åï¼Œæ‰§è¡Œè¿œç¨‹ sh è„šæœ¬ç”¨äºä¸‹è½½æœ¬æ¬¡æ„å»º WAR åŒ…ï¼Œåœ¨è‡ªåŠ¨éƒ¨ç½²é‡å¯ã€‚</p><h3 id="1-jenkins-æˆäºˆå¯è¯»æƒé™"><a href="#1-jenkins-æˆäºˆå¯è¯»æƒé™" class="headerlink" title="1. jenkins æˆäºˆå¯è¯»æƒé™"></a>1. jenkins æˆäºˆå¯è¯»æƒé™</h3><p>ä¸é…ç½®ä¼š403</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230206160008255.png" alt="image-20230206160008255"></p><h3 id="2-jenkins-é…ç½®æ‰§è¡Œè„šæœ¬"><a href="#2-jenkins-é…ç½®æ‰§è¡Œè„šæœ¬" class="headerlink" title="2. jenkins é…ç½®æ‰§è¡Œè„šæœ¬"></a>2. jenkins é…ç½®æ‰§è¡Œè„šæœ¬</h3><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230206154056839.png" alt="image-20230206154056839"></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">BUILD_ID=dontKillMe<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$BUILD_ID</span><br>ssh root@localhost BUILD_URL=<span class="hljs-variable">$BUILD_URL</span> /var/root/svr/services/test-jenkins-demo/jenkins.sh<br></code></pre></td></tr></table></figure><p> jenkins.shå†…å®¹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash -e</span><br><span class="hljs-built_in">source</span> /etc/profile<br><span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;`dirname <span class="hljs-variable">$0</span>`&quot;</span><br>. ./pom.sh<br><br><br><span class="hljs-comment">#1. download war, ready env</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;deploy time: <span class="hljs-variable">$work_time</span>&quot;</span><br>mkdir -p war/<br><span class="hljs-comment"># é…ç½®ä¸‹è½½å­˜æ”¾ç›®å½•</span><br>war=war/<span class="hljs-variable">$pom_a</span>-<span class="hljs-variable">$pom_v</span>.war<br><span class="hljs-comment"># åŸºäºè¿œç¨‹ä¼ è¿‡æ¥çš„ BUILD_URLä¸‹è½½æœ¬æ¬¡æ„å»º</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BUILD_URL&#125;</span><span class="hljs-variable">$&#123;pom_g&#125;</span>\$<span class="hljs-variable">$&#123;pom_a&#125;</span>/artifact/<span class="hljs-variable">$pom_g</span>/<span class="hljs-variable">$pom_a</span>/<span class="hljs-variable">$pom_v</span>/<span class="hljs-variable">$pom_a</span>-<span class="hljs-variable">$pom_v</span>.war&quot;</span><br>/opt/homebrew/bin/wget  <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BUILD_URL&#125;</span><span class="hljs-variable">$&#123;pom_g&#125;</span>\$<span class="hljs-variable">$&#123;pom_a&#125;</span>/artifact/<span class="hljs-variable">$pom_g</span>/<span class="hljs-variable">$pom_a</span>/<span class="hljs-variable">$pom_v</span>/<span class="hljs-variable">$pom_a</span>-<span class="hljs-variable">$pom_v</span>.war&quot;</span> -O <span class="hljs-variable">$war</span><br><span class="hljs-comment"># æ‰§è¡Œéƒ¨ç½²å‡½æ•°</span><br>deploy_war<br></code></pre></td></tr></table></figure><h3 id="3-sshè®¾ç½®å…å¯†ç™»å½•"><a href="#3-sshè®¾ç½®å…å¯†ç™»å½•" class="headerlink" title="3. sshè®¾ç½®å…å¯†ç™»å½•"></a>3. sshè®¾ç½®å…å¯†ç™»å½•</h3><p>ï¼ˆæ·»åŠ å…¬é’¥åˆ°æœåŠ¡å™¨ï¼‰<a href="https://pyr9.github.io/SSH%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95/">SSHå…å¯†ç™»å½• - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p><p>æ³¨æ„äº‹é¡¹âš ï¸ï¼š</p><ol><li>ä¸Šé¢å¦‚æœä½¿ç”¨wget è€Œä¸æ˜¯&#x2F;opt&#x2F;homebrew&#x2F;bin&#x2F;wget ä¼šå‡ºç°  404 Not Found</li></ol>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>é¡¹ç›®éƒ¨ç½²åˆ°tomcatçš„ä¸‰ç§æ–¹å¼</title>
    <link href="/%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E5%88%B0tomcat/"/>
    <url>/%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E5%88%B0tomcat/</url>
    
    <content type="html"><![CDATA[<h1 id="1-é¡¹ç›®ç›´æ¥æ”¾å…¥-webapps-ç›®å½•ä¸­"><a href="#1-é¡¹ç›®ç›´æ¥æ”¾å…¥-webapps-ç›®å½•ä¸­" class="headerlink" title="1.é¡¹ç›®ç›´æ¥æ”¾å…¥ webapps ç›®å½•ä¸­"></a>1.<strong>é¡¹ç›®ç›´æ¥æ”¾å…¥ webapps ç›®å½•ä¸­</strong></h1><ol><li>æŠŠé¡¹ç›®æ‰“åŒ…ï¼Œæ”¾å…¥webappsç›®å½•ä¸‹</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/202301242001681.png"></p><ol start="2"><li><p>ä¾æ¬¡è¿è¡Œtomcat çš„binç›®å½•ä¸‹<code>shutdown.sh</code>,<code>startup.sh</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230124200306.png"></p></li><li><p>åœ¨æµè§ˆå™¨è¾“å…¥ï¼š<a href="http://localhost:8080/%E9%A1%B9%E7%9B%AE%E5%90%8D%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%BF%9B%E5%85%A5%E5%88%B0%E9%A1%B9%E7%9B%AE%E7%9A%84index%E9%A1%B5%E9%9D%A2">http://localhost:8080/é¡¹ç›®åï¼Œå°±å¯ä»¥è¿›å…¥åˆ°é¡¹ç›®çš„indexé¡µé¢</a></p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230124200912.png"  /><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230124200828.png"></p></li></ol><h1 id="2-ä¿®æ”¹-conf-x2F-server-xml-æ–‡ä»¶"><a href="#2-ä¿®æ”¹-conf-x2F-server-xml-æ–‡ä»¶" class="headerlink" title="2 ä¿®æ”¹ conf&#x2F;server.xml æ–‡ä»¶"></a>2 <strong>ä¿®æ”¹ conf&#x2F;server.xml æ–‡ä»¶</strong></h1><p>è¿›å…¥tomcatä¸‹conf&#x2F;server.xmlï¼Œåœ¨<code>&lt;Host&gt; &lt;/Host&gt;</code>æ ‡ç­¾ä¹‹é—´è¾“å…¥é¡¹ç›®é…ç½®ä¿¡æ¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Context</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/test01&quot;</span> <span class="hljs-attr">docBase</span>=<span class="hljs-string">&quot;/Users/xxx/test-jenkins-1.0-RELEASE&quot;</span> <span class="hljs-attr">reloadable</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><ul><li><p><strong>path</strong>:æµè§ˆå™¨è®¿é—®æ—¶çš„è·¯å¾„å</p></li><li><p><strong>docBase</strong>:webé¡¹ç›®çš„WebRootæ‰€åœ¨çš„è·¯å¾„ï¼Œæ³¨æ„æ˜¯WebRootçš„è·¯å¾„ï¼Œä¸æ˜¯é¡¹ç›®çš„è·¯å¾„ï¼Œå…¶å®ä¹Ÿ<strong>å°±æ˜¯ç¼–è¯‘åçš„é¡¹ç›®è·¯å¾„</strong>ï¼ˆè§£å‹åçš„j aråŒ…è·¯å¾„ï¼‰ã€‚</p></li><li><p><em><strong>reloadble</strong>:è®¾å®šé¡¹ç›®æœ‰æ”¹åŠ¨æ—¶ï¼Œtomcatæ˜¯å¦é‡æ–°åŠ è½½è¯¥é¡¹ç›®</em></p></li></ul><h1 id="3-conf-x2F-Catalina"><a href="#3-conf-x2F-Catalina" class="headerlink" title="3 conf&#x2F;Catalina"></a>3 <strong>conf&#x2F;Catalina</strong></h1><ol><li><p>å…¥åˆ° apache-tomcat-7.0.52\conf\Catalina\localhost ç›®å½•ï¼Œæ–°å»ºä¸€ä¸ª <code>ROOT.xml</code> æ–‡ä»¶</p></li><li><p>åœ¨é‚£ä¸ªæ–°å»ºçš„ xml æ–‡ä»¶ä¸­ï¼Œå¢åŠ ä¸‹é¢é…ç½®è¯­å¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Context</span> <span class="hljs-attr">docBase</span>=<span class="hljs-string">&quot;/Users/panyurou/test-jenkins-1.0-RELEASE&quot;</span> <span class="hljs-attr">reloadable</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>åœ¨æµè§ˆå™¨è¾“å…¥è·¯å¾„ï¼šlocalhost:8080</p></li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230126154643.png"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ç‰ˆæœ¬å¿«é€Ÿè¿­ä»£æµç¨‹è®¾è®¡</title>
    <link href="/%E7%89%88%E6%9C%AC%E5%BF%AB%E9%80%9F%E8%BF%AD%E4%BB%A3%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1/"/>
    <url>/%E7%89%88%E6%9C%AC%E5%BF%AB%E9%80%9F%E8%BF%AD%E4%BB%A3%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ•´ä½“æµç¨‹è®¾è®¡"><a href="#1-æ•´ä½“æµç¨‹è®¾è®¡" class="headerlink" title="1 æ•´ä½“æµç¨‹è®¾è®¡"></a>1 æ•´ä½“æµç¨‹è®¾è®¡</h1><ol><li>ä¸åŒçš„å¼€å‘æäº¤å½“å¤©çš„å˜åŠ¨åˆ°ç»Ÿä¸€çš„ä»£ç ä»“åº“</li><li>jenkinsé›†æˆéƒ¨ç½²åˆ°å¼€å‘ç¯å¢ƒ</li><li>æµ‹è¯•æ‰‹åŠ¨ä»jenkinsçš„testä»“åº“æ‹‰å–æ‰“å¥½çš„jaråŒ…ï¼Œéƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒï¼Œè¿›è¡Œæµ‹è¯•</li><li>æµ‹è¯•å®Œæˆåç”±è¿ç»´ä»jenkinsçš„releaseä»“åº“æ‹‰å–æ‰“å¥½çš„jaråŒ…ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230124123255413.png" alt="image-20230124123255413"></p><h1 id="2-å‘å¸ƒçª—å£æœºåˆ¶"><a href="#2-å‘å¸ƒçª—å£æœºåˆ¶" class="headerlink" title="2. å‘å¸ƒçª—å£æœºåˆ¶"></a>2. å‘å¸ƒçª—å£æœºåˆ¶</h1><p>ä¸Šè¿°å‘å¸ƒæµç¨‹æ˜¯æ¯”è¾ƒé‡çš„ï¼Œæˆ‘ä»¬ä¸å¯èƒ½æ¯å¤©èµ°ä¸€éã€‚å¯ä»¥è®¾ç½®ä¸€ä¸ªå›ºå®šçš„å‘å¸ƒæ—¶é—´ï¼Œä¸€èˆ¬è®¾ç½®åœ¨å‘¨å››ã€‚</p><ul><li><p>æ¯”å¦‚å‘¨å››ä¸‹åˆå››ç‚¹ï¼Œå¦‚æœè¿™ä¸ªç‚¹è¿˜æ²¡æœ‰æ¥å¾—åŠå®ç°æˆ–è€…å®Œæˆæµ‹è¯•ï¼Œåˆ™éœ€è¦ç­‰åˆ°ä¸‹ä¸ªçª—å£æ‰èƒ½å‘å¸ƒã€‚</p></li><li><p>è¿™æ ·çš„ç›®çš„ï¼šæ˜¯ä¸ºäº†è®©å›¢é˜Ÿçš„æ¯ä¸ªäººæœ‰ä¸€ä¸ªæ¸…æ™°çš„æ—¶é—´è§‚å¿µï¼ŒçŸ¥é“ä»€ä¹ˆæ—¶å€™å¹²ä»€ä¹ˆäº‹ï¼Œé¿å…æ‰‹å¿™è„šä¹±è„šä¹±çš„éšæ„å‘å¸ƒã€‚</p></li></ul><h1 id="3-å‘å¸ƒè®¡åˆ’"><a href="#3-å‘å¸ƒè®¡åˆ’" class="headerlink" title="3. å‘å¸ƒè®¡åˆ’"></a>3. å‘å¸ƒè®¡åˆ’</h1><ul><li><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„éœ€æ±‚ä¹‹é—´æ˜¯æœ‰è”ç³»çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æå‰è®¡åˆ’å¥½ä¸‹ä¸ªçª—å£èƒ½ä¸Šçº¿çš„éœ€æ±‚ï¼Œé¿å…Aéœ€æ±‚ä¸Šçº¿æ—¶ï¼Œä»–æ‰€ä¾èµ–çš„Béœ€æ±‚ä¸èƒ½ä¸Šçº¿ã€‚</p></li><li><p>ä¸­é—´éšæ„æ·»åŠ éœ€æ±‚ï¼Œä¼šä½¿å‘å¸ƒå˜çš„å›°éš¾ã€‚</p></li></ul><h1 id="4-å®æ–½è®¡åˆ’"><a href="#4-å®æ–½è®¡åˆ’" class="headerlink" title="4 å®æ–½è®¡åˆ’"></a>4 å®æ–½è®¡åˆ’</h1><p>é™¤äº†å‘å¸ƒè®¡åˆ’ï¼Œæˆ‘ä»¬éœ€è¦æœ‰å®æ–½è¯´æ˜ï¼Œæ¯”å¦‚ï¼šéœ€è¦æ›´æ–°é‚£äº›sqlè„šæœ¬ï¼Œä¿®æ”¹å“ªäº›é…ç½®æ–‡ä»¶</p><h1 id="5-æ—¶é—´èŠ‚ç‚¹"><a href="#5-æ—¶é—´èŠ‚ç‚¹" class="headerlink" title="5 æ—¶é—´èŠ‚ç‚¹"></a>5 æ—¶é—´èŠ‚ç‚¹</h1><p>æ•´ä¸ªè¿‡ç¨‹æ¶‰åŠå›¢é˜Ÿåä½œï¼Œåªè¦æœ‰ä¸€æ–¹å»¶è¯¯ï¼Œå°±ä¼šé€ æˆå…¶ä»–æ–¹ç­‰å¾…æˆ–è€…å·¥ä½œæ¨è¿Ÿå‘ç”Ÿã€‚ä¸ºé¿å…è¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦è®¾è®¡ç²¾ç»†çš„æ—¶é—´èŠ‚ç‚¹å¦‚ä¸‹ï¼š</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230128200518146.png" alt="image-20230128200518146" style="zoom:50%;" />]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>macä¸‹å¯åŠ¨tomcat</title>
    <link href="/mac%E4%B8%8B%E5%90%AF%E5%8A%A8tomcat/"/>
    <url>/mac%E4%B8%8B%E5%90%AF%E5%8A%A8tomcat/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1. å®‰è£…"></a>1. å®‰è£…</h1><p>ç™»å½•Apache Tomcatå®˜ç½‘ï¼Œåœ°å€ <a href="http://tomcat.apache.org/">http://tomcat.apache.org</a> ï¼Œå·¦è¾¹çš„Downloadï¼Œç‚¹å‡»é€‰æ‹©éœ€è¦ä¸‹è½½çš„ç‰ˆæœ¬ Tomcat8</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230115204748.png"></p><h2 id="2-å¯åŠ¨"><a href="#2-å¯åŠ¨" class="headerlink" title="2 å¯åŠ¨"></a>2 å¯åŠ¨</h2><p>ä¸‹è½½ä¸‹æ¥è§£å‹ï¼Œè¿›å…¥binç›®å½•ï¼Œè¿è¡Œ<code>./startup.sh</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230115205133.png"></p><p>åœæ­¢è¿è¡Œ <code>./shutdown.sh</code></p><h1 id="3-ä¿®æ”¹é»˜è®¤ç«¯å£å·"><a href="#3-ä¿®æ”¹é»˜è®¤ç«¯å£å·" class="headerlink" title="3 ä¿®æ”¹é»˜è®¤ç«¯å£å·"></a>3 ä¿®æ”¹é»˜è®¤ç«¯å£å·</h1><p>ä¸ä¿®æ”¹çš„è¯ï¼Œå¯ä»¥ç›´æ¥è®¿é—®8080ç«¯å£ï¼Œæˆ‘è¿™é‡Œä¿®æ”¹æˆäº†8888</p><ol><li>è¿›å…¥conf ç›®å½• <code>cd conf</code></li><li>ä¿®æ”¹server.xml  <code>vim server.xml</code></li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230115205500.png"></p><h1 id="4-è®¾ç½®ç”¨æˆ·ä¿¡æ¯"><a href="#4-è®¾ç½®ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="4 è®¾ç½®ç”¨æˆ·ä¿¡æ¯"></a>4 è®¾ç½®ç”¨æˆ·ä¿¡æ¯</h1><p>å¦‚æœéœ€è¦manager Appï¼Œè¿˜éœ€è¦å¢åŠ ç”¨æˆ·åå’Œå¯†ç </p><ol><li><p>è¿›å…¥conf ç›®å½• <code>cd conf</code></p></li><li><p>ä¿®æ”¹server.xml  <code>vim tomcat-users.xml</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230115205918.png"></p></li></ol><h1 id="5-è®¿é—®-8888ç«¯å£"><a href="#5-è®¿é—®-8888ç«¯å£" class="headerlink" title="5 è®¿é—® 8888ç«¯å£"></a>5 è®¿é—® 8888ç«¯å£</h1><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230115210632.png"></p>]]></content>
    
    
    <categories>
      
      <category>tomcat</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>nexusç§æœæ­å»ºä¸æ ¸å¿ƒåŠŸèƒ½</title>
    <link href="/nexus%E7%A7%81%E6%9C%8D%E6%90%AD%E5%BB%BA%E4%B8%8E%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD/"/>
    <url>/nexus%E7%A7%81%E6%9C%8D%E6%90%AD%E5%BB%BA%E4%B8%8E%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ç§æœæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-ç§æœæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. ç§æœæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. ç§æœæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>ç§æœæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è¿œç¨‹ä»“åº“ï¼Œå®ƒæ˜¯æ¶è®¾åœ¨å±€åŸŸç½‘å†…çš„ä»“åº“æœåŠ¡ã€‚ç§æœä»£ç†å¹¿åŸŸç½‘ä¸Šçš„è¿œç¨‹ä»“åº“ï¼Œä¾›å±€åŸŸç½‘å†…çš„Mavenç”¨æˆ·ä½¿ç”¨ã€‚</p><p>å½“Mavenéœ€è¦ä¸‹è½½æ„å»ºçš„ä½¿ç”¨ï¼Œå®ƒå…ˆä»ç§æœè¯·æ±‚ï¼Œå¦‚æœç§æœä¸Šæ²¡æœ‰çš„è¯ï¼Œåˆ™ä»å¤–éƒ¨çš„è¿œç¨‹ä»“åº“ä¸‹è½½ï¼Œç„¶åç¼“å­˜åœ¨ç§æœä¸Šï¼Œå†ä¸ºMavençš„ä¸‹è½½è¯·æ±‚æä¾›æœåŠ¡ã€‚</p><p><strong>ä½¿ç”¨ç§æœçš„å¥½å¤„</strong></p><ul><li>èŠ‚çœè‡ªå·±çš„å¤–ç½‘å¸¦å®½ï¼šå¤§é‡çš„å¯¹äºå¤–éƒ¨è¿œç¨‹ä»“åº“çš„é‡å¤è¯·æ±‚ä¼šæ¶ˆè€—å¾ˆå¤§çš„å¸¦å®½</li><li>åŠ é€ŸMavençš„æ„å»ºï¼šä¸åœçš„è¯·æ±‚å¤–éƒ¨ä»“åº“æ— ç–‘æ˜¯æ¯”è¾ƒè€—æ—¶çš„ï¼Œ ä½†Mavençš„ä¸€äº›å†…éƒ¨æœºåˆ¶ï¼ˆå¦‚å¿«ç…§æ£€æµ‹ï¼‰è¦æ±‚Mavenåœ¨æ‰§è¡Œæ„å»ºçš„æ—¶å€™ä¸åœåœ°æ£€æŸ¥è¿œç¨‹ä»“åº“çš„æ•°æ®ã€‚å› æ­¤å½“é…ç½®äº†å¾ˆå¤šè¿œç¨‹ä»“åº“æ—¶ï¼Œæ„å»ºçš„é€Ÿåº¦ä¼šè¢«å¤§å¤§é™ä½ã€‚</li><li>éƒ¨ç½²ç¬¬ä¸‰æ–¹æ„ä»¶ï¼šå½“æŸä¸ªæ„ä»¶æ— æ³•ä»å¤–éƒ¨è¿œç¨‹ä»“åº“ä¸‹è½½ã€‚å¦‚Oracleçš„JDBCé©±åŠ¨ç”±äºç‰ˆæƒåŸå› ä¸èƒ½å‘å¸ƒåˆ°å¤–ç½‘çš„ä¸­å¿ƒä»“åº“ï¼Œå»ºç«‹ç§æœä¹‹åä¾¿å¯ä»¥å°†è¿™äº›æ„ä»¶éƒ¨ç½²åˆ°æœ¬åœ°ç§æœä¸­ï¼Œä¾›å†…éƒ¨çš„Mavené¡¹ç›®ä½¿ç”¨ã€‚</li><li>æé«˜ç¨³å®šè¡Œï¼Œå¢å¼ºæ§åˆ¶ã€‚Mavenæ„å»ºæå®šä¾èµ–äºè¿œç¨‹ä»“åº“ï¼Œå› æ­¤ï¼Œå½“Internetä¸ç¨³å®šçš„æ—¶å€™ï¼ŒMavenæ„å»ºä¹Ÿä¼šå˜çš„ä¸ç¨³å®šï¼Œç”šè‡³æ— æ³•æ„å»ºã€‚ä½¿ç”¨ç§æœåå³ä½¿æš‚æ—¶æ²¡æœ‰Internetè¿æ¥Mavenä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œå› ä¸ºç§æœä¸­ç¼“å­˜äº†å¤§é‡çš„æ„ä»¶ã€‚æ­¤å¤–ä¸€äº›ç§æœè½¯ä»¶ï¼ˆå¦‚ï¼šNexusï¼‰è¿˜æä¾›äº†å¾ˆå¤šé¢å¤–çš„åŠŸèƒ½ï¼Œå¦‚æƒé™ç®¡ç†ï¼ŒRELEASE&#x2F;SNAPSHOTåŒºåˆ†ç­‰ï¼Œç®¡ç†å‘˜å¯ä»¥å¯¹ä»“åº“è¿›è¡Œä¸€äº›æ›´é«˜çº§çš„æ§åˆ¶ã€‚</li><li>é™ä½ä¸­å¤®ä»“åº“çš„è´Ÿè·ã€‚æ•°ç™¾ä¸‡çš„è¯·æ±‚ï¼Œå­˜å‚¨æ•°Tçš„æ•°æ®ï¼Œéœ€è¦ç›¸ç›¸å½“å¤§çš„è´¢åŠ›ã€‚ä½¿ç”¨ç§æœå¯ä»¥é¿å…å¾ˆå¤šå¯¹ä¸­å¤®ä»“åº“çš„é‡å¤è¯·æ±‚ã€‚</li></ul><h1 id="2-nexus-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2-nexus-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2 nexus æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2 nexus æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>Nexus æ˜¯ Sonatype å…¬å¸å‘å¸ƒçš„ä¸€æ¬¾ä»“åº“ï¼ˆRepositoryï¼‰ç®¡ç†è½¯ä»¶ï¼Œå¸¸ç”¨æ¥æ­å»º Maven ç§æœï¼Œæ‰€ä»¥ä¹Ÿæœ‰äººå°† Nexus ç§°ä¸ºâ€œMavenä»“åº“ç®¡ç†å™¨â€ã€‚</p><p>Nexus å¼€æºç‰ˆå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p><ul><li>å ç”¨å†…å­˜å°ï¼ˆ28 M å·¦å³ï¼‰</li><li>å…·æœ‰åŸºäº ExtJs å¾—æ“ä½œç•Œé¢ï¼Œç”¨æˆ·ä½“éªŒè¾ƒå¥½</li><li>ä½¿ç”¨åŸºäº Restlet çš„å®Œå…¨ REST API</li><li>æ”¯æŒä»£ç†ä»“åº“ã€å®¿ä¸»ä»“åº“å’Œä»“åº“ç»„</li><li>åŸºäºæ–‡ä»¶ç³»ç»Ÿï¼Œä¸éœ€è¦ä¾èµ–æ•°æ®åº“</li><li>æ”¯æŒä»“åº“ç´¢å¼•ä»¥åŠæœç´¢</li><li>æ”¯æŒåœ¨ç•Œé¢ä¸Šä¸Šä¼ æ„ä»¶</li><li>å®‰å…¨æ§åˆ¶</li></ul><h1 id="3-nexuså®‰è£…"><a href="#3-nexuså®‰è£…" class="headerlink" title="3 nexuså®‰è£…"></a>3 nexuså®‰è£…</h1><ol><li><p>è¿›å…¥<a href="https://help.sonatype.com/repomanager2">Repository Manager 2 (sonatype.com)</a>ï¼Œé€‰æ‹©å¯¹åº”çš„ç‰ˆæœ¬è¿›è¡Œä¸‹è½½</p></li><li><p>ä¸‹è½½è§£å‹åï¼Œè¿›å…¥binç›®å½•ï¼Œè¿è¡Œ <code>./nexus start</code></p></li><li><p>è®¿é—®<a href="http://localhost:8081/nexus">http://localhost:8081/nexus</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230116212514.png"></p></li></ol><p>æ³¨ï¼šnexuså¯åŠ¨å¤±è´¥ï¼ŒæŸ¥çœ‹æŠ¥é”™æ—¥å¿—ï¼ˆnexus-2.15.1-02&#x2F;logs&#x2F;wrapper.logï¼‰</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230116212959.png"></p><p>ä¿®å¤ï¼šå°†javax.activation-1.2.0.jar å’Œjaxb-api-2.3.0.jaråŒ…æ”¾åˆ°nexusçš„libä¸‹</p><p>4  ç™»é™†nexusï¼Œnexus2 é»˜è®¤ç”¨æˆ·åå’Œå¯†ç æ˜¯<code>admin</code> and <code>admin123</code> .ä¸ç¡®å®šçš„å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£<a href="https://help.sonatype.com/repomanager2/installing-and-running/running">Running (sonatype.com)</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230116215507.png"></p><ol start="5"><li><p>æŸ¥çœ‹ä»“åº“</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230116220006.png"></p></li></ol><p>â€‹       å¦‚æœç§æœä¸‹è½½ä¸åˆ°ï¼Œå°±ä¼šå»è¿œç«¯ä»“åº“ä¸‹è½½ï¼Œè¿œç«¯ä»“åº“çš„ä¸‹è½½è·¯å¾„å°±æ˜¯Centralé…ç½®çš„åœ°å€ï¼Œè¿™é‡Œæˆ‘ä¿®æ”¹æˆé˜¿é‡Œé•œåƒåœ°å€</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230117095523.png"></p><h1 id="4-é…ç½®ä»nexusä¸‹è½½ä¾èµ–"><a href="#4-é…ç½®ä»nexusä¸‹è½½ä¾èµ–" class="headerlink" title="4 é…ç½®ä»nexusä¸‹è½½ä¾èµ–"></a>4 é…ç½®ä»nexusä¸‹è½½ä¾èµ–</h1><ol><li>pom.xmlé‡Œé…ç½®ä»“åº“ï¼Œä»“åº“åœ°å€å°±æ˜¯nexusçš„public Repositoriesçš„åœ°å€ï¼Œå¦‚æœæœ‰å¤šä¸ªé¡¹ç›®å¯ä»¥ç›´æ¥é…åˆ°setting.xmlä¸­</li></ol>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;repositories&gt;<br>&lt;repository&gt;<br>&lt;id&gt;nexus-repository&lt;/id&gt;<br>&lt;name&gt;nexus repository&lt;/name&gt;<br>&lt;url&gt;http:<span class="hljs-comment">//localhost:8081/nexus/content/groups/public/&lt;/url&gt;</span><br>&lt;/repository&gt;<br>&lt;/repositories&gt;<br></code></pre></td></tr></table></figure><ol start="2"><li><p>æµ‹è¯•</p><p>åˆ é™¤é¡¹ç›®å·²æœ‰çš„ä¾èµ–ï¼Œé‡æ–°compileé¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä»nexuså»ä¸‹è½½çš„ä¾èµ–ï¼Œæˆ‘è¿™é‡Œæ˜¯æµ‹è¯•çš„junit4</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230117100714.png"></p></li></ol><p>â€‹      æ­¤æ—¶è¿›å…¥publicä»“åº“ï¼Œå¯ä»¥çœ‹åˆ°ç§æœé‡Œå·²ç»å¤šäº†junit</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230117100859.png"></p><h1 id="5-é…ç½®å‘å¸ƒåˆ°nexus"><a href="#5-é…ç½®å‘å¸ƒåˆ°nexus" class="headerlink" title="5 é…ç½®å‘å¸ƒåˆ°nexus"></a>5 é…ç½®å‘å¸ƒåˆ°nexus</h1><ol><li>ä¿®æ”¹pom.xmlï¼Œé…ç½®å‘å¸ƒç‰ˆæœ¬å’Œå¿«ç…§ç‰ˆæœ¬çš„ä»“åº“åœ°å€</li></ol>   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">distributionManagement</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>release-repository<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>release repository<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>http://localhost:8081/nexus/content/repositories/releases/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">snapshotRepository</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>snapshots-repository<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>snapshots repository<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>http://localhost:8081/nexus/content/repositories/snapshots/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">snapshotRepository</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">distributionManagement</span>&gt;</span><br></code></pre></td></tr></table></figure><ol start="2"><li><p>ä¿®æ”¹setting.xmlï¼Œé…ç½®æœåŠ¡ç”¨æˆ·åå’Œå¯†ç ï¼ˆä¸Šä¼ åˆ°ç§æœéœ€è¦æœ‰æƒé™ï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">servers</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">server</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>release-repository<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>deployment<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>deployment123<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">server</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">server</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>snapshots-repository<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>deployment<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>deployment123<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">server</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">servers</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>éƒ¨ç½²é¡¹ç›®</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230117111441.png"></p></li></ol><p>â€‹        ç”±äºæˆ‘çš„é¡¹ç›®æ˜¯å¿«ç…§ç‰ˆæœ¬ï¼ˆpom.xmé…ç½®çš„<version>1.0-SNAPSHOT</version>ï¼‰ï¼Œæ‰€ä»¥ä¸Šä¼ åˆ°äº†å¿«ç…§ä»“åº“é‡Œå¦‚æœéœ€è¦ä¸Šä¼ åˆ°å‘               å¸ƒä»“åº“é‡Œä¿®æ”¹pom.xml</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/202301171117149.png"></p><p>å¯ä»¥çœ‹åˆ°ç›®å‰é¡¹ç›®ä¸Šä¼ åˆ°äº†releaseä»“åº“</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230117113859.png"></p>]]></content>
    
    
    <categories>
      
      <category>maven</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>jenkinsä¹‹waråŒ…éƒ¨ç½²</title>
    <link href="/jekins%E6%94%AFwar%E5%8C%85%E9%83%A8%E7%BD%B2/"/>
    <url>/jekins%E6%94%AFwar%E5%8C%85%E9%83%A8%E7%BD%B2/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ’ä»¶å®‰è£…"><a href="#1-æ’ä»¶å®‰è£…" class="headerlink" title="1. æ’ä»¶å®‰è£…"></a>1. æ’ä»¶å®‰è£…</h1><ul><li><p>Maven Integration</p></li><li><p>Pipeline Maven Integration</p></li><li><p>Deploy to container</p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230115200509.png"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230115200537.png"></p><h1 id="2-æ–°å»ºä»»åŠ¡"><a href="#2-æ–°å»ºä»»åŠ¡" class="headerlink" title="2. æ–°å»ºä»»åŠ¡"></a>2. æ–°å»ºä»»åŠ¡</h1><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/202301152009848.png"></p><h1 id="3-æºç é…ç½®"><a href="#3-æºç é…ç½®" class="headerlink" title="3 æºç é…ç½®"></a>3 æºç é…ç½®</h1><ul><li>Credentials éœ€è¦é€‰æ‹©åœ¨ç”¨æˆ·åˆ—è¡¨ï¼Œé…ç½®äº†è¯¥ä»“åº“ssh keyçš„ç”¨æˆ·</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230115201137.png"></p><h1 id="4-æ„å»ºåæ“ä½œ"><a href="#4-æ„å»ºåæ“ä½œ" class="headerlink" title="4 æ„å»ºåæ“ä½œ"></a>4 æ„å»ºåæ“ä½œ</h1><h2 id="4-1-éƒ¨ç½²åˆ°æœåŠ¡å™¨"><a href="#4-1-éƒ¨ç½²åˆ°æœåŠ¡å™¨" class="headerlink" title="4.1 éƒ¨ç½²åˆ°æœåŠ¡å™¨"></a>4.1 éƒ¨ç½²åˆ°æœåŠ¡å™¨</h2><p>æ„å»ºåï¼Œéƒ¨ç½²waråŒ…åˆ°æŒ‡å®šæœåŠ¡å™¨ï¼Œæˆ‘è¿™é‡Œæ˜¯éƒ¨ç½²åœ¨äº†æœ¬åœ°çš„tomcatæœåŠ¡ä¸Š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/202301152014790.png"></p><p>æ³¨æ„ï¼š</p><ul><li><p>waræ–‡ä»¶åœ°å€ï¼Œå¦‚æœä¸åœ¨å½“å‰é¡¹ç›®çš„targetä¸‹ï¼Œéœ€è¦å†™æˆç±»ä¼¼ <code>**/target/*.war</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230115202448.png"></p></li></ul><h2 id="4-2-ä¸Šä¼ åˆ°ç§æœ"><a href="#4-2-ä¸Šä¼ åˆ°ç§æœ" class="headerlink" title="4.2 ä¸Šä¼ åˆ°ç§æœ"></a>4.2 ä¸Šä¼ åˆ°ç§æœ</h2><p>æˆ‘è¿™é‡Œæ˜¯ä¸Šä¼ åˆ°äº†nexusä¸Š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230122205100.png"></p><p>å¯¹è‹±éœ€è¦ä¿®æ”¹setting.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">server</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>deployment<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>deployment123<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">server</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">server</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>deployment<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>deployment123<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">server</span>&gt;</span><br></code></pre></td></tr></table></figure><h1 id="5-æ„å»ºé¡¹ç›®"><a href="#5-æ„å»ºé¡¹ç›®" class="headerlink" title="5  æ„å»ºé¡¹ç›®"></a>5  æ„å»ºé¡¹ç›®</h1><p>å¦‚æœæ„å»ºå¤±è´¥ï¼Œå¯ä»¥åœ¨æ§åˆ¶å°æŸ¥çœ‹æŠ¥é”™ä¿¡æ¯</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230115202724.png"></p><h1 id="6-å¯åŠ¨tomcat"><a href="#6-å¯åŠ¨tomcat" class="headerlink" title="6 å¯åŠ¨tomcat"></a>6 å¯åŠ¨tomcat</h1><p>å¯ä»¥æŸ¥çœ‹å·²ç»éƒ¨ç½²æˆåŠŸçš„æœåŠ¡äº†</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/202301152016375.png"></p><h1 id="7-ç™»é™†nexus"><a href="#7-ç™»é™†nexus" class="headerlink" title="7. ç™»é™†nexus"></a>7. ç™»é™†nexus</h1><p>å¯ä»¥çœ‹åˆ°waråŒ…å·²ç»ä¸Šä¼ åˆ°äº†nexus</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/202301222054195.png"></p>]]></content>
    
    
    <categories>
      
      <category>jenkins</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>IDEAè§£å†³resourcesèµ„æºæ‰¾ä¸åˆ°</title>
    <link href="/IDEA%E8%A7%A3%E5%86%B3resources%E8%B5%84%E6%BA%90%E6%89%BE%E4%B8%8D%E5%88%B0/"/>
    <url>/IDEA%E8%A7%A3%E5%86%B3resources%E8%B5%84%E6%BA%90%E6%89%BE%E4%B8%8D%E5%88%B0/</url>
    
    <content type="html"><![CDATA[<p>pomä¸­åˆ é™¤<code>&lt;packaging&gt;pom&lt;/packaging&gt;</code>ã€‚åŠ äº†è¿™ä¸ªpomä¸ä¼šå¤„ç†resourcesç›®å½•</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/202301121549744.png"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Macä¸‹å®‰è£…jenkins</title>
    <link href="/Mac%E4%B8%8B%E5%AE%89%E8%A3%85jekins/"/>
    <url>/Mac%E4%B8%8B%E5%AE%89%E8%A3%85jekins/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å¯æŒç»­åŒ–é›†æˆCI"><a href="#1-å¯æŒç»­åŒ–é›†æˆCI" class="headerlink" title="1. å¯æŒç»­åŒ–é›†æˆCI"></a>1. å¯æŒç»­åŒ–é›†æˆCI</h1><p>â€‹      æŒç»­é›†æˆå³CIï¼ˆContinuous integrationï¼‰æ˜¯ä¸€ç§è½¯ä»¶å¼€å‘å®è·µ,å¯ä»¥è®©å›¢é˜Ÿåœ¨æŒç»­çš„åŸºç¡€ä¸Šä¸æ–­æ”¶åˆ°åé¦ˆå¹¶è¿›è¡Œæ”¹è¿›ï¼Œä¸å¿…ç­‰åˆ°å¼€å‘å‘¨æœŸåæœŸæ‰å¯»æ‰¾ç¼ºé™·ã€‚æŒç»­é›†æˆè¦ç‚¹ï¼š</p><ul><li>ç»Ÿä¸€çš„ä»£ç åº“ git</li><li>ç»Ÿä¸€çš„ä¾èµ–åŒ…ç®¡ç† nexus</li><li>æµ‹è¯•è‡ªåŠ¨åŒ–</li><li>æ„å»ºå…¨è‡ªåŠ¨åŒ– maven</li><li>éƒ¨ç½²è‡ªåŠ¨åŒ–</li><li>å¯è¿½è¸ªçš„é›†æˆè®°å½• ï¼šæŸä¸€æ¬¡æœ‰é—®é¢˜ï¼Œå¯ä»¥æ‰¾åˆ°ä¸Šæ¬¡é›†æˆã€‚æˆ–è€…ä¸Šä¸Šæ¬¡é›†æˆï¼Œç„¶åä»£ç å›æ»š</li></ul><p>æŒç»­é›†æˆçš„æµç¨‹ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230108202610.png"></p><h1 id="2-jenkinsæ¦‚è¿°"><a href="#2-jenkinsæ¦‚è¿°" class="headerlink" title="2 jenkinsæ¦‚è¿°"></a>2 jenkinsæ¦‚è¿°</h1><p>jenkinså°±æ˜¯ä¸ºäº†æ»¡è¶³ä¸Šè¿°æŒç»­é›†æˆçš„è¦ç‚¹è€Œè®¾è®¡çš„ä¸€æ¬¾å·¥å…·ï¼Œä¸»ä½“æ¡†æ¶æ˜¯é‡‡ç”¨javaå¼€å‘ï¼Œå®è´¨å†…éƒ¨åŠŸèƒ½éƒ½æ˜¯é€šè¿‡æ’ä»¶å®ç°ï¼Œæå¤§ç¨‹åº¦æé«˜äº†ç³»ç»Ÿçš„æ‰©å±•æ€§ã€‚</p><p>å…¶ä¸ä»…å¯ä»¥æ»¡è¶³javaç³»ç»Ÿçš„é›†æˆï¼Œä¹Ÿå¯ä»¥å®ç°PHPç­‰è¯­è¨€çš„é›†æˆå‘å¸ƒã€‚</p><p>é€šè¿‡pipelineæ’ä»¶ï¼Œç”¨æˆ·å¯ä»¥éšè‡ªå·±éœ€è¦å®šåˆ¶é›†æˆæµç¨‹ã€‚</p><h1 id="3-mac-ä¸‹å®‰è£…-jenkins"><a href="#3-mac-ä¸‹å®‰è£…-jenkins" class="headerlink" title="3 mac ä¸‹å®‰è£… jenkins"></a>3 mac ä¸‹å®‰è£… jenkins</h1><p>ç”¨brew å®‰è£…</p><p><code> brew install jenkins</code></p><p>å¯åŠ¨jenkins</p><p><code>brew services start jenkins</code></p><p>åœæ­¢jenkins</p><p><code> brew services stop jenkins</code></p><h1 id="4-ä¿®æ”¹jenkinsé»˜è®¤ç«¯å£é…ç½®"><a href="#4-ä¿®æ”¹jenkinsé»˜è®¤ç«¯å£é…ç½®" class="headerlink" title="4 ä¿®æ”¹jenkinsé»˜è®¤ç«¯å£é…ç½®"></a>4 ä¿®æ”¹jenkinsé»˜è®¤ç«¯å£é…ç½®</h1><h2 id="1-æŸ¥çœ‹jenkinså®‰è£…è·¯å¾„"><a href="#1-æŸ¥çœ‹jenkinså®‰è£…è·¯å¾„" class="headerlink" title="1.æŸ¥çœ‹jenkinså®‰è£…è·¯å¾„"></a>1.æŸ¥çœ‹jenkinså®‰è£…è·¯å¾„</h2><ul><li><code>brew list jenkins</code></li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230110221220.png" style="zoom:150%;" /><h2 id="2-ä¿®æ”¹homebrew-mxcl-jenkins-plist"><a href="#2-ä¿®æ”¹homebrew-mxcl-jenkins-plist" class="headerlink" title="2. ä¿®æ”¹homebrew.mxcl.jenkins.plist"></a>2. ä¿®æ”¹homebrew.mxcl.jenkins.plist</h2><ul><li><p>æ‰“å¼€æ–‡ä»¶ <code>vim /opt/homebrew/Cellar/jenkins/2.385/homebrew.mxcl.jenkins.plist</code></p></li><li><p>ä¿®æ”¹é»˜è®¤ç«¯å£å·</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230110221801.png"></p></li></ul><h2 id="3-ä¿®æ”¹jenkinsç³»ç»Ÿé…ç½®url"><a href="#3-ä¿®æ”¹jenkinsç³»ç»Ÿé…ç½®url" class="headerlink" title="3. ä¿®æ”¹jenkinsç³»ç»Ÿé…ç½®url"></a>3. ä¿®æ”¹jenkinsç³»ç»Ÿé…ç½®url</h2><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230110222629.png"  /><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/202301221541401.png"></p><h1 id="5-pipeline-é›†æˆåŸç†"><a href="#5-pipeline-é›†æˆåŸç†" class="headerlink" title="5 pipeline é›†æˆåŸç†  "></a>5 pipeline é›†æˆåŸç†  <img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230124113315.png"></h1>]]></content>
    
    
    <categories>
      
      <category>jenkins</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å·¥ä½œæµ</title>
    <link href="/%E5%B7%A5%E4%BD%9C%E6%B5%81/"/>
    <url>/%E5%B7%A5%E4%BD%9C%E6%B5%81/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å·¥ä½œæµæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-å·¥ä½œæµæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. å·¥ä½œæµæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. å·¥ä½œæµæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>å·¥ä½œæµå°±æ˜¯è®¡ç®—æœºå¯¹ä¸šåŠ¡æµç¨‹è‡ªåŠ¨åŒ–æ‰§è¡Œç®¡ç†ã€‚æœ‰äº†å·¥ä½œæµå¯ä»¥æ›´å¥½çš„ç®¡ç†ä¸šåŠ¡æµç¨‹ï¼Œæé«˜ç³»ç»Ÿæ‰©å±•æ€§ã€‚</p><h1 id="2-Activity-7"><a href="#2-Activity-7" class="headerlink" title="2. Activity 7"></a>2. Activity 7</h1><ul><li>activityæ˜¯ä¸€ä¸ªå·¥ä½œæµå¼•æ“ï¼Œactivityå¯ä»¥å°†ä¸šåŠ¡ç³»ç»Ÿä¸­å¤æ‚çš„ä¸šåŠ¡æµç¨‹æŠ½å–å‡ºæ¥ï¼Œä½¿ç”¨ä¸“é—¨çš„å»ºæ¨¡è¯­è¨€BPMN2.0è¿›è¡Œå®šä¹‰ã€‚</li><li>ä¸šåŠ¡æµç¨‹æŒ‰ç…§é¢„å…ˆå®šä¹‰çš„æµç¨‹è¿›è¡Œæ‰§è¡Œï¼Œå®ç°äº†ç³»ç»Ÿçš„æµç¨‹ç”±activitiè¿›è¡Œç®¡ç†ï¼Œå‡å°‘ä¸šåŠ¡ç³»ç»Ÿç”±äºæµç¨‹å˜æ›´è¿›è¡Œç³»ç»Ÿå‡çº§æ”¹é€ çš„å·¥ä½œé‡ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¥å£®æ€§ï¼ŒåŒæ—¶ä¹Ÿå‡å°‘äº†ç³»ç»Ÿå¼€å‘çš„ç»´æŠ¤æˆæœ¬ã€‚</li></ul><h1 id="3-BPMN"><a href="#3-BPMN" class="headerlink" title="3 BPMN"></a>3 BPMN</h1><p>BPMNï¼ˆBusiness Process Model AndNotationï¼‰- ä¸šåŠ¡æµç¨‹æ¨¡å‹å’Œç¬¦å· æ˜¯ç”±BPMIï¼ˆBusinessProcess Management Initiativeï¼‰<strong>å¼€å‘çš„ä¸€å¥—æ ‡å‡†çš„ä¸šåŠ¡æµç¨‹å»ºæ¨¡ç¬¦å·</strong>ï¼Œä½¿ç”¨BPMNæä¾›çš„<strong>ç¬¦å·</strong>å¯ä»¥åˆ›å»ºä¸šåŠ¡æµç¨‹ã€‚</p><h1 id="4-ä½¿ç”¨æ­¥éª¤"><a href="#4-ä½¿ç”¨æ­¥éª¤" class="headerlink" title="4.  ä½¿ç”¨æ­¥éª¤"></a>4.  ä½¿ç”¨æ­¥éª¤</h1><h2 id="4-1-æµç¨‹å®šä¹‰"><a href="#4-1-æµç¨‹å®šä¹‰" class="headerlink" title="4.1 æµç¨‹å®šä¹‰"></a>4.1 æµç¨‹å®šä¹‰</h2><p>ä½¿ç”¨activitiæµç¨‹å»ºæ¨¡å·¥å…·(activity-designer)å®šä¹‰ä¸šåŠ¡æµç¨‹(.bpmnæ–‡ä»¶) ã€‚</p><h2 id="4-1-æµç¨‹å®šä¹‰éƒ¨ç½²"><a href="#4-1-æµç¨‹å®šä¹‰éƒ¨ç½²" class="headerlink" title="4.1 æµç¨‹å®šä¹‰éƒ¨ç½²"></a>4.1 æµç¨‹å®šä¹‰éƒ¨ç½²</h2><ul><li><p>activitiéƒ¨ç½²ä¸šåŠ¡æµç¨‹å®šä¹‰ï¼ˆ.bpmnæ–‡ä»¶ï¼‰</p></li><li><p>ä½¿ç”¨activitiæä¾›çš„apiæŠŠæµç¨‹å®šä¹‰å†…å®¹å­˜å‚¨èµ·æ¥ï¼Œåœ¨Activitiæ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥æŸ¥è¯¢å®šä¹‰çš„å†…å®¹</p></li><li><p>Activitiæ‰§è¡ŒæŠŠæµç¨‹å®šä¹‰å†…å®¹å­˜å‚¨åœ¨æ•°æ®åº“ä¸­</p></li></ul><h2 id="4-2-å¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹"><a href="#4-2-å¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹" class="headerlink" title="4.2 å¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹"></a>4.2 å¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹</h2><ul><li>æµç¨‹å®ä¾‹ä¹Ÿå«ï¼šProcessInstance</li><li>å¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹è¡¨ç¤ºå¼€å§‹ä¸€æ¬¡ä¸šåŠ¡æµç¨‹çš„è¿è¡Œã€‚</li><li>åœ¨å‘˜å·¥è¯·å‡æµç¨‹å®šä¹‰éƒ¨ç½²å®Œæˆåï¼Œå¦‚æœå¼ ä¸‰è¦è¯·å‡å°±å¯ä»¥å¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹ï¼Œå¦‚æœæå››è¦è¯·å‡ä¹Ÿå¯åŠ¨ä¸€ä¸ªæµç¨‹å®ä¾‹ï¼Œä¸¤ä¸ªæµç¨‹çš„æ‰§è¡Œäº’ç›¸ä¸å½±å“ã€‚</li></ul><h2 id="4-3-ç”¨æˆ·æŸ¥è¯¢å¾…åŠä»»åŠ¡-Task"><a href="#4-3-ç”¨æˆ·æŸ¥è¯¢å¾…åŠä»»åŠ¡-Task" class="headerlink" title="4.3 ç”¨æˆ·æŸ¥è¯¢å¾…åŠä»»åŠ¡(Task)"></a>4.3 ç”¨æˆ·æŸ¥è¯¢å¾…åŠä»»åŠ¡(Task)</h2><p>å› ä¸ºç°åœ¨ç³»ç»Ÿçš„ä¸šåŠ¡æµç¨‹å·²ç»äº¤ç»™activitiç®¡ç†ï¼Œé€šè¿‡activitiå°±å¯ä»¥æŸ¥è¯¢å½“å‰æµç¨‹æ‰§è¡Œåˆ°å“ªäº†ï¼Œå½“å‰ç”¨æˆ·éœ€è¦åŠç†ä»€ä¹ˆä»»åŠ¡äº†ï¼Œè¿™äº›activitiå¸®æˆ‘ä»¬ç®¡ç†äº†ï¼Œè€Œä¸éœ€è¦å¼€å‘äººå‘˜è‡ªå·±ç¼–å†™åœ¨sqlè¯­å¥æŸ¥è¯¢ã€‚</p><h2 id="4-4-ç”¨æˆ·åŠç†ä»»åŠ¡"><a href="#4-4-ç”¨æˆ·åŠç†ä»»åŠ¡" class="headerlink" title="4.4 ç”¨æˆ·åŠç†ä»»åŠ¡"></a>4.4 ç”¨æˆ·åŠç†ä»»åŠ¡</h2><p>ç”¨æˆ·æŸ¥è¯¢å¾…åŠä»»åŠ¡åï¼Œå°±å¯ä»¥åŠç†æŸä¸ªä»»åŠ¡ï¼Œå¦‚æœè¿™ä¸ªä»»åŠ¡åŠç†å®Œæˆè¿˜éœ€è¦å…¶å®ƒç”¨æˆ·åŠç†ï¼Œæ¯”å¦‚é‡‡è´­å•åˆ›å»ºåç”±éƒ¨é—¨ç»ç†å®¡æ ¸ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯ç”±activitiå¸®æˆ‘ä»¬å®Œæˆäº†ã€‚</p><h2 id="4-5-æµç¨‹ç»“æŸ"><a href="#4-5-æµç¨‹ç»“æŸ" class="headerlink" title="4.5 æµç¨‹ç»“æŸ"></a>4.5 æµç¨‹ç»“æŸ</h2><p>å½“ä»»åŠ¡åŠç†å®Œæˆæ²¡æœ‰ä¸‹ä¸€ä¸ªä»»åŠ¡ç»“ç‚¹äº†ï¼Œè¿™ä¸ªæµç¨‹å®ä¾‹å°±å®Œæˆäº†ã€‚</p><h1 id="5-springé›†æˆactiviti"><a href="#5-springé›†æˆactiviti" class="headerlink" title="5 springé›†æˆactiviti"></a>5 springé›†æˆactiviti</h1><h2 id="1-å¼•å…¥ä¾èµ–"><a href="#1-å¼•å…¥ä¾èµ–" class="headerlink" title="1. å¼•å…¥ä¾èµ–"></a>1. å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">slf4j.version</span>&gt;</span>1.6.6<span class="hljs-tag">&lt;/<span class="hljs-name">slf4j.version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">log4j.version</span>&gt;</span>1.2.12<span class="hljs-tag">&lt;/<span class="hljs-name">log4j.version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">activiti.version</span>&gt;</span>7.0.0.Beta1<span class="hljs-tag">&lt;/<span class="hljs-name">activiti.version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.activiti<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>activiti-engine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;activiti.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.activiti<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>activiti-spring<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;activiti.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-comment">&lt;!-- bpmn æ¨¡å‹å¤„ç† --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.activiti<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>activiti-bpmn-model<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;activiti.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-comment">&lt;!-- bpmn è½¬æ¢ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.activiti<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>activiti-bpmn-converter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;activiti.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-comment">&lt;!-- bpmn jsonæ•°æ®è½¬æ¢ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.activiti<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>activiti-json-converter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;activiti.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-comment">&lt;!-- bpmn å¸ƒå±€ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.activiti<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>activiti-bpmn-layout<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;activiti.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-comment">&lt;!-- activiti äº‘æ”¯æŒ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.activiti.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>activiti-cloud-services-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;activiti.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-comment">&lt;!-- mysqlé©±åŠ¨ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.28<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-comment">&lt;!-- mybatis --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-comment">&lt;!-- é“¾æ¥æ±  --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-dbcp<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-dbcp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.13.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-comment">&lt;!-- log start --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;log4j.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;slf4j.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="2-å¢åŠ activitié…ç½®æ–‡ä»¶"><a href="#2-å¢åŠ activitié…ç½®æ–‡ä»¶" class="headerlink" title="2. å¢åŠ activitié…ç½®æ–‡ä»¶"></a>2. å¢åŠ activitié…ç½®æ–‡ä»¶</h2><p>resourcesä¸‹å¢åŠ activitié…ç½®æ–‡ä»¶activiti.cfg.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:tx</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/tx&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-string"><span class="hljs-tag">                    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-string"><span class="hljs-tag">http://www.springframework.org/schema/contex</span></span><br><span class="hljs-string"><span class="hljs-tag">http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="hljs-string"><span class="hljs-tag">http://www.springframework.org/schema/tx</span></span><br><span class="hljs-string"><span class="hljs-tag">http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.apache.commons.dbcp.BasicDataSource&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql:///activiti&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;19980617pyr&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxActive&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;3&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxIdle&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>  <span class="hljs-comment">&lt;!--    é»˜è®¤æ–¹å¼ä¸‹beançš„id å›ºå®šä¸ºprocessEngineConfiguration--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;processEngineConfiguration&quot;</span></span><br><span class="hljs-tag">          <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- å¼•ç”¨æ•°æ®æº ä¸Šé¢å·²ç»è®¾ç½®å¥½äº†--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span> /&gt;</span><br>        <span class="hljs-comment">&lt;!-- activitiæ•°æ®åº“è¡¨å¤„ç†ç­–ç•¥ databaseSchemaUpdateï¼šå¦‚æœæ•°æ®åº“ä¸­å·²ç»å­˜åœ¨ç›¸åº”çš„è¡¨ç›´æ¥ä½¿ç”¨ï¼Œä¸å­˜åœ¨ï¼Œç›´æ¥åˆ›å»º--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;databaseSchemaUpdate&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="3-ç”Ÿæˆactivitiéœ€è¦çš„è¡¨"><a href="#3-ç”Ÿæˆactivitiéœ€è¦çš„è¡¨" class="headerlink" title="3 ç”Ÿæˆactivitiéœ€è¦çš„è¡¨"></a>3 ç”Ÿæˆactivitiéœ€è¦çš„è¡¨</h2><p>åˆ©ç”¨æµ‹è¯•ç±»ç”Ÿæˆactivitiéœ€è¦çš„è¡¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.activiti.engine.ProcessEngine;<br><span class="hljs-keyword">import</span> org.activiti.engine.ProcessEngines;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestCreate</span> </span>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”Ÿæˆ activitiçš„æ•°æ®åº“è¡¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testCreateDbTable</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * ä½¿ç”¨classpathä¸‹çš„activiti.cfg.xmlä¸­çš„é…ç½®åˆ›å»ºprocessEngine</span><br><span class="hljs-comment">         * getDefaultProcessEngineä¼šé»˜è®¤ä»resourcesä¸‹è¯»å–åå­—ä¸ºactiviti.cfg.xmlæ–‡ä»¶</span><br><span class="hljs-comment">         * åˆ›å»ºprocessEngineæ—¶ï¼Œå°±ä¼šåˆ›å»ºmysqlè¡¨</span><br><span class="hljs-comment">         */</span><br>        ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();<br>        System.out.println(processEngine);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œä»¥ä¸Šä»£ç ï¼Œä¼šåœ¨æ•°æ®åº“é‡Œç”Ÿæˆ25å¼ è¡¨</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20230128155215.png"></p>]]></content>
    
    
    <categories>
      
      <category>Activiti</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>mavenåŸºæœ¬æ¦‚å¿µ</title>
    <link href="/maven%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/"/>
    <url>/maven%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h2 id="mavenéµå¾ªçº¦å®šå¤§äºé…ç½®"><a href="#mavenéµå¾ªçº¦å®šå¤§äºé…ç½®" class="headerlink" title="mavenéµå¾ªçº¦å®šå¤§äºé…ç½®"></a>mavenéµå¾ªçº¦å®šå¤§äºé…ç½®</h2><ul><li>mavenç¼–è¯‘çš„è·¯å¾„ä¸º src&#x2F;main&#x2F;java</li><li>maven æ‰“åŒ…åçš„è·¯å¾„åœ¨ &#x2F;target&#x2F;classes</li><li>mavené¡¹ç›®çš„é…ç½®æ–‡ä»¶å­˜å‚¨åœ¨&#x2F;resourcesç›®å½•ä¸‹</li><li>mavenæ‰“åŒ…å°±æ˜¯ï¼Œè¿è¡Œ<code>mvn package</code>æŠŠ &#x2F;target&#x2F;classesä¸‹çš„æ–‡ä»¶ï¼Œæ‰“æˆä¸€ä¸ªjaråŒ…æˆ–è€…waråŒ…ï¼Œæ‰“åœ¨targetç›®å½•ä¸‹</li><li>mavenè¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œè¿è¡Œ<code>mvn test</code>ï¼Œå°†è¿è¡Œsrc&#x2F;testä¸‹ä»¥testå¼€åçš„æ–‡ä»¶é‡Œçš„ï¼Œä»¥testå¼€å¤´çš„æ–¹æ³•ã€  å¦‚æœå¼•å…¥äº†junitï¼Œå°†ä¼šè¿è¡Œä»¥@testæ³¨è§£çš„æ–¹æ³•ã€‚</li></ul><h2 id="maven-ç”Ÿå‘½å‘¨æœŸ"><a href="#maven-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="maven ç”Ÿå‘½å‘¨æœŸ"></a>maven ç”Ÿå‘½å‘¨æœŸ</h2><ul><li>Maven çš„å†…éƒ¨æœ‰ä¸‰ä¸ªæ ‡å‡†ç”Ÿå‘½å‘¨æœŸ</li><li>ç”Ÿå‘½å‘¨æœŸä¸­çš„é˜¶æ®µæ˜¯æœ‰ä¸¥æ ¼çš„æ‰§è¡Œé¡ºåºçš„ã€‚æ¯”å¦‚ï¼šå¿…é¡»æ‰§è¡Œå®Œcompileæ‰ä¼šæ‰§è¡Œpackage</li><li>ç”Ÿå‘½å‘¨æœŸä¸­çš„é˜¶æ®µæ˜¯æœ‰æ‰§è¡Œé€»è¾‘çš„ã€‚å³å½“ä½ æ‰§è¡Œä¸€ä¸ªé˜¶æ®µæ—¶ï¼Œå…¶å‰é¢çš„é˜¶æ®µä¼šè‡ªåŠ¨æ‰§è¡Œã€‚</li><li>ç”Ÿå‘½å‘¨æœŸçš„é˜¶æ®µå¯ä»¥ç»‘å®šå…·ä½“çš„æ’ä»¶å’Œç›®æ ‡</li></ul><h2 id="Clean-ç”Ÿå‘½å‘¨æœŸ"><a href="#Clean-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Clean ç”Ÿå‘½å‘¨æœŸ"></a>Clean ç”Ÿå‘½å‘¨æœŸ</h2><p>å½“æˆ‘ä»¬æ‰§è¡Œ mvn post-clean å‘½ä»¤æ—¶ï¼ŒMaven è°ƒç”¨ clean ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒåŒ…å«ä»¥ä¸‹é˜¶æ®µï¼š</p><ul><li>pre-cleanï¼šæ‰§è¡Œä¸€äº›éœ€è¦åœ¨cleanä¹‹å‰å®Œæˆçš„å·¥ä½œ</li><li>cleanï¼šç§»é™¤æ‰€æœ‰ä¸Šä¸€æ¬¡æ„å»ºç”Ÿæˆçš„æ–‡ä»¶</li><li>post-cleanï¼šæ‰§è¡Œä¸€äº›éœ€è¦åœ¨cleanä¹‹åç«‹åˆ»å®Œæˆçš„å·¥ä½œ</li></ul><h2 id="Default-Build-ç”Ÿå‘½å‘¨æœŸ"><a href="#Default-Build-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Default (Build) ç”Ÿå‘½å‘¨æœŸ"></a>Default (Build) ç”Ÿå‘½å‘¨æœŸ</h2><p>è¿™æ˜¯ Maven çš„ä¸»è¦ç”Ÿå‘½å‘¨æœŸï¼Œè¢«ç”¨äºæ„å»ºåº”ç”¨ï¼ŒåŒ…æ‹¬ 23 ä¸ªé˜¶æ®µï¼Œæ ¸å¿ƒé˜¶æ®µåŒ…æ‹¬ï¼š</p><table><thead><tr><th>æ ¸å¿ƒé˜¶æ®µ</th><th>è¯¦è§£</th></tr></thead><tbody><tr><td>validate</td><td>éªŒè¯é¡¹ç›®æ˜¯å¦æ­£ç¡®ï¼Œæ‰€æœ‰å¿…è¦ä¿¡æ¯æ˜¯å¦å¯ç”¨<code>ï¼ˆå¾ˆå°‘å•ç‹¬ä½¿ç”¨ï¼‰</code></td></tr><tr><td>compile</td><td>ç¼–è¯‘é¡¹ç›®çš„æºä»£ç ï¼ˆå°†src&#x2F;mainä¸­çš„javaä»£ç ç¼–è¯‘æˆclassæ–‡ä»¶ï¼Œè¾“å‡ºåˆ°targeç›®å½•ä¸‹ï¼‰</td></tr><tr><td>test</td><td>å°†å•å…ƒæµ‹è¯•çš„èµ„æºæ–‡ä»¶å’Œä»£ç è¿›è¡Œç¼–è¯‘ï¼Œç”Ÿæˆçš„æ–‡ä»¶ä½äºtarget&#x2F;test-classes ï¼ˆæ‰“åŒ…éƒ¨ç½²è¯·è·³è¿‡è¯¥é˜¶æ®µï¼‰</td></tr><tr><td>package</td><td>æŠŠclassæ–‡ä»¶ï¼Œresourcesæ–‡ä»¶æ‰“åŒ…æˆjaråŒ…ï¼ˆä¹Ÿå¯ä»¥æ˜¯waråŒ…ï¼‰ï¼Œç”Ÿæˆçš„jaråŒ…ä½äºtargetç›®å½•ä¸‹</td></tr><tr><td>verify</td><td>æ£€æŸ¥åŒ…æ˜¯å¦æœ‰æ•ˆ<code>ï¼ˆå¾ˆå°‘å•ç‹¬ä½¿ç”¨ï¼‰</code></td></tr><tr><td>install</td><td>å°†jaréƒ¨ç½²åˆ°æœ¬åœ°ä»“åº“ï¼Œæœ¬åœ°çš„å…¶ä»–æ¨¡å—ä¾èµ–è¯¥jaråŒ…æ—¶ï¼Œå¯ä»¥ç›´æ¥ä»æœ¬åœ°ä»“åº“å»è·å–</td></tr><tr><td>deploy</td><td>å°†jaråŒ…éƒ¨ç½²åˆ°è¿œç«¯ä»“åº“ï¼Œéœ€è¦åœ¨mavençš„setting.xmlä¸­é…ç½®ç§æœçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥åŠåœ¨pom.xmlé…ç½®</td></tr></tbody></table><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221227224007.png"></p><h2 id="Site-ç”Ÿå‘½å‘¨æœŸ"><a href="#Site-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Site ç”Ÿå‘½å‘¨æœŸ"></a>Site ç”Ÿå‘½å‘¨æœŸ</h2><p>Maven Site æ’ä»¶ä¸€èˆ¬ç”¨æ¥åˆ›å»ºæ–°çš„æŠ¥å‘Šæ–‡æ¡£ã€éƒ¨ç½²ç«™ç‚¹ç­‰ã€‚åŒ…æ‹¬4å„é˜¶æ®µ</p><ul><li>pre-siteï¼šæ‰§è¡Œä¸€äº›éœ€è¦åœ¨ç”Ÿæˆç«™ç‚¹æ–‡æ¡£ä¹‹å‰å®Œæˆçš„å·¥ä½œ</li><li>siteï¼šç”Ÿæˆé¡¹ç›®çš„ç«™ç‚¹æ–‡æ¡£</li><li>post-siteï¼š æ‰§è¡Œä¸€äº›éœ€è¦åœ¨ç”Ÿæˆç«™ç‚¹æ–‡æ¡£ä¹‹åå®Œæˆçš„å·¥ä½œï¼Œå¹¶ä¸”ä¸ºéƒ¨ç½²åšå‡†å¤‡</li><li>site-deployï¼šå°†ç”Ÿæˆçš„ç«™ç‚¹æ–‡æ¡£éƒ¨ç½²åˆ°ç‰¹å®šçš„æœåŠ¡å™¨ä¸Š</li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>vueçš„ç”Ÿå‘½å‘¨æœŸé€‰é¡¹</title>
    <link href="/vue%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"/>
    <url>/vue%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</url>
    
    <content type="html"><![CDATA[<h2 id="1-beforeCreate"><a href="#1-beforeCreate" class="headerlink" title="1. beforeCreate"></a>1. beforeCreate</h2><ul><li><p>åœ¨ç»„ä»¶å®ä¾‹åˆå§‹åŒ–ä¹‹åè°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯new Vue()ä¹‹å</p></li><li><p>åˆå§‹åŒ–äº†ä¸»è¦çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°</p></li></ul><h2 id="2-created"><a href="#2-created" class="headerlink" title="2. created"></a>2. created</h2><ul><li>åˆå§‹åŒ–äº†data()ï¼Œcomputed()ï¼Œmethods()ï¼Œwatch()</li><li>ä½¿ç”¨åœºæ™¯ï¼šè°ƒç”¨ajaxæ¥è·å–è‡ªå·±çš„é¦–å±æ•°æ®</li></ul><h2 id="3-beforeMount"><a href="#3-beforeMount" class="headerlink" title="3.beforeMount"></a>3.beforeMount</h2><ul><li>å†…å­˜ä¸­å·²ç»ç¼–è¯‘ç”Ÿæˆå¥½äº†htmlç»“æ„ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ¸²æŸ“ã€‚</li></ul><blockquote><p>mountè¡¨ç¤ºæŒ‚è½½çš„æ„æ€ï¼Œå°±æ˜¯è¯´è¦å°†å†…å­˜ä¸­æ¸²æŸ“çš„htmlç»“æ„ï¼Œæ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚</p></blockquote><h2 id="4-mounted"><a href="#4-mounted" class="headerlink" title="4. mounted"></a>4. mounted</h2><ul><li>å†…å­˜ä¸­æ¸²æŸ“å¥½çš„htmlç»“æ„ï¼Œæ›¿æ¢åˆ°é¡µé¢ä¸Š</li><li>å…¶è‡ªèº«çš„ DOM æ ‘å·²ç»åˆ›å»ºå®Œæˆå¹¶æ’å…¥äº†çˆ¶å®¹å™¨ä¸­ã€‚</li><li>æ‰€æœ‰åŒæ­¥å­ç»„ä»¶éƒ½å·²ç»è¢«æŒ‚è½½</li></ul><p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š</p><p>åœ¨æ­¤å¤„å‘é€ å¼‚æ­¥è¯·æ±‚ ï¼ˆajaxï¼Œfetchï¼Œaxiosç­‰ï¼‰ï¼Œè·å–æœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼Œæ˜¾ç¤ºåœ¨DOMé‡Œã€‚</p><p>æ¯”å¦‚ï¼šæ ¹æ®è¾“å…¥æ¡†é‡Œè¾“å…¥çš„å…ƒç´ ï¼Œå»æœåŠ¡å™¨æŸ¥è¯¢æ•°æ®</p><h2 id="5-beforeUpdate"><a href="#5-beforeUpdate" class="headerlink" title="5. beforeUpdate"></a>5. <strong>beforeUpdate</strong></h2><ul><li>ç»„ä»¶æ›´æ–°ï¼ˆæ•°æ®æ›´æ–°ï¼‰ä¹‹å‰æ‰§è¡Œçš„å‡½æ•°</li></ul><h2 id="6-updated"><a href="#6-updated" class="headerlink" title="6.updated"></a>6.<strong>updated</strong></h2><p>ç»„ä»¶æ›´æ–°ï¼ˆæ•°æ®æ›´æ–°ï¼‰åæ‰§è¡Œçš„å‡½æ•°</p><h2 id="7-beforeDestroy"><a href="#7-beforeDestroy" class="headerlink" title="7. beforeDestroy"></a>7. beforeDestroy</h2><ul><li>vueï¼ˆç»„ä»¶ï¼‰å¯¹è±¡é”€æ¯ä¹‹å‰</li></ul><h2 id="8-destroyed"><a href="#8-destroyed" class="headerlink" title="8. destroyed"></a>8. destroyed</h2><ul><li>ç»„ä»¶é”€æ¯å</li></ul>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å“åº”å¼å¼€å‘</title>
    <link href="/Bootstrap%E4%BD%BF%E7%94%A8/"/>
    <url>/Bootstrap%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å“åº”å¼å¼€å‘"><a href="#1-å“åº”å¼å¼€å‘" class="headerlink" title="1 å“åº”å¼å¼€å‘"></a>1 å“åº”å¼å¼€å‘</h1><h2 id="1-1-å“åº”å¼å¼€å‘åŸç†"><a href="#1-1-å“åº”å¼å¼€å‘åŸç†" class="headerlink" title="1.1 å“åº”å¼å¼€å‘åŸç†"></a>1.1 å“åº”å¼å¼€å‘åŸç†</h2><p>å“åº”å¼å¼€å‘å°±æ˜¯ä½¿ç”¨åª’ä½“æŸ¥è¯¢ï¼Œé’ˆå¯¹ä¸åŒå®½åº¦çš„è®¾å¤‡è¿›è¡Œå¸ƒå±€å’Œæ ·å¼çš„è°ƒæ•´ï¼Œä»è€Œé€‚é…ä¸åŒè®¾å¤‡ã€‚</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221127201119.png" style="zoom:50%;" /><h2 id="1-2-æ¡ˆä¾‹"><a href="#1-2-æ¡ˆä¾‹" class="headerlink" title="1.2 æ¡ˆä¾‹"></a>1.2 æ¡ˆä¾‹</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs css"><br><span class="hljs-comment">/*1. è¶…å°å±å¹•ä¸‹ å°äº768 å®¹å™¨å®½åº¦ä¸º100%*/</span><br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">767px</span>) &#123;<br>    <span class="hljs-selector-class">.container</span> &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/*2. å°å±å¹•ä¸‹ &gt;= 768, å®¹å™¨å¸ƒå±€æ”¹ä¸º750px*/</span><br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">768px</span>) &#123;<br>    <span class="hljs-selector-class">.container</span> &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">750px</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/*2. ä¸­ç­‰å±å¹• &gt;= 992, å®¹å™¨å¸ƒå±€æ”¹ä¸º970px*/</span><br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">992px</span>) &#123;<br>    <span class="hljs-selector-class">.container</span> &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">970px</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/*2. å°å±å¹•ä¸‹ &gt;= 1200, å®¹å™¨å¸ƒå±€æ”¹ä¸º1170px*/</span><br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">1200px</span>) &#123;<br>    <span class="hljs-selector-class">.container</span> &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">1170px</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221127201326.png" style="zoom:70%;" />]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å“åº”å¼å¼€å‘</title>
    <link href="/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%BC%80%E5%8F%91/"/>
    <url>/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%BC%80%E5%8F%91/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å“åº”å¼å¼€å‘"><a href="#1-å“åº”å¼å¼€å‘" class="headerlink" title="1 å“åº”å¼å¼€å‘"></a>1 å“åº”å¼å¼€å‘</h1><h2 id="1-1-å“åº”å¼å¼€å‘åŸç†"><a href="#1-1-å“åº”å¼å¼€å‘åŸç†" class="headerlink" title="1.1 å“åº”å¼å¼€å‘åŸç†"></a>1.1 å“åº”å¼å¼€å‘åŸç†</h2><p>å“åº”å¼å¼€å‘å°±æ˜¯ä½¿ç”¨åª’ä½“æŸ¥è¯¢ï¼Œé’ˆå¯¹ä¸åŒå®½åº¦çš„è®¾å¤‡è¿›è¡Œå¸ƒå±€å’Œæ ·å¼çš„è°ƒæ•´ï¼Œä»è€Œé€‚é…ä¸åŒè®¾å¤‡ã€‚</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221127201119.png" style="zoom:50%;" /><h2 id="1-2-æ¡ˆä¾‹"><a href="#1-2-æ¡ˆä¾‹" class="headerlink" title="1.2 æ¡ˆä¾‹"></a>1.2 æ¡ˆä¾‹</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs css"><br><span class="hljs-comment">/*1. è¶…å°å±å¹•ä¸‹ å°äº768 å®¹å™¨å®½åº¦ä¸º100%*/</span><br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">767px</span>) &#123;<br>    <span class="hljs-selector-class">.container</span> &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/*2. å°å±å¹•ä¸‹ &gt;= 768, å®¹å™¨å¸ƒå±€æ”¹ä¸º750px*/</span><br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">768px</span>) &#123;<br>    <span class="hljs-selector-class">.container</span> &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">750px</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/*2. ä¸­ç­‰å±å¹• &gt;= 992, å®¹å™¨å¸ƒå±€æ”¹ä¸º970px*/</span><br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">992px</span>) &#123;<br>    <span class="hljs-selector-class">.container</span> &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">970px</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/*2. å°å±å¹•ä¸‹ &gt;= 1200, å®¹å™¨å¸ƒå±€æ”¹ä¸º1170px*/</span><br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">1200px</span>) &#123;<br>    <span class="hljs-selector-class">.container</span> &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">1170px</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221127201326.png" style="zoom:70%;" />]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSSå®šä½</title>
    <link href="/CSS%E5%AE%9A%E4%BD%8D/"/>
    <url>/CSS%E5%AE%9A%E4%BD%8D/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä¸ºä»€ä¹ˆéœ€è¦å®šä½ï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆéœ€è¦å®šä½ï¼Ÿ" class="headerlink" title="1. ä¸ºä»€ä¹ˆéœ€è¦å®šä½ï¼Ÿ"></a>1. ä¸ºä»€ä¹ˆéœ€è¦å®šä½ï¼Ÿ</h1><p>æœ‰äº›åœºæ™¯ï¼Œä½¿ç”¨æ ‡å‡†æµå’Œæµ®åŠ¨éƒ½æ²¡åŠæ³•å®ç°ã€‚æ¯”å¦‚ï¼š</p><ul><li>æŸä¸ªå…ƒç´ å¯ä»¥éšæ„åœ¨ä¸€ä¸ªç›’å­å†…ç§»åŠ¨ä½ç½®ï¼Œå¹¶ä¸”å‹ä½å…¶ä»–ç›’å­ã€‚</li><li>æ»šåŠ¨çª—å£çš„æ—¶å€™ï¼Œç›’å­æ˜¯å›ºå®šåœ¨æŸä¸ªä½ç½®çš„ã€‚</li></ul><h1 id="2-å®šä½æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2-å®šä½æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2 å®šä½æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2 å®šä½æ˜¯ä»€ä¹ˆï¼Ÿ</h1><ul><li><p>å®šä½ç»„æˆï¼šå®šä½ &#x3D; å®šä½æ¨¡å¼ + è¾¹åç§»</p></li><li><p>å®šä½ç‰¹æ€§ï¼š</p><ol><li><p>ç»å¯¹å®šä½å’Œå›ºå®šå®šä½å’Œæµ®åŠ¨ç±»ä¼¼</p><ul><li>è¡Œå†…å…ƒç´ æ·»åŠ ç»å¯¹å®šä½æˆ–å›ºå®šå®šä½ï¼Œå¯ä»¥ç›´æ¥è®¾ç½®å®½åº¦å’Œé«˜åº¦</li><li>å—çº§å…ƒç´ æ·»åŠ ç»å¯¹å®šä½æˆ–å›ºå®šå®šä½ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®å®½åº¦å’Œé«˜åº¦ï¼Œé»˜è®¤å¤§å°æ˜¯å†…å®¹çš„å¤§å°ã€‚</li></ul></li><li><p>ç»å¯¹å®šä½å’Œå›ºå®šå®šä½ä¼šå‹ä½å®ƒä¸‹é¢æ ‡å‡†æµçš„ç›’å­</p></li></ol></li></ul><h2 id="2-1-å®šä½æ¨¡å¼"><a href="#2-1-å®šä½æ¨¡å¼" class="headerlink" title="2.1 å®šä½æ¨¡å¼"></a>2.1 å®šä½æ¨¡å¼</h2><p>å®šä½æ¨¡å¼ï¼Œå†³å®šå…ƒç´ çš„å®šä½æ–¹å¼ï¼Œé€šè¿‡CSSçš„positionå±æ€§æ¥è®¾ç½®ï¼Œåˆ†ä¸º4ç§ï¼š</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221127143043.png" style="zoom:70%;" /><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221127175619.png" style="zoom:70%;" /><h2 id="2-2-è¾¹åç§»"><a href="#2-2-è¾¹åç§»" class="headerlink" title="2.2 è¾¹åç§»"></a>2.2 è¾¹åç§»</h2><p>è¾¹åç§»ï¼Œå†³å®šå…ƒç´ çš„æœ€ç»ˆä½ç½®ï¼Œæœ‰top,bottom,left,right 4ä¸ªå±æ€§</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221127143307.png" style="zoom:70%;" /><h1 id="3-å®šä½æ–¹å¼"><a href="#3-å®šä½æ–¹å¼" class="headerlink" title="3 å®šä½æ–¹å¼"></a>3 å®šä½æ–¹å¼</h1><h2 id="3-1-é™æ€å®šä½"><a href="#3-1-é™æ€å®šä½" class="headerlink" title="3.1 é™æ€å®šä½"></a>3.1 é™æ€å®šä½</h2><ul><li>å®šä¹‰ï¼šé™æ€å®šä½æ˜¯å…ƒç´ çš„é»˜è®¤å®šä½æ–¹å¼ï¼Œå³æ— å®šä½ã€‚</li><li>è¯­æ³•ï¼š<code>&#123;positionï¼š static&#125;</code></li><li>ç‰¹ç‚¹ï¼š<ul><li>æŒ‰ç…§æ ‡å‡†æµçš„ç‰¹æ€§ï¼Œæ²¡æœ‰ä½åç§»</li></ul></li><li>åº”ç”¨ï¼š<ul><li>é™æ€å®šä½åœ¨å¸ƒå±€æ—¶å¾ˆå°‘ç”¨åˆ°</li></ul></li></ul><h2 id="3-2-ç›¸å¯¹å®šä½"><a href="#3-2-ç›¸å¯¹å®šä½" class="headerlink" title="3.2 ç›¸å¯¹å®šä½"></a>3.2 ç›¸å¯¹å®šä½</h2><ul><li>å®šä¹‰ï¼š ç›¸å¯¹å®šä½æ˜¯å…ƒç´ åœ¨ç§»åŠ¨ä½ç½®çš„æ—¶å€™ï¼Œç›¸å¯¹å®ƒåŸæ¥çš„ä½ç½®æ¥è¯´çš„ã€‚</li><li>è¯­æ³• ï¼š<code>&#123;positionï¼š relative&#125;</code></li><li>ç‰¹ç‚¹ï¼š<ul><li>ç§»åŠ¨çš„ä½ç½®æ˜¯å‚ç…§è‡ªå·±åŸå…ˆçš„ä½ç½®</li><li>ä¸è„±æ ‡ï¼Œç»§ç»­ä¿ç•™åŸæ¥çš„ä½ç½®</li></ul></li><li>åº”ç”¨ï¼š<ul><li>ç»™å†³å®šå®šä½å½“çˆ¹</li></ul></li></ul><h2 id="3-3-ç»å¯¹å®šä½"><a href="#3-3-ç»å¯¹å®šä½" class="headerlink" title="3.3 ç»å¯¹å®šä½"></a>3.3 ç»å¯¹å®šä½</h2><ul><li>å®šä¹‰ï¼šç»å¯¹å®šä½æ˜¯å…ƒç´ åœ¨ç§»åŠ¨ä½ç½®çš„æ—¶å€™ï¼Œç›¸å¯¹å®ƒ<strong>ç¥–è¾ˆå…ƒç´ </strong>çš„ä½ç½®æ¥è¯´çš„ã€‚</li><li>è¯­æ³•ï¼š<code>&#123;positionï¼š absolute&#125;</code></li><li>ç‰¹ç‚¹ï¼š<ul><li>å¦‚æœæ²¡æœ‰ç¥–å…ˆå…ƒç´ ï¼Œæˆ–ç¥–å…ˆå…ƒç´ æ²¡æœ‰å®šä½ï¼Œåˆ™ä»¥æµè§ˆå™¨ä¸ºå‡†å®šä½ï¼ˆDocumentæ–‡æ¡£ï¼‰</li><li>å¦‚æœç¥–å…ˆå…ƒç´ æœ‰å®šä½ï¼ˆç›¸å¯¹ï¼Œç»å¯¹ï¼Œå›ºå®šå®šä½ï¼‰ï¼Œåˆ™ä»¥æœ€è¿‘ä¸€çº§æœ‰å®šä½çš„ç¥–å…ˆå…ƒç´ ï¼Œä¸ºå‚è€ƒç‚¹ç§»åŠ¨ä½ç½®ã€‚</li><li>ç»å¯¹å®šä½ä¸å†å æœ‰åŸå…ˆçš„ä½ç½®ï¼ˆè„±æ ‡ï¼‰</li></ul></li></ul><p><strong>å­ç»çˆ¶ç›¸çš„ç”±æ¥</strong></p><ul><li>æ„æ€æ˜¯ï¼šå­çº§æ˜¯ç»å¯¹å®šä½çš„è¯ï¼Œçˆ¶çº§è¦æ˜¯ç›¸å¯¹å®šä½</li><li>ç†ç”±ï¼š<ul><li>çˆ¶çº§éœ€è¦å æœ‰ä½ç½®ï¼Œæ‰€ä»¥æ˜¯ç›¸å¯¹å®šä½</li><li>å­çº§éœ€è¦ä¸å æœ‰ä½ç½®ï¼Œå¹¶ä¸”å¯ä»¥æ”¾åˆ°çˆ¶ç›’å­çš„ä»»æ„ä¸€ä¸ªåœ°æ–¹ã€‚æ‰€ä»¥æ˜¯ç»å¯¹å®šä½ã€‚</li></ul></li></ul><h2 id="3-4-å›ºå®šå®šä½"><a href="#3-4-å›ºå®šå®šä½" class="headerlink" title="3.4 å›ºå®šå®šä½"></a>3.4 å›ºå®šå®šä½</h2><ul><li>å®šä¹‰ï¼šå›ºå®šå®šä½æ˜¯å…ƒç´ å›ºå®šäºæµè§ˆå™¨çš„å¯è§†åŒºçš„ä½ç½®</li><li>è¯­æ³•ï¼š<code>&#123;positionï¼š fixed&#125;</code></li><li>ç‰¹ç‚¹ï¼š<ul><li>ä»¥æµè§ˆå™¨çš„å¯è§†çª—å£ä¸ºå‚ç…§ç‚¹ç§»åŠ¨å…ƒç´ </li><li>æµè§ˆå™¨æ»šåŠ¨æ—¶ï¼Œå…ƒç´ çš„ä½ç½®ä¸ä¼šæ”¹å˜</li><li>è·Ÿçˆ¶å…ƒç´ æ²¡æœ‰å…³ç³»</li><li>ä¸å æœ‰åŸå…ˆçš„ä½ç½®ï¼ˆè„±æ ‡ï¼‰</li></ul></li></ul><blockquote><p>å›ºå®šå®šä½å¯ä»¥çœ‹åšæ˜¯ä¸€ç§ç‰¹æ®Šçš„ç»å¯¹å®šä½</p></blockquote><h2 id="3-5-ç²˜æ€§å®šä½"><a href="#3-5-ç²˜æ€§å®šä½" class="headerlink" title="3.5 ç²˜æ€§å®šä½"></a>3.5 ç²˜æ€§å®šä½</h2><ul><li>å®šä¹‰ï¼šç²˜æ€§å®šä½å¯ä»¥çœ‹åšç›¸å¯¹å®šä½å’Œå›ºå®šå®šä½çš„æ··åˆã€‚ä¸€èˆ¬è·Ÿé¡µé¢æ»šåŠ¨æ¡æ­é…ä½¿ç”¨</li><li>è¯­æ³•ï¼š<code>&#123;positionï¼š sticky; top: 10px&#125;</code>ï¼ˆåˆšå¼€å§‹éšæ»šåŠ¨æ¡æ»šåŠ¨ï¼Œç­‰åˆ°è¾¾äº†è·è·ç¦»æµè§ˆå™¨å¯è§†çª—å£ä¸Šæ–¹çš„10pxåï¼Œå°±å›ºå®šåœ¨äº†çª—å£ä¸Šï¼‰</li><li>ç‰¹ç‚¹ï¼š<ul><li>ä»¥æµè§ˆå™¨çš„å¯è§†çª—å£ä¸ºå‚ç…§ç‚¹ç§»åŠ¨å…ƒç´ </li><li>ä¸è„±æ ‡ï¼Œç»§ç»­ä¿ç•™åŸæ¥çš„ä½ç½®</li><li>å¿…é¡»æ·»åŠ topï¼Œleft,  rightï¼Œ bottomä¸­çš„ä¸€ä¸ªæ‰æœ‰æ•ˆ</li><li>å…¼å®¹æ€§å·®ï¼Œä¸æ”¯æŒIE</li></ul></li></ul><h1 id="4-å®šä½å æ”¾æ¬¡åº"><a href="#4-å®šä½å æ”¾æ¬¡åº" class="headerlink" title="4 å®šä½å æ”¾æ¬¡åº"></a>4 å®šä½å æ”¾æ¬¡åº</h1><ul><li>å®šä¹‰ï¼š ä½¿ç”¨å®šä½å¸ƒå±€æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ç›’å­çš„é‡å æƒ…å†µã€‚æ­¤æ—¶ï¼Œä½¿ç”¨z-index æ¥è®¾ç½®å æ”¾æ¬¡åº</li><li>è¯­æ³•ï¼š<code>&#123;z-index: 1&#125;</code></li><li>ç‰¹ç‚¹ï¼š<ul><li>æ•°å€¼å¯ä»¥æ˜¯æ­£æ•´æ•°ã€è´Ÿæ•´æ•°ã€0ï¼Œé»˜è®¤æ˜¯auto</li><li>æ•°å€¼è¶Šå¤§ï¼Œç›’å­è¶Šé ä¸Š</li><li>æ•°å­—åé¢ä¸èƒ½åŠ å•ä½</li><li>åªæœ‰å®šä½çš„ç›’å­æ‰èƒ½æœ‰z-indexå±æ€§</li></ul></li></ul><h1 id="5-ç»å¯¹å®šä½ç›’å­å±…ä¸­"><a href="#5-ç»å¯¹å®šä½ç›’å­å±…ä¸­" class="headerlink" title="5 ç»å¯¹å®šä½ç›’å­å±…ä¸­"></a>5 ç»å¯¹å®šä½ç›’å­å±…ä¸­</h1><ul><li>åŠ äº†ç»å¯¹å®šä½çš„ç›’å­ä¸èƒ½é€šè¿‡<code>margin: 0 auto</code>æ°´å¹³å±…ä¸­ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ä»¥ä¸‹è®¡ç®—æ–¹æ³•å®ç°å±…ä¸­ã€‚<ol><li><code>left: 50%</code>: è®©ç›’å­çš„å·¦ä¾§ç§»åŠ¨çˆ¶å®¹å™¨å®½åº¦çš„ä¸€åŠ</li><li><code>margin-left: -0.5*è‡ªèº«å®½åº¦ px</code>: è®©ç›’å­å‘å·¦ç§»åŠ¨è‡ªèº«ç›’å­å®½åº¦çš„ä¸€èˆ¬</li></ol></li></ul>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSSå…ƒç´ æ˜¾ç¤ºæ¨¡å¼</title>
    <link href="/CSS%E5%85%83%E7%B4%A0%E6%98%BE%E7%A4%BA%E6%A8%A1%E5%BC%8F/"/>
    <url>/CSS%E5%85%83%E7%B4%A0%E6%98%BE%E7%A4%BA%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1 å®šä¹‰"></a>1 å®šä¹‰</h1><ul><li><p>å…ƒç´ æ˜¾ç¤ºæ¨¡å¼å°±æ˜¯ï¼šå…ƒç´ ï¼ˆæ ‡ç­¾ï¼‰ä»¥ä»€ä¹ˆæ–¹å¼è¿›è¡Œæ˜¾ç¤ºã€‚æ¯”å¦‚<div>è‡ªå·±å ä¸€è¡Œï¼Œä¸€è¡Œå¯ä»¥æ”¾å¤šä¸ª<span></p></li><li><p>htmlå…ƒç´ ä¸€èˆ¬å¯ä»¥åˆ†ä¸ºï¼šå—å…ƒç´ å’Œè¡Œå…ƒç´ </p></li></ul><h1 id="2-å—å…ƒç´ "><a href="#2-å—å…ƒç´ " class="headerlink" title="2 å—å…ƒç´ "></a>2 å—å…ƒç´ </h1><p>å¸¸è§çš„å—çº§å…ƒç´ æœ‰divã€hrã€pã€h1 - h6, ul , ol , form , table</p><h2 id="2-1-ç‰¹ç‚¹"><a href="#2-1-ç‰¹ç‚¹" class="headerlink" title="2.1 ç‰¹ç‚¹"></a>2.1 ç‰¹ç‚¹</h2><ul><li>ç‹¬å ä¸€è¡Œ</li><li>å¯ä»¥æ§åˆ¶ï¼šå®½åº¦ï¼Œé«˜åº¦ï¼Œå†…å¤–è¾¹è·</li><li>å®½åº¦é»˜è®¤æ˜¯çˆ¶å®¹å™¨çš„100%</li><li>æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢å¯ä»¥æ”¾è¡Œå†…å…ƒç´ æˆ–è€…å—çº§å…ƒç´ </li></ul><p>æ³¨æ„ï¼šæ–‡å­—ç±»çš„å…ƒç´ å†…ä¸èƒ½ä½¿ç”¨å—çº§å…ƒç´ ã€‚å¦‚<code>&lt;p&gt;, &lt;h1&gt;~&lt;h6&gt;</code>é‡Œé¢ä¸å¯ä»¥ä½¿ç”¨div</p><h1 id="3-è¡Œå†…å…ƒç´ "><a href="#3-è¡Œå†…å…ƒç´ " class="headerlink" title="3 è¡Œå†…å…ƒç´ "></a>3 è¡Œå†…å…ƒç´ </h1><p>å¸¸è§çš„è¡Œå†…å…ƒç´ æœ‰a, span, a, i ,em ç­‰</p><h2 id="3-1-ç‰¹ç‚¹"><a href="#3-1-ç‰¹ç‚¹" class="headerlink" title="3.1 ç‰¹ç‚¹"></a>3.1 ç‰¹ç‚¹</h2><ul><li><p>è¡Œå†…å…ƒç´ åœ¨ä¸€è¡Œå¯ä»¥æ˜¾ç¤ºå¤šä¸ª</p></li><li><p>é«˜å’Œå®½è®¾ç½®æ˜¯æ— æ•ˆçš„</p></li><li><p>å®½åº¦é»˜è®¤å°±æ˜¯ä»–æœ¬èº«å†…å®¹çš„å®½åº¦</p></li><li><p>è¡Œå†…å…ƒç´ åªèƒ½å®¹çº³æ–‡æœ¬æˆ–è€…å…¶ä»–è¡Œå†…å…ƒç´ </p></li></ul><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>é“¾æ¥é‡Œé¢ä¸èƒ½å†æ”¾é“¾æ¥</li></ul><h1 id="4-è¡Œå†…å—å…ƒç´ "><a href="#4-è¡Œå†…å—å…ƒç´ " class="headerlink" title="4 è¡Œå†…å—å…ƒç´ "></a>4 è¡Œå†…å—å…ƒç´ </h1><p> å¸¸è§çš„è¡Œå†…å—å…ƒç´ æœ‰ï¼šinput, img, tdã€‚ä»–ä»¬åŒäº‹å…·æœ‰å—å…ƒç´ å’Œè¡Œå†…å…ƒç´ çš„ç‰¹ç‚¹ã€‚</p><h2 id="4-1-ç‰¹ç‚¹"><a href="#4-1-ç‰¹ç‚¹" class="headerlink" title="4. 1 ç‰¹ç‚¹"></a>4. 1 ç‰¹ç‚¹</h2><ul><li>ä¸€è¡Œå¯ä»¥æ˜¾ç¤ºå¤šä¸ªï¼Œä½†æ˜¯å¤šä¸ªé—´ä¼šæœ‰ç©ºç™½ç¼éš™ã€‚</li><li>å®½åº¦é»˜è®¤å°±æ˜¯ä»–æœ¬èº«å†…å®¹çš„å®½åº¦</li><li>å¯ä»¥æ§åˆ¶ï¼šå®½åº¦ï¼Œé«˜åº¦ï¼Œå†…å¤–è¾¹è·</li></ul><h1 id="5-å…ƒç´ æ˜¾ç¤ºæ¨¡å¼çš„è½¬æ¢"><a href="#5-å…ƒç´ æ˜¾ç¤ºæ¨¡å¼çš„è½¬æ¢" class="headerlink" title="5 å…ƒç´ æ˜¾ç¤ºæ¨¡å¼çš„è½¬æ¢"></a>5 å…ƒç´ æ˜¾ç¤ºæ¨¡å¼çš„è½¬æ¢</h1><p>å¸¸è§çš„æ“ä½œï¼šæƒ³å¢åŠ aé“¾æ¥çš„è§¦å‘èŒƒå›´</p><ul><li>è½¬ä¸ºå—å…ƒç´ ï¼š<code>display:block</code></li><li>è½¬ä¸ºè¡Œå†…å…ƒç´ ï¼š<code>display:inline</code></li><li>è½¬ä¸ºè¡Œå†…å—å…ƒç´ ï¼š<code>display:inline-block</code></li></ul>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è§£å†³æ‰‹æœºç«¯1åƒç´ è¾¹æ¡†é—®é¢˜</title>
    <link href="/%E8%A7%A3%E5%86%B3%E6%89%8B%E6%9C%BA%E7%AB%AF1%E5%83%8F%E7%B4%A0%E8%BE%B9%E6%A1%86%E9%97%AE%E9%A2%98/"/>
    <url>/%E8%A7%A3%E5%86%B3%E6%89%8B%E6%9C%BA%E7%AB%AF1%E5%83%8F%E7%B4%A0%E8%BE%B9%E6%A1%86%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å®šä¹‰border-cssæ–‡ä»¶"><a href="#1-å®šä¹‰border-cssæ–‡ä»¶" class="headerlink" title="1. å®šä¹‰border.cssæ–‡ä»¶"></a>1. å®šä¹‰border.cssæ–‡ä»¶</h1><p><a href="https://github.com/panyuro/Travel/blob/main/src/assets/styles/border.css">Travel&#x2F;border.css at main Â· panyuro&#x2F;Travel (github.com)</a></p><h1 id="2-åœ¨main-jså¼•å…¥"><a href="#2-åœ¨main-jså¼•å…¥" class="headerlink" title="2. åœ¨main.jså¼•å…¥"></a>2. åœ¨main.jså¼•å…¥</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;./assets/styles/border.css&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSSæµ®åŠ¨</title>
    <link href="/CSS%E6%B5%AE%E5%8A%A8/"/>
    <url>/CSS%E6%B5%AE%E5%8A%A8/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤šä¸ªå—çº§å…ƒç´ çºµå‘æ’åˆ—æ‰¾æ ‡å‡†æµï¼Œæ¨ªå‘æ’åˆ—æ‰¾æµ®åŠ¨ã€‚</p></blockquote><h1 id="1-æ™®é€šæµï¼ˆæ ‡å‡†æµï¼‰"><a href="#1-æ™®é€šæµï¼ˆæ ‡å‡†æµï¼‰" class="headerlink" title="1 æ™®é€šæµï¼ˆæ ‡å‡†æµï¼‰"></a>1 æ™®é€šæµï¼ˆæ ‡å‡†æµï¼‰</h1><h2 id="1-1-å®šä¹‰"><a href="#1-1-å®šä¹‰" class="headerlink" title="1.1 å®šä¹‰"></a>1.1 å®šä¹‰</h2><p>æ ‡å‡†æµå°±æ˜¯æ ‡ç­¾æŒ‰ç…§è§„å®šå¥½é»˜è®¤æ–¹å¼æ’åˆ—ã€‚æ ‡å‡†æµæ˜¯æœ€åŸºæœ¬çš„å¸ƒå±€æ–¹å¼ã€‚</p><ol><li>å—çº§å…ƒç´ ä¼šç‹¬å ä¸€è¡Œï¼Œä»ä¸Šåˆ°ä¸‹é¡ºåºæ’åˆ—ã€‚å¦‚ï¼šdivã€hrã€pã€h1 - h6, ul , ol , form , table</li><li>è¡Œå†…å…ƒç´ ä¼šæŒ‰ç…§é¡ºåºï¼Œä»å·¦å¾€å³æ’åº,å¦‚ï¼šspan, a, i ,em</li></ol><h1 id="2-æµ®åŠ¨"><a href="#2-æµ®åŠ¨" class="headerlink" title="2 æµ®åŠ¨"></a>2 æµ®åŠ¨</h1><h2 id="2-1-ä¸ºä»€ä¹ˆéœ€è¦æµ®åŠ¨ï¼Ÿ"><a href="#2-1-ä¸ºä»€ä¹ˆéœ€è¦æµ®åŠ¨ï¼Ÿ" class="headerlink" title="2.1 ä¸ºä»€ä¹ˆéœ€è¦æµ®åŠ¨ï¼Ÿ"></a>2.1 ä¸ºä»€ä¹ˆéœ€è¦æµ®åŠ¨ï¼Ÿ</h2><ul><li>æœ‰å¾ˆå¤šå¸ƒå±€æ•ˆæœï¼Œæ ‡å‡†æµæ²¡æœ‰åŠæ³•å®Œæˆã€‚æ¯”å¦‚ï¼šå¤šä¸ªå—çº§ç›’å­ä¸€è¡Œæ²¡æœ‰ç¼éš™æ’åˆ—ã€‚</li><li>æµ®åŠ¨ï¼Œå¯ä»¥æ”¹å˜å…ƒç´ æ ‡ç­¾çš„é»˜è®¤æ’åˆ—æ–¹å¼ã€‚</li><li>æµ®åŠ¨æœ€åˆäº§ç”Ÿçš„ç›®çš„ï¼šåšæ–‡å­—ç¯ç»•ã€‚</li></ul><h2 id="2-2-ä»€ä¹ˆæ˜¯æµ®åŠ¨ï¼Ÿ"><a href="#2-2-ä»€ä¹ˆæ˜¯æµ®åŠ¨ï¼Ÿ" class="headerlink" title="2.2 ä»€ä¹ˆæ˜¯æµ®åŠ¨ï¼Ÿ"></a>2.2 ä»€ä¹ˆæ˜¯æµ®åŠ¨ï¼Ÿ</h2><ul><li><p>floatå±æ€§ï¼Œç”¨äºåˆ›å»ºæµ®åŠ¨æ¡†ï¼Œå°†å…¶ç§»åŠ¨åˆ°ä¸€è¾¹ï¼Œç›´è‡³å·¦è¾¹ç¼˜æˆ–è€…å³è¾¹ç¼˜è§¦åŠåˆ°åŒ…å«å—æˆ–è€…å¦ä¸€ä¸ªæµ®åŠ¨æ¡†çš„è¾¹ç¼˜</p></li><li><p>è¯­æ³•ï¼š<code>&#123;float: å±æ€§å€¼&#125;</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221126195705.png"></p></li></ul><h2 id="2-3-æµ®åŠ¨ç‰¹æ€§"><a href="#2-3-æµ®åŠ¨ç‰¹æ€§" class="headerlink" title="2.3 æµ®åŠ¨ç‰¹æ€§"></a>2.3 æµ®åŠ¨ç‰¹æ€§</h2><ol><li><p>è®¾ç½®äº†æµ®åŠ¨çš„å…ƒç´ ï¼Œè„±ç¦»äº†æ ‡å‡†æµçš„æ§åˆ¶ï¼ˆç®€ç§°â€œè„±æ ‡â€ï¼‰ã€‚æµ®åŠ¨çš„ç›’å­ä¸å†ä¿ç•™åŸæ¥çš„ä½ç½®ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221126200811.png"></p></li><li><p>å¦‚æœå¤šä¸ªç›’å­éƒ½è®¾ç½®äº†æµ®åŠ¨ï¼Œåˆ™ä»–ä»¬ä¼šæŒ‰ç…§å±æ€§å€¼ï¼Œä¸€è¡Œæ˜¾ç¤ºå¹¶ä¸”é¡¶ç«¯å¯¹é½æ’åˆ—ã€‚</p><ul><li><p>æ³¨æ„ï¼šæµ®åŠ¨çš„å…ƒç´ æ˜¯äº’ç›¸è´´åœ¨ä¸€èµ·çš„ï¼ˆä¸ä¼šæœ‰ç¼éš™ï¼‰ï¼Œå¦‚æœçˆ¶çº§å…ƒç´ è£…ä¸ä¸‹è¿™äº›æµ®åŠ¨çš„ç›’å­ï¼Œå¤šå‡ºçš„ç›’å­ä¼šå¦èµ·ä¸€è¡Œå¯¹é½ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221126222207.png"></p></li></ul></li><li><p>è®¾ç½®äº†æµ®åŠ¨çš„å…ƒç´ ï¼Œä¼šå…·æœ‰è¡Œå†…å—å…ƒç´ çš„ç‰¹æ€§</p><ul><li>å—çº§å…ƒç´ ï¼Œæ²¡æœ‰è®¾ç½®å®½åº¦æ—¶ï¼Œé»˜è®¤å®½åº¦å’Œçˆ¶çº§ä¸€æ ·ã€‚ä½†æ˜¯æ·»åŠ æµ®åŠ¨åï¼Œä»–çš„å¤§å°æ ¹æ®å†…å®¹æ¥å†³å®šã€‚</li><li>è¡Œå†…å…ƒç´ ï¼Œæ·»åŠ æµ®åŠ¨åï¼Œå°±å¯ä»¥ç›´æ¥è®¾ç½®é«˜åº¦å’Œå®½åº¦ã€‚</li></ul></li><li><p>æµ®åŠ¨ä¸ä¼šå‹ä½å®ƒä¸‹é¢æ ‡å‡†æµç›’å­é‡Œçš„æ–‡å­—ã€‚å› ä¸ºä»–æœ€åˆè®¾ç½®çš„ç›®çš„å°±æ˜¯ä¸ºäº†åšæ–‡å­—ç¯ç»•ã€‚</p></li></ol><h2 id="2-4-æµ®åŠ¨å¸ƒå±€çš„æ³¨æ„ç‚¹"><a href="#2-4-æµ®åŠ¨å¸ƒå±€çš„æ³¨æ„ç‚¹" class="headerlink" title="2.4 æµ®åŠ¨å¸ƒå±€çš„æ³¨æ„ç‚¹"></a>2.4 æµ®åŠ¨å¸ƒå±€çš„æ³¨æ„ç‚¹</h2><h3 id="2-4-1-æµ®åŠ¨å’Œæ ‡å‡†æµçˆ¶çº§æ­é…ä½¿ç”¨"><a href="#2-4-1-æµ®åŠ¨å’Œæ ‡å‡†æµçˆ¶çº§æ­é…ä½¿ç”¨" class="headerlink" title="2.4.1  æµ®åŠ¨å’Œæ ‡å‡†æµçˆ¶çº§æ­é…ä½¿ç”¨"></a>2.4.1  æµ®åŠ¨å’Œæ ‡å‡†æµçˆ¶çº§æ­é…ä½¿ç”¨</h3><p>ä¸ºäº†çº¦æŸæµ®åŠ¨å…ƒç´ çš„ä½ç½®ï¼Œæˆ‘ä»¬ä¸€èˆ¬é‡‡å–çš„ç­–ç•¥æ˜¯ï¼š<strong>å…ˆç”¨æ ‡å‡†æµçš„çˆ¶å…ƒç´ æ’åˆ—ä¸Šä¸‹ä½ç½®ï¼Œä¹‹åå†…éƒ¨å…ƒç´ é‡‡å–æµ®åŠ¨ï¼Œæ’åˆ—å·¦å³ä½ç½®ã€‚</strong></p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221126230639.png" style="zoom:50%;" /><h3 id="2-4-2-ä¸€ä¸ªå…ƒç´ æµ®åŠ¨äº†ï¼Œç†è®ºä¸Šå…¶ä½™çš„å…„å¼Ÿå…ƒç´ éƒ½åº”è¯¥æµ®åŠ¨"><a href="#2-4-2-ä¸€ä¸ªå…ƒç´ æµ®åŠ¨äº†ï¼Œç†è®ºä¸Šå…¶ä½™çš„å…„å¼Ÿå…ƒç´ éƒ½åº”è¯¥æµ®åŠ¨" class="headerlink" title="2.4.2 ä¸€ä¸ªå…ƒç´ æµ®åŠ¨äº†ï¼Œç†è®ºä¸Šå…¶ä½™çš„å…„å¼Ÿå…ƒç´ éƒ½åº”è¯¥æµ®åŠ¨"></a>2.4.2 ä¸€ä¸ªå…ƒç´ æµ®åŠ¨äº†ï¼Œç†è®ºä¸Šå…¶ä½™çš„å…„å¼Ÿå…ƒç´ éƒ½åº”è¯¥æµ®åŠ¨</h3><p>æµ®åŠ¨çš„ç›’å­ï¼Œåªä¼šå½±å“ä»–åé¢çš„æ ‡å‡†æµï¼Œä¸ä¼šå½±å“å‰é¢çš„æ ‡å‡†æµã€‚å› ä¸ºå‰é¢çš„æ ‡å‡†æµå·²ç»ç‹¬å ä¸€è¡Œäº†</p><h1 id="2-5-æ¸…é™¤æµ®åŠ¨"><a href="#2-5-æ¸…é™¤æµ®åŠ¨" class="headerlink" title="2.5 æ¸…é™¤æµ®åŠ¨"></a>2.5 æ¸…é™¤æµ®åŠ¨</h1><h3 id="2-5-1-ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿ"><a href="#2-5-1-ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿ" class="headerlink" title="2.5.1 ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿ"></a>2.5.1 ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿ</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚ï¼šæ–‡å­—é•¿çŸ­ä¸å®šï¼Œåˆ—è¡¨å±•ç¤ºé«˜åº¦ä¸å®šã€‚çˆ¶ç›’å­ä¸æ–¹ä¾¿ç»™é«˜åº¦ã€‚</p><p>ä½†æ˜¯å­ç›’å­æµ®åŠ¨åˆä¸å æœ‰ä½ç½®ï¼Œæœ€åä¼šå¯¼è‡´çˆ¶ç›’å­ä¸å ç”¨åŸæ–‡æ¡£æµçš„ä½ç½®ï¼Œé«˜åº¦ä¸º0ï¼Œä¼šå½±å“åé¢çš„å…ƒç´ æ’ç‰ˆã€‚</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221127000827.png" style="zoom:50%;" /><h3 id="2-5-2-æ¸…é™¤æµ®åŠ¨çš„æœ¬è´¨"><a href="#2-5-2-æ¸…é™¤æµ®åŠ¨çš„æœ¬è´¨" class="headerlink" title="2.5.2 æ¸…é™¤æµ®åŠ¨çš„æœ¬è´¨"></a>2.5.2 æ¸…é™¤æµ®åŠ¨çš„æœ¬è´¨</h3><p>æ¸…é™¤æµ®åŠ¨ä¹‹åï¼Œçˆ¶çº§å°±ä¼šæ ¹æ®æµ®åŠ¨çš„å­ç›’å­è‡ªåŠ¨æ£€æµ‹é«˜åº¦ã€‚çˆ¶çº§æœ‰äº†é«˜åº¦ï¼Œå°±ä¸ä¼šå½±å“åé¢çš„å…ƒç´ æ’ç‰ˆäº†ã€‚</p><h3 id="2-5-3-æ¸…é™¤æµ®åŠ¨çš„æ–¹å¼"><a href="#2-5-3-æ¸…é™¤æµ®åŠ¨çš„æ–¹å¼" class="headerlink" title="2.5.3 æ¸…é™¤æµ®åŠ¨çš„æ–¹å¼"></a>2.5.3 æ¸…é™¤æµ®åŠ¨çš„æ–¹å¼</h3><ul><li><p>è¯­æ³•ï¼š<code>&#123;clear: å±æ€§å€¼&#125;</code>ï¼Œå®é™…å·¥ä½œä¸­ï¼Œå‡ ä¹åªç”¨clear:both</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20221127112835.png" style="zoom:50%;" /></li></ul><h4 id="1-é¢å¤–æ ‡ç­¾æ³•"><a href="#1-é¢å¤–æ ‡ç­¾æ³•" class="headerlink" title="1 é¢å¤–æ ‡ç­¾æ³•"></a>1 é¢å¤–æ ‡ç­¾æ³•</h4><ul><li><p>å®šä¹‰ï¼š é¢å¤–æ ‡ç­¾æ³•ä¹Ÿç§°ä¹‹ä¸º<strong>éš”å¢™æ³•</strong>ï¼Œ æ˜¯W3Cæœ€æ¨èçš„åšæ³•ã€‚</p></li><li><p>ä½¿ç”¨ï¼šåœ¨æµ®åŠ¨å…ƒç´ æœ«å°¾æ·»åŠ ä¸€ä¸ªç©ºçš„æ ‡ç­¾ï¼Œä¾‹å¦‚ï¼š<code>&lt;div style=&quot;clear: both&quot;&gt;&lt;/div&gt;</code></p></li><li><p>ä¼˜ç¼ºç‚¹ï¼š</p><ul><li>ä¼˜ç‚¹ï¼šé€šä¿—æ˜“æ‡‚ï¼Œä¹¦å†™æ–¹ä¾¿</li><li>ç¼ºç‚¹ï¼šå¢åŠ äº†æ— æ„ä¹‰çš„æ ‡ç­¾ï¼Œç»“æ„åŒ–å·®</li></ul></li></ul><h4 id="2-ç»™çˆ¶çº§æ·»åŠ overflow"><a href="#2-ç»™çˆ¶çº§æ·»åŠ overflow" class="headerlink" title="2 ç»™çˆ¶çº§æ·»åŠ overflow"></a>2 ç»™çˆ¶çº§æ·»åŠ overflow</h4><ul><li>ä½¿ç”¨ï¼šç»™çˆ¶çº§æ·»åŠ overflowå±æ€§ï¼Œå°†å…¶å±æ€§å€¼è®¾ç½®ä¸ºï¼šhidden, auto æˆ– scroll</li><li>ä¼˜ç¼ºç‚¹ï¼š<ul><li>ä¼˜ç‚¹ï¼šä»£ç ç®€ä»‹</li><li>ç¼ºç‚¹ï¼š æ— æ³•å±•ç¤ºæº¢å‡ºçš„éƒ¨åˆ†</li></ul></li></ul><h4 id="3-after-ä¼ªå…ƒç´ æ³•"><a href="#3-after-ä¼ªå…ƒç´ æ³•" class="headerlink" title="3 :after ä¼ªå…ƒç´ æ³•"></a>3 :after ä¼ªå…ƒç´ æ³•</h4><ul><li>ä½¿ç”¨ï¼šafteræ–¹å¼æ˜¯é¢å¤–æ ‡ç­¾æ³•çš„å‡çº§ç‰ˆã€‚åªéœ€è¦ç»™çˆ¶ç±»å…ƒç´ æ·»åŠ ï¼š</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.clearfix</span>:after &#123;<br>    content: <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-attribute">display</span>: block;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">clear</span>: both;<br>    <span class="hljs-attribute">visibility</span>: hidden;<br>&#125;<br><br><span class="hljs-selector-class">.clearfix</span> &#123;<br>    <span class="hljs-comment">/*IE6,IE7*/</span><br>    zoom: <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ä¼˜ç¼ºç‚¹ï¼š<ul><li>ä¼˜ç‚¹ï¼šæ²¡æœ‰å¢åŠ æ ‡ç­¾ï¼Œç»“æ„ç®€å•</li><li>ç¼ºç‚¹ï¼šéœ€è¦ç…§é¡¾ä½ç‰ˆæœ¬æµè§ˆå™¨</li></ul></li><li>ä»£è¡¨ç½‘ç«™ï¼šç™¾åº¦ï¼Œæ·˜å®ï¼Œç½‘æ˜“</li></ul><h4 id="4-åŒä¼ªå…ƒç´ æ³•"><a href="#4-åŒä¼ªå…ƒç´ æ³•" class="headerlink" title="4. åŒä¼ªå…ƒç´ æ³•"></a>4. åŒä¼ªå…ƒç´ æ³•</h4><ul><li>ä½¿ç”¨ï¼šçˆ¶å…ƒç´ æ·»åŠ ï¼š</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.clearfix</span>:before, .clearfix:after &#123;<br>    content: <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-attribute">display</span>: table;<br>&#125;<br><span class="hljs-selector-class">.clearfix</span>:after &#123;<br>    clear: both;<br>&#125;<br><span class="hljs-selector-class">.clearfix</span> &#123;<br>    <span class="hljs-comment">/*IE6,IE7*/</span><br>    zoom: <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ä¼˜ç¼ºç‚¹ï¼š<ul><li>ä¼˜ç‚¹ï¼šä»£ç æ›´ç®€æ´</li><li>ç¼ºç‚¹ï¼šéœ€è¦ç…§é¡¾ä½ç‰ˆæœ¬æµè§ˆå™¨</li></ul></li><li>ä»£è¡¨ç½‘ç«™ï¼šå°ç±³ï¼Œè…¾è®¯</li></ul>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSSç›’å­æ¨¡å‹</title>
    <link href="/CSS%E7%9B%92%E5%AD%90%E6%A8%A1%E5%9E%8B/"/>
    <url>/CSS%E7%9B%92%E5%AD%90%E6%A8%A1%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å—çº§å…ƒç´ æ°´å¹³å±…ä¸­"><a href="#1-å—çº§å…ƒç´ æ°´å¹³å±…ä¸­" class="headerlink" title="1 å—çº§å…ƒç´ æ°´å¹³å±…ä¸­"></a>1 å—çº§å…ƒç´ æ°´å¹³å±…ä¸­</h1><ol><li>å¿…é¡»æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶<ul><li>ç›’å­å¿…é¡»æŒ‡æ˜äº†å®½åº¦</li><li>ç›’å­å·¦å³çš„å¤–è¾¹å‰§éƒ½è®¾ç½®ä¸ºauto</li></ul></li><li>å¸¸è§„å†™æ³•<ul><li>margin-left: auto ; margin-right: auto</li><li>margin: auto</li><li>margin: 0 auto</li></ul></li></ol><h1 id="2-è¡Œå†…å…ƒç´ æˆ–è€…è¡Œå†…å—å…ƒç´ æ°´å¹³å±…ä¸­"><a href="#2-è¡Œå†…å…ƒç´ æˆ–è€…è¡Œå†…å—å…ƒç´ æ°´å¹³å±…ä¸­" class="headerlink" title="2 è¡Œå†…å…ƒç´ æˆ–è€…è¡Œå†…å—å…ƒç´ æ°´å¹³å±…ä¸­"></a>2 è¡Œå†…å…ƒç´ æˆ–è€…è¡Œå†…å—å…ƒç´ æ°´å¹³å±…ä¸­</h1><p>è§£å†³æ–¹æ¡ˆï¼šç»™çˆ¶å…ƒç´ æ·»åŠ ï¼š text-align: center</p><h1 id="3-åµŒå¥—å—å…ƒç´ å‚ç›´å¤–è¾¹è·å¡Œé™·"><a href="#3-åµŒå¥—å—å…ƒç´ å‚ç›´å¤–è¾¹è·å¡Œé™·" class="headerlink" title="3 åµŒå¥—å—å…ƒç´ å‚ç›´å¤–è¾¹è·å¡Œé™·"></a>3 åµŒå¥—å—å…ƒç´ å‚ç›´å¤–è¾¹è·å¡Œé™·</h1><p>å¯¹äºä¸¤ä¸ªåµŒå¥—å…³ç³»ï¼ˆçˆ¶å­å…³ç³»ï¼‰çš„å—å…ƒç´ ï¼Œçˆ¶å…ƒç´ å’Œå­å…ƒç´ åŒæ—¶éƒ½æœ‰ä¸Šå¤–è¾¹è·ï¼Œæ­¤æ—¶çˆ¶å…ƒç´ ä¼šå¡Œé™·è¾ƒå¤§çš„å¤–è¾¹è·å€¼</p><p>è§£å†³æ–¹æ¡ˆ</p><ul><li>ç»™çˆ¶å…ƒç´ å®šä¹‰ä¸Šè¾¹æ¡†</li><li>ç»™çˆ¶å…ƒç´ å®šä¹‰ä¸Šå†…è¾¹è·</li><li>ç»™çˆ¶å…ƒç´ æ·»åŠ ï¼šoverflow: hidden</li></ul><h1 id="4-æ¸…é™¤å†…å¤–è¾¹è·"><a href="#4-æ¸…é™¤å†…å¤–è¾¹è·" class="headerlink" title="4 æ¸…é™¤å†…å¤–è¾¹è·"></a>4 æ¸…é™¤å†…å¤–è¾¹è·</h1><p>ç½‘é¡µå…ƒç´ å¾ˆå¤šéƒ½å¸¦æœ‰é»˜è®¤çš„å†…å¤–è¾¹è·ï¼Œä¸åŒçš„æµè§ˆå™¨é»˜è®¤çš„ä¹Ÿä¸ä¸€è‡´ã€‚å› æ­¤æˆ‘ä»¬åœ¨å¸ƒå±€å‰ï¼Œéœ€è¦æ¸…é™¤ä¸‹ç½‘é¡µå…ƒç´ çš„å†…å¤–è¾¹è·ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html">* &#123;<br>  padding: 0; /* æ¸…é™¤å†…è¾¹è· */<br>  margin: 0; /* æ¸…é™¤å¤–è¾¹è· */<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="5-Padding-ä¼šå½±å“ç›’å­çš„å¤§å°"><a href="#5-Padding-ä¼šå½±å“ç›’å­çš„å¤§å°" class="headerlink" title="5 Padding ä¼šå½±å“ç›’å­çš„å¤§å°"></a>5 Padding ä¼šå½±å“ç›’å­çš„å¤§å°</h1><ul><li>å¦‚æœç›’å­å·²ç»æœ‰äº†å®½åº¦å’Œé«˜åº¦ï¼Œæ­¤æ—¶å†æŒ‡å®šå†…è¾¹è·ï¼Œä¼šæ’‘å¤§ç›’å­</li></ul><p>â€‹è§£å†³æ–¹æ¡ˆï¼šè®©widthå’Œheightå‡å»å¤šå‡ºæ¥çš„å†…è¾¹è·å¤§å°</p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h8bv0i7jx1j314g0u0aet.jpg" style="zoom: 33%;" /><ul><li>å¦‚æœç›’å­æœ¬èº«æ²¡æœ‰æŒ‡å®šå®½åº¦å’Œé«˜åº¦ï¼Œåˆ™æ­¤æ—¶paddingä¸ä¼šæ’‘å¤§ç›’å­</li></ul><h1 id="6-padding-bottomå®ç°æ™®é€šå…ƒç´ å›ºå®šå®½é«˜æ¯”"><a href="#6-padding-bottomå®ç°æ™®é€šå…ƒç´ å›ºå®šå®½é«˜æ¯”" class="headerlink" title="6 padding-bottomå®ç°æ™®é€šå…ƒç´ å›ºå®šå®½é«˜æ¯”"></a>6 padding-bottomå®ç°æ™®é€šå…ƒç´ å›ºå®šå®½é«˜æ¯”</h1><p>å°†<code>div</code>å…ƒç´ çš„é«˜åº¦è®¾ä¸ºäº†<code>0</code>ï¼Œé€šè¿‡<code>padding-bottom</code>æ¥æ’‘å¼€ç›’å­çš„é«˜åº¦</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;father&quot;</span>&gt;<br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;son&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/div&gt;<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">.father &#123;<br>  <span class="hljs-attr">width</span>: <span class="hljs-number">50</span>%;<br>  background-color: #25a4bb;<br>&#125;<br><br>.son &#123;<br>  <span class="hljs-attr">height</span>: <span class="hljs-number">0</span>;<br>  padding-bottom: <span class="hljs-number">50</span>%; <span class="hljs-comment">//è§„å®šåŸºäºçˆ¶å…ƒç´ çš„å®½åº¦çš„ç™¾åˆ†æ¯”çš„å†…è¾¹è·ã€‚</span><br>  background-color: red;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ESLint</title>
    <link href="/ESLint/"/>
    <url>/ESLint/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ESLintæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-ESLintæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1 ESLintæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1 ESLintæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>ESLintæœ€åˆæ˜¯ç”±<a href="http://nczonline.net/">Nicholas C. Zakas</a> äº2013å¹´6æœˆåˆ›å»ºçš„å¼€æºé¡¹ç›®ã€‚å®ƒçš„ç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªæ’ä»¶åŒ–çš„javascriptä»£ç æ£€æµ‹å·¥å…·ã€‚</p><ul><li>ESLint çš„åˆè¡·æ˜¯ä¸ºäº†è®©ç¨‹åºå‘˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„æ£€æµ‹è§„åˆ™</li><li>ESLint å¹¶ä¸æ¨èä»»ä½•ç¼–ç é£æ ¼ï¼Œè§„åˆ™æ˜¯è‡ªç”±çš„</li></ul><p><strong>å®˜ç½‘ï¼š</strong><a href="https://eslint.bootcss.com/">ESLint - æ’ä»¶åŒ–çš„ JavaScript ä»£ç æ£€æµ‹å·¥å…· - ESLintä¸­æ–‡æ–‡æ¡£ (bootcss.com)</a></p><h1 id="2-ä¼˜åŠ¿"><a href="#2-ä¼˜åŠ¿" class="headerlink" title="2 ä¼˜åŠ¿"></a>2 ä¼˜åŠ¿</h1><h3 id="2-1-é¿å…ä½çº§bugï¼Œæ‰¾å‡ºå¯èƒ½å‘ç”Ÿçš„è¯­æ³•é”™è¯¯"><a href="#2-1-é¿å…ä½çº§bugï¼Œæ‰¾å‡ºå¯èƒ½å‘ç”Ÿçš„è¯­æ³•é”™è¯¯" class="headerlink" title="2.1. é¿å…ä½çº§bugï¼Œæ‰¾å‡ºå¯èƒ½å‘ç”Ÿçš„è¯­æ³•é”™è¯¯"></a>2.1. é¿å…ä½çº§bugï¼Œæ‰¾å‡ºå¯èƒ½å‘ç”Ÿçš„è¯­æ³•é”™è¯¯</h3><blockquote><p>ä½¿ç”¨æœªå£°æ˜å˜é‡ã€ä¿®æ”¹ const å˜é‡â€¦â€¦</p></blockquote><h3 id="2-2-æç¤ºåˆ é™¤å¤šä½™çš„ä»£ç "><a href="#2-2-æç¤ºåˆ é™¤å¤šä½™çš„ä»£ç " class="headerlink" title="2.2. æç¤ºåˆ é™¤å¤šä½™çš„ä»£ç "></a>2.2. æç¤ºåˆ é™¤å¤šä½™çš„ä»£ç </h3><blockquote><p>å£°æ˜è€Œæœªä½¿ç”¨çš„å˜é‡ã€é‡å¤çš„ case â€¦â€¦</p></blockquote><h3 id="2-3-ç»Ÿä¸€å›¢é˜Ÿçš„ä»£ç é£æ ¼"><a href="#2-3-ç»Ÿä¸€å›¢é˜Ÿçš„ä»£ç é£æ ¼" class="headerlink" title="2.3. ç»Ÿä¸€å›¢é˜Ÿçš„ä»£ç é£æ ¼"></a>2.3. ç»Ÿä¸€å›¢é˜Ÿçš„ä»£ç é£æ ¼</h3><blockquote><p>åŠ ä¸åŠ åˆ†å·ï¼Ÿä½¿ç”¨ tab è¿˜æ˜¯ç©ºæ ¼ï¼Ÿ</p></blockquote><h1 id="3-ESLintæ£€æŸ¥è¯­æ³•çš„è§„åˆ™"><a href="#3-ESLintæ£€æŸ¥è¯­æ³•çš„è§„åˆ™" class="headerlink" title="3 ESLintæ£€æŸ¥è¯­æ³•çš„è§„åˆ™"></a>3 ESLintæ£€æŸ¥è¯­æ³•çš„è§„åˆ™</h1><p><a href="http://eslint.cn/docs/rules/">List of available rules - ESLintä¸­æ–‡</a></p><h1 id="4-Eslint-é…ç½®"><a href="#4-Eslint-é…ç½®" class="headerlink" title="4 Eslint é…ç½®"></a>4 Eslint é…ç½®</h1><p><strong>1 å¯ä»¥é€šè¿‡vueè„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®æ—¶è‡ªåŠ¨ä¸‹è½½é…ç½®</strong></p><p><strong>2 é¡¹ç›®å·²ç»åˆ›å»ºå¥½ï¼Œæ‰‹åŠ¨ä¸‹è½½é…ç½®</strong></p><ul><li><p>å®‰è£…å¹¶åˆå§‹åŒ–é…ç½®æ–‡ä»¶</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">npm install eslint --save-dev   <span class="hljs-comment">// å®‰è£…å¹¶ä¿å­˜åˆ°é¡¹ç›®å¼€å‘ä¾èµ–</span><br>./node_modules/.bin/eslint -- --init <span class="hljs-comment">// åˆå§‹åŒ–å‘½ä»¤</span><br></code></pre></td></tr></table></figure></li><li><p>ESLint ä¼šè¯¢é—®ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ ¹æ®ä½ çš„å›ç­”ç”Ÿæˆå¯¹åº”çš„<code>.eslintrc.js</code>é…ç½®æ–‡ä»¶ã€‚<img src="https://tva1.sinaimg.cn/large/008vxvgGly1h8bjfywzaxj31k80iqgr7.jpg"></p></li></ul><h1 id="5-é…ç½®æ–‡ä»¶ä»‹ç»"><a href="#5-é…ç½®æ–‡ä»¶ä»‹ç»" class="headerlink" title="5 é…ç½®æ–‡ä»¶ä»‹ç»"></a>5 é…ç½®æ–‡ä»¶ä»‹ç»</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-string">&quot;env&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;browser&quot;</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-string">&quot;es6&quot;</span>: <span class="hljs-literal">true</span><br>    &#125;,<br>    <span class="hljs-string">&quot;extends&quot;</span>: <span class="hljs-string">&quot;standard&quot;</span>,<br>    <span class="hljs-string">&quot;globals&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;Atomics&quot;</span>: <span class="hljs-string">&quot;readonly&quot;</span>,<br>        <span class="hljs-string">&quot;SharedArrayBuffer&quot;</span>: <span class="hljs-string">&quot;readonly&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;parserOptions&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;ecmaVersion&quot;</span>: <span class="hljs-number">2018</span>,<br>        <span class="hljs-string">&quot;sourceType&quot;</span>: <span class="hljs-string">&quot;module&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;plugins&quot;</span>: [<br>        <span class="hljs-string">&quot;vue&quot;</span><br>    ],<br>    <span class="hljs-string">&quot;rules&quot;</span>: &#123;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="5-1-env"><a href="#5-1-env" class="headerlink" title="5.1 env"></a>5.1 env</h2><p>å‘Šè¯‰eslintï¼Œå½“å‰ä»£ç æ˜¯è¿è¡Œåœ¨å“ªäº›ç¯å¢ƒä¸­</p><ul><li><p>å¼€å‘ä¸­ç»å¸¸ä¼šç”¨åˆ° ä¸€äº›è¿è¡Œç¯å¢ƒè‡ªå¸¦çš„ apiï¼Œå¦‚ï¼š</p><ul><li><p>æµè§ˆå™¨ä¸­çš„ <strong>window&#x2F;document</strong> ç­‰</p></li><li><p>nodejsä¸­çš„ <strong>__dirname</strong> ç­‰</p></li></ul></li><li><p>å¦‚æœä¸æŒ‡å®šçš„è¯ï¼Œæ£€æŸ¥æ—¶å°±ä¼šæŠ¥é”™</p></li></ul><h2 id="5-2-extends"><a href="#5-2-extends" class="headerlink" title="5.2 extends"></a>5.2 extends</h2><p> ç›´æ¥ä½¿ç”¨åˆ«äººå·²ç»å†™å¥½çš„ lint è§„åˆ™ï¼Œæ–¹ä¾¿å¿«æ·ã€‚æ‰©å±•ä¸€èˆ¬æ”¯æŒä¸‰ç§ç±»å‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>  <span class="hljs-string">&quot;extends&quot;</span>: [<br>    <span class="hljs-string">&quot;eslint:recommended&quot;</span>,<br>    <span class="hljs-string">&quot;plugin:react/recommended&quot;</span>,<br>    <span class="hljs-string">&quot;eslint-config-standard&quot;</span>,<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ESLint å®˜æ–¹çš„æ‰©å±•:  ä¸€å…±æœ‰ä¸¤ä¸ªï¼š<code>eslint:recommended</code> ã€<code>eslint:all</code></li><li>æ’ä»¶ç±»å‹ã€‚</li><li>npm åŒ…çš„æ‰©å±•ã€‚å®˜æ–¹è§„å®š npm åŒ…çš„æ‰©å±•å¿…é¡»ä»¥ <code>eslint-config-</code> å¼€å¤´ï¼Œä½¿ç”¨æ—¶å¯ä»¥çœç•¥è¿™ä¸ªå¤´ï¼Œä¸Šé¢æ¡ˆä¾‹ä¸­ <code>eslint-config-standard</code> å¯ä»¥ç›´æ¥ç®€å†™æˆ <code>standard</code>ã€‚</li></ul><h2 id="5-3-globals"><a href="#5-3-globals" class="headerlink" title="5.3 globals"></a>5.3 globals</h2><p>åœ¨ ESLint ä¸­å®šä¹‰å…¨å±€å˜é‡</p><ul><li>å½“è®¿é—®å½“å‰æºæ–‡ä»¶å†…æœªå®šä¹‰çš„å˜é‡æ—¶ï¼Œ<a href="https://link.juejin.cn/?target=https://eslint.bootcss.com/docs/rules/no-undef">no-undef</a> è§„åˆ™å°†å‘å‡ºè­¦å‘Šã€‚</li><li>å¦‚æœä½ æƒ³åœ¨ä¸€ä¸ªæºæ–‡ä»¶é‡Œä½¿ç”¨å…¨å±€å˜é‡ï¼Œæ¨èä½ åœ¨ ESLint ä¸­å®šä¹‰è¿™äº›å…¨å±€å˜é‡ï¼Œè¿™æ · ESLint å°±ä¸ä¼šå‘å‡ºè­¦å‘Šäº†ã€‚</li></ul><h2 id="5-4-parserOptions"><a href="#5-4-parserOptions" class="headerlink" title="5.4  parserOptions"></a>5.4  parserOptions</h2><p>ESLint è§£æå™¨ è§£æä»£ç æ—¶ï¼Œå¯ä»¥æŒ‡å®š ç”¨å“ªä¸ª js çš„ç‰ˆæœ¬</p><ul><li>ecmaVersionï¼š <em>ä½ å¯ä»¥ä½¿ç”¨ 6ã€7ã€8ã€9 æˆ– 10 æ¥æŒ‡å®šä½ æƒ³è¦ä½¿ç”¨çš„ ECMAScript ç‰ˆæœ¬ã€‚ä½ ä¹Ÿå¯ä»¥ç”¨ä½¿ç”¨å¹´ä»½å‘½åçš„ç‰ˆæœ¬å·æŒ‡å®šä¸º 2015ï¼ˆåŒ 6ï¼‰ï¼Œ2016ï¼ˆåŒ 7ï¼‰ï¼Œæˆ– 2017ï¼ˆåŒ 8ï¼‰æˆ– 2018ï¼ˆåŒ 9ï¼‰æˆ– 2019 (same as 10)</em></li><li>sourceTypeï¼š sourceType æœ‰ä¸¤ä¸ªå€¼ï¼Œscript å’Œ moduleã€‚ å¯¹äº ES6+ çš„è¯­æ³•å’Œç”¨ import &#x2F; export çš„è¯­æ³•å¿…é¡»ç”¨ module.</li></ul><h2 id="5-5-plugins"><a href="#5-5-plugins" class="headerlink" title="5.5 plugins"></a>5.5 plugins</h2><p>è®¸å¤š ESLint æ’ä»¶ä¸ºä½¿ç”¨ç‰¹å®šçš„åº“å’Œæ¡†æ¶æä¾›äº†é¢å¤–çš„è§„åˆ™ã€‚</p><ul><li><p>å®˜æ–¹çš„è§„åˆ™åªèƒ½æ£€æŸ¥æ ‡å‡†çš„ JavaScript è¯­æ³•ï¼Œå¦‚æœä½ å†™çš„æ˜¯ JSX æˆ–è€… Vue å•æ–‡ä»¶ç»„ä»¶ï¼Œå°±éœ€è¦å®‰è£… ESLint çš„æ’ä»¶ï¼Œæ¥å®šåˆ¶ä¸€äº›ç‰¹å®šçš„è§„åˆ™è¿›è¡Œæ£€æŸ¥ã€‚</p></li><li><p>ESLint çš„æ’ä»¶ä¸æ‰©å±•ä¸€æ ·æœ‰å›ºå®šçš„å‘½åæ ¼å¼ï¼Œä»¥ <code>eslint-plugin-</code> å¼€å¤´ï¼Œä½¿ç”¨çš„æ—¶å€™ä¹Ÿå¯ä»¥çœç•¥è¿™ä¸ªå¤´ã€‚</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>  <span class="hljs-string">&quot;plugins&quot;</span>: [<br>    <span class="hljs-string">&quot;react&quot;</span>, <span class="hljs-comment">// eslint-plugin-react</span><br>    <span class="hljs-string">&quot;vue&quot;</span>,   <span class="hljs-comment">// eslint-plugin-vue</span><br>  ]<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ–è€…æ˜¯åœ¨æ‰©å±•ä¸­å¼•å…¥æ’ä»¶ï¼Œå‰é¢æœ‰æåˆ° <code>plugin:</code> å¼€å¤´çš„æ˜¯æ‰©å±•æ˜¯è¿›è¡Œæ’ä»¶çš„åŠ è½½ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>  <span class="hljs-string">&quot;extends&quot;</span>: [<br>    <span class="hljs-string">&quot;plugin:react/recommended&quot;</span>,<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="5-6-rules"><a href="#5-6-rules" class="headerlink" title="5.6 rules"></a>5.6 rules</h2><p>ESLint é™„å¸¦æœ‰<a href="https://link.zhihu.com/?target=https://cn.eslint.org/docs/rules/">å¤§é‡çš„è§„åˆ™</a>ï¼Œä½ å¯ä»¥åœ¨é…ç½®æ–‡ä»¶çš„ <code>rules</code> å±æ€§ä¸­é…ç½®ä½ æƒ³è¦çš„è§„åˆ™</p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯</tag>
      
      <tag>ä»£ç è§„èŒƒ</tag>
      
      <tag>eslint</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaæ³›å‹</title>
    <link href="/Java%E6%B3%9B%E5%9E%8B/"/>
    <url>/Java%E6%B3%9B%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æ³›å‹æ¦‚å¿µ"><a href="#1-æ³›å‹æ¦‚å¿µ" class="headerlink" title="1.æ³›å‹æ¦‚å¿µ"></a>1.æ³›å‹æ¦‚å¿µ</h1><h2 id="1-1-å®šä¹‰"><a href="#1-1-å®šä¹‰" class="headerlink" title="1.1 å®šä¹‰"></a>1.1 å®šä¹‰</h2><p>æ³›å‹æ˜¯JDK5ä¸­å¼•å…¥çš„ç‰¹æ€§ï¼Œå¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µçº¦æŸæ“ä½œçš„æ•°æ®ç±»å‹ï¼Œå¹¶è¿›è¡Œæ£€æŸ¥</p><ul><li>javaèŒƒå‹åœ¨ç”Ÿæˆå­—èŠ‚ç çš„æ—¶å€™ä¼šè¿›è¡Œæ“¦é™¤</li><li>èŒƒå‹æ ¼å¼ï¼š<code>&lt;æ•°æ®ç±»å‹&gt;</code></li><li>æ³¨æ„ï¼šæ³›å‹åªèƒ½æ”¯æŒå¼•ç”¨æ•°æ®ç±»å‹ï¼Œå› ä¸ºå®šä¹‰çš„èŒƒå‹ï¼Œå…¶å®åœ¨å­˜å…¥çš„æ—¶å€™è¿˜æ˜¯ä¼šå˜æˆObjectç±»å‹ï¼Œè€ŒåŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¸å¯ä»¥å˜æˆObjectç±»å‹</li><li>æŒ‡å®šèŒƒå‹ç±»å‹åï¼Œå¯ä»¥ä¼ å…¥è¯¥ç±»ç±»å‹åŠå…¶å­ç±»ç±»å‹</li></ul><h2 id="1-2-å¥½å¤„"><a href="#1-2-å¥½å¤„" class="headerlink" title="1.2 å¥½å¤„"></a>1.2 å¥½å¤„</h2><ul><li>ç»Ÿä¸€æ•°æ®ç±»å‹</li><li>è¿è¡Œæ—¶æœŸçš„é—®é¢˜ï¼Œæåˆ°äº†ç¼–è¯‘æœŸé—´ï¼Œé¿å…äº†å¼ºåˆ¶ç±»å‹è½¬æ¢å‡ºç°çš„å¼‚å¸¸ã€‚</li></ul><h1 id="2-ä½¿ç”¨åœºæ™¯"><a href="#2-ä½¿ç”¨åœºæ™¯" class="headerlink" title="2 ä½¿ç”¨åœºæ™¯"></a>2 ä½¿ç”¨åœºæ™¯</h1><h2 id="2-1-èŒƒå‹ç±»"><a href="#2-1-èŒƒå‹ç±»" class="headerlink" title="2.1 èŒƒå‹ç±»"></a>2.1 èŒƒå‹ç±»</h2><h3 id="2-1-å®šä¹‰"><a href="#2-1-å®šä¹‰" class="headerlink" title="2.1 å®šä¹‰"></a>2.1 å®šä¹‰</h3><p>å½“ç¼–å†™ä¸€ä¸ªç±»æ—¶ï¼Œå¦‚æœä¸ç¡®å®šç±»å‹ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±ç§°ä¸ºèŒƒå‹ç±»,.å¦‚ï¼š ArrayList</p><ul><li>åˆ›å»ºè¿™ä¸ªç±»çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç¡®å®šç±»å‹</li><li>è¿™é‡Œçš„ç±»å‹å¯ä»¥å®šä¹‰ä¸ºå˜é‡ï¼Œæ˜¯ç”¨æ¥è®°å½•æ•°æ®çš„ç±»å‹çš„ï¼Œå¯ä»¥å†™æˆTï¼ŒEï¼ŒK , Vï¼Œä¹Ÿå¯ä»¥å†™æˆå…¶ä»–å˜é‡</li></ul><h3 id="2-2-æ ¼å¼"><a href="#2-2-æ ¼å¼" class="headerlink" title="2.2 æ ¼å¼"></a>2.2 æ ¼å¼</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">ä¿®é¥°ç¬¦ <span class="hljs-keyword">class</span> ç±»å&lt;<span class="hljs-symbol">E</span>&gt;&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-3-ç¤ºä¾‹"><a href="#2-3-ç¤ºä¾‹" class="headerlink" title="2.3 ç¤ºä¾‹"></a>2.3 ç¤ºä¾‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyArray</span>&lt;<span class="hljs-title">E</span>&gt; </span>&#123;<br>  Object[] obj = <span class="hljs-keyword">new</span> Object[<span class="hljs-number">10</span>];<br>  <span class="hljs-keyword">int</span> size;<br><br>  <span class="hljs-comment">// Eè¡¨ç¤ºä¸ç¡®å®šçš„ç±»å‹ï¼Œè¯¥ç±»å‹åœ¨ç±»åé¢å®šä¹‰è¿‡äº†</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">add</span><span class="hljs-params">(E e)</span> </span>&#123;<br>    obj[size] = e;<br>    size++;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> (E) obj[index];<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>  MyArray&lt;String&gt; myArray = <span class="hljs-keyword">new</span> MyArray&lt;&gt;();<br>  myArray.add(<span class="hljs-string">&quot;q&quot;</span>);<br>  System.out.println(myArray.get(<span class="hljs-number">0</span>));<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-2-èŒƒå‹æ–¹æ³•"><a href="#2-2-èŒƒå‹æ–¹æ³•" class="headerlink" title="2.2 èŒƒå‹æ–¹æ³•"></a>2.2 èŒƒå‹æ–¹æ³•</h2><h3 id="2-2-1-ä½¿ç”¨ç±»å‹åé¢å®šä¹‰çš„ç±»å‹"><a href="#2-2-1-ä½¿ç”¨ç±»å‹åé¢å®šä¹‰çš„ç±»å‹" class="headerlink" title="2.2.1 ä½¿ç”¨ç±»å‹åé¢å®šä¹‰çš„ç±»å‹"></a>2.2.1 ä½¿ç”¨ç±»å‹åé¢å®šä¹‰çš„ç±»å‹</h3><ul><li><p>æ–¹æ³•ä¸­å½¢å‚ç±»å‹ä¸ç¡®å®šæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç±»å‹åé¢å®šä¹‰çš„ç±»å‹ã€‚</p></li><li><p>æ‰€æœ‰çš„æ–¹æ³•éƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªç±»å‹</p></li></ul><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyArray</span>&lt;<span class="hljs-title">E</span>&gt; </span>&#123;    <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> (E) obj[index];<br>   &#125;<br> &#125;<br></code></pre></td></tr></table></figure><h3 id="2-2-2-åœ¨æ–¹æ³•ä¸Šå®šä¹‰è‡ªå·±çš„ç±»å‹"><a href="#2-2-2-åœ¨æ–¹æ³•ä¸Šå®šä¹‰è‡ªå·±çš„ç±»å‹" class="headerlink" title="2.2.2 åœ¨æ–¹æ³•ä¸Šå®šä¹‰è‡ªå·±çš„ç±»å‹"></a>2.2.2 <strong>åœ¨æ–¹æ³•ä¸Šå®šä¹‰è‡ªå·±çš„ç±»å‹</strong></h3><p>åªèƒ½åœ¨æœ¬æ–¹æ³•ä¸­ä½¿ç”¨</p><h4 id="æ ¼å¼"><a href="#æ ¼å¼" class="headerlink" title="æ ¼å¼"></a>æ ¼å¼</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">ä¿®é¥°ç¬¦&lt;E&gt; è¿”å›å€¼ç±»å‹ æ–¹æ³•å(ç±»å‹ å˜é‡å)&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span>&lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">(T t)</span></span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-function">List&lt;T&gt; <span class="hljs-title">buildList</span><span class="hljs-params">(T... t)</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> Arrays.asList(t);<br>&#125;<br><br><span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-function">T <span class="hljs-title">getValue</span><span class="hljs-params">(T t)</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> t;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>  List&lt;Integer&gt; integers = buildList(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);<br>  System.out.println(integers);<br><br>  Integer value = getValue(<span class="hljs-number">1</span>);<br>  System.out.println(value);<br><br>  String str = getValue(<span class="hljs-string">&quot;111&quot;</span>);<br>  System.out.println(str);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-3-èŒƒå‹æ¥å£"><a href="#2-3-èŒƒå‹æ¥å£" class="headerlink" title="2.3 èŒƒå‹æ¥å£"></a>2.3 èŒƒå‹æ¥å£</h2><p>å½“ç¼–å†™ä¸€ä¸ªæ¥å£æ—¶ï¼Œå¦‚æœä¸ç¡®å®šç±»å‹ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±ç§°ä¸ºèŒƒå‹æ¥å£ï¼Œå¦‚ï¼š list</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">ä¿®é¥°ç¬¦ <span class="hljs-class"><span class="hljs-keyword">interface</span> æ¥å£å&lt;<span class="hljs-title">E</span>&gt;</span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">ä¿®é¥°ç¬¦ <span class="hljs-class"><span class="hljs-keyword">interface</span> æ¥å£å&lt;<span class="hljs-title">E</span>&gt;</span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-ä½¿ç”¨ä¸€ï¼š-å®ç°ç±»ç»™å‡ºå…·ä½“ç±»å‹"><a href="#1-ä½¿ç”¨ä¸€ï¼š-å®ç°ç±»ç»™å‡ºå…·ä½“ç±»å‹" class="headerlink" title="1 ä½¿ç”¨ä¸€ï¼š å®ç°ç±»ç»™å‡ºå…·ä½“ç±»å‹"></a>1 ä½¿ç”¨ä¸€ï¼š å®ç°ç±»ç»™å‡ºå…·ä½“ç±»å‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyList</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">List</span>&lt;<span class="hljs-title">String</span>&gt; </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">add</span><span class="hljs-params">(String s)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>  MyList list = <span class="hljs-keyword">new</span> MyList();<br>  list.add(<span class="hljs-string">&quot;string&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-ä½¿ç”¨äºŒï¼šå®ç°ç±»ç»§ç»­å»¶ç»­æ³›å‹ï¼Œåˆ›å»ºå¯¹è±¡æ—¶å†ç¡®å®š"><a href="#2-ä½¿ç”¨äºŒï¼šå®ç°ç±»ç»§ç»­å»¶ç»­æ³›å‹ï¼Œåˆ›å»ºå¯¹è±¡æ—¶å†ç¡®å®š" class="headerlink" title="2 ä½¿ç”¨äºŒï¼šå®ç°ç±»ç»§ç»­å»¶ç»­æ³›å‹ï¼Œåˆ›å»ºå¯¹è±¡æ—¶å†ç¡®å®š"></a>2 ä½¿ç”¨äºŒï¼šå®ç°ç±»ç»§ç»­å»¶ç»­æ³›å‹ï¼Œåˆ›å»ºå¯¹è±¡æ—¶å†ç¡®å®š</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyList2</span>&lt;<span class="hljs-title">E</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">List</span>&lt;<span class="hljs-title">E</span>&gt; </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">add</span><span class="hljs-params">(E e)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>  MyList2&lt;String&gt; list2 = <span class="hljs-keyword">new</span> MyList2();<br>  list2.add(<span class="hljs-string">&quot;string&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="3-æ³›å‹é€šé…ç¬¦"><a href="#3-æ³›å‹é€šé…ç¬¦" class="headerlink" title="3 æ³›å‹é€šé…ç¬¦"></a>3 æ³›å‹é€šé…ç¬¦</h1><ul><li><p><code>?</code>å¯ä»¥è¡¨ç¤ºä¸ç¡®å®šçš„ç±»å‹</p></li><li><p><code>? extends E</code>: è¡¨ç¤ºåªèƒ½ä¼ é€’Eæˆ–è€…Eçš„å­ç±»</p></li><li><p><code>? super E</code>: è¡¨ç¤ºåªèƒ½ä¼ é€’Eæˆ–è€…Eçš„çˆ¶ç±»</p></li></ul><h2 id="3-1-ç¤ºä¾‹"><a href="#3-1-ç¤ºä¾‹" class="headerlink" title="3.1 ç¤ºä¾‹"></a>3.1 ç¤ºä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Father</span> </span>&#123;<br>  <span class="hljs-keyword">public</span> String id;<br>  <span class="hljs-keyword">public</span> String name;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Father</span><span class="hljs-params">(String id, String name)</span> </span>&#123;<br>    <span class="hljs-keyword">this</span>.id = id;<br>    <span class="hljs-keyword">this</span>.name = name;<br>  &#125;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">study</span><span class="hljs-params">()</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;å­¦ä¹ çŠ¶æ€ä¸­------&quot;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Son</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Father</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Son</span><span class="hljs-params">(String id, String name)</span> </span>&#123;<br>    <span class="hljs-keyword">super</span>(id, name);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GrandSon</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Son</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">GrandSon</span><span class="hljs-params">(String id, String name)</span> </span>&#123;<br>    <span class="hljs-keyword">super</span>(id, name);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>? extends Son</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">study</span><span class="hljs-params">(List&lt;? extends Son&gt; array)</span> </span>&#123;<br>        array.forEach(Son::study);<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h80c7s1nt7j30p20cmgmq.jpg" style="zoom:50%;" /><ul><li>? extends Son</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">study</span><span class="hljs-params">(List&lt;? <span class="hljs-keyword">super</span> Son&gt; array)</span> </span>&#123;<br>  array.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h80cw8fu3wj30p00bumy2.jpg" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ³›å‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ES6è¯­æ³•å­¦ä¹ ç¬”è®°</title>
    <link href="/ES6%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/ES6%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Letå’Œconst"><a href="#1-Letå’Œconst" class="headerlink" title="1 Letå’Œconst"></a>1 Letå’Œconst</h1><ul><li>Let:  æ‰€å£°æ˜çš„å˜é‡ï¼Œåªåœ¨letå‘½ä»¤æ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆã€‚</li><li><code>const</code>å£°æ˜ä¸€ä¸ªåªè¯»çš„<code>å¸¸é‡</code>ã€‚ä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜ã€‚constä¸€æ—¦å£°æ˜å˜é‡ï¼Œå°±å¿…é¡»ç«‹å³<code>åˆå§‹åŒ–</code>ï¼Œä¸èƒ½ç•™åˆ°ä»¥åèµ‹å€¼ã€‚ç±»ä¼¼final</li></ul><h1 id="2-è§£æ„èµ‹å€¼"><a href="#2-è§£æ„èµ‹å€¼" class="headerlink" title="2 è§£æ„èµ‹å€¼"></a>2 è§£æ„èµ‹å€¼</h1><ul><li>ES6 å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»<strong>æ•°ç»„å’Œå¯¹è±¡</strong>ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸º<code>è§£æ„</code>ï¼ˆDestructuringï¼‰ã€‚</li><li>æœ¬è´¨ä¸Šï¼Œè¿™ç§å†™æ³•å±äº<code>â€œæ¨¡å¼åŒ¹é…â€</code>ï¼Œåªè¦ç­‰å·ä¸¤è¾¹çš„æ¨¡å¼ç›¸åŒï¼Œå·¦è¾¹çš„å˜é‡å°±ä¼šè¢«èµ‹äºˆå¯¹åº”çš„å€¼</li></ul><h2 id="2-1-æ•°ç»„çš„è§£æ„èµ‹å€¼"><a href="#2-1-æ•°ç»„çš„è§£æ„èµ‹å€¼" class="headerlink" title="2.1  æ•°ç»„çš„è§£æ„èµ‹å€¼"></a>2.1  æ•°ç»„çš„è§£æ„èµ‹å€¼</h2><ul><li><p>å¯ä»¥ä»æ•°ç»„ä¸­æå–å€¼ï¼ŒæŒ‰ç…§å¯¹åº”ä½ç½®ï¼Œå¯¹å˜é‡èµ‹å€¼ã€‚</p></li><li><p>æ•°ç»„çš„å…ƒç´ æ˜¯æŒ‰æ¬¡åºæ’åˆ—çš„ï¼Œå˜é‡çš„å–å€¼ç”±å®ƒçš„ä½ç½®å†³å®š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> [a, b, c] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br><br><span class="hljs-keyword">let</span> [ , , third] = [<span class="hljs-string">&quot;foo&quot;</span>, <span class="hljs-string">&quot;bar&quot;</span>, <span class="hljs-string">&quot;baz&quot;</span>];<br><br><span class="hljs-keyword">let</span> [head, ...tail] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];<br>head <span class="hljs-comment">// 1</span><br>tail <span class="hljs-comment">// [2, 3, 4]</span><br><br><span class="hljs-keyword">let</span> [x, y, ...z] = [<span class="hljs-string">&#x27;a&#x27;</span>];<br>x <span class="hljs-comment">// &quot;a&quot;</span><br>y <span class="hljs-comment">// undefined</span><br>z <span class="hljs-comment">// []</span><br><br><span class="hljs-keyword">let</span> [x, y, z] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])<br></code></pre></td></tr></table></figure></li><li><p>è§£æ„èµ‹å€¼<code>å…è®¸æŒ‡å®š</code>é»˜è®¤å€¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> [foo = <span class="hljs-literal">true</span>] = [];<br>foo <span class="hljs-comment">// true</span><br><span class="hljs-keyword">let</span> [x, y = <span class="hljs-string">&#x27;b&#x27;</span>] = [<span class="hljs-string">&#x27;a&#x27;</span>]; <span class="hljs-comment">// x=&#x27;a&#x27;, y=&#x27;b&#x27;</span><br><br><span class="hljs-comment">// åªæœ‰å½“ä¸€ä¸ªæ•°ç»„æˆå‘˜ä¸¥æ ¼ç­‰äºundefinedï¼Œé»˜è®¤å€¼æ‰ä¼šç”Ÿæ•ˆã€‚</span><br><span class="hljs-keyword">let</span> [x, y = <span class="hljs-string">&#x27;b&#x27;</span>] = [<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-literal">undefined</span>]; <span class="hljs-comment">// x=&#x27;a&#x27;, y=&#x27;b&#x27;</span><br><br><span class="hljs-keyword">let</span> [x = <span class="hljs-number">1</span>] = [<span class="hljs-literal">null</span>];<br>x <span class="hljs-comment">// null</span><br></code></pre></td></tr></table></figure><h2 id="2-2-å¯¹è±¡çš„è§£æ„èµ‹å€¼"><a href="#2-2-å¯¹è±¡çš„è§£æ„èµ‹å€¼" class="headerlink" title="2.2 å¯¹è±¡çš„è§£æ„èµ‹å€¼"></a>2.2 å¯¹è±¡çš„è§£æ„èµ‹å€¼</h2><ul><li>å¯¹è±¡çš„å±æ€§æ²¡æœ‰æ¬¡åºï¼Œ<code>å˜é‡</code>å¿…é¡»ä¸<code>å±æ€§</code>åŒåï¼Œæ‰èƒ½å–åˆ°æ­£ç¡®çš„å€¼ã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> &#123; foo, bar &#125; = &#123; <span class="hljs-attr">foo</span>: <span class="hljs-string">&#x27;aaa&#x27;</span>, <span class="hljs-attr">bar</span>: <span class="hljs-string">&#x27;bbb&#x27;</span> &#125;;<br>foo <span class="hljs-comment">// &quot;aaa&quot;</span><br>bar <span class="hljs-comment">// &quot;bbb&quot;</span><br><br><span class="hljs-keyword">let</span> &#123;foo&#125; = &#123;<span class="hljs-attr">bar</span>: <span class="hljs-string">&#x27;baz&#x27;</span>&#125;;<br>foo <span class="hljs-comment">// undefined</span><br><br><span class="hljs-keyword">const</span> &#123; log &#125; = <span class="hljs-built_in">console</span>;<br>log(<span class="hljs-string">&#x27;hello&#x27;</span>) <span class="hljs-comment">// hello</span><br></code></pre></td></tr></table></figure><p>å¦‚æœå˜é‡åä¸å±æ€§åä¸ä¸€è‡´ï¼Œå¿…é¡»å†™æˆä¸‹é¢è¿™æ ·ã€‚</p><p>fooæ˜¯åŒ¹é…çš„æ¨¡å¼ï¼Œbazæ‰æ˜¯å˜é‡ã€‚çœŸæ­£è¢«èµ‹å€¼çš„æ˜¯å˜é‡bazï¼Œè€Œä¸æ˜¯æ¨¡å¼fooã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> &#123; <span class="hljs-attr">foo</span>: baz &#125; = &#123; <span class="hljs-attr">foo</span>: <span class="hljs-string">&#x27;aaa&#x27;</span>, <span class="hljs-attr">bar</span>: <span class="hljs-string">&#x27;bbb&#x27;</span> &#125;;<br>baz <span class="hljs-comment">// &quot;aaa&quot;</span><br></code></pre></td></tr></table></figure></li><li><p>è§£æ„ä¹Ÿå¯ä»¥ç”¨äºåµŒå¥—ç»“æ„çš„å¯¹è±¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> obj = &#123;<br>  <span class="hljs-attr">p</span>: [<br>    <span class="hljs-string">&#x27;Hello&#x27;</span>,<br>    &#123; <span class="hljs-attr">y</span>: <span class="hljs-string">&#x27;World&#x27;</span> &#125;<br>  ]<br>&#125;;<br><span class="hljs-keyword">let</span> &#123; <span class="hljs-attr">p</span>: [x, &#123; y &#125;] &#125; = obj;<br>x <span class="hljs-comment">// &quot;Hello&quot;</span><br>y <span class="hljs-comment">// &quot;World&quot;</span><br></code></pre></td></tr></table></figure></li><li><p>å¯¹è±¡<code>çš„</code>è§£æ„<code>ä¹Ÿå¯ä»¥æŒ‡å®š</code>é»˜è®¤å€¼</p><ul><li>é»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯ï¼Œå¯¹è±¡çš„<code>å±æ€§å€¼</code>ä¸¥æ ¼ç­‰äº<code>undefined</code>ã€‚</li><li>nullä¸undefinedä¸ä¸¥æ ¼ç›¸ç­‰ï¼Œæ‰€ä»¥æ˜¯ä¸ªæœ‰æ•ˆçš„èµ‹å€¼ï¼Œå¯¼è‡´é»˜è®¤å€¼ä¸ä¼šç”Ÿæ•ˆã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> &#123;x, y = <span class="hljs-number">5</span>&#125; = &#123;<span class="hljs-attr">x</span>: <span class="hljs-number">1</span>&#125;;<br>x <span class="hljs-comment">// 1</span><br>y <span class="hljs-comment">// 5</span><br></code></pre></td></tr></table></figure></li></ul><h2 id="2-3-å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼"><a href="#2-3-å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼" class="headerlink" title="2.3 å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼"></a>2.3 å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼</h2><ul><li>å­—ç¬¦ä¸²è¢«è½¬æ¢æˆäº†ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> [a, b, c, d, e] = <span class="hljs-string">&#x27;hello&#x27;</span>;<br></code></pre></td></tr></table></figure><ul><li>ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<code>length</code>å±æ€§ï¼Œå› æ­¤è¿˜å¯ä»¥å¯¹è¿™ä¸ªå±æ€§è§£æ„èµ‹å€¼</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> &#123;<span class="hljs-attr">length</span> : len&#125; = <span class="hljs-string">&#x27;hello&#x27;</span>;<br>len <span class="hljs-comment">// 5</span><br></code></pre></td></tr></table></figure><h2 id="2-4-ç”¨é€”"><a href="#2-4-ç”¨é€”" class="headerlink" title="2.4 ç”¨é€”"></a>2.4 ç”¨é€”</h2><ol><li><strong>äº¤æ¢å˜é‡çš„å€¼</strong></li></ol><p>äº¤æ¢å˜é‡<code>x</code>å’Œ<code>y</code>çš„å€¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">[x, y] = [y, x];<br></code></pre></td></tr></table></figure><ol start="2"><li><p><strong>ä»å‡½æ•°è¿”å›å¤šä¸ªå€¼</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// è¿”å›ä¸€ä¸ªæ•°ç»„</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">example</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<br>&#125;<br><span class="hljs-keyword">let</span> [a, b, c] = example();<br><br><span class="hljs-comment">// è¿”å›ä¸€ä¸ªå¯¹è±¡</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">example</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> &#123;<br>    <span class="hljs-attr">foo</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">bar</span>: <span class="hljs-number">2</span><br>  &#125;;<br>&#125;<br><span class="hljs-keyword">let</span> &#123; foo, bar &#125; = example();<br></code></pre></td></tr></table></figure></li><li><p><strong>æå– JSON æ•°æ®</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> jsonData = &#123;<br>  <span class="hljs-attr">id</span>: <span class="hljs-number">42</span>,<br>  <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;OK&quot;</span>,<br>  <span class="hljs-attr">data</span>: [<span class="hljs-number">867</span>, <span class="hljs-number">5309</span>]<br>&#125;;<br><span class="hljs-keyword">let</span> &#123; id, status, <span class="hljs-attr">data</span>: number &#125; = jsonData;<br><span class="hljs-built_in">console</span>.log(id, status, number);<br><span class="hljs-comment">// 42, &quot;OK&quot;, [867, 5309]</span><br></code></pre></td></tr></table></figure></li><li><p><strong>éå† Map ç»“æ„</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> [key, value] <span class="hljs-keyword">of</span> map) &#123;<br>  <span class="hljs-built_in">console</span>.log(key + <span class="hljs-string">&quot; is &quot;</span> + value);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// è·å–é”®å</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> [key] <span class="hljs-keyword">of</span> map) &#123;<br>  <span class="hljs-comment">// ...</span><br>&#125;<br><span class="hljs-comment">// è·å–é”®å€¼</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> [,value] <span class="hljs-keyword">of</span> map) &#123;<br>  <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><strong>è¾“å…¥æ¨¡å—çš„æŒ‡å®šæ–¹æ³•</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; SourceMapConsumer, SourceNode &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;source-map&quot;</span>);<br></code></pre></td></tr></table></figure></li></ol><h1 id="3-å‡½æ•°çš„æ‰©å±•"><a href="#3-å‡½æ•°çš„æ‰©å±•" class="headerlink" title="3. å‡½æ•°çš„æ‰©å±•"></a>3. å‡½æ•°çš„æ‰©å±•</h1><h2 id="3-1-å‚æ•°è®¾ç½®é»˜è®¤å€¼"><a href="#3-1-å‚æ•°è®¾ç½®é»˜è®¤å€¼" class="headerlink" title="3.1 å‚æ•°è®¾ç½®é»˜è®¤å€¼"></a>3.1 å‚æ•°è®¾ç½®é»˜è®¤å€¼</h2><ul><li><p>ES6 å…è®¸ä¸ºå‡½æ•°çš„å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œå³ç›´æ¥å†™åœ¨å‚æ•°å®šä¹‰çš„åé¢ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params">x, y = <span class="hljs-string">&#x27;World&#x27;</span></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(x, y);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params">&#123;x, y = <span class="hljs-number">5</span>&#125;</span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(x, y);<br>&#125;<br>foo(&#123;&#125;) <span class="hljs-comment">// undefined 5</span><br>foo(&#123;<span class="hljs-attr">x</span>: <span class="hljs-number">1</span>&#125;) <span class="hljs-comment">// 1 5</span><br>foo(&#123;<span class="hljs-attr">x</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">2</span>&#125;) <span class="hljs-comment">// 1 2</span><br></code></pre></td></tr></table></figure></li><li><p>ç”±äºå¤§æ‹¬å·è¢«è§£é‡Šä¸ºä»£ç å—ï¼Œæ‰€ä»¥å¦‚æœç®­å¤´å‡½æ•°ç›´æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¿…é¡»åœ¨å¯¹è±¡å¤–é¢åŠ ä¸Šæ‹¬å·ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> getTempItem = <span class="hljs-function"><span class="hljs-params">id</span> =&gt;</span> (&#123; <span class="hljs-attr">id</span>: id, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Temp&quot;</span> &#125;);<br></code></pre></td></tr></table></figure></li><li><p>ES6 å¼•å…¥<code>rest å‚æ•°</code>ï¼ˆå½¢å¼ä¸º â€¦å˜é‡å ï¼‰ï¼Œç”¨äºè·å–å‡½æ•°çš„å¤šä½™å‚æ•°ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä½¿ç”¨ arguments å¯¹è±¡äº†ã€‚rest å‚æ•°æ­é…çš„å˜é‡æ˜¯ä¸€ä¸ª<code>æ•°ç»„</code>ï¼Œè¯¥å˜é‡å°†å¤šä½™çš„å‚æ•°æ”¾å…¥æ•°ç»„ä¸­ã€‚</p><p>âš ï¸ï¼š rest å‚æ•°ä¹‹åä¸èƒ½å†æœ‰å…¶ä»–å‚æ•°ï¼ˆå³åªèƒ½æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">...values</span>) </span>&#123;<br>  <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> val <span class="hljs-keyword">of</span> values) &#123;<br>    sum += val;<br>  &#125;<br>    <span class="hljs-keyword">return</span> sum;<br>&#125;<br><br><span class="hljs-comment">// åˆ©ç”¨ rest å‚æ•°ï¼Œå¯ä»¥å‘è¯¥å‡½æ•°ä¼ å…¥ä»»æ„æ•°ç›®çš„å‚æ•°ã€‚</span><br>add(<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>) <span class="hljs-comment">// 10</span><br></code></pre></td></tr></table></figure></li></ul><h1 id="4-æ•°ç»„çš„æ‰©å±•"><a href="#4-æ•°ç»„çš„æ‰©å±•" class="headerlink" title="4 æ•°ç»„çš„æ‰©å±•"></a>4 æ•°ç»„çš„æ‰©å±•</h1><p><code>æ‰©å±•è¿ç®—ç¬¦</code>ï¼ˆspreadï¼‰æ˜¯ä¸‰ä¸ªç‚¹ï¼ˆ â€¦ ï¼‰ã€‚å®ƒå¥½æ¯” rest å‚æ•°çš„é€†è¿ç®—ï¼Œå°†ä¸€ä¸ªæ•°ç»„è½¬ä¸ºç”¨é€—å·åˆ†éš”çš„å‚æ•°åºåˆ—ã€‚</p><p><strong>ä»»ä½•å®šä¹‰äº†éå†å™¨ï¼ˆIteratorï¼‰æ¥å£çš„å¯¹è±¡ï¼ˆå‚é˜… Iterator ä¸€ç« ï¼‰ï¼Œéƒ½å¯ä»¥ç”¨æ‰©å±•è¿ç®—ç¬¦è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">console</span>.log(...[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])<br><span class="hljs-comment">// 1 2 3</span><br></code></pre></td></tr></table></figure><p>ç”¨é€”ï¼š</p><ul><li><p>è¯¥è¿ç®—ç¬¦ä¸»è¦ç”¨äº<code>å‡½æ•°è°ƒç”¨</code>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">x, y</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> x + y;<br>&#125;<br><br><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">4</span>, <span class="hljs-number">38</span>];<br>add(...numbers) <span class="hljs-comment">// 42</span><br></code></pre></td></tr></table></figure></li><li><p>åº”ç”¨ Math.max æ–¹æ³•ï¼Œç®€åŒ–æ±‚å‡ºä¸€ä¸ªæ•°ç»„æœ€å¤§å…ƒç´ çš„å†™æ³•ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">Math</span>.max(...[<span class="hljs-number">14</span>, <span class="hljs-number">3</span>, <span class="hljs-number">77</span>])<br></code></pre></td></tr></table></figure></li><li><p>push å‡½æ•°ï¼Œå°†ä¸€ä¸ªæ•°ç»„æ·»åŠ åˆ°å¦ä¸€ä¸ªæ•°ç»„çš„å°¾éƒ¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> arr1 = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>];<br><span class="hljs-keyword">let</span> arr2 = [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br>arr1.push(...arr2);<br></code></pre></td></tr></table></figure></li><li><p>å¤åˆ¶æ•°ç»„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> a1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>];<br><span class="hljs-comment">// å†™æ³•ä¸€</span><br><span class="hljs-keyword">const</span> a2 = [...a1];<br><span class="hljs-comment">// å†™æ³•äºŒ</span><br><span class="hljs-keyword">const</span> [...a2] = a1;<br></code></pre></td></tr></table></figure></li><li><p><strong>åˆå¹¶æ•°ç»„</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> arr1 = [<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>];<br><span class="hljs-keyword">const</span> arr2 = [<span class="hljs-string">&#x27;c&#x27;</span>];<br><span class="hljs-keyword">const</span> arr3 = [<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>];<br>[...arr1, ...arr2, ...arr3]<br><span class="hljs-comment">// [ &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27; ]</span><br></code></pre></td></tr></table></figure></li><li><p><strong>ä¸è§£æ„èµ‹å€¼ç»“åˆ</strong>ï¼Œ<strong>ç”Ÿæˆæ•°ç»„</strong></p><p>å¦‚æœå°†æ‰©å±•è¿ç®—ç¬¦ç”¨äºæ•°ç»„èµ‹å€¼ï¼Œåªèƒ½æ”¾åœ¨å‚æ•°çš„æœ€åä¸€ä½ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> [first, ...rest] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br>first <span class="hljs-comment">// 1</span><br>rest  <span class="hljs-comment">// [2, 3, 4, 5]</span><br><br><span class="hljs-keyword">const</span> [first, ...rest] = [];<br>first <span class="hljs-comment">// undefined</span><br>rest  <span class="hljs-comment">// []</span><br><br><span class="hljs-keyword">const</span> [first, ...rest] = [<span class="hljs-string">&quot;foo&quot;</span>];<br>first  <span class="hljs-comment">// &quot;foo&quot;</span><br>rest   <span class="hljs-comment">// []</span><br></code></pre></td></tr></table></figure></li><li><p>å°†<code>å­—ç¬¦ä¸²</code>è½¬ä¸ºçœŸæ­£çš„<code>æ•°ç»„</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">[...<span class="hljs-string">&#x27;hello&#x27;</span>]<br><span class="hljs-comment">// [ &quot;h&quot;, &quot;e&quot;, &quot;l&quot;, &quot;l&quot;, &quot;o&quot; ]</span><br></code></pre></td></tr></table></figure></li><li><p>mapè·å–key</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([<br>  [<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;one&#x27;</span>],<br>  [<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;two&#x27;</span>],<br>  [<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;three&#x27;</span>],<br>]);<br><span class="hljs-keyword">let</span> arr = [...map.keys()]; <span class="hljs-comment">// [1, 2, 3]</span><br></code></pre></td></tr></table></figure></li></ul><h1 id="5-å¯¹è±¡çš„æ‰©å±•"><a href="#5-å¯¹è±¡çš„æ‰©å±•" class="headerlink" title="5 å¯¹è±¡çš„æ‰©å±•"></a>5 å¯¹è±¡çš„æ‰©å±•</h1><h2 id="5-1-å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•"><a href="#5-1-å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•" class="headerlink" title="5.1 å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•"></a>5.1 å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">x, y</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> &#123;x, y&#125;;<br>&#125;<br><br><span class="hljs-comment">// ç­‰åŒäº</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">x, y</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> &#123;<span class="hljs-attr">x</span>: x, <span class="hljs-attr">y</span>: y&#125;;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> Person = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;å¼ ä¸‰&#x27;</span>,<br>  <span class="hljs-comment">//ç­‰åŒäºbirth: birth</span><br>  birth,<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="5-2-æ—¥å¿—çš„æ‰“å°"><a href="#5-2-æ—¥å¿—çš„æ‰“å°" class="headerlink" title="5.2 æ—¥å¿—çš„æ‰“å°"></a>5.2 æ—¥å¿—çš„æ‰“å°</h2><p>è¾“å‡º user å’Œ foo ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œå°±æ˜¯ä¸¤ç»„é”®å€¼å¯¹ï¼Œå¯èƒ½ä¼šæ··æ·†ã€‚æŠŠå®ƒä»¬æ”¾åœ¨å¤§æ‹¬å·é‡Œé¢è¾“å‡ºï¼Œå°±å˜æˆäº†å¯¹è±¡çš„ç®€æ´è¡¨ç¤ºæ³•ï¼Œæ¯ç»„é”®å€¼å¯¹å‰é¢ä¼šæ‰“å°å¯¹è±¡åï¼Œè¿™æ ·å°±æ¯”è¾ƒæ¸…æ™°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> user = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;test&#x27;</span><br>&#125;;<br><span class="hljs-keyword">let</span> foo = &#123;<br>  <span class="hljs-attr">bar</span>: <span class="hljs-string">&#x27;baz&#x27;</span><br>&#125;;<br><br><span class="hljs-built_in">console</span>.log(user, foo)<br><span class="hljs-comment">// &#123;name: &quot;test&quot;&#125; &#123;bar: &quot;baz&quot;&#125;</span><br><span class="hljs-built_in">console</span>.log(&#123;user, foo&#125;)<br><span class="hljs-comment">// &#123;user: &#123;name: &quot;test&quot;&#125;, foo: &#123;bar: &quot;baz&quot;&#125;&#125;</span><br></code></pre></td></tr></table></figure><h2 id="5-3-è§£æ„èµ‹å€¼"><a href="#5-3-è§£æ„èµ‹å€¼" class="headerlink" title="5.3 è§£æ„èµ‹å€¼"></a>5.3 è§£æ„èµ‹å€¼</h2><ul><li><p>å¯¹è±¡çš„<code>è§£æ„èµ‹å€¼</code>ç”¨äºä»ä¸€ä¸ªå¯¹è±¡<code>å–å€¼</code>ï¼Œæ‰€æœ‰çš„é”®å’Œå®ƒä»¬çš„å€¼ï¼Œéƒ½ä¼šæ‹·è´åˆ°æ–°å¯¹è±¡ä¸Šé¢ã€‚</p></li><li><p>è§£æ„èµ‹å€¼è¦æ±‚ç­‰å·å³è¾¹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å¦‚æœç­‰å·å³è¾¹æ˜¯ undefined æˆ– null ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºå®ƒä»¬æ— æ³•è½¬ä¸ºå¯¹è±¡ã€‚</p></li><li><p>è§£æ„èµ‹å€¼å¿…é¡»æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p></li><li><p>è§£æ„èµ‹å€¼<code>çš„æ‹·è´æ˜¯</code>æµ…æ‹·è´</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> &#123; x, y, ...z &#125; = &#123; <span class="hljs-attr">x</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">a</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">4</span> &#125;;<br>x <span class="hljs-comment">// 1</span><br>y <span class="hljs-comment">// 2</span><br>z <span class="hljs-comment">// &#123; a: 3, b: 4 &#125;</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> z = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">4</span> &#125;;<br><span class="hljs-keyword">let</span> n = &#123; ...z &#125;;<br>n <span class="hljs-comment">// &#123; a: 3, b: 4 &#125;</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> foo = &#123; ...[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>] &#125;;<br>foo<br><span class="hljs-comment">// &#123;0: &quot;a&quot;, 1: &quot;b&quot;, 2: &quot;c&quot;&#125;</span><br></code></pre></td></tr></table></figure><ul><li>å¦‚æœæ‰©å±•è¿ç®—ç¬¦åé¢æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒä¼šè‡ªåŠ¨è½¬æˆä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;...<span class="hljs-string">&#x27;hello&#x27;</span>&#125;<br><span class="hljs-comment">// &#123;0: &quot;h&quot;, 1: &quot;e&quot;, 2: &quot;l&quot;, 3: &quot;l&quot;, 4: &quot;o&quot;&#125;</span><br></code></pre></td></tr></table></figure><h2 id="5-4-é“¾åˆ¤æ–­è¿ç®—ç¬¦"><a href="#5-4-é“¾åˆ¤æ–­è¿ç®—ç¬¦" class="headerlink" title="5.4 é“¾åˆ¤æ–­è¿ç®—ç¬¦"></a>5.4 é“¾åˆ¤æ–­è¿ç®—ç¬¦</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> firstName = message?.body?.user?.firstName || <span class="hljs-string">&#x27;default&#x27;</span>;<br></code></pre></td></tr></table></figure><p>?. è¿ç®—ç¬¦ï¼Œç›´æ¥åœ¨é“¾å¼è°ƒç”¨çš„æ—¶å€™åˆ¤æ–­ï¼Œå·¦ä¾§çš„å¯¹è±¡æ˜¯å¦ä¸º null æˆ– undefined ã€‚å¦‚æœæ˜¯çš„ï¼Œå°±ä¸å†å¾€ä¸‹è¿ç®—ï¼Œè€Œæ˜¯è¿”å› undefined </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js">a?.b<br><span class="hljs-comment">// ç­‰åŒäº</span><br>a == <span class="hljs-literal">null</span> ? <span class="hljs-literal">undefined</span> : a.b<br>a?.[x]<br><span class="hljs-comment">// ç­‰åŒäº</span><br>a == <span class="hljs-literal">null</span> ? <span class="hljs-literal">undefined</span> : a[x]<br>a?.b()<br><span class="hljs-comment">// ç­‰åŒäº</span><br>a == <span class="hljs-literal">null</span> ? <span class="hljs-literal">undefined</span> : a.b()<br>a?.()<br><span class="hljs-comment">// ç­‰åŒäº</span><br>a == <span class="hljs-literal">null</span> ? <span class="hljs-literal">undefined</span> : a()<br><br>è¡¨å•å¯èƒ½æ²¡æœ‰ checkValidity è¿™ä¸ªæ–¹æ³•ï¼Œè¿™æ—¶ ?. è¿ç®—ç¬¦å°±ä¼šè¿”å› <span class="hljs-literal">undefined</span> ï¼Œåˆ¤æ–­è¯­å¥å°±å˜æˆäº† <span class="hljs-literal">undefined</span> === <span class="hljs-literal">false</span> ï¼Œæ‰€ä»¥å°±ä¼šè·³è¿‡ä¸‹é¢çš„ä»£ç ã€‚<br><span class="hljs-keyword">if</span> (myForm.checkValidity?.() === <span class="hljs-literal">false</span>) &#123;<br>  <span class="hljs-comment">// è¡¨å•æ ¡éªŒå¤±è´¥</span><br>  <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="5-5-åˆ¤æ–­è¿ç®—ç¬¦"><a href="#5-5-åˆ¤æ–­è¿ç®—ç¬¦" class="headerlink" title="5.5   ?? åˆ¤æ–­è¿ç®—ç¬¦"></a>5.5   ?? åˆ¤æ–­è¿ç®—ç¬¦</h2><p> <code>||</code>: å·¦ä¾§çš„å€¼å¦‚æœä¸º nullï¼Œundefinedï¼Œç©ºå­—ç¬¦ä¸²ï¼Œ false ï¼Œ 0 ï¼Œé»˜è®¤å€¼ä¼šç”Ÿæ•ˆ</p><p><code>??</code>: å·¦ä¾§çš„å€¼ä¸º null æˆ– undefined æ—¶ï¼Œé»˜è®¤å€¼ä¼šç”Ÿæ•ˆ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> headerText = response.settings.headerText || <span class="hljs-string">&#x27;Hello, world!&#x27;</span>;<br><span class="hljs-keyword">const</span> headerText = response.settings.headerText ?? <span class="hljs-string">&#x27;Hello, world!&#x27;</span>;<br></code></pre></td></tr></table></figure><h1 id="6-å¯¹è±¡çš„æ–°å¢æ–¹æ³•"><a href="#6-å¯¹è±¡çš„æ–°å¢æ–¹æ³•" class="headerlink" title="6 å¯¹è±¡çš„æ–°å¢æ–¹æ³•"></a>6 å¯¹è±¡çš„æ–°å¢æ–¹æ³•</h1><h2 id="6-1-Object-is"><a href="#6-1-Object-is" class="headerlink" title="6.1 Object.is()"></a>6.1 Object.is()</h2><ul><li><p><code>ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦</code>ï¼ˆ &#x3D;&#x3D;&#x3D; ï¼‰ </p><ul><li>ç±»å‹ä¸åŒï¼Œç›´æ¥è¿”å›false</li><li>ä¸¤ä¸ªå¤åˆç±»å‹ï¼ˆå¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°ï¼‰çš„æ•°æ®æ¯”è¾ƒæ—¶ï¼Œä¸æ˜¯æ¯”è¾ƒå®ƒä»¬çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œè€Œæ˜¯æ¯”è¾ƒå®ƒä»¬æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚</li><li>åŒä¸€ç±»å‹çš„åŸå§‹ç±»å‹çš„å€¼ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼‰æ¯”è¾ƒæ—¶ï¼Œå€¼ç›¸åŒå°±è¿”å›trueï¼Œå€¼ä¸åŒå°±è¿”å›false</li><li>undefined å’Œ null ä¸è‡ªèº«ä¸¥æ ¼ç›¸ç­‰</li></ul></li><li><p><code>ç›¸ç­‰è¿ç®—ç¬¦</code>ï¼ˆ &#x3D;&#x3D; ï¼‰</p><ul><li>åœ¨æ¯”è¾ƒä¸åŒç±»å‹çš„æ•°æ®æ—¶ï¼Œç›¸ç­‰è¿ç®—ç¬¦ä¼šå…ˆå°†æ•°æ®è¿›è¡Œç±»å‹è½¬æ¢ï¼Œç„¶åå†ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦æ¯”è¾ƒ</li></ul></li><li><p>Object.is()</p><ul><li><p>å®ƒç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ä¸¥æ ¼ç›¸ç­‰ï¼Œä¸ä¸¥æ ¼æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ&#x3D;&#x3D;&#x3D;ï¼‰çš„è¡Œä¸ºåŸºæœ¬ä¸€è‡´ã€‚</p></li><li><p>ä¸åŒä¹‹å¤„åªæœ‰ä¸¤ä¸ªï¼šä¸€æ˜¯ +0 ä¸ç­‰äº -0 ï¼ŒäºŒæ˜¯ NaN ç­‰äºè‡ªèº«ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">Object</span>.is(+<span class="hljs-number">0</span>, -<span class="hljs-number">0</span>) <span class="hljs-comment">// false</span><br><span class="hljs-built_in">Object</span>.is(<span class="hljs-literal">NaN</span>, <span class="hljs-literal">NaN</span>) <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure></li></ul></li></ul><h2 id="6-2-Object-assign"><a href="#6-2-Object-assign" class="headerlink" title="6.2 Object.assign()"></a>6.2 Object.assign()</h2><p>Object.assignæ–¹æ³•ç”¨äºå¯¹è±¡çš„åˆå¹¶ï¼Œå°†æºå¯¹è±¡ï¼ˆsourceï¼‰çš„æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼Œå¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ï¼ˆtargetï¼‰</p><ul><li><code>Object.assign</code>æ–¹æ³•å®è¡Œçš„æ˜¯<code>æµ…æ‹·è´</code>ï¼Œ</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> target = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;;<br><span class="hljs-keyword">const</span> source1 = &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125;;<br><span class="hljs-keyword">const</span> source2 = &#123; <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> &#125;;<br><span class="hljs-built_in">Object</span>.assign(target, source1, source2);<br>target <span class="hljs-comment">// &#123;a:1, b:2, c:3&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>es6</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>bootstrapåŸºæœ¬æ ·å¼</title>
    <link href="/bootstrap%E5%9F%BA%E6%9C%AC%E6%A0%B7%E5%BC%8F/"/>
    <url>/bootstrap%E5%9F%BA%E6%9C%AC%E6%A0%B7%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="è¾¹æ¡†"><a href="#è¾¹æ¡†" class="headerlink" title="è¾¹æ¡†"></a>è¾¹æ¡†</h1><ul><li>class&#x3D;â€borderâ€  æ·»åŠ è¾¹æ¡†å±æ€§ï¼Œ</li><li>class&#x3D;â€border-topâ€ æ˜¾ç¤ºæŒ‡å®šè¾¹æ¡†ã€‚</li><li>class&#x3D;â€â€border-0â€ï¼šè¾¹æ¡†-åˆ é™¤</li><li>class&#x3D;â€border-top-0â€œï¼š åˆ é™¤æˆ–æ˜¾ç¤ºç‰¹å®šè¾¹æ¡†</li><li><code>.rounded</code>å…ƒç´ å¯ä»¥è½»æ¾çš„å®šä¹‰å››ä¸ªåœ†è§’çš„å­¤åº¦åŠæ˜¾ç¤ºæ•ˆæœ</li></ul><h1 id="æ–‡æœ¬é¢œè‰²"><a href="#æ–‡æœ¬é¢œè‰²" class="headerlink" title="æ–‡æœ¬é¢œè‰²"></a>æ–‡æœ¬é¢œè‰²</h1><ul><li>.text-danger</li><li>.text-secondary</li><li>.text-success</li></ul><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ku4yzhrwj305n05fjrb.jpg"></p><h1 id="Flexå¼¹æ€§å¸ƒå±€"><a href="#Flexå¼¹æ€§å¸ƒå±€" class="headerlink" title="Flexå¼¹æ€§å¸ƒå±€"></a>Flexå¼¹æ€§å¸ƒå±€</h1><ul><li><p><code>d-flex </code>å°† <strong>ç›´å±å†…éƒ¨å­å…ƒç´ </strong> è½¬æ¢ä¸ºflexå±æ€§</p></li><li><p><code>.flex-row</code> å¯è®¾ç½®å­å…ƒç´ æ°´å¹³æ–¹å‘æ’ç‰ˆå‘ˆç°ã€å•è¡Œã€‘</p></li><li><p><code>.flex-row-reverse</code> å¯å®ç°å…ƒç´ åœ¨æ°´å¹³ä¸Šä½œåæ–¹å‘æ’åˆ—, å³å¯¹é½</p></li><li><p><code>.flex-column</code> è®¾ç½®å‚ç›´æ–¹å‘å¸ƒå±€</p></li><li><p><code>.flex-column-reverse</code> å®ç°å‚ç›´æ–¹å‘çš„åè½¬å¸ƒå±€ï¼ˆä»åº•å‘ä¸Šé“ºå¼€ï¼‰</p></li><li><p><code>justify-content-*</code> é€šç”¨æ ·å¼å¯ä»¥æ”¹å˜flxé¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½ï¼Œé€‰æ–¹å‘ï¼ˆå€¼ï¼‰åŒ…æ‹¬ï¼š <code>start</code> (æµè§ˆå™¨é»˜è®¤å€¼),ã€<code>end</code>ã€ <code>center</code>ã€ <code>between</code>ã€ <code>around</code></p></li><li><p><code>.flex-fill</code>åœ¨ä¸€ç³»åˆ—å…„å¼Ÿå…ƒç´ ä¸Šä½¿ç”¨è¯¥ç±»æ¥å¼ºåˆ¶å®ƒä»¬å˜æˆç›¸ç­‰çš„å®½åº¦ï¼ŒåŒæ—¶å æ®æ‰€æœ‰å¯ç”¨çš„æ°´å¹³ç©ºé—´ã€‚<a href="https://getbootstrap.net/docs/4.1/components/navs/#working-with-flex-utilities">ç‰¹åˆ«é€‚ç”¨äºç­‰å®½æˆ–æ­£ç¡®çš„å¯¼èˆªã€‚</a></p></li><li><p>å‘å³æ¨ä¸¤ä¸ªé¡¹ç›®(<code>.mr-auto</code>)ã€å‘å·¦æ¨ä¸¤ä¸ªé¡¹ç›® (<code>.ml-auto</code>)ï¼Œ<strong>IE10å’ŒIE11ä¸èƒ½æ­£ç¡®æ”¯æŒåœ¨çˆ¶å±‚å…·æœ‰éé»˜è®¤çš„ <code>justify-content</code> å€¼è‡ªè¾¹è·æµ®åŠ¨auto margin</strong> </p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ksut55d5j30vj01m0sm.jpg"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;d-flex&quot;</span>&gt;<br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;mr-auto p-2&quot;</span>&gt;</span>Flex item<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;p-2&quot;</span>&gt;</span>Flex item<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;p-2&quot;</span>&gt;</span>Flex item<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/div&gt;<br></code></pre></td></tr></table></figure></li><li><p><code>order-*</code>æ’åºæ–¹æ³•çš„å“åº”å¼å±æ€§ï¼š</p></li><li><p><code>align-content</code> é€šç”¨æ ·å¼å®šä¹‰ï¼Œå¯ä»¥å°†flexç‰©ä»·äºæ¨ªè½´ä¸Š <em>ä¸€èµ·å¯¹é½</em>ï¼Œé€‚ç”¨äºå¤šè¡Œçš„Flexé¡¹ç›®</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring Data JPA ä½¿ç”¨JPQLå’ŒSQL</title>
    <link href="/Spring-Data-JPA-%E4%BD%BF%E7%94%A8JPQL%E5%92%8CSQL/"/>
    <url>/Spring-Data-JPA-%E4%BD%BF%E7%94%A8JPQL%E5%92%8CSQL/</url>
    
    <content type="html"><![CDATA[<h1 id="2-spring-Data-JPA-ä½¿ç”¨JPQL"><a href="#2-spring-Data-JPA-ä½¿ç”¨JPQL" class="headerlink" title="2 spring Data JPA ä½¿ç”¨JPQL"></a>2 spring Data JPA ä½¿ç”¨JPQL</h1><p>JPQLï¼ˆJava Presistence Query Language ï¼‰æ˜¯EJB3.0ä¸­çš„JPAé€ å‡ºæ¥çš„å¯¹è±¡æŸ¥è¯¢è¯­è¨€ã€‚JPQLæ˜¯å®Œå…¨é¢å‘å¯¹è±¡çš„ï¼Œå…·å¤‡ç»§æ‰¿ã€å¤šæ€å’Œå…³è”ç­‰ç‰¹æ€§ï¼Œå’Œhibernate HQLå¾ˆç›¸ä¼¼ã€‚</p><ul><li>Repository æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.pyr.repositories;<br><br><span class="hljs-keyword">import</span> org.pyr.entity.Customer;<br><span class="hljs-keyword">import</span> org.springframework.data.jpa.repository.Modifying;<br><span class="hljs-keyword">import</span> org.springframework.data.jpa.repository.Query;<br><span class="hljs-keyword">import</span> org.springframework.data.repository.PagingAndSortingRepository;<br><span class="hljs-keyword">import</span> org.springframework.data.repository.query.Param;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;<br><br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CustomerJPQLRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PagingAndSortingRepository</span>&lt;<span class="hljs-title">Customer</span>, <span class="hljs-title">Long</span>&gt; </span>&#123;<br><br>    <span class="hljs-meta">@Query(&quot;From Customer where custName = :custName&quot;)</span><br>    <span class="hljs-function">Customer <span class="hljs-title">findCustomerByCustName</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;custName&quot;)</span> String custName)</span></span>;<br><br>    <span class="hljs-meta">@Query(&quot;From Customer where custName = ?1&quot;)</span><br>    <span class="hljs-function">Customer <span class="hljs-title">findCustomerByCustName2</span><span class="hljs-params">(String custName)</span></span>;<br><br>    <span class="hljs-meta">@Transactional</span> <span class="hljs-comment">// é€šå¸¸åœ¨ä¸šåŠ¡é€»è¾‘ä¸­serviceå¢åŠ ï¼Œè€Œä¸æ˜¯è¿™é‡Œ</span><br>    <span class="hljs-meta">@Modifying</span><br>    <span class="hljs-meta">@Query(&quot;UPDATE Customer set custName = :custName where custId = :custId&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">updateCutomserNameById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;custName&quot;)</span> String custName, <span class="hljs-meta">@Param(&quot;custId&quot;)</span> <span class="hljs-keyword">long</span> custId)</span></span>;<br><br>    <span class="hljs-meta">@Transactional</span> <span class="hljs-comment">// é€šå¸¸åœ¨ä¸šåŠ¡é€»è¾‘ä¸­serviceå¢åŠ ï¼Œè€Œä¸æ˜¯è¿™é‡Œ</span><br>    <span class="hljs-meta">@Modifying</span><br>    <span class="hljs-meta">@Query(&quot;DELETE from Customer where custId = :custId&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">deleteCutomserById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;custId&quot;)</span> <span class="hljs-keyword">long</span> custId)</span></span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><ul><li>æµ‹è¯•æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.pyr;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<br><span class="hljs-keyword">import</span> org.pyr.config.JPAConfig;<br><span class="hljs-keyword">import</span> org.pyr.entity.Customer;<br><span class="hljs-keyword">import</span> org.pyr.repositories.CustomerJPQLRepository;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.test.context.ContextConfiguration;<br><span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;<br><br><span class="hljs-meta">@ContextConfiguration(classes = JPAConfig.class)</span><br><span class="hljs-meta">@RunWith(SpringJUnit4ClassRunner.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JPATest2</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    CustomerJPQLRepository customerJPQLRepository;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindByName</span><span class="hljs-params">()</span></span>&#123;<br>        Customer customer = customerJPQLRepository.findCustomerByCustName(<span class="hljs-string">&quot;å¾åº¶143&quot;</span>);<br>        System.out.println(customer);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindById</span><span class="hljs-params">()</span></span>&#123;<br>        Customer customer = customerJPQLRepository.findCustomerByCustName2(<span class="hljs-string">&quot;å¾åº¶143&quot;</span>);<br>        System.out.println(customer);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testUpdate</span><span class="hljs-params">()</span></span>&#123;<br>        customerJPQLRepository.updateCutomserNameById(<span class="hljs-string">&quot;lisa&quot;</span>, <span class="hljs-number">2L</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDelete</span><span class="hljs-params">()</span></span>&#123;<br>        customerJPQLRepository.deleteCutomserById(<span class="hljs-number">2L</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="3-spring-Data-JPA-ä½¿ç”¨SQL"><a href="#3-spring-Data-JPA-ä½¿ç”¨SQL" class="headerlink" title="3  spring Data JPA ä½¿ç”¨SQL"></a>3  spring Data JPA ä½¿ç”¨SQL</h1><ul><li>Repository æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Query(value = &quot;select * from cst_customer where cust_name = :custName&quot;, nativeQuery = true)</span><br><span class="hljs-function">Customer <span class="hljs-title">findCustomerByCustNameWithNative</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;custName&quot;)</span> String custName)</span></span>;<br></code></pre></td></tr></table></figure><ul><li>æµ‹è¯•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindCustomerByCustNameWithNative</span><span class="hljs-params">()</span></span>&#123;<br>    Customer customer = customerJPQLRepository.findCustomerByCustNameWithNative(<span class="hljs-string">&quot;aa&quot;</span>);<br>    System.out.println(customer);<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JPA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®åº“</tag>
      
      <tag>springData JPA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring Data JPA ä½¿ç”¨QueryDSL</title>
    <link href="/Spring-Data-JPA-%E4%BD%BF%E7%94%A8QueryDSL/"/>
    <url>/Spring-Data-JPA-%E4%BD%BF%E7%94%A8QueryDSL/</url>
    
    <content type="html"><![CDATA[<h1 id="1-QueryDSL-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-QueryDSL-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1 QueryDSL æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1 QueryDSL æ˜¯ä»€ä¹ˆï¼Ÿ</h1><ul><li><p>QueryDSLæ˜¯åŸºäºORMæ¡†æ¶æˆ–SQLå¹³å°ä¸Šçš„<strong>ä¸€ä¸ªé€šç”¨æŸ¥è¯¢æ¡†æ¶</strong>ã€‚å€ŸåŠ©QueryDSLå¯ä»¥åœ¨ä»»ä½•æ”¯æŒçš„ORMæ¡†æ¶æˆ–SQLå¹³å° <strong>ä¸Šä»¥é€šç”¨APIæ–¹å¼æ„å»ºæŸ¥è¯¢ã€‚</strong></p></li><li><p>JPAæ˜¯QueryDSLçš„ä¸»è¦é›†æˆæŠ€æœ¯ï¼Œæ˜¯JPQLå’ŒCriteriaæŸ¥è¯¢çš„ä»£æ›¿æ–¹æ³•ã€‚ç›®å‰QueryDSLæ”¯æŒçš„å¹³å°åŒ…æ‹¬ JPA,JDO,SQL,Mongodb ç­‰ç­‰</p></li><li><p>Querydslæ‰©å±•èƒ½è®©æˆ‘ä»¬ä»¥<strong>é“¾å¼æ–¹å¼ä»£ç ç¼–å†™æŸ¥è¯¢æ–¹æ³•</strong>ã€‚è¯¥æ‰©å±•éœ€è¦ä¸€ä¸ªæ¥å£QueryDslPredicateExecutorï¼Œå®ƒå®šä¹‰äº†å¾ˆå¤šæŸ¥è¯¢æ–¹æ³•ã€‚</p></li></ul><h1 id="2-Spring-Data-JPA-ä½¿ç”¨QueryDSL"><a href="#2-Spring-Data-JPA-ä½¿ç”¨QueryDSL" class="headerlink" title="2 Spring Data JPA ä½¿ç”¨QueryDSL"></a>2 Spring Data JPA ä½¿ç”¨QueryDSL</h1><h2 id="1-å¼•å…¥ä¾èµ–"><a href="#1-å¼•å…¥ä¾èµ–" class="headerlink" title="1. å¼•å…¥ä¾èµ–"></a>1. å¼•å…¥ä¾èµ–</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs java">    &lt;dependencies&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;<br>            &lt;artifactId&gt;spring-data-jpa&lt;/artifactId&gt;<br>        &lt;/dependency&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>            &lt;artifactId&gt;druid&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.8</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br>        &lt;!-- https:<span class="hljs-comment">//mvnrepository.com/artifact/com.querydsl/querydsl-jpa --&gt;</span><br>        &lt;dependency&gt;<br>            &lt;groupId&gt;com.querydsl&lt;/groupId&gt;<br>            &lt;artifactId&gt;querydsl-jpa&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">4.1</span><span class="hljs-number">.4</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;org.springframework&lt;/groupId&gt;<br>            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">5.3</span><span class="hljs-number">.19</span>&lt;/version&gt;<br>            &lt;scope&gt;test&lt;/scope&gt;<br>        &lt;/dependency&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;com.mysema.maven&lt;/groupId&gt;<br>            &lt;artifactId&gt;apt-maven-plugin&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">1.1</span><span class="hljs-number">.3</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;com.querydsl&lt;/groupId&gt;<br>            &lt;artifactId&gt;querydsl-apt&lt;/artifactId&gt;<br>            &lt;version&gt;<span class="hljs-number">4.2</span><span class="hljs-number">.1</span>&lt;/version&gt;<br>            &lt;scope&gt;provided&lt;/scope&gt;<br>        &lt;/dependency&gt;<br>    &lt;/dependencies&gt;<br>&lt;!--  Springä¸åŒæ¨¡å—æˆ–è€…ä¸å¤–éƒ¨è¿›è¡Œé›†æˆæ—¶ï¼Œä¾èµ–å¤„ç†å°±éœ€è¦å„è‡ªå¯¹åº”ç‰ˆæœ¬å·ã€‚BOMæ˜¯ç”±Mavenæä¾›çš„åŠŸèƒ½ï¼Œç”¨ä»¥ç»Ÿä¸€é—´æ¥æˆ–è€…ç›´æ¥ä¾èµ–çš„ç±»åº“ç‰ˆæœ¬--&gt;<br>&lt;!--    åœ¨mavençš„pom.xmlä¸­æ— éœ€æŒ‡å®šå…·ä½“çš„ç±»åº“ç‰ˆæœ¬ï¼Œç›´æ¥ä½¿ç”¨ï¼Œå³é»˜è®¤ä½¿ç”¨bomä¸­æŒ‡å®šçš„ç‰ˆæœ¬<br>&lt;dependencyManagement&gt;<br>        &lt;dependencies&gt;<br>            &lt;dependency&gt;<br>                &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;<br>                &lt;artifactId&gt;spring-data-bom&lt;/artifactId&gt;<br>                &lt;version&gt;<span class="hljs-number">2021.1</span><span class="hljs-number">.0</span>&lt;/version&gt;<br>                &lt;scope&gt;<span class="hljs-keyword">import</span>&lt;/scope&gt;<br>                &lt;type&gt;pom&lt;/type&gt;<br>            &lt;/dependency&gt;<br>        &lt;/dependencies&gt;<br>    &lt;/dependencyManagement&gt;<br>    &lt;build&gt;<br>        &lt;plugins&gt;<br>            &lt;!--è¯¥æ’ä»¶å¯ä»¥ç”Ÿæˆquerysdléœ€è¦çš„æŸ¥è¯¢å¯¹è±¡(å‘½åæ–¹å¼ä¸ºï¼š<span class="hljs-string">&quot;Q&quot;</span>+å¯¹åº”å®ä½“åï¼Œæ‰§è¡Œmvn compileå³å¯--&gt;<br>            &lt;plugin&gt;<br>                &lt;groupId&gt;com.mysema.maven&lt;/groupId&gt;<br>                &lt;artifactId&gt;apt-maven-plugin&lt;/artifactId&gt;<br>                &lt;executions&gt;<br>                    &lt;execution&gt;<br>                        &lt;goals&gt;<br>                            &lt;goal&gt;process&lt;/goal&gt;<br>                        &lt;/goals&gt;<br>                        &lt;configuration&gt;<br>                            &lt;outputDirectory&gt;target/generatedâ€sources/queries&lt;/outputDirectory&gt;<br>                            &lt;processor&gt;com.querydsl.apt.jpa.JPAAnnotationProcessor&lt;/processor&gt;<br>                            &lt;logOnlyOnError&gt;<span class="hljs-keyword">true</span>&lt;/logOnlyOnError&gt;<br>                        &lt;/configuration&gt;<br>                    &lt;/execution&gt;<br>                &lt;/executions&gt;<br>            &lt;/plugin&gt;<br>        &lt;/plugins&gt;<br>    &lt;/build&gt;<br></code></pre></td></tr></table></figure><h2 id="2-æ·»åŠ å®ä½“ç±»å’ŒJpaçš„é…ç½®"><a href="#2-æ·»åŠ å®ä½“ç±»å’ŒJpaçš„é…ç½®" class="headerlink" title="2 . æ·»åŠ å®ä½“ç±»å’ŒJpaçš„é…ç½®"></a>2 . æ·»åŠ å®ä½“ç±»å’ŒJpaçš„é…ç½®</h2><p>å‚è€ƒï¼š[Spring data JPAçš„CRUD - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)](<a href="https://pyr9.github.io/Spring">https://pyr9.github.io/Spring</a> data JPAçš„CRUD&#x2F;)</p><h2 id="3-ç¼–å†™Repository"><a href="#3-ç¼–å†™Repository" class="headerlink" title="3. ç¼–å†™Repository"></a>3. ç¼–å†™Repository</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.pyr.repositories;<br><br><span class="hljs-keyword">import</span> org.pyr.entity.Customer;<br><span class="hljs-keyword">import</span> org.springframework.data.querydsl.QuerydslPredicateExecutor;<br><span class="hljs-keyword">import</span> org.springframework.data.repository.CrudRepository;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CustomerRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CrudRepository</span>&lt;<span class="hljs-title">Customer</span>, <span class="hljs-title">Long</span>&gt; , <span class="hljs-title">QuerydslPredicateExecutor</span>&lt;<span class="hljs-title">Customer</span>&gt; </span>&#123;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4-ç¼–å†™æµ‹è¯•ç±»"><a href="#4-ç¼–å†™æµ‹è¯•ç±»" class="headerlink" title="4 ç¼–å†™æµ‹è¯•ç±»"></a>4 ç¼–å†™æµ‹è¯•ç±»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.pry;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<br><span class="hljs-keyword">import</span> org.pyr.config.JPAConfig;<br><span class="hljs-keyword">import</span> org.pyr.entity.Customer;<br><span class="hljs-keyword">import</span> org.pyr.entity.QCustomer;<br><span class="hljs-keyword">import</span> org.pyr.repositories.CustomerRepository;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.test.context.ContextConfiguration;<br><span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;<br><br><span class="hljs-meta">@ContextConfiguration(classes = JPAConfig.class)</span><br><span class="hljs-meta">@RunWith(SpringJUnit4ClassRunner.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QueryDslTest</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    CustomerRepository customerRepository;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindOne</span><span class="hljs-params">()</span> </span>&#123;<br>        QCustomer qCustomer = QCustomer.customer;<br>        Customer customer = customerRepository.findOne(<br>                qCustomer.custId.eq(<span class="hljs-number">4L</span>)<br>                        .and(qCustomer.custName.eq(<span class="hljs-string">&quot;aa&quot;</span>))<br>        ).orElse(<span class="hljs-keyword">null</span>);<br>        System.out.println(customer);<br>    &#125;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindAll</span><span class="hljs-params">()</span> </span>&#123;<br>        QCustomer qCustomer = QCustomer.customer;<br>        Iterable&lt;Customer&gt; customers = customerRepository.findAll(<br>                qCustomer.custId.in(<span class="hljs-number">4L</span>, <span class="hljs-number">5L</span>, <span class="hljs-number">6L</span>, <span class="hljs-number">7L</span>)<br>                        .and(qCustomer.custName.eq(<span class="hljs-string">&quot;aa&quot;</span>))<br>        );<br>        System.out.println(customers);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JPA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springdata jpa</tag>
      
      <tag>queryDSL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring data JPAçš„CRUD</title>
    <link href="/Spring%20data%20JPA%E7%9A%84CRUD/"/>
    <url>/Spring%20data%20JPA%E7%9A%84CRUD/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Spring-data-JPAçš„CRUD"><a href="#1-Spring-data-JPAçš„CRUD" class="headerlink" title="1 Spring data JPAçš„CRUD"></a>1 Spring data JPAçš„CRUD</h1><h2 id="1-1-å¼•å…¥ä¾èµ–"><a href="#1-1-å¼•å…¥ä¾èµ–" class="headerlink" title="1.1 å¼•å…¥ä¾èµ–"></a>1.1 å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs xml">dependencies&gt;<br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.data<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-data-jpa<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>druid<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.8<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.3.19<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.data<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-data-bom<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2021.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="1-2-é…ç½®spring-Data-JPA"><a href="#1-2-é…ç½®spring-Data-JPA" class="headerlink" title="1.2 é…ç½®spring Data JPA"></a>1.2 é…ç½®spring Data JPA</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.pyr.config;<br><br><span class="hljs-keyword">import</span> com.alibaba.druid.pool.DruidDataSource;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.data.jpa.repository.config.EnableJpaRepositories;<br><span class="hljs-keyword">import</span> org.springframework.orm.jpa.JpaTransactionManager;<br><span class="hljs-keyword">import</span> org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;<br><span class="hljs-keyword">import</span> org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;<br><span class="hljs-keyword">import</span> org.springframework.transaction.PlatformTransactionManager;<br><span class="hljs-keyword">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;<br><br><span class="hljs-keyword">import</span> javax.persistence.EntityManagerFactory;<br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableJpaRepositories(&quot;org.pyr.repositories&quot;)</span><br><span class="hljs-meta">@EnableTransactionManagement</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JPAConfig</span> </span>&#123;<br><br>  <span class="hljs-meta">@Bean</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> DataSource <span class="hljs-title">dataSource</span><span class="hljs-params">()</span> </span>&#123;<br>    DruidDataSource dataSource = <span class="hljs-keyword">new</span> DruidDataSource();<br>    dataSource.setUsername(<span class="hljs-string">&quot;root&quot;</span>);<br>    dataSource.setPassword(<span class="hljs-string">&quot;19980617pyr&quot;</span>);<br>    dataSource.setDriverClassName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br>    dataSource.setUrl(<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/springdata_jpa&quot;</span>);<br>    <span class="hljs-keyword">return</span> dataSource;<br>  &#125;<br><br>  <span class="hljs-meta">@Bean</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> LocalContainerEntityManagerFactoryBean <span class="hljs-title">entityManagerFactory</span><span class="hljs-params">()</span> </span>&#123;<br><br>    HibernateJpaVendorAdapter vendorAdapter = <span class="hljs-keyword">new</span> HibernateJpaVendorAdapter();<br>    vendorAdapter.setGenerateDdl(<span class="hljs-keyword">true</span>);<br><br>    LocalContainerEntityManagerFactoryBean factory = <span class="hljs-keyword">new</span> LocalContainerEntityManagerFactoryBean();<br>    factory.setJpaVendorAdapter(vendorAdapter);<br>    factory.setPackagesToScan(<span class="hljs-string">&quot;org.pyr.entity&quot;</span>);<br>    factory.setDataSource(dataSource());<br>    <span class="hljs-keyword">return</span> factory;<br>  &#125;<br><br>  <span class="hljs-meta">@Bean</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> PlatformTransactionManager <span class="hljs-title">transactionManager</span><span class="hljs-params">(EntityManagerFactory entityManagerFactory)</span> </span>&#123;<br><br>    JpaTransactionManager txManager = <span class="hljs-keyword">new</span> JpaTransactionManager();<br>    txManager.setEntityManagerFactory(entityManagerFactory);<br>    <span class="hljs-keyword">return</span> txManager;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="1-3-æ·»åŠ å®ä½“ç±»"><a href="#1-3-æ·»åŠ å®ä½“ç±»" class="headerlink" title="1.3 æ·»åŠ å®ä½“ç±»"></a>1.3 æ·»åŠ å®ä½“ç±»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.pyr.entity;<br><br><span class="hljs-keyword">import</span> javax.persistence.*;<br><br><span class="hljs-meta">@Entity</span><br><span class="hljs-meta">@Table(name = &quot;cst_customer&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span></span>&#123;<br><br>    <span class="hljs-meta">@Id</span> <span class="hljs-comment">//å£°æ˜ä¸»é”®çš„é…ç½®</span><br>    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span> <span class="hljs-comment">//:é…ç½®ä¸»é”®çš„ç”Ÿæˆç­–ç•¥: .IDENTITY ï¼šè‡ªå¢ï¼Œmysql</span><br>    <span class="hljs-meta">@Column(name = &quot;cust_id&quot;)</span> <span class="hljs-comment">// é…ç½®å±æ€§å’Œå­—æ®µçš„æ˜ å°„å…³ç³»  nameï¼šæ•°æ®åº“è¡¨ä¸­å­—æ®µçš„åç§°</span><br>    <span class="hljs-keyword">private</span> Long custId; <span class="hljs-comment">//å®¢æˆ·çš„ä¸»é”®</span><br><br>    <span class="hljs-meta">@Column(name = &quot;cust_name&quot;)</span><br>    <span class="hljs-keyword">private</span> String custName;<span class="hljs-comment">//å®¢æˆ·åç§°</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCustId</span><span class="hljs-params">(Long custId)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.custId = custId;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCustName</span><span class="hljs-params">(String custName)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.custName = custName;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Customer&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;custId=&quot;</span> + custId +<br>                <span class="hljs-string">&quot;, custName=&#x27;&quot;</span> + custName + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="1-4-ç¼–å†™Repository"><a href="#1-4-ç¼–å†™Repository" class="headerlink" title="1.4 ç¼–å†™Repository"></a>1.4 ç¼–å†™Repository</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.pyr.repositories;<br><br><span class="hljs-keyword">import</span> org.pyr.entity.Customer;<br><span class="hljs-keyword">import</span> org.springframework.data.repository.CrudRepository;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CustomerRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CrudRepository</span>&lt;<span class="hljs-title">Customer</span>, <span class="hljs-title">Long</span>&gt; </span>&#123;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="1-4-ç¼–å†™æµ‹è¯•ç±»"><a href="#1-4-ç¼–å†™æµ‹è¯•ç±»" class="headerlink" title="1.4 ç¼–å†™æµ‹è¯•ç±»"></a>1.4 ç¼–å†™æµ‹è¯•ç±»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.pyr;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<br><span class="hljs-keyword">import</span> org.pyr.config.JPAConfig;<br><span class="hljs-keyword">import</span> org.pyr.entity.Customer;<br><span class="hljs-keyword">import</span> org.pyr.repositories.CustomerRepository;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.test.context.ContextConfiguration;<br><span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;<br><br><span class="hljs-keyword">import</span> java.util.Optional;<br><br><span class="hljs-meta">@ContextConfiguration(classes = JPAConfig.class)</span><br><span class="hljs-meta">@RunWith(SpringJUnit4ClassRunner.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JPATest</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    CustomerRepository customerRepository;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFind</span><span class="hljs-params">()</span></span>&#123;<br>        Optional&lt;Customer&gt; customer = customerRepository.findById(<span class="hljs-number">3L</span>);<br>        System.out.println(customer.get());<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSave</span><span class="hljs-params">()</span></span>&#123;<br>        Customer customer = <span class="hljs-keyword">new</span> Customer();<br>        customer.setCustName(<span class="hljs-string">&quot;aa&quot;</span>);<br>        customerRepository.save(customer);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testUpdate</span><span class="hljs-params">()</span></span>&#123;<br>        Customer customer = <span class="hljs-keyword">new</span> Customer();<br>        customer.setCustId(<span class="hljs-number">3L</span>);<br>        customer.setCustName(<span class="hljs-string">&quot;aa123&quot;</span>);<br>        customerRepository.save(customer);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDelete</span><span class="hljs-params">()</span></span>&#123;<br>        Customer customer = <span class="hljs-keyword">new</span> Customer();<br>        customer.setCustId(<span class="hljs-number">3L</span>);<br>        customer.setCustName(<span class="hljs-string">&quot;aa123&quot;</span>);<br>        customerRepository.delete(customer);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JPA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®åº“</tag>
      
      <tag>springData JPA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸºäºJPAçš„æ•°æ®åº“æ“ä½œ</title>
    <link href="/%E5%9F%BA%E4%BA%8EJPA%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/"/>
    <url>/%E5%9F%BA%E4%BA%8EJPA%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<p>äº§ç”ŸåŸå› ï¼š<strong>å¦‚æœå•ç‹¬ä½¿ç”¨hibernateçš„APIæ¥è¿›è¡ŒæŒä¹…åŒ–æ“ä½œï¼Œåˆ™ä¸èƒ½éšæ„åˆ‡æ¢å…¶ä»–ORMæ¡†æ¶</strong></p><h1 id="1-æ“ä½œæ­¥éª¤"><a href="#1-æ“ä½œæ­¥éª¤" class="headerlink" title="1 æ“ä½œæ­¥éª¤"></a>1 æ“ä½œæ­¥éª¤</h1><h2 id="1-1-å¯¼å…¥ä¾èµ–"><a href="#1-1-å¯¼å…¥ä¾èµ–" class="headerlink" title="1.1 å¯¼å…¥ä¾èµ–"></a>1.1 å¯¼å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.29<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hibernate<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hibernate-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.6.8.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.13<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="1-2-æ·»åŠ META-INF-persistence-xml"><a href="#1-2-æ·»åŠ META-INF-persistence-xml" class="headerlink" title="1.2 æ·»åŠ META-INF\persistence.xml"></a>1.2 æ·»åŠ META-INF\persistence.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">persistence</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://java.sun.com/xml/ns/persistence&quot;</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;2.0&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--éœ€è¦é…ç½®persistenceâ€unitèŠ‚ç‚¹æŒä¹…åŒ–å•å…ƒï¼šnameï¼šæŒä¹…åŒ–å•å…ƒåç§°</span><br><span class="hljs-comment">    transactionâ€typeï¼šäº‹åŠ¡ç®¡ç†çš„æ–¹å¼ JTAï¼šåˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç† RESOURCE_LOCALï¼šæœ¬åœ°äº‹åŠ¡ç®¡ç†--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">persistence-unit</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hibernateJPA&quot;</span> <span class="hljs-attr">transaction-type</span>=<span class="hljs-string">&quot;RESOURCE_LOCAL&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--        jpaçš„å®ç°æ–¹å¼ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">provider</span>&gt;</span>org.hibernate.jpa.HibernatePersistenceProvider<span class="hljs-tag">&lt;/<span class="hljs-name">provider</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--            é…ç½®jpaå®ç°æ–¹çš„é…ç½®ä¿¡æ¯--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;javax.persistence.jdbc.url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/springdata_jpa&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;javax.persistence.jdbc.user&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;javax.persistence.jdbc.password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;19980617pyr&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;javax.persistence.jdbc.driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span><br>            <span class="hljs-comment">&lt;!--            é…ç½®jpaå®ç°æ–¹(hibernate)çš„é…ç½®ä¿¡æ¯--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hibernate.show_sql&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hibernate.format_sql&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hibernate.hbm2ddl.auto&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;update&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hibernate.dialect&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;org.hibernate.dialect.MySQL5InnoDBDialect&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">persistence-unit</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">persistence</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="1-3-å¢åŠ æµ‹è¯•å®ä½“ç±»"><a href="#1-3-å¢åŠ æµ‹è¯•å®ä½“ç±»" class="headerlink" title="1.3 å¢åŠ æµ‹è¯•å®ä½“ç±»"></a>1.3 å¢åŠ æµ‹è¯•å®ä½“ç±»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> entity;<br><br><span class="hljs-keyword">import</span> javax.persistence.*;<br><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-meta">@Entity</span><br><span class="hljs-meta">@Table(name = &quot;cst_customer&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span></span>&#123;<br><br>    <span class="hljs-meta">@Id</span> <span class="hljs-comment">//å£°æ˜ä¸»é”®çš„é…ç½®</span><br>    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span> <span class="hljs-comment">//:é…ç½®ä¸»é”®çš„ç”Ÿæˆç­–ç•¥: .IDENTITY ï¼šè‡ªå¢ï¼Œmysql</span><br>    <span class="hljs-meta">@Column(name = &quot;cust_id&quot;)</span> <span class="hljs-comment">// é…ç½®å±æ€§å’Œå­—æ®µçš„æ˜ å°„å…³ç³»  nameï¼šæ•°æ®åº“è¡¨ä¸­å­—æ®µçš„åç§°</span><br>    <span class="hljs-keyword">private</span> Long custId; <span class="hljs-comment">//å®¢æˆ·çš„ä¸»é”®</span><br><br>    <span class="hljs-meta">@Column(name = &quot;cust_name&quot;)</span><br>    <span class="hljs-keyword">private</span> String custName;<span class="hljs-comment">//å®¢æˆ·åç§°</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCustId</span><span class="hljs-params">(Long custId)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.custId = custId;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCustName</span><span class="hljs-params">(String custName)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.custName = custName;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Customer&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;custId=&quot;</span> + custId +<br>                <span class="hljs-string">&quot;, custName=&#x27;&quot;</span> + custName + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="1-4-æµ‹è¯•"><a href="#1-4-æµ‹è¯•" class="headerlink" title="1.4 æµ‹è¯•"></a>1.4 æµ‹è¯•</h2><p><strong>å‡†å¤‡å·¥ä½œ</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    EntityManager entityManager;<br><br>    <span class="hljs-meta">@Before</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;<br>        EntityManagerFactory entityManagerFactory = Persistence.createEntityManagerFactory(<span class="hljs-string">&quot;hibernateJPA&quot;</span>);<br>        entityManager = entityManagerFactory.createEntityManager();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Save"><a href="#Save" class="headerlink" title="Save"></a>Save</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@org</span>.junit.<span class="hljs-function">Test</span><br><span class="hljs-function">   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSave</span><span class="hljs-params">()</span> </span>&#123;<br>       EntityTransaction transaction = entityManager.getTransaction();<br>       transaction.begin();<br><br>       Customer customer = <span class="hljs-keyword">new</span> Customer();<br>       customer.setCustName(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>);<br>       entityManager.persist(customer);<br><br>       transaction.commit();<br>       entityManager.close();<br>   &#125;<br></code></pre></td></tr></table></figure><h3 id="Delete"><a href="#Delete" class="headerlink" title="Delete"></a>Delete</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">    <span class="hljs-meta">@org</span>.junit.<span class="hljs-function">Test</span><br><span class="hljs-function">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testRemove</span><span class="hljs-params">()</span> </span>&#123;<br>        EntityTransaction transaction = entityManager.getTransaction();<br>        transaction.begin();<br><span class="hljs-comment">//        Customer customer =new Customer();</span><br><span class="hljs-comment">//        customer.setCustId(3L);</span><br>        Customer customer = entityManager.find(Customer.class, <span class="hljs-number">3L</span>);<br>        entityManager.remove(customer);<br>        transaction.commit();<br>        entityManager.close();<br>    &#125;<br></code></pre></td></tr></table></figure><p>âš ï¸ï¼šè¿™é‡Œè¦åˆ é™¤çš„å¯¹è±¡éœ€è¦æ˜¯æ•°æ®åº“é‡ŒæŸ¥è¯¢åˆ°çš„ï¼Œå’ŒentityManagerå‘ç”Ÿè¿‡å…³è”çš„å¯¹è±¡ï¼Œå³æŒä¹…çŠ¶æ€ã€‚æˆ–è€…ä½¿ç”¨HQLã€‚newå‡ºæ¥çš„å¯¹è±¡æ— æ³•å®Œæˆåˆ é™¤é€»è¾‘ã€‚</p><h3 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@org</span>.junit.<span class="hljs-function">Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testUpdate</span><span class="hljs-params">()</span> </span>&#123;<br>    EntityTransaction transaction = entityManager.getTransaction();<br>    transaction.begin();<br><br>    Customer customer = <span class="hljs-keyword">new</span> Customer();<br>    customer.setCustName(<span class="hljs-string">&quot;å¼ ä¸‰123&quot;</span>);<br>    customer.setCustId(<span class="hljs-number">3L</span>);<br>    <span class="hljs-comment">// æŒ‡å®šidå³æ›´æ–°ï¼Œæ²¡æœ‰idå°±æ–°å¢</span><br>    Customer rs = entityManager.merge(customer);<br>    System.out.println(rs);<br>    transaction.commit();<br>    entityManager.close();<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>HQLUpdate</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@org</span>.junit.<span class="hljs-function">Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testHQLUpdate</span><span class="hljs-params">()</span> </span>&#123;<br>    EntityTransaction transaction = entityManager.getTransaction();<br>    transaction.begin();<br><br>    String sqlQuery = <span class="hljs-string">&quot;update Customer set custName=:name where custId=:id&quot;</span>;<br>    entityManager.createQuery(sqlQuery)<br>            .setParameter(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;å¾åº¶143&quot;</span>)<br>            .setParameter(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-number">2L</span>)<br>            .executeUpdate();<br><br>    transaction.commit();<br>    entityManager.close();<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>SqlæŸ¥è¯¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@org</span>.junit.<span class="hljs-function">Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSQLUpdate</span><span class="hljs-params">()</span> </span>&#123;<br>    EntityTransaction transaction = entityManager.getTransaction();<br>    transaction.begin();<br><br>    String sqlQuery = <span class="hljs-string">&quot;update cst_customer set cust_id=:name where cust_name=:id&quot;</span>;<br>    entityManager.createNativeQuery(sqlQuery)<br>            .setParameter(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;å¾åº¶123&quot;</span>)<br>            .setParameter(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-number">2L</span>)<br>            .executeUpdate();<br><br>    transaction.commit();<br>    entityManager.close();<br>&#125;<br></code></pre></td></tr></table></figure><p>âš ï¸ï¼šè¿™é‡Œä½¿ç”¨createNativeQueryï¼Œè¡¨æ˜å’Œå­—æ®µåéƒ½æ¢æˆå°å†™</p><h3 id="Select"><a href="#Select" class="headerlink" title="Select"></a>Select</h3><ul><li>ç«‹å³æŸ¥è¯¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@org</span>.junit.<span class="hljs-function">Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFind</span><span class="hljs-params">()</span> </span>&#123;<br>    EntityTransaction transaction = entityManager.getTransaction();<br>    transaction.begin();<br><br>    Customer rs = entityManager.find(Customer.class, <span class="hljs-number">3L</span>);<br>    System.out.println(<span class="hljs-string">&quot;========================&quot;</span>);<br>    System.out.println(rs);<br>    transaction.commit();<br>    entityManager.close();<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æ‡’åŠ è½½æŸ¥è¯¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@org</span>.junit.<span class="hljs-function">Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testLazyFind</span><span class="hljs-params">()</span> </span>&#123;<br>    EntityTransaction transaction = entityManager.getTransaction();<br>    transaction.begin();<br><br>    Customer rs = entityManager.getReference(Customer.class, <span class="hljs-number">3L</span>);<br>    System.out.println(<span class="hljs-string">&quot;========================&quot;</span>);<br>    System.out.println(rs);<br>    transaction.commit();<br>    entityManager.close();<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>HQLæŸ¥è¯¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@org</span>.junit.<span class="hljs-function">Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testHQLSelect</span><span class="hljs-params">()</span> </span>&#123;<br>    EntityTransaction transaction = entityManager.getTransaction();<br>    transaction.begin();<br><br>    String sqlQuery = <span class="hljs-string">&quot;select c from Customer c&quot;</span>;<br>    Query query = entityManager.createQuery(sqlQuery);<br>    List&lt;Customer&gt; resultList = query.getResultList();<br>    resultList.forEach(System.out::println);<br><br>    transaction.commit();<br>    entityManager.close();<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JPA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®åº“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸºäºHibernateæ•°æ®åº“æ“ä½œ</title>
    <link href="/%E5%9F%BA%E4%BA%8EHibernate%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/"/>
    <url>/%E5%9F%BA%E4%BA%8EHibernate%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h1 id="1-åŸºäºHibernateæ•°æ®åº“æ“ä½œ"><a href="#1-åŸºäºHibernateæ•°æ®åº“æ“ä½œ" class="headerlink" title="1 åŸºäºHibernateæ•°æ®åº“æ“ä½œ"></a>1 åŸºäºHibernateæ•°æ®åº“æ“ä½œ</h1><h2 id="1-1-æ“ä½œæ­¥éª¤"><a href="#1-1-æ“ä½œæ­¥éª¤" class="headerlink" title="1.1 æ“ä½œæ­¥éª¤"></a>1.1 æ“ä½œæ­¥éª¤</h2><h3 id="1-1-1-å¯¼å…¥ä¾èµ–"><a href="#1-1-1-å¯¼å…¥ä¾èµ–" class="headerlink" title="1.1.1 å¯¼å…¥ä¾èµ–"></a>1.1.1 å¯¼å…¥ä¾èµ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>    &lt;groupId&gt;mysql&lt;/groupId&gt;<br>    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">8.0</span><span class="hljs-number">.29</span>&lt;/version&gt;<br>    &lt;scope&gt;test&lt;/scope&gt;<br>&lt;/dependency&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;<br>    &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">5.6</span><span class="hljs-number">.8</span>.Final&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><h3 id="1-1-2-å¢åŠ å®ä½“ç±»"><a href="#1-1-2-å¢åŠ å®ä½“ç±»" class="headerlink" title="1.1.2 å¢åŠ å®ä½“ç±»"></a>1.1.2 å¢åŠ å®ä½“ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> tt.pyr.entity;<br><br><span class="hljs-keyword">import</span> javax.persistence.*;<br><br><span class="hljs-meta">@Entity</span><br><span class="hljs-meta">@Table(name = &quot;cst_customer&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span> </span>&#123;<br><br>    <span class="hljs-meta">@Id</span> <span class="hljs-comment">//å£°æ˜ä¸»é”®çš„é…ç½®</span><br>    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span> <span class="hljs-comment">//:é…ç½®ä¸»é”®çš„ç”Ÿæˆç­–ç•¥: .IDENTITY ï¼šè‡ªå¢ï¼Œmysql</span><br>    <span class="hljs-meta">@Column(name = &quot;cust_id&quot;)</span> <span class="hljs-comment">// é…ç½®å±æ€§å’Œå­—æ®µçš„æ˜ å°„å…³ç³»  nameï¼šæ•°æ®åº“è¡¨ä¸­å­—æ®µçš„åç§°</span><br>    <span class="hljs-keyword">private</span> Long custId; <span class="hljs-comment">//å®¢æˆ·çš„ä¸»é”®</span><br><br>    <span class="hljs-meta">@Column(name = &quot;cust_name&quot;)</span><br>    <span class="hljs-keyword">private</span> String custName;<span class="hljs-comment">//å®¢æˆ·åç§°</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCustId</span><span class="hljs-params">(Long custId)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.custId = custId;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCustName</span><span class="hljs-params">(String custName)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.custName = custName;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-1-3-é…ç½®hibernate-cfg-xml"><a href="#1-1-3-é…ç½®hibernate-cfg-xml" class="headerlink" title="1.1.3 é…ç½®hibernate.cfg.xml"></a>1.1.3 é…ç½®<strong>hibernate.cfg.xml</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;?xml version = <span class="hljs-string">&quot;1.0&quot;</span> encoding = <span class="hljs-string">&quot;utf-8&quot;</span>?&gt;<br>&lt;!DOCTYPE hibernate-configuration PUBLIC<br>        <span class="hljs-string">&quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot;</span><br>        <span class="hljs-string">&quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;</span>&gt;<br>&lt;hibernate-configuration&gt;<br>    &lt;session-factory&gt;<br>        &lt;property name=<span class="hljs-string">&quot;hibernate.connection.url&quot;</span>&gt;jdbc:mysql:<span class="hljs-comment">//localhost:3306/springdata_jpa&lt;/property&gt;</span><br>        &lt;property name=<span class="hljs-string">&quot;hibernate.connection.username&quot;</span>&gt;root&lt;/property&gt;<br>        &lt;property name=<span class="hljs-string">&quot;hibernate.connection.password&quot;</span>&gt;19980617pyr&lt;/property&gt;<br>        &lt;property name=<span class="hljs-string">&quot;hibernate.connection.driver_class&quot;</span>&gt;com.mysql.cj.jdbc.Driver&lt;/property&gt;<br>        &lt;property name=<span class="hljs-string">&quot;hibernate.show_sql&quot;</span>&gt;<span class="hljs-keyword">true</span>&lt;/property&gt;<br>        &lt;property name=<span class="hljs-string">&quot;format_sql&quot;</span>&gt;<span class="hljs-keyword">true</span>&lt;/property&gt;<br>        &lt;property name=<span class="hljs-string">&quot;hbm2ddl.auto&quot;</span>&gt;update&lt;/property&gt;<br>        &lt;mapping <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;tt.pyr.entity.Customer&quot;</span>&gt;&lt;/mapping&gt;<br>    &lt;/session-factory&gt;<br>&lt;/hibernate-configuration&gt;<br><br></code></pre></td></tr></table></figure><h3 id="1-1-4-ç¼–å†™æµ‹è¯•ç”¨ä¾‹"><a href="#1-1-4-ç¼–å†™æµ‹è¯•ç”¨ä¾‹" class="headerlink" title="1.1.4 ç¼–å†™æµ‹è¯•ç”¨ä¾‹"></a>1.1.4 ç¼–å†™æµ‹è¯•ç”¨ä¾‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> test;<br><br><span class="hljs-keyword">import</span> org.hibernate.Session;<br><span class="hljs-keyword">import</span> org.hibernate.SessionFactory;<br><span class="hljs-keyword">import</span> org.hibernate.Transaction;<br><span class="hljs-keyword">import</span> org.hibernate.boot.MetadataSources;<br><span class="hljs-keyword">import</span> org.hibernate.boot.registry.StandardServiceRegistry;<br><span class="hljs-keyword">import</span> org.hibernate.boot.registry.StandardServiceRegistryBuilder;<br><span class="hljs-keyword">import</span> org.junit.Before;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> tt.pyr.entity.Customer;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HibernateTest</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> SessionFactory sf;<br><br>    <span class="hljs-meta">@Before</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;<br>        StandardServiceRegistry registry = <span class="hljs-keyword">new</span> StandardServiceRegistryBuilder().configure(<span class="hljs-string">&quot;/hibernate.cfg.xml&quot;</span>).build();<br>        <span class="hljs-comment">//2. æ ¹æ®æœåŠ¡æ³¨å†Œç±»åˆ›å»ºä¸€ä¸ªå…ƒæ•°æ®èµ„æºé›†ï¼ŒåŒæ—¶æ„å»ºå…ƒæ•°æ®å¹¶ç”Ÿæˆåº”ç”¨ä¸€èˆ¬å”¯ä¸€çš„çš„sessionå·¥å‚</span><br>        sf = <span class="hljs-keyword">new</span> MetadataSources(registry).buildMetadata().buildSessionFactory();<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testInsert</span><span class="hljs-params">()</span> </span>&#123;<br>        Session sess = sf.openSession();<br>        Transaction tx = sess.beginTransaction();<br>        Customer customer = <span class="hljs-keyword">new</span> Customer();<br>        customer.setCustName(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>);<br>        sess.save(customer);<br>        tx.commit();<br>        sess.close();<br>        sf.close();<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSaveOrUpdate</span><span class="hljs-params">()</span> </span>&#123;<br>        Session sess = sf.openSession();<br>        Transaction tx = sess.beginTransaction();<br>        Customer customer = <span class="hljs-keyword">new</span> Customer();<br>        customer.setCustName(<span class="hljs-string">&quot;é‡Œæ–¯&quot;</span>);<br>        sess.saveOrUpdate(customer);<br>        tx.commit();<br>        sess.close();<br>        sf.close();<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testRemove</span><span class="hljs-params">()</span> </span>&#123;<br>        Session sess = sf.openSession();<br>        Transaction tx = sess.beginTransaction();<br>        Customer customer = <span class="hljs-keyword">new</span> Customer();<br>        customer.setCustId(<span class="hljs-number">1L</span>);<br>        sess.remove(customer);<br>        tx.commit();<br>        sess.close();<br>        sf.close();<br>    &#125;<br>  <br>      <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testHQL</span><span class="hljs-params">()</span> </span>&#123;<br>        Session sess = sf.openSession();<br>        Transaction tx = sess.beginTransaction();<br><br>        String sql = <span class="hljs-string">&quot;Update Customer set custName=:custName where custId=:id&quot;</span>;<br>        sess.createQuery(sql).setParameter(<span class="hljs-string">&quot;custName&quot;</span>, <span class="hljs-string">&quot;å¾åº¶&quot;</span>).setParameter(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-number">2L</span>).executeUpdate();<br>        tx.commit();<br>        sess.close();<br>        sf.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="1-2-HQL"><a href="#1-2-HQL" class="headerlink" title="1.2 HQL"></a>1.2 HQL</h2><h3 id="1-2-1-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-2-1-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.2.1 æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.2.1 æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li>HQLæ˜¯Hibernate Query Languageï¼ˆHibernate æŸ¥è¯¢è¯­è¨€ï¼‰çš„ç¼©å†™ï¼Œæä¾›æ›´åŠ ä¸°å¯Œçµæ´»ã€æ›´ä¸ºå¼ºå¤§çš„æŸ¥è¯¢èƒ½åŠ›ï¼›HQLæ›´æ¥è¿‘SQLè¯­å¥æŸ¥è¯¢è¯­æ³•ã€‚</li><li>HibernateæŸ¥è¯¢è¯­è¨€(HQL)ä¸SQL(ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€)ç›¸åŒï¼Œä½†ä¸ä¾èµ–äºæ•°æ®åº“è¡¨ã€‚ æˆ‘ä»¬åœ¨HQLä¸­ä½¿ç”¨ç±»åï¼Œè€Œä¸æ˜¯è¡¨å,å®ƒæ˜¯æ•°æ®åº“ç‹¬ç«‹çš„æŸ¥è¯¢è¯­è¨€ã€‚</li></ul><h3 id="1-1-2-HQLæŸ¥è¯¢çš„æ­¥éª¤"><a href="#1-1-2-HQLæŸ¥è¯¢çš„æ­¥éª¤" class="headerlink" title="1.1.2 HQLæŸ¥è¯¢çš„æ­¥éª¤"></a>1.1.2 HQLæŸ¥è¯¢çš„æ­¥éª¤</h3><ul><li>è·å¾—Hibernate Sessionå¯¹è±¡</li><li>ç¼–å†™HQLè¯­å¥</li><li>è°ƒç”¨Sessionçš„createQueryæ–¹æ³•åˆ›å»ºæŸ¥è¯¢å¯¹è±¡</li><li>å¦‚æœHQLè¯­å¥åŒ…å«å‚æ•°ï¼Œåˆ™è°ƒç”¨Queryçš„setXxxæ–¹æ³•ä¸ºå‚æ•°èµ‹å€¼</li><li>è°ƒç”¨Queryå¯¹è±¡çš„listç­‰æ–¹æ³•è¿”å›æŸ¥è¯¢ç»“æœã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> test;<br><br><span class="hljs-keyword">import</span> org.hibernate.Session;<br><span class="hljs-keyword">import</span> org.hibernate.SessionFactory;<br><span class="hljs-keyword">import</span> org.hibernate.Transaction;<br><span class="hljs-keyword">import</span> org.hibernate.boot.MetadataSources;<br><span class="hljs-keyword">import</span> org.hibernate.boot.registry.StandardServiceRegistry;<br><span class="hljs-keyword">import</span> org.hibernate.boot.registry.StandardServiceRegistryBuilder;<br><span class="hljs-keyword">import</span> org.junit.Before;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> tt.pyr.entity.Customer;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HibernateTest</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> SessionFactory sf;<br><br>    <span class="hljs-meta">@Before</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;<br>        StandardServiceRegistry registry = <span class="hljs-keyword">new</span> StandardServiceRegistryBuilder().configure(<span class="hljs-string">&quot;/hibernate.cfg.xml&quot;</span>).build();<br>        sf = <span class="hljs-keyword">new</span> MetadataSources(registry).buildMetadata().buildSessionFactory();<br>    &#125;<br>  <br>      <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testHQL</span><span class="hljs-params">()</span> </span>&#123;<br>        Session sess = sf.openSession();<br>        Transaction tx = sess.beginTransaction();<br><br>        String sql = <span class="hljs-string">&quot;Update Customer set custName=:custName where custId=:id&quot;</span>;<br>        sess.createQuery(sql).setParameter(<span class="hljs-string">&quot;custName&quot;</span>, <span class="hljs-string">&quot;å¾åº¶&quot;</span>).setParameter(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-number">2L</span>).executeUpdate();<br>        tx.commit();<br>        sess.close();<br>        sf.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JPA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®åº“</tag>
      
      <tag>Hibernate</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JPAå’Œhibernateå’ŒSpringDataJpa</title>
    <link href="/JPA%E5%92%8Chibernate%E5%92%8CSpringDataJpa/"/>
    <url>/JPA%E5%92%8Chibernate%E5%92%8CSpringDataJpa/</url>
    
    <content type="html"><![CDATA[<p>Javaè®¿é—®æŒä¹…å±‚çš„ä¸¤ç§æ–¹å¼</p><ul><li>ä»¥Sqlä¸ºæ ¸å¿ƒï¼Œå°è£…ä¸€å®šç¨‹åº¦çš„JDBCæ“ä½œï¼Œæ¯”å¦‚mybatis</li><li>ä»¥Javaå®ä½“ç±»ä¸ºæ ¸å¿ƒï¼Œå°†å®ä½“ç±»å’Œæ•°æ®è¡¨ä¹‹é—´å»ºç«‹è¿æ¥ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„ORMæ¡†æ¶ï¼Œæ¯”å¦‚ï¼šHibernate,SpringData jpa</li></ul><h1 id="1-JPA"><a href="#1-JPA" class="headerlink" title="1. JPA"></a>1. JPA</h1><p>JPAé¡¾åæ€ä¹‰å°±æ˜¯Java Persistence APIçš„æ„æ€</p><ul><li>ä½¿ç”¨æ³¨è§£æˆ–XMLæè¿°å¯¹è±¡ï¼å…³ç³»è¡¨çš„æ˜ å°„å…³ç³»</li><li>å°†è¿è¡ŒæœŸçš„å®ä½“å¯¹è±¡æŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­</li><li>å®šä¹‰äº†ä¸€äº›æ¥å£ã€‚</li></ul><h1 id="2-hibernate"><a href="#2-hibernate" class="headerlink" title="2. hibernate"></a>2. hibernate</h1><p>Hibernateå°±æ˜¯å®ç°äº†JPAæ¥å£çš„ORMæ¡†æ¶ã€‚</p><h1 id="3-Spring-Data-JPA"><a href="#3-Spring-Data-JPA" class="headerlink" title="3 Spring Data JPA"></a>3 <strong>Spring Data JPA</strong></h1><h2 id="3-1-å®šä¹‰"><a href="#3-1-å®šä¹‰" class="headerlink" title="3.1 å®šä¹‰"></a>3.1 å®šä¹‰</h2><ul><li><p>Spring Data JPAæ˜¯springæä¾›çš„ä¸€å¥— <strong>JPA åº”ç”¨æ¡†æ¶</strong>ã€‚</p></li><li><p>SpringDataJpaå¯ä»¥ç†è§£ä¸ºJPAè§„èŒƒçš„å†æ¬¡å°è£…æŠ½è±¡ï¼Œåº•å±‚è¿˜æ˜¯ä½¿ç”¨äº†Hibernateçš„JpaæŠ€æœ¯å®ç°ã€‚</p></li><li><p>Spring Data JPAæ—¨åœ¨é€šè¿‡å°†ç»Ÿä¸€ORMæ¡†æ¶çš„è®¿é—®æŒä¹…å±‚çš„æ“ä½œï¼Œæ¥æé«˜å¼€å‘äººçš„æ•ˆç‡ã€‚</p></li><li><p>è™½ç„¶ORMæ¡†æ¶éƒ½å®ç°äº†JPAè§„èŒƒï¼Œä½†æ˜¯åœ¨ä¸åŒçš„ORMæ¡†æ¶ä¹‹é—´åˆ‡æ¢ä»ç„¶éœ€è¦ç¼–å†™ä¸åŒçš„ä»£ç ï¼Œè€Œä½¿ç”¨<strong>Spring Data JPAèƒ½å¤Ÿæ–¹ä¾¿å¤§å®¶åœ¨ä¸åŒçš„ORMæ¡†æ¶ä¹‹é—´è¿›è¡Œåˆ‡æ¢è€Œä¸éœ€è¦æ›´æ”¹ä»£ç </strong>ã€‚</p></li><li><p>æŒ‰ç…§çº¦å®šå¥½çš„è§„åˆ™è¿›è¡Œã€æ–¹æ³•å‘½åã€‘å»å†™daoå±‚æ¥å£ï¼Œå°±å¯ä»¥åœ¨ä¸å†™æ¥å£å®ç°çš„æƒ…å†µä¸‹ï¼Œå®ç°å¯¹æ•°æ®åº“çš„è®¿é—®å’Œæ“ä½œã€‚åŒæ—¶æä¾›äº†å¾ˆå¤šé™¤äº†CRUDä¹‹å¤–çš„åŠŸèƒ½ï¼Œå¦‚åˆ†é¡µã€æ’åºã€å¤æ‚æŸ¥è¯¢ç­‰ç­‰</p></li><li><p>Spring Data JPA è®©æˆ‘ä»¬è§£è„±äº†DAOå±‚çš„æ“ä½œï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰CRUDéƒ½å¯ä»¥ä¾èµ–äºå®ƒæ¥å®ç°,</p></li></ul><h2 id="3-2-Spring-Data-JPAç»™æˆ‘ä»¬æä¾›çš„ä¸»è¦çš„ç±»å’Œæ¥å£"><a href="#3-2-Spring-Data-JPAç»™æˆ‘ä»¬æä¾›çš„ä¸»è¦çš„ç±»å’Œæ¥å£" class="headerlink" title="3.2  Spring Data JPAç»™æˆ‘ä»¬æä¾›çš„ä¸»è¦çš„ç±»å’Œæ¥å£"></a>3.2  <strong>Spring Data JPAç»™æˆ‘ä»¬æä¾›çš„ä¸»è¦çš„ç±»å’Œæ¥å£</strong></h2><ul><li><p>Repository æ¥å£ï¼š</p><ul><li><p>Repository</p></li><li><p>CrudRepository</p></li><li><p>JpaRepository &#x3D; åŸºæœ¬<code>CRUD</code>åŠŸèƒ½+åˆ†é¡µ+æŒ‰â€œå®ä¾‹â€æŸ¥è¯¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">JpaRepository</span>&lt;<span class="hljs-title">T</span>, <span class="hljs-title">ID</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">PagingAndSortingRepository</span>&lt;<span class="hljs-title">T</span>, <span class="hljs-title">ID</span>&gt;, <span class="hljs-title">QueryByExampleExecutor</span></span><br></code></pre></td></tr></table></figure></li></ul></li><li><p>Repository å®ç°ç±»ï¼š</p><ul><li><p>SimpleJpaRepository</p></li><li><p>QueryDslJpaRepository</p></li></ul></li></ul><h1 id="4-JPAã€hibernateã€Spring-Data-Jpaå…³ç³»"><a href="#4-JPAã€hibernateã€Spring-Data-Jpaå…³ç³»" class="headerlink" title="4 JPAã€hibernateã€Spring Data Jpaå…³ç³»"></a>4 JPAã€hibernateã€Spring Data Jpaå…³ç³»</h1><ul><li><p>JPAæ˜¯ä¸€ä¸ªè§„èŒƒï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»…ä»…å®šä¹‰äº†ä¸€äº›æ¥å£</p></li><li><p>Hibernateå°±æ˜¯å®ç°äº†JPAæ¥å£çš„ORMæ¡†æ¶</p></li><li><p>SpringDataJpaæ˜¯Springæä¾›çš„ä¸€å¥—ç®€åŒ–JPAå¼€å‘çš„æ¡†æ¶ã€‚å¯ä»¥ç†è§£ä¸ºJPAè§„èŒƒçš„å†æ¬¡å°è£…æŠ½è±¡ï¼Œåº•å±‚è¿˜æ˜¯ä½¿ç”¨äº†Hibernateçš„JpaæŠ€æœ¯å®ç°ã€‚</p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230320175230013.png" alt="image-20230320175230013"></p><h1 id="5-Spring-Data-JPAå’ŒHibernateçš„å…³ç³»"><a href="#5-Spring-Data-JPAå’ŒHibernateçš„å…³ç³»" class="headerlink" title="5 Spring Data JPAå’ŒHibernateçš„å…³ç³»"></a>5 <strong>Spring Data JPAå’ŒHibernateçš„å…³ç³»</strong></h1><ul><li>Hibernateå…¶å®æ˜¯JPAçš„ä¸€ç§å®ç°ï¼Œè€ŒSpring Data JPAæ˜¯ä¸€ä¸ªJPAæ•°æ®è®¿é—®æŠ½è±¡ã€‚</li><li>pring Data JPAä¸æ˜¯ä¸€ä¸ªå®ç°æˆ–JPAæä¾›çš„ç¨‹åºï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œä¸»è¦ç”¨äºå‡å°‘ä¸ºå„ç§æŒä¹…å±‚å­˜å‚¨å®ç°æ•°æ®è®¿é—®å±‚æ‰€éœ€çš„æ ·æ¿ä»£ç é‡ã€‚ä½†æ˜¯å®ƒè¿˜æ˜¯éœ€è¦JPAæä¾›å®ç°ç¨‹åºã€‚</li><li>Spring Data JPAæ˜¯ä¸€ç§JPAçš„æŠ½è±¡å±‚ï¼Œåº•å±‚ä¾èµ–Hibernate</li></ul><h1 id="6-mybatis-å’Œhibernateçš„å¯¹æ¯”ï¼Ÿ"><a href="#6-mybatis-å’Œhibernateçš„å¯¹æ¯”ï¼Ÿ" class="headerlink" title="6 mybatis å’Œhibernateçš„å¯¹æ¯”ï¼Ÿ"></a>6 mybatis å’Œhibernateçš„å¯¹æ¯”ï¼Ÿ</h1><p>ï¼ˆ1ï¼‰hibernateæ˜¯å…¨è‡ªåŠ¨ï¼Œè€Œmybatisæ˜¯åŠè‡ªåŠ¨ã€‚</p><p>hibernateå®Œå…¨å¯ä»¥é€šè¿‡å¯¹è±¡å…³ç³»æ¨¡å‹å®ç°å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œæ‹¥æœ‰å®Œæ•´çš„JavaBeanå¯¹è±¡ä¸æ•°æ®åº“çš„æ˜ å°„ç»“æ„æ¥è‡ªåŠ¨ç”Ÿæˆsqlã€‚è€Œmybatisä»…æœ‰åŸºæœ¬çš„å­—æ®µæ˜ å°„ï¼Œå¯¹è±¡æ•°æ®ä»¥åŠå¯¹è±¡å®é™…å…³ç³»ä»ç„¶éœ€è¦é€šè¿‡æ‰‹å†™sqlæ¥å®ç°å’Œç®¡ç†ã€‚</p><p>ï¼ˆ2ï¼‰hibernateæ•°æ®åº“ç§»æ¤æ€§è¿œå¤§äºmybatis</p><p>hibernateé€šè¿‡å®ƒå¼ºå¤§çš„æ˜ å°„ç»“æ„å’Œhqlè¯­è¨€ï¼Œå¤§å¤§é™ä½äº†å¯¹è±¡ä¸æ•°æ®åº“ï¼ˆOracleã€MySQLç­‰ï¼‰çš„è€¦åˆæ€§ï¼Œè€Œmybatisç”±äºéœ€è¦æ‰‹å†™sqlï¼Œå› æ­¤ä¸æ•°æ®åº“çš„è€¦åˆæ€§ç›´æ¥å–å†³äºç¨‹åºå‘˜å†™sqlçš„æ–¹æ³•ï¼Œå¦‚æœsqlä¸å…·é€šç”¨æ€§è€Œç”¨äº†å¾ˆå¤šæŸæ•°æ®åº“ç‰¹æ€§çš„sqlè¯­å¥çš„è¯ï¼Œç§»æ¤æ€§ä¹Ÿä¼šéšä¹‹é™ä½å¾ˆå¤šï¼Œæˆæœ¬å¾ˆé«˜ã€‚</p><p>ï¼ˆ3ï¼‰hibernateæ‹¥æœ‰å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿï¼Œmybatisåˆ™æ¬ ç¼ºä¸€äº›</p><p>hibernateæ—¥å¿—ç³»ç»Ÿéå¸¸å¥å…¨ï¼Œæ¶‰åŠå¹¿æ³›ï¼ŒåŒ…æ‹¬ï¼šsqlè®°å½•ã€å…³ç³»å¼‚å¸¸ã€ä¼˜åŒ–è­¦å‘Šã€ç¼“å­˜æç¤ºã€è„æ•°æ®è­¦å‘Šç­‰ï¼›è€Œmybatisåˆ™é™¤äº†åŸºæœ¬è®°å½•åŠŸèƒ½å¤–ï¼ŒåŠŸèƒ½è–„å¼±å¾ˆå¤šã€‚</p><p>ï¼ˆ4ï¼‰sqlç›´æ¥ä¼˜åŒ–ä¸Šï¼Œmybatisè¦æ¯”hibernateæ–¹ä¾¿å¾ˆå¤š</p><p>ç”±äºmybatisçš„sqléƒ½æ˜¯å†™åœ¨xmlé‡Œï¼Œå› æ­¤ä¼˜åŒ–sqlæ¯”hibernateæ–¹ä¾¿å¾ˆå¤šã€‚è€Œhibernateçš„sqlå¾ˆå¤šéƒ½æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œæ— æ³•ç›´æ¥ç»´æŠ¤sqlï¼›</p>]]></content>
    
    
    <categories>
      
      <category>JPA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JPA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vueå…¥é—¨</title>
    <link href="/Vue%E5%85%A5%E9%97%A8/"/>
    <url>/Vue%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Vueæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-Vueæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1 Vueæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1 Vueæ˜¯ä»€ä¹ˆï¼Ÿ</h1><ul><li>vueæ˜¯ä¸€å¥—JavaScriptæ¡†æ¶</li><li>Vueå¯ä»¥ç®€åŒ–Domæ“ä½œ</li><li>å“åº”å¼æ•°æ®é©±åŠ¨</li></ul><h1 id="2-hello-world"><a href="#2-hello-world" class="headerlink" title="2 hello world"></a>2 hello world</h1><ol><li>å¯¼å…¥Vue</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script src=&quot;https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js&quot;&gt;&lt;/script&gt;<br></code></pre></td></tr></table></figure><ol start="2"><li>åˆ›å»ºVueå®ä¾‹å¯¹è±¡ï¼Œè®¾ç½®elå±æ€§å’Œdataå±æ€§</li><li>ä½¿ç”¨ç®€æ´çš„æ¨¡æ¿è¯­æ³•æŠŠæ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸Š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;body&gt;<br>  &lt;div id=&quot;app&quot;&gt;<br>    &#123;&#123;message&#125;&#125;<br>  &lt;/div&gt;<br>  &lt;script src=&quot;https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js&quot;&gt;&lt;/script&gt;<br>  &lt;script&gt;<br>   var app = new Vue(&#123;<br>     el:&quot;#app&quot;,<br>     data:&#123;<br>       message: &quot;hello world!&quot;<br>     &#125;<br>   &#125;)<br>  &lt;/script&gt;<br>&lt;/body&gt;<br></code></pre></td></tr></table></figure><h1 id="3-elæŒ‚è½½ç‚¹"><a href="#3-elæŒ‚è½½ç‚¹" class="headerlink" title="3 elæŒ‚è½½ç‚¹"></a>3 elæŒ‚è½½ç‚¹</h1><ul><li><p>elæ˜¯ç”¨æ¥è®¾ç½®<strong>vueå®ä¾‹æŒ‚è½½</strong>çš„å…ƒç´ </p></li><li><p>Vueä¼šç®¡ç†elé€‰é¡¹<strong>å‘½ä¸­çš„å…ƒç´ </strong>ä»¥åŠå…¶å†…éƒ¨çš„<strong>åä»£å…ƒç´ </strong></p></li><li><p>å¯ä»¥ä½¿ç”¨å…¶ä»–çš„é€‰æ‹©å™¨ï¼Œä½†æ˜¯<strong>å»ºè®®ä½¿ç”¨idé€‰æ‹©å™¨</strong></p></li><li><p>å¯ä»¥ä½¿ç”¨å…¶ä»–çš„åŒæ ‡ç­¾ï¼Œä¸èƒ½ä½¿ç”¨HTMLæˆ–è€…body</p></li></ul><h1 id="4-dataæ•°æ®å¯¹è±¡"><a href="#4-dataæ•°æ®å¯¹è±¡" class="headerlink" title="4 dataæ•°æ®å¯¹è±¡"></a>4 dataæ•°æ®å¯¹è±¡</h1><ul><li>vueä¸­ç”¨åˆ°çš„å¯¹è±¡å®šä¹‰åœ¨dataä¸­</li><li>Dataä¸­å¯ä»¥å†™å¤æ‚ç±»å‹çš„æ•°æ®ï¼Œæ¯”å¦‚å¯¹è±¡ï¼Œæ•°ç»„</li><li>æ¸²æŸ“å¤æ‚ç±»å‹çš„æ•°æ®ï¼Œéµå¾ªjsçš„è¯­æ³•å³å¯</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;body&gt;<br>  &lt;div id=&quot;app&quot;&gt;<br>    &#123;&#123;message&#125;&#125;<br>    &#123;&#123;school.name&#125;&#125;<br>    &#123;&#123;school.age&#125;&#125;<br>    &lt;ul&gt;<br>      &lt;li&gt;&#123;&#123;hoobies[0]&#125;&#125;&lt;/li&gt;<br>      &lt;li&gt;&#123;&#123;hoobies[2]&#125;&#125;&lt;/li&gt;<br>    &lt;/ul&gt;<br>  &lt;/div&gt;<br>  &lt;script src=&quot;https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js&quot;&gt;&lt;/script&gt;<br>  &lt;script&gt;<br>    var app = new Vue(&#123;<br>      el: &quot;#app&quot;,<br>      data: &#123;<br>        message: &quot;hello world!&quot;,<br>        school: &#123;<br>          name: &quot;å¼ ä¸‰&quot;,<br>          age: 14<br>        &#125;,<br>        hoobies: [&quot;å”±æ­Œ&quot;, &quot;è·³èˆ&quot;, &quot;å¼¹ç´&quot;]<br>      &#125;<br>    &#125;)<br>  &lt;/script&gt;<br>&lt;/body&gt;<br></code></pre></td></tr></table></figure><h2 id="5-æ¨¡ç‰ˆè¯­æ³•"><a href="#5-æ¨¡ç‰ˆè¯­æ³•" class="headerlink" title="5 æ¨¡ç‰ˆè¯­æ³•"></a>5 æ¨¡ç‰ˆè¯­æ³•</h2><ul><li><code> &#123;&#123; message &#125;&#125;</code> å±•ç¤ºå­—ç¬¦ä¸²æ–‡æœ¬</li><li><code>v-bind:class=&quot;&#39;btnb tn-sm&#39;&quot;</code> ç»‘å®šå±æ€§</li></ul><img src="/Users/panyurou/Library/Application Support/typora-user-images/image-20221023232100807.png" alt="image-20221023232100807" style="zoom:50%;" /><ul><li><p><code>v-html</code>: ç¿»è¯‘æˆhtmlæ ‡ç­¾</p></li><li><p><code>&#123;&#123; ok ? 'YES':'No' &#125;&#125;</code> ä¸‰å…ƒè¿ç®—</p></li><li><p><code>&#123;&#123; message.spilt('').join(',') &#125;&#125;</code>:  vueæ”¯æŒjsè¡¨è¾¾å¼</p></li><li><p>V-if æ§åˆ¶å…ƒç´ æ˜¯å¦åˆ‡æ¢</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;div id=&quot;app-3&quot;&gt;<br>  &lt;p v-if=&quot;seen&quot;&gt;ç°åœ¨ä½ çœ‹åˆ°æˆ‘äº†&lt;/p&gt;<br>&lt;/div&gt;<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> app3 = <span class="hljs-keyword">new</span> Vue(&#123;<br>  <span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#app-3&#x27;</span>,<br>  <span class="hljs-attr">data</span>: &#123;<br>    <span class="hljs-attr">seen</span>: <span class="hljs-literal">true</span><br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><ul><li>@click ç»‘å®šäº‹ä»¶</li></ul><img src="/Users/panyurou/Library/Application Support/typora-user-images/image-20221023231840513.png" alt="image-20221023231840513" style="zoom:50%;" /> <p>![image-20221023232442286](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20221023232442286.png)</p><ul><li>å¯ä»¥å®šä¹‰è¯·æ±‚è¿”å›çš„æ•°æ®çš„æ ¼å¼</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">data</span>: function () &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>        isEdit: <span class="hljs-literal">false</span>,<br>        businessDataFromApi: <span class="hljs-literal">null</span><br>    &#125;<br>&#125;<br><br> getBusinessDataByQueryApi() &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.queryApi !== undefined) &#123;<br>                let url = `$&#123;<span class="hljs-keyword">this</span>.$store.state[<span class="hljs-keyword">this</span>.entity].baseModuleUrl&#125;/$&#123;<span class="hljs-keyword">this</span>.entity&#125;/` + <span class="hljs-keyword">this</span>.queryApi;<br>                <span class="hljs-keyword">this</span>.$store.dispatch(<span class="hljs-string">&#x27;api/post&#x27;</span>, &#123;<br>                    url: url,<br>                    <span class="hljs-keyword">data</span>: &#123;<br>                        idFilter: <span class="hljs-keyword">this</span>.businessData.id === undefined ? <span class="hljs-keyword">this</span>.$route.query.id : <span class="hljs-keyword">this</span>.businessData.id<br>                    &#125;<br>                &#125;).then(response =&gt; &#123;<br>                    <span class="hljs-keyword">if</span> (response.<span class="hljs-keyword">data</span>.list.length === <span class="hljs-number">1</span>) &#123;<br>                        <span class="hljs-keyword">this</span>.businessDataFromApi = response.<span class="hljs-keyword">data</span>.list[<span class="hljs-number">0</span>];<br>                    &#125;<br>                &#125;)<br>            &#125;<br>        &#125;<br></code></pre></td></tr></table></figure><ul><li>![image-20221024231200647](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20221024231200647.png)</li></ul><p>![image-20221024231215526](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20221024231215526.png)</p><p>- </p><ul><li><pre><code class="hljs">handleClick(col, $event) </code></pre></li><li><p>@click&#x3D;â€handleClick()â€ å’Œ@click&#x3D;â€handleClickâ€çš„åŒºåˆ«åœ¨äºï¼šç¬¬ä¸€ä¸ªæ‹¿ä¸åˆ°eventäº‹ä»¶ï¼Œå¦‚æœè¦æ‹¿åˆ°äº‹ä»¶ï¼Œéœ€è¦å†™æˆ@click&#x3D;â€handleClick($event)â€</p></li><li><p>é˜»æ­¢é»˜è®¤è¡Œä¸º@click.prevent</p></li><li><p>@click.once åªæ‰§è¡Œä¸€æ¬¡äº‹ä»¶è§¦å‘</p></li><li><p>@click.self åªæœ‰e.target &#x3D; e.currentTargetçš„æ—¶å€™æ‰ä¼šæ‰§è¡Œ</p><img src="/Users/panyurou/Library/Application Support/typora-user-images/image-20221108210854373.png" alt="image-20221108210854373" style="zoom: 33%;" /></li></ul>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mongodbé›†ç¾¤</title>
    <link href="/Mongodb%E9%9B%86%E7%BE%A4/"/>
    <url>/Mongodb%E9%9B%86%E7%BE%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä¸»ä»æ¨¡å¼"><a href="#1-ä¸»ä»æ¨¡å¼" class="headerlink" title="1. ä¸»ä»æ¨¡å¼"></a>1. ä¸»ä»æ¨¡å¼</h1><p>ä¸»ä»æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ— æ³•è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼Œå¯¹äºç®€å•çš„ä¸»ä»å¤åˆ¶æ— æ³•è‡ªåŠ¨æ•…éšœè½¬ç§»çš„ç¼ºé™·ï¼Œå„ä¸ªæ•°æ®åº“éƒ½åœ¨æ”¹è¿›ï¼ŒMySQLæ¨å‡ºçš„Fabric ï¼ŒRedisçš„å“¨å…µï¼ŒMongodbçš„å¤åˆ¶é›†ã€‚</p><h1 id="2-å¤åˆ¶é›†æ¨¡å¼"><a href="#2-å¤åˆ¶é›†æ¨¡å¼" class="headerlink" title="2. å¤åˆ¶é›†æ¨¡å¼"></a>2. å¤åˆ¶é›†æ¨¡å¼</h1><ul><li>Mongodbå¤åˆ¶é›†ï¼ˆReplication Setï¼‰ç”±ä¸€ç»„Mongodå®ä¾‹ï¼ˆè¿›ç¨‹ï¼‰ç»„æˆï¼ŒåŒ…å«ä¸€ä¸ª PrimaryèŠ‚ç‚¹å’Œå¤šä¸ªSecondaryèŠ‚ç‚¹</li><li>Mongodb Driverï¼ˆå®¢æˆ·ç«¯ï¼‰çš„æ‰€æœ‰æ•°æ®éƒ½å†™å…¥ ï¼ŒPrimaryï¼ŒSecondaryä»PrimaryåŒæ­¥å†™å…¥çš„æ•°æ®ï¼Œä»¥ä¿æŒå¤åˆ¶é›†å†…æ‰€æœ‰æˆå‘˜å­˜å‚¨ç›¸åŒçš„æ•°æ®é›†ï¼Œæä¾›æ•°æ®çš„é«˜å¯ç”¨</li><li>ä»èŠ‚ç‚¹ä¼šä»oplogæ‹‰æ•°æ®ï¼Œç±»ä¼¼mysqlçš„binlog</li><li>åœ¨å®ç°é«˜å¯ç”¨çš„åŒæ—¶ï¼Œå¤åˆ¶é›†å®ç°äº†å…¶ä»–å‡ ä¸ªé™„åŠ ä½œç”¨: <ul><li>æ•°æ®åˆ†å‘: å°†æ•°æ®ä»ä¸€ä¸ªåŒºåŸŸå¤åˆ¶åˆ°å¦ä¸€ä¸ªåŒºåŸŸï¼Œå‡å°‘å¦ä¸€ä¸ªåŒºåŸŸçš„è¯»å»¶è¿Ÿ </li><li>è¯»å†™åˆ†ç¦»: ä¸åŒç±»å‹çš„å‹åŠ›åˆ†åˆ«åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šæ‰§è¡Œ </li><li>å¼‚åœ°å®¹ç¾: åœ¨æ•°æ®ä¸­å¿ƒæ•…éšœæ—¶å€™å¿«é€Ÿåˆ‡æ¢åˆ°å¼‚åœ°</li></ul></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224723229.png" alt="image-20230228224723229"></p><h2 id="2-1-ä¸‰èŠ‚ç‚¹å¤åˆ¶é›†æ¨¡å¼"><a href="#2-1-ä¸‰èŠ‚ç‚¹å¤åˆ¶é›†æ¨¡å¼" class="headerlink" title="2.1 ä¸‰èŠ‚ç‚¹å¤åˆ¶é›†æ¨¡å¼"></a>2.1 <strong>ä¸‰èŠ‚ç‚¹å¤åˆ¶é›†æ¨¡å¼</strong></h2><p>å¸¸è§çš„å¤åˆ¶é›†æ¶æ„ç”±3ä¸ªæˆå‘˜èŠ‚ç‚¹ç»„æˆï¼Œå…¶ä¸­å­˜åœ¨å‡ ç§ä¸åŒçš„æ¨¡å¼</p><h3 id="2-1-1-PSSæ¨¡å¼ï¼ˆå®˜æ–¹æ¨èæ¨¡å¼ï¼‰"><a href="#2-1-1-PSSæ¨¡å¼ï¼ˆå®˜æ–¹æ¨èæ¨¡å¼ï¼‰" class="headerlink" title="2.1.1 PSSæ¨¡å¼ï¼ˆå®˜æ–¹æ¨èæ¨¡å¼ï¼‰"></a>2.1.1 <strong>PSSæ¨¡å¼ï¼ˆå®˜æ–¹æ¨èæ¨¡å¼ï¼‰</strong></h3><ul><li><p>PSSæ¨¡å¼ç”±ä¸€ä¸ªä¸»èŠ‚ç‚¹å’Œä¸¤ä¸ªå¤‡èŠ‚ç‚¹æ‰€ç»„æˆï¼Œå³Primary+Secondary+Secondary</p></li><li><p>æ­¤æ¨¡å¼å§‹ç»ˆæä¾›æ•°æ®é›†çš„ä¸¤ä¸ªå®Œæ•´å‰¯æœ¬ï¼Œå¦‚æœä¸»èŠ‚ç‚¹ä¸å¯ç”¨ï¼Œåˆ™å¤åˆ¶é›†é€‰æ‹©å¤‡èŠ‚ç‚¹ä½œä¸ºä¸»èŠ‚ ç‚¹å¹¶ç»§ç»­æ­£å¸¸æ“ä½œã€‚</p></li><li><p>æ—§çš„ä¸»èŠ‚ç‚¹åœ¨å¯ç”¨æ—¶é‡æ–°åŠ å…¥å¤åˆ¶é›†ã€‚</p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224732217.png" alt="image-20230228224732217"></p><h3 id="2-1-2-PSAæ¨¡å¼ï¼ˆå®˜æ–¹æ¨èæ¨¡å¼ï¼‰"><a href="#2-1-2-PSAæ¨¡å¼ï¼ˆå®˜æ–¹æ¨èæ¨¡å¼ï¼‰" class="headerlink" title="2.1.2 *PSAæ¨¡å¼ï¼ˆå®˜æ–¹æ¨èæ¨¡å¼ï¼‰*"></a>2.1.2 *<em><strong>PSA</strong>æ¨¡å¼ï¼ˆå®˜æ–¹æ¨èæ¨¡å¼ï¼‰</em>*</h3><ul><li>PSAæ¨¡å¼ç”±ä¸€ä¸ªä¸»èŠ‚ç‚¹ã€ä¸€ä¸ªå¤‡èŠ‚ç‚¹å’Œä¸€ä¸ªä»²è£è€…èŠ‚ç‚¹ç»„æˆï¼Œå³ Primary+Secondary+Arbiter </li><li>æ­¤æ¨¡å¼ä»…æä¾›æ•°æ®çš„ä¸€ä¸ªå®Œæ•´å‰¯æœ¬ï¼Œå¦‚æœä¸»èŠ‚ç‚¹ä¸å¯ç”¨ï¼Œåˆ™å¤åˆ¶ é›†å°†é€‰æ‹©å¤‡èŠ‚ç‚¹ä½œä¸ºä¸»èŠ‚ç‚¹ã€‚</li><li>ArbiterèŠ‚ç‚¹ä¸å­˜å‚¨æ•°æ®å‰¯æœ¬ï¼Œä¹Ÿä¸æä¾›ä¸šåŠ¡çš„è¯»å†™æ“ä½œã€‚ArbiterèŠ‚ç‚¹å‘ç”Ÿæ•…éšœä¸å½± å“ä¸šåŠ¡ï¼Œä»…å½±å“é€‰ä¸¾æŠ•ç¥¨ã€‚å› ä¸ºéœ€è¦åŠæ•°é€‰ä¸¾ï¼Œä½†æœºå™¨æˆæœ¬ä¸å¤Ÿå†ç”³è¯·ä¸€å°</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224740040.png" alt="image-20230228224740040"></p><h1 id="3-åˆ†ç‰‡é›†ç¾¤æ¶æ„"><a href="#3-åˆ†ç‰‡é›†ç¾¤æ¶æ„" class="headerlink" title="3 åˆ†ç‰‡é›†ç¾¤æ¶æ„"></a>3 <strong>åˆ†ç‰‡é›†ç¾¤æ¶æ„</strong></h1><p>MongoDB åˆ†ç‰‡é›†ç¾¤ï¼ˆSharded Clusterï¼‰æ˜¯å¯¹æ•°æ®è¿›è¡Œæ°´å¹³æ‰©å±•çš„ä¸€ç§æ–¹å¼</p><h2 id="3-1-ä½¿ç”¨åœºæ™¯"><a href="#3-1-ä½¿ç”¨åœºæ™¯" class="headerlink" title="3.1 ä½¿ç”¨åœºæ™¯"></a>3.1 ä½¿ç”¨åœºæ™¯</h2><ul><li>å†™IOPSè¶…å‡ºå•ä¸ªMongoDBèŠ‚ç‚¹çš„å†™æœåŠ¡èƒ½åŠ›</li><li>å­˜å‚¨å®¹é‡éœ€æ±‚è¶…å‡ºå•æœºçš„ç£ç›˜å®¹é‡ã€‚ </li><li>æ´»è·ƒçš„æ•°æ®é›†è¶…å‡ºå•æœºå†…å­˜å®¹é‡ï¼Œå¯¼è‡´å¾ˆå¤šè¯·æ±‚éƒ½è¦ä»ç£ç›˜è¯»å–æ•°æ®ï¼Œå½±å“æ€§ èƒ½</li></ul>]]></content>
    
    
    <categories>
      
      <category>MongoDB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é›†ç¾¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ElasticSearché›†ç¾¤æ¶æ„</title>
    <link href="/ElasticSearch%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84/"/>
    <url>/ElasticSearch%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ESé›†ç¾¤æ¶æ„"><a href="#1-ESé›†ç¾¤æ¶æ„" class="headerlink" title="1 ESé›†ç¾¤æ¶æ„"></a>1 <strong>ESé›†ç¾¤æ¶æ„</strong></h1><ul><li><p>ä¸€ä¸ªé›†ç¾¤å¯ä»¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªèŠ‚ç‚¹ </p></li><li><p>ä¸åŒçš„é›†ç¾¤é€šè¿‡ä¸åŒçš„åå­—æ¥åŒºåˆ†ï¼Œé»˜è®¤åå­—â€œelasticsearchâ€œ </p></li><li><p>é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹ï¼Œæˆ–è€…åœ¨å‘½ä»¤è¡Œä¸­ -E cluster.name&#x3D;es-clusterè¿›è¡Œè®¾å®š</p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221740498.png" alt="image-20230228221740498"></p><h1 id="2-é›†ç¾¤èŠ‚ç‚¹ç±»å‹"><a href="#2-é›†ç¾¤èŠ‚ç‚¹ç±»å‹" class="headerlink" title="2  é›†ç¾¤èŠ‚ç‚¹ç±»å‹"></a>2  é›†ç¾¤èŠ‚ç‚¹ç±»å‹</h1><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221752056.png" alt="image-20230228221752056"></p><ul><li><p>Master Nodeï¼šä¸»èŠ‚ç‚¹ </p><ul><li><p>å¤„ç†åˆ›å»ºï¼Œåˆ é™¤ç´¢å¼•ç­‰è¯·æ±‚ï¼Œè´Ÿè´£ç´¢å¼•çš„åˆ›å»ºä¸åˆ é™¤</p></li><li><p>å†³å®šåˆ†ç‰‡è¢«åˆ†é…åˆ°å“ªä¸ªèŠ‚ç‚¹</p></li><li><p>ç®¡ç†é›†ç¾¤èŠ‚ç‚¹çŠ¶æ€</p></li></ul></li><li><p>Master eligible nodesï¼š</p><ul><li>å¯ä»¥å‚ä¸é€‰ä¸¾çš„åˆæ ¼èŠ‚ç‚¹ </li><li>æ¯ä¸ªèŠ‚ç‚¹å¯åŠ¨åï¼Œé»˜è®¤å°±æ˜¯ä¸€ä¸ªMaster eligibleèŠ‚ç‚¹</li></ul></li><li><p>Data Nodeï¼šæ•°æ®èŠ‚ç‚¹ </p><ul><li>å¯ä»¥ä¿å­˜æ•°æ®çš„èŠ‚ç‚¹ï¼Œè´Ÿè´£æ•°æ®å†™å…¥ä¸æœç´¢</li><li>èŠ‚ç‚¹å¯åŠ¨åï¼Œé»˜è®¤å°±æ˜¯æ•°æ®èŠ‚ç‚¹ã€‚å¯ä»¥è®¾ç½®node.data: false ç¦æ­¢</li></ul></li><li><p>Coordinating Nodeï¼šåè°ƒèŠ‚ç‚¹</p><ul><li>è´Ÿè´£æ¥å—Clientçš„è¯·æ±‚ï¼Œ å°†è¯·æ±‚åˆ†å‘åˆ°åˆé€‚çš„èŠ‚ç‚¹ï¼Œæœ€ç»ˆæŠŠç»“æœæ±‡é›†åˆ°ä¸€èµ· </li><li>æ¯ä¸ªèŠ‚ç‚¹é»˜è®¤éƒ½èµ·åˆ°äº†Coordinating Nodeçš„èŒè´£</li></ul></li></ul><h1 id="3-åˆ†ç‰‡å’Œå‰¯æœ¬"><a href="#3-åˆ†ç‰‡å’Œå‰¯æœ¬" class="headerlink" title="3 åˆ†ç‰‡å’Œå‰¯æœ¬"></a>3 åˆ†ç‰‡å’Œå‰¯æœ¬</h1><h2 id="3-1-åˆ†ç‰‡"><a href="#3-1-åˆ†ç‰‡" class="headerlink" title="3.1 åˆ†ç‰‡"></a>3.1 åˆ†ç‰‡</h2><ul><li><p>ES é€šè¿‡æ°´å¹³æ‹†åˆ†çš„æ–¹å¼å°†ä¸€ä¸ªç´¢å¼•ä¸Šçš„æ•°æ®æ‹†åˆ†å‡ºæ¥åˆ†é…åˆ°ä¸åŒçš„æ•°æ®å—ä¸Šï¼Œåˆ†å¸ƒåœ¨å¤šå°æœåŠ¡å™¨ä¸Šå­˜å‚¨ï¼Œæ‹†åˆ†å‡ºæ¥çš„æ•°æ®åº“å—ç§°ä¹‹ä¸ºä¸€ä¸ªåˆ†ç‰‡ã€‚</p></li><li><p>ä¸€ä¸ªç´¢å¼•ï¼ˆindexï¼‰ç”±å¤šä¸ªshardï¼ˆåˆ†ç‰‡ï¼‰ç»„æˆï¼Œè€Œåˆ†ç‰‡æ˜¯åˆ†å¸ƒåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šçš„</p></li><li><p>ä¸»åˆ†ç‰‡æ•°åœ¨ç´¢å¼•åˆ›å»ºæ—¶æŒ‡å®šï¼Œåç»­ä¸å…è®¸ä¿®æ”¹ï¼Œé™¤éReindex</p></li></ul><h2 id="3-2-å‰¯æœ¬"><a href="#3-2-å‰¯æœ¬" class="headerlink" title="3.2 å‰¯æœ¬"></a>3.2 å‰¯æœ¬</h2><ul><li>ç”¨ä»¥è§£å†³æ•°æ®é«˜å¯ç”¨çš„é—®é¢˜ã€‚ å‰¯æœ¬åˆ†ç‰‡æ˜¯ä¸»åˆ†ç‰‡çš„æ‹·è´ </li><li>å‰¯æœ¬åˆ†ç‰‡æ•°ï¼Œå¯ä»¥åŠ¨æ€è°ƒæ•´ </li><li>å¢åŠ å‰¯æœ¬æ•°ï¼Œè¿˜å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜æœåŠ¡çš„å¯ç”¨æ€§(è¯»å–çš„å å)</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">1</span> # æŒ‡å®šç´¢å¼•çš„ä¸»åˆ†ç‰‡å’Œå‰¯æœ¬åˆ†ç‰‡æ•° <br>  PUT /blogs  &#123;<br> <span class="hljs-string">&quot;settings&quot;</span>: &#123;<br>   <span class="hljs-string">&quot;number_of_shards&quot;</span>: <span class="hljs-number">3</span>,<br>   <span class="hljs-string">&quot;number_of_replicas&quot;</span>: <span class="hljs-number">1</span> <br> &#125; &#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221807970.png" alt="image-20230228221807970"></p><h2 id="3-2-1-è®¾ç½®å‰¯æœ¬åˆ†ç‰‡æ•°"><a href="#3-2-1-è®¾ç½®å‰¯æœ¬åˆ†ç‰‡æ•°" class="headerlink" title="3.2.1 è®¾ç½®å‰¯æœ¬åˆ†ç‰‡æ•°"></a>3.2.1 <strong>è®¾ç½®å‰¯æœ¬åˆ†ç‰‡æ•°</strong></h2><p>å‰¯æœ¬æ˜¯ä¸»åˆ†ç‰‡çš„æ‹·è´ï¼š </p><ul><li><p>æé«˜ç³»ç»Ÿå¯ç”¨æ€§ï¸°å“åº”æŸ¥è¯¢è¯·æ±‚ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤± </p></li><li><p>éœ€è¦å ç”¨å’Œä¸»åˆ†ç‰‡ä¸€æ ·çš„èµ„æº</p></li></ul><p>å¯¹æ€§èƒ½çš„å½±å“ï¼š</p><ul><li><p>åˆ†ç‰‡é—´çš„æ•°æ®åŒæ­¥ä¼šå ç”¨ä¸€å®šçš„ç½‘ç»œå¸¦å®½ï¼Œå½±å“æ•ˆç‡</p></li><li><p>ä¼šå‡ç¼“å¯¹ä¸»åˆ†ç‰‡çš„æŸ¥è¯¢å‹åŠ›ï¼Œä½†æ˜¯ä¼šæ¶ˆè€—åŒæ ·çš„å†…å­˜èµ„æºã€‚å¦‚æœæœºå™¨èµ„æºå……åˆ†ï¼Œ æé«˜å‰¯æœ¬æ•°ï¼Œå¯ä»¥æé«˜æ•´ä½“çš„æŸ¥è¯¢QPS</p></li></ul><h1 id="4-Elasticsearchæ–‡æ¡£å†™å…¥åŸç†"><a href="#4-Elasticsearchæ–‡æ¡£å†™å…¥åŸç†" class="headerlink" title="4 Elasticsearchæ–‡æ¡£å†™å…¥åŸç†"></a>4 Elasticsearchæ–‡æ¡£å†™å…¥åŸç†</h1><ol><li>å®¢æˆ·ç«¯é€‰æ‹©ä¸€ä¸ªnodeå‘é€è¯·æ±‚è¿‡å»ï¼Œè¿™ä¸ªnodeå°±æ˜¯coordinating node (åè°ƒèŠ‚ ç‚¹)</li><li>coordinating nodeè®¡ç®—å¾—åˆ°æ–‡æ¡£è¦å†™å…¥çš„åˆ†ç‰‡ã€‚é»˜è®¤æ˜¯ <code>hash(æ–‡æ¡£çš„id) % ä¸»åˆ†ç‰‡æ•°</code></li><li>coordinating nodeï¼Œå¯¹documentè¿›è¡Œè·¯ç”±ï¼Œå°†è¯·æ±‚è½¬å‘ç»™å¯¹åº”çš„node </li><li>nodeä¸Šçš„primary shardå¤„ç†è¯·æ±‚ï¼Œç„¶åå°†æ•°æ®åŒæ­¥åˆ°replica node </li><li>coordinating nodeå¦‚æœå‘ç°primary nodeå’Œæ‰€æœ‰çš„replica nodeéƒ½ä¿å­˜å¥½äº†æ–‡æ¡£ï¼Œ å°±ä¼šè¿”å›è¯·æ±‚åˆ°å®¢æˆ·ç«¯</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221821340.png" alt="image-20230228221821340"></p><h1 id="5-ESè¯»å–æ•°æ®çš„è¿‡ç¨‹"><a href="#5-ESè¯»å–æ•°æ®çš„è¿‡ç¨‹" class="headerlink" title="5 ESè¯»å–æ•°æ®çš„è¿‡ç¨‹"></a>5 <strong>ESè¯»å–æ•°æ®çš„è¿‡ç¨‹</strong></h1><h2 id="5-1-æ ¹æ®idæŸ¥è¯¢æ•°æ®çš„è¿‡ç¨‹"><a href="#5-1-æ ¹æ®idæŸ¥è¯¢æ•°æ®çš„è¿‡ç¨‹" class="headerlink" title="5. 1 æ ¹æ®idæŸ¥è¯¢æ•°æ®çš„è¿‡ç¨‹"></a>5. 1 <strong>æ ¹æ®idæŸ¥è¯¢æ•°æ®çš„è¿‡ç¨‹</strong></h2><ol><li>å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°ä»»æ„ä¸€ä¸ª nodeï¼Œæˆä¸º coordinate node</li><li>coordinate node å¯¹ doc id è¿›è¡Œå“ˆå¸Œè·¯ç”±ï¼Œå°†è¯·æ±‚è½¬å‘åˆ°å¯¹åº”çš„ nodeï¼Œæ­¤æ—¶ä¼š ä½¿ç”¨ round-robin éšæœºè½®è¯¢ç®—æ³•ï¼Œåœ¨ primary shard ä»¥åŠå…¶æ‰€æœ‰ replica ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªï¼Œè®©è¯»è¯·æ±‚è´Ÿè½½å‡è¡¡ã€‚</li><li>æ¥æ”¶è¯·æ±‚çš„ node è¿”å› document ç»™ coordinate node</li><li>coordinate node è¿”å› document ç»™å®¢æˆ·ç«¯ã€‚</li></ol><blockquote><p>æ ¹æ® doc id è¿›è¡Œ hashï¼Œåˆ¤æ–­å‡ºæ¥å½“æ—¶æŠŠ doc id åˆ†é…åˆ°äº†å“ªä¸ª shard ä¸Šé¢å»ï¼Œä»é‚£ä¸ª shard å»æŸ¥è¯¢ã€‚</p></blockquote><h2 id="5-2-æ ¹æ®å…³é”®è¯æŸ¥è¯¢æ•°æ®çš„è¿‡ç¨‹"><a href="#5-2-æ ¹æ®å…³é”®è¯æŸ¥è¯¢æ•°æ®çš„è¿‡ç¨‹" class="headerlink" title="5.2 æ ¹æ®å…³é”®è¯æŸ¥è¯¢æ•°æ®çš„è¿‡ç¨‹"></a>5.2 <strong>æ ¹æ®å…³é”®è¯æŸ¥è¯¢æ•°æ®çš„è¿‡ç¨‹</strong></h2><ol><li>å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°ä¸€ä¸ª coordinate node ã€‚</li><li>åè°ƒèŠ‚ç‚¹å°†æŸ¥è¯¢è¯·æ±‚å¹¿æ’­åˆ°æ¯ä¸€ä¸ªæ•°æ®èŠ‚ç‚¹ï¼Œè¿™äº›æ•°æ®èŠ‚ç‚¹çš„åˆ†ç‰‡ä¼šå¤„ç†è¯¥æŸ¥è¯¢è¯·æ±‚ </li><li><strong>query phase</strong>ï¼šæ¯ä¸ª shard å°†è‡ªå·±çš„æœç´¢ç»“æœï¼ˆåŒ…æ‹¬ï¼šæ–‡æ¡£IDã€èŠ‚ç‚¹ä¿¡æ¯ã€åˆ†ç‰‡ä¿¡æ¯ï¼‰è¿”å›ç»™åè°ƒèŠ‚ç‚¹ï¼Œç”±åè°ƒèŠ‚ç‚¹è¿›è¡Œ æ•°æ®çš„åˆå¹¶ã€æ’åºã€åˆ†é¡µç­‰æ“ä½œï¼Œäº§å‡ºæœ€ç»ˆç»“æœ</li><li><strong>fetch phaseï¼š</strong>æ¥ç€ç”±åè°ƒèŠ‚ç‚¹æ ¹æ® doc id å»å„ä¸ªèŠ‚ç‚¹ä¸Šæ‹‰å–å®é™…çš„ document æ•°æ®ï¼Œæœ€ç»ˆè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é›†ç¾¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ElasticSearchçŸ¥è¯†ç‚¹æ€»ç»“</title>
    <link href="/ElasticSearch%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/"/>
    <url>/ElasticSearch%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Esæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-Esæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1 Esæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1 Esæ˜¯ä»€ä¹ˆï¼Ÿ</h1><ul><li>Elasticsearchæ˜¯ç”¨Javaå¼€å‘å¹¶ä¸”æ˜¯å½“å‰æœ€æµè¡Œçš„å¼€æºçš„<strong>ä¼ä¸šçº§æœç´¢å¼•æ“</strong>ã€‚</li><li>èƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚</li><li>å®¢æˆ·ç«¯æ”¯æŒJavaã€.NETï¼ˆC#ï¼‰ã€PHPã€Pythonã€Rubyç­‰å¤šç§è¯­è¨€ã€‚</li></ul><h1 id="2-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ES"><a href="#2-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ES" class="headerlink" title="2 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ES?"></a>2 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ES?</h1><ul><li>æ•°æ®é‡åœ¨å‡ ä¸‡æˆ–è€…å‡ åä¸‡æ—¶å€™ï¼Œæ‰€ä»¥é‡‡ç”¨ä»¥å¾€çš„æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå®æ—¶ä¸æ•°æ®åº“äº¤äº’ï¼Œä¼šå¯¼è‡´æ•ˆç‡ç‰¹åˆ«ä½ä¸‹</li><li>ä¸èƒ½å°†æœç´¢è¯æ‹†åˆ†å¼€æ¥ï¼Œå¦‚æœé‡‡ç”¨ä»¥å¾€çš„æ¨¡ç³ŠæŸ¥è¯¢ï¼Œæ¯”å¦‚ <code>name</code> &#x3D;â€™æ‰‹æœº%â€™ï¼Œ åªèƒ½æœç´¢åå­—æ˜¯â€œæ‰‹æœºâ€å¼€å¤´çš„æ‰‹æœºå•†å“ï¼Œå¦‚æœæƒ³æœå‡ºâ€œåä¸ºæ‰‹æœºâ€æˆ–è€…â€æ‰‹æœºå£³â€œé‚£æ˜¯æœç´¢ä¸å‡ºæ¥çš„ã€‚</li></ul><h1 id="3-Eså’Œä¼ ç»Ÿå…³ç³»æ€§æ•°æ®åº“æ¯”è¾ƒ"><a href="#3-Eså’Œä¼ ç»Ÿå…³ç³»æ€§æ•°æ®åº“æ¯”è¾ƒ" class="headerlink" title="3 Eså’Œä¼ ç»Ÿå…³ç³»æ€§æ•°æ®åº“æ¯”è¾ƒ"></a>3 Eså’Œä¼ ç»Ÿå…³ç³»æ€§æ•°æ®åº“æ¯”è¾ƒ</h1><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224035138.png" alt="image-20230228224035138"></p><h1 id="4-ä»€ä¹ˆæ˜¯å…¨æ–‡æ£€ç´¢"><a href="#4-ä»€ä¹ˆæ˜¯å…¨æ–‡æ£€ç´¢" class="headerlink" title="4 ä»€ä¹ˆæ˜¯å…¨æ–‡æ£€ç´¢"></a>4 ä»€ä¹ˆæ˜¯å…¨æ–‡æ£€ç´¢</h1><ul><li>å…¨æ–‡æ£€ç´¢æ˜¯æŒ‡ï¼šé€šè¿‡ä¸€ä¸ªç¨‹åºæ‰«ææ–‡æœ¬ä¸­çš„æ¯ä¸€ä¸ªå•è¯ï¼Œé’ˆå¯¹å•è¯å»ºç«‹ç´¢å¼•ï¼Œå¹¶ä¿å­˜è¯¥å•è¯åœ¨æ–‡æœ¬ä¸­çš„ä½ç½®ã€ä»¥åŠå‡ºç°çš„æ¬¡æ•°ã€‚</li><li>ç”¨æˆ·æŸ¥è¯¢æ—¶ï¼Œé€šè¿‡ä¹‹å‰å»ºç«‹å¥½çš„ç´¢å¼•æ¥æŸ¥è¯¢ï¼Œå°†ç´¢å¼•ä¸­å•è¯å¯¹åº”çš„æ–‡æœ¬ä½ç½®ã€å‡ºç°çš„æ¬¡æ•°è¿”å›ç»™ç”¨æˆ·ï¼Œå› ä¸ºæœ‰äº†å…·ä½“æ–‡æœ¬çš„ä½ç½®ï¼Œæ‰€ä»¥å°±å¯ä»¥å°†å…·ä½“å†…å®¹è¯»å–å‡ºæ¥äº†</li></ul><h1 id="5-ä»€ä¹ˆæ˜¯å€’æ’ç´¢å¼•ï¼Ÿ"><a href="#5-ä»€ä¹ˆæ˜¯å€’æ’ç´¢å¼•ï¼Ÿ" class="headerlink" title="5 ä»€ä¹ˆæ˜¯å€’æ’ç´¢å¼•ï¼Ÿ"></a>5 ä»€ä¹ˆæ˜¯å€’æ’ç´¢å¼•ï¼Ÿ</h1><p>å¯¹äºå…³ç³»å‹æ•°æ®åº“mysqlæ¥è¯´ï¼Œ<strong>æ™®é€šçš„ç´¢å¼•ç»“æ„å°±æ˜¯â€œid-&gt;é¢˜ç›®-&gt;å†…å®¹â€ï¼Œ</strong>åœ¨æˆ‘ä»¬æœç´¢çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“idæˆ–è€…é¢˜ç›®<strong>ï¼Œé‚£ä¹ˆæ£€ç´¢æ•ˆç‡æ˜¯å¾ˆé«˜æ•ˆçš„ï¼Œå› ä¸ºâ€œidâ€ã€â€œé¢˜ç›®â€æ˜¯å¾ˆæ–¹ä¾¿åˆ›å»ºç´¢å¼•çš„ã€‚</strong></p><p>é‚£ä¹ˆ<strong>å€’æ’åºç´¢å¼•</strong>çš„ç»“æ„æ˜¯æ€æ ·çš„å‘¢ï¼Ÿç®€å•æ¥è®²<strong>å°±æ˜¯â€œä»¥å†…å®¹çš„å…³é”®è¯â€å»ºç«‹ç´¢å¼•ï¼Œ</strong>æ˜ å°„å…³ç³»ä¸º<strong>â€œå†…å®¹çš„å…³é”®è¯-&gt;IDâ€ã€‚</strong>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨â€œå…³é”®è¯â€ä¸­è¿›è¡Œæ£€ç´¢</p><h1 id="6-Elasticsearchä¸­çš„æ ¸å¿ƒæ¦‚å¿µ"><a href="#6-Elasticsearchä¸­çš„æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="6 Elasticsearchä¸­çš„æ ¸å¿ƒæ¦‚å¿µ"></a>6 Elasticsearchä¸­çš„æ ¸å¿ƒæ¦‚å¿µ</h1><h2 id="6-1-ç´¢å¼•index"><a href="#6-1-ç´¢å¼•index" class="headerlink" title="6.1 ç´¢å¼•index"></a>6.1 ç´¢å¼•index</h2><p>ç±»ä¼¼äºæ•°æ®åº“ä¸­çš„<strong>åº“</strong>ï¼Œå­˜æ”¾æ‹¥æœ‰æŸäº›å…±åŒç‰¹å¾çš„æ–‡æ¡£çš„é›†åˆã€‚</p><h2 id="6-2-å­—æ®µç±»å‹Type"><a href="#6-2-å­—æ®µç±»å‹Type" class="headerlink" title="6.2 å­—æ®µç±»å‹Type"></a>6.2 å­—æ®µç±»å‹Type</h2><p>ç±»ä¼¼äºæ•°æ®åº“ä¸­çš„<strong>è¡¨</strong>ï¼Œ åœ¨7.0å¼€å§‹ï¼Œä¸€ä¸ªç´¢å¼•åªèƒ½å»ºä¸€ä¸ªTypeä¸º<code>_doc</code></p><h2 id="6-4-å­—æ®µField"><a href="#6-4-å­—æ®µField" class="headerlink" title="6.4 å­—æ®µField"></a>6.4 å­—æ®µField</h2><p>ç›¸å½“äºæ˜¯æ•°æ®è¡¨çš„å­—æ®µ|åˆ—</p><h2 id="6-5-æ–‡æ¡£document"><a href="#6-5-æ–‡æ¡£document" class="headerlink" title="6.5 æ–‡æ¡£document"></a>6.5 æ–‡æ¡£document</h2><p>ä¸€ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªå¯è¢«ç´¢å¼•çš„åŸºç¡€ä¿¡æ¯å•å…ƒï¼Œç±»ä¼¼ä¸€æ¡è®°å½•ã€‚æ–‡æ¡£ä»¥JSONï¼ˆJavascriptObjectNotationï¼‰æ ¼å¼æ¥è¡¨ç¤ºï¼›</p><h2 id="6-6-æ˜ å°„mapping"><a href="#6-6-æ˜ å°„mapping" class="headerlink" title="6.6 æ˜ å°„mapping"></a>6.6 æ˜ å°„mapping</h2><p>mappingæ˜¯å¤„ç†æ•°æ®çš„æ–¹å¼å’Œè§„åˆ™æ–¹é¢åšä¸€äº›é™åˆ¶ï¼Œå¦‚æŸä¸ªå­—æ®µçš„æ•°æ®ç±»å‹ã€é»˜è®¤å€¼ã€åˆ†è¯å™¨ã€æ˜¯å¦è¢«ç´¢å¼•ç­‰ç­‰ï¼Œè¿™äº›éƒ½æ˜¯æ˜ å°„é‡Œé¢å¯ä»¥è®¾ç½®çš„</p>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mysqlåˆ†åº“åˆ†è¡¨</title>
    <link href="/mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/"/>
    <url>/mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-åˆ†åº“åˆ†è¡¨æ˜¯ä»€ä¹ˆ"><a href="#1-åˆ†åº“åˆ†è¡¨æ˜¯ä»€ä¹ˆ" class="headerlink" title="1 åˆ†åº“åˆ†è¡¨æ˜¯ä»€ä¹ˆ"></a>1 åˆ†åº“åˆ†è¡¨æ˜¯ä»€ä¹ˆ</h1><ul><li>åˆ†åº“ï¼šä»å•ä¸ªæ•°æ®åº“æ‹†åˆ†æˆå¤šä¸ªæ•°æ®åº“çš„è¿‡ç¨‹ï¼Œå°†æ•°æ®æ•£è½åœ¨å¤šä¸ªæ•°æ®åº“ä¸­ã€‚</li><li>åˆ†è¡¨ï¼šä»å•å¼ è¡¨æ‹†åˆ†æˆå¤šå¼ è¡¨çš„è¿‡ç¨‹ï¼Œå°†æ•°æ®æ•£è½åœ¨å¤šå¼ è¡¨å†…ã€‚</li></ul><h1 id="2-åˆ†åº“åˆ†è¡¨æœ‰ä»€ä¹ˆç”¨"><a href="#2-åˆ†åº“åˆ†è¡¨æœ‰ä»€ä¹ˆç”¨" class="headerlink" title="2 åˆ†åº“åˆ†è¡¨æœ‰ä»€ä¹ˆç”¨"></a>2 <strong>åˆ†åº“åˆ†è¡¨æœ‰ä»€ä¹ˆç”¨</strong></h1><p>åˆ†åº“åˆ†è¡¨å°±æ˜¯ä¸ºäº†è§£å†³ç”±äºæ•°æ®é‡è¿‡å¤§è€Œå¯¼è‡´æ•°æ®åº“æ€§èƒ½é™ä½çš„é—®é¢˜</p><h1 id="3-åˆ†åº“åˆ†è¡¨çš„æ–¹å¼"><a href="#3-åˆ†åº“åˆ†è¡¨çš„æ–¹å¼" class="headerlink" title="3 åˆ†åº“åˆ†è¡¨çš„æ–¹å¼"></a>3 <strong>åˆ†åº“åˆ†è¡¨çš„æ–¹å¼</strong></h1><ul><li>åˆ†åº“åˆ†è¡¨åŒ…å«åˆ†åº“å’Œåˆ†è¡¨ ä¸¤ä¸ªéƒ¨åˆ†ï¼Œè€Œè¿™ä¸¤ä¸ªéƒ¨åˆ†å¯ä»¥ç»Ÿç§°ä¸ºæ•°æ®åˆ†ç‰‡ï¼Œå…¶ç›®çš„éƒ½æ˜¯å°†æ•°æ®æ‹†åˆ†æˆä¸åŒçš„å­˜å‚¨å•å…ƒã€‚</li><li>ä»åˆ†æ‹†çš„è§’åº¦ä¸Šï¼Œå¯ä»¥åˆ†ä¸ºå‚ç›´åˆ†ç‰‡å’Œæ°´å¹³åˆ†ç‰‡</li></ul><h2 id="3-1-å‚ç›´åˆ†ç‰‡"><a href="#3-1-å‚ç›´åˆ†ç‰‡" class="headerlink" title="3.1 å‚ç›´åˆ†ç‰‡"></a>3.1 å‚ç›´åˆ†ç‰‡</h2><ul><li>æŒ‰ç…§ä¸šåŠ¡æ¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç‰‡ï¼ŒæŒ‰ç…§ä¸šåŠ¡å°†è¡¨è¿›è¡Œå½’ç±»ï¼Œåˆ†å¸ƒåˆ°ä¸åŒçš„æ•°æ®åº“æˆ–è¡¨ä¸­ï¼Œä»è€Œå°†å‹åŠ›åˆ†æ•£è‡³ä¸åŒçš„æ•°æ®åº“æˆ–è¡¨ã€‚</li><li>å¦‚æœå‚ç›´åˆ†ç‰‡ä¹‹åï¼Œè¡¨ä¸­çš„æ•°æ®é‡ä¾ç„¶è¶…è¿‡å•èŠ‚ç‚¹æ‰€èƒ½æ‰¿è½½çš„é˜ˆå€¼ï¼Œåˆ™éœ€è¦æ°´å¹³åˆ†ç‰‡æ¥è¿›ä¸€æ­¥å¤„ç†ã€‚</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221440881.png" alt="image-20230228221440881"></p><h2 id="3-2-æ°´å¹³åˆ†ç‰‡"><a href="#3-2-æ°´å¹³åˆ†ç‰‡" class="headerlink" title="3.2 æ°´å¹³åˆ†ç‰‡"></a>3.2 æ°´å¹³åˆ†ç‰‡</h2><ul><li>åˆç§°æ¨ªå‘åˆ†ç‰‡ã€‚é€šè¿‡æŸä¸ªå­—æ®µ(æˆ–æŸå‡ ä¸ªå­—æ®µ)ï¼Œæ ¹æ®æŸç§è§„åˆ™å°†æ•°æ®åˆ†æ•£è‡³å¤šä¸ªåº“æˆ–è¡¨ä¸­ï¼Œæ¯ä¸ªåˆ†ç‰‡ä»…åŒ…å«æ•°æ®çš„ä¸€éƒ¨åˆ†</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221453079.png" alt="image-20230228221453079"></p><h3 id="3-2-1-æ°´å¹³åˆ†ç‰‡å¸¸ç”¨çš„åˆ†ç‰‡ç­–ç•¥"><a href="#3-2-1-æ°´å¹³åˆ†ç‰‡å¸¸ç”¨çš„åˆ†ç‰‡ç­–ç•¥" class="headerlink" title="3.2.1 æ°´å¹³åˆ†ç‰‡å¸¸ç”¨çš„åˆ†ç‰‡ç­–ç•¥"></a>3.2.1 æ°´å¹³åˆ†ç‰‡å¸¸ç”¨çš„åˆ†ç‰‡ç­–ç•¥</h3><ul><li>ç²¾å‡†åˆ†ç‰‡ï¼Œæ¯”å¦‚ï¼šå–ä½™\å–æ¨¡ ã€‚ ä¼˜ç‚¹å‡åŒ€å­˜æ”¾æ•°æ®ï¼Œç¼ºç‚¹ æ‰©å®¹éå¸¸éº»çƒ¦ï¼Œå¦‚æœæ–°åŠ ä¸€å°æœåŠ¡å™¨ï¼Œä¹‹å‰çš„è€æ•°æ®å°±å¾—åšè¿ç§»</li><li>æŒ‰ç…§èŒƒå›´åˆ†ç‰‡ ï¼š å½“æˆ‘ä»¬ SQLä¸­çš„åˆ†ç‰‡å¥å­—æ®µç”¨åˆ° <code>BETWEEN AND</code>æ“ä½œç¬¦ä¼šä½¿ç”¨åˆ°æ­¤ç®—æ³•ï¼Œæ¯”å¦‚è®¢å•idåœ¨1è‡³100å­˜æ”¾åˆ°ä¸€å¼ è¡¨ï¼Œ200åˆ°300åœ¨å¦ä¸€å¼ ã€‚</li></ul><h1 id="4-åˆ†åº“åˆ†è¡¨è¦è§£å†³å“ªäº›é—®é¢˜"><a href="#4-åˆ†åº“åˆ†è¡¨è¦è§£å†³å“ªäº›é—®é¢˜" class="headerlink" title="4 åˆ†åº“åˆ†è¡¨è¦è§£å†³å“ªäº›é—®é¢˜"></a>4 åˆ†åº“åˆ†è¡¨è¦è§£å†³å“ªäº›é—®é¢˜</h1><ul><li>äº‹åŠ¡ä¸€è‡´æ€§é—®é¢˜</li></ul><p>åŸæœ¬å•æœºæ•°æ®åº“æœ‰å¾ˆå¥½çš„äº‹åŠ¡æœºåˆ¶èƒ½å¤Ÿå¸®æˆ‘ä»¬ä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚ä½†æ˜¯åˆ†åº“åˆ†è¡¨åï¼Œç”±äºæ•°æ®åˆ†å¸ƒåœ¨ä¸åŒåº“ç”šè‡³ä¸åŒæœåŠ¡å™¨ï¼Œä¸å¯é¿å…ä¼šå¸¦æ¥åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ã€‚</p><ul><li>è·¨èŠ‚ç‚¹å…³è”æŸ¥è¯¢é—®é¢˜</li></ul><p>åœ¨æ²¡æœ‰åˆ†åº“æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œå¾ˆå®¹æ˜“çš„è¿›è¡Œè·¨è¡¨çš„å…³è”æŸ¥è¯¢ã€‚ä½†æ˜¯åœ¨åˆ†åº“åï¼Œè¡¨è¢«åˆ†æ•£åˆ°äº†ä¸åŒçš„æ•°æ®åº“ï¼Œå°±æ— æ³•è¿›è¡Œå…³è”æŸ¥è¯¢äº†ã€‚è¿™æ—¶å°±éœ€è¦å°†å…³è”æŸ¥è¯¢æ‹†åˆ†æˆå¤šæ¬¡æŸ¥è¯¢ï¼Œç„¶åå°†è·å¾—çš„ç»“æœè¿›è¡Œæ‹¼è£…ã€‚</p><ul><li>è·¨èŠ‚ç‚¹åˆ†é¡µã€æ’åºå‡½æ•°</li></ul><p>è·¨èŠ‚ç‚¹å¤šåº“è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œlimitåˆ†é¡µã€order byæ’åºç­‰é—®é¢˜ï¼Œå°±å˜å¾—æ¯”è¾ƒå¤æ‚äº†ã€‚éœ€è¦å…ˆåœ¨ä¸åŒçš„åˆ†ç‰‡èŠ‚ç‚¹ä¸­å°†æ•°æ®è¿›è¡Œæ’åºå¹¶è¿”å›ï¼Œç„¶åå°†ä¸åŒåˆ†ç‰‡è¿”å›çš„ç»“æœé›†è¿›è¡Œæ±‡æ€»å’Œå†æ¬¡æ’åºã€‚è¿™æ—¶éå¸¸å®¹æ˜“å‡ºç°å†…å­˜å´©æºƒçš„é—®é¢˜ã€‚</p><ul><li>ä¸»é”®é¿é‡é—®é¢˜</li></ul><p>åœ¨åˆ†åº“åˆ†è¡¨ç¯å¢ƒä¸­ï¼Œç”±äºè¡¨ä¸­æ•°æ®åŒæ—¶å­˜åœ¨ä¸åŒæ•°æ®åº“ä¸­ï¼Œä¸»é”®å€¼å¹³æ—¶ä½¿ç”¨çš„è‡ªå¢é•¿å°†æ— ç”¨æ­¦ä¹‹åœ°ï¼ŒæŸä¸ªåˆ†åŒºæ•°æ®åº“ç”Ÿæˆçš„IDæ— æ³•ä¿è¯å…¨å±€å”¯ä¸€ã€‚å› æ­¤éœ€è¦å•ç‹¬è®¾è®¡å…¨å±€ä¸»é”®ï¼Œä»¥é¿å…è·¨åº“ä¸»é”®é‡å¤é—®é¢˜ã€‚</p><ul><li>å…¬å…±è¡¨å¤„ç†</li></ul><p>å®é™…çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œå‚æ•°è¡¨ã€æ•°æ®å­—å…¸è¡¨ç­‰éƒ½æ˜¯æ•°æ®é‡è¾ƒå°ï¼Œå˜åŠ¨å°‘ï¼Œè€Œä¸”å±äºé«˜é¢‘è”åˆæŸ¥è¯¢çš„ä¾èµ–è¡¨ã€‚è¿™ä¸€ç±»è¡¨ä¸€èˆ¬å°±éœ€è¦åœ¨æ¯ä¸ªæ•°æ®åº“ä¸­éƒ½ä¿å­˜ä¸€ä»½ï¼Œå¹¶ä¸”æ‰€æœ‰å¯¹å…¬å…±è¡¨çš„æ“ä½œéƒ½è¦åˆ†å‘åˆ°æ‰€æœ‰çš„åˆ†åº“å»æ‰§è¡Œã€‚</p><ul><li>è¿ç»´å·¥ä½œé‡</li></ul><p>é¢å¯¹æ•£ä¹±çš„åˆ†åº“åˆ†è¡¨ä¹‹åçš„æ•°æ®ï¼Œåº”ç”¨å¼€å‘å·¥ç¨‹å¸ˆå’Œæ•°æ®åº“ç®¡ç†å‘˜å¯¹æ•°æ®åº“çš„æ“ä½œéƒ½å˜å¾—éå¸¸ç¹é‡ã€‚å¯¹äºæ¯ä¸€æ¬¡æ•°æ®è¯»å†™æ“ä½œï¼Œä»–ä»¬éƒ½éœ€è¦çŸ¥é“è¦å¾€å“ªä¸ªå…·ä½“çš„æ•°æ®åº“çš„åˆ†è¡¨å»æ“ä½œï¼Œè¿™ä¹Ÿæ˜¯å…¶ä¸­é‡è¦çš„æŒ‘æˆ˜ä¹‹ä¸€ã€‚</p><h1 id="5-ä»€ä¹ˆæ—¶å€™éœ€è¦åˆ†åº“åˆ†è¡¨ï¼Ÿ"><a href="#5-ä»€ä¹ˆæ—¶å€™éœ€è¦åˆ†åº“åˆ†è¡¨ï¼Ÿ" class="headerlink" title="5 ä»€ä¹ˆæ—¶å€™éœ€è¦åˆ†åº“åˆ†è¡¨ï¼Ÿ"></a>5 <strong>ä»€ä¹ˆæ—¶å€™éœ€è¦åˆ†åº“åˆ†è¡¨ï¼Ÿ</strong></h1><p>åœ¨é˜¿é‡Œå·´å·´å…¬å¸ƒçš„å¼€å‘æ‰‹å†Œä¸­ï¼Œå»ºè®®MySQLå•è¡¨è®°å½•å¦‚æœè¾¾åˆ°500Wè¿™ä¸ªçº§åˆ«ï¼Œæˆ–è€…å•è¡¨å®¹é‡è¾¾åˆ°2GBï¼Œä¸€èˆ¬å°±å»ºè®®è¿›è¡Œåˆ†åº“åˆ†è¡¨ã€‚</p><h1 id="6-å¸¸è§çš„åˆ†åº“åˆ†è¡¨ç»„ä»¶"><a href="#6-å¸¸è§çš„åˆ†åº“åˆ†è¡¨ç»„ä»¶" class="headerlink" title="6 å¸¸è§çš„åˆ†åº“åˆ†è¡¨ç»„ä»¶"></a>6 <strong>å¸¸è§çš„åˆ†åº“åˆ†è¡¨ç»„ä»¶</strong></h1><p>ShardingSphereï¼Œmycatï¼Œ DBLE</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†åº“åˆ†è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>rabbitMqé›†ç¾¤</title>
    <link href="/rabbitMq%E9%9B%86%E7%BE%A4/"/>
    <url>/rabbitMq%E9%9B%86%E7%BE%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="æ™®é€šé›†ç¾¤æ¨¡å¼"><a href="#æ™®é€šé›†ç¾¤æ¨¡å¼" class="headerlink" title="æ™®é€šé›†ç¾¤æ¨¡å¼"></a>æ™®é€šé›†ç¾¤æ¨¡å¼</h1><ul><li><p><strong>queueçš„æ¶ˆæ¯</strong>ï¼Œåªä¼šæ”¾åœ¨<strong>ä¸€ä¸ªrabbtimqå®ä¾‹</strong>ä¸Šã€‚<strong>æ¯ä¸ªå®ä¾‹éƒ½åŒæ­¥queueçš„ç»“æ„å’Œqueueæ¶ˆæ¯çš„çœŸæ­£ä½ç½®</strong>ã€‚</p></li><li><p>æ¶ˆè´¹çš„æ—¶å€™ï¼Œå®é™…ä¸Šå¦‚æœè¿æ¥åˆ°äº†å¦å¤–ä¸€ä¸ªå®ä¾‹ï¼Œé‚£ä¹ˆé‚£ä¸ªå®ä¾‹ä¼šä»queueæ‰€åœ¨å®ä¾‹ä¸Šæ‹‰å–æ•°æ®è¿‡æ¥ã€‚</p></li></ul><p>è¿™ç§é›†ç¾¤æ¨¡å¼çš„æ¶ˆæ¯å¯é æ€§ä¸æ˜¯å¾ˆé«˜ã€‚å› ä¸ºå¦‚æœå…¶ä¸­æœ‰ä¸ªèŠ‚ç‚¹æœåŠ¡å®•æœºäº†ï¼Œé‚£è¿™ä¸ªèŠ‚ç‚¹ä¸Šçš„æ•°æ®å°±æ— æ³•æ¶ˆè´¹äº†ï¼Œéœ€è¦ç­‰åˆ°è¿™ä¸ªèŠ‚ç‚¹æœåŠ¡æ¢å¤åæ‰èƒ½æ¶ˆè´¹ã€‚</p><h1 id="é•œåƒé›†ç¾¤æ¨¡å¼"><a href="#é•œåƒé›†ç¾¤æ¨¡å¼" class="headerlink" title="é•œåƒé›†ç¾¤æ¨¡å¼"></a>é•œåƒé›†ç¾¤æ¨¡å¼</h1><ul><li><p>è¿™ç§æ¨¡å¼æ˜¯åœ¨æ™®é€šé›†ç¾¤æ¨¡å¼åŸºç¡€ä¸Šçš„ä¸€ç§å¢å¼ºæ–¹æ¡ˆï¼Œè¿™ä¹Ÿå°±æ˜¯RabbitMQçš„å®˜æ–¹HAé«˜å¯ç”¨æ–¹æ¡ˆã€‚</p></li><li><p>è¿™ç§æ¨¡å¼ä¼šåœ¨é•œåƒèŠ‚ç‚¹ä¸­é—´ä¸»åŠ¨è¿›è¡Œæ¶ˆæ¯åŒæ­¥ï¼Œè€Œä¸æ˜¯åœ¨å®¢æˆ·ç«¯æ‹‰å–æ¶ˆæ¯æ—¶ä¸´æ—¶åŒæ­¥ã€‚è¿™ç§æ¨¡å¼çš„æ¶ˆæ¯å¯é æ€§æ›´é«˜ï¼Œå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½å­˜ç€å…¨é‡çš„æ¶ˆæ¯ã€‚</p></li><li><p>ä»–çš„å¼Šç«¯ä¹Ÿæ˜¯æ˜æ˜¾çš„ï¼Œé›†ç¾¤å†…éƒ¨çš„ç½‘ç»œå¸¦å®½ä¼šè¢«è¿™ç§åŒæ­¥é€šè®¯å¤§é‡çš„æ¶ˆè€—ï¼Œè¿›è€Œé™ä½æ•´ä¸ªé›†ç¾¤çš„æ€§èƒ½ã€‚è¿™ç§æ¨¡å¼ä¸‹ï¼Œé˜Ÿåˆ—æ•°é‡æœ€å¥½ä¸è¦è¿‡å¤šã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>RabbitMQ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é›†ç¾¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mysqlé›†ç¾¤</title>
    <link href="/Mysql%E9%9B%86%E7%BE%A4/"/>
    <url>/Mysql%E9%9B%86%E7%BE%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä¸»ä»æ¨¡å¼"><a href="#1-ä¸»ä»æ¨¡å¼" class="headerlink" title="1 ä¸»ä»æ¨¡å¼"></a>1 ä¸»ä»æ¨¡å¼</h1><ul><li>ä¸€ä¸ªmasterå¯ä»¥æ‹¥æœ‰å¤šä¸ªslaveï¼Œä¸€ä¸ªslaveåªå¯¹åº”ä¸€ä¸ªmaster</li><li><strong>ä¸€ä¸»å¤šä»ï¼Œä¸»è´Ÿè´£å†™ï¼Œå¹¶ä¸”å°†æ•°æ®å¤åˆ¶åˆ°å…¶å®ƒçš„ slave èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹è´Ÿè´£è¯»</strong>ã€‚</li><li>æ‰€æœ‰çš„è¯»è¯·æ±‚å…¨éƒ¨èµ°ä»èŠ‚ç‚¹ã€‚è¿™æ ·ä¹Ÿå¯ä»¥å¾ˆè½»æ¾å®ç°æ°´å¹³æ‰©å®¹ï¼Œæ”¯æ’‘<strong>è¯»é«˜å¹¶å‘</strong>ã€‚</li><li>ä¸€ä¸»å¤šä»çš„ç»“æ„ï¼Œä¸»è¦ç›®çš„æ˜¯å®ç°æ•°æ®çš„å¤šç‚¹å¤‡ä»½ï¼ˆæ²¡æœ‰æ•…éšœè‡ªåŠ¨è½¬ç§»å’Œè´Ÿè½½å‡è¡¡ï¼‰</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ä»åº“è¦ä»binlogè·å–æ•°æ®å¹¶é‡æ”¾ï¼Œè¿™è‚¯å®šä¸ä¸»åº“å†™å…¥æ•°æ®å­˜åœ¨æ—¶é—´å»¶è¿Ÿï¼Œå› æ­¤ä»åº“çš„æ•°æ®æ€»æ˜¯è¦æ»åä¸»åº“ã€‚</li><li>å¯¹ä¸»åº“ä¸ä»åº“ä¹‹é—´çš„ç½‘ç»œå»¶è¿Ÿè¦æ±‚è¾ƒé«˜ï¼Œè‹¥ç½‘ç»œå»¶è¿Ÿå¤ªé«˜ï¼Œå°†åŠ é‡ä¸Šè¿°çš„æ»åï¼Œé€ æˆæœ€ç»ˆæ•°æ®çš„ä¸ä¸€è‡´ã€‚</li><li>å•ä¸€çš„ä¸»èŠ‚ç‚¹æŒ‚äº†ï¼Œå°†ä¸èƒ½å¯¹å¤–æä¾›å†™æœåŠ¡ã€‚</li></ul><h2 id="1-1-Mysqlä¸»ä»å¤åˆ¶å·¥ä½œåŸç†"><a href="#1-1-Mysqlä¸»ä»å¤åˆ¶å·¥ä½œåŸç†" class="headerlink" title="1.1 Mysqlä¸»ä»å¤åˆ¶å·¥ä½œåŸç†"></a>1.1 Mysqlä¸»ä»å¤åˆ¶å·¥ä½œåŸç†</h2><p>æ•°æ®åº“çš„ä¸»ä»åŒæ­¥ï¼Œå°±æ˜¯ä¸ºäº†è¦ä¿è¯å¤šä¸ªæ•°æ®åº“ä¹‹é—´çš„æ•°æ®ä¿æŒä¸€è‡´ã€‚</p><ul><li><p>æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨æ•°æ®åº“çš„å¯¼å…¥å¯¼å‡ºå·¥å…·ï¼Œå®šæ—¶å°†ä¸»åº“çš„æ•°æ®å¯¼å‡ºï¼Œå†å¯¼å…¥åˆ°ä»åº“å½“ä¸­ã€‚è¿™æ˜¯ä¸€ç§å¾ˆå¸¸è§ï¼Œä¹Ÿå¾ˆç®€å•æ˜“è¡Œçš„æ•°æ®åº“é›†ç¾¤æ–¹å¼ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼è¿›è¡Œæ•°æ®åŒæ­¥çš„å®æ—¶æ€§æ¯”è¾ƒå·®ã€‚</p></li><li><p>å¦‚æœè¦ä¿è¯æ•°æ®èƒ½å¤Ÿå®æ—¶åŒæ­¥ï¼Œå¯¹äºMySQLï¼Œé€šå¸¸å°±è¦ç”¨åˆ°ä»–è‡ªèº«æä¾›çš„ä¸€å¥—é€šè¿‡Binlogæ—¥å¿—åœ¨å¤šä¸ªMySQLæœåŠ¡ä¹‹é—´è¿›è¡ŒåŒæ­¥çš„é›†ç¾¤æ–¹æ¡ˆã€‚</p></li></ul><p><strong>Binlogå¤åˆ¶æµç¨‹è¯¦è§£ï¼š</strong></p><ul><li>ä¸»åº“ä¸Šæ‰“å¼€Binlogæ—¥å¿—ï¼Œè®°å½•å¯¹æ•°æ®çš„æ¯ä¸€æ­¥æ“ä½œ</li><li>å½“ä¸»åº“æœ‰æ•°æ®æ›´æ–°çš„æ—¶å€™ï¼Œä¼šé€šçŸ¥ä»åº“</li><li>ä»åº“ä¼šå‘ä¸»åº“è¯·æ±‚binlogæ—¥å¿—ï¼Œä½†ä¸ºäº†ä¿è¯æ—¥å¿—æ¥æ”¶çš„ç¨³å®šæ€§ï¼Œå¹¶ä¸ä¼šç«‹å³é‡æ¼”Binlogæ•°æ®æ“ä½œï¼Œè€Œæ˜¯å…ˆå°†æ¥æ”¶åˆ°çš„Binlogæ—¥å¿—å†™å…¥åˆ°è‡ªå·±çš„RelayLogæ—¥å¿—å½“ä¸­</li><li>ä»åº“æ£€æµ‹åˆ°RelayLogä¸­çš„æ“ä½œæ—¥å¿—æœ‰æ›´æ–°ï¼Œå°±ä¼šåœ¨è‡ªå·±æ•°æ®åº“ä¸­è¿›è¡Œå¼‚æ­¥é‡æ¼”ã€‚</li></ul><blockquote><p>MySQLçš„BinLogæ—¥å¿—èƒ½å¤Ÿæ¯”è¾ƒå®æ—¶çš„è®°å½•ä¸»åº“ä¸Šçš„æ‰€æœ‰æ—¥å¿—æ“ä½œï¼Œå› æ­¤ä»–ä¹Ÿè¢«å¾ˆå¤šå…¶ä»–å·¥å…·ç”¨æ¥å®æ—¶ç›‘æ§MySQLçš„æ•°æ®å˜åŒ–ã€‚å¦‚ï¼š</p><ul><li>è½¬å‘åˆ°Rediså®ç°ç¼“å­˜ä¸€è‡´</li><li>ClickHouseä¹Ÿæ”¯æŒå°†è‡ªå·±æ¨¡æ‹Ÿæˆä¸€ä¸ªMySQLçš„ä»èŠ‚ç‚¹ï¼Œæ¥æ”¶MySQLçš„Binlogæ—¥å¿—ï¼Œå®æ—¶åŒæ­¥MySQLçš„æ•°æ®ã€‚è¿™ä¸ªåŠŸèƒ½ç›®å‰è¿˜åœ¨å®éªŒé˜¶æ®µã€‚</li></ul></blockquote><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224830814.png" alt="image-20230228224830814"></p><h2 id="1-2-ä¸»ä»å¤åˆ¶çš„ç­–ç•¥"><a href="#1-2-ä¸»ä»å¤åˆ¶çš„ç­–ç•¥" class="headerlink" title="1.2 ä¸»ä»å¤åˆ¶çš„ç­–ç•¥"></a>1.2 ä¸»ä»å¤åˆ¶çš„ç­–ç•¥</h2><ol><li><strong>ã€ŒåŒæ­¥ç­–ç•¥ã€</strong>ï¼šMasterä¼šç­‰å¾…æ‰€æœ‰çš„Slaveéƒ½å›åº”åæ‰ä¼šæäº¤ï¼Œè¿™ä¸ªä¸»ä»çš„åŒæ­¥çš„æ€§èƒ½ä¼šä¸¥é‡çš„å½±å“ã€‚</li><li><strong>ã€ŒåŠåŒæ­¥ç­–ç•¥ã€</strong>ï¼šMasterè‡³å°‘ä¼šç­‰å¾…ä¸€ä¸ªSlaveå›åº”å¹¶å†™å…¥relay logåæäº¤ã€‚</li><li><strong>ã€Œå¼‚æ­¥ç­–ç•¥ã€</strong>ï¼šMasterä¸ç”¨ç­‰å¾…Slaveå›åº”å°±å¯ä»¥æäº¤ã€‚</li></ol><h2 id="1-3-æ—¥å¿—è®°å½•ä¸Špositionæ–¹å¼å’ŒGTIDæ–¹å¼åŒºåˆ«"><a href="#1-3-æ—¥å¿—è®°å½•ä¸Špositionæ–¹å¼å’ŒGTIDæ–¹å¼åŒºåˆ«" class="headerlink" title="1.3 æ—¥å¿—è®°å½•ä¸Špositionæ–¹å¼å’ŒGTIDæ–¹å¼åŒºåˆ«"></a>1.3 <strong>æ—¥å¿—è®°å½•ä¸Špositionæ–¹å¼å’ŒGTIDæ–¹å¼åŒºåˆ«</strong></h2><ul><li>ä¸»ä»å¤åˆ¶,é»˜è®¤æ˜¯é€šè¿‡poså¤åˆ¶(postion)æ–¹å¼,å°†ç”¨æˆ·è¿›è¡Œçš„æ¯ä¸€é¡¹æ“ä½œéƒ½è¿›è¡Œç¼–å·(pos)ï¼Œåœ¨é…ç½®ä»æœåŠ¡æ—¶ï¼Œå°±éœ€è¦é€šè¿‡è¿™ä¸ªPositioné€šçŸ¥ä»æœåŠ¡ä»å“ªä¸ªåœ°æ–¹å¼€å§‹è®°å½•binLogã€‚</li><li>GTID (Global Transaction IDå…¨å±€äº‹åŠ¡ID)å°±æ˜¯ç±»ä¼¼äºposçš„ä¸€ä¸ªä½œç”¨,å…¨å±€é€šç”¨å¹¶ä¸”æ—¥å¿—æ–‡ä»¶é‡Œäº‹ä»¶çš„GTIDå€¼æ˜¯ä¸€è‡´çš„ã€‚ä¸ç”¨ä»¥å‰é‚£æ ·åœ¨éœ€è¦æ‰¾log_fileå’Œlog_Posã€‚</li><li>ä»æ¶æ„è®¾è®¡çš„è§’åº¦ï¼ŒGTIDæ˜¯ä¸€ç§å¾ˆå¥½çš„åˆ†å¸ƒå¼IDå®è·µæ–¹å¼</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224842796.png" alt="image-20230228224842796"></p><h1 id="2-MySQL-Fabric-æ¨¡å¼"><a href="#2-MySQL-Fabric-æ¨¡å¼" class="headerlink" title="2 MySQL Fabric æ¨¡å¼"></a>2 MySQL Fabric æ¨¡å¼</h1><ul><li>MySQL Fabricèƒ½â€œç»„ç»‡â€å¤šä¸ªMySQLæ•°æ®åº“ï¼Œæ˜¯åº”ç”¨ç³»ç»Ÿå°†å¤§äºå‡ TBçš„è¡¨åˆ†æ•£åˆ°å¤šä¸ªæ•°æ®åº“ï¼Œå³æ•°æ®åˆ†ç‰‡(Data Shard)ã€‚</li><li>åœ¨åŒä¸€ä¸ªåˆ†ç‰‡å†…åˆå¯ä»¥å«æœ‰å¤šä¸ªæ•°æ®åº“ï¼Œå¹¶ä¸”ç”±Fabric<strong>è‡ªåŠ¨</strong>æŒ‘é€‰ä¸€ä¸ªé€‚åˆçš„ä½œä¸ºä¸»æ•°æ®åº“ï¼Œå…¶ä»–çš„æ•°æ®åº“é…ç½®æˆä»æ•°æ®åº“ï¼Œæ¥åšä¸»ä»å¤åˆ¶ã€‚</li><li>åœ¨ä¸»æ•°æ®åº“æŒ‚æ‰æ—¶ï¼Œä»å„ä¸ªä»æ•°æ®åº“ä¸­æŒ‘é€‰ä¸€ä¸ªæå‡ä¸ºä¸»æ•°æ®åº“ã€‚</li></ul><h1 id="3-MySQL-Cluster-æ¨¡å¼"><a href="#3-MySQL-Cluster-æ¨¡å¼" class="headerlink" title="3 MySQL Cluster æ¨¡å¼"></a>3 MySQL Cluster æ¨¡å¼</h1><ul><li>MySQL Clusteræ˜¯å¤šä¸»å¤šä»ç»“æ„çš„</li></ul><p>å¯å‚è€ƒredis cluster</p><h1 id="4-ç¬¬ä¸‰æ–¹ä¼˜åŒ–"><a href="#4-ç¬¬ä¸‰æ–¹ä¼˜åŒ–" class="headerlink" title="4 ç¬¬ä¸‰æ–¹ä¼˜åŒ–"></a>4 ç¬¬ä¸‰æ–¹ä¼˜åŒ–</h1><h2 id="4-1-MMM-æ¨¡å¼"><a href="#4-1-MMM-æ¨¡å¼" class="headerlink" title="4.1 MMM æ¨¡å¼"></a>4.1 MMM æ¨¡å¼</h2><ul><li><p>MMMï¼ˆMaster Replication Manager for MySQLï¼‰æ˜¯<strong>åŒä¸»å¤šä»</strong>ç»“æ„ã€‚</p></li><li><p>è¿™æ˜¯Googleçš„å¼€æºé¡¹ç›®ï¼Œä½¿ç”¨Perlè¯­è¨€æ¥å¯¹MySQL ä¸»ä»åšæ‰©å±•ï¼Œæä¾›ä¸€å¥—æ”¯æŒåŒä¸»æ•…éšœåˆ‡æ¢å’ŒåŒä¸»æ—¥å¸¸ç®¡ç†çš„è„šæœ¬ç¨‹åºï¼Œä¸»è¦ç”¨æ¥ç›‘æ§mysqlä¸»ä¸»å¤åˆ¶å¹¶åšå¤±è´¥è½¬ç§»ã€‚</p></li><li><p>ä»–éœ€è¦ä¸¤ä¸ªMasterï¼ŒåŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªMasterå¯¹å¤–æä¾›æœåŠ¡ï¼Œå¯ä»¥è¯´æ˜¯ä¸»å¤‡æ¨¡å¼ã€‚</p></li><li><p>ä»–æ˜¯é€šè¿‡ä¸€ä¸ªVIP(è™šæ‹ŸIP)çš„æœºåˆ¶æ¥ä¿è¯é›†ç¾¤çš„é«˜å¯ç”¨ã€‚æ•´ä¸ªé›†ç¾¤ä¸­ï¼Œåœ¨ä¸»èŠ‚ç‚¹ä¸Šä¼šé€šè¿‡ä¸€ä¸ªVIPåœ°å€æ¥æä¾›æ•°æ®è¯»å†™æœåŠ¡ï¼Œè€Œå½“å‡ºç°æ•…éšœæ—¶ï¼ŒVIPå°±ä¼šä»åŸæ¥çš„ä¸»èŠ‚ç‚¹æ¼‚ç§»åˆ°å…¶ä»–èŠ‚ç‚¹ï¼Œç”±å…¶ä»–èŠ‚ç‚¹æä¾›æœåŠ¡ã€‚</p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224851424.png" alt="image-20230228224851424"></p><h3 id="4-1-1ä¼˜ç‚¹ï¼š"><a href="#4-1-1ä¼˜ç‚¹ï¼š" class="headerlink" title="4.1.1ä¼˜ç‚¹ï¼š"></a>4.1.1ä¼˜ç‚¹ï¼š</h3><ul><li><p>æä¾›äº†è¯»å†™VIPçš„é…ç½®ï¼Œä½¿è¯»å†™è¯·æ±‚éƒ½å¯ä»¥è¾¾åˆ°é«˜å¯ç”¨</p></li><li><p>å·¥å…·åŒ…ç›¸å¯¹æ¯”è¾ƒå®Œå–„ï¼Œä¸éœ€è¦é¢å¤–çš„å¼€å‘è„šæœ¬</p></li><li><p>å®Œæˆæ•…éšœè½¬ç§»ä¹‹åå¯ä»¥å¯¹MySQLé›†ç¾¤è¿›è¡Œé«˜å¯ç”¨ç›‘æ§</p></li></ul><h3 id="4-1-2-ç¼ºç‚¹ï¼š"><a href="#4-1-2-ç¼ºç‚¹ï¼š" class="headerlink" title="4.1.2 ç¼ºç‚¹ï¼š"></a><em>4.1.2 ç¼ºç‚¹ï¼š</em></h3><ul><li><p>æ•…éšœç®€å•ç²—æš´ï¼Œå®¹æ˜“ä¸¢å¤±äº‹åŠ¡ï¼Œå»ºè®®é‡‡ç”¨åŠåŒæ­¥å¤åˆ¶æ–¹å¼ï¼Œå‡å°‘å¤±è´¥çš„æ¦‚ç‡</p></li><li><p>ç›®å‰MMMç¤¾åŒºå·²ç»ç¼ºå°‘ç»´æŠ¤ï¼Œä¸æ”¯æŒåŸºäºGTIDçš„å¤åˆ¶</p></li></ul><h3 id="4-1-3-é€‚ç”¨åœºæ™¯ï¼š"><a href="#4-1-3-é€‚ç”¨åœºæ™¯ï¼š" class="headerlink" title="4.1.3 é€‚ç”¨åœºæ™¯ï¼š"></a>4.1.3 <strong>é€‚ç”¨åœºæ™¯ï¼š</strong></h3><ul><li><p>è¯»å†™éƒ½éœ€è¦é«˜å¯ç”¨çš„</p></li><li><p>åŸºäºæ—¥å¿—ç‚¹çš„å¤åˆ¶æ–¹å¼</p></li></ul><h2 id="4-2-MHA-æ¨¡å¼"><a href="#4-2-MHA-æ¨¡å¼" class="headerlink" title="4.2 MHA æ¨¡å¼"></a>4.2 <strong>MHA</strong> æ¨¡å¼</h2><ul><li>MHAï¼ˆMaster High Availabilityï¼‰æ˜¯<strong>å¤šä¸»å¤šä»</strong>ç»“æ„ï¼Œ</li><li>æ˜¯ç”±æ—¥æœ¬äººå¼€å‘çš„ä¸€ä¸ªåŸºäºPerlè„šæœ¬å†™çš„å·¥å…·ã€‚è¿™ä¸ªå·¥å…·ä¸“é—¨ç”¨äºç›‘æ§ä¸»åº“çš„çŠ¶æ€ï¼Œå½“å‘ç°masterèŠ‚ç‚¹æ•…éšœæ—¶ï¼Œä¼šæå‡å…¶ä¸­æ‹¥æœ‰æ–°æ•°æ®çš„slaveèŠ‚ç‚¹æˆä¸ºæ–°çš„masterèŠ‚ç‚¹ï¼Œåœ¨æ­¤æœŸé—´ï¼ŒMHAä¼šé€šè¿‡å…¶ä»–ä»èŠ‚ç‚¹è·å–é¢å¤–çš„ä¿¡æ¯æ¥é¿å…æ•°æ®ä¸€è‡´æ€§æ–¹é¢çš„é—®é¢˜ã€‚</li><li>MHAè¿˜æä¾›äº†materèŠ‚ç‚¹çš„åœ¨çº¿åˆ‡æ¢åŠŸèƒ½ï¼Œå³æŒ‰éœ€åˆ‡æ¢master-slaveèŠ‚ç‚¹ã€‚MHAèƒ½å¤Ÿåœ¨30ç§’å†…å®ç°æ•…éšœåˆ‡æ¢ï¼Œå¹¶èƒ½åœ¨æ•…éšœåˆ‡æ¢è¿‡ç¨‹ä¸­ï¼Œæœ€å¤§ç¨‹åº¦çš„ä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚</li></ul><h3 id="4-2-1-ä¼˜ç‚¹ï¼š"><a href="#4-2-1-ä¼˜ç‚¹ï¼š" class="headerlink" title="4.2.1 ä¼˜ç‚¹ï¼š"></a>4.2.1 ä¼˜ç‚¹ï¼š</h3><ul><li><p>MHAé™¤äº†æ”¯æŒæ—¥å¿—ç‚¹çš„å¤åˆ¶è¿˜æ”¯æŒGTIDçš„æ–¹å¼</p></li><li><p>åŒMMMç›¸æ¯”ï¼ŒMHAä¼šå°è¯•ä»æ—§çš„Masterä¸­æ¢å¤æ—§çš„äºŒè¿›åˆ¶æ—¥å¿—ï¼Œåªæ˜¯æœªå¿…æ¯æ¬¡éƒ½èƒ½æˆåŠŸã€‚å¦‚æœå¸Œæœ›æ›´å°‘çš„æ•°æ®ä¸¢å¤±åœºæ™¯ï¼Œå»ºè®®ä½¿ç”¨MHAæ¶æ„ã€‚</p></li></ul><h3 id="4-2-2-ç¼ºç‚¹ï¼š"><a href="#4-2-2-ç¼ºç‚¹ï¼š" class="headerlink" title="4.2.2 ç¼ºç‚¹ï¼š"></a>4.2.2 ç¼ºç‚¹ï¼š</h3><ul><li><p>MHAéœ€è¦è‡ªè¡Œå¼€å‘VIPè½¬ç§»è„šæœ¬ã€‚</p></li><li><p>MHAåªç›‘æ§Masterçš„çŠ¶æ€ï¼Œæœªç›‘æ§Slaveçš„çŠ¶æ€</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é›†ç¾¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>zookeeperçš„ä½¿ç”¨åœºæ™¯</title>
    <link href="/zookeeper%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/"/>
    <url>/zookeeper%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ZooKeeper-å®ç°åˆ†å¸ƒå¼-ID"><a href="#1-ZooKeeper-å®ç°åˆ†å¸ƒå¼-ID" class="headerlink" title="1 ZooKeeper å®ç°åˆ†å¸ƒå¼ ID"></a>1 ZooKeeper å®ç°åˆ†å¸ƒå¼ ID</h1><h2 id="1-1-ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ID"><a href="#1-1-ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ID" class="headerlink" title="1.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ID"></a>1.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ID</h2><p>åœ¨å•ä½“ç»“æ„çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ MySQL æ•°æ®åº“çš„ä¸»é”®è‡ªå¢æ¥ä¸ºæˆ‘ä»¬çš„æ•°æ®è®¾ç½®å”¯ä¸€æ ‡è¯† IDï¼Œä½†æ˜¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œå•ä¸ªæ•°æ®åº“çš„ååé‡æˆä¸ºæ•´ä¸ªåº”ç”¨çš„æ€§èƒ½ç“¶é¢ˆï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­å»ºæ•°æ®åº“é›†ç¾¤æ¥æå‡æ•°æ®åº“çš„æ€§èƒ½ï¼Œæ­¤æ—¶å¦‚æœè¿˜ä½¿ç”¨ MySQL çš„ä¸»é”®è‡ªå¢æ¥è®¾ç½®æ•°æ® ID çš„è¯ï¼Œå°±ä¼šå‡ºç°é‡å¤çš„ IDï¼Œè¿™æ ·å°±ä¼šå‡ºç°ä¸»é”®å†²çªçš„æƒ…å†µã€‚</p><p>å¦‚æœä½¿ç”¨åˆ†å¸ƒå¼çš„å…¨å±€å”¯ä¸€ ID å°±ä¸ç”¨æ‹…å¿ƒä¼šå‡ºç°è¿™ä¸ªé—®é¢˜äº†</p><h2 id="1-2-å®ç°æ–¹å¼"><a href="#1-2-å®ç°æ–¹å¼" class="headerlink" title="1.2 å®ç°æ–¹å¼"></a>1.2 å®ç°æ–¹å¼</h2><h3 id="1-2-1-UUIDå®ç°åˆ†å¸ƒå¼-ID"><a href="#1-2-1-UUIDå®ç°åˆ†å¸ƒå¼-ID" class="headerlink" title="1.2.1 UUIDå®ç°åˆ†å¸ƒå¼ ID"></a>1.2.1 <strong>UUIDå®ç°åˆ†å¸ƒå¼ ID</strong></h3><ul><li>åœ¨ Java ä¸­å¯ä»¥ä½¿ç”¨ java.util.UUID çš„ randomUUID() æ–¹æ³•æ¥è·å¾—ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">java.util.UUID.randomUUID().toString();<br></code></pre></td></tr></table></figure><p>UUID å¯ä»¥åœ¨æœ¬åœ°ç”Ÿæˆï¼Œç”Ÿæˆé€Ÿåº¦å¿«ï¼Œä¸ä¾èµ–ç½‘ç»œå’Œå…¶å®ƒæœåŠ¡ï¼Œä½†æ˜¯ UUID æ²¡æœ‰å¯ä»¥è¯†åˆ«çš„ç‰¹ç‚¹ï¼Œä¹Ÿæ²¡æœ‰é¡ºåºæ€§ã€‚</p><h3 id="1-2-2-Rediså®ç°åˆ†å¸ƒå¼-ID"><a href="#1-2-2-Rediså®ç°åˆ†å¸ƒå¼-ID" class="headerlink" title="1.2.2 Rediså®ç°åˆ†å¸ƒå¼ ID"></a>1.2.2 <strong>Rediså®ç°åˆ†å¸ƒå¼ ID</strong></h3><p>ä½¿ç”¨ Redis çš„ Incr å‘½ä»¤æ¥æŠŠ &lt;key,value&gt; ä¸­ key çš„æ•°å€¼åŠ  1 å¹¶è¿”å›ï¼Œå¦‚æœè¿™ä¸ª key ä¸å­˜åœ¨ï¼Œåˆ™ key å€¼ä¼šè¢«åˆå§‹åŒ–ä¸º 0ï¼Œå†æ‰§è¡Œ Incr å‘½ä»¤æ¥è¿›è¡ŒåŠ  1 æ“ä½œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä½¿ç”¨ incr(key) æ¥è®© key åŠ  1</span><br><span class="hljs-keyword">long</span> id = jedis.incr(<span class="hljs-string">&quot;id&quot;</span>);<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ Redis çš„æ–¹å¼ç”Ÿæˆåˆ†å¸ƒå¼ ID éœ€è¦ä¾èµ– Redis æœåŠ¡ï¼Œè¿˜è¦ä¿è¯ Redis çš„é«˜å¯ç”¨ï¼Œå¦åˆ™ Redis æœåŠ¡å®•æœºä¼šå½±å“æ•´ä¸ªåº”ç”¨ã€‚</p><h3 id="1-2-3-Zookeeper-å®ç°åˆ†å¸ƒå¼-ID"><a href="#1-2-3-Zookeeper-å®ç°åˆ†å¸ƒå¼-ID" class="headerlink" title="1.2.3 Zookeeper å®ç°åˆ†å¸ƒå¼ ID"></a>1.2.3 Zookeeper å®ç°åˆ†å¸ƒå¼ ID</h3><p>åœ¨ Zookeeper ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Zookeeper çš„ é¡ºåºèŠ‚ç‚¹æ¥å®Œæˆåˆ†å¸ƒå¼ ID çš„ç”Ÿæˆ</p><p>é¡ºåºèŠ‚ç‚¹ï¼Œåœ¨ Zookeeper å®¢æˆ·ç«¯åˆ›å»ºé¡ºåºèŠ‚ç‚¹æ—¶ï¼ŒZookeeper ä¼šæ ¹æ®åˆ›å»ºçš„æ—¶é—´é¡ºåºï¼Œåœ¨èŠ‚ç‚¹åç§°åæ·»åŠ  10 ä½çš„é¡ºåºç¼–å·ã€‚</p><h1 id="2-Zookeeper-å®ç°è´Ÿè½½å‡è¡¡"><a href="#2-Zookeeper-å®ç°è´Ÿè½½å‡è¡¡" class="headerlink" title="2  Zookeeper å®ç°è´Ÿè½½å‡è¡¡"></a>2  Zookeeper å®ç°è´Ÿè½½å‡è¡¡</h1><h2 id="2-1-ä¸ºä»€ä¹ˆéœ€è¦åšè´Ÿè½½å‡è¡¡"><a href="#2-1-ä¸ºä»€ä¹ˆéœ€è¦åšè´Ÿè½½å‡è¡¡" class="headerlink" title="2.1 ä¸ºä»€ä¹ˆéœ€è¦åšè´Ÿè½½å‡è¡¡"></a>2.1 ä¸ºä»€ä¹ˆéœ€è¦åšè´Ÿè½½å‡è¡¡</h2><p>åœ¨åˆ†å¸ƒå¼çš„ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨é›†ç¾¤éƒ¨ç½²çš„æ–¹å¼æ¥æé«˜æŸä¸ªæœåŠ¡çš„å¯ç”¨æ€§ï¼Œä¸ºäº†è®©é«˜å¹¶å‘çš„è¯·æ±‚èƒ½å¤Ÿå¹³å‡çš„åˆ†é…åˆ°é›†ç¾¤ä¸­çš„æ¯ä¸€ä¸ªæœåŠ¡ï¼Œé¿å…æœ‰äº›æœåŠ¡å‹åŠ›è¿‡å¤§ï¼Œè€Œæœ‰äº›æœåŠ¡å¤„äºç©ºé—²çŠ¶æ€è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦åˆ¶å®šä¸€äº›è§„åˆ™æ¥æŠŠè¯·æ±‚è¿›è¡Œè·¯ç”±ï¼Œè¿™ç§åˆ†é…è¯·æ±‚çš„åšæ³•å°±å«åšè´Ÿè½½å‡è¡¡ï¼Œè·¯ç”±è¯·æ±‚çš„è§„åˆ™å°±æ˜¯è´Ÿè½½å‡è¡¡çš„ç­–ç•¥ã€‚</p><h2 id="2-2-è´Ÿè½½å‡è¡¡çš„ç­–ç•¥"><a href="#2-2-è´Ÿè½½å‡è¡¡çš„ç­–ç•¥" class="headerlink" title="2.2 è´Ÿè½½å‡è¡¡çš„ç­–ç•¥"></a>2.2 è´Ÿè½½å‡è¡¡çš„ç­–ç•¥</h2><h3 id="3-2-1-è½®è¯¢ç­–ç•¥"><a href="#3-2-1-è½®è¯¢ç­–ç•¥" class="headerlink" title="3.2.1 è½®è¯¢ç­–ç•¥"></a>3.2.1 <strong>è½®è¯¢ç­–ç•¥</strong></h3><ul><li>è½®è¯¢ç­–ç•¥å°±æ˜¯æŒ‰ç…§é›†ç¾¤çš„æœåŠ¡åˆ—è¡¨çš„é¡ºåºï¼Œä¾æ¬¡è¿›è¡Œè¯·æ±‚çš„åˆ†é…ï¼Œç›´åˆ°åˆ—è¡¨ä¸­æ‰€æœ‰çš„æœåŠ¡éƒ½åˆ†é…äº†ä¸€æ¬¡è¯·æ±‚ï¼Œå°±å®Œæˆäº†ä¸€è½®çš„è¯·æ±‚åˆ†é…ï¼Œç„¶åå†ä»ç¬¬ä¸€ä¸ªæœåŠ¡å¼€å§‹åˆ†é…è¯·æ±‚ã€‚</li><li>è½®è¯¢ç­–ç•¥æ˜¯å¾ˆå¤šè´Ÿè½½å‡è¡¡æŠ€æœ¯çš„é»˜è®¤ç­–ç•¥ï¼Œè¿™æ ·çš„æ–¹å¼ä¿è¯äº†çš„æ¯ä¸ªæœåŠ¡æ‰€æ‰¿å—çš„è¯·æ±‚å‹åŠ›æ˜¯å¹³å‡çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæœåŠ¡åˆ—è¡¨æŒ‰ç…§é¡ºåºæ”¾åˆ°ä¸€ä¸ªæ•°ç»„æ¥å¾ªç¯åˆ†é…è¯·æ±‚ã€‚</li></ul><h3 id="3-2-2-éšæœºç­–ç•¥"><a href="#3-2-2-éšæœºç­–ç•¥" class="headerlink" title="3.2.2 éšæœºç­–ç•¥"></a>3.2.2 <strong>éšæœºç­–ç•¥</strong></h3><ul><li>éšæœºç­–ç•¥å°±æ˜¯æ ¹æ®éšæœºç®—æ³•æŠŠè¯·æ±‚éšæœºçš„åˆ†é…ç»™æœåŠ¡åˆ—è¡¨ä¸­çš„ä»»æ„ä¸€ä¸ªæœåŠ¡ã€‚</li><li>éšæœºç­–ç•¥çš„å®ç°æ–¹å¼ï¼šæˆ‘ä»¬å¯ä»¥æŠŠæœåŠ¡åˆ—è¡¨æ”¾åˆ°ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åæ ¹æ®æ•°ç»„çš„é•¿åº¦æ¥è·å–éšæœºæ•°ï¼Œå–åˆ°çš„éšæœºæ•°å°±æ˜¯æœåŠ¡åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•ï¼Œæ ¹æ®è¿™ä¸ªç´¢å¼•ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°æœåŠ¡åœ°å€æ¥å‘é€è¯·æ±‚äº†</li></ul><h3 id="3-2-3-ä¸€è‡´æ€§å“ˆå¸Œç­–ç•¥"><a href="#3-2-3-ä¸€è‡´æ€§å“ˆå¸Œç­–ç•¥" class="headerlink" title="3.2.3 ä¸€è‡´æ€§å“ˆå¸Œç­–ç•¥"></a>3.2.3 <strong>ä¸€è‡´æ€§å“ˆå¸Œç­–ç•¥</strong></h3><ul><li>ä¸€è‡´æ€§å“ˆå¸Œç­–ç•¥çš„å®ç°æ–¹å¼ï¼šæˆ‘ä»¬å…ˆæŠŠæœåŠ¡åˆ—è¡¨ä¸­çš„åœ°å€è¿›è¡Œå“ˆå¸Œè®¡ç®—ï¼ŒæŠŠè®¡ç®—åçš„å€¼æ”¾åˆ°å“ˆå¸Œç¯ä¸Šï¼Œæ¥æ”¶åˆ°è¯·æ±‚åï¼Œæ ¹æ®è¯·æ±‚çš„å›ºå®šå±æ€§å€¼æ¥è¿›è¡Œå“ˆå¸Œè®¡ç®—ï¼Œç„¶åæ ¹æ®è¯·æ±‚çš„å“ˆå¸Œå€¼åœ¨å“ˆå¸Œç¯ä¸Šé¡ºæ—¶é’ˆå¯»æ‰¾æœåŠ¡åœ°å€çš„å“ˆå¸Œå€¼ï¼Œå¯»æ‰¾åˆ°å“ªä¸ªæœåŠ¡åœ°å€çš„å“ˆå¸Œå€¼ï¼Œå°±æŠŠè¯·æ±‚åˆ†é…ç»™å“ªä¸ªæœåŠ¡ã€‚</li></ul><h3 id="3-2-4-åŠ æƒè½®è¯¢ç­–ç•¥"><a href="#3-2-4-åŠ æƒè½®è¯¢ç­–ç•¥" class="headerlink" title="3.2.4 åŠ æƒè½®è¯¢ç­–ç•¥"></a>3.2.4 <strong>åŠ æƒè½®è¯¢ç­–ç•¥</strong></h3><p>åŠ æƒè½®è¯¢ç­–ç•¥å°±æ˜¯åœ¨è½®è¯¢ç­–ç•¥çš„åŸºç¡€ä¸Šï¼Œå¯¹ Server åœ°å€è¿›è¡ŒåŠ æƒå¤„ç†ï¼Œé™¤äº†æŒ‰ç…§æœåŠ¡åœ°å€åˆ—è¡¨çš„é¡ºåºæ¥åˆ†é…è¯·æ±‚å¤–ï¼Œè¿˜è¦æŒ‰ç…§æƒé‡å¤§å°æ¥å†³å®šè¯·æ±‚çš„åˆ†é…æ¬¡æ•°ã€‚åŠ æƒçš„ç›®çš„æ˜¯ä¸ºäº†è®©æ€§èƒ½å’Œç½‘ç»œè¾ƒå¥½çš„æœåŠ¡å¤šæ‰¿æ‹…è¯·æ±‚åˆ†é…çš„å‹åŠ›ã€‚</p><p>æ¯”å¦‚ Server_1 çš„æƒé‡æ˜¯ 3ï¼ŒServer_2 çš„æƒé‡æ˜¯ 2ï¼ŒServer_3 çš„æƒé‡æ˜¯ 1ï¼Œé‚£ä¹ˆåœ¨è¿›è¡Œè¯·æ±‚åˆ†é…æ—¶ï¼ŒServer_1 ä¼šè¢«åˆ†é… 3 æ¬¡è¯·æ±‚ï¼ŒServer_2 ä¼šè¢«åˆ†é… 2 æ¬¡è¯·æ±‚ï¼ŒServer_3 ä¼šè¢«åˆ†é… 1 æ¬¡è¯·æ±‚ï¼Œå°±è¿™æ ·å®Œæˆä¸€è½®è¯·æ±‚çš„åˆ†é…ï¼Œç„¶åå†ä» Server_1 å¼€å§‹è¿›è¡Œåˆ†é…ã€‚</p><h3 id="3-2-5-åŠ æƒéšæœºç­–ç•¥"><a href="#3-2-5-åŠ æƒéšæœºç­–ç•¥" class="headerlink" title="3.2.5 åŠ æƒéšæœºç­–ç•¥"></a>3.2.5 <strong>åŠ æƒéšæœºç­–ç•¥</strong></h3><p>åŠ æƒéšæœºç­–ç•¥å°±æ˜¯åœ¨éšæœºç­–ç•¥çš„åŸºç¡€ä¸Šï¼Œå¯¹ Server åœ°å€è¿›è¡ŒåŠ æƒå¤„ç†ï¼ŒServer åœ°å€çš„åŠ æƒæœ‰å¤šå°‘ï¼Œé‚£ä¹ˆ Server åœ°å€çš„æ•°ç»„ä¸­çš„åœ°å€å°±ä¼šæœ‰å‡ ä¸ªï¼Œç„¶åå†ä»è¿™ä¸ªæ•°ç»„ä¸­è¿›è¡Œéšæœºé€‰å€ã€‚</p><h3 id="3-2-6-æœ€å°è¿æ¥æ•°ç­–ç•¥"><a href="#3-2-6-æœ€å°è¿æ¥æ•°ç­–ç•¥" class="headerlink" title="3.2.6 æœ€å°è¿æ¥æ•°ç­–ç•¥"></a>3.2.6 <strong>æœ€å°è¿æ¥æ•°ç­–ç•¥</strong></h3><p>æœ€å°è¿æ¥æ•°ç­–ç•¥ï¼Œå°±æ˜¯æ ¹æ®å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¼šè¯æ•°é‡æ¥å†³å®šè¯·æ±‚çš„åˆ†é…æƒ…å†µï¼Œå®ƒä¼šæŠŠè¯·æ±‚åˆ†é…åˆ°ä¼šè¯æ•°é‡å°çš„æœåŠ¡ï¼Œä¼šè¯çš„æ•°é‡è¶Šå°‘ï¼Œä¹Ÿèƒ½è¯´æ˜æœåŠ¡çš„æ€§èƒ½å’Œç½‘ç»œè¾ƒå¥½ã€‚</p><h2 id="å®ç°æ–¹å¼"><a href="#å®ç°æ–¹å¼" class="headerlink" title="å®ç°æ–¹å¼"></a>å®ç°æ–¹å¼</h2><p>æŠŠZooKeeperä½œä¸ºä¸€ä¸ªæœåŠ¡çš„<a href="https://cloud.tencent.com/product/tse?from=10680">æ³¨å†Œä¸­å¿ƒ</a>ï¼Œåœ¨å…¶ä¸­ç™»è®°æ¯ä¸ªæœåŠ¡ï¼Œæ¯å°æœåŠ¡å™¨çŸ¥é“è‡ªå·±æ˜¯å±äºå“ªä¸ªæœåŠ¡ï¼Œåœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œè‡ªå·±å‘æ‰€å±æœåŠ¡è¿›è¡Œç™»è®°ï¼Œè¿™æ ·ï¼Œä¸€ä¸ªæ ‘å½¢çš„æœåŠ¡ç»“æ„å°±å‘ˆç°å‡ºæ¥äº†</p><p>æœåŠ¡çš„è°ƒç”¨è€…åˆ°æ³¨å†Œä¸­å¿ƒé‡Œé¢æŸ¥æ‰¾ï¼šèƒ½æä¾›æ‰€éœ€æœåŠ¡çš„æœåŠ¡å™¨åˆ—è¡¨ï¼Œç„¶åè‡ªå·±æ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œä»ä¸­é€‰å–ä¸€å°æœåŠ¡å™¨è¿›è¡Œè¿æ¥</p><h1 id="3-Zookeeper-å®ç°é…ç½®ä¸­å¿ƒ"><a href="#3-Zookeeper-å®ç°é…ç½®ä¸­å¿ƒ" class="headerlink" title="3 Zookeeper å®ç°é…ç½®ä¸­å¿ƒ"></a>3 Zookeeper å®ç°é…ç½®ä¸­å¿ƒ</h1><p>é…ç½®ä¸­å¿ƒæ¥æ›´æ–°é…ç½®çš„æ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ç”±é…ç½®ä¸­å¿ƒçš„é…ç½®æ›´æ–°åå‘æœåŠ¡æ¨é€æ›´æ–°çš„é…ç½®ï¼Œå¦ä¸€ç§æ˜¯æœåŠ¡å®šæ—¶è½®è¯¢çš„æ–¹å¼çš„å»é…ç½®ä¸­å¿ƒæ‹‰å–é…ç½®ï¼Œå‘ç°é…ç½®ä¸­å¿ƒçš„é…ç½®è¢«æ›´æ–°å°±æ›´æ–°è‡ªå·±çš„é…ç½®ã€‚</p><p>Zookeeper å®ç°é…ç½®ä¸­å¿ƒçš„æ–¹å¼ï¼šæœåŠ¡æŠŠè‡ªå·±çš„é…ç½®ä¿¡æ¯å­˜å‚¨åˆ° Zookeeper èŠ‚ç‚¹çš„ data ä¸Šï¼Œå¹¶ä¸”å¯¹è¿™ä¸ªèŠ‚ç‚¹å¼€å¯ Watch ç›‘å¬ï¼Œåªè¦è¿™ä¸ªèŠ‚ç‚¹çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼ŒZookeeper å°±ä¼šæŠŠè¿™ä¸ªæ¶ˆæ¯æ¨é€ç»™æœåŠ¡ï¼ŒæœåŠ¡åœ¨å›è°ƒäº‹ä»¶ä¸­å»è·å–è¯¥èŠ‚ç‚¹çš„æ•°æ®ï¼Œç„¶åä½¿ç”¨æ–°çš„æ•°æ®æ›´æ–°è‡ªå·±çš„é…ç½®ã€‚é‚£ä¹ˆæ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬å°±å¼€å§‹ä½¿ç”¨ Zookeeper æ¥å®ç°é…ç½®ä¸­å¿ƒã€‚</p><h1 id="4-Zookeeper-å®ç°åˆ†å¸ƒå¼é”"><a href="#4-Zookeeper-å®ç°åˆ†å¸ƒå¼é”" class="headerlink" title="4 Zookeeper å®ç°åˆ†å¸ƒå¼é”"></a>4 Zookeeper å®ç°åˆ†å¸ƒå¼é”</h1><p><a href="https://pyr9.github.io/Zookeeper%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/">Zookeeperå®ç°åˆ†å¸ƒå¼é” - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p><h1 id="5-Zookeeper-å®ç°æ³¨å†Œä¸­å¿ƒ"><a href="#5-Zookeeper-å®ç°æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="5 Zookeeper å®ç°æ³¨å†Œä¸­å¿ƒ"></a>5 Zookeeper å®ç°æ³¨å†Œä¸­å¿ƒ</h1><p><a href="https://pyr9.github.io/%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83/">æ³¨å†Œä¸­å¿ƒ - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p>]]></content>
    
    
    <categories>
      
      <category>Zookeeper</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>zookeeperèŠ‚ç‚¹ä»‹ç»</title>
    <link href="/zookeeper%E8%8A%82%E7%82%B9%E4%BB%8B%E7%BB%8D/"/>
    <url>/zookeeper%E8%8A%82%E7%82%B9%E4%BB%8B%E7%BB%8D/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Zookeeper-æ•°æ®æ¨¡å‹"><a href="#1-Zookeeper-æ•°æ®æ¨¡å‹" class="headerlink" title="1 Zookeeper æ•°æ®æ¨¡å‹"></a>1 Zookeeper æ•°æ®æ¨¡å‹</h1><ul><li>Zookeeper æ•°æ®æ¨¡å‹çš„ç»“æ„æ˜¯åŸºäºèŠ‚ç‚¹çš„ï¼Œæˆ‘ä»¬æŠŠè¿™ç§èŠ‚ç‚¹å«åš <strong>Znode</strong> ã€‚</li><li>èŠ‚ç‚¹ä¹‹ä¸‹å¯ä»¥åŒ…å«å­èŠ‚ç‚¹ï¼Œè¿™ç§ç»“æ„å’Œæ•°æ®ç»“æ„ä¸­çš„æ ‘ç±»ä¼¼ï¼Œä¹Ÿå’Œæ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•ç±»ä¼¼ã€‚</li></ul><ul><li>æ¯ä¸ªèŠ‚ç‚¹æ‹¥æœ‰å”¯ä¸€çš„è·¯å¾„path.</li></ul><img src="https://tva1.sinaimg.cn/large/008i3skNly1gycegg0aihj30u00v0wgk.jpg" style="zoom: 33%;" /><h1 id="2-èŠ‚ç‚¹çš„ç»“æ„"><a href="#2-èŠ‚ç‚¹çš„ç»“æ„" class="headerlink" title="2 èŠ‚ç‚¹çš„ç»“æ„"></a>2 èŠ‚ç‚¹çš„ç»“æ„</h1><ul><li><strong>path</strong>:å”¯ä¸€è·¯å¾„ </li><li><strong>childNode</strong>ï¼šå­èŠ‚ç‚¹</li><li><strong>stat</strong>:çŠ¶æ€å±æ€§:å³pathå¯¹åº”çš„å€¼</li><li><strong>type</strong>:èŠ‚ç‚¹ç±»å‹</li></ul><h1 id="3-èŠ‚ç‚¹ç±»å‹"><a href="#3-èŠ‚ç‚¹ç±»å‹" class="headerlink" title="3 èŠ‚ç‚¹ç±»å‹"></a>3 èŠ‚ç‚¹ç±»å‹</h1><table><thead><tr><th align="left">ç±»å‹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">PERSISTENT</td><td align="left">æŒä¹…èŠ‚ç‚¹</td></tr><tr><td align="left">PERSISTENT_SEQUENTIAL</td><td align="left">æŒä¹…åºå·èŠ‚ç‚¹</td></tr><tr><td align="left">EPHEMERAL</td><td align="left">ä¸´æ—¶èŠ‚ç‚¹(ä¸å¯åœ¨æ‹¥æœ‰å­èŠ‚ç‚¹)</td></tr><tr><td align="left">EPHEMERAL_SEQUENTIAL</td><td align="left">ä¸´æ—¶åºå·èŠ‚ç‚¹(ä¸å¯åœ¨æ‹¥æœ‰å­èŠ‚ç‚¹)</td></tr></tbody></table><h2 id="3-1-PERSISTENTï¼ˆæŒä¹…èŠ‚ç‚¹ï¼‰"><a href="#3-1-PERSISTENTï¼ˆæŒä¹…èŠ‚ç‚¹ï¼‰" class="headerlink" title="3.1 PERSISTENTï¼ˆæŒä¹…èŠ‚ç‚¹ï¼‰"></a>3.1 PERSISTENTï¼ˆæŒä¹…èŠ‚ç‚¹ï¼‰</h2><ul><li>æŒä¹…åŒ–ä¿å­˜çš„èŠ‚ç‚¹ï¼Œä¹Ÿæ˜¯é»˜è®¤åˆ›å»ºçš„</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-operator">/</span>test<br></code></pre></td></tr></table></figure><h2 id="3-2-PERSISTENT-SEQUENTIAL-æŒä¹…åºå·èŠ‚ç‚¹"><a href="#3-2-PERSISTENT-SEQUENTIAL-æŒä¹…åºå·èŠ‚ç‚¹" class="headerlink" title="3.2 PERSISTENT_SEQUENTIAL(æŒä¹…åºå·èŠ‚ç‚¹)"></a>3.2 PERSISTENT_SEQUENTIAL(æŒä¹…åºå·èŠ‚ç‚¹)</h2><p>åˆ›å»ºæ—¶zookeeper ä¼šåœ¨è·¯å¾„ä¸ŠåŠ ä¸Šåºå·ä½œä¸ºåç¼€ã€‚éå¸¸é€‚åˆç”¨äºåˆ†å¸ƒå¼é”ã€åˆ†å¸ƒå¼é€‰ä¸¾ç­‰åœºæ™¯ã€‚åˆ›å»ºæ—¶æ·»åŠ  -s å‚æ•°å³å¯ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>s  <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>seq<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">13</span>] <span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>s <span class="hljs-operator">/</span>temp<br>Created <span class="hljs-operator">/</span>temp0000000004<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">14</span>] <span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>s <span class="hljs-operator">/</span>temp<br>Created <span class="hljs-operator">/</span>temp0000000005<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">15</span>] <span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>s <span class="hljs-operator">/</span>temp<br>Created <span class="hljs-operator">/</span>temp0000000006<br></code></pre></td></tr></table></figure><h2 id="3-3-EPHEMERALï¼ˆä¸´æ—¶èŠ‚ç‚¹ï¼‰"><a href="#3-3-EPHEMERALï¼ˆä¸´æ—¶èŠ‚ç‚¹ï¼‰" class="headerlink" title="3.3 EPHEMERALï¼ˆä¸´æ—¶èŠ‚ç‚¹ï¼‰"></a>3.3 EPHEMERALï¼ˆä¸´æ—¶èŠ‚ç‚¹ï¼‰</h2><ul><li>åªå­˜åœ¨äºå½“å‰ä¼šè¯ï¼Œå½“å¯¹è¯æ–­å¼€åä¼šè¢«åˆ é™¤ã€‚åˆ›å»ºçš„æ—¶å€™å¢åŠ  -e</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>e <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>seq<br></code></pre></td></tr></table></figure><ul><li>é€‚ç”¨äºå¿ƒè·³ï¼ŒæœåŠ¡å‘ç°ç­‰åœºæ™¯ã€‚å¦‚ä¸‹å›¾å½“node1æŒ‚æ‰äº†ï¼Œå®ƒzookeeper1ä¸­åˆ›å»ºçš„ä¸´æ—¶èŠ‚ç‚¹å’Œå…¶å­˜å‚¨çš„æ•°æ®å°±ä¼šå°±ä¼šè¢«åˆ é™¤ï¼Œzookeeper1å°±çŸ¥é“node1æŒ‚æ‰äº†ã€‚</li></ul><img src="/Users/panyurou/Library/Application Support/typora-user-images/image-20220116230200083.png" alt="image-20220116230200083" style="zoom: 33%;" /><h2 id="3-4-EPHEMERAL-SEQUENTIALï¼ˆä¸´æ—¶åºå·èŠ‚ç‚¹ï¼‰"><a href="#3-4-EPHEMERAL-SEQUENTIALï¼ˆä¸´æ—¶åºå·èŠ‚ç‚¹ï¼‰" class="headerlink" title="3.4 EPHEMERAL_SEQUENTIALï¼ˆä¸´æ—¶åºå·èŠ‚ç‚¹ï¼‰"></a>3.4 EPHEMERAL_SEQUENTIALï¼ˆä¸´æ—¶åºå·èŠ‚ç‚¹ï¼‰</h2><p>ä¸æŒä¹…åºå·èŠ‚ç‚¹ç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºEPHEMERAL_SEQUENTIALæ˜¯ä¸´æ—¶çš„ä¼šåœ¨ä¼šè¯æ–­å¼€ååˆ é™¤ã€‚åˆ›å»ºæ—¶æ·»åŠ  -e -s </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>e <span class="hljs-operator">-</span>s <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>seq<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">2</span>] <span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>e <span class="hljs-operator">-</span>s <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>c1<br>Created <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>c10000000000<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">3</span>] <span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>e <span class="hljs-operator">-</span>s <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>c1<br>Created <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>c10000000001<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">4</span>] <span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>e <span class="hljs-operator">-</span>s <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>c1<br>Created <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>c10000000002<br></code></pre></td></tr></table></figure><h1 id="4-èŠ‚ç‚¹å±æ€§"><a href="#4-èŠ‚ç‚¹å±æ€§" class="headerlink" title="4 èŠ‚ç‚¹å±æ€§"></a>4 èŠ‚ç‚¹å±æ€§</h1><ul><li>æŸ¥çœ‹èŠ‚ç‚¹å±æ€§</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">stat <span class="hljs-operator">/</span>temp<br></code></pre></td></tr></table></figure><ul><li>å±æ€§è¯´æ˜</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql">cZxid <span class="hljs-operator">=</span> <span class="hljs-number">0x2</span>   #åˆ›å»ºèŠ‚ç‚¹çš„äº‹åŠ¡ID<br>ctime <span class="hljs-operator">=</span> Mon Jan <span class="hljs-number">17</span> <span class="hljs-number">21</span>:<span class="hljs-number">09</span>:<span class="hljs-number">16</span> CST <span class="hljs-number">2022</span> #åˆ›å»ºèŠ‚ç‚¹çš„æ—¶é—´<br>mZxid <span class="hljs-operator">=</span> <span class="hljs-number">0x2</span> #ä¿®æ”¹å½“å‰èŠ‚ç‚¹æ•°æ®çš„äº‹åŠ¡ID<br>mtime <span class="hljs-operator">=</span> Mon Jan <span class="hljs-number">17</span> <span class="hljs-number">21</span>:<span class="hljs-number">09</span>:<span class="hljs-number">16</span> CST <span class="hljs-number">2022</span> #æœ€åä¿®æ”¹æ—¶é—´<br>pZxid <span class="hljs-operator">=</span> <span class="hljs-number">0x5</span> #å­èŠ‚ç‚¹å˜æ›´ï¼ˆåŒ…æ‹¬è‡ªèŠ‚ç‚¹çš„åˆ é™¤å’Œå¢åŠ ï¼Œä¸åŒ…æ‹¬ä¿®æ”¹ï¼‰çš„äº‹åŠ¡ID<br>cversion <span class="hljs-operator">=</span> <span class="hljs-number">3</span>  #è¿™è¡¨ç¤ºå¯¹æ­¤znodeçš„å­èŠ‚ç‚¹è¿›è¡Œçš„æ›´æ”¹æ¬¡æ•°ï¼ŒåªåŒ…æ‹¬è‡ªèŠ‚ç‚¹çš„åˆ é™¤å’Œå¢åŠ <br>dataVersion <span class="hljs-operator">=</span> <span class="hljs-number">0</span> #æ•°æ®ç‰ˆæœ¬ï¼Œå½“å‰èŠ‚ç‚¹æ•°æ®å˜æ›´æ¬¡æ•°<br>aclVersion <span class="hljs-operator">=</span> <span class="hljs-number">0</span> #æƒé™ç‰ˆæœ¬ï¼Œå˜æ›´æ¬¡æ•°<br>ephemeralOwner <span class="hljs-operator">=</span> <span class="hljs-number">0x0</span> #ä¸´æ—¶èŠ‚ç‚¹æ‰€å±ä¼šè¯IDï¼Œæ°¸ä¹…èŠ‚ç‚¹å€¼ä¸º<span class="hljs-number">0x0</span><br>dataLength <span class="hljs-operator">=</span> <span class="hljs-number">0</span> #æ•°æ®é•¿åº¦<br>numChildren <span class="hljs-operator">=</span> <span class="hljs-number">3</span> #å­èŠ‚ç‚¹æ•°(ä¸åŒ…æ‹¬å­å­èŠ‚ç‚¹)<br></code></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h1 id="5-Znode-èŠ‚ç‚¹çš„æ“ä½œ"><a href="#5-Znode-èŠ‚ç‚¹çš„æ“ä½œ" class="headerlink" title="5 Znode èŠ‚ç‚¹çš„æ“ä½œ"></a>5 Znode èŠ‚ç‚¹çš„æ“ä½œ</h1><h2 id="5-1-åˆ›å»ºèŠ‚ç‚¹ï¼š-create"><a href="#5-1-åˆ›å»ºèŠ‚ç‚¹ï¼š-create" class="headerlink" title="5.1 åˆ›å»ºèŠ‚ç‚¹ï¼š create"></a>5.1 <strong>åˆ›å»ºèŠ‚ç‚¹ï¼š</strong> <code>create</code></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªæŒä¹…èŠ‚ç‚¹</span><br>create /persistent_node<br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªæŒä¹…çš„é¡ºåºèŠ‚ç‚¹</span><br>create -s /persistent_sequential_node<br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªä¸´æ—¶èŠ‚ç‚¹</span><br>create -e /ephemeral_node<br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„é¡ºåºèŠ‚ç‚¹</span><br>create -s -e /ephemeral_sequential_node<br><br><br>ä»£ç å—12345678<br></code></pre></td></tr></table></figure><p>- </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"># åˆ›å»ºä¸€ä¸ªæŒä¹…èŠ‚ç‚¹<br>create /persistent_node<br># åˆ›å»ºä¸€ä¸ªæŒä¹…çš„é¡ºåºèŠ‚ç‚¹<br>create -s /persistent_sequential_node<br># åˆ›å»ºä¸€ä¸ªä¸´æ—¶èŠ‚ç‚¹<br>create -e /ephemeral_node<br># åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„é¡ºåºèŠ‚ç‚¹<br>create -s -e /ephemeral_sequential_node<br></code></pre></td></tr></table></figure><h2 id="5-2-åˆ é™¤èŠ‚ç‚¹ï¼š-delete"><a href="#5-2-åˆ é™¤èŠ‚ç‚¹ï¼š-delete" class="headerlink" title="5.2 åˆ é™¤èŠ‚ç‚¹ï¼š delete"></a>5.2 <strong>åˆ é™¤èŠ‚ç‚¹ï¼š</strong> <code>delete</code></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">delete /config/topics/test<br></code></pre></td></tr></table></figure><h2 id="5-3-è·å¾—ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®ï¼š-get"><a href="#5-3-è·å¾—ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®ï¼š-get" class="headerlink" title="5.3 è·å¾—ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®ï¼š get"></a>5.3 <strong>è·å¾—ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®ï¼š</strong> <code>get</code></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">get /persistent_node<br></code></pre></td></tr></table></figure><h2 id="5-4-è®¾ç½®ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®ï¼š"><a href="#5-4-è®¾ç½®ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®ï¼š" class="headerlink" title="5.4 è®¾ç½®ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®ï¼š"></a>5.4 <strong>è®¾ç½®ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®ï¼š</strong></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">set /brokers myNewData<br></code></pre></td></tr></table></figure><h2 id="5-5-è·å–å­èŠ‚ç‚¹ï¼š"><a href="#5-5-è·å–å­èŠ‚ç‚¹ï¼š" class="headerlink" title="5.5 è·å–å­èŠ‚ç‚¹ï¼š"></a>5.5 <strong>è·å–å­èŠ‚ç‚¹ï¼š</strong></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"># è·å–æ ¹èŠ‚ç‚¹ä¸‹çš„å­èŠ‚ç‚¹<br>ls /<br># æ ¹èŠ‚ç‚¹ä¸‹çš„å­èŠ‚ç‚¹æœ‰ zk-watcher-<span class="hljs-number">2</span>ï¼Œzookeeper<br>[zk-watcher-<span class="hljs-number">2</span>, zookeeper]<br></code></pre></td></tr></table></figure><h1 id="6-èŠ‚ç‚¹çš„ç›‘å¬"><a href="#6-èŠ‚ç‚¹çš„ç›‘å¬" class="headerlink" title="6 èŠ‚ç‚¹çš„ç›‘å¬"></a>6 èŠ‚ç‚¹çš„ç›‘å¬</h1><p>å®¢æˆ·æ·»åŠ  -w å‚æ•°å¯å®æ—¶ç›‘å¬èŠ‚ç‚¹ä¸å­èŠ‚ç‚¹çš„å˜åŒ–ï¼Œå¹¶ä¸”å®æ—¶æ”¶åˆ°é€šçŸ¥ã€‚éå¸¸é€‚ç”¨ä¿éšœåˆ†å¸ƒå¼æƒ…å†µä¸‹çš„æ•°æ®ä¸€è‡´æ€§ã€‚å…¶ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="left">å‘½ä»¤</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">ls -w path</td><td align="left">ç›‘å¬å­èŠ‚ç‚¹çš„å˜åŒ–ï¼ˆå¢ï¼Œåˆ ï¼‰</td></tr><tr><td align="left">get -w path</td><td align="left">ç›‘å¬èŠ‚ç‚¹æ•°æ®çš„å˜åŒ–</td></tr><tr><td align="left">stat -w path</td><td align="left">ç›‘å¬èŠ‚ç‚¹å±æ€§çš„å˜åŒ–</td></tr><tr><td align="left">printwatches on|off</td><td align="left">è§¦å‘ç›‘å¬åï¼Œæ˜¯å¦æ‰“å°ç›‘å¬äº‹ä»¶(é»˜è®¤on)</td></tr></tbody></table><h2 id="6-1-ç›‘å¬èŠ‚ç‚¹æ•°æ®çš„å˜åŒ–"><a href="#6-1-ç›‘å¬èŠ‚ç‚¹æ•°æ®çš„å˜åŒ–" class="headerlink" title="6.1 ç›‘å¬èŠ‚ç‚¹æ•°æ®çš„å˜åŒ–"></a>6.1 ç›‘å¬èŠ‚ç‚¹æ•°æ®çš„å˜åŒ–</h2><ul><li><p>step1ï¼šæ‰“å¼€å®¢æˆ·ç«¯A</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">get</span> <span class="hljs-operator">-</span>w  <span class="hljs-operator">/</span>temp<br></code></pre></td></tr></table></figure></li><li><p>Step2ï¼šæ‰“å¼€å®¢æˆ·ç«¯B:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> <span class="hljs-operator">/</span>temp &quot;aaa&quot;<br></code></pre></td></tr></table></figure></li><li><p>æ­¤æ—¶å®¢æˆ·ç«¯Aï¼Œå‡ºç°ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">8</span>] <span class="hljs-keyword">get</span> <span class="hljs-operator">-</span>w  <span class="hljs-operator">/</span>temp<br><span class="hljs-keyword">null</span><br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">9</span>]<br>WATCHER::<br><br>WatchedEvent state:SyncConnected type:NodeDataChanged path:<span class="hljs-operator">/</span>temp<br></code></pre></td></tr></table></figure></li><li><p>å†æ¬¡åœ¨å®¢æˆ·ç«¯Bè¾“å…¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> <span class="hljs-operator">/</span>temp &quot;ddd&quot;<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥å‘ç°ï¼Œå®¢æˆ·ç«¯Aæ²¡æœ‰æ”¶åˆ°ä»»ä½•é€šçŸ¥ï¼Œæ•…è¿™é‡Œçš„watchæ˜¯ä¸€æ¬¡æ€§çš„ï¼Œç¬¬äºŒæ¬¡è§¦å‘ä¸å†ç”Ÿæ•ˆã€‚</p></li></ul><h2 id="6-2-ç›‘å¬å­èŠ‚ç‚¹çš„å˜åŒ–"><a href="#6-2-ç›‘å¬å­èŠ‚ç‚¹çš„å˜åŒ–" class="headerlink" title="6.2 ç›‘å¬å­èŠ‚ç‚¹çš„å˜åŒ–"></a>6.2 ç›‘å¬å­èŠ‚ç‚¹çš„å˜åŒ–</h2><ul><li><p>step1ï¼šæ‰“å¼€å®¢æˆ·ç«¯A</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">ls <span class="hljs-operator">-</span>w  <span class="hljs-operator">/</span>temp<br></code></pre></td></tr></table></figure></li><li><p>Step2ï¼šæ‰“å¼€å®¢æˆ·ç«¯B:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>e <span class="hljs-operator">-</span>s <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>c1<br></code></pre></td></tr></table></figure></li><li><p>æ­¤æ—¶å®¢æˆ·ç«¯Aï¼Œå‡ºç°ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">9</span>] ls <span class="hljs-operator">-</span>w <span class="hljs-operator">/</span>temp<br>[c10000000000, c10000000001, c10000000002]<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">10</span>]<br>WATCHER::<br><br>WatchedEvent state:SyncConnected type:NodeChildrenChanged path:<span class="hljs-operator">/</span>temp<br></code></pre></td></tr></table></figure></li></ul><h1 id="7-Zookeeperæƒé™æ§åˆ¶"><a href="#7-Zookeeperæƒé™æ§åˆ¶" class="headerlink" title="7 Zookeeperæƒé™æ§åˆ¶"></a>7 Zookeeperæƒé™æ§åˆ¶</h1><ul><li>ACLå…¨ç§°ä¸ºAccess Control Listï¼ˆè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼‰ï¼Œç”¨äºæ§åˆ¶èµ„æºçš„è®¿é—®æƒé™ã€‚   </li><li>ZooKeeperä½¿ç”¨ACLæ¥æ§åˆ¶å¯¹å…¶znodeçš„é˜²é—®ã€‚</li><li>åŸºäº<code>scheme:id:permission</code>çš„æ–¹å¼è¿›è¡Œæƒé™æ§åˆ¶ã€‚schemeè¡¨ç¤ºæˆæƒæ¨¡å¼ã€idæ¨¡å¼å¯¹åº”å€¼ã€permissionå³å…·ä½“çš„å¢åˆ æ”¹æƒé™ä½ã€‚</li></ul><h2 id="7-1-scheme-æˆæƒæ¨¡å‹"><a href="#7-1-scheme-æˆæƒæ¨¡å‹" class="headerlink" title="7.1 scheme:æˆæƒæ¨¡å‹"></a>7.1 scheme:æˆæƒæ¨¡å‹</h2><table><thead><tr><th align="left">æ–¹æ¡ˆ</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">world</td><td align="left">å¼€æ”¾æ¨¡å¼ï¼Œworldè¡¨ç¤ºå…¨ä¸–ç•Œéƒ½å¯ä»¥è®¿é—®ï¼ˆè¿™æ˜¯é»˜è®¤è®¾ç½®ï¼‰</td></tr><tr><td align="left">ip</td><td align="left">ipæ¨¡å¼ï¼Œé™å®šå®¢æˆ·ç«¯IPé˜²é—®</td></tr><tr><td align="left">auth</td><td align="left">ç”¨æˆ·å¯†ç è®¤è¯æ¨¡å¼ï¼Œåªæœ‰åœ¨ä¼šè¯ä¸­æ·»åŠ äº†è®¤è¯æ‰å¯ä»¥é˜²é—®</td></tr><tr><td align="left">digest</td><td align="left">ä¸authç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºauthç”¨æ˜æ–‡å¯†ç ï¼Œè€Œdigest ç”¨sha-1+base64åŠ å¯†åçš„å¯†ç ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­digest æ›´å¸¸è§ã€‚</td></tr></tbody></table><h2 id="7-2-permissionæƒé™ä½"><a href="#7-2-permissionæƒé™ä½" class="headerlink" title="7.2 permissionæƒé™ä½"></a>7.2 <strong>permissionæƒé™ä½</strong></h2><table><thead><tr><th align="left">æƒé™ä½</th><th align="left">æƒé™</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">c</td><td align="left">CREATE</td><td align="left">å¯ä»¥åˆ›å»ºå­èŠ‚ç‚¹</td></tr><tr><td align="left">d</td><td align="left">DELETE</td><td align="left">å¯ä»¥åˆ é™¤å­èŠ‚ç‚¹ï¼ˆä»…ä¸‹ä¸€çº§èŠ‚ç‚¹ï¼‰</td></tr><tr><td align="left">r</td><td align="left">READ</td><td align="left">å¯ä»¥è¯»å–èŠ‚ç‚¹æ•°æ®åŠæ˜¾ç¤ºå­èŠ‚ç‚¹åˆ—è¡¨</td></tr><tr><td align="left">w</td><td align="left">WRITE</td><td align="left">å¯ä»¥è®¾ç½®èŠ‚ç‚¹æ•°æ®</td></tr><tr><td align="left">a</td><td align="left">ADMIN</td><td align="left">å¯ä»¥è®¾ç½®èŠ‚ç‚¹è®¿é—®æ§åˆ¶åˆ—è¡¨æƒé™</td></tr></tbody></table><h2 id="7-3-acl-ç›¸å…³å‘½ä»¤"><a href="#7-3-acl-ç›¸å…³å‘½ä»¤" class="headerlink" title="7.3 acl ç›¸å…³å‘½ä»¤"></a>7.3 acl ç›¸å…³å‘½ä»¤</h2><table><thead><tr><th align="left">å‘½ä»¤</th><th align="left">ä½¿ç”¨æ–¹å¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">getAcl</td><td align="left">getAcl <path></td><td align="left">è¯»å–ACLæƒé™</td></tr><tr><td align="left">setAcl</td><td align="left">setAcl <path> <acl></td><td align="left">è®¾ç½®ACLæƒé™</td></tr><tr><td align="left">addauth</td><td align="left">addauth <scheme> <auth></td><td align="left">æ·»åŠ è®¤è¯ç”¨æˆ·</td></tr></tbody></table><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><ul><li>world</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql">[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">11</span>] getAcl <span class="hljs-operator">/</span>temp<br><span class="hljs-string">&#x27;world,&#x27;</span>anyone<br>: cdrwa<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">12</span>] setAcl <span class="hljs-operator">/</span>temp world:anyone:rwa<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">13</span>] getAcl <span class="hljs-operator">/</span>temp<br><span class="hljs-string">&#x27;world,&#x27;</span>anyone<br>: rwa<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">14</span>] <span class="hljs-keyword">get</span> <span class="hljs-operator">/</span>temp<br>ddd<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">15</span>] <span class="hljs-keyword">set</span> <span class="hljs-operator">/</span>temp &quot;bbb&quot;<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">16</span>] <span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>e <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>t<br>Insufficient permission : <span class="hljs-operator">/</span>temp<span class="hljs-operator">/</span>t<br></code></pre></td></tr></table></figure><ul><li><p>IP</p><p>è¯­æ³•ï¼š setAcl <path> ip:&lt;ipåœ°å€|åœ°å€æ®µ&gt;:&lt;æƒé™ä½&gt;</p></li></ul><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">[zk: localhost<span class="hljs-function">:2181</span><span class="hljs-params">(CONNECTED)</span> 18] <span class="hljs-keyword">set</span>Acl <span class="hljs-string">/temp</span> ip<span class="hljs-function">:192.168.2.103</span><span class="hljs-function">:ra</span><br>[zk: localhost<span class="hljs-function">:2181</span><span class="hljs-params">(CONNECTED)</span> 19] getAcl <span class="hljs-string">/temp</span><br>Insufficient permission : <span class="hljs-string">/temp</span><br></code></pre></td></tr></table></figure><ul><li><p>auth</p><p>è¯­æ³•ï¼š </p><ol><li>setAcl <path> auth:&lt;ç”¨æˆ·å&gt;:&lt;å¯†ç &gt;:&lt;æƒé™ä½&gt;</li><li>addauth digest &lt;ç”¨æˆ·å&gt;:&lt;å¯†ç &gt;</li></ol></li><li><p>digest</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">âœ  <span class="hljs-operator">~</span> echo <span class="hljs-operator">-</span>n pyr:<span class="hljs-number">123456</span> <span class="hljs-operator">|</span> openssl dgst <span class="hljs-operator">-</span><span class="hljs-type">binary</span> <span class="hljs-operator">-</span>sha1 <span class="hljs-operator">|</span> openssl base64<br>zj9LbzdoKijw<span class="hljs-operator">/</span>kCo1pQJnXBFiq4<span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">zk: localhost:2181(CONNECTED) 28</span>] create /temp2<br>Created /temp2<br>[<span class="hljs-meta">zk: localhost:2181(CONNECTED) 30</span>] getAcl /temp2<br><span class="hljs-string">&#x27;world,&#x27;</span>anyone<br>: cdrwa<br>[<span class="hljs-meta">zk: localhost:2181(CONNECTED) 31</span>] setAcl /temp2 digest:pyr:zj9LbzdoKijw/kCo1pQJnXBFiq4=:rwa<br>[<span class="hljs-meta">zk: localhost:2181(CONNECTED) 32</span>] getAcl /temp2<br>Insufficient permission : /temp2<br>[<span class="hljs-meta">zk: 127.0.0.1:2181(CONNECTED) 45</span>] addauth digest pyr:<span class="hljs-number">123456</span><br>[<span class="hljs-meta">zk: 127.0.0.1:2181(CONNECTED) 46</span>] <span class="hljs-keyword">get</span> /temp2<br><span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <categories>
      
      <category>Zookeeper</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Zookeeperå®ç°åˆ†å¸ƒå¼é”</title>
    <link href="/Zookeeper%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/"/>
    <url>/Zookeeper%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/</url>
    
    <content type="html"><![CDATA[<h1 id="1åŸºäºZooKeeperçš„åˆ†å¸ƒå¼é”ã€‚"><a href="#1åŸºäºZooKeeperçš„åˆ†å¸ƒå¼é”ã€‚" class="headerlink" title="1åŸºäºZooKeeperçš„åˆ†å¸ƒå¼é”ã€‚"></a>1åŸºäºZooKeeperçš„åˆ†å¸ƒå¼é”ã€‚</h1>]]></content>
    
    
    <categories>
      
      <category>Zookeeper</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼é”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Rediså®ç°åˆ†å¸ƒå¼é”</title>
    <link href="/Redis%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/"/>
    <url>/Redis%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/</url>
    
    <content type="html"><![CDATA[<h2 id="1-åŸºäºRediså®ç°åˆ†å¸ƒå¼é”"><a href="#1-åŸºäºRediså®ç°åˆ†å¸ƒå¼é”" class="headerlink" title="1 åŸºäºRediså®ç°åˆ†å¸ƒå¼é”"></a>1 <strong>åŸºäºRediså®ç°åˆ†å¸ƒå¼é”</strong></h2><h1 id=""><a href="#" class="headerlink" title=""></a></h1>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼é”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ³¨å†Œä¸­å¿ƒ</title>
    <link href="/%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83/"/>
    <url>/%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯æ³¨å†Œä¸­å¿ƒ"><a href="#1-ä»€ä¹ˆæ˜¯æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="1 ä»€ä¹ˆæ˜¯æ³¨å†Œä¸­å¿ƒ"></a>1 ä»€ä¹ˆæ˜¯æ³¨å†Œä¸­å¿ƒ</h1><p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæ³¨å†Œä¸­å¿ƒæ˜¯æ ¸å¿ƒçš„åŸºç¡€æœåŠ¡ä¹‹ä¸€ã€‚</p><p>æ³¨å†Œä¸­å¿ƒå¯ä»¥è¯´æ˜¯å¾®æœåŠ¡æ¶æ„ä¸­çš„â€é€šè®¯å½•â€œï¼Œå®ƒè®°å½•äº†æœåŠ¡å’ŒæœåŠ¡åœ°å€çš„æ˜ å°„å…³ç³»ã€‚åœ¨åˆ†å¸ƒå¼æ¶æ„ä¸­ï¼ŒæœåŠ¡ä¼šæ³¨å†Œåˆ°è¿™é‡Œï¼Œå½“æœåŠ¡éœ€è¦è°ƒç”¨å…¶å®ƒæœåŠ¡æ—¶ï¼Œå°±åˆ°è¿™é‡Œæ‰¾åˆ°æœåŠ¡çš„åœ°å€ï¼Œè¿›è¡Œè°ƒç”¨ã€‚</p><h1 id="2-ä¸ºä»€ä¹ˆè¦æœ‰æ³¨å†Œä¸­å¿ƒ"><a href="#2-ä¸ºä»€ä¹ˆè¦æœ‰æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="2 ä¸ºä»€ä¹ˆè¦æœ‰æ³¨å†Œä¸­å¿ƒ"></a>2 ä¸ºä»€ä¹ˆè¦æœ‰æ³¨å†Œä¸­å¿ƒ</h1><p>é€šå¸¸ï¼Œåœ¨å¾®æœåŠ¡ç³»ç»Ÿä¸­ï¼Œå¦‚æœæˆ‘ä»¬ç°åœ¨çš„ä¼šå‘˜æœåŠ¡è¦è°ƒè®¢å•æœåŠ¡ï¼Œå°±åªèƒ½æŠŠipå†™æ­»ï¼Œä¸€æ—¦Ipå˜æ›´ï¼Œæˆ–è€…æ‰©å®¹ï¼ˆå†å¢åŠ æœºå™¨ï¼‰ï¼Œä¼šå‘˜æœåŠ¡å°±æ„Ÿå—ä¸åˆ°</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221602827.png" alt="image-20230228221602827"></p><p>æ‰€ä»¥éœ€è¦æ‰‹åŠ¨ç»´æŠ¤ä¸€ä¸ªæ³¨å†Œè¡¨ï¼Œå¢åŠ è®¢å•æœåŠ¡çš„æ—¶å€™ï¼Œå»æ³¨å†Œè¡¨é‡Œæ³¨å†Œï¼ˆ<strong>æœåŠ¡æ³¨å†Œ</strong>ï¼‰ï¼Œéœ€è¦è°ƒç”¨çš„æ—¶å€™ï¼Œå…ˆå»æ³¨å†Œè¡¨é‡ŒæŸ¥ï¼ˆ<strong>æœåŠ¡å‘ç°</strong>ï¼‰ï¼Œå†è°ƒç”¨ã€‚ä½†æ˜¯å½“æŸä¸ªèŠ‚ç‚¹å®•æœºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å†å»è°ƒç”¨å°±æœ‰é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦å€ŸåŠ©æŸäº›æ‰‹æ®µå¯ä»¥è‡ªåŠ¨æ„ŸçŸ¥åˆ°æœåŠ¡ä¸‹çº¿ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221614178.png" alt="image-20230228221614178"></p><h2 id="3-æ³¨å†Œä¸­å¿ƒå®ç°"><a href="#3-æ³¨å†Œä¸­å¿ƒå®ç°" class="headerlink" title="3 æ³¨å†Œä¸­å¿ƒå®ç°"></a>3 æ³¨å†Œä¸­å¿ƒå®ç°</h2><p>æ³¨å†Œä¸­å¿ƒå»å®ç°çš„æ—¶å€™å¾—æ”¯æŒæœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°</p><ul><li>æœåŠ¡æ³¨å†Œï¼šå°±æ˜¯éœ€è¦ç»´æŠ¤ä¸€ä¸ªæ³¨å†Œè¡¨ï¼Œå­˜å‚¨æœåŠ¡å’ŒæœåŠ¡åœ°å€çš„æ˜ å°„å…³ç³»ã€‚<strong>æ‰€ä»¥éœ€è¦å¯ä»¥å­˜å‚¨æ•°æ®</strong></li><li>æœåŠ¡å‘ç°ï¼šå½“æœåŠ¡è¦è°ƒç”¨çš„æ—¶å€™ï¼Œé€šè¿‡è¯»å–æœåŠ¡æ³¨å†Œè¡¨è·å–å¯ç”¨çš„æœåŠ¡ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡æ­¤ä¿¡æ¯è¿æ¥æœåŠ¡å™¨</li></ul><p>æ³¨ï¼š</p><ol><li><p>ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå¯ä»¥åœ¨serverç«¯ï¼Œè‡ªå·±ç»´æŠ¤ä¸€ä»½æ³¨å†Œä¸­å¿ƒçš„ç¼“å­˜ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ‰éœ€è¦è¿æ¥zookeeperæˆ–è€…redis</p></li><li><p>åŒä¸€ä¸ªserver, æ¯æ¬¡æ–°åŠ ä¸€ä¸ªipéƒ½éœ€è¦é‡æ–°æŸ¥è¯¢ä¸€æ¬¡,ä»è€Œæ›´æ–°ç¼“å­˜ã€‚å› æ­¤zookeeperå’Œredisè¿˜èƒ½åšæ³¨å†Œä¸­å¿ƒçš„ä¸€ä¸ªæ¡ä»¶æ˜¯ï¼Œä»–ä»¬èƒ½å¤Ÿç›‘å¬æ•°æ®çš„å˜åŒ–ï¼ˆrediså…·æœ‰æ¶ˆè´¹è®¢é˜…ï¼Œzookeeperå…·æœ‰watchæœºåˆ¶ï¼‰ï¼Œå½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šæ”¶åˆ°æ¶ˆæ¯ï¼Œä»è€Œæ›´æ–°åˆ—è¡¨ </p></li><li><p>æŸä¸ªIPå¯¹åº”çš„æœåŠ¡æŒ‚æ‰çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦æ›´æ–°æ³¨å†Œè¡¨ï¼Œå› æ­¤éœ€è¦ç±»ä¼¼å¿ƒè·³æœºåˆ¶ï¼Œæ¥æ£€æµ‹æœåŠ¡æ˜¯å¦æŒ‚æ‰ï¼ŒæŒ‚æ‰åï¼Œéœ€è¦ç§»é™¤è¯¥æœåŠ¡ã€‚ï¼ˆredisçš„è¿‡æœŸæ—¶é—´ï¼Œzookeeperçš„ä¸´æ—¶èŠ‚ç‚¹ï¼‰</p></li></ol><h2 id="3-1-åŸºäºmysql-å®ç°æ³¨å†Œä¸­å¿ƒ"><a href="#3-1-åŸºäºmysql-å®ç°æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="3.1 åŸºäºmysql å®ç°æ³¨å†Œä¸­å¿ƒ"></a>3.1 åŸºäºmysql å®ç°æ³¨å†Œä¸­å¿ƒ</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221628038.png" alt="image-20230228221628038"></p><ul><li>è®¢å•æœåŠ¡å¯åŠ¨æ—¶ï¼Œè°ƒç”¨æ³¨å†Œæ¥å£ï¼Œä¹Ÿå°±æ˜¯insertï¼Œå°†æœåŠ¡åï¼Œipï¼Œç«¯å£ä»¥åŠçŠ¶æ€è¿›è¡Œå­˜å‚¨ï¼Œå¯¹åº”ç”Ÿæˆæ³¨å†Œè¡¨</li><li>æ¯æ¬¡è°ƒç”¨è®¢å•æœåŠ¡å‰ï¼Œéƒ½å…ˆå»æ³¨å†Œè¡¨é‡ŒæŸ¥è¯¢æœåŠ¡åˆ—è¡¨ï¼Œæ‰§è¡Œselect</li><li>ç»´æŠ¤ ä¸€ä¸ªå¿ƒè·³ï¼Œå®šæœŸå»æ„Ÿåº”ä¸‹èŠ‚ç‚¹çŠ¶æ€æ˜¯å¦æ­£å¸¸ï¼Œæ¯”å¦‚pingä¸€ä¸‹ç«¯å£ï¼Œå¦‚æœä¸æ­£å¸¸ï¼Œä¿®æ”¹æ­¤æ—¶èŠ‚ç‚¹çŠ¶æ€</li></ul><h2 id="3-2-åŸºäºzookeeperå®ç°æ³¨å†Œä¸­å¿ƒ"><a href="#3-2-åŸºäºzookeeperå®ç°æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="3.2 åŸºäºzookeeperå®ç°æ³¨å†Œä¸­å¿ƒ"></a>3.2 åŸºäºzookeeperå®ç°æ³¨å†Œä¸­å¿ƒ</h2><ul><li>åˆ›å»ºçˆ¶èŠ‚ç‚¹ï¼Œç”¨äºç®¡ç†æœåŠ¡èŠ‚ç‚¹</li><li>è®¢å•æœåŠ¡å¯åŠ¨æ—¶ï¼Œåœ¨è¿™ä¸ªçˆ¶èŠ‚ç‚¹ä¸Šåˆ›å»ºä¸´æ—¶å­èŠ‚ç‚¹ï¼Œç”¨æ¥å­˜å‚¨æœåŠ¡å’ŒæœåŠ¡åœ°å€çš„æ˜ å°„å…³ç³»ï¼Œå¯¹åº”ç”Ÿæˆæ³¨å†Œè¡¨</li><li>æ¯æ¬¡è°ƒç”¨è®¢å•æœåŠ¡å‰ï¼Œéƒ½å…ˆå»æ³¨å†Œè¡¨é‡ŒæŸ¥è¯¢æœåŠ¡åˆ—è¡¨</li><li>zookeeperæœ‰ç›‘å¬é€šçŸ¥æœºåˆ¶ï¼Œå¯ä»¥å¤©ç„¶æ„Ÿå—åˆ°æœåŠ¡æ˜¯å¦åœ¨çº¿ï¼Œå¦‚æœå¯¹æŸä¸ªèŠ‚ç‚¹è¿›è¡Œç›‘å¬ï¼Œå½“è¿™ä¸ªèŠ‚ç‚¹è¢«åˆ é™¤ï¼Œæˆ–è€…è¢«ä¿®æ”¹æ—¶ï¼Œç›‘å¬æ–¹ä¼šæ„ŸçŸ¥åˆ°ä¿®æ”¹æ¶ˆæ¯ã€‚æ‰€ä»¥è¿™é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦ç›‘å¬çˆ¶èŠ‚ç‚¹</li></ul><blockquote><p>åˆ›å»ºè¯¥èŠ‚ç‚¹çš„ Zookeeper å®¢æˆ·ç«¯ä¸ Zookeeper æœåŠ¡ç«¯æ–­å¼€è¿æ¥æ—¶ï¼Œè¯¥èŠ‚ç‚¹ä¼šè¢« Zookeeper æœåŠ¡ç«¯ç§»é™¤ã€‚ä½¿ç”¨ä¸´æ—¶èŠ‚ç‚¹æ¥ç»´æŠ¤ Server çš„åœ°å€åˆ—è¡¨å°±ä¿è¯äº†è¯·æ±‚ä¸ä¼šè¢«åˆ†é…åˆ°å·²ç»åœæœºçš„æœåŠ¡ä¸Šã€‚</p></blockquote><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228221650614.png" alt="image-20230228221650614"></p><h2 id="3-3-redis-å®ç°æ³¨å†Œä¸­å¿ƒ"><a href="#3-3-redis-å®ç°æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="3.3 redis å®ç°æ³¨å†Œä¸­å¿ƒ"></a>3.3 redis å®ç°æ³¨å†Œä¸­å¿ƒ</h2>]]></content>
    
    
    <categories>
      
      <category>Zookeeper</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ³¨å†Œä¸­å¿ƒ</tag>
      
      <tag>mysqlå®ç°æ³¨å†Œä¸­å¿ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVMè°ƒä¼˜</title>
    <link href="/JVM%E8%B0%83%E4%BC%98/"/>
    <url>/JVM%E8%B0%83%E4%BC%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-è°ƒä¼˜åŸåˆ™"><a href="#1-è°ƒä¼˜åŸåˆ™" class="headerlink" title="1 è°ƒä¼˜åŸåˆ™"></a>1 è°ƒä¼˜åŸåˆ™</h1><ul><li><p><strong>å¤šæ•°å¯¼è‡´GCé—®é¢˜çš„Javaåº”â½¤ï¼Œéƒ½ä¸æ˜¯å› ä¸ºæˆ‘ä»¬å‚æ•°è®¾ç½®é”™è¯¯ï¼Œâ½½æ˜¯ä»£ç é—®é¢˜</strong>ï¼›</p></li><li><p>å®é™…ä½¿ç”¨ä¸­ï¼Œåˆ†æGCä¼˜åŒ–ä»£ç ï¼Œæ¯”ä¼˜åŒ–JVMå‚æ•°æ•ˆæœè¦å¥½ï¼ŒJVM å‚æ•°çš„é»˜è®¤ï¼ˆæ¨èï¼‰å€¼éƒ½æ˜¯ç»è¿‡ JVM å›¢é˜Ÿçš„åå¤æµ‹è¯•å’Œå‰äººçš„å……åˆ†éªŒè¯å¾—å‡ºçš„æ¯”è¾ƒåˆç†çš„å€¼ï¼Œå› æ­¤é€šå¸¸æ¥è¯´æ˜¯æ¯”è¾ƒé è°±å’Œé€šç”¨çš„ï¼Œä¸€èˆ¬ä¸ä¼šå‡ºå¤§é—®é¢˜ã€‚</p></li><li><p>å¦‚æœæ»¡è¶³ä¸‹é¢çš„æŒ‡æ ‡ï¼Œåˆ™ä¸€èˆ¬ä¸éœ€è¦è¿›è¡ŒGCï¼š</p><ul><li>Minor GCæ‰§è¡Œæ—¶é—´ä¸åˆ°50msï¼Œä¸ä½äº10ç§’ä¸€æ¬¡ï¼›</li><li>Full GCæ‰§è¡Œæ—¶é—´ä¸åˆ°1sï¼Œä¸ä½äºä¸€å°æ—¶1æ¬¡ï¼›</li></ul></li></ul><h1 id="2-æ£€æŸ¥Full-GC-æ˜¯å¦é¢‘ç¹"><a href="#2-æ£€æŸ¥Full-GC-æ˜¯å¦é¢‘ç¹" class="headerlink" title="2. æ£€æŸ¥Full GC æ˜¯å¦é¢‘ç¹"></a>2. æ£€æŸ¥Full GC æ˜¯å¦é¢‘ç¹</h1><p>å¯ä»¥é€šè¿‡<code>jstat -gc pid interval count</code>ï¼Œæ¯éš”intervalç§’ï¼Œæ‰“å°countæ¬¡ï¼Œpidè¿›ç¨‹ä¸‹GCå‹åŠ›æ•´ä½“æƒ…å†µã€‚è§‚å¯Ÿæ˜¯å¦å‡ºç°é¢‘ç¹Full GC</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20240612121617021.png" alt="image-20240612121617021" style="zoom: 100%;" /><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><p><strong>S0C</strong> å’Œ <strong>S1C</strong>ï¼šå¹¸å­˜åŒº 0 å’Œå¹¸å­˜åŒº 1 çš„å®¹é‡åˆ†åˆ«ä¸º 14336 KB å’Œ 10752 KBã€‚</p></li><li><p><strong>S0U</strong> å’Œ <strong>S1U</strong>ï¼šå¹¸å­˜åŒº 0 æ²¡æœ‰ä½¿ç”¨ï¼Œå¹¸å­˜åŒº 1 ä½¿ç”¨äº† 10724.4 KBã€‚</p></li><li><p><strong>EC</strong> å’Œ <strong>EU</strong>ï¼šä¼Šç”¸å›­åŒºçš„å®¹é‡ä¸º 215040 KBï¼Œä½¿ç”¨äº† 20511.6 KBã€‚</p></li><li><p><strong>OC</strong> å’Œ <strong>OU</strong>ï¼šè€å¹´ä»£çš„å®¹é‡ä¸º 139776 KBï¼Œä½¿ç”¨äº† 18056.9 KBã€‚</p></li><li><p><strong>MC</strong> å’Œ <strong>MU</strong>ï¼šå…ƒç©ºé—´çš„å®¹é‡ä¸º 45184 KBï¼Œä½¿ç”¨äº† 42025.9 KBã€‚</p></li><li><p><strong>CCSC</strong> å’Œ <strong>CCSU</strong>ï¼šå‹ç¼©ç±»ç©ºé—´çš„å®¹é‡ä¸º 6272 KBï¼Œä½¿ç”¨äº† 5667.6 KBã€‚</p></li><li><p><strong>YGC</strong> å’Œ <strong>YGCT</strong>ï¼šå¹´è½»ä»£åƒåœ¾å›æ”¶æ¬¡æ•°ä¸º 5 æ¬¡ï¼Œåƒåœ¾å›æ”¶æ€»æ—¶é—´ä¸º 0.068 ç§’ã€‚</p></li><li><p><strong>FGC</strong> å’Œ <strong>FGCT</strong>ï¼šå®Œå…¨åƒåœ¾å›æ”¶æ¬¡æ•°ä¸º 2 æ¬¡ï¼Œåƒåœ¾å›æ”¶æ€»æ—¶é—´ä¸º 0.054 ç§’ã€‚</p></li><li><p><strong>CGC</strong> å’Œ <strong>CGCT</strong>ï¼šå¹¶å‘åƒåœ¾å›æ”¶æ¬¡æ•°å’Œæ—¶é—´æœªæ˜¾ç¤ºï¼ˆå¯èƒ½æ˜¯å› ä¸ºæ²¡æœ‰å¯ç”¨æˆ–å‘ç”Ÿï¼‰ã€‚</p></li><li><p><strong>GCT</strong>ï¼šåƒåœ¾å›æ”¶æ€»æ—¶é—´ä¸º 0.122 ç§’ã€‚</p></li></ul><h1 id="3-JVMå‚æ•°"><a href="#3-JVMå‚æ•°" class="headerlink" title="3  JVMå‚æ•°"></a>3  JVMå‚æ•°</h1><p>å¯ä»¥è€ƒè™‘<a href="https://pyr9.github.io/JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/">JVMå†…å­˜æ¨¡å‹</a>ï¼š</p><p>è®¾ç½®æ ¼å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">java â€Xms2048M â€Xmx2048M â€Xmn1024M â€Xss512K â€XX:MetaspaceSize=256M â€XX:MaxMetaspaceSize=256M â€jar microserviceâ€eurekaâ€server.jar <br></code></pre></td></tr></table></figure><p><strong>å †</strong>ï¼š</p><ul><li><code>-Xms</code>ï¼šè®¾ç½®åˆå§‹å †å¤§å°ã€‚</li><li><code>-Xmx</code>ï¼šè®¾ç½®æœ€å¤§å †å¤§å°ã€‚</li></ul><p><strong>å¹´è½»ä»£ï¼š</strong></p><ul><li><code>-Xmn&lt;size&gt;</code>ï¼šè®¾ç½®å¹´è½»ä»£å†…å­˜å¤§å°ã€‚ï¼ˆè€å¹´ä»£çš„å¤§å°ç­‰äºå †å†…å­˜å¤§å°å‡å»å¹´è½»ä»£çš„å¤§å°ï¼‰</li></ul><p><strong>EdenåŒºä¸SurvivoråŒºçš„æ¯”ä¾‹ï¼š</strong></p><ul><li><code>-XX:SurvivorRatio=&lt;ratio&gt;</code>ï¼šè®¾ç½®EdenåŒºä¸SurvivoråŒºçš„æ¯”ä¾‹ã€‚</li></ul><p><strong>å¹´è½»ä»£ä¸è€å¹´ä»£</strong>ï¼š</p><ul><li><code>-XX:NewRatio=&lt;ratio&gt;</code>ï¼šè®¾ç½®å¹´è½»ä»£ä¸è€å¹´ä»£çš„æ¯”ä¾‹ã€‚</li></ul><p><strong>æ°¸ä¹…ä»£&#x2F;å…ƒç©ºé—´ï¼š</strong></p><ul><li><p><code>-XX:MaxPermSize=&lt;size&gt;</code>ï¼šè®¾ç½®æ°¸ä¹…ä»£çš„æœ€å¤§å¤§å°ï¼ˆä»…é€‚ç”¨äºJava 7åŠä¹‹å‰ç‰ˆæœ¬ï¼‰ã€‚</p></li><li><p><code>-XX:MetaspaceSize=&lt;size&gt;</code>ï¼šè®¾ç½®å…ƒç©ºé—´çš„åˆå§‹å¤§å°ã€‚</p></li><li><p><code>-XX:MaxMetaspaceSize=&lt;size&gt;</code>ï¼šè®¾ç½®å…ƒç©ºé—´çš„æœ€å¤§å¤§å°ï¼ˆé€‚ç”¨äºJava 8åŠä¹‹åç‰ˆæœ¬ï¼‰</p></li></ul><p><strong>æ ˆ</strong>ï¼š</p><ul><li><code>-Xss&lt;size&gt;</code>ï¼šè®¾ç½®æ¯ä¸ªçº¿ç¨‹çš„å †æ ˆå¤§å°ã€‚</li></ul><p><strong>åƒåœ¾æ”¶é›†å™¨</strong></p><ul><li><code>-XX:+UseSerialGC</code>ï¼šä½¿ç”¨ä¸²è¡Œåƒåœ¾æ”¶é›†å™¨ã€‚</li><li><code>-XX:+UseParallelGC</code>ï¼šä½¿ç”¨å¹¶è¡Œåƒåœ¾æ”¶é›†å™¨ï¼ˆParallel GCï¼‰ã€‚</li><li><code>-XX:+UseConcMarkSweepGC</code>ï¼šä½¿ç”¨å¹¶å‘æ ‡è®°æ¸…é™¤åƒåœ¾æ”¶é›†å™¨ï¼ˆCMSï¼‰ã€‚</li><li><code>-XX:+UseG1GC</code>ï¼šä½¿ç”¨G1åƒåœ¾æ”¶é›†å™¨ã€‚</li><li><code>-XX:+UseZGC</code>ï¼šä½¿ç”¨ZGCåƒåœ¾æ”¶é›†å™¨ã€‚</li><li><code>-XX:+UseShenandoahGC</code>ï¼šä½¿ç”¨Shenandoahåƒåœ¾æ”¶é›†å™¨ã€‚</li></ul><p><strong>åƒåœ¾æ”¶é›†è°ƒä¼˜</strong></p><ul><li><code>-XX:MaxGCPauseMillis=&lt;ms&gt;</code>ï¼šè®¾ç½®æœ€å¤§GCæš‚åœæ—¶é—´ã€‚</li><li><code>-XX:G1HeapRegionSize=&lt;size&gt;</code>ï¼šè®¾ç½®G1åƒåœ¾æ”¶é›†å™¨çš„å †åŒºåŸŸå¤§å°ã€‚</li><li><code>-XX:InitiatingHeapOccupancyPercent=&lt;percent&gt;</code>ï¼šè®¾ç½®è§¦å‘æ··åˆGCçš„å †å ç”¨ç™¾åˆ†æ¯”ï¼ˆç”¨äºG1ï¼‰ã€‚</li><li><code>-XX:ParallelGCThreads=&lt;n&gt;</code>ï¼šè®¾ç½®ç”¨äºå¹¶è¡Œåƒåœ¾æ”¶é›†çš„çº¿ç¨‹æ•°ã€‚</li></ul><h1 id="4-JVMè°ƒä¼˜æ¡ˆä¾‹"><a href="#4-JVMè°ƒä¼˜æ¡ˆä¾‹" class="headerlink" title="4. JVMè°ƒä¼˜æ¡ˆä¾‹"></a>4. JVMè°ƒä¼˜æ¡ˆä¾‹</h1><p><a href="https://pyr9.github.io/JVM%E8%B0%83%E4%BC%98%E6%A1%88%E4%BE%8B/">æ¡ˆä¾‹</a></p>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½è°ƒä¼˜</tag>
      
      <tag>JVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åƒåœ¾æ”¶é›†å™¨ä¹‹ZGCæ”¶é›†å™¨</title>
    <link href="/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B9%8BZGC%E6%94%B6%E9%9B%86%E5%99%A8/"/>
    <url>/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B9%8BZGC%E6%94%B6%E9%9B%86%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="ZGCæ”¶é›†å™¨-XX-UseZGC"><a href="#ZGCæ”¶é›†å™¨-XX-UseZGC" class="headerlink" title="ZGCæ”¶é›†å™¨(-XX:+UseZGC)"></a><strong>ZGCæ”¶é›†å™¨</strong>(-XX:+UseZGC)</h1><p>ZGCæ˜¯ä¸€æ¬¾JDK 11ä¸­æ–°åŠ å…¥çš„å…·æœ‰å®éªŒæ€§è´¨çš„ä½å»¶è¿Ÿåƒåœ¾æ”¶é›†å™¨ã€‚JDK 11åªæ”¯æŒlinuxç³»ç»Ÿï¼ŒJDK 14æ‰æ”¯æŒäº†macOså’ŒWindowsç³»ç»Ÿ</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225702509.png" alt="image-20230228225702509"></p><h2 id="ä¸€-ç‰¹ç‚¹"><a href="#ä¸€-ç‰¹ç‚¹" class="headerlink" title="ä¸€ ç‰¹ç‚¹"></a>ä¸€ ç‰¹ç‚¹</h2><h3 id="1-æ”¯æŒTBé‡çº§çš„å †ã€‚"><a href="#1-æ”¯æŒTBé‡çº§çš„å †ã€‚" class="headerlink" title="1. æ”¯æŒTBé‡çº§çš„å †ã€‚"></a>1. <strong>æ”¯æŒTBé‡çº§çš„å †</strong>ã€‚</h3><p>è¿™åº”è¯¥å¯ä»¥æ»¡è¶³æœªæ¥åå¹´å†…ï¼Œæ‰€æœ‰JAVAåº”ç”¨çš„éœ€æ±‚äº† å§ã€‚</p><h3 id="2-æœ€å¤§GCåœé¡¿æ—¶é—´ä¸è¶…10msã€‚"><a href="#2-æœ€å¤§GCåœé¡¿æ—¶é—´ä¸è¶…10msã€‚" class="headerlink" title="2. æœ€å¤§GCåœé¡¿æ—¶é—´ä¸è¶…10msã€‚"></a>2. <strong>æœ€å¤§GCåœé¡¿æ—¶é—´ä¸è¶…10ms</strong>ã€‚</h3><ul><li>ç›®å‰ä¸€èˆ¬çº¿ä¸Šç¯å¢ƒè¿è¡Œè‰¯å¥½çš„JAVAåº”ç”¨Minor GCåœé¡¿æ—¶é—´åœ¨10mså·¦å³ï¼Œ Major GCä¸€èˆ¬éƒ½éœ€è¦100msä»¥ä¸Š</li><li>G1å¯ä»¥è°ƒèŠ‚åœé¡¿æ—¶é—´ï¼Œä½†æ˜¯å¦‚æœè°ƒçš„è¿‡ä½çš„è¯ï¼Œåè€Œä¼šé€‚å¾—å…¶å</li></ul><h3 id="3-æœ€ç³Ÿç³•çš„æƒ…å†µä¸‹ååé‡ä¼šé™ä½15-ã€‚"><a href="#3-æœ€ç³Ÿç³•çš„æƒ…å†µä¸‹ååé‡ä¼šé™ä½15-ã€‚" class="headerlink" title="3. æœ€ç³Ÿç³•çš„æƒ…å†µä¸‹ååé‡ä¼šé™ä½15%ã€‚"></a>3. æœ€ç³Ÿç³•çš„æƒ…å†µä¸‹ååé‡ä¼šé™ä½15%ã€‚</h3><p>å®ƒçš„åœé¡¿æ—¶é—´ä¸ä¼šéšç€å †çš„å¢å¤§è€Œå¢é•¿ï¼ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡ åGå †çš„åœé¡¿æ—¶é—´æ˜¯ 10msä»¥ä¸‹ï¼Œå‡ ç™¾Gç”šè‡³ä¸ŠTå †çš„åœé¡¿æ—¶é—´ä¹Ÿæ˜¯10msä»¥ä¸‹</p><h3 id="4-ä¸åˆ†ä»£-æš‚æ—¶"><a href="#4-ä¸åˆ†ä»£-æš‚æ—¶" class="headerlink" title="4. ä¸åˆ†ä»£(æš‚æ—¶)"></a>4. <strong>ä¸åˆ†ä»£(æš‚æ—¶)</strong></h3><p>åˆ†ä»£çš„åŸå› æ˜¯å› ä¸ºæ¯ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸åŒï¼Œæˆ‘ä»¬éœ€è¦å›æ”¶çš„æ—¶é—´ä¹Ÿä¸åŒã€‚ZGCä¸åˆ†ä»£æ˜¯å› ä¸ºæš‚æ—¶è¿˜æ²¡æœ‰å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œå®ç°èµ·æ¥æ¯”è¾ƒéº»çƒ¦ã€‚</p><h3 id="5-ZGCçš„Regionå¯ä»¥å…·æœ‰å¤§ã€-ä¸­ã€-å°ä¸‰ç±»å®¹é‡"><a href="#5-ZGCçš„Regionå¯ä»¥å…·æœ‰å¤§ã€-ä¸­ã€-å°ä¸‰ç±»å®¹é‡" class="headerlink" title="5. ZGCçš„Regionå¯ä»¥å…·æœ‰å¤§ã€ ä¸­ã€ å°ä¸‰ç±»å®¹é‡"></a>5. ZGCçš„Regionå¯ä»¥å…·æœ‰å¤§ã€ ä¸­ã€ å°ä¸‰ç±»å®¹é‡</h3><p>å°å‹Regionï¼ˆSmall Regionï¼‰ ï¼š å®¹é‡å›ºå®šä¸º2MBï¼Œ ç”¨äºæ”¾ç½®å°äº256KBçš„å°å¯¹è±¡ã€‚ </p><p>ä¸­å‹Regionï¼ˆMedium Regionï¼‰ ï¼š å®¹é‡å›ºå®šä¸º32MBï¼Œ ç”¨äºæ”¾ç½®å¤§äºç­‰äº256KBä½†å°äº4MBçš„å¯¹è±¡ã€‚ </p><p>å¤§å‹Regionï¼ˆLarge Regionï¼‰ ï¼š å®¹é‡ä¸å›ºå®šï¼Œ å¯ä»¥åŠ¨æ€å˜åŒ–ï¼Œ ä½†å¿…é¡»ä¸º2MBçš„æ•´æ•°å€ï¼Œ ç”¨äºæ”¾ç½®4MBæˆ– ä»¥ä¸Šçš„å¤§å¯¹è±¡ã€‚ æ¯ä¸ªå¤§å‹Regionä¸­ ï¼Œåªä¼šå­˜æ”¾ä¸€ä¸ªå¤§å¯¹è±¡</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225713386.png" alt="image-20230228225713386"></p><h2 id="äºŒ-ZGCå­˜åœ¨çš„é—®é¢˜"><a href="#äºŒ-ZGCå­˜åœ¨çš„é—®é¢˜" class="headerlink" title="äºŒ ZGCå­˜åœ¨çš„é—®é¢˜"></a>äºŒ <strong>ZGCå­˜</strong>åœ¨çš„é—®é¢˜</h2><ul><li>ZGCæœ€å¤§çš„é—®é¢˜æ˜¯<strong>æµ®åŠ¨åƒåœ¾</strong>ã€‚1 ZGCæ²¡æœ‰åˆ†ä»£æ¦‚å¿µï¼Œæ¯æ¬¡éƒ½éœ€è¦è¿›è¡Œå…¨å †æ‰«æï¼Œå¯¼è‡´ä¸€äº›â€œæœç”Ÿå¤•æ­»â€çš„å¯¹è±¡æ²¡èƒ½åŠæ—¶çš„è¢«å›æ”¶ã€‚ æ‰€ä»¥å°±ä¸å­˜åœ¨Young GCã€Old GCï¼Œæ‰€æœ‰çš„GCè¡Œä¸ºéƒ½æ˜¯Full GC</li><li>ZGCçš„åœé¡¿æ—¶é—´æ˜¯åœ¨10msä»¥ä¸‹ï¼Œä½†æ˜¯ZGCçš„æ‰§è¡Œæ—¶é—´è¿˜æ˜¯è¿œè¿œå¤§äºè¿™ä¸ªæ—¶é—´çš„ã€‚</li></ul><p><strong>è§£å†³æ–¹æ¡ˆ</strong> </p><p>ç›®å‰å”¯ä¸€çš„åŠæ³•æ˜¯å¢å¤§å †çš„å®¹é‡ï¼Œä½¿å¾—ç¨‹åºå¾—åˆ°æ›´å¤šçš„å–˜æ¯æ—¶é—´ï¼Œä½†æ˜¯è¿™ä¸ªä¹Ÿæ˜¯ä¸€ä¸ªæ²»æ ‡ä¸æ²»æœ¬çš„æ–¹æ¡ˆã€‚å¦‚æœéœ€è¦ä»æ ¹ æœ¬ä¸Šè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿˜æ˜¯éœ€è¦å¼•å…¥åˆ†ä»£æ”¶é›†ï¼Œè®©æ–°ç”Ÿå¯¹è±¡éƒ½åœ¨ä¸€ä¸ªä¸“é—¨çš„åŒºåŸŸä¸­åˆ›å»ºï¼Œç„¶åä¸“é—¨é’ˆå¯¹è¿™ä¸ªåŒºåŸŸè¿›è¡Œæ›´é¢‘ç¹ã€æ›´å¿«çš„æ”¶é›†ã€‚ </p><h2 id="ä¸‰-ZGCè¿ä½œè¿‡ç¨‹"><a href="#ä¸‰-ZGCè¿ä½œè¿‡ç¨‹" class="headerlink" title="ä¸‰ ZGCè¿ä½œè¿‡ç¨‹"></a>ä¸‰ <strong>ZGCè¿ä½œè¿‡ç¨‹</strong></h2><h3 id="1-å¹¶å‘æ ‡è®°ï¼ˆConcurrent-Markï¼‰"><a href="#1-å¹¶å‘æ ‡è®°ï¼ˆConcurrent-Markï¼‰" class="headerlink" title="1. å¹¶å‘æ ‡è®°ï¼ˆConcurrent Markï¼‰"></a>1. å¹¶å‘æ ‡è®°ï¼ˆConcurrent Markï¼‰</h3><ul><li>ç›¸å½“äºSMSæ”¶é›†å™¨çš„åˆå§‹æ ‡è®°+å¹¶å‘æ ‡è®°+é‡æ–°æ ‡è®°ã€‚</li><li>åˆå§‹æ ‡è®° (<strong>Mark Start</strong>)å’Œæœ€ç»ˆæ ‡è®°(<strong>Mark End</strong>)ä¹Ÿä¼šå‡ºç°çŸ­æš‚çš„åœé¡¿</li><li>G1ä¸åŒçš„æ˜¯ï¼Œ ZGCçš„æ ‡è®°æ˜¯åœ¨æŒ‡é’ˆä¸Šè€Œä¸æ˜¯åœ¨å¯¹è±¡ä¸Šè¿›è¡Œçš„ï¼Œ æ ‡è®°é˜¶æ®µä¼šæ›´æ–°æŸ“è‰²æŒ‡é’ˆä¸­çš„Marked 0ã€ Marked 1æ ‡å¿—ä½ã€‚</li></ul><h3 id="2-å¹¶å‘é¢„å¤‡é‡åˆ†é…ï¼ˆConcurrent-Prepare-for-Relocateï¼‰"><a href="#2-å¹¶å‘é¢„å¤‡é‡åˆ†é…ï¼ˆConcurrent-Prepare-for-Relocateï¼‰" class="headerlink" title="2. å¹¶å‘é¢„å¤‡é‡åˆ†é…ï¼ˆConcurrent Prepare for Relocateï¼‰"></a>2. å¹¶å‘é¢„å¤‡é‡åˆ†é…ï¼ˆConcurrent Prepare for Relocateï¼‰</h3><ul><li>è¿™ä¸ªé˜¶æ®µéœ€è¦æ ¹æ®ç‰¹å®šçš„æŸ¥è¯¢æ¡ä»¶ç»Ÿè®¡å¾—å‡ºæœ¬æ¬¡æ”¶ é›†è¿‡ç¨‹è¦æ¸…ç†å“ªäº›Regionï¼Œå°†è¿™äº›Regionç»„æˆé‡åˆ†é…é›†ï¼ˆRelocation Setï¼‰ã€‚</li><li>ZGCæ¯æ¬¡å›æ”¶éƒ½ä¼šæ‰«ææ‰€æœ‰çš„ Regionï¼Œç”¨èŒƒå›´æ›´å¤§çš„æ‰«ææˆæœ¬æ¢å–çœå»G1ä¸­è®°å¿†é›†çš„ç»´æŠ¤æˆæœ¬ã€‚</li></ul><h3 id="3-å¹¶å‘é‡åˆ†é…ï¼ˆConcurrent-Relocateï¼‰"><a href="#3-å¹¶å‘é‡åˆ†é…ï¼ˆConcurrent-Relocateï¼‰" class="headerlink" title="3. å¹¶å‘é‡åˆ†é…ï¼ˆConcurrent Relocateï¼‰"></a>3. å¹¶å‘é‡åˆ†é…ï¼ˆConcurrent Relocateï¼‰</h3><ul><li>é‡åˆ†é…æ˜¯ZGCæ‰§è¡Œè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒé˜¶æ®µï¼Œè¿™ä¸ªè¿‡ç¨‹è¦æŠŠé‡åˆ†é…é›†ä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°æ–°çš„Regionä¸Šï¼Œå¹¶ä¸ºé‡åˆ†é…é›†ä¸­çš„æ¯ä¸ªRegionç»´æŠ¤ä¸€ä¸ª<strong>è½¬å‘è¡¨ï¼ˆForward Tableï¼‰</strong>ï¼Œè®°å½•ä»æ—§å¯¹è±¡åˆ°æ–°å¯¹è±¡çš„è½¬å‘å…³ç³»ã€‚</li><li>å¦‚æœç”¨æˆ·çº¿ç¨‹æ­¤æ—¶å¹¶ å‘è®¿é—®äº†ä½äºé‡åˆ†é…é›†ä¸­çš„å¯¹è±¡ï¼Œè¿™æ¬¡è®¿é—®å°†ä¼šæ ¹æ®Regionä¸Šçš„è½¬å‘è¡¨è®°å½•å°†è®¿é—®è½¬å‘åˆ°æ–°å¤åˆ¶çš„å¯¹è±¡ä¸Šï¼Œå¹¶åŒæ—¶ä¿®æ­£æ›´æ–°è¯¥å¼•ç”¨çš„å€¼ï¼Œä½¿å…¶ç›´æ¥æŒ‡å‘æ–°å¯¹è±¡ï¼ŒZGCå°†è¿™ç§è¡Œä¸ºç§°ä¸ºæŒ‡ é’ˆçš„â€œè‡ªæ„ˆâ€ï¼ˆSelf-Healingï¼‰èƒ½åŠ›ã€‚ </li><li>ZGCçš„é¢œè‰²æŒ‡é’ˆå› ä¸ºâ€œè‡ªæ„ˆâ€ï¼ˆSelfâ€Healingï¼‰èƒ½åŠ›ï¼Œæ‰€ä»¥åªæœ‰ç¬¬ä¸€æ¬¡è®¿é—®æ—§å¯¹è±¡ä¼šå˜æ…¢ï¼Œ <strong>ä¸€æ—¦é‡åˆ†é…é›†ä¸­æŸä¸ªRegionçš„å­˜æ´»å¯¹è±¡éƒ½å¤åˆ¶å®Œæ¯• åï¼Œ è¿™ä¸ªRegionå°±å¯ä»¥ç«‹å³é‡Šæ”¾ç”¨äºæ–°å¯¹è±¡çš„åˆ†é…</strong>ï¼Œä½†æ˜¯è½¬å‘è¡¨è¿˜å¾—ç•™ç€ä¸èƒ½é‡Šæ”¾æ‰ï¼Œ å› ä¸ºå¯èƒ½è¿˜æœ‰è®¿é—®åœ¨ä½¿ç”¨è¿™ä¸ªè½¬å‘è¡¨ã€‚</li></ul><h3 id="4-å¹¶å‘é‡æ˜ å°„ï¼ˆConcurrent-Remapï¼‰"><a href="#4-å¹¶å‘é‡æ˜ å°„ï¼ˆConcurrent-Remapï¼‰" class="headerlink" title="4. å¹¶å‘é‡æ˜ å°„ï¼ˆConcurrent Remapï¼‰"></a>4. <strong>å¹¶å‘é‡æ˜ å°„ï¼ˆConcurrent Remapï¼‰</strong></h3><ul><li>é‡æ˜ å°„æ‰€åšçš„å°±æ˜¯ä¿®æ­£æ•´ä¸ªå †ä¸­æŒ‡å‘é‡åˆ†é…é›†ä¸­æ—§å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨ï¼Œ</li><li>ä½† æ˜¯ZGCä¸­å¯¹è±¡å¼•ç”¨å­˜åœ¨â€œè‡ªæ„ˆâ€åŠŸèƒ½ï¼Œæ‰€ä»¥è¿™ä¸ªé‡æ˜ å°„æ“ä½œå¹¶ä¸æ˜¯å¾ˆè¿«åˆ‡ã€‚</li><li>ZGCå¾ˆå·§å¦™åœ°æŠŠå¹¶å‘é‡æ˜ å°„é˜¶æ®µè¦åšçš„ å·¥ä½œï¼Œåˆå¹¶åˆ°äº†ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†å¾ªç¯ä¸­çš„å¹¶å‘æ ‡è®°é˜¶æ®µé‡Œå»å®Œæˆï¼Œåæ­£å®ƒä»¬éƒ½æ˜¯è¦éå†æ‰€æœ‰å¯¹è±¡çš„ï¼Œè¿™æ ·åˆå¹¶å°±èŠ‚ çœäº†ä¸€æ¬¡éå†å¯¹è±¡å›¾çš„å¼€é”€ã€‚ä¸€æ—¦æ‰€æœ‰æŒ‡é’ˆéƒ½è¢«ä¿®æ­£ä¹‹åï¼Œ åŸæ¥è®°å½•æ–°æ—§å¯¹è±¡å…³ç³»çš„è½¬å‘è¡¨å°±å¯ä»¥é‡Šæ”¾æ‰äº†ã€‚</li></ul><blockquote><p>2ï¼Œ3ï¼Œ4 æ­¥ç›¸å½“äºæ˜¯å®ç°äº†CSMçš„å¹¶å‘æ¸…é™¤ï¼Œä½†æ˜¯æ˜¯ä½¿ç”¨çš„å¤åˆ¶ç®—æ³•ï¼Œ</p></blockquote><blockquote><p>G1 åœ¨è¿™ä¸€æ­¥æ˜¯STWçš„ï¼Œç›´æ¥å¤åˆ¶å®Œéœ€è¦å­˜æ´»çš„å¯¹è±¡ï¼Œä¿®æ­£å¯¹è±¡çš„å¼•ç”¨åˆ°æ–°å¼•ç”¨ä¸Šå°±å¯ä»¥ã€‚ZGCéœ€è¦å†ä¿ç•™ä¸€ä»½æ—§å¯¹è±¡åˆ°æ–°å¯¹è±¡çš„è½¬å‘å…³ç³»ï¼Œè€Œä¸”è¿˜éœ€è¦å†åšä¸€æ¬¡æ—§æ•°æ®çš„é‡æ˜ å°„ã€‚</p></blockquote><h2 id="å››-ZGCè§¦å‘æ—¶æœº"><a href="#å››-ZGCè§¦å‘æ—¶æœº" class="headerlink" title="å›› ZGCè§¦å‘æ—¶æœº"></a>å›› <strong>ZGCè§¦å‘æ—¶æœº</strong></h2><p>ZGCç›®å‰æœ‰4ä¸­æœºåˆ¶è§¦å‘GCï¼š </p><ul><li><p>å®šæ—¶è§¦å‘ï¼Œé»˜è®¤ä¸ºä¸ä½¿ç”¨ï¼Œå¯é€šè¿‡ZCollectionIntervalå‚æ•°é…ç½®ã€‚ </p></li><li><p>é¢„çƒ­è§¦å‘ï¼Œæœ€å¤šä¸‰æ¬¡ï¼Œåœ¨å †å†…å­˜è¾¾åˆ°10%ã€20%ã€30%æ—¶è§¦å‘ï¼Œä¸»è¦æ—¶ç»Ÿè®¡GCæ—¶é—´ï¼Œä¸ºå…¶ä»–GCæœºåˆ¶ä½¿ç”¨ã€‚ </p></li><li><p>åˆ†é…é€Ÿç‡ï¼ŒåŸºäºæ­£æ€åˆ†å¸ƒç»Ÿè®¡ï¼Œè®¡ç®—å†…å­˜99.9%å¯èƒ½çš„æœ€å¤§åˆ†é…é€Ÿç‡ï¼Œä»¥åŠæ­¤é€Ÿç‡ä¸‹å†…å­˜å°†è¦è€—å°½çš„æ—¶é—´ç‚¹ï¼Œ åœ¨è€—å°½ä¹‹å‰è§¦å‘GCï¼ˆè€—å°½æ—¶é—´ - ä¸€æ¬¡GCæœ€å¤§æŒç»­æ—¶é—´ - ä¸€æ¬¡GCæ£€æµ‹å‘¨æœŸæ—¶é—´ï¼‰ã€‚ </p></li><li><p>ä¸»åŠ¨è§¦å‘ï¼Œï¼ˆé»˜è®¤å¼€å¯ï¼Œå¯é€šè¿‡ZProactiveå‚æ•°é…ç½®ï¼‰ è·ä¸Šæ¬¡GCå †å†…å­˜å¢é•¿10%ï¼Œæˆ–è¶…è¿‡5åˆ†é’Ÿæ—¶ï¼Œå¯¹æ¯”è·ä¸Š æ¬¡GCçš„é—´éš”æ—¶é—´è·Ÿï¼ˆ49 * ä¸€æ¬¡GCçš„æœ€å¤§æŒç»­æ—¶é—´ï¼‰ï¼Œè¶…è¿‡åˆ™è§¦å‘ã€‚</p></li></ul><h2 id="äº”-å¦‚ä½•é€‰æ‹©åƒåœ¾æ”¶é›†å™¨"><a href="#äº”-å¦‚ä½•é€‰æ‹©åƒåœ¾æ”¶é›†å™¨" class="headerlink" title="äº” å¦‚ä½•é€‰æ‹©åƒåœ¾æ”¶é›†å™¨"></a>äº” <strong>å¦‚ä½•é€‰æ‹©åƒåœ¾æ”¶é›†å™¨</strong></h2><ol><li><p>ä¼˜å…ˆè°ƒæ•´å †çš„å¤§å°è®©æœåŠ¡å™¨è‡ªå·±æ¥é€‰æ‹© </p></li><li><p>å¦‚æœå†…å­˜å°äº100Mï¼Œä½¿ç”¨ä¸²è¡Œæ”¶é›†å™¨ </p></li><li><p>å¦‚æœæ˜¯å•æ ¸ï¼Œå¹¶ä¸”æ²¡æœ‰åœé¡¿æ—¶é—´çš„è¦æ±‚ï¼Œä¸²è¡Œæˆ–JVMè‡ªå·±é€‰æ‹© </p></li><li><p>å¦‚æœå…è®¸åœé¡¿æ—¶é—´è¶…è¿‡1ç§’ï¼Œé€‰æ‹©å¹¶è¡Œæˆ–è€…JVMè‡ªå·±é€‰ </p></li><li><p>å¦‚æœå“åº”æ—¶é—´æœ€é‡è¦ï¼Œå¹¶ä¸”ä¸èƒ½è¶…è¿‡1ç§’ï¼Œä½¿ç”¨å¹¶å‘æ”¶é›†å™¨ </p></li><li><p>4Gä»¥ä¸‹å¯ä»¥ç”¨parallelï¼Œ4-8Gå¯ä»¥ç”¨ParNew+CMSï¼Œ8Gä»¥ä¸Šå¯ä»¥ç”¨G1ï¼Œå‡ ç™¾Gä»¥ä¸Šç”¨ZGC</p></li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225722421.png" alt="image-20230228225722421"></p><blockquote><p><strong>JDK 1.8é»˜è®¤ä½¿ç”¨ Parallel(å¹´è½»ä»£å’Œè€å¹´ä»£éƒ½æ˜¯)</strong> </p></blockquote><blockquote><p><strong>JDK 1.9é»˜è®¤ä½¿ç”¨ G1</strong></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½è°ƒä¼˜</tag>
      
      <tag>åƒåœ¾æ”¶é›†å™¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åƒåœ¾æ”¶é›†å™¨ä¹‹G1æ”¶é›†å™¨</title>
    <link href="/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B9%8BG1%E6%94%B6%E9%9B%86%E5%99%A8/"/>
    <url>/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B9%8BG1%E6%94%B6%E9%9B%86%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="G1æ”¶é›†å™¨-XX-UseG1GC"><a href="#G1æ”¶é›†å™¨-XX-UseG1GC" class="headerlink" title="G1æ”¶é›†å™¨(-XX:+UseG1GC)"></a><strong>G1æ”¶é›†å™¨</strong>(<strong>-XX:+UseG1GC</strong>)</h1><p><strong>G1 (Garbage-First)æ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡å™¨çš„åƒåœ¾æ”¶é›†å™¨,ä¸»è¦é’ˆå¯¹é…å¤‡å¤šæ ¸å¤„ç†å™¨åŠå¤§å®¹é‡å†…å­˜çš„æœºå™¨</strong>. æ»¡è¶³<strong>å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´åœé¡¿æ—¶é—´çš„åŒæ—¶,è¿˜å…·å¤‡é«˜ååé‡æ€§èƒ½ç‰¹å¾.</strong> </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232909465.png" alt="image-20230228232909465"></p><h2 id="ä¸€-ç‰¹ç‚¹"><a href="#ä¸€-ç‰¹ç‚¹" class="headerlink" title="ä¸€ ç‰¹ç‚¹"></a>ä¸€ ç‰¹ç‚¹</h2><h3 id="1-åˆ†ä»£æ”¶é›†"><a href="#1-åˆ†ä»£æ”¶é›†" class="headerlink" title="1. åˆ†ä»£æ”¶é›†"></a>1. åˆ†ä»£æ”¶é›†</h3><ul><li><p>è™½ç„¶G1å¯ä»¥ä¸éœ€è¦å…¶ä»–æ”¶é›†å™¨é…åˆå°±èƒ½ç‹¬ç«‹ç®¡ç†æ•´ä¸ªGCå †ï¼Œä½†æ˜¯è¿˜æ˜¯ä¿ç•™äº†åˆ†ä»£çš„æ¦‚å¿µ</p></li><li><p>G1å°†Javaå †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼ˆ<strong>Region</strong>ï¼‰ï¼Œä¸€èˆ¬Regionå¤§å°ç­‰äºå †å¤§å°é™¤ä»¥2048ï¼ŒJVMæœ€å¤šå¯ä»¥æœ‰2048ä¸ªRegionã€‚ </p></li><li><p>è¿™äº›Regionä¸­åŒ…å«äº†é€»è¾‘ä¸Šçš„å¹´è½»ä»£å’Œè€å¹´ä»£ï¼Œä½†ä¸å†æ˜¯ç‰©ç†éš”é˜‚äº†ï¼Œå®ƒä»¬éƒ½æ˜¯ï¼ˆå¯ä»¥ä¸è¿ç»­ï¼‰Regionçš„é›†åˆã€‚</p></li><li><p>é»˜è®¤å¹´è½»ä»£å¯¹å †å†…å­˜çš„å æ¯”æ˜¯5%ï¼Œå¯ä»¥é€šè¿‡â€œ-XX:G1NewSizePercentâ€è®¾ç½®å¹´è½»ä»£åˆå§‹å æ¯”ã€‚</p></li><li><p>åœ¨ç³»ç»Ÿè¿è¡Œä¸­ï¼ŒJVMä¼šä¸åœçš„ç»™å¹´è½»ä»£å¢åŠ æ›´å¤šçš„Regionï¼Œä½†æœ€å¤šæ–°ç”Ÿä»£çš„å æ¯”ä¸ä¼šè¶…è¿‡60%ï¼Œå¯ä»¥é€šè¿‡â€œ</p><p>-XX:G1MaxNewSizePercentâ€è°ƒæ•´ã€‚</p></li><li><p>å¹´è½»ä»£ä¸­çš„Edenå’Œ Survivorå¯¹åº”çš„regionä¹Ÿè·Ÿä¹‹å‰ä¸€æ ·ï¼Œé»˜è®¤8:1:1ï¼Œå‡è®¾å¹´è½»ä»£ç°åœ¨æœ‰1000ä¸ªregionï¼ŒedenåŒºå¯¹åº”800ä¸ªï¼Œs0å¯¹åº”100 ä¸ªï¼Œs1å¯¹åº”100ä¸ª</p></li><li><p>ä¸€ä¸ªRegionå¯èƒ½ä¹‹å‰æ˜¯å¹´è½»ä»£ï¼Œå¦‚æœRegionè¿›è¡Œäº†åƒåœ¾å›æ”¶ï¼Œä¹‹åå¯èƒ½åˆä¼šå˜æˆè€å¹´ä»£ï¼Œä¹Ÿå°±æ˜¯è¯´Regionçš„åŒºåŸŸåŠŸèƒ½å¯èƒ½ä¼šåŠ¨æ€å˜åŒ–ã€‚</p></li></ul><h3 id="2-å¹¶è¡Œä¸å¹¶å‘"><a href="#2-å¹¶è¡Œä¸å¹¶å‘" class="headerlink" title="2. å¹¶è¡Œä¸å¹¶å‘"></a>2. <strong>å¹¶è¡Œä¸å¹¶å‘</strong></h3><ul><li>å¹¶è¡Œæ€§: G1èƒ½å……åˆ†åˆ©ç”¨CPUã€å¤šæ ¸ç¯å¢ƒä¸‹çš„ç¡¬ä»¶ä¼˜åŠ¿ï¼Œé€šè¿‡å¤šä¸ªGCçº¿ç¨‹åŒæ—¶å·¥ä½œï¼Œæ¥ç¼©çŸ­Stop-The-Worldåœé¡¿æ—¶é—´ã€‚</li><li>å¹¶å‘æ€§: G1æ‹¥æœ‰ä¸åº”ç”¨ç¨‹åºäº¤æ›¿æ‰§è¡Œçš„èƒ½åŠ›,éƒ¨åˆ†å·¥ä½œå¯ä»¥å’Œåº”ç”¨ç¨‹åºåŒæ—¶æ‰§è¡Œ,å› æ­¤,ä¸€èˆ¬æ¥è¯´,ä¸ä¼šåœ¨æ•´ä¸ªå›æ”¶é˜¶æ®µå‘ç”Ÿå®Œå…¨é˜»å¡åº”ç”¨ç¨‹åºçš„æƒ…å†µ</li></ul><blockquote><p><strong>å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«</strong></p><p>å¹¶è¡Œï¼ŒæŒ‡çš„æ˜¯å¤šä¸ªäº‹æƒ…ï¼Œåœ¨<strong>åŒä¸€æ—¶é—´ç‚¹ä¸Š</strong>åŒæ—¶å‘ç”Ÿäº†ã€‚å¹¶è¡Œçš„å¤šä¸ªä»»åŠ¡ä¹‹é—´æ˜¯ä¸äº’ç›¸æŠ¢å èµ„æºçš„ï¼Œç³»ç»Ÿè¦æœ‰å¤šä¸ªCPUæ‰ä¼šå‡ºç°å¹¶è¡Œ</p><p>å¹¶å‘ï¼ŒæŒ‡çš„æ˜¯å¤šä¸ªäº‹æƒ…ï¼Œåœ¨<strong>åŒä¸€æ—¶é—´æ®µå†…</strong>åŒæ—¶å‘ç”Ÿäº†ã€‚  å¹¶å‘çš„å¤šä¸ªä»»åŠ¡ä¹‹é—´æ˜¯äº’ç›¸æŠ¢å èµ„æºçš„ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸­çœ‹ä¼¼æ˜¯å¤šä¸ªä»»åŠ¡åŒæ—¶å®Œæˆçš„çš„ï¼Œä½†å…¶å®æ˜¯CPUåœ¨å¤šæ¬¡åˆ‡æ¢ã€‚</p></blockquote><h3 id="3-ç©ºé—´æ•´åˆ"><a href="#3-ç©ºé—´æ•´åˆ" class="headerlink" title="3. ç©ºé—´æ•´åˆ"></a>3. ç©ºé—´æ•´åˆ</h3><ul><li>G1å°†å†…å­˜åˆ’åˆ†ä¸ºä¸€ä¸ªä¸ªçš„regionã€‚ å†…å­˜çš„å›æ”¶æ˜¯<strong>ä»¥regionä½œä¸ºåŸºæœ¬å•ä½çš„</strong>ã€‚</li><li>Regionä¹‹é—´æ˜¯å¤åˆ¶ç®—æ³•,ä½†æ•´ä½“ä¸Šå®é™…å¯çœ‹ä½œæ˜¯<strong>æ ‡è®°- æ•´ç†ç®—æ³•</strong>,ä¸¤ç§ç®—æ³•éƒ½å¯ä»¥é¿å…å†…å­˜ç¢ç‰‡ã€‚</li></ul><h3 id="4-å¯é¢„æµ‹çš„åœé¡¿"><a href="#4-å¯é¢„æµ‹çš„åœé¡¿" class="headerlink" title="4. å¯é¢„æµ‹çš„åœé¡¿"></a>4. å¯é¢„æµ‹çš„åœé¡¿</h3><ul><li>é™ä½åœé¡¿æ—¶é—´æ˜¯G1 å’Œ CMS å…±åŒçš„å…³æ³¨ç‚¹ï¼Œä½†G1 é™¤äº†è¿½æ±‚ä½åœé¡¿å¤–ï¼Œè¿˜èƒ½å»ºç«‹<strong>å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹</strong>ï¼Œèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸ºMæ¯«ç§’çš„æ—¶é—´ç‰‡æ®µ(é€šè¿‡å‚æ•°â€<strong>-</strong> <strong>XX:MaxGCPauseMillis</strong>â€œæŒ‡å®š)å†…å®Œæˆåƒåœ¾æ”¶é›†ã€‚</li><li>è¿™é‡Œè®¾ç½®çš„â€œæœŸæœ›å€¼â€å¿…é¡»æ˜¯ç¬¦åˆå®é™…çš„ï¼Œ å®ƒé»˜è®¤çš„åœé¡¿ç›®æ ‡ä¸ºä¸¤ç™¾æ¯«ç§’ï¼Œ ä¸€èˆ¬æ¥è¯´ï¼Œ å›æ”¶é˜¶æ®µå åˆ°å‡ ååˆ°ä¸€ç™¾ç”šè‡³æ¥è¿‘ä¸¤ç™¾æ¯«ç§’éƒ½å¾ˆæ­£å¸¸ï¼Œ ä½†å¦‚æœæˆ‘ä»¬æŠŠåœé¡¿æ—¶é—´è°ƒå¾—éå¸¸ä½ï¼Œ è­¬å¦‚è®¾ç½®ä¸ºäºŒåæ¯«ç§’ï¼Œ å¾ˆå¯èƒ½å‡ºç°çš„ç»“æœå°±æ˜¯ç”±äºåœé¡¿ç›®æ ‡æ—¶é—´å¤ªçŸ­ï¼Œ å¯¼è‡´æ¯æ¬¡é€‰å‡ºæ¥çš„å›æ”¶é›†åªå å †å†…å­˜å¾ˆå°çš„ä¸€éƒ¨åˆ†ï¼Œ æ”¶é›†å™¨æ”¶é›†çš„é€Ÿåº¦é€æ¸è·Ÿä¸ä¸Šåˆ†é…å™¨åˆ†é…çš„é€Ÿåº¦ï¼Œ å¯¼è‡´åƒåœ¾æ…¢æ…¢å †ç§¯ã€‚ æœ€ç»ˆå æ»¡å †å¼•å‘ Full GCåè€Œé™ä½æ€§èƒ½ã€‚</li></ul><h2 id="äºŒ-GCçš„è¿ä½œè¿‡ç¨‹"><a href="#äºŒ-GCçš„è¿ä½œè¿‡ç¨‹" class="headerlink" title="äºŒ GCçš„è¿ä½œè¿‡ç¨‹"></a>äºŒ GCçš„è¿ä½œè¿‡ç¨‹</h2><h3 id="1-åˆå§‹æ ‡è®°ï¼ˆinitial-markï¼ŒSTWï¼‰"><a href="#1-åˆå§‹æ ‡è®°ï¼ˆinitial-markï¼ŒSTWï¼‰" class="headerlink" title="1.åˆå§‹æ ‡è®°ï¼ˆinitial markï¼ŒSTWï¼‰"></a>1.<strong>åˆå§‹æ ‡è®°</strong>ï¼ˆinitial markï¼ŒSTWï¼‰</h3><p>æš‚åœæ‰€æœ‰çš„å…¶ä»–çº¿ç¨‹ï¼Œå¹¶è®°å½•ä¸‹gc rootsç›´æ¥èƒ½å¼•ç”¨çš„å¯¹è±¡ï¼Œ<strong>é€Ÿåº¦å¾ˆå¿«</strong> </p><h3 id="2-å¹¶å‘æ ‡è®°ï¼ˆConcurrent-Markingï¼‰"><a href="#2-å¹¶å‘æ ‡è®°ï¼ˆConcurrent-Markingï¼‰" class="headerlink" title="2. å¹¶å‘æ ‡è®°ï¼ˆConcurrent Markingï¼‰"></a>2. å¹¶å‘æ ‡è®°ï¼ˆConcurrent Markingï¼‰</h3><p>åŒCMSçš„å¹¶å‘æ ‡è®° </p><h3 id="3-æœ€ç»ˆæ ‡è®°ï¼ˆRemarkï¼ŒSTWï¼‰"><a href="#3-æœ€ç»ˆæ ‡è®°ï¼ˆRemarkï¼ŒSTWï¼‰" class="headerlink" title="3. æœ€ç»ˆæ ‡è®°ï¼ˆRemarkï¼ŒSTWï¼‰"></a>3. <strong>æœ€ç»ˆæ ‡è®°</strong>ï¼ˆRemarkï¼ŒSTWï¼‰</h3><p>åŒCMSçš„é‡æ–°æ ‡è®° </p><h3 id="4-ç­›é€‰å›æ”¶ï¼ˆCleanupï¼ŒSTWï¼‰"><a href="#4-ç­›é€‰å›æ”¶ï¼ˆCleanupï¼ŒSTWï¼‰" class="headerlink" title="4. ç­›é€‰å›æ”¶ï¼ˆCleanupï¼ŒSTWï¼‰"></a>4. <strong>ç­›é€‰å›æ”¶</strong>ï¼ˆCleanupï¼ŒSTWï¼‰</h3><p>ç­›é€‰å›æ”¶é˜¶æ®µé¦–å…ˆå¯¹å„ä¸ªRegionçš„å›æ”¶ä»·å€¼å’Œæˆæœ¬è¿›è¡Œæ’åºï¼Œæ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„GCåœé¡¿æ—¶é—´(å¯ä»¥ç”¨JVMå‚æ•° -XX:MaxGCPauseMillisæŒ‡å®š)æ¥åˆ¶å®šå›æ”¶è®¡åˆ’ã€‚</p><ul><li><strong>G1æ”¶é›†å™¨åœ¨åå°ç»´æŠ¤äº†ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆé€‰æ‹©å›æ”¶ä»·å€¼æœ€å¤§çš„Region</strong>ï¼Œæ¯”å¦‚ä¸€ä¸ªRegionèŠ±200msèƒ½å›æ”¶10Måƒåœ¾ï¼Œå¦å¤–ä¸€ä¸ªRegionèŠ±50msèƒ½å›æ”¶20Måƒåœ¾ï¼Œåœ¨å›æ”¶æ—¶é—´æœ‰é™æƒ…å†µä¸‹ï¼ŒG1å½“ç„¶ä¼šä¼˜å…ˆé€‰æ‹©åé¢è¿™ä¸ªRegionå›æ”¶ã€‚è¿™ç§ä½¿ç”¨Regionåˆ’åˆ†å†…å­˜ç©ºé—´ä»¥åŠæœ‰ä¼˜å…ˆçº§çš„åŒºåŸŸå›æ”¶æ–¹å¼ï¼Œä¿è¯äº†G1æ”¶é›†å™¨åœ¨æœ‰é™æ—¶é—´å†…å¯ä»¥å°½å¯èƒ½é«˜çš„æ”¶é›†æ•ˆç‡ã€‚</li><li>æ¯”å¦‚è¯´è€å¹´ä»£æ­¤æ—¶æœ‰1000ä¸ª Regionéƒ½æ»¡äº†ï¼Œä½†æ˜¯å› ä¸ºæ ¹æ®é¢„æœŸåœé¡¿æ—¶é—´ï¼Œæœ¬æ¬¡åƒåœ¾å›æ”¶å¯èƒ½åªèƒ½åœé¡¿200æ¯«ç§’ï¼Œé‚£ä¹ˆé€šè¿‡ä¹‹å‰å›æ”¶æˆæœ¬è®¡ç®—å¾—çŸ¥ï¼Œå¯èƒ½å›æ”¶å…¶ä¸­800ä¸ªRegionåˆšå¥½éœ€è¦200msï¼Œé‚£ä¹ˆå°±åªä¼šå›æ”¶800ä¸ªRegion(<strong>Collection Set</strong>ï¼Œè¦å›æ”¶çš„é›† åˆ)ï¼Œå°½é‡æŠŠGCå¯¼è‡´çš„åœé¡¿æ—¶é—´æ§åˆ¶åœ¨æˆ‘ä»¬æŒ‡å®šçš„èŒƒå›´å†…ã€‚è¿™ä¸ªé˜¶æ®µå…¶å®ä¹Ÿå¯ä»¥åšåˆ°ä¸ç”¨æˆ·ç¨‹åºä¸€èµ·å¹¶å‘æ‰§è¡Œï¼Œä½†æ˜¯å› ä¸ºåªå›æ”¶ä¸€éƒ¨åˆ†Regionï¼Œæ—¶é—´æ˜¯ç”¨æˆ·å¯æ§åˆ¶çš„ï¼Œè€Œä¸”åœé¡¿ç”¨æˆ·çº¿ç¨‹å°†å¤§å¹…æé«˜æ”¶é›†æ•ˆç‡ã€‚</li><li>CMSå›æ”¶é˜¶æ®µæ˜¯è·Ÿç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘æ‰§è¡Œçš„ï¼ŒG1å› ä¸ºå†…éƒ¨å®ç°å¤ªå¤æ‚æš‚æ—¶æ²¡å®ç°å¹¶å‘å›æ”¶ï¼Œä¸è¿‡åˆ°äº†Shenandoahå°±å®ç°äº†å¹¶å‘æ”¶é›†ï¼ŒShenandoahå¯ä»¥çœ‹æˆæ˜¯G1çš„å‡çº§ç‰ˆæœ¬</li></ul><h2 id="ä¸‰-G1åƒåœ¾æ”¶é›†åˆ†ç±»"><a href="#ä¸‰-G1åƒåœ¾æ”¶é›†åˆ†ç±»" class="headerlink" title="ä¸‰ G1åƒåœ¾æ”¶é›†åˆ†ç±»"></a>ä¸‰ <strong>G1åƒåœ¾æ”¶é›†åˆ†ç±»</strong></h2><h3 id="1-YoungGC"><a href="#1-YoungGC" class="headerlink" title="1. YoungGC"></a>1. <strong>YoungGC</strong></h3><ul><li>YoungGCå¹¶ä¸æ˜¯è¯´ç°æœ‰çš„EdenåŒºæ”¾æ»¡äº†å°±ä¼šé©¬ä¸Šè§¦å‘ï¼Œ</li><li>G1ä¼šè®¡ç®—ä¸‹ç°åœ¨EdenåŒºå›æ”¶å¤§æ¦‚è¦å¤šä¹…æ—¶é—´ï¼Œå¦‚æœå›æ”¶æ—¶ é—´è¿œè¿œå°äºå‚æ•° -XX:MaxGCPauseMills è®¾å®šçš„å€¼ï¼Œé‚£ä¹ˆå¢åŠ å¹´è½»ä»£çš„regionï¼Œç»§ç»­ç»™æ–°å¯¹è±¡å­˜æ”¾ï¼Œä¸ä¼šé©¬ä¸ŠåšYoung GCï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡EdenåŒºæ”¾æ»¡ï¼ŒG1è®¡ç®—å›æ”¶æ—¶é—´æ¥è¿‘å‚æ•° -XX:MaxGCPauseMills è®¾å®šçš„å€¼ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘Young GC</li></ul><h3 id="2-MixedGC"><a href="#2-MixedGC" class="headerlink" title="2. MixedGC"></a>2. <strong>MixedGC</strong></h3><ul><li>ä¸æ˜¯FullGCï¼Œè€å¹´ä»£çš„å ç”¨ç©ºé—´è¾¾åˆ°æ•´å †çš„é˜ˆå€¼(<strong>-XX:InitiatingHeapOccupancyPercent</strong>è®¾å®šçš„å€¼ï¼Œé»˜è®¤45%)åˆ™è§¦å‘ï¼Œå›æ”¶æ‰€æœ‰çš„ Youngå’Œéƒ¨åˆ†Old(æ ¹æ®æœŸæœ›çš„GCåœé¡¿æ—¶é—´ç¡®å®šoldåŒºåƒåœ¾æ”¶é›†çš„ä¼˜å…ˆé¡ºåº)ä»¥åŠå¤§å¯¹è±¡åŒºï¼Œ</li><li>æ­£å¸¸æƒ…å†µG1çš„åƒåœ¾æ”¶é›†æ˜¯å…ˆåš MixedGCï¼Œä¸»è¦ä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œéœ€è¦æŠŠå„ä¸ªregionä¸­å­˜æ´»çš„å¯¹è±¡æ‹·è´åˆ°åˆ«çš„regioné‡Œå»ï¼Œæ‹·è´è¿‡ç¨‹ä¸­å¦‚æœå‘ç°<strong>æ²¡æœ‰è¶³å¤Ÿ</strong> <strong>çš„ç©ºregion</strong>èƒ½å¤Ÿæ‰¿è½½æ‹·è´å¯¹è±¡å°±ä¼šè§¦å‘ä¸€æ¬¡Full GC</li></ul><h3 id="3-Full-GC"><a href="#3-Full-GC" class="headerlink" title="3. Full GC"></a><strong>3. Full GC</strong></h3><ul><li><p>åœæ­¢ç³»ç»Ÿç¨‹åºï¼Œç„¶åé‡‡ç”¨å•çº¿ç¨‹è¿›è¡Œæ ‡è®°ã€æ¸…ç†å’Œå‹ç¼©æ•´ç†ï¼Œå¥½ç©ºé—²å‡ºæ¥ä¸€æ‰¹Regionæ¥ä¾›ä¸‹ä¸€æ¬¡MixedGCä½¿ç”¨</p></li><li><p>è¿™ä¸ªè¿‡ç¨‹æ˜¯éå¸¸è€—æ—¶çš„ã€‚(Shenandoahä¼˜åŒ–æˆå¤šçº¿ç¨‹æ”¶é›†äº†) ã€‚Full GCçš„æ—¶å€™é™¤äº†æ”¶é›†å¹´è½»ä»£å’Œè€å¹´ä»£ä¹‹å¤–ï¼Œä¹Ÿä¼šå°†HumongousåŒºä¸€å¹¶å›æ”¶ã€‚</p></li></ul><h2 id="å››-G1-å¤§å¯¹è±¡çš„å¤„ç†"><a href="#å››-G1-å¤§å¯¹è±¡çš„å¤„ç†" class="headerlink" title="å›› G1 å¤§å¯¹è±¡çš„å¤„ç†"></a>å›› G1 å¤§å¯¹è±¡çš„å¤„ç†</h2><ul><li>G1æœ‰ä¸“é—¨åˆ†é… å¤§å¯¹è±¡çš„Regionå«<strong>HumongousåŒº</strong>ï¼Œè€Œä¸æ˜¯è®©å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£çš„Regionä¸­ã€‚</li><li>åœ¨G1ä¸­ï¼Œå¤§å¯¹è±¡çš„åˆ¤å®šè§„åˆ™å°±æ˜¯ä¸€ä¸ªå¤§å¯¹è±¡è¶…è¿‡äº†ä¸€ä¸ªRegionå¤§å°çš„50%ï¼Œæ¯”å¦‚æŒ‰ç…§ä¸Šé¢ç®—çš„ï¼Œæ¯ä¸ªRegionæ˜¯2Mï¼Œåªè¦ä¸€ä¸ªå¤§å¯¹è±¡è¶…è¿‡äº†1Mï¼Œå°±ä¼šè¢«æ”¾ å…¥Humongousä¸­ï¼Œè€Œä¸”ä¸€ä¸ªå¤§å¯¹è±¡å¦‚æœå¤ªå¤§ï¼Œå¯èƒ½ä¼šæ¨ªè·¨å¤šä¸ªRegionæ¥å­˜æ”¾ã€‚</li><li>HumongousåŒºä¸“é—¨å­˜æ”¾çŸ­æœŸå·¨å‹å¯¹è±¡ï¼Œä¸ç”¨ç›´æ¥è¿›è€å¹´ä»£ï¼Œå¯ä»¥èŠ‚çº¦è€å¹´ä»£çš„ç©ºé—´ï¼Œé¿å…å› ä¸ºè€å¹´ä»£ç©ºé—´ä¸å¤Ÿçš„GCå¼€ é”€ã€‚</li></ul><h2 id="äº”-G1æ”¶é›†å™¨å‚æ•°è®¾ç½®"><a href="#äº”-G1æ”¶é›†å™¨å‚æ•°è®¾ç½®" class="headerlink" title="äº” G1æ”¶é›†å™¨å‚æ•°è®¾ç½®"></a>äº” <strong>G1æ”¶é›†å™¨å‚æ•°è®¾ç½®</strong></h2><ul><li><p>-XX:+UseG1GC:ä½¿ç”¨G1æ”¶é›†å™¨</p></li><li><p>-XX:ParallelGCThreads:æŒ‡å®šGCå·¥ä½œçš„çº¿ç¨‹æ•°é‡</p></li><li><p>-XX:G1HeapRegionSize:æŒ‡å®šåˆ†åŒºå¤§å°(1MB~32MBï¼Œä¸”å¿…é¡»æ˜¯2çš„Næ¬¡å¹‚)ï¼Œé»˜è®¤å°†æ•´å †åˆ’åˆ†ä¸º2048ä¸ªåˆ†åŒº</p></li><li><p><strong>-XX:MaxGCPauseMillis</strong>:ç›®æ ‡æš‚åœæ—¶é—´(é»˜è®¤200ms)</p></li><li><p>-XX:G1NewSizePercent:æ–°ç”Ÿä»£å†…å­˜åˆå§‹ç©ºé—´(é»˜è®¤æ•´å †5%ï¼Œå€¼é…ç½®æ•´æ•°ï¼Œé»˜è®¤å°±æ˜¯ç™¾åˆ†æ¯”)</p></li><li><p>-XX:G1MaxNewSizePercent:æ–°ç”Ÿä»£å†…å­˜æœ€å¤§ç©ºé—´</p></li><li><p>-XX:TargetSurvivorRatio:SurvivoråŒºçš„å¡«å……å®¹é‡(é»˜è®¤50%)ï¼ŒSurvivoråŒºåŸŸé‡Œçš„ä¸€æ‰¹å¯¹è±¡(å¹´é¾„1+å¹´é¾„2+å¹´é¾„nçš„å¤šä¸ªå¹´é¾„å¯¹è±¡)æ€»å’Œè¶…è¿‡äº†SurvivoråŒºåŸŸçš„50%ï¼Œæ­¤æ—¶å°±ä¼šæŠŠå¹´é¾„n(å«)ä»¥ä¸Šçš„å¯¹è±¡éƒ½æ”¾å…¥è€å¹´ä»£</p></li><li><p>-XX:MaxTenuringThreshold:æœ€å¤§å¹´é¾„é˜ˆå€¼(é»˜è®¤15)</p></li><li><p>**-XX:InitiatingHeapOccupancyPercent:**è€å¹´ä»£å ç”¨ç©ºé—´è¾¾åˆ°æ•´å †å†…å­˜é˜ˆå€¼(é»˜è®¤45%)ï¼Œåˆ™æ‰§è¡Œæ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ··åˆæ”¶é›†(<strong>MixedGC</strong>)ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¹‹å‰è¯´çš„å †é»˜è®¤æœ‰2048ä¸ªregionï¼Œå¦‚æœæœ‰æ¥è¿‘1000ä¸ªregionéƒ½æ˜¯è€å¹´ä»£çš„regionï¼Œåˆ™å¯èƒ½å°±è¦è§¦å‘MixedGCäº†</p></li><li><p><strong>-XX:G1MixedGCLiveThresholdPercent(é»˜è®¤85%)</strong>  regionä¸­çš„å­˜æ´»å¯¹è±¡ä½äºè¿™ä¸ªå€¼æ—¶æ‰ä¼šå›æ”¶è¯¥regionï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªå€¼ï¼Œå­˜æ´»å¯¹è±¡è¿‡å¤šï¼Œå›æ”¶çš„çš„æ„ä¹‰ä¸å¤§ã€‚</p></li><li><p><strong>-XX:G1MixedGCCountTarget</strong>:åœ¨ä¸€æ¬¡å›æ”¶è¿‡ç¨‹ä¸­æŒ‡å®šåšå‡ æ¬¡ç­›é€‰å›æ”¶(é»˜è®¤8æ¬¡)ï¼Œåœ¨æœ€åä¸€ä¸ªç­›é€‰å›æ”¶é˜¶æ®µå¯ä»¥å›æ”¶ä¸€ä¼šï¼Œç„¶åæš‚åœå›æ”¶ï¼Œæ¢å¤ç³»ç»Ÿè¿è¡Œï¼Œä¸€ä¼šå†å¼€å§‹å›æ”¶ï¼Œè¿™æ ·å¯ä»¥è®©ç³»ç»Ÿä¸è‡³äºå•æ¬¡åœé¡¿æ—¶é—´è¿‡é•¿ã€‚</p></li><li><p>-XX:G1HeapWastePercent(é»˜è®¤5%): gcè¿‡ç¨‹ä¸­ç©ºå‡ºæ¥çš„regionæ˜¯å¦å……è¶³é˜ˆå€¼ï¼Œåœ¨æ··åˆå›æ”¶çš„æ—¶å€™ï¼Œå¯¹Regionå›æ”¶éƒ½æ˜¯åŸºäºå¤åˆ¶ç®—æ³•è¿›è¡Œçš„ï¼Œéƒ½æ˜¯æŠŠè¦å›æ”¶çš„Regioné‡Œçš„å­˜æ´»å¯¹è±¡æ”¾å…¥å…¶ä»–Regionï¼Œç„¶åè¿™ä¸ªRegionä¸­çš„åƒåœ¾å¯¹è±¡å…¨éƒ¨æ¸…ç†æ‰ï¼Œè¿™æ ·çš„è¯åœ¨å›æ”¶è¿‡ç¨‹å°±ä¼šä¸æ–­ç©ºå‡ºæ¥æ–°çš„Regionï¼Œä¸€æ—¦ç©ºé—²å‡ºæ¥çš„Regionæ•°é‡è¾¾åˆ°äº†å †å†…å­˜çš„5%ï¼Œæ­¤æ—¶å°±ä¼šç«‹å³åœæ­¢æ··åˆå›æ”¶ï¼Œæ„å‘³ç€æœ¬æ¬¡æ··åˆå›æ”¶å°±ç»“æŸäº†ã€‚</p></li></ul><blockquote><p>-XX åé¢å¸¦çš„Xè¶Šå¤šï¼Œè¯´æ˜è¿™ä¸ªå‚æ•°è¶Šä¸ç¨³å®šï¼Œåé¢å¯èƒ½ä¼šè¢«åºŸå¼ƒæ‰ï¼Œæ¯”å¦‚java â€“versionï¼Œè¿™ç§äº‹æœ€ç¨³å®šçš„</p></blockquote><h2 id="å…­-G1åƒåœ¾æ”¶é›†å™¨ä¼˜åŒ–å»ºè®®"><a href="#å…­-G1åƒåœ¾æ”¶é›†å™¨ä¼˜åŒ–å»ºè®®" class="headerlink" title="å…­ G1åƒåœ¾æ”¶é›†å™¨ä¼˜åŒ–å»ºè®®"></a>å…­ <strong>G1åƒåœ¾æ”¶é›†å™¨ä¼˜åŒ–å»ºè®®</strong></h2><p>è°ƒèŠ‚ -XX:MaxGCPauseMills è¿™ä¸ªå‚æ•°çš„å€¼ï¼Œé¿å… -XX:MaxGCPauseMillsè¿‡å¤§ç”¨æˆ·ä½“éªŒä¸å¥½ï¼Œ-XX:MaxGCPauseMillsè¿‡å°ï¼Œåƒåœ¾å †ç§¯è‡³å æ»¡æ•´ä¸ªå †ï¼Œè§¦å‘full GCã€‚</p><ul><li><p>å‡è®¾å‚æ•° -XX:MaxGCPauseMills è®¾ç½®çš„å€¼å¾ˆå°ï¼Œ è­¬å¦‚è®¾ç½®ä¸ºäºŒåæ¯«ç§’ï¼Œ å¾ˆå¯èƒ½å‡ºç°çš„ç»“æœå°±æ˜¯ç”±äºåœé¡¿ç›®æ ‡æ—¶é—´å¤ªçŸ­ï¼Œ å¯¼è‡´æ¯æ¬¡é€‰å‡ºæ¥çš„å›æ”¶é›†åªå å †å†…å­˜å¾ˆå°çš„ä¸€éƒ¨åˆ†ï¼Œ æ”¶é›†å™¨æ”¶é›†çš„é€Ÿåº¦é€æ¸è·Ÿä¸ä¸Šåˆ†é…å™¨åˆ†é…çš„é€Ÿåº¦ï¼Œ å¯¼è‡´åƒåœ¾æ…¢æ…¢å †ç§¯ã€‚ æœ€ç»ˆå æ»¡å †å¼•å‘ Full GCåè€Œé™ä½æ€§èƒ½</p></li><li><p>å‡è®¾å‚æ•° -XX:MaxGCPauseMills è®¾ç½®çš„å€¼å¾ˆå¤§ï¼Œå¯¼è‡´ç³»ç»Ÿåœé¡¿å¾ˆä¹…ï¼Œç”¨æˆ·ä½“éªŒä¸å¥½ã€‚</p></li></ul><h2 id="ä¸ƒ-G1çš„ä½¿ç”¨åœºæ™¯"><a href="#ä¸ƒ-G1çš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä¸ƒ G1çš„ä½¿ç”¨åœºæ™¯"></a>ä¸ƒ <strong>G1çš„ä½¿ç”¨åœºæ™¯</strong></h2><h3 id="1-å¸Œæœ›æ¶ˆé™¤é•¿æ—¶é—´çš„GCåœé¡¿ï¼ˆè¶…è¿‡0-5-1ç§’ï¼‰"><a href="#1-å¸Œæœ›æ¶ˆé™¤é•¿æ—¶é—´çš„GCåœé¡¿ï¼ˆè¶…è¿‡0-5-1ç§’ï¼‰" class="headerlink" title="1. å¸Œæœ›æ¶ˆé™¤é•¿æ—¶é—´çš„GCåœé¡¿ï¼ˆè¶…è¿‡0.5-1ç§’ï¼‰"></a>1. å¸Œæœ›æ¶ˆé™¤é•¿æ—¶é—´çš„GCåœé¡¿ï¼ˆè¶…è¿‡0.5-1ç§’ï¼‰</h3><p>å¯¹äºç±»ä¼¼Kafkaçš„ç³»ç»Ÿï¼Œå› ä¸ºä»–éœ€è¦æ”¯æŒæ¯ç§’å¤„ç†ç™¾ä¸‡çº§çš„æ¶ˆæ¯ï¼Œæ‰€ä»¥ä¸€èˆ¬éœ€è¦å¤§å†…å­˜æœºå™¨æ¥éƒ¨ç½²ï¼Œæ¯”å¦‚ä¸‰å››åGï¼Œå¯¹äºè¿™ä¹ˆå¤§çš„å†…å­˜ï¼Œminor GC å³ä½¿ä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œä¹Ÿå°±ä¸å†å¿«äº†ï¼Œå¾ˆå¯èƒ½ä¼šå‡ºç°ç³»ç»Ÿæ¯è¿è¡Œä¸€ä¸¤åˆ†é’Ÿå°±ä¼šå› ä¸ºminor gcå¡é¡¿å‡ ç§’é’Ÿæ²¡æ³•å¤„ç†æ–°æ¶ˆæ¯ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¯ä»¥çš„ã€‚ä½¿ç”¨G1æ”¶é›†å™¨å°±å¯ä»¥æ¶ˆé™¤é•¿æ—¶é—´çš„GCåœé¡¿ï¼Œæ¯”å¦‚è®¾ç½®åœé¡¿æ—¶é—´æ˜¯50msï¼Œå50msçš„å¡é¡¿å…¶å®å®Œå…¨èƒ½å¤Ÿæ¥å—ï¼Œç”¨æˆ·å‡ ä¹æ— æ„ŸçŸ¥ï¼Œé‚£ä¹ˆæ•´ä¸ªç³»ç»Ÿå°±å¯ä»¥åœ¨å¡é¡¿å‡ ä¹æ— æ„ŸçŸ¥çš„æƒ…å†µä¸‹ä¸€è¾¹å¤„ç†ä¸šåŠ¡ä¸€è¾¹æ”¶é›†åƒåœ¾ã€‚</p><h3 id="2-æƒ³è¦æ›´å¯æ§ã€å¯é¢„æœŸçš„GCåœé¡¿å‘¨æœŸ"><a href="#2-æƒ³è¦æ›´å¯æ§ã€å¯é¢„æœŸçš„GCåœé¡¿å‘¨æœŸ" class="headerlink" title="2. æƒ³è¦æ›´å¯æ§ã€å¯é¢„æœŸçš„GCåœé¡¿å‘¨æœŸ"></a>2. æƒ³è¦æ›´å¯æ§ã€å¯é¢„æœŸçš„GCåœé¡¿å‘¨æœŸ</h3><h3 id="3-å¤šæ ¸CPUï¼Œå¤§å†…å­˜"><a href="#3-å¤šæ ¸CPUï¼Œå¤§å†…å­˜" class="headerlink" title="3. å¤šæ ¸CPUï¼Œå¤§å†…å­˜"></a>3. å¤šæ ¸CPUï¼Œå¤§å†…å­˜</h3><p>8GBä»¥ä¸Šçš„å †å†…å­˜(å»ºè®®å€¼)ï¼Œå› ä¸ºg1ç®—æ³•å¾ˆå¤æ‚ï¼Œå†…å­˜ä¸å¤Ÿå¤§ï¼Œå°±ä¸è¦ç”¨äº†</p><h3 id="4-ï¼Ÿï¼Ÿ"><a href="#4-ï¼Ÿï¼Ÿ" class="headerlink" title="4. ï¼Ÿï¼Ÿ"></a>4. ï¼Ÿï¼Ÿ</h3><ul><li><p>å¯¹è±¡åˆ†é…æˆ–è€…æ™‹å‡çš„é€Ÿåº¦å˜åŒ–å¤§  ï¼Ÿï¼Ÿ</p></li><li><p>å®æ—¶æ•°æ®å ç”¨è¶…è¿‡ä¸€åŠçš„å †ç©ºé—´  ï¼Ÿï¼Ÿ</p></li></ul><h2 id="å…«-CMSæ”¶é›†å™¨å’ŒG1æ”¶é›†å™¨çš„åŒºåˆ«"><a href="#å…«-CMSæ”¶é›†å™¨å’ŒG1æ”¶é›†å™¨çš„åŒºåˆ«" class="headerlink" title="å…« CMSæ”¶é›†å™¨å’ŒG1æ”¶é›†å™¨çš„åŒºåˆ«"></a>å…« CMSæ”¶é›†å™¨å’ŒG1æ”¶é›†å™¨çš„åŒºåˆ«</h2><h3 id="1-ä½¿ç”¨èŒƒå›´ä¸ä¸€æ ·"><a href="#1-ä½¿ç”¨èŒƒå›´ä¸ä¸€æ ·" class="headerlink" title="1. ä½¿ç”¨èŒƒå›´ä¸ä¸€æ ·"></a>1. ä½¿ç”¨èŒƒå›´ä¸ä¸€æ ·</h3><ul><li>CMSæ”¶é›†å™¨æ˜¯è€å¹´ä»£çš„æ”¶é›†å™¨ï¼Œå¯ä»¥é…åˆæ–°ç”Ÿä»£çš„Serialå’ŒParNewæ”¶é›†å™¨ä¸€èµ·ä½¿ç”¨</li><li>G1æ”¶é›†å™¨æ”¶é›†èŒƒå›´æ˜¯è€å¹´ä»£å’Œæ–°ç”Ÿä»£ã€‚ä¸éœ€è¦ç»“åˆå…¶ä»–æ”¶é›†å™¨ä½¿ç”¨</li></ul><h3 id="2-STWçš„æ—¶é—´"><a href="#2-STWçš„æ—¶é—´" class="headerlink" title="2. STWçš„æ—¶é—´"></a>2. STWçš„æ—¶é—´</h3><ul><li>CMSæ”¶é›†å™¨ä»¥æœ€å°çš„åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚åªæœ‰åˆå§‹æ ‡è®°å’Œé‡æ–°æ ‡è®°éœ€è¦STW</li><li>G1æ”¶é›†å™¨å¯é¢„æµ‹åƒåœ¾å›æ”¶çš„åœé¡¿æ—¶é—´ï¼ˆå»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹ï¼‰ã€‚é™¤äº†åˆå§‹æ ‡è®°å’Œé‡æ–°æ ‡è®°éœ€è¦STWï¼Œç­›é€‰å›æ”¶æ—¶ä¹Ÿéœ€è¦STWï¼Œä¸è¿‡åœé¡¿æ—¶é—´å¯é¢„æµ‹</li></ul><h3 id="3-åƒåœ¾ç¢ç‰‡"><a href="#3-åƒåœ¾ç¢ç‰‡" class="headerlink" title="3. åƒåœ¾ç¢ç‰‡"></a>3. åƒåœ¾ç¢ç‰‡</h3><ul><li>CMSæ”¶é›†å™¨æ˜¯ä½¿ç”¨â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•è¿›è¡Œçš„åƒåœ¾å›æ”¶ï¼Œå®¹æ˜“äº§ç”Ÿå†…å­˜ç¢ç‰‡</li><li>G1æ”¶é›†å™¨ä½¿ç”¨çš„æ˜¯â€œæ ‡è®°-æ•´ç†â€ç®—æ³•ï¼Œè¿›è¡Œäº†ç©ºé—´æ•´åˆï¼Œé™ä½äº†å†…å­˜ç©ºé—´ç¢ç‰‡ã€‚</li></ul><h3 id="4-åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸ä¸€æ ·"><a href="#4-åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸ä¸€æ ·" class="headerlink" title="4. åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸ä¸€æ ·"></a>4. åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸ä¸€æ ·</h3><ul><li>CMS: åˆå§‹æ ‡è®° + å¹¶å‘æ ‡è®° + é‡æ–°æ ‡è®° + å¹¶å‘æ¸…é™¤</li><li>G1: åˆå§‹æ ‡è®° + å¹¶å‘æ ‡è®° + æœ€ç»ˆæ ‡è®° + ç­›é€‰å›æ”¶</li></ul>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½è°ƒä¼˜</tag>
      
      <tag>åƒåœ¾æ”¶é›†å™¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åƒåœ¾æ”¶é›†å™¨</title>
    <link href="/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8/"/>
    <url>/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-åƒåœ¾æ”¶é›†ç®—æ³•"><a href="#1-åƒåœ¾æ”¶é›†ç®—æ³•" class="headerlink" title="1 åƒåœ¾æ”¶é›†ç®—æ³•"></a>1 <strong>åƒåœ¾æ”¶é›†ç®—æ³•</strong></h1><h2 id="1-1-æ ‡è®°-æ¸…é™¤ç®—æ³•"><a href="#1-1-æ ‡è®°-æ¸…é™¤ç®—æ³•" class="headerlink" title="1.1 æ ‡è®° - æ¸…é™¤ç®—æ³•"></a>1.1 <strong>æ ‡è®° - æ¸…é™¤ç®—æ³•</strong></h2><p>ç®—æ³•åˆ†ä¸ºâ€œæ ‡è®°â€å’Œâ€œæ¸…é™¤â€ä¸¤ä¸ªé˜¶æ®µ:é¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚<br>ç¼ºç‚¹:<br>ï¼ˆ1ï¼‰æ•ˆç‡é—®é¢˜ï¼Œ æ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªè¿‡ç¨‹çš„æ•ˆç‡éƒ½ä¸é«˜ï¼›<br>ï¼ˆ2ï¼‰ç©ºé—´é—®é¢˜ï¼Œæ ‡è®°æ¸…é™¤ä¹‹åä¼šäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ï¼Œç©ºé—´ç¢ç‰‡å¤ªå¤šå¯èƒ½ä¼šå¯¼è‡´ä»¥ååœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­éœ€è¦åˆ†é…è¾ƒå¤§å¯¹è±¡æ—¶ï¼Œæ— æ³•æ‰¾åˆ°è¶³å¤Ÿçš„è¿ç»­å†…å­˜é¢ä¸å¾—ä¸æå‰è§¦å‘å¦ä¸€æ¬¡åƒåœ¾æ”¶é›†åŠ¨ä½œã€‚</p><h2 id="1-2-æ ‡è®°-æ•´ç†ç®—æ³•"><a href="#1-2-æ ‡è®°-æ•´ç†ç®—æ³•" class="headerlink" title="1.2 æ ‡è®° - æ•´ç†ç®—æ³•"></a>1.2 <strong>æ ‡è®° - æ•´ç†ç®—æ³•</strong></h2><p> è®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚<br>ä¼˜ç‚¹: ä¸ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡<br>ä¸è¶³: éœ€è¦ç§»åŠ¨å¤§é‡å¯¹è±¡ï¼Œå¤„ç†æ•ˆç‡æ¯”è¾ƒä½ã€‚</p><h2 id="1-3-å¤åˆ¶ç®—æ³•"><a href="#1-3-å¤åˆ¶ç®—æ³•" class="headerlink" title="1.3 å¤åˆ¶ç®—æ³•"></a>1.3 <strong>å¤åˆ¶ç®—æ³•</strong></h2><p>å°†å†…å­˜åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€å—ï¼Œå½“è¿™ä¸€å—å†…å­˜ç”¨å®Œäº†å°±å°†è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´è¿›è¡Œä¸€æ¬¡æ¸…ç†ã€‚</p><p>æ–°ç”Ÿä»£çš„å¯¹è±¡æ¯æ¬¡åœ¨æ¯æ¬¡åƒåœ¾æ”¶é›†æ—¶éƒ½ä¼šæœ‰å¤§æ‰¹å¯¹è±¡æ­»å»ï¼Œåªæœ‰å°‘é‡å­˜æ´»ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦æŒ‰ç…§1:1åˆ’åˆ†å†…å­˜ç©ºé—´è€Œæ˜¯ å°†å†…å­˜åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„ Eden ç©ºé—´å’Œä¸¤å—è¾ƒå°çš„ Survivor ç©ºé—´ï¼Œæ¯æ¬¡ä½¿ç”¨ Eden å’Œå…¶ä¸­ä¸€å—Survivorã€‚</p><p>åœ¨å›æ”¶æ—¶ï¼Œå°† Eden å’Œ Survivor ä¸­è¿˜å­˜æ´»ç€çš„å¯¹è±¡å…¨éƒ¨å¤åˆ¶åˆ°å¦ä¸€å— Survivor ä¸Šï¼Œæœ€åæ¸…ç† Eden å’Œä½¿ç”¨è¿‡çš„é‚£ä¸€å— Survivorç©ºé—´ã€‚ï¼ˆHotSpot è™šæ‹Ÿæœºçš„ Eden å’Œ Survivor å¤§å°æ¯”ä¾‹é»˜è®¤ä¸º 8:1:1ï¼‰</p><h2 id="1-4-åˆ†ä»£æ”¶é›†ç®—æ³•"><a href="#1-4-åˆ†ä»£æ”¶é›†ç®—æ³•" class="headerlink" title="1.4 åˆ†ä»£æ”¶é›†ç®—æ³•"></a>1.4 <strong>åˆ†ä»£æ”¶é›†ç®—æ³•</strong></h2><p>å½“å‰è™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†éƒ½é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œåªæ˜¯æ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ†ä¸ºå‡ å—ã€‚ä¸€èˆ¬å°†javaå †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„åƒåœ¾æ”¶é›†ç®—æ³•ã€‚</p><ul><li><p>æ–°ç”Ÿä»£ä½¿ç”¨ï¼šå¤åˆ¶ç®—æ³•</p><p>æ–°ç”Ÿä»£ä¸­ï¼Œæ¯æ¬¡æ”¶é›†éƒ½ä¼šæœ‰å¤§é‡å¯¹è±¡(è¿‘99%)æ­»å»ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©å¤åˆ¶ç®—æ³•ï¼Œåªéœ€è¦ä»˜å‡ºå°‘é‡å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ¯æ¬¡åƒåœ¾æ”¶é›†ã€‚</p></li><li><p>è€å¹´ä»£ä½¿ç”¨ï¼šæ ‡è®° - æ¸…é™¤ æˆ–è€… æ ‡è®° - æ•´ç† ç®—æ³•</p><p>è€Œè€å¹´ä»£çš„å¯¹è±¡å­˜æ´»å‡ ç‡æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œè€Œä¸”æ²¡æœ‰é¢å¤–çš„ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»é€‰æ‹©â€œæ ‡è®°-æ¸…é™¤â€æˆ–â€œæ ‡è®°-æ•´ç†â€ç®—æ³•è¿›è¡Œåƒåœ¾æ”¶é›†ã€‚<strong>â€œæ ‡è®°-æ¸…é™¤â€æˆ–â€œæ ‡è®°-æ•´ç†â€ç®—æ³•ä¼šæ¯”å¤åˆ¶ç®—æ³•æ…¢10å€ä»¥ ä¸Šã€‚</strong></p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232824370.png" alt="image-20230228232824370"></p><h1 id="2-åƒåœ¾æ”¶é›†å™¨"><a href="#2-åƒåœ¾æ”¶é›†å™¨" class="headerlink" title="2 åƒåœ¾æ”¶é›†å™¨"></a>2 <strong>åƒåœ¾æ”¶é›†å™¨</strong></h1><p><strong>å¦‚æœè¯´æ”¶é›†ç®—æ³•æ˜¯å†…å­˜å›æ”¶çš„æ–¹æ³•è®ºï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±æ˜¯å†…å­˜å›æ”¶çš„å…·ä½“å®ç°ã€‚</strong> </p><p>è™½ç„¶æˆ‘ä»¬å¯¹å„ä¸ªæ”¶é›†å™¨è¿›è¡Œæ¯”è¾ƒï¼Œä½†å¹¶éä¸ºäº†æŒ‘é€‰å‡ºä¸€ä¸ªæœ€å¥½çš„æ”¶é›†å™¨ã€‚å› ä¸ºç›´åˆ°ç°åœ¨ä¸ºæ­¢è¿˜æ²¡æœ‰æœ€å¥½çš„åƒåœ¾æ”¶é›†å™¨å‡ºç°ï¼Œæ›´åŠ æ²¡æœ‰ä¸‡èƒ½çš„åƒåœ¾æ”¶é›†å™¨ï¼Œ<strong>æˆ‘ä»¬èƒ½åšçš„å°±æ˜¯æ ¹æ®å…·ä½“åº”ç”¨åœºæ™¯é€‰æ‹©é€‚åˆè‡ªå·±çš„åƒåœ¾æ”¶é›†å™¨</strong>ã€‚</p><p>å¯¹äºJDK8é»˜è®¤çš„åƒåœ¾å›æ”¶å™¨æ˜¯-XX:+UseParallelGC(å¹´è½»ä»£)å’Œ-XX:+UseParallelOldGC(è€å¹´ä»£)ï¼Œå¦‚æœå†…å­˜è¾ƒå¤§(è¶…è¿‡4ä¸ªGï¼Œåªæ˜¯ç»éªŒå€¼)ï¼Œç³»ç»Ÿå¯¹åœé¡¿æ—¶é—´æ¯”è¾ƒæ•æ„Ÿï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>ParNew+CMS(</strong>-XX:+UseParNewGC -XX:+UseConcMarkSweepGC**)** </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232833764.png" alt="image-20230228232833764"></p><h2 id="2-1-Serialæ”¶é›†å™¨"><a href="#2-1-Serialæ”¶é›†å™¨" class="headerlink" title="2.1 Serialæ”¶é›†å™¨"></a>2.1 Serialæ”¶é›†å™¨</h2><ul><li><strong>-XX:+UseSerialGC -XX:+UseSerialOldGC</strong></li><li>Serialï¼ˆä¸²è¡Œï¼‰æ”¶é›†å™¨æ˜¯æœ€åŸºæœ¬ã€å†å²æœ€æ‚ ä¹…çš„åƒåœ¾æ”¶é›†å™¨äº†ã€‚</li><li>å®ƒæ˜¯å•çº¿ç¨‹çš„æ”¶é›†å™¨ï¼Œåªä¼šä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†å·¥ä½œã€‚è¿›è¡Œåƒåœ¾æ”¶é›†æ—¶å¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹(<strong>â€œStop The Worldâ€</strong>) ï¼Œç›´åˆ°å®ƒæ”¶é›†ç»“æŸã€‚</li><li>å®ƒçš„ä¼˜ç‚¹æ˜¯ç®€å•é«˜æ•ˆï¼Œåœ¨å•ä¸ª CPU ç¯å¢ƒä¸‹ï¼Œç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œå› æ­¤æ‹¥æœ‰æœ€é«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡ã€‚</li><li><strong>Serial Oldæ”¶é›†å™¨æ˜¯Serialæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬</strong>ï¼Œå®ƒåŒæ ·æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨ã€‚å®ƒä¸»è¦æœ‰ä¸¤å¤§ç”¨é€”ï¼šä¸€ç§ç”¨é€”æ˜¯åœ¨JDK1.5 ä»¥åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­ä¸Parallel Scavengeæ”¶é›†å™¨æ­é…ä½¿ç”¨ï¼Œ<strong>å¦ä¸€ç§ç”¨é€”æ˜¯ä½œä¸ºCMSæ”¶é›†å™¨çš„åå¤‡æ–¹æ¡ˆ</strong>ã€‚</li></ul><blockquote><p><strong>æ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚</strong> </p></blockquote><h2 id="2-2-Parallel-Scavengeæ”¶é›†å™¨"><a href="#2-2-Parallel-Scavengeæ”¶é›†å™¨" class="headerlink" title="2.2 Parallel Scavengeæ”¶é›†å™¨"></a>2.2 <strong>Parallel Scavengeæ”¶é›†å™¨</strong></h2><ul><li><strong>-XX:+UseParallelGC(å¹´è½»ä»£),-XX:+UseParallelOldGC(è€å¹´ä»£)</strong></li><li><strong>Parallel</strong>æ”¶é›†å™¨å…¶å®<strong>å°±æ˜¯Serialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬</strong>ï¼Œé™¤äº†ä½¿ç”¨å¤šçº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†å¤–ï¼Œå…¶ä½™è¡Œä¸ºï¼ˆæ§åˆ¶å‚æ•°ã€æ”¶é›†ç®—æ³•ã€å›æ”¶ç­–ç•¥ç­‰ç­‰ï¼‰å’ŒSerialæ”¶é›†å™¨ç±»ä¼¼ã€‚</li><li>é»˜è®¤çš„æ”¶é›†çº¿ç¨‹æ•°è·Ÿcpuæ ¸æ•°ç›¸åŒï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨å‚æ•°(- XX:ParallelGCThreads)æŒ‡å®šæ”¶é›†çº¿ç¨‹æ•°ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸æ¨èä¿®æ”¹ã€‚ </li><li><strong>Parallel Scavengeæ”¶é›†å™¨å…³æ³¨ç‚¹æ˜¯ååé‡ï¼ˆé«˜æ•ˆç‡çš„åˆ©ç”¨CPUï¼Œè·å–æœ€çŸ­çš„åƒåœ¾å›æ”¶æ—¶é—´ï¼‰</strong></li><li><strong>Parallel Oldæ”¶é›†å™¨æ˜¯Parallel Scavengeæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬</strong>ã€‚ä½¿ç”¨å¤šçº¿ç¨‹å’Œâ€œæ ‡è®°-æ•´ç†â€ç®—æ³•ã€‚åœ¨æ³¨é‡ååé‡ä»¥åŠ CPUèµ„æºçš„åœºåˆï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘ Parallel Scavengeæ”¶é›†å™¨å’ŒParallel Oldæ”¶é›†å™¨(<strong>JDK8é»˜è®¤çš„æ–°ç”Ÿä»£å’Œè€å¹´ä»£æ”¶é›†å™¨</strong>)ã€‚</li></ul><blockquote><p><strong>æ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚</strong></p></blockquote><h2 id="2-3-ParNewæ”¶é›†å™¨"><a href="#2-3-ParNewæ”¶é›†å™¨" class="headerlink" title="2.3 ParNewæ”¶é›†å™¨"></a>2.3 ParNewæ”¶é›†å™¨</h2><ul><li><p><strong>-XX:+UseParNewGC</strong></p></li><li><p>ParNewæ”¶é›†å™¨å…¶å®<strong>è·ŸParallelæ”¶é›†å™¨å¾ˆç±»ä¼¼</strong>ï¼ŒåŒºåˆ«ä¸»è¦åœ¨äºå®ƒå¯ä»¥å’ŒCMSæ”¶é›†å™¨é…åˆä½¿ç”¨ã€‚</p></li></ul><blockquote><p><strong>æ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚</strong> </p></blockquote><h2 id="2-4-CMSæ”¶é›†å™¨"><a href="#2-4-CMSæ”¶é›†å™¨" class="headerlink" title="2.4 CMSæ”¶é›†å™¨"></a>2.4 <strong>CMSæ”¶é›†å™¨</strong></h2><ul><li><p><strong>-XX:+UseConcMarkSweepGC(old)</strong></p></li><li><p><strong>CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚å®ƒéå¸¸ç¬¦åˆåœ¨æ³¨é‡ç”¨æˆ·ä½“</strong> <strong>éªŒçš„åº”ç”¨ä¸Šä½¿ç”¨ï¼Œå®ƒæ˜¯HotSpotè™šæ‹Ÿæœºç¬¬ä¸€æ¬¾çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘æ”¶é›†å™¨ï¼Œå®ƒç¬¬ä¸€æ¬¡å®ç°äº†è®©åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹</strong> <strong>ï¼ˆåŸºæœ¬ä¸Šï¼‰åŒæ—¶å·¥ä½œ</strong></p></li><li><p>æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼š </p><ul><li>åˆå§‹æ ‡è®°ï¼šä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹ GC Roots èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œéœ€è¦åœé¡¿ã€‚</li><li>å¹¶å‘æ ‡è®°ï¼šè¿›è¡Œ GC Roots Tracing çš„è¿‡ç¨‹ï¼Œå®ƒåœ¨æ•´ä¸ªå›æ”¶è¿‡ç¨‹ä¸­è€—æ—¶æœ€é•¿ï¼Œä¸éœ€è¦åœé¡¿ã€‚</li><li>é‡æ–°æ ‡è®°ï¼šä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œéœ€è¦åœé¡¿ã€‚</li><li>å¹¶å‘æ¸…é™¤ï¼šç”¨æˆ·å¯åŒæ—¶è¿è¡Œçš„ï¼Œè€—æ—¶è¾ƒé•¿ã€‚</li></ul></li><li><p>ä¼˜ç¼ºç‚¹ï¼š</p><ul><li>ä¼˜ç‚¹ï¼š<strong>å¹¶å‘æ”¶é›†ã€ä½åœé¡¿</strong>ã€‚ç”±äºåœ¨æ•´ä¸ªè¿‡ç¨‹å’Œä¸­æœ€è€—æ—¶çš„å¹¶å‘æ ‡è®°å’Œ å¹¶å‘æ¸…é™¤è¿‡ç¨‹æ”¶é›†å™¨ç¨‹åºéƒ½å¯ä»¥å’Œç”¨æˆ·çº¿ç¨‹ä¸€èµ·å·¥ä½œï¼Œæ‰€ä»¥æ€»ä½“æ¥è¯´ï¼ŒCmsæ”¶é›†å™¨çš„å†…å­˜å›æ”¶è¿‡ç¨‹æ˜¯ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘æ‰§è¡Œçš„ã€‚</li><li>ç¼ºç‚¹ï¼š<ul><li>å¯¹CPUæ•æ„Ÿï¼Œå¹¶å‘é˜¶æ®µï¼Œè™½ç„¶ä¸ä¼šå¯¼è‡´ç”¨æˆ·çº¿ç¨‹åœé¡¿ï¼Œä½†æ˜¯ä¼šå› ä¸ºå ç”¨äº†ä¸€éƒ¨åˆ†çº¿ç¨‹ä½¿åº”ç”¨ç¨‹åºå˜æ…¢ï¼Œæ€»ååé‡ä¼šé™ä½</li><li>CMSåŸºäºæ ‡è®° - æ¸…é™¤ç®—æ³•ï¼Œä¼šå¯¼è‡´ç©ºé—´ç¢ç‰‡ï¼Œå¾€å¾€å‡ºç°è€å¹´ä»£ç©ºé—´å‰©ä½™ï¼Œä½†æ— æ³•æ‰¾åˆ°è¶³å¤Ÿå¤§è¿ç»­ç©ºé—´æ¥åˆ†é…å½“å‰å¯¹è±¡ï¼Œä¸å¾—ä¸æå‰è§¦å‘ä¸€æ¬¡ Full GCã€‚ï¼Œå½“ç„¶é€šè¿‡å‚æ•°- XX:+UseCMSCompactAtFullCollectionå¯ä»¥è®©jvmåœ¨æ‰§è¡Œå®Œæ ‡è®°æ¸…é™¤åå†åšæ•´ç† </li><li>æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ã€‚æµ®åŠ¨åƒåœ¾æ˜¯æŒ‡å¹¶å‘æ¸…é™¤é˜¶æ®µç”±äºç”¨æˆ·çº¿ç¨‹ç»§ç»­è¿è¡Œè€Œäº§ç”Ÿçš„åƒåœ¾ï¼Œè¿™éƒ¨åˆ†åƒåœ¾åªèƒ½åˆ°ä¸‹ä¸€æ¬¡ GC æ—¶æ‰èƒ½è¿›è¡Œå›æ”¶ã€‚ç”±äºæµ®åŠ¨åƒåœ¾çš„å­˜åœ¨ï¼Œå› æ­¤éœ€è¦é¢„ç•™å‡ºä¸€éƒ¨åˆ†å†…å­˜ï¼Œæ„å‘³ç€ CMS æ”¶é›†ä¸èƒ½åƒå…¶å®ƒæ”¶é›†å™¨é‚£æ ·ç­‰å¾…è€å¹´ä»£å¿«æ»¡çš„æ—¶å€™å†å›æ”¶ã€‚å¦‚æœé¢„ç•™çš„å†…å­˜ä¸å¤Ÿå­˜æ”¾æµ®åŠ¨åƒåœ¾ï¼Œå°±ä¼šå‡ºç° Concurrent Mode Failureï¼Œè¿™æ—¶è™šæ‹Ÿæœºå°†ä¸´æ—¶å¯ç”¨ Serial Old æ¥æ›¿ä»£ CMSã€‚</li></ul></li></ul></li><li><p><strong>CMSçš„ç›¸å…³æ ¸å¿ƒå‚æ•°</strong></p></li></ul><ol><li><p>-XX:+UseConcMarkSweepGCï¼šå¯ç”¨cms </p></li><li><p>-XX:ConcGCThreadsï¼šå¹¶å‘çš„GCçº¿ç¨‹æ•° </p></li><li><p>-XX:+UseCMSCompactAtFullCollectionï¼šFullGCä¹‹ååšå‹ç¼©æ•´ç†ï¼ˆå‡å°‘ç¢ç‰‡ï¼‰ </p></li><li><p>-XX:CMSFullGCsBeforeCompactionï¼šå¤šå°‘æ¬¡FullGCä¹‹åå‹ç¼©ä¸€æ¬¡ï¼Œé»˜è®¤æ˜¯0ï¼Œä»£è¡¨æ¯æ¬¡FullGCåéƒ½ä¼šå‹ç¼©ä¸€æ¬¡</p></li><li><p><strong>-XX:CMSInitiatingOccupancyFraction</strong>: å½“è€å¹´ä»£ä½¿ç”¨è¾¾åˆ°è¯¥æ¯”ä¾‹æ—¶ä¼šè§¦å‘FullGCï¼ˆé»˜è®¤æ˜¯92ï¼Œè¿™æ˜¯ç™¾åˆ†æ¯”ï¼‰ </p></li><li><p>-XX:+UseCMSInitiatingOccupancyOnlyï¼šåªä½¿ç”¨è®¾å®šçš„å›æ”¶é˜ˆå€¼(-XX:CMSInitiatingOccupancyFractionè®¾å®šçš„å€¼)ï¼Œå¦‚æœä¸æŒ‡å®šï¼ŒJVMä»…åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨è®¾å®šå€¼ï¼Œåç»­åˆ™ä¼šè‡ªåŠ¨è°ƒæ•´ </p></li><li><p>-XX:+CMSScavengeBeforeRemarkï¼šåœ¨CMS GCå‰å¯åŠ¨ä¸€æ¬¡minor gcï¼Œç›®çš„åœ¨äºå‡å°‘è€å¹´ä»£å¯¹å¹´è½»ä»£çš„å¼•ç”¨ï¼Œé™ä½CMS GCçš„æ ‡è®°é˜¶æ®µæ—¶çš„å¼€é”€ï¼Œä¸€èˆ¬CMSçš„GCè€—æ—¶ 80%éƒ½åœ¨æ ‡è®°é˜¶æ®µ </p></li><li><p>-XX:+CMSParallellnitialMarkEnabledï¼šè¡¨ç¤ºåœ¨åˆå§‹æ ‡è®°çš„æ—¶å€™å¤šçº¿ç¨‹æ‰§è¡Œï¼Œç¼©çŸ­STW </p></li><li><p>-XX:+CMSParallelRemarkEnabledï¼šåœ¨é‡æ–°æ ‡è®°çš„æ—¶å€™å¤šçº¿ç¨‹æ‰§è¡Œï¼Œç¼©çŸ­STW;</p></li></ol><blockquote><p><strong>åªå¯ä»¥ç”¨åœ¨è€å¹´ä»£ï¼Œä½¿ç”¨â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•</strong></p></blockquote><h2 id="2-5-G1æ”¶é›†å™¨"><a href="#2-5-G1æ”¶é›†å™¨" class="headerlink" title="2.5 G1æ”¶é›†å™¨"></a>2.5 <strong>G1æ”¶é›†å™¨</strong></h2><p><a href="https://pyr9.github.io/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B9%8BG1%E6%94%B6%E9%9B%86%E5%99%A8/">åƒåœ¾æ”¶é›†å™¨ä¹‹G1æ”¶é›†å™¨ - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p><h2 id="2-6-ZGCæ”¶é›†å™¨"><a href="#2-6-ZGCæ”¶é›†å™¨" class="headerlink" title="2.6 ZGCæ”¶é›†å™¨"></a>2.6 ZGCæ”¶é›†å™¨</h2><p><a href="https://pyr9.github.io/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B9%8BZGC%E6%94%B6%E9%9B%86%E5%99%A8/">åƒåœ¾æ”¶é›†å™¨ä¹‹ZGCæ”¶é›†å™¨ - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p><h1 id="3-åƒåœ¾å›æ”¶å™¨é€‰æ‹©"><a href="#3-åƒåœ¾å›æ”¶å™¨é€‰æ‹©" class="headerlink" title="3. åƒåœ¾å›æ”¶å™¨é€‰æ‹©?"></a>3. åƒåœ¾å›æ”¶å™¨é€‰æ‹©?</h1><ul><li><strong>JDK 1.8é»˜è®¤ä½¿ç”¨ Parallel</strong>ï¼Œ<strong>JDK 1.9é»˜ä¹‹åè®¤ä½¿ç”¨ G1</strong></li><li>100Mä»¥ä¸‹ç”¨Serialï¼Œç®€å•+é«˜æ•ˆ</li><li>4Gä»¥ä¸‹å¯ä»¥ç”¨parallelï¼Œå¹¶å‘æ”¶é›† + é«˜ååé‡ã€‚ï¼ˆæ ‡è®°æ•´ç†ï¼ŒSTWï¼‰</li><li>4-8Gå¯ä»¥ç”¨ParNew+CMSï¼Œå¹¶å‘æ”¶é›† + ä½åœé¡¿(æ³¨é‡ç”¨æˆ·ä½“éªŒï¼‰</li><li>8Gä»¥ä¸Šå¯ä»¥ç”¨G1ï¼Œé¿å…é•¿æ—¶é—´çš„åœé¡¿+å¯é¢„æœŸçš„GCåœé¡¿å‘¨æœŸ + é«˜ååé‡(ç­›é€‰å›æ”¶æ—¶éœ€è¦STW)</li><li>å‡ ç™¾Gä»¥ä¸Šç”¨ZGCï¼Œæ”¯æŒTBé‡çº§çš„å †+ æœ€å¤§GCåœé¡¿æ—¶é—´ä¸è¶…10ms</li></ul>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½è°ƒä¼˜</tag>
      
      <tag>åƒåœ¾æ”¶é›†ç®—æ³•</tag>
      
      <tag>åƒåœ¾æ”¶é›†å™¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¯¹è±¡å†…å­˜åˆ†é…</title>
    <link href="/%E5%AF%B9%E8%B1%A1%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/"/>
    <url>/%E5%AF%B9%E8%B1%A1%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/</url>
    
    <content type="html"><![CDATA[<h1 id="å¯¹è±¡å†…å­˜åˆ†é…ç­–ç•¥"><a href="#å¯¹è±¡å†…å­˜åˆ†é…ç­–ç•¥" class="headerlink" title="å¯¹è±¡å†…å­˜åˆ†é…ç­–ç•¥"></a>å¯¹è±¡å†…å­˜åˆ†é…ç­–ç•¥</h1><ul><li>JVMé€šè¿‡<strong>é€ƒé€¸åˆ†æ</strong>ç¡®å®šè¯¥å¯¹è±¡ä¸ä¼šè¢«å¤–éƒ¨è®¿é—®ã€‚å¦‚æœä¸ä¼šé€ƒé€¸å¯ä»¥å°†è¯¥å¯¹è±¡åœ¨<strong>æ ˆä¸Šåˆ†é…</strong>å†…å­˜</li><li>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£ä¸­ Eden åŒºåˆ†é…ã€‚</li><li><strong>å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£</strong></li><li><strong>é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£</strong> </li><li><strong>å¯¹è±¡åŠ¨æ€å¹´é¾„åˆ¤æ–­</strong></li><li><strong>è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿æœºåˆ¶</strong></li></ul><h2 id="å¯¹è±¡æ ˆä¸Šåˆ†é…"><a href="#å¯¹è±¡æ ˆä¸Šåˆ†é…" class="headerlink" title="å¯¹è±¡æ ˆä¸Šåˆ†é…"></a><strong>å¯¹è±¡æ ˆä¸Šåˆ†é…</strong></h2><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><ul><li><p>æˆ‘ä»¬é€šè¿‡JVMå†…å­˜åˆ†é…å¯ä»¥çŸ¥é“JAVAä¸­çš„å¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸Šè¿›è¡Œåˆ†é…ï¼Œå½“å¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨çš„æ—¶å€™ï¼Œéœ€è¦ä¾é GCè¿›è¡Œå›æ”¶å†…å­˜ï¼Œå¦‚æœå¯¹è±¡æ•°é‡è¾ƒå¤šçš„æ—¶å€™ï¼Œä¼šç»™GCå¸¦æ¥è¾ƒå¤§å‹åŠ›ï¼Œä¹Ÿé—´æ¥å½±å“äº†åº”ç”¨çš„æ€§èƒ½ã€‚</p></li><li><p>ä¸ºäº†å‡å°‘ä¸´æ—¶å¯¹è±¡åœ¨å †å†…åˆ†é…çš„æ•°é‡ï¼ŒJVMé€šè¿‡<strong>é€ƒé€¸åˆ†æ</strong>ç¡®å®šè¯¥å¯¹è±¡ä¸ä¼šè¢«å¤–éƒ¨è®¿é—®ã€‚å¦‚æœä¸ä¼šé€ƒé€¸å¯ä»¥å°†è¯¥å¯¹è±¡åœ¨<strong>æ ˆä¸Šåˆ†é…</strong>å†…å­˜ï¼Œè¿™æ ·è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å°±å¯ä»¥éšæ ˆå¸§å‡ºæ ˆè€Œé”€æ¯ï¼Œå°±å‡è½»äº†åƒåœ¾å›æ”¶çš„å‹åŠ›ã€‚</p></li></ul><h3 id="å¯¹è±¡é€ƒé€¸åˆ†æ"><a href="#å¯¹è±¡é€ƒé€¸åˆ†æ" class="headerlink" title="å¯¹è±¡é€ƒé€¸åˆ†æ"></a>å¯¹è±¡é€ƒé€¸åˆ†æ</h3><p><strong>å¯¹è±¡é€ƒé€¸åˆ†æ</strong>ï¼šå°±æ˜¯åˆ†æå¯¹è±¡åŠ¨æ€ä½œç”¨åŸŸï¼Œå½“ä¸€ä¸ªå¯¹è±¡åœ¨æ–¹æ³•ä¸­è¢«å®šä¹‰åï¼Œå®ƒå¯èƒ½è¢«å¤–éƒ¨æ–¹æ³•æ‰€å¼•ç”¨ï¼Œä¾‹å¦‚ä½œä¸ºè°ƒç”¨å‚æ•°ä¼ é€’åˆ°å…¶ä»–åœ°æ–¹ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">test1</span><span class="hljs-params">()</span> </span>&#123;<br>  User user = <span class="hljs-keyword">new</span> User();<br>  user.setId(<span class="hljs-number">1</span>);<br>  <span class="hljs-keyword">return</span> user;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">()</span> </span>&#123;<br>  User user = <span class="hljs-keyword">new</span> User();<br>  user.setId(<span class="hljs-number">1</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ˜¾ç„¶ï¼Œtest1æ–¹æ³•ä¸­çš„userå¯¹è±¡è¢«è¿”å›äº†ï¼Œè¿™ä¸ªå¯¹è±¡çš„ä½œç”¨åŸŸèŒƒå›´ä¸ç¡®å®šï¼Œtest2æ–¹æ³•ä¸­çš„userå¯¹è±¡æˆ‘ä»¬å¯ä»¥ç¡®å®šå½“æ–¹æ³•ç»“ æŸè¿™ä¸ªå¯¹è±¡å°±å¯ä»¥è®¤ä¸ºæ˜¯æ— æ•ˆå¯¹è±¡äº†ï¼Œå¯¹äºè¿™æ ·çš„å¯¹è±¡æˆ‘ä»¬å…¶å®å¯ä»¥å°†å…¶åˆ†é…åœ¨æ ˆå†…å­˜é‡Œï¼Œè®©å…¶åœ¨æ–¹æ³•ç»“æŸæ—¶è·Ÿéšæ ˆå†… å­˜ä¸€èµ·è¢«å›æ”¶æ‰ã€‚</p><p>JVMå¯¹äºè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡å¼€å¯é€ƒé€¸åˆ†æå‚æ•°(-XX:+DoEscapeAnalysis)æ¥ä¼˜åŒ–å¯¹è±¡å†…å­˜åˆ†é…ä½ç½®ï¼Œä½¿å…¶é€šè¿‡<strong>æ ‡é‡æ›¿æ¢</strong>ä¼˜å…ˆåˆ†é…åœ¨æ ˆä¸Š(<strong>æ ˆä¸Šåˆ†é…</strong>ï¼‰ï¼ŒJDK7ä¹‹åé»˜è®¤å¼€å¯é€ƒé€¸åˆ†æï¼Œå¦‚æœè¦å…³é—­ä½¿ç”¨å‚æ•°(-XX:-DoEscapeAnalysis)</p><blockquote><p><strong>æ ‡é‡æ›¿æ¢ï¼š</strong>é€šè¿‡é€ƒé€¸åˆ†æç¡®å®šè¯¥å¯¹è±¡ä¸ä¼šè¢«å¤–éƒ¨è®¿é—®ï¼Œå¹¶ä¸”å¯¹è±¡å¯ä»¥è¢«è¿›ä¸€æ­¥åˆ†è§£æ—¶ï¼Œ<strong>JVMä¸ä¼šåˆ›å»ºè¯¥å¯¹è±¡</strong>ï¼Œè€Œæ˜¯å°†è¯¥å¯¹è±¡æˆå‘˜å˜é‡åˆ†è§£è‹¥å¹²ä¸ªè¢«è¿™ä¸ªæ–¹æ³•ä½¿ç”¨çš„æˆå‘˜å˜é‡æ‰€ä»£æ›¿ï¼Œè¿™äº›ä»£æ›¿çš„æˆå‘˜å˜é‡åœ¨æ ˆå¸§æˆ–å¯„å­˜å™¨ä¸Šåˆ†é…ç©ºé—´ï¼Œè¿™æ ·å°±ä¸ä¼šå› ä¸ºæ²¡æœ‰ä¸€å¤§å—è¿ç»­ç©ºé—´å¯¼è‡´å¯¹è±¡å†…å­˜ä¸å¤Ÿåˆ†é…ã€‚å¼€å¯æ ‡é‡æ›¿æ¢å‚æ•°(-XX:+EliminateAllocations)ï¼ŒJDK7ä¹‹åé»˜è®¤å¼€å¯</p></blockquote><h3 id="æ ˆä¸Šåˆ†é…ç¤ºä¾‹"><a href="#æ ˆä¸Šåˆ†é…ç¤ºä¾‹" class="headerlink" title="æ ˆä¸Šåˆ†é…ç¤ºä¾‹"></a><strong>æ ˆä¸Šåˆ†é…ç¤ºä¾‹</strong></h3><p>ä»£ç è°ƒç”¨äº†1äº¿æ¬¡test()ï¼Œå¦‚æœæ˜¯åˆ†é…åˆ°å †ä¸Šï¼Œå¤§æ¦‚éœ€è¦1GBä»¥ä¸Šå †ç©ºé—´ï¼Œå¦‚æœå †ç©ºé—´å°äºè¯¥å€¼ï¼Œå¿…ç„¶ä¼šè§¦å‘GCã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DoEscapeAnalysis</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100000000</span>; i++) &#123;<br>      test();<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>    User user = <span class="hljs-keyword">new</span> User();<br>    user.setId(<span class="hljs-number">1</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ä½¿ç”¨å¦‚ä¸‹å‚æ•°ä¸ä¼šå‘ç”ŸGC</li></ul>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">â€Xmx15m â€Xms15m â€XX:+DoEscapeAnalysis â€XX:+PrintGC â€XX:+EliminateAllocations<br></code></pre></td></tr></table></figure><p>  <img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232619185.png" alt="image-20230228232619185"></p><ul><li>ä½¿ç”¨å¦‚ä¸‹å‚æ•°éƒ½ä¼šå‘ç”Ÿå¤§é‡GC</li></ul>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">â€Xmx15m â€Xms15m â€XX:â€DoEscapeAnalysis â€XX:+PrintGC â€XX:+EliminateAllocations<br>â€Xmx15m â€Xms15m â€XX:+DoEscapeAnalysis â€XX:+PrintGC â€XX:â€EliminateAllocations<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232628497.png" alt="image-20230228232628497"></p><h2 id="å¯¹è±¡åœ¨EdenåŒºåˆ†é…"><a href="#å¯¹è±¡åœ¨EdenåŒºåˆ†é…" class="headerlink" title="å¯¹è±¡åœ¨EdenåŒºåˆ†é…"></a><strong>å¯¹è±¡åœ¨EdenåŒºåˆ†é…</strong></h2><ul><li><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£ä¸­ Eden åŒºåˆ†é…ã€‚å½“ Eden åŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œåˆ†é…æ—¶ï¼Œè™šæ‹Ÿæœºå°†å‘èµ·ä¸€æ¬¡Minor GCã€‚</p></li><li><p><strong>Edenä¸SurvivoråŒºé»˜è®¤8:1:1</strong> </p></li><li><p>è¿‡ç¨‹</p><ul><li>å¤§é‡çš„å¯¹è±¡è¢«åˆ†é…åœ¨edenåŒºï¼ŒedenåŒºæ»¡äº†åä¼šè§¦å‘minor gcï¼Œå¯èƒ½ä¼šæœ‰99%ä»¥ä¸Šçš„å¯¹è±¡æˆä¸ºåƒåœ¾è¢«å›æ”¶æ‰</li><li>å‰©ä½™å­˜æ´»çš„å¯¹è±¡ä¼šè¢«æŒªåˆ°ä¸ºç©ºçš„é‚£å—survivoråŒº</li><li>ä¸‹ä¸€æ¬¡edenåŒºæ»¡äº†ååˆä¼šè§¦å‘minor gcï¼ŒæŠŠedenåŒºå’ŒsurvivoråŒºåƒåœ¾å¯¹è±¡å›æ”¶ï¼ŒæŠŠå‰©ä½™å­˜æ´»çš„å¯¹è±¡ä¸€æ¬¡æ€§æŒªåŠ¨åˆ°å¦å¤–ä¸€å—ä¸ºç©ºçš„survivoråŒº</li><li>å› ä¸ºæ–°ç”Ÿä»£çš„å¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•æ­»çš„ï¼Œå­˜æ´»æ—¶é—´å¾ˆçŸ­ï¼Œæ‰€ä»¥JVMé»˜è®¤çš„8:1:1çš„æ¯”ä¾‹æ˜¯å¾ˆåˆé€‚çš„ï¼Œ<strong>è®©edenåŒºå°½é‡çš„å¤§ï¼ŒsurvivoråŒºå¤Ÿç”¨å³å¯</strong></li><li>JVMé»˜è®¤æœ‰è¿™ä¸ªå‚æ•°-XX:+UseAdaptiveSizePolicy(é»˜è®¤å¼€å¯)ï¼Œä¼šå¯¼è‡´è¿™ä¸ª8:1:1æ¯”ä¾‹è‡ªåŠ¨å˜åŒ–ï¼Œå¦‚æœä¸æƒ³è¿™ä¸ªæ¯”ä¾‹æœ‰å˜åŒ–å¯ä»¥è®¾ç½®å‚æ•°-XX:-UseAdaptiveSizePolicy</li></ul></li></ul><h2 id="å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£"><a href="#å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£" class="headerlink" title="å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£"></a><strong>å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£</strong></h2><p>å¤§å¯¹è±¡å°±æ˜¯éœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼ˆæ¯”å¦‚ï¼šå­—ç¬¦ä¸²ã€æ•°ç»„ï¼‰ã€‚JVMå‚æ•° -XX:PretenureSizeThreshold å¯ä»¥è®¾ç½®å¤§å¯¹è±¡çš„å¤§å°ï¼Œå¦‚æœå¯¹è±¡è¶…è¿‡è®¾ç½®å¤§å°ä¼šç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œä¸ä¼šè¿›å…¥</p><p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·å‘¢ï¼Ÿ</strong></p><p>ä¸ºäº†é¿å…ä¸ºå¤§å¯¹è±¡GCæ—¶ï¼Œå¤šæ¬¡åœ¨survivorä¸Šæ¥å›å¤åˆ¶è€Œé™ä½æ•ˆç‡ã€‚</p><h2 id="é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£"><a href="#é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£" class="headerlink" title="é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£"></a>é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£</h2><ul><li><p>ä¸ºæ¯ä¸ªå¯¹è±¡å®šä¹‰å¹´é¾„è®¡æ•°å™¨ï¼Œå¯¹è±¡åœ¨ Eden å‡ºç”Ÿå¹¶ç»è¿‡ Minor GC ä¾ç„¶å­˜æ´»ï¼Œå°†ç§»åŠ¨åˆ° Survivor ä¸­ï¼Œå¹´é¾„å°±å¢åŠ  1 å²ï¼Œå¢åŠ åˆ°ä¸€å®šå¹´é¾„åˆ™ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ã€‚ï¼ˆé»˜è®¤ 15 å²ï¼ŒCMSæ”¶é›†å™¨é»˜è®¤6å²ï¼Œä¸åŒçš„åƒåœ¾æ”¶é›†å™¨ä¼šç•¥å¾®æœ‰ç‚¹ä¸åŒ)</p></li><li><p>å¯¹è±¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼ï¼Œå¯ä»¥é€šè¿‡å‚æ•° -XX:MaxTenuringThreshold æ¥è®¾ç½®</p></li></ul><h2 id="å¯¹è±¡åŠ¨æ€å¹´é¾„åˆ¤æ–­"><a href="#å¯¹è±¡åŠ¨æ€å¹´é¾„åˆ¤æ–­" class="headerlink" title="å¯¹è±¡åŠ¨æ€å¹´é¾„åˆ¤æ–­"></a><strong>å¯¹è±¡åŠ¨æ€å¹´é¾„åˆ¤æ–­</strong></h2><ul><li><p>å½“å‰æ”¾å¯¹è±¡çš„SurvivoråŒºåŸŸé‡Œ(å…¶ä¸­ä¸€å—åŒºåŸŸï¼Œæ”¾å¯¹è±¡çš„é‚£å—såŒº)ï¼Œä¸€æ‰¹å¯¹è±¡çš„æ€»å¤§å°å¤§äºè¿™å—SurvivoråŒºåŸŸå†…å­˜å¤§å°çš„ 50%(XX:TargetSurvivorRatioå¯ä»¥æŒ‡å®š)ï¼Œé‚£ä¹ˆæ­¤æ—¶<strong>å¤§äºç­‰äº</strong>è¿™æ‰¹å¯¹è±¡å¹´é¾„æœ€å¤§å€¼çš„å¯¹è±¡ï¼Œå°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£äº†ï¼Œ </p></li><li><p>ä¾‹å¦‚SurvivoråŒºåŸŸé‡Œç°åœ¨æœ‰ä¸€æ‰¹å¯¹è±¡ï¼Œå¹´é¾„1+å¹´é¾„2+å¹´é¾„nçš„å¤šä¸ªå¹´é¾„å¯¹è±¡æ€»å’Œè¶…è¿‡äº†SurvivoråŒºåŸŸçš„50%ï¼Œæ­¤æ—¶å°±ä¼šæŠŠå¹´é¾„n(å«)ä»¥ä¸Šçš„å¯¹è±¡éƒ½æ”¾å…¥è€å¹´ä»£ã€‚</p></li><li><p><strong>å¯¹è±¡åŠ¨æ€å¹´</strong> <strong>é¾„åˆ¤æ–­æœºåˆ¶ä¸€èˆ¬æ˜¯åœ¨minor gcä¹‹åè§¦å‘çš„ã€‚</strong></p></li></ul><p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·å‘¢</strong>ï¼Ÿ</p><p>è¿™ä¸ªè§„åˆ™å…¶å®æ˜¯å¸Œæœ›é‚£äº›å¯èƒ½æ˜¯é•¿æœŸå­˜æ´»çš„å¯¹è±¡ï¼Œå°½æ—©è¿›å…¥è€å¹´ä»£ã€‚</p><h2 id="è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿æœºåˆ¶"><a href="#è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿æœºåˆ¶" class="headerlink" title="è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿æœºåˆ¶"></a><strong>è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿æœºåˆ¶</strong></h2><ul><li>åœ¨å‘ç”Ÿ Minor GC ä¹‹å‰ï¼Œè™šæ‹Ÿæœºå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ï¼Œ</li><li>å¦‚æœæ¡ä»¶æˆç«‹çš„è¯ï¼Œé‚£ä¹ˆ Minor GC å¯ä»¥ç¡®è®¤æ˜¯å®‰å…¨çš„ã€‚</li><li>å¦‚æœä¸æˆç«‹çš„è¯è™šæ‹Ÿæœºä¼šæŸ¥çœ‹ â€œ-XX:-HandlePromotionFailureâ€ çš„å‚æ•°æ˜¯å¦è®¾ç½®äº†(jdk1.8é»˜è®¤å°±è®¾ç½®äº†)ï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ï¼Œ<ul><li>å¦‚æœå…è®¸ï¼Œå°±ä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œå¦‚æœå¤§äºï¼Œå°†å°è¯•ç€è¿›è¡Œä¸€æ¬¡ Minor GCï¼›å¦‚æœå°äºï¼Œä¼šè§¦å‘full gcã€‚</li><li>ä¸å…è®¸ï¼Œä¼šè§¦å‘Full GC</li></ul></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232645030.png" alt="image-20230228232645030"></p>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½è°ƒä¼˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVMå†…å­˜å‚æ•°è®¾ç½®</title>
    <link href="/JVM%E5%86%85%E5%AD%98%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE/"/>
    <url>/JVM%E5%86%85%E5%AD%98%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="JVMå†…å­˜å‚æ•°è®¾ç½®"><a href="#JVMå†…å­˜å‚æ•°è®¾ç½®" class="headerlink" title="JVMå†…å­˜å‚æ•°è®¾ç½®"></a><strong>JVMå†…å­˜å‚æ•°è®¾ç½®</strong></h1><h2 id="JVMå‚æ•°è®¾ç½®æ ¼å¼"><a href="#JVMå‚æ•°è®¾ç½®æ ¼å¼" class="headerlink" title="JVMå‚æ•°è®¾ç½®æ ¼å¼"></a>JVMå‚æ•°è®¾ç½®æ ¼å¼</h2><p>Spring Bootç¨‹åºçš„JVMå‚æ•°è®¾ç½®æ ¼å¼(Tomcatå¯åŠ¨ç›´æ¥åŠ åœ¨binç›®å½•ä¸‹catalina.shæ–‡ä»¶é‡Œ)ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">java â€Xms2048M â€Xmx2048M â€Xmn1024M â€Xss512K â€XX:MetaspaceSize=256M â€XX:MaxMetaspaceSize=256M â€jar microserviceâ€eurekaâ€server.jar <br></code></pre></td></tr></table></figure><h2 id="å…ƒç©ºé—´çš„JVMå‚æ•°"><a href="#å…ƒç©ºé—´çš„JVMå‚æ•°" class="headerlink" title="å…ƒç©ºé—´çš„JVMå‚æ•°"></a>å…ƒç©ºé—´çš„JVMå‚æ•°</h2><ul><li><p>å…³äºå…ƒç©ºé—´çš„JVMå‚æ•°æœ‰ä¸¤ä¸ªï¼š-XX:MetaspaceSize&#x3D;Nå’Œ -XX:MaxMetaspaceSize&#x3D;N</p><ul><li><p><strong>-XXï¼šMaxMetaspaceSize</strong>ï¼š è®¾ç½®å…ƒç©ºé—´æœ€å¤§å€¼ï¼Œ é»˜è®¤æ˜¯-1ï¼Œ å³ä¸é™åˆ¶ï¼Œ æˆ–è€…è¯´åªå—é™äºæœ¬åœ°å†…å­˜å¤§å°ã€‚ </p></li><li><p><strong>-XXï¼šMetaspaceSize</strong>ï¼š æŒ‡å®šå…ƒç©ºé—´è§¦å‘Fullgcçš„åˆå§‹é˜ˆå€¼(å…ƒç©ºé—´æ— å›ºå®šåˆå§‹å¤§å°)ï¼Œ ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œé»˜è®¤æ˜¯21Mï¼Œè¾¾åˆ°è¯¥å€¼å°±ä¼šè§¦å‘full gcï¼Œ åŒæ—¶æ”¶é›†å™¨ä¼šå¯¹è¯¥å€¼è¿›è¡Œè°ƒæ•´ï¼š å¦‚æœé‡Šæ”¾äº†å¤§é‡çš„ç©ºé—´ï¼Œ å°±é€‚å½“é™ä½è¯¥å€¼ï¼› å¦‚æœé‡Šæ”¾äº†å¾ˆå°‘çš„ç©ºé—´ï¼Œ é‚£ä¹ˆåœ¨ä¸è¶…è¿‡-XXï¼šMaxMetaspaceSizeï¼ˆå¦‚æœè®¾ç½®äº†çš„è¯ï¼‰ çš„æƒ…å†µä¸‹ï¼Œ é€‚å½“æé«˜è¯¥å€¼ã€‚ï¼ˆæ¯”å¦‚åˆå§‹å€¼æ˜¯21Mï¼Œfull gcåï¼Œé‡Šæ”¾äº†20Mï¼Œåªå‰©1Mï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±ä¼šå°†è¯¥å€¼è°ƒæˆ2Mï¼›ç›¸åï¼Œå¦‚æœé‡Šæ”¾äº†1Mï¼Œè¿˜å‰©20Mï¼Œä¸‹æ¬¡å°±ä¼šè°ƒæ•´åˆ°40Mï¼‰</p></li></ul></li><li><p>ç”±äºè°ƒæ•´å…ƒç©ºé—´çš„å¤§å°éœ€è¦Full GCï¼Œè¿™æ˜¯éå¸¸æ˜‚è´µçš„æ“ä½œï¼Œå¦‚æœåº”ç”¨åœ¨å¯åŠ¨çš„æ—¶å€™å‘ç”Ÿå¤§é‡Full GCï¼Œé€šå¸¸éƒ½æ˜¯ç”±äºæ°¸ä¹…ä»£æˆ–å…ƒç©ºé—´å‘ç”Ÿ äº†å¤§å°è°ƒæ•´ï¼ŒåŸºäºè¿™ç§æƒ…å†µï¼Œä¸€èˆ¬å»ºè®®åœ¨JVMå‚æ•°ä¸­å°†MetaspaceSizeå’ŒMaxMetaspaceSizeè®¾ç½®æˆä¸€æ ·çš„å€¼ï¼Œå¹¶è®¾ç½®å¾—æ¯”åˆå§‹å€¼è¦å¤§ã€‚</p></li><li><p>å¯¹äº8Gç‰©ç†å†…å­˜çš„æœºå™¨æ¥è¯´ï¼Œä¸€èˆ¬æˆ‘ä¼šå°†è¿™ä¸¤ä¸ªå€¼éƒ½è®¾ç½®ä¸º256Mã€‚å¸¸è§çš„é—®é¢˜ï¼šé¡¹ç›®jaråŒ…åªæœ‰1Gï¼Œä½†æ˜¯å¯åŠ¨äº†å¥½ä¹…ï¼Œå°±å¯èƒ½æ˜¯å› ä¸ºç”±äºå…ƒç©ºé—´è®¾ç½®çš„å¤ªå°ï¼Œä¸€ç›´åœ¨è§¦å‘full GCã€‚</p></li></ul><h2 id="æ ˆçš„JVMå‚æ•°"><a href="#æ ˆçš„JVMå‚æ•°" class="headerlink" title="æ ˆçš„JVMå‚æ•°"></a>æ ˆçš„JVMå‚æ•°</h2><p>Xssè®¾ç½®è¶Šå°ï¼Œè¯´æ˜ä¸€ä¸ªçº¿ç¨‹æ ˆé‡Œèƒ½åˆ†é…çš„æ ˆå¸§å°±è¶Šå°‘ï¼Œä½†æ˜¯å¯¹JVMæ•´ä½“æ¥è¯´èƒ½å¼€å¯çš„çº¿ç¨‹æ•°ä¼šæ›´å¤š </p><p><strong>StackOverflowError</strong>ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StackOverflowTest</span> </span>&#123;<br>    <br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">redo</span><span class="hljs-params">()</span> </span>&#123;<br>        count++;<br>        redo();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            redo();<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable t) &#123;<br>            t.printStackTrace();<br>            System.out.println(count);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œä»£ç ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224131501.png" alt="image-20230228224131501"></p><p>è°ƒæ•´-Xsså‚æ•°ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224141154.png" alt="image-20230228224141154"></p><p>æ‰“å°ç»“æœï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224149027.png" alt="image-20230228224149027"></p>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½è°ƒä¼˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVMå†…å­˜æ¨¡å‹</title>
    <link href="/JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/"/>
    <url>/JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="JVMå†…å­˜æ¨¡å‹"><a href="#JVMå†…å­˜æ¨¡å‹" class="headerlink" title="JVMå†…å­˜æ¨¡å‹"></a>JVMå†…å­˜æ¨¡å‹</h1><p>JVMå†…å­˜æ¨¡å‹æ€»ä½“æ¥è¯´åˆ†ä¸ºäº”å¤§å—ã€‚åˆ†åˆ«æ˜¯ï¼šjavaå †ï¼Œæ–¹æ³•åŒºï¼ˆ1.8åå«å…ƒç©ºé—´ï¼‰è™šæ‹Ÿæœºæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œä»¥åŠç¨‹åºè®¡æ•°å™¨ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyOTIyNjQ3,size_16,color_FFFFFF,t_70.png" alt="img"></p><h2 id="1-å †"><a href="#1-å †" class="headerlink" title="1 å †"></a>1 å †</h2><p>javaå †æ˜¯javaè™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ã€‚å®ƒç”¨æ¥å­˜æ”¾å¯¹è±¡å®ä¾‹å’Œæ•°ç»„ã€‚</p><ul><li><p>åœ¨ Java ä¸­ï¼Œå †è¢«åˆ’åˆ†æˆä¸¤ä¸ªä¸åŒçš„åŒºåŸŸï¼šæ–°ç”Ÿä»£ ( Young )ã€è€å¹´ä»£ ( Old )ï¼Œ 1.8ä¹‹å‰è¿˜åŒ…æ‹¬æ–¹æ³•åŒºã€‚æ–°ç”Ÿä»£ ( Young ) åˆè¢«åˆ’åˆ†ä¸ºä¸‰ä¸ªåŒºåŸŸï¼šEdenã€From Survivorã€To Survivorã€‚</p></li><li><p>çº¿ç¨‹å…±äº«ã€‚javaå †æ˜¯è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºã€‚</p></li><li><p>javaå †æ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œå› æ­¤å¾ˆå¤šæ—¶å€™ä¹Ÿè¢«ç§°ä½œ â€œGCå †â€ï¼ˆGarbage Collection Heapï¼‰ã€‚</p></li><li><p>javaå †å¯ä»¥å¤„äºç‰©ç†ä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œåªè¦é€»è¾‘ä¸Šè¿ç»­å³å¯ã€‚</p></li><li><p>å¦‚æœåœ¨å †ä¸­æ²¡æœ‰å†…å­˜å®Œæˆå®ä¾‹åˆ†é…ï¼Œå¹¶ä¸”å †ä¹Ÿæ— æ³•å†æ‰©å±•æ—¶ï¼Œåˆ™ä¼šæŠ›å‡ºOut Of Memory Error ã€‚</p></li><li><p>å…¶å¤§å°é€šè¿‡-Xms(æœ€å°å€¼)å’Œ-Xmx(æœ€å¤§å€¼)å‚æ•°è®¾ç½®ï¼ˆæœ€å¤§æœ€å°å€¼éƒ½è¦å°äº1Gï¼‰ï¼Œå‰è€…ä¸ºå¯åŠ¨æ—¶ç”³è¯·çš„æœ€å°å†…å­˜ï¼Œé»˜è®¤ä¸ºæ“ä½œç³»ç»Ÿç‰©ç†å†…å­˜çš„1&#x2F;64ï¼Œåè€…ä¸ºJVMå¯ç”³è¯·çš„æœ€å¤§å†…å­˜,é»˜è®¤ä¸ºç‰©ç†å†…å­˜çš„1&#x2F;4ï¼Œé»˜è®¤å½“ç©ºä½™å †å†…å­˜å°äº40%æ—¶ï¼ŒJVMä¼šå¢å¤§å †å†…å­˜åˆ°-XmxæŒ‡å®šçš„å¤§å°ï¼Œå¯é€šè¿‡-XX:MinHeapFreeRation&#x3D;æ¥æŒ‡å®šè¿™ä¸ªæ¯”åˆ—ã€‚</p></li><li><p>åœ¨æˆ‘ä»¬åƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾€å¾€å°†å †å†…å­˜åˆ†æˆæ–°ç”Ÿä»£å’Œè€ç”Ÿä»£ï¼ˆå¤§å°æ¯”ä¾‹1ï¼š2ï¼‰ï¼Œæ–°ç”Ÿä»£ä¸­ç”±Edenå’ŒSurvivor0ï¼ŒSurvivor1ç»„æˆï¼Œä¸‰è€…çš„æ¯”ä¾‹æ˜¯8ï¼š1ï¼š1ï¼Œæ–°ç”Ÿä»£çš„å›æ”¶æœºåˆ¶é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼Œåœ¨Minor GCçš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ç•™ä¸€ä¸ªå­˜æ´»åŒºç”¨æ¥å­˜æ”¾å­˜æ´»çš„å¯¹è±¡ï¼ŒçœŸæ­£è¿›è¡Œçš„åŒºåŸŸæ˜¯Eden+å…¶ä¸­ä¸€ä¸ªå­˜æ´»åŒºï¼Œå½“æˆ‘ä»¬çš„å¯¹è±¡æ—¶é•¿è¶…è¿‡ä¸€å®šå¹´é¾„æ—¶ï¼ˆé»˜è®¤15ï¼Œå¯ä»¥é€šè¿‡å‚æ•°è®¾ç½®ï¼‰ï¼Œå°†ä¼šæŠŠå¯¹è±¡æ”¾å…¥è€ç”Ÿä»£ï¼Œå½“ç„¶å¤§çš„å¯¹è±¡ä¼šç›´æ¥è¿›å…¥è€ç”Ÿä»£ï¼Œè€ç”Ÿä»£é‡‡ç”¨çš„å›æ”¶ç®—æ³•æ˜¯æ ‡è®°æ•´ç†ç®—æ³•ã€‚</p></li></ul><h2 id="2-æ–¹æ³•åŒº"><a href="#2-æ–¹æ³•åŒº" class="headerlink" title="2 æ–¹æ³•åŒº"></a>2 æ–¹æ³•åŒº</h2><ul><li><p>æ–¹æ³•åŒºä¸javaå †ä¸€æ ·ï¼Œæ˜¯çº¿ç¨‹å…±äº«çš„åŒºåŸŸï¼Œå®ƒé‡Œé¢å­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„<strong>ç±»ä¿¡æ¯ã€å­—æ®µä¿¡æ¯ã€æ–¹æ³•ä¿¡æ¯ã€é™æ€å˜é‡ã€å¸¸é‡</strong>ç­‰æ•°æ®ã€‚</p></li><li><p>æ–¹æ³•åŒºç±»ä¼¼Javaçš„æ¥å£ï¼Œè€Œè™šæ‹Ÿæœºçš„å®ç°æ–¹å¼ï¼Œåœ¨1.8ä¹‹å‰æ˜¯æ°¸ä¹…ä»£ï¼Œ1.8ä¹‹åæ˜¯å…ƒç©ºé—´ã€‚</p></li></ul><p><strong>ä¸ºä»€ä¹ˆè¦å°†æ°¸ä¹…ä»£æ›¿æ¢æˆå…ƒç©ºé—´å‘¢ï¼Ÿ</strong></p><p>å› ä¸ºæ°¸ä¹…ä»£ä½¿ç”¨çš„æ˜¯è™šæ‹Ÿæœºè®¾ç½®çš„å†…å­˜ï¼Œæœ‰ä¸€ä¸ª JVM æœ¬èº«è®¾ç½®çš„å›ºå®šå¤§å°ä¸Šé™ï¼Œæ— æ³•è¿›è¡Œè°ƒæ•´ï¼Œè€Œå…ƒç©ºé—´ä½¿ç”¨çš„æ˜¯ç›´æ¥å†…å­˜ï¼Œå—æœ¬æœºå¯ç”¨å†…å­˜çš„é™åˆ¶ï¼Œè™½ç„¶å…ƒç©ºé—´ä»æ—§å¯èƒ½æº¢å‡ºï¼Œä½†æ˜¯æ¯”åŸæ¥å‡ºç°çš„å‡ ç‡ä¼šæ›´å°ï¼Œå¹¶ä¸”å¯ä»¥åŠ è½½æ›´å¤šçš„ç±»ã€‚</p><h2 id="3-æ ˆ"><a href="#3-æ ˆ" class="headerlink" title="3 æ ˆ"></a>3 æ ˆ</h2><p>   è™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰æè¿°çš„æ˜¯javaæ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼‰æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼šæ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„æ—¶å€™éƒ½æœ‰ä¸€ä¸ªæ ˆå¸§,ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ï¼Œæ“ä½œæ•°æ ˆï¼ŒåŠ¨æ€é“¾æ¥ï¼Œæ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨åˆ°æ‰§è¡Œå°±å¯¹åº”äº†ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚</p><ul><li>çº¿ç¨‹ç§æœ‰ã€‚ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒã€‚</li><li>åœ¨javaè™šæ‹Ÿæœºè§„èŒƒä¸­ï¼Œè¿™ä¸ªåŒºåŸŸè§„å®šäº†ä¸¤ç§å¼‚å¸¸çŠ¶å†µã€‚ä¸€æ˜¯ Stack Overflow Error å¼‚å¸¸ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦</li><li>äºŒæ˜¯Out Of Memory Error å¦‚æœæ‰€åœ¨è™šæ‹Ÿæœºå¯ä»¥æ‰©å±•ï¼Œå½“å®ƒæ‰©å±•æ—¶æ— æ³•å¾—åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼Œåˆ™ä¼šæŠ›å‡ºè¯¥å¼‚å¸¸ã€‚</li></ul><h2 id="4-æœ¬åœ°æ–¹æ³•æ ˆ"><a href="#4-æœ¬åœ°æ–¹æ³•æ ˆ" class="headerlink" title="4 æœ¬åœ°æ–¹æ³•æ ˆ"></a>4 æœ¬åœ°æ–¹æ³•æ ˆ</h2><p>   æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰ä¸è™šæ‹Ÿæœºæ ˆå‘æŒ¥çš„ä½œç”¨æ˜¯ç›¸ä¼¼çš„ï¼Œä¸åŒç‚¹åœ¨äºè™šæ‹Ÿæœºæ ˆæ‰§è¡Œçš„æ˜¯javaæ–¹æ³•æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆæ˜¯ä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„Nativeæ–¹æ³•æœåŠ¡ã€‚æœ‰çš„è™šæ‹Ÿæœºç›´æ¥æŠŠè™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆåˆäºŒä¸ºä¸€ï¼Œä¸è™šæ‹Ÿæœºæ ˆä¸€æ ·ï¼Œæœ¬åœ°æ–¹æ³•æ ˆä¹Ÿä¼šæŠ›å‡ºStack Overflow Errorå’ŒOut Of Memory Errorå¼‚å¸¸ã€‚</p><h2 id="5-ç¨‹åºè®¡æ•°å™¨"><a href="#5-ç¨‹åºè®¡æ•°å™¨" class="headerlink" title="5 ç¨‹åºè®¡æ•°å™¨"></a>5 ç¨‹åºè®¡æ•°å™¨</h2><p>   ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå¯çœ‹åšå½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç è¡Œå·æŒ‡ä»¤å™¨ï¼Œå­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰æ‹©ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</p><ul><li>çº¿ç¨‹ç§æœ‰ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œä¸ªçº¿ç¨‹ä¹‹é—´è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œç‹¬ç«‹å­˜å‚¨</li><li>å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªjavaæ–¹æ³•ï¼Œåˆ™è®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼›å¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯nativeæ–¹æ³•ï¼Œåˆ™è¿™ä¸ªè®¡æ•°å™¨ä¸ºç©ºã€‚</li><li>æ­¤å†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨javaè™šæ‹Ÿæœºä¸­æ²¡æœ‰è§„å®š Out Of Memory Erroræƒ…å†µçš„åŒºåŸŸã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½è°ƒä¼˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javaå‘½ä»¤--jmapå·¥å…·</title>
    <link href="/java%E5%91%BD%E4%BB%A4--jmap%E5%B7%A5%E5%85%B7/"/>
    <url>/java%E5%91%BD%E4%BB%A4--jmap%E5%B7%A5%E5%85%B7/</url>
    
    <content type="html"><![CDATA[<h1 id="Jmap"><a href="#Jmap" class="headerlink" title="Jmap"></a><strong>Jmap</strong></h1><p>å‘½ä»¤jmapæ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½çš„å‘½ä»¤ã€‚å®ƒå¯ä»¥ç”Ÿæˆ java ç¨‹åºçš„ dump æ–‡ä»¶ï¼Œ ä¹Ÿå¯ä»¥æŸ¥çœ‹å †å†…å¯¹è±¡ç¤ºä¾‹çš„ç»Ÿè®¡ä¿¡æ¯ã€æŸ¥çœ‹ ClassLoader çš„ä¿¡æ¯ä»¥åŠ finalizer é˜Ÿåˆ—ã€‚</p><p><strong>ç³»ç»Ÿä¸­å†…å­˜é£™å‡äº†ï¼Œæ€ä¹ˆåŠï¼Ÿ</strong></p><p>ä½¿ç”¨jmapçœ‹çœ‹æ˜¯å¦æœ‰å¤§é‡ç±»ç”Ÿæˆ</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231003015.png" alt="image-20230228231003015"></p><h3 id="histo"><a href="#histo" class="headerlink" title="- histo"></a>- histo</h3><p>æŸ¥çœ‹å †å†…å­˜ä¿¡æ¯ï¼Œå®ä¾‹ä¸ªæ•°ä»¥åŠå ç”¨å†…å­˜å¤§å° </p><ul><li>å‘½ä»¤ï¼š <code> ~ jmap -histo 91656 &gt; ./log.txt</code></li><li>ç»“æœåˆ†æ<ul><li>numï¼šåºå· </li><li>instancesï¼šå®ä¾‹æ•°é‡ </li><li>bytesï¼šå ç”¨ç©ºé—´å¤§å° </li><li>class nameï¼šç±»åç§°   [C is a char[]ï¼Œ[S is a short[]ï¼Œ[I is a int[]ï¼Œ[B is a byte[]ï¼Œ[[I is a int[][]</li></ul></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231003015.png"></p><h3 id="â€dump"><a href="#â€dump" class="headerlink" title="â€dump"></a>â€dump</h3><p>ç”ŸæˆJavaè™šæ‹Ÿæœºçš„å †è½¬å‚¨å¿«ç…§dumpæ–‡ä»¶</p><ul><li><p>å‘½ä»¤ <code>jmap -dump:live,format=b,file=heap.bin &lt;pid&gt;</code></p></li><li><p>è¿è¡Œç»“æœ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  ~ jmap -dump:live,format=b,file=eureka.hprof <span class="hljs-number">3548</span><br>Dumping heap to /Users/panyurou/eureka.hprof ...<br></code></pre></td></tr></table></figure></li><li><p>ä¹Ÿå¯ä»¥è®¾ç½®å†…å­˜æº¢å‡ºè‡ªåŠ¨å¯¼å‡ºdumpæ–‡ä»¶(å†…å­˜å¾ˆå¤§çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå¯¼ä¸å‡ºæ¥) </p><ul><li>-XX:+HeapDumpOnOutOfMemoryError </li><li>-XX:HeapDumpPath&#x3D;.&#x2F; ï¼ˆè·¯å¾„ï¼‰</li></ul></li><li><p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OOMTest</span> </span>&#123;<br>  <span class="hljs-comment">// JVMè®¾ç½® :â€Xms10M â€Xmx10M â€XX:+PrintGCDetails</span><br>  <span class="hljs-comment">// â€XX:+HeapDumpOnOutOfMemoryError â€XX:HeapDumpPath=/Users/panyurou/jvm.hprof</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    List&lt;Object&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>      list.add(<span class="hljs-keyword">new</span> User(i++));<br>      <span class="hljs-keyword">new</span> User(j--);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œé…ç½®ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231024765.png" alt="image-20230228231024765"></p><p>è¿è¡Œç»“æœï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231032270.png" alt="image-20230228231032270"></p></li><li><p>ç”¨jvisualvmå‘½ä»¤å·¥å…·å¯¼å…¥è¯¥dumpæ–‡ä»¶åˆ†æ</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231039259.png" alt="image-20230228231039259"></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½è°ƒä¼˜</tag>
      
      <tag>javaå‘½ä»¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>kafkaçš„æ¶ˆæ¯é›¶ä¸¢å¤±æ–¹æ¡ˆ</title>
    <link href="/kafka%E7%9A%84%E6%B6%88%E6%81%AF%E9%9B%B6%E4%B8%A2%E5%A4%B1%E6%96%B9%E6%A1%88/"/>
    <url>/kafka%E7%9A%84%E6%B6%88%E6%81%AF%E9%9B%B6%E4%B8%A2%E5%A4%B1%E6%96%B9%E6%A1%88/</url>
    
    <content type="html"><![CDATA[<h1 id="Kafkaå¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Ÿ"><a href="#Kafkaå¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Ÿ" class="headerlink" title="Kafkaå¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Ÿ"></a>Kafkaå¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Ÿ</h1><h2 id="å“ªäº›ç¯èŠ‚ä¼šæœ‰ä¸¢æ¶ˆæ¯çš„å¯èƒ½ï¼Ÿ"><a href="#å“ªäº›ç¯èŠ‚ä¼šæœ‰ä¸¢æ¶ˆæ¯çš„å¯èƒ½ï¼Ÿ" class="headerlink" title="å“ªäº›ç¯èŠ‚ä¼šæœ‰ä¸¢æ¶ˆæ¯çš„å¯èƒ½ï¼Ÿ"></a>å“ªäº›ç¯èŠ‚ä¼šæœ‰ä¸¢æ¶ˆæ¯çš„å¯èƒ½ï¼Ÿ</h2><p><a href="https://pyr9.github.io/RabbitMQ%E7%9A%84%E6%B6%88%E6%81%AF%E9%9B%B6%E4%B8%A2%E5%A4%B1%E6%96%B9%E6%A1%88/#%E5%93%AA%E4%BA%9B%E7%8E%AF%E8%8A%82%E4%BC%9A%E6%9C%89%E4%B8%A2%E6%B6%88%E6%81%AF%E7%9A%84%E5%8F%AF%E8%83%BD%EF%BC%9F">RabbitMQçš„æ¶ˆæ¯é›¶ä¸¢å¤±æ–¹æ¡ˆ - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p><h2 id="Kafkaæ€ä¹ˆä¿è¯æ¶ˆæ¯å¯é æ€§"><a href="#Kafkaæ€ä¹ˆä¿è¯æ¶ˆæ¯å¯é æ€§" class="headerlink" title="Kafkaæ€ä¹ˆä¿è¯æ¶ˆæ¯å¯é æ€§?"></a>Kafkaæ€ä¹ˆä¿è¯æ¶ˆæ¯å¯é æ€§?</h2><h3 id="1-ç”Ÿäº§è€…ä¿è¯æ¶ˆæ¯æ­£ç¡®å‘é€åˆ°Kafka"><a href="#1-ç”Ÿäº§è€…ä¿è¯æ¶ˆæ¯æ­£ç¡®å‘é€åˆ°Kafka" class="headerlink" title="1. ç”Ÿäº§è€…ä¿è¯æ¶ˆæ¯æ­£ç¡®å‘é€åˆ°Kafka?"></a>1. ç”Ÿäº§è€…ä¿è¯æ¶ˆæ¯æ­£ç¡®å‘é€åˆ°Kafka?</h3><p>Kafkaé€šè¿‡é…ç½®request.required.ackså±æ€§æ¥ç¡®è®¤æ¶ˆæ¯çš„ç”Ÿäº§ï¼š</p><ul><li>0 ç”Ÿäº§è€…å°†æ•°æ®å‘é€å‡ºå»å°±ä¸ç®¡äº†ï¼Œä¸å»ç­‰å¾…ä»»ä½•è¿”å›ã€‚è¿™ç§æƒ…å†µä¸‹æ•°æ®ä¼ è¾“æ•ˆç‡æœ€é«˜ï¼Œä½†æ˜¯æ•°æ®å¯é æ€§ç¡®æ˜¯æœ€ä½çš„ï¼Œå­˜åœ¨ä¸¢æ¶ˆæ¯ï¼šæ•°æ®è¿˜æ²¡å†™å…¥leaderï¼Œleaderå°±æŒ‚äº†</li><li>1ï¼ˆé»˜è®¤ï¼‰ æ•°æ®å‘é€åˆ°Kafkaåï¼Œç»è¿‡leaderæˆåŠŸæ¥æ”¶æ¶ˆæ¯çš„çš„ç¡®è®¤ï¼Œå°±ç®—æ˜¯å‘é€æˆåŠŸäº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœleaderå®•æœºäº†ï¼Œåˆ™ä¼šä¸¢å¤±æ•°æ®ã€‚</li><li>-1æˆ–all produceréœ€è¦ç­‰å¾…ISRä¸­çš„æ‰€æœ‰å‰¯æœ¬éƒ½ç¡®è®¤æ¥æ”¶åˆ°æ•°æ®åæ‰ç®—ä¸€æ¬¡å‘é€å®Œæˆï¼Œå¯é æ€§æœ€é«˜ã€‚å½“ISRä¸­æ‰€æœ‰å‰¯æœ¬éƒ½å‘Leaderå‘é€ACKæ—¶ï¼Œleaderæ‰commitï¼Œè¿™æ—¶å€™produceræ‰èƒ½è®¤ä¸ºä¸€ä¸ªè¯·æ±‚ä¸­çš„æ¶ˆæ¯éƒ½commitäº†ã€‚è¿™ç§æ€§èƒ½ä¸é«˜ï¼Œä¸€èˆ¬æ˜¯é‡‘èçº§åˆ«æˆ–è€…å’Œé’±æ‰“äº¤é“çš„æ—¶å€™é‡‡ç”¨ã€‚</li></ul><p><strong>é¿å…æ¶ˆæ¯ä¸¢å¤±å°±å¯ä»¥å°†ackè®¾ç½®æˆ-1æˆ–all</strong></p><blockquote><p>ISR**(InSyncRepli)** ï¼šä¸leaderä¿æŒä¸€å®šåŒæ­¥ç¨‹åº¦çš„å‰¯æœ¬ä»¬ï¼ˆåŒ…æ‹¬leaderï¼‰ã€‚æ˜¯replicasçš„ä¸€ä¸ªå­é›†</p></blockquote><h3 id="2-Kafkaæ¶ˆæ¯å¤‡ä»½å’ŒåŒæ­¥"><a href="#2-Kafkaæ¶ˆæ¯å¤‡ä»½å’ŒåŒæ­¥" class="headerlink" title="2. Kafkaæ¶ˆæ¯å¤‡ä»½å’ŒåŒæ­¥"></a>2. Kafkaæ¶ˆæ¯å¤‡ä»½å’ŒåŒæ­¥</h3><ul><li>afkaé€šè¿‡åˆ†åŒºçš„å¤šå‰¯æœ¬ç­–ç•¥æ¥è§£å†³æ¶ˆæ¯çš„å¤‡ä»½é—®é¢˜ã€‚åœ¨kafkaä¸­ï¼Œå®ç°å‰¯æœ¬çš„ç›®çš„å°±æ˜¯å†—ä½™å¤‡ä»½ï¼Œä¸”ä»…ä»…æ˜¯å†—ä½™å¤‡ä»½ï¼Œæ‰€æœ‰çš„è¯»å†™è¯·æ±‚éƒ½æ˜¯ç”±leaderå‰¯æœ¬è¿›è¡Œå¤„ç†çš„ã€‚followerå‰¯æœ¬ä»…æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œé‚£å°±æ˜¯ä»leaderå‰¯æœ¬æ‹‰å–æ¶ˆæ¯ï¼Œå°½é‡è®©è‡ªå·±è·Ÿleaderå‰¯æœ¬çš„å†…å®¹ä¸€è‡´ã€‚</li><li>ç»™åŒ…å«é‡è¦æ¶ˆæ¯çš„é˜Ÿåˆ—å»ºç«‹ä¸€ä¸ªè¿œç«¯å¤‡ä»½ã€‚</li></ul><h3 id="3-Kafkaæ¶ˆæ¯å­˜ç›˜ä¸ä¸¢æ¶ˆæ¯"><a href="#3-Kafkaæ¶ˆæ¯å­˜ç›˜ä¸ä¸¢æ¶ˆæ¯" class="headerlink" title="3. Kafkaæ¶ˆæ¯å­˜ç›˜ä¸ä¸¢æ¶ˆæ¯?"></a>3. Kafkaæ¶ˆæ¯å­˜ç›˜ä¸ä¸¢æ¶ˆæ¯?</h3><p>Kafkaæä¾›æ¶ˆæ¯æŒä¹…åŒ–ï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¼šç«‹å³è¢«å†™å…¥æ–‡ä»¶ç³»ç»Ÿçš„æŒä¹…åŒ–æ—¥å¿—ä¸­ã€‚kafkaä¸€èˆ¬ä¸ä¼šåˆ é™¤æ¶ˆæ¯ï¼Œä¸ç®¡è¿™äº›æ¶ˆæ¯æœ‰æ²¡æœ‰è¢«æ¶ˆè´¹ã€‚åªä¼šæ ¹æ®é…ç½®çš„æ—¥å¿—ä¿ç•™æ—¶é—´(log.retention.hours)ç¡®è®¤æ¶ˆæ¯å¤šä¹…è¢«åˆ é™¤ï¼Œé»˜è®¤ä¿ç•™æœ€è¿‘ä¸€å‘¨çš„æ—¥å¿—æ¶ˆæ¯ã€‚</p><h3 id="4-Kafkaæ¶ˆè´¹è€…ä¸ä¸¢å¤±æ¶ˆæ¯"><a href="#4-Kafkaæ¶ˆè´¹è€…ä¸ä¸¢å¤±æ¶ˆæ¯" class="headerlink" title="4. Kafkaæ¶ˆè´¹è€…ä¸ä¸¢å¤±æ¶ˆæ¯?"></a>4. <strong>Kafkaæ¶ˆè´¹è€…ä¸ä¸¢å¤±æ¶ˆæ¯</strong>?</h3><ul><li>RabbitMQåœ¨æ¶ˆè´¹æ¶ˆæ¯æ—¶å¯ä»¥æŒ‡å®šæ˜¯è‡ªåŠ¨åº”ç­”ï¼Œè¿˜æ˜¯æ‰‹åŠ¨åº”ç­”ã€‚å°†Kafkaçš„åº”ç­”æ¨¡å¼è®¾å®šä¸ºæ‰‹åŠ¨åº”ç­”å¯ä»¥æé«˜æ¶ˆæ¯æ¶ˆè´¹çš„å¯é æ€§ã€‚</li><li>è®¾ç½®äº†æ‰‹åŠ¨ç¡®è®¤ï¼Œåˆ™éœ€è¦åœ¨ä¸šåŠ¡å¤„ç†æˆæˆåŠŸåï¼Œæ‰‹åŠ¨è°ƒç”¨<code>consumer.commitSync()</code></li></ul><p><strong>æœ€åï¼Œä»»ä½•ç”¨æˆ·æ€çš„åº”ç”¨ç¨‹åºéƒ½æ— æ³•ä¿è¯ç»å¯¹çš„æ•°æ®å®‰å…¨ï¼Œæ‰€ä»¥ï¼Œå¤‡ä»½ä¸æ¢å¤çš„æ–¹æ¡ˆä¹Ÿéœ€è¦è€ƒè™‘åˆ°ã€‚</strong></p>]]></content>
    
    
    <categories>
      
      <category>Kafka</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MQ</tag>
      
      <tag>æ¶ˆæ¯å¯é æ€§</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RabbitMQçš„é«˜çº§ç‰¹æ€§</title>
    <link href="/RabbitMQ%E7%9A%84%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7/"/>
    <url>/RabbitMQ%E7%9A%84%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<h1 id="RabbitMQçš„é«˜çº§ç‰¹æ€§"><a href="#RabbitMQçš„é«˜çº§ç‰¹æ€§" class="headerlink" title="RabbitMQçš„é«˜çº§ç‰¹æ€§"></a>RabbitMQçš„é«˜çº§ç‰¹æ€§</h1><h2 id="å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„é¡ºåºï¼Ÿ"><a href="#å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„é¡ºåºï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„é¡ºåºï¼Ÿ"></a><strong>å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„é¡ºåºï¼Ÿ</strong></h2><p>æ¶ˆæ¯çš„é¡ºåºæ˜¯æŒ‡çš„æ˜¯ï¼Œä¸€ä¸ªç»„å†…æ¶ˆæ¯çš„é¡ºåºï¼Œè€Œä¸æ˜¯æ•´ä¸ªmqé‡Œçš„æ¶ˆæ¯é¡ºåºã€‚æ¯”å¦‚ä¸€ä¸ªä¸‹å•è¿‡ç¨‹éœ€è¦å®Œæˆæ‰£æ¬¾ï¼Œå‡åº“å­˜ï¼Œé€šçŸ¥å¿«é€’å‘è´§ï¼Œè¿™ä¸€ç»„æ¶ˆæ¯çš„é¡ºåºä¸èƒ½ä¹±ã€‚</p><ul><li><p>å‘é€ç«¯ï¼šä¸€ç»„æœ‰åºæ¶ˆæ¯ï¼Œåªå‘åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œåˆ©ç”¨é˜Ÿåˆ—çš„FIFOç‰¹æ€§ä¿è¯æ¶ˆæ¯åœ¨å‘é€æ—¶é¡ºåºä¸ä¼šä¹±ã€‚</p><p>å¦‚æœå‘é€ç«¯é…ç½®äº†é‡è¯•æœºåˆ¶ï¼Œå°±å¯èƒ½å‡ºç°å‘é€æ–¹å‘é€æ—¶æ˜¯1ï¼Œ2ï¼Œ3ï¼Œä½†1å‘é€å¤±è´¥ï¼Œé‡è¯•å‘é€1ï¼Œè¿™æ ·æ”¶åˆ°çš„æ¶ˆæ¯å°±æ˜¯2ï¼Œ3ï¼Œ1ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦åŒæ­¥çš„å»å‘æ¶ˆæ¯ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªæ¶ˆæ¯å‘é€æˆåŠŸäº†ï¼Œå†å»å‘é€2ï¼Œ3ã€‚</p></li><li><p>æ¶ˆè´¹è€…ç«¯ï¼šè¿›è¡Œæ¶ˆè´¹æ—¶ï¼Œä¿è¯åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…ï¼ŒåŒæ—¶æŒ‡å®šprefetchå±æ€§ä¸º1ï¼Œå³æ¯æ¬¡RabbitMQéƒ½åªå¾€æ¶ˆè´¹ç«¯æ¨é€ä¸€ä¸ªæ¶ˆæ¯ã€‚è¿™æ ·å¯ä»¥ä¿è¯æ¶ˆè´¹æ—¶çš„æœ‰åºã€‚</p></li></ul><p><strong>æ˜¾ç„¶ï¼Œè¿™æ˜¯ä»¥æåº¦æ¶ˆè€—æ€§èƒ½ä½œä¸ºä»£ä»·çš„ï¼Œåœ¨å®é™…é€‚åº”è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥å°½é‡é¿å…è¿™ç§åœºæ™¯ã€‚</strong></p><h2 id="æ¶ˆæ¯ç§¯å‹å’Œè§£å†³"><a href="#æ¶ˆæ¯ç§¯å‹å’Œè§£å†³" class="headerlink" title="æ¶ˆæ¯ç§¯å‹å’Œè§£å†³"></a>æ¶ˆæ¯ç§¯å‹å’Œè§£å†³</h2><h3 id="1-å‘é€æ–¹å‘é€æµé‡å¤ªå¤§"><a href="#1-å‘é€æ–¹å‘é€æµé‡å¤ªå¤§" class="headerlink" title="1.å‘é€æ–¹å‘é€æµé‡å¤ªå¤§"></a>1.å‘é€æ–¹å‘é€æµé‡å¤ªå¤§</h3><ul><li>é™ä½æ¶ˆæ¯ç”Ÿäº§çš„é€Ÿåº¦ã€‚ç”Ÿäº§è€…ç«¯äº§ç”Ÿæ¶ˆæ¯çš„é€Ÿåº¦é€šå¸¸æ˜¯è·Ÿä¸šåŠ¡æ¯æ¯ç›¸å…³çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸å¤ªå¥½ç›´æ¥ä¼˜åŒ–ã€‚ä½†æ˜¯å¯ä»¥é‡‡ç”¨æ‰¹é‡å‘é€æ¶ˆæ¯çš„æ–¹å¼ï¼Œé™ä½IOé¢‘ç‡ã€‚</li></ul><h3 id="2-æ¶ˆè´¹è€…èƒ½åŠ›ä¸è¶³"><a href="#2-æ¶ˆè´¹è€…èƒ½åŠ›ä¸è¶³" class="headerlink" title="2. æ¶ˆè´¹è€…èƒ½åŠ›ä¸è¶³"></a>2. æ¶ˆè´¹è€…èƒ½åŠ›ä¸è¶³</h3><ul><li><p>ä¿®æ”¹æ¶ˆè´¹ç«¯ç¨‹åºï¼Œå†™ä¸€ä¸ªä¸´æ—¶çš„åˆ†å‘æ•°æ®çš„ consumer ç¨‹åºï¼Œå°†æ”¶åˆ°çš„æ¶ˆæ¯å¿«é€Ÿè½¬å‘ç»™ä¸´æ—¶å»ºç«‹å¥½åŸå…ˆ 10 å€çš„ queueï¼Œ æ¥ç€ä¸´æ—¶å¾ç”¨ 10 å€çš„æœºå™¨æ¥éƒ¨ç½² consumerï¼Œæ¯ä¸€ä¸ª consumer æ¶ˆè´¹ä¸€ä¸ªä¸´æ—¶ queue çš„æ•°æ®ã€‚</p></li><li><p>ä¸Šçº¿ä¸“é—¨çš„æ¶ˆè´¹è€…ç»„ã€‚ä¸“é—¨ç”¨æ¥å°†æ¶ˆæ¯å¿«é€Ÿè½¬å½•ã€‚ä¿å­˜åˆ°æ•°æ®åº“æˆ–è€…Redisï¼Œç„¶åå†æ…¢æ…¢è¿›è¡Œå¤„ç†ã€‚</p></li><li><p>å¯¹äºå•ä¸ªæ¶ˆè´¹è€…ç«¯ï¼Œå¯ä»¥é€šè¿‡é…ç½®æå‡æ¶ˆè´¹è€…ç«¯çš„ååé‡ã€‚ä¾‹å¦‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"># å•æ¬¡æ¨é€æ¶ˆæ¯æ•°é‡<br>spring.rabbitmq.listener.simple.prefetch=<span class="hljs-number">1</span><br># æ¶ˆè´¹è€…çš„æ¶ˆè´¹çº¿ç¨‹æ•°é‡<br>spring.rabbitmq.listener.simple.concurrency<br></code></pre></td></tr></table></figure></li></ul><h3 id="3-æ¶ˆè´¹è€…æœ‰bugæˆ–è€…å®•æœºäº†"><a href="#3-æ¶ˆè´¹è€…æœ‰bugæˆ–è€…å®•æœºäº†" class="headerlink" title="3.æ¶ˆè´¹è€…æœ‰bugæˆ–è€…å®•æœºäº†"></a>3.æ¶ˆè´¹è€…æœ‰bugæˆ–è€…å®•æœºäº†</h3><ul><li>å°†æ¶ˆè´¹ä¸æˆåŠŸçš„æ¶ˆæ¯è½¬å‘åˆ°å…¶ä»–é˜Ÿåˆ—é‡Œï¼Œç±»ä¼¼æ­»ä¿¡é˜Ÿåˆ—ï¼Œåé¢å†æ…¢æ…¢åˆ†æã€‚kafkaæ²¡æœ‰æ­»ä¿¡é˜Ÿåˆ—éœ€è¦è‡ªå·±å®ç°ã€‚</li></ul><h4 id="å…¶ä»–è§£å†³æ–¹å¼"><a href="#å…¶ä»–è§£å†³æ–¹å¼" class="headerlink" title="å…¶ä»–è§£å†³æ–¹å¼"></a>å…¶ä»–è§£å†³æ–¹å¼</h4><ul><li>RabbitMQæœåŠ¡ç«¯ï¼šå°è¯•ä½¿ç”¨æ–°æ¨å‡ºçš„Quorumä»¥åŠStreamé˜Ÿåˆ—ï¼Œä¹Ÿèƒ½å¾ˆå¥½çš„æé«˜æœåŠ¡ç«¯çš„æ¶ˆæ¯å †ç§¯èƒ½åŠ›ã€‚ä½†æ˜¯è¿™ä¸¤ç§é˜Ÿåˆ—çš„ç¨³å®šæ€§å’Œå‘¨è¾¹ç”Ÿæ€éƒ½è¿˜ä¸å¤Ÿå®Œå–„ã€‚</li><li>RabbitMQä¸€ç›´ä»¥æ¥ï¼Œå°±æ˜¯å¯¹äºæ¶ˆæ¯å †ç§¯é—®é¢˜çš„å¤„ç†ä¸å¥½ã€‚å½“RabbitMQä¸­æœ‰å¤§é‡æ¶ˆæ¯å †ç§¯æ—¶ï¼Œæ•´ä½“æ€§èƒ½ä¼šä¸¥é‡ä¸‹é™ã€‚ä¸è¡Œå°±æ¢kafka</li></ul><h2 id="MQä¸­æ¶ˆæ¯å¤±æ•ˆ"><a href="#MQä¸­æ¶ˆæ¯å¤±æ•ˆ" class="headerlink" title="MQä¸­æ¶ˆæ¯å¤±æ•ˆ"></a>MQä¸­æ¶ˆæ¯å¤±æ•ˆ</h2><p>RabbtiMQ æ˜¯å¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´ çš„ï¼Œä¹Ÿå°±æ˜¯ TTLã€‚å¦‚æœæ¶ˆæ¯åœ¨ queue ä¸­ç§¯å‹è¶…è¿‡ä¸€å®šçš„æ—¶é—´å°±ä¼šè¢« RabbitMQ ç»™æ¸…ç†æ‰ï¼Œè¿™ä¸ªæ•°æ®å°±æ²¡äº†ã€‚</p><p>è§£å†³ï¼šæ‰¹é‡é‡å¯¼ã€‚å°±æ˜¯å¤§é‡ç§¯å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å½“æ—¶å°± ç›´æ¥ä¸¢å¼ƒæ•°æ®äº†ï¼Œç„¶åç­‰è¿‡äº†é«˜å³°æœŸä»¥åã€‚å°†ä¸¢å¤±çš„é‚£æ‰¹æ•°æ®ï¼Œå†™ä¸ªä¸´æ—¶ç¨‹åºï¼Œä¸€ç‚¹ä¸€ç‚¹çš„æŸ¥å‡ºæ¥ï¼Œç„¶åé‡æ–°çŒå…¥ mq é‡Œé¢å»</p><h2 id="æ¶ˆæ¯çš„å¹‚ç­‰æ€§"><a href="#æ¶ˆæ¯çš„å¹‚ç­‰æ€§" class="headerlink" title="æ¶ˆæ¯çš„å¹‚ç­‰æ€§"></a>æ¶ˆæ¯çš„å¹‚ç­‰æ€§</h2><p>é€ æˆæ¶ˆæ¯é‡å¤çš„æ ¹æœ¬åŸå› æ˜¯ï¼šç½‘ç»œä¸å¯è¾¾ã€‚ </p><p>æ‰€ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•å°±æ˜¯ç»•è¿‡è¿™ä¸ªé—®é¢˜ã€‚é‚£ä¹ˆé—®é¢˜å°±å˜æˆäº†ï¼šå¦‚æœæ¶ˆè´¹ç«¯æ”¶ åˆ°ä¸¤æ¡ä¸€æ ·çš„æ¶ˆæ¯ï¼Œåº”è¯¥æ€æ ·å¤„ç†ï¼Ÿ </p><p>æ–¹æ¡ˆä¸€ï¼š åˆ©ç”¨ä¸€å¼ æ—¥å¿—è¡¨æ¥è®°å½•å·²ç»å¤„ç†æˆåŠŸçš„æ¶ˆæ¯çš„ IDï¼Œå¦‚ æœæ–°åˆ°çš„æ¶ˆæ¯ ID å·²ç»åœ¨æ—¥å¿—è¡¨ä¸­ï¼Œé‚£ä¹ˆå°±ä¸å†å¤„ç†è¿™æ¡æ¶ˆæ¯ã€‚ </p><p>æ–¹æ¡ˆäºŒï¼šæ¶ˆæ¯ç”Ÿæˆå”¯ä¸€çš„idï¼Œå­˜å‚¨åœ¨redisä¸­ã€‚</p><p>æ–¹æ¡ˆäºŒï¼š</p><ul><li><p>ç¬¬ä¸€æ¬¡ æ‰§è¡Œæ›´æ–°è¯­å¥çš„æ˜¯ä¸€æ ·ï¼Œversion &#x3D;1 </p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">update account <span class="hljs-keyword">set</span> price = price <span class="hljs-number">-100</span>, <span class="hljs-built_in">version</span> = <span class="hljs-built_in">version</span> + <span class="hljs-number">1</span>, <span class="hljs-keyword">where</span> <span class="hljs-built_in">id</span> = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">version</span> = <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure></li></ul><ul><li><p>ç¬¬äºŒæ¬¡, æ‰§è¡Œæ›´æ–°è¯­å¥çš„æ˜¯ä¸€æ ·ï¼Œversion å·²ç»å˜æˆäº†2ï¼Œæ­¤æ—¶æ‰¾<code>where version = 1 </code> å°±æ— æ³•æ‰¾åˆ°</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">update account <span class="hljs-keyword">set</span> price = price <span class="hljs-number">-100</span>, <span class="hljs-built_in">version</span> = <span class="hljs-built_in">version</span> + <span class="hljs-number">1</span>, <span class="hljs-keyword">where</span> <span class="hljs-built_in">id</span> = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">version</span> = <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure></li></ul><h2 id="æ¶ˆè´¹ç«¯é™æµ"><a href="#æ¶ˆè´¹ç«¯é™æµ" class="headerlink" title="æ¶ˆè´¹ç«¯é™æµ"></a>æ¶ˆè´¹ç«¯é™æµ</h2><ul><li>åœ¨<a href="rabbit:listener-container">rabbit:listener-container</a> ä¸­é…ç½®<code>prefetch</code>å±æ€§è®¾ç½®æ¶ˆè´¹ç«¯ä¸€æ¬¡æ‹‰å–å¤šå°‘æ¶ˆæ¯</li><li>æ¶ˆè´¹ç«¯çš„ç¡®è®¤æ¨¡å¼éœ€è¦æ˜¯æ‰‹åŠ¨ç¡®è®¤</li></ul><h2 id="TTL"><a href="#TTL" class="headerlink" title="TTL"></a>TTL</h2><ol><li>TTLå…¨ç§°ï¼štime to live æ¶ˆæ¯å­˜æ´»æ—¶é—´æˆ–æ¶ˆæ¯è¿‡æœŸæ—¶é—´</li><li>æ¶ˆæ¯è¾¾åˆ°äº†å­˜æ´»æ—¶é—´åï¼Œå¦‚æœè¿˜æ²¡è¢«æ¶ˆè´¹ï¼Œä¼šè¢«è‡ªåŠ¨ç§»é™¤</li><li>RabbitMQå¯ä»¥å¯¹æ¶ˆæ¯è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¹Ÿå¯ä»¥å¯¹æ•´ä¸ªé˜Ÿåˆ—è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚</li></ol><h2 id="æ­»ä¿¡é˜Ÿåˆ—"><a href="#æ­»ä¿¡é˜Ÿåˆ—" class="headerlink" title="æ­»ä¿¡é˜Ÿåˆ—"></a>æ­»ä¿¡é˜Ÿåˆ—</h2><ul><li><p>å½“æ¶ˆæ¯æˆä¸ºæ­»ä¿¡åï¼Œå¯ä»¥è¢«é‡æ–°å‘é€åˆ°ä¸€ä¸ªäº¤æ¢æœºï¼Œè¿™ä¸ªäº¤æ¢æœºå°±æ˜¯æ­»ä¿¡äº¤æ¢æœºï¼Œå®ƒç»‘å®šçš„é˜Ÿåˆ—å°±æ˜¯æ­»ä¿¡é˜Ÿåˆ—</p></li><li><p>æˆä¸ºæ­»ä¿¡çš„æ¡ä»¶ï¼š</p><ul><li>æ¶ˆæ¯è¾¾åˆ°äº†å­˜æ´»æ—¶é—´ï¼Œè¿˜æ²¡æœ‰è¢«æ¶ˆè´¹ã€‚</li><li>æ¶ˆè´¹è€…æ‹’æ”¶æ¶ˆæ¯ï¼Œå¹¶ä¸”ä¸é‡å›é˜Ÿåˆ—ã€‚  </li><li>é˜Ÿåˆ—åˆ°è¾¾äº†æŒ‡å®šçš„é•¿åº¦é™åˆ¶</li></ul></li><li><p>ä»£ç </p><ul><li><p>producer:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"># æŒ‡å®šäº†æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ä¸º10s <br>AMQP.BasicProperties properties = <span class="hljs-keyword">new</span> AMQP.BasicProperties.Builder()<br>                .deliveryMode(<span class="hljs-number">2</span>)<br>                .contentEncoding(<span class="hljs-string">&quot;UTF-8&quot;</span>)<br>                .expiration(<span class="hljs-string">&quot;10000&quot;</span>)<br>                .build();<br>  channel.basicPublish(exchange, routingKey, <span class="hljs-keyword">true</span>, properties, msg.getBytes());<br></code></pre></td></tr></table></figure></li><li><p>consumer:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">String exchangeName = <span class="hljs-string">&quot;test_dlx_exchange&quot;</span>;<br>channel.exchangeDeclare(exchangeName, <span class="hljs-string">&quot;topic&quot;</span>, <span class="hljs-keyword">true</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">null</span>);<br><br># åœ¨é˜Ÿåˆ—åŠ ä¸Šä¸€ä¸ªå‚æ•°ï¼ŒæŒ‡å®šæ­»ä¿¡é˜Ÿåˆ—<br>Map&lt;String, Object&gt; agruments = <span class="hljs-keyword">new</span> HashMap&lt;String, Object&gt;();<br>agruments.put(<span class="hljs-string">&quot;x-dead-letter-exchange&quot;</span>, <span class="hljs-string">&quot;dlx.exchange&quot;</span>);<br>channel.queueDeclare(queueName, <span class="hljs-keyword">true</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, agruments);<br></code></pre></td></tr></table></figure></li></ul></li></ul><h2 id="å»¶è¿Ÿé˜Ÿåˆ—"><a href="#å»¶è¿Ÿé˜Ÿåˆ—" class="headerlink" title="å»¶è¿Ÿé˜Ÿåˆ—"></a>å»¶è¿Ÿé˜Ÿåˆ—</h2><p>å»¶è¿Ÿé˜Ÿåˆ—ï¼Œæ¶ˆæ¯è¿›å…¥é˜Ÿåˆ—åï¼Œä¸ä¼šç«‹å³è¢«æ¶ˆè´¹ï¼Œè€Œæ˜¯ç­‰åˆ°ä¸€å®šçš„æ—¶é—´ï¼Œæ‰ä¼šè¢«æ¶ˆè´¹ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼š</p><ol><li>ç”¨æˆ·ä¸‹å•åï¼Œ30åˆ†é’Ÿæœªæ”¯ä»˜ï¼Œå–æ¶ˆè®¢å•ï¼Œå›æ»šåº“å­˜</li><li>æ–°ç”¨æˆ·æ³¨å†Œ7å¤©åï¼Œå‘é€çŸ­ä¿¡é—®å€™</li></ol><blockquote><p>å½“ç„¶ä¸Šé¢çš„åœºæ™¯ä¹Ÿå¯ä»¥ç”¨å®šæ—¶å™¨å®ç°</p></blockquote><p>rabbitmqç°åœ¨ä¸æ”¯æŒå»¶è¿Ÿé˜Ÿåˆ—ï¼Œå»¶è¿Ÿé˜Ÿåˆ—çš„å®ç°éœ€è¦å€ŸåŠ©TTLå’Œæ­»ä¿¡é˜Ÿåˆ—ã€‚å…·ä½“å®ç°æµç¨‹ï¼š</p><ul><li>ç”¨æˆ·ä¸‹å•ï¼ŒæŠŠæ¶ˆæ¯å‘é€åˆ°Queue1ä¸­ï¼Œä¸è®¾ç½®Consumer1ï¼Œè®¾ç½®Queue1é˜Ÿåˆ—é‡Œçš„æ¶ˆæ¯å­˜æ´»æ—¶é—´ä¸º30åˆ†é’Ÿï¼Œç­‰å¾…30åˆ†é’Ÿåï¼Œæ¶ˆæ¯æˆä¸ºæ­»ä¿¡ã€‚</li><li>æ­»ä¿¡çš„æ¶ˆæ¯å‘é€åˆ°Queue2ï¼Œæ·»åŠ Consumer2ç›‘å¬Queue2</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228233554129.png" alt="image-20230228233554129"></p><h4 id="æ­»ä¿¡é˜Ÿåˆ—å’Œå»¶æ—¶é˜Ÿåˆ—çš„åŒºåˆ«"><a href="#æ­»ä¿¡é˜Ÿåˆ—å’Œå»¶æ—¶é˜Ÿåˆ—çš„åŒºåˆ«" class="headerlink" title="æ­»ä¿¡é˜Ÿåˆ—å’Œå»¶æ—¶é˜Ÿåˆ—çš„åŒºåˆ«"></a>æ­»ä¿¡é˜Ÿåˆ—å’Œå»¶æ—¶é˜Ÿåˆ—çš„åŒºåˆ«</h4><ul><li>æ­»ä¿¡é˜Ÿåˆ—ï¼Œç›‘å¬çš„æ˜¯Queue1,æˆä¸ºæ­»ä¿¡çš„æ¶ˆæ¯ä¼šè¢«ä¸¢åˆ°DLXä¸­ï¼Œæˆ–è€…ä¸å¤„ç†è‡ªå·±æ¸…ç†æ‰</li><li>å»¶è¿Ÿé˜Ÿåˆ—ï¼Œç›‘å¬çš„æ˜¯æ­»ä¿¡é˜Ÿåˆ—</li></ul>]]></content>
    
    
    <categories>
      
      <category>RabbitMQ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¶ˆæ¯ä¸­é—´ä»¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>rabbitMQå…¥é—¨</title>
    <link href="/rabbitMQ%E5%85%A5%E9%97%A8/"/>
    <url>/rabbitMQ%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="MQä»‹ç»"><a href="#MQä»‹ç»" class="headerlink" title="MQä»‹ç»"></a>MQä»‹ç»</h1><h2 id="ä»€ä¹ˆæ˜¯MQï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯MQï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯MQï¼Ÿ"></a>ä»€ä¹ˆæ˜¯MQï¼Ÿ</h2><ul><li>MQï¼šMessageQueueï¼Œæ¶ˆæ¯é˜Ÿåˆ—ã€‚ é˜Ÿåˆ—ï¼Œæ˜¯ä¸€ç§FIFO å…ˆè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„ã€‚</li><li>æ¶ˆæ¯ç”±ç”Ÿäº§è€…å‘é€åˆ°MQè¿›è¡Œæ’é˜Ÿï¼Œç„¶åæŒ‰åŸæ¥çš„é¡ºåºäº¤ç”±æ¶ˆæ¯çš„æ¶ˆè´¹è€…è¿›è¡Œå¤„ç†ã€‚</li><li>QQå’Œå¾®ä¿¡å°±æ˜¯å…¸å‹çš„MQã€‚</li></ul><h2 id="MQçš„çš„ä¼˜ç‚¹ï¼š"><a href="#MQçš„çš„ä¼˜ç‚¹ï¼š" class="headerlink" title="MQçš„çš„ä¼˜ç‚¹ï¼š"></a>MQçš„çš„ä¼˜ç‚¹ï¼š</h2><ul><li><p><strong>å¼‚æ­¥</strong>ï¼šç›¸æ¯”äºä¼ ç»Ÿçš„ä¸²è¡Œã€å¹¶è¡Œæ‰§è¡Œï¼Œå¯ä»¥æé«˜ååé‡ã€‚ æ¯”å¦‚ï¼šå‘å¿«é€’çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç­‰å¾…ç”¨æˆ·æ¥æ”¶åˆ°å¿«é€’ï¼Œè€Œæ˜¯æŠŠå¿«é€’æ”¾è¿›èœé¸Ÿé©¿ç«™ï¼Œå‘æ¶ˆæ¯åï¼Œç¦»å¼€ï¼Œç”¨æˆ·é—²æš‡æ—¶å»å–å¿«é€’ã€‚</p></li><li><p><strong>è§£å¶</strong>ï¼šæœåŠ¡ä¹‹é—´è¿›è¡Œè§£è€¦ï¼Œæ‰å¯ä»¥å‡å°‘æœåŠ¡ä¹‹é—´çš„å½±å“ã€‚æé«˜ç³»ç»Ÿæ•´ä½“çš„ç¨³å®šæ€§ä»¥åŠå¯æ‰©å±•æ€§ã€‚æ¯”å¦‚ç”¨æˆ·ä¸‹å•çš„åœºæ™¯ï¼Œç”¨æˆ·ä¸‹å•åï¼Œè®¢å•ç³»ç»Ÿéœ€è¦é€šçŸ¥åº“å­˜ç³»ç»Ÿå‡åº“å­˜ï¼Œä¼ ç»Ÿçš„æ¨¡å¼ï¼Œå½“åº“å­˜ç³»ç»Ÿæ— æ³•è®¿é—®æ—¶ï¼Œç”¨æˆ·è°ƒç”¨æ¥å£å¤±è´¥ï¼Œä»è€Œå¯¼è‡´ä¸‹å•å¤±è´¥ã€‚ä½†å¼•å…¥MQåï¼Œç”¨æˆ·ä¸‹å•åï¼Œå°†ä¸‹å•æ¶ˆæ¯å†™å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç„¶åè¿”å›ç”¨æˆ·ä¸‹å•æˆåŠŸï¼Œåº“å­˜ç³»ç»Ÿå»è®¢é˜…ä¸‹å•çš„æ¶ˆæ¯ï¼Œå»æ‹‰å–ä¸‹å•ä¿¡æ¯ï¼Œä»è€Œè¿›è¡Œå‡åº“å­˜ï¼Œè¿™æ—¶å³ä½¿åº“å­˜ç³»ç»Ÿä¸å¯ç”¨ï¼Œä¾æ—§å¯ä»¥ä¸‹å•æˆåŠŸï¼Œå®ç°äº†è®¢å•ç³»ç»Ÿå’Œåº“å­˜ç³»ç»Ÿçš„è§£è€¦ã€‚</p></li><li><p><strong>å‰Šå³°</strong>ï¼šå¯ä»¥é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—é•¿åº¦æ§åˆ¶è¯·æ±‚é‡ï¼›å¯ä»¥ç¼“è§£çŸ­æ—¶é—´å†…çš„é«˜å¹¶å‘è¯· æ±‚ã€‚ æ¯”å¦‚åŒåä¸€ï¼Œè¯·æ±‚é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¯·æ±‚æ”¾åˆ°MQé‡Œï¼Œä¸‹æ¸¸æœåŠ¡å†æ…¢æ…¢æ¶ˆè´¹ã€‚</p></li></ul><h2 id="MQçš„ç¼ºç‚¹"><a href="#MQçš„ç¼ºç‚¹" class="headerlink" title="MQçš„ç¼ºç‚¹"></a><strong>MQçš„ç¼ºç‚¹</strong></h2><ul><li>ç³»ç»Ÿå¯ç”¨æ€§é™ä½ã€‚ç³»ç»Ÿå¼•å…¥çš„å¤–éƒ¨ä¾èµ–å¢å¤šï¼Œç³»ç»Ÿçš„ç¨³å®šæ€§å°±ä¼šå˜å·®ã€‚ä¸€æ—¦MQå®•æœºï¼Œå¯¹ä¸šåŠ¡ä¼šäº§ç”Ÿå½±å“ã€‚è¿™å°±éœ€è¦è€ƒè™‘å¦‚ä½•ä¿è¯MQçš„é«˜å¯ç”¨</li><li>ç³»ç»Ÿå¤æ‚åº¦æé«˜ã€‚å¼•å…¥MQåç³»ç»Ÿçš„å¤æ‚åº¦ä¼šå¤§å¤§æé«˜ã€‚ä»¥å‰æœåŠ¡ä¹‹é—´å¯ä»¥è¿›è¡ŒåŒæ­¥çš„æœåŠ¡è°ƒç”¨ï¼Œå¼•å…¥MQåï¼Œä¼šå˜ä¸ºå¼‚æ­¥è°ƒç”¨ï¼Œæ•°æ®çš„é“¾è·¯å°±ä¼šå˜å¾—æ›´å¤æ‚ã€‚å¹¶ä¸”è¿˜ä¼šå¸¦æ¥å…¶ä»–ä¸€äº›é—®é¢˜ã€‚æ¯”å¦‚ï¼šå¦‚ä½•ä¿è¯æ¶ˆè´¹ä¸ä¼šä¸¢å¤±ï¼Ÿä¸ä¼šè¢«é‡å¤è°ƒç”¨ï¼Ÿæ€ä¹ˆä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§ç­‰é—®é¢˜</li><li>æ¶ˆæ¯ä¸€è‡´æ€§é—®é¢˜ã€‚Aç³»ç»Ÿå¤„ç†å®Œä¸šåŠ¡ï¼Œé€šè¿‡MQå‘é€æ¶ˆæ¯ç»™Bã€Cç³»ç»Ÿè¿›è¡Œåç»­çš„ä¸šåŠ¡å¤„ç†ã€‚å¦‚æœBç³»ç»Ÿå¤„ç†æˆåŠŸï¼ŒCç³»ç»Ÿå¤„ç†å¤±è´¥æ€ä¹ˆåŠï¼Ÿè¿™å°±éœ€è¦è€ƒè™‘å¦‚ä½•ä¿è¯æ¶ˆæ¯æ•°æ®å¤„ç†çš„ä¸€è‡´æ€§ã€‚</li></ul><h1 id="ä»€ä¹ˆæ˜¯RabbitMQï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯RabbitMQï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯RabbitMQï¼Ÿ"></a><strong>ä»€ä¹ˆæ˜¯RabbitMQï¼Ÿ</strong></h1><p>RabbitMQæ˜¯ä¸€æ¬¾å¼€æºçš„ï¼ŒErlangç¼–å†™çš„ï¼ŒåŸºäºAMQPåè®®çš„æ¶ˆæ¯ä¸­é—´ä»¶</p><h1 id="ä¸ºä»€ä¹ˆé€‰æ‹©rabbitmqï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©rabbitmqï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹©rabbitmqï¼Ÿ"></a>ä¸ºä»€ä¹ˆé€‰æ‹©rabbitmqï¼Ÿ</h1><ul><li>æ”¯æ’‘é«˜å¹¶å‘ã€é«˜ååã€æ€§èƒ½å¾ˆé«˜ï¼ŒåŒæ—¶æœ‰éå¸¸å®Œå–„ä¾¿æ·çš„åå°ç®¡ç†ç•Œé¢å¯ä»¥ä½¿ç”¨ã€‚ </li><li>æ”¯æŒé›†ç¾¤åŒ–ã€é«˜å¯ç”¨éƒ¨ç½²æ¶æ„ã€æ¶ˆæ¯é«˜å¯é æ”¯æŒï¼ŒåŠŸèƒ½è¾ƒä¸ºå®Œå–„ã€‚</li><li>å¼€ æºçš„ï¼Œæ¯”è¾ƒç¨³å®šçš„æ”¯æŒï¼Œæ´»è·ƒåº¦ä¹Ÿé«˜</li></ul><blockquote><p>ç¼ºç‚¹ï¼š ç¡®å® erlang è¯­è¨€é˜»æ­¢äº†å¤§é‡çš„ Java å·¥ç¨‹å¸ˆ å»æ·±å…¥ç ”ç©¶å’ŒæŒæ§å®ƒï¼Œå¯¹å…¬å¸è€Œè¨€ï¼Œå‡ ä¹å¤„äºä¸å¯æ§çš„çŠ¶æ€ï¼Œ</p></blockquote><h1 id="RabbitMQçš„åŸºæœ¬æ¦‚å¿µ"><a href="#RabbitMQçš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="RabbitMQçš„åŸºæœ¬æ¦‚å¿µ"></a>RabbitMQçš„åŸºæœ¬æ¦‚å¿µ</h1><ul><li>connectionï¼š å®¢æˆ·ç«¯ä¸RabbitMQè¿›è¡Œäº¤äº’ï¼Œé¦–å…ˆå°±éœ€è¦å»ºç«‹ä¸€ä¸ªTPCè¿æ¥ï¼Œè¿™ä¸ªè¿æ¥å°±æ˜¯Connection</li></ul><ul><li><p>Brokerï¼š ç®€å•æ¥è¯´å°±æ˜¯æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨å®ä½“ </p></li><li><p>Exchangeï¼š æ¶ˆæ¯äº¤æ¢æœºï¼Œå®ƒæŒ‡å®šæ¶ˆæ¯æŒ‰ä»€ä¹ˆè§„åˆ™ï¼Œè·¯ç”±åˆ°å“ªä¸ªé˜Ÿåˆ— </p></li><li><p>Queueï¼š æ¶ˆæ¯é˜Ÿåˆ—è½½ä½“ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½ä¼šè¢«æŠ•å…¥åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ— </p></li><li><p>Bindingï¼š ç»‘å®šï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯æŠŠexchangeå’ŒqueueæŒ‰ç…§è·¯ç”±è§„åˆ™ç»‘å®šèµ·æ¥ </p></li><li><p>Routing Keyï¼š è·¯ç”±å…³é”®å­—ï¼Œexchangeæ ¹æ®è¿™ä¸ªå…³é”®å­—è¿›è¡Œæ¶ˆæ¯æŠ•é€’ </p></li><li><p>VHostï¼š vhost å¯ä»¥ç†è§£ä¸ºè™šæ‹Ÿ broker ï¼Œå³ mini-RabbitMQ serverã€‚å…¶å†…éƒ¨ å‡å«æœ‰ç‹¬ç«‹çš„ queueã€exchange å’Œ binding ç­‰ï¼Œä½†æœ€æœ€é‡è¦çš„æ˜¯ï¼Œå…¶æ‹¥æœ‰ç‹¬ç«‹çš„ æƒé™ç³»ç»Ÿï¼Œå¯ä»¥åšåˆ° vhost èŒƒå›´çš„ç”¨æˆ·æ§åˆ¶ã€‚å½“ç„¶ï¼Œä» RabbitMQ çš„å…¨å±€è§’åº¦ï¼Œç±»ä¼¼mysqlä¸­çš„databaseåˆ›å»ºä¸€ä¸ªtable éœ€è¦æŒ‡æ˜ç”¨å“ªä¸ªæ•°æ®åº“ã€‚</p></li></ul><h1 id="channelä¿¡é“"><a href="#channelä¿¡é“" class="headerlink" title="channelä¿¡é“"></a>channelä¿¡é“</h1><ul><li>ä¿¡é“æ˜¯ç”Ÿäº§è€…&#x2F;æ¶ˆè´¹è€…ä¸rbabitmqé€šä¿¡çš„æ¸ é“ã€‚ç”Ÿäº§è€…publishæˆ–è€…æ¶ˆè´¹è€…consumeä¸€ä¸ªé˜Ÿåˆ—éƒ½æ˜¯é€šè¿‡ä¿¡é“å®Œæˆçš„ã€‚</li><li>å¤šçº¿ç¨‹æ—¶ï¼ŒrabbitMQåœ¨ä¸€æ¡tcpä¸Šå»ºç«‹å¤šä¸ªä¿¡é“æ¥å¤„ç†å¤šçº¿ç¨‹ã€‚</li><li>æ¯ä¸ªä¿¡é“åœ¨rabbitmqä¸Šæœ‰å”¯ä¸€çš„id,ä¿è¯ä¸€ä¸ªä¿¡é“å¯¹åº”ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ã€‚</li></ul><h1 id="äº¤æ¢æœº"><a href="#äº¤æ¢æœº" class="headerlink" title="äº¤æ¢æœº"></a>äº¤æ¢æœº</h1><ul><li><p>äº¤æ¢æœºå°±ç±»ä¼¼æ˜¯è·¯ç”±å™¨ï¼Œä»–ä¼šæ ¹æ®è·¯ç”±é”®ï¼ˆåœ¨rabbitMQå°±æ˜¯routing keyï¼‰ï¼Œå°†æ¶ˆæ¯åˆ†å‘åˆ°ç›¸åº”çš„é˜Ÿåˆ—ä¸Šå»ã€‚</p></li><li><p>äº¤æ¢æœºçš„å››ç§ç±»å‹</p><ul><li>fanout: æŠŠæ‰€æœ‰å‘é€åˆ°è¯¥äº¤æ¢å™¨çš„æ¶ˆæ¯è·¯ç”±åˆ°æ‰€æœ‰ä¸è¯¥äº¤æ¢å™¨ç»‘å®šçš„é˜Ÿåˆ—ä¸­ã€‚(1:N)</li><li>Direct :   æŠŠæ¶ˆæ¯è·¯ç”±åˆ°BindingKeyå’ŒRoutingKeyå®Œå…¨åŒ¹é…çš„é˜Ÿåˆ—ä¸­ã€‚(1:1)</li><li>topic: å¯ä»¥æ ¹æ®æ¨¡ç³ŠåŒ¹é…ï¼Œå¯ä»¥å°†å¤šä¸ªæ¶ˆæ¯è·¯ç”±åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯”å¦‚ä¸€ä¸ªé˜Ÿåˆ—çš„routing_keyæ˜¯â€™â€™.testâ€é‚£ä¹ˆå‡¡æ˜¯åˆ°è¾¾è·¯ç”±å™¨çš„æ¶ˆæ¯çš„åç¼€ä¸ºâ€œ.testâ€ï¼Œéƒ½ä¼šè¿›åˆ°è¿™ä¸ªé˜Ÿåˆ—ã€‚<ul><li>â€œ* â€åªèƒ½æ˜¯ä¸€ä¸ªå•è¯ï¼Œå¦‚â€œâ€aa.testâ€œ</li><li>â€œ#â€å¯ä»¥æ˜¯&gt;&#x3D; 0çš„å•è¯ï¼Œå¦‚â€œâ€testâ€œ,â€aa.bb.testâ€</li></ul></li><li><code>headers</code>:ä¸ä¾èµ–è·¯ç”±é”®åŒ¹é…è§„åˆ™è·¯ç”±æ¶ˆæ¯ã€‚æ˜¯æ ¹æ®å‘é€æ¶ˆæ¯å†…å®¹ä¸­çš„<code>headers</code>å±æ€§è¿›è¡ŒåŒ¹é…ã€‚æ€§èƒ½å·®ï¼ŒåŸºæœ¬ç”¨ä¸åˆ°ã€‚</li></ul></li></ul><h1 id="äº¤æ¢æœº-1"><a href="#äº¤æ¢æœº-1" class="headerlink" title="äº¤æ¢æœº"></a>äº¤æ¢æœº</h1><ul><li><p>äº¤æ¢æœºå°±ç±»ä¼¼æ˜¯è·¯ç”±å™¨ï¼Œä»–ä¼šæ ¹æ®è·¯ç”±é”®ï¼ˆåœ¨rabbitMQå°±æ˜¯routing keyï¼‰ï¼Œå°†æ¶ˆæ¯åˆ†å‘åˆ°ç›¸åº”çš„é˜Ÿåˆ—ä¸Šå»ã€‚</p></li><li><p>äº¤æ¢æœºçš„å››ç§ç±»å‹</p><ul><li>fanout: æŠŠæ‰€æœ‰å‘é€åˆ°è¯¥äº¤æ¢å™¨çš„æ¶ˆæ¯è·¯ç”±åˆ°æ‰€æœ‰ä¸è¯¥äº¤æ¢å™¨ç»‘å®šçš„é˜Ÿåˆ—ä¸­ã€‚(1:N)</li><li>Direct :   æŠŠæ¶ˆæ¯è·¯ç”±åˆ°BindingKeyå’ŒRoutingKeyå®Œå…¨åŒ¹é…çš„é˜Ÿåˆ—ä¸­ã€‚(1:1)</li><li>topic: å¯ä»¥æ ¹æ®æ¨¡ç³ŠåŒ¹é…ï¼Œå¯ä»¥å°†å¤šä¸ªæ¶ˆæ¯è·¯ç”±åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯”å¦‚ä¸€ä¸ªé˜Ÿåˆ—çš„routing_keyæ˜¯â€™â€™.testâ€é‚£ä¹ˆå‡¡æ˜¯åˆ°è¾¾è·¯ç”±å™¨çš„æ¶ˆæ¯çš„åç¼€ä¸ºâ€œ.testâ€ï¼Œéƒ½ä¼šè¿›åˆ°è¿™ä¸ªé˜Ÿåˆ—ã€‚<ul><li>â€œ* â€åªèƒ½æ˜¯ä¸€ä¸ªå•è¯ï¼Œå¦‚â€œâ€aa.testâ€œ</li><li>â€œ#â€å¯ä»¥æ˜¯&gt;&#x3D; 0çš„å•è¯ï¼Œå¦‚â€œâ€testâ€œ,â€aa.bb.testâ€</li></ul></li><li><code>headers</code>:ä¸ä¾èµ–è·¯ç”±é”®åŒ¹é…è§„åˆ™è·¯ç”±æ¶ˆæ¯ã€‚æ˜¯æ ¹æ®å‘é€æ¶ˆæ¯å†…å®¹ä¸­çš„<code>headers</code>å±æ€§è¿›è¡ŒåŒ¹é…ã€‚æ€§èƒ½å·®ï¼ŒåŸºæœ¬ç”¨ä¸åˆ°ã€‚</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>RabbitMQ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¶ˆæ¯ä¸­é—´ä»¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çŸ¥è¯†ç‚¹æ±‡æ€»</title>
    <link href="/%E9%9D%A2%E8%AF%95%E5%87%86%E5%A4%87/"/>
    <url>/%E9%9D%A2%E8%AF%95%E5%87%86%E5%A4%87/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="ddd227fe8659d7620d8f370281c742ffe6762a665f6b4cc1ae5c92660b6b5cfa">ffda66bfab181c2acf199c136e56147374682d524a8b022b9f8c35ea0638a7c0072d1b33d658d4b2baf1c0fa50def23c5480504f6a79e1624bf1b6b822972e416e10d4c06496abe5fea9b6d7ab0a31f7292dd3cd6971083a178232ab65102071ab3473c665c3c378983a8f4ac0ac4ae959fdce7c787214a2e42859d680577b7e45194074c3da87785a15c32e130579f613d9738b191060d3721e0c7320fc8b53f3079658ba67bb9116f0a3bfb724de650eeb70e287fa83978695ebaf0841e680cb41a7d559128c62de13bf7636deea823694253d284436d0d0d582954d0f849e9eef4e243cce365a9c6ac5662299b94aeb3c9c4c6db4e7bf62c916f950761b28ecbd0fdd9beb7db5bc15f5d2ff78d28f5f4c77c78bd8ba2e6910d6d1f041818c0cbae27caa3e8566189c5e18d50fb6f9cb020f0ee65e66e7fcd4576b30ca0046b4355a88d9183c366048061a32f4ae3440cde9d15d984c41f00b51597165527dfb3ec5ec9ace816e5036ce5d165547780984d8f5f306df26506b3efc60dcd799658787a9e1dca8a205df412532448abb834e9a8a2ff5bd0fe0b3ec23d7776f769d3880a3f26bdee2127344182b08f16419db559ff4223ea3913402baa77b78355add6b9d933433ca60835b816b7abd89b446b9794064809d6629acffe4fd6438e7c9c569131684bb2fade0375cd86ba0096da15c21e6db5a987402a4e00968644fdcba60180534c3d3da2b7b328fcbebc678b64994c8d57b3a16887e692184bd36a6995038ea0fb686b732b356e41116b91096c734fcde72b0d3d9624c7865e97ed0c2b44aabe4c5538cdffd209384011df8b14d5f3dee3c83fc8027045696a99dab35eeadba19389e997532f86a2031d9b972359bcfc68964de46910723c46185797ca0424a161c4ea1940368eebc1862b8ae64204730e82a6b2747fbcb49ec03a1cb858525519ed9fb685c81ba918b9017e9ba341666354ac30414cf766f25818141ed7bd8d683b9f378e2a19d2fc63faf0a890b5c935ffefc2739a7f0c7b0cf2ad276977515e198310b1e7fa8f09258956cf30525f5841e1bce51d598876d7e543d3d9b388b0fd00b7169d0d019adaa85c18ae5d21fdd0acf3e5c1314c687353673d0ae4d9a9abf028efdca55c891df7cb48417a6780969d50e14fe73d42192ca08ce8cb41e82b72a2b9723942f6fc63572ee4fa9758cfcbc915689dfd526ecc18531a45e7f9362f34c163d398c4d96497c1a489e4f2dc3448f96dcacd8c312a42b4ca4762209e59c004e98eac5c2e863408f305c6af43ab60d91003b367b5e85df0582cf3c15d3c55d35705bab6fa77e3945960dc4f9e53cafa5a4033767a92459e43284df13fab6dc6787ac5b3b3a2b738b7ea492e493250054cad73cf23e1190473bfcc3125cd8b1924f642f4af56dc77c3296168c477dc9fef83099c509a3d8fad46158bf076cc6b10d58c49f4f14dd840db5d58535cf4d60e0b2119149e150cab02d6c02813bc45684984fce453e78e7555793830acc583a9edcaeebddec94cdd6a76627fa76c4d07d79148ce630e5abcd96d9a185226b86c4a40796aeb39c95714ce162f3b0fb7ba48a20073f0fb55ece752577835bdb0557d273f95a7f23f03f5cbf8669b66f613df64eb55917fa2f8cdd5c74f11449d6a4597b6f07e5133766eb4c6e35e2d3de2876cf7025cb5b8b1daf1962f4007f52370e73c5e655e8a8bcca0a97c2719b5b12f9d212c3d652f0eab442686d3009a1f76c1080df9178d36005c226c71cc64813f0bbc45e8a56d2acb75f76f327c3bad0f0973c1a41a25a455bff6cd3f3dc1d38d77692b2d8a9ca22923a84154dd18813de71b3b632ab898035a8e7e34eca5314ceab8fcfaf12f4456ad6c15ad0b3bf281fc841fc6a8469a7cd61751d18409eaea657da992a5caa69c097013edd0f2393b37ce659d90bd5a49878fa82d30401e7168ad7b0bd38cc9ed8f1ad4fab8c0ad89532975b300ba21da51bfaabbdf60962afc09ec16ad9a2b92ee951a790bb0833fe453462272fa76907e7cf3b20d66de5450d132d2ae04e453109d2f12163c9a202dd2244050b45d636ae62c36a3347dba9536d0f7f22dfdb92969c0f94a4f5970e4f65656d6d6149e12b761ddba0c38a9d989b8214b163ab3a972ee5505f24775ab68b4fff72736fe51a4d22fc73048e854beb2efbf66455624a5ddb28bf732b3991d25c269c124d9fa786ad9265f47e2839ee623ba86696b0cbaeceb892d4069fe84e57dde1dbb922916ed3cbf949338c093085ec23dd80a6bce106ba43473fe4b3aab9afcc5d30896741f007a1bca088b275cd5d5d7b569bf924f01b9a2d4224515210ba36d602dbd070caba9de15c8b32d5000cb085709f1c5ff119474b60a50b8cb7cdad0dc103a37666faa722feda05552f2d5ef509f3d231801039e22ecebb6da13975da918f4b6dc038d01c0bd17ce332c0c4291a47ecdc5b6852d116c9bd94f5f0c17d93d11f51a6f4cae9bcb7e1a23fb4e2bd818021f674c18fd7757feefe61ef82b241d651ded0606ff8d8d3b4add93e5e4dcc927f4e771639823d6fd5aaa560a366c21776ebad6153ea05a96432b78b379cd9a83ecf65680e95bb5e4de84833d785462b4a180f8fa240503e381d09e9eec7d8b81e5c2f238286f0074046c5a14814a83b88fe053d3a7444e1d65e4e5023cb5b4df85979d92f78587a4800a4fdd1b3bf1801b8ffc681676649175f5f4342cc0f2810a8495a1f217ba3b06191d3c202415ac532da9c78de46ddd31dc5c098c3901ccfcb018f3192a46289eff9258eef63fd4347872673862ae6c2ad6509866c0338798d89acff44f919b27140f80ad7cdb848e6c58ca2d41c791b5bd183889d95e81001c770983882daac75ddd36ea38ee229010841c7d31a720b397837ff677b81a1289b31ccc79b4b858e2879128565c19aad6a55d152cccae06a8c77cae86d82adc9d2faeab5c55f75ea76e53ab983c44bb54e3ff5c48ab90fa77acefc4ee1fdee74ee228d9c156a185b8bba224d0e00a1fae9a3b05895cd308b59713ea7fe6f85b871e4dbc8307ab6ced11bbdbab08a2e6efc0366bcde24ae7d891b7d81f39ce88f988a9b218c16468af2a768ad3e8f69b883f322e3eb32be1539c7238d1d9f3edbaa615b544a366381b640eb7a086669e31805d569c625aed7c38c83ce155c13f824562327dabd41c69eacb16c00d4013fb7ae3ed47d1c3fc172bf9f9bf557c402e6871a789c15e56f3289f5e9da094bc3aa93864a55968e9b82e50fb3c8ec06f7286be3dbe0703467b658971aec3e8af0909de5f327819f30c66dc2b637629fb0c67f6fcc924cbad8955ab43b40d56bd2ed17350c312171646f68d38ee97fa9e7c183489b7a50f0d290044e5d0ccf49f0cf4bdf7f6879f70790d6f9b2d8c78de362eea63d1c0f02d76527fee42bf508bddddaa1a1350b95f9c7aa1429ab6b84882ce959bafb10bd6b1d3f8a4214ae50dd8d9fc2465bc4b1d11cea251cb498eb103163d1f6954608533ef52434a8113cede1e666e5ee16a99b345fe9940f9a34d74a26f478a7238fa2cadc231fff50ccb2dc3c40026a3a883e2a1bfa31a58ab09e83cdfc348243e6f77b9e4f822dd1d6e820266b427a8d3a00483826df1bfdb7f1987c31fee89674db4326c956fe21fc4377e753525208324454fa67ea590cb29db4104cdb1cf8c03026f2ff9abebe7b30697c981d41b1515250a864f5354b4b55af972888e23bb392f4dbc13130cb44e81b3580d1c7be0394dc232553775bcc3dd2b8bafbdc1ef374ecdf674f30119549428a98878dc92247b03a167c5b8126ae63ceccec975f727a3de7b359553f723f66e77120a256053d3d688ba99945f0641fc0f7be54eda27897055eb8fc25f97b778820f83a366bf78ea8ebe0a880cd514c776697f64f28a76b4e2ace307750bc57410f9ac3f1cc01fc4bf94165cd82684115815e3314986928c6afb92e46ac4163f6b136ff53e95b36d017c7e99ab16d8777566af757af836031294d5a5974cf457926717637caaa374bf8b087a0489bf5eff0dca3ec10d1c14780356179aaeff17c8bdc98b1aace3bcd3ace34c1b2908e4a717b9063416bba12bf93f9889f8b8ecc374725e7b1deac17cc834ed6a3c69b3dbfc096ad1cf602f58c02548369af29171e40b45d1294c80d0267493cb179c4189739a17434c619da586efb0f0991c610fe85ec83f4edec778edcd993ea5eb04912158f5a7ee19887b8e0c42e497728ed40ecce600d164846f9e02ff06a68b951e500bbf601aa30d6b6a2a52a498f964e23c3ca3f2f0fa026e0a5013df11186fb92a1f9da9c571b45c4ad629d7e9a66ccbe144ffec10b84a0892492a86b4bb5ef06a6604283fd7295c796111cd2547229851e61649548d5a0f2972efbaf1de82eee0b1c3d3b4921fb94b347c933ad5671f9f93f61003cb7773fc3869d58d420ddc99867117716605012d88207d0fd4df828e15f45587ca27635e419026c9b63922b62605e1e08e3444544f96683e3a01517180dd9b58e5917bd6c425ef1f77d7e3cc2965c7039f4803dd1cd52161b35d2514a7c471c91add63ac1295f7757e1d9cdb4b82963d9795e9276e4775afbae20810bd80de9ac36633a6b29f61cdf81d6c51b131609ee4db26f8919123bd6251c9eb76985971b43743f7e47f1c92ef05ab4c6f3b77ffca648cf5768761f66f6356e83bc81eec6c228049a82aefc186839b200b9212a780c8d2da1825016e18e4c692b7c3998acc81decec04d214cc6fe35d6268b1b103c85e38c2efe26024c0972ab33716220bd6fe17a7c9881857fa911ea208e25098b2c23db81ed1136d2448cce7fa02737d6046df44dfb85b2e06716c406066d5225426cb879b00a963edf67cc44a77d8c1bfb9e48e917f387becbfddccce1690019e7ed0aa03ce0b9d6567fdbf4e78742089753943e63fdf9ea9aa7282a9a17f75b5218ea004a696b62f5f8e553075c168ddad59eec26b8d508c7518ce4c09775ff45cf3bb3ac27d70cea56faedd39cf1fba955ea776f758da1c6d657fa5d334ce855c2adb7fca4c90ef8f0cb5a15bba5aa234e5aa97bde335dea1613b3a45cadeea6d04b0780375aaaf3d3335d64c1f12ac4c3ef53d300cf7e4b47b6fe7ce9c8eee7030187a8dcf07804f27357f90ff7827917b42e327e6cd7657249afe8d88abb6740b06d5086367b0acbf70cae86003594477c38f669ecaf61711fbd61340cd98958250d3b114a00ac443d2f36d136a9f2abada92dcb94bd1d0659171608334279d898ca882ddd85cb8b1add465f0e6089193676b40a122313f220b7697796dd56a9eee7a1576f79b4aefdcb08f8b2c2325794bd2f0abcf84227059c851a7af92709b955f5bc8a8f56c0c2b1c0b9eb32cbaee9461b6fe8c969a597b4176ad6d6232e41f3a60af88da01ab6117d25b50cf7d72ef7cb5d538e62fe02bb349ae69631387b4ee0033c5ff4ca4f212385b921d6e084632f40cdd250da8b4dcf53ec6d72e3f20ca177b2d0dcdb48b69c569b96169e1363490c4f84ee4f341582cc6c07b3e3b30cb9566f30683bb6f6ebcacc30ab5af42be0cc50af9c0caf622f44f3c0c44cea00b98eea1848b5dabc30f28cf7a11d3cd0f5e046be940418a52e4434e56ccee5a54447407e6ced62cda18028785383183700a47c110852fd0a0c1088b95f68266cfe30551c486ee0d436b178a3a3e04bc9cd6d24e600d36aa004c63e77c8f3ff546c8388e53a46702b53b48d17765a5ca55d3e353517470659ae64204afaf139f548ddbb5148c6da4fed85a592f858e527901dd58629e94b51e9f93a76253c828b2df4081ff5bdc954a940192684b35573614b1c9813165e066f452092706b18026a64a02028d15a97b34934ab459e8bc41a9f8191f66554135b6d021143b95e2c5bdfd099de54a04e341e994e73fd2fca03146db5546cdacdee02d3439480d745bdbaf0addb5cfd9ad66ac47b85146a84bf3100f96855badbd5efcd5811f427618414c613036fc01b3dedd33553dda7c615f199cd9c0d3cad125d7694e25558c734604165526b449dc13d6bea6c0cec308cb5cb48d8a6c566f789f78d311ad11178fc320b79cd75f2e9a899d56c615202a8d75d0d7557c7128b8405d72ecb6e20e1e12daee4bb25a27193ebe90b4f83cc6a5b9d62034fe8fd6ab4fca1bccd6121ce27dba4ff9279ef153252f480e41ee0860c0062188236544159f487ccdf1d0a0d375530c172f7bbcced3ddf842290ed76e1561ca2e245908d61b407f79cefb8ec8ad6b51c8ef505fdad38d5ccc8688331f2a166f621fc1574d83a6f63e812488bfa82bf676a19e4d03aa40bfbb36d8157196238f77fa000fb5aa513ea1be1e7c7ac14738cb50ae702b17bbaa74fe486aaec8c58127540fe2733586df0156c232d9378873535b8643d0004c057d7679882d92e09e12407456f1d0f3a2644147a93a1ffb054487d3d1c3802f34ccc950d86baf20c78563ea201d6160b62f682ca8fd0f790ab9e98a8f927df129e58325c4323b2c4f92aae177f7323a7e8c61b9201dcc7573664a57b0de7494bb9453a76b8d3cf1974909a50631c62b0131b9e0083a50ae1117e15ea7f35734538c671d5e7892cd13d23bc5d4eddd4e5e3a94579cce31f7f4d0e4e9b650bb4ed72be7e293e122cb19e5d850eb435ce0b357114592fcb60a2b56e4bed55a22705897ca4d37e8b79478f4ef35ddc201595890e6c65527da5376527f50ab6d571da9e1213d1a0d2477d09517f6e281631e22fd05ee221bfa5dc08933863b3839a0124dfe693545c2438f8229ff6e3661f63006c4b7799df3122751ebbbf7bcc2f80b3558c0a55cb46640eb65d4369d6da0ecd81b12ec8740bca7f90625a579fec865f9c275df1fa1dd63cea210d96d6045b4ab72e11b51b8d22cf7c3fd7788d122958ee6b9700f87f24f3e987116aba0672caeedd89ede9ded36bc26eee4a97348e83048806bff60f583e1c655aa3de9735d3cba93a8e9c247bdcea2c3314c8206a59899303e1ccf846c55aa473cbe2e32623428c7cd04935f5ee52ba603bdca498d08b141de4505301c3a96320308ba6b539e9d5f2e08c346fe6d000d3cf4f4ba6176fdbef4ca115b7c0a1c1f99db1054d466561931effbc5fa5473f55f21d6bfada75b659703503cea5aac9f433a6e6a65dcd619e462f0d7d9273956545c445d5d350abb5b0522061d0213812d75f58b20a2d8d383a861c7d458db31166f3a430d7f73b14fa4709df5f852e349dd22b7a4964f952a329eec0bacac114e848a153112528eb93157424fb96c6f277262d36559de92454954b47895ac11110849084e3e8705a09a0ba7a6dc418345d91e805f3f78ad197ea4077e11e2c8994bfa3eae69baea9845288e4a65bd0cbf71633f877757b1d3b63366b10066a6bf672cb45127c585e7e1edf6bceaf6d538311e414d79c8265a486f5414c21a2700d7339937f8b9c04bb9822ac42e775b2654f9345b34c51856107169fe7f4516c3e1756fdd699558172b55b42cfc2df9752199fcb578eacde84824eafff289daed4bb1e2883866cb38157d756e6adb1be8a4f35288ce810c94e1adc0324074a57b18a1f294e006ad965e89267b0f71a495c54ae4eec070acfcb7d10514ef913ee3b33b54963a31b5bf5ec6f782d53d429dade3c9b46da9bffa457a24f9b0a402659355bce246ca61244295fd8132b4e532f5cf5cf7c950afa210bdf314075abed115c1cb5ba861127a267d904601132583b2d991f69f8e0ce1b802a789b3984dcae9d4c52b00662c86756177ddca9ac58c86bdaef13221b430be70eca9a2d6b95e6a108ca3313dcb11da7930874e5cc50ac3fb069a8489d31282b2e46bf7d4c5947964cbf7eea6bae6e90e732bfd36c74f924d793c5818aca8490272ef8e939cb96aa212</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>springCloudçŸ¥è¯†ç‚¹æ•´ç†</title>
    <link href="/springCloud%E9%9D%A2%E8%AF%95%E9%A2%98%E6%95%B4%E7%90%86/"/>
    <url>/springCloud%E9%9D%A2%E8%AF%95%E9%A2%98%E6%95%B4%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h2 id="1-ä¸ºä»€ä¹ˆä¼šå‡ºç°SpringCloud"><a href="#1-ä¸ºä»€ä¹ˆä¼šå‡ºç°SpringCloud" class="headerlink" title="1. ä¸ºä»€ä¹ˆä¼šå‡ºç°SpringCloud?"></a>1. ä¸ºä»€ä¹ˆä¼šå‡ºç°SpringCloud?</h2><p>å•ä½“æ¶æ„çš„ä¼˜ç¼ºç‚¹</p><p>ä¼˜ç‚¹ï¼š</p><ul><li>éƒ¨ç½²ç®€å•ï¼šåªæœ‰ä¸€ä¸ªåŒ…</li><li>æŠ€æœ¯å•ä¸€ï¼šåŒä¸€ä¸ªæ¶æ„æ¥è¯´ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªä¸€ç§æŠ€æœ¯ï¼Œç±»ä¼¼springboot + java</li><li>ç”¨äººæˆæœ¬ä½ï¼šå› ä¸ºåªéœ€è¦ä¸€ç§æŠ€æœ¯</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ä»£ç ç»“æ„æ··ä¹±ï¼šä¸šåŠ¡å¤æ‚ï¼Œå¯¼è‡´ä»£ç é‡å¾ˆå¤§ï¼Œç®¡ç†ä¼šè¶Šæ¥è¶Šå›°éš¾ã€‚</li><li>ç»å¸¸éœ€è¦è§£å†³å†²çªï¼Œå¼€å‘æ•ˆç‡ä½ï¼šå¼€å‘äººå‘˜åŒæ—¶ç»´æŠ¤åŒä¸€å¥—ä»£ç ï¼Œå¾ˆéš¾é¿å…ä»£ç å†²çªã€‚å¼€å‘è¿‡ç¨‹ä¸­ä¼šä¼´éšè§£å†³å†²çªï¼Œä¸¥é‡å½±å“å¼€å‘æ•ˆç‡ã€‚</li><li>æ’æŸ¥è§£å†³é—®é¢˜æˆæœ¬é«˜ï¼šçº¿ä¸Šå‘ç°äº†bugï¼Œå¯èƒ½bu gå¾ˆç®€å•ï¼Œä½†æ˜¯ç”±äºåªæœ‰ä¸€å¥—ä»£ç ï¼Œéœ€è¦ç¼–è¯‘æ‰“åŒ…ä¸Šçº¿ï¼Œæˆæœ¬å¾ˆé«˜ã€‚</li><li>ç›‘æ§å¾ˆéš¾ï¼šå¾ˆå¤šåŠŸèƒ½ç‚¹ï¼Œæ‚åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ã€‚</li></ul><p>ç”±äºå•ä½“ç»“æ„çš„åº”ç”¨éšç€ç³»ç»Ÿå¤æ‚åº¦çš„å¢é«˜ï¼Œä¼šæš´éœ²å‡ºå„ç§å„æ ·çš„é—®é¢˜ã€‚è¿‘äº›å¹´æ¥ï¼Œå¾®æœåŠ¡æ¶æ„é€æ¸å–ä»£äº†å•ä½“æ¶æ„ï¼Œä¸”è¿™ç§è¶‹åŠ¿å°†ä¼šè¶Šæ¥è¶Šæµè¡Œã€‚</p><h2 id="2-ä»€ä¹ˆæ˜¯Spring-Cloudï¼Ÿ"><a href="#2-ä»€ä¹ˆæ˜¯Spring-Cloudï¼Ÿ" class="headerlink" title="2. ä»€ä¹ˆæ˜¯Spring Cloudï¼Ÿ"></a>2. <strong>ä»€ä¹ˆæ˜¯Spring Cloud</strong>ï¼Ÿ</h2><p>SpringCloudæ˜¯åŸºäºSpringBootçš„ä¸€æ•´å¥—å®ç°å¾®æœåŠ¡çš„<strong>æ¡†æ¶</strong>ã€‚å®ƒæä¾›äº†å¾®æœåŠ¡å¼€å‘æ‰€éœ€çš„æœåŠ¡æ³¨å†Œä¸å‘ç°,æœåŠ¡è°ƒç”¨,è´Ÿè½½å‡è¡¡,APIç½‘å…³</p><p>é…ç½®ç®¡ç†,ç†”æ–­å™¨</p><p><strong>springCloudçš„ä¼˜ç¼ºç‚¹</strong></p><p>ä¼˜ç‚¹ï¼š</p><ul><li>äº§å‡ºäºSpringå¤§å®¶æ—ï¼ŒSpringåœ¨ä¼ä¸šçº§å¼€å‘æ¡†æ¶ä¸­æ— äººèƒ½æ•Œï¼Œæ¥å¤´å¾ˆå¤§ï¼Œå¯ä»¥ä¿è¯åç»­çš„æ›´æ–°ã€å®Œå–„ ã€‚</li><li>ç»„ä»¶ä¸°å¯Œï¼ŒåŠŸèƒ½é½å…¨ã€‚Spring Cloud ä¸ºå¾®æœåŠ¡æ¶æ„æä¾›äº†éå¸¸å®Œæ•´çš„æ”¯æŒã€‚ä¾‹ å¦‚ã€é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æ–­è·¯å™¨ã€å¾®æœåŠ¡ç½‘å…³ç­‰ï¼› </li><li>Spring Cloud ç¤¾åŒºæ´»è·ƒåº¦å¾ˆé«˜ï¼Œæ•™ç¨‹å¾ˆä¸°å¯Œï¼Œé‡åˆ°é—®é¢˜å¾ˆå®¹æ˜“æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ</li><li>æœåŠ¡æ‹†åˆ†ç²’åº¦æ›´ç»†ï¼Œè€¦åˆåº¦æ¯”è¾ƒä½ï¼Œæœ‰åˆ©äºèµ„æºé‡å¤åˆ©ç”¨ï¼Œæœ‰åˆ©äºæé«˜å¼€å‘æ•ˆç‡</li><li>å‡è½»å›¢é˜Ÿçš„æˆæœ¬ï¼Œå¯ä»¥å¹¶è¡Œå¼€å‘ï¼Œä¸ç”¨å…³æ³¨å…¶ä»–äººæ€ä¹ˆå¼€å‘ï¼Œå…ˆå…³æ³¨è‡ªå·±çš„å¼€å‘ </li><li>å¾®æœåŠ¡å¯ä»¥æ˜¯è·¨å¹³å°çš„ï¼Œå¯ä»¥ç”¨ä»»ä½•ä¸€ç§è¯­è¨€å¼€å‘</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å¾®æœåŠ¡è¿‡å¤šï¼Œæ²»ç†æˆæœ¬é«˜ï¼Œä¸åˆ©äºç»´æŠ¤ç³»ç»Ÿ </li><li>åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘çš„æˆæœ¬é«˜ï¼ˆå®¹é”™ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ç­‰ï¼‰å¯¹å›¢é˜ŸæŒ‘æˆ˜å¤§</li></ul><h2 id="3-springboot-å’ŒspringCloud-çš„åŒºåˆ«å’Œè”ç³»"><a href="#3-springboot-å’ŒspringCloud-çš„åŒºåˆ«å’Œè”ç³»" class="headerlink" title="3. springboot å’ŒspringCloud çš„åŒºåˆ«å’Œè”ç³»"></a>3. springboot å’ŒspringCloud çš„åŒºåˆ«å’Œè”ç³»</h2><ul><li>springCloud æ˜¯åŸºäºSpringboot æ„å»ºçš„ï¼Œä»–é‡Œé¢çš„æ¯ä¸ªå­é¡¹ç›®å°±æ˜¯ä¸€ä¸ªspringbooté¡¹ç›®ã€‚SpringBootå¯ä»¥ç¦»å¼€SpringCloudç‹¬ç«‹ä½¿ç”¨å¼€å‘é¡¹ç›®ï¼Œ ä½†æ˜¯SpringCloudç¦»ä¸ å¼€SpringBoot ï¼Œå±äºä¾èµ–çš„å…³ç³» </li><li>SpringBootä¸“æ³¨äºå¿«é€Ÿæ–¹ä¾¿çš„å¼€å‘å•ä¸ªä¸ªä½“å¾®æœåŠ¡ã€‚ SpringCloudæ˜¯å…³æ³¨å…¨å±€çš„å¾®æœåŠ¡åè°ƒæ•´ç†æ²»ç†æ¡†æ¶ï¼Œä¸ºå¾®æœåŠ¡æ¶æ„æä¾›äº†éå¸¸å®Œæ•´çš„æ”¯æŒã€‚ä¾‹å¦‚ã€é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æ–­è·¯å™¨ã€å¾®æœåŠ¡ç½‘å…³ç­‰</li></ul><h2 id="4-Spring-Cloud-Netflixæ ¸å¿ƒç»„ä»¶ï¼Ÿ"><a href="#4-Spring-Cloud-Netflixæ ¸å¿ƒç»„ä»¶ï¼Ÿ" class="headerlink" title="4. Spring Cloud Netflixæ ¸å¿ƒç»„ä»¶ï¼Ÿ"></a>4. <strong>Spring Cloud Netflix</strong>æ ¸å¿ƒç»„ä»¶ï¼Ÿ</h2><p>Netflix OSS å¼€æºç»„ä»¶é›†æˆï¼ŒåŒ…æ‹¬Eurekaã€Hystrixã€Ribbonã€Feignã€Zuulç­‰ æ ¸å¿ƒç»„ä»¶ã€‚</p><ul><li><p>Eurekaï¼šæœåŠ¡æ²»ç†ç»„ä»¶ï¼ŒåŒ…æ‹¬æœåŠ¡ç«¯çš„æ³¨å†Œä¸­å¿ƒå’Œå®¢æˆ·ç«¯çš„æœåŠ¡å‘ç°æœºåˆ¶ï¼› </p></li><li><p>Ribbonï¼šè´Ÿè½½å‡è¡¡çš„æœåŠ¡è°ƒç”¨ç»„ä»¶ï¼Œå…·æœ‰å¤šç§è´Ÿè½½å‡è¡¡è°ƒç”¨ç­–ç•¥ï¼› </p></li><li><p>Feignï¼šåŸºäºRibbonå’ŒHystrixçš„å£°æ˜å¼æœåŠ¡è°ƒç”¨ç»„ä»¶ï¼› </p></li><li><p>Zuulï¼šAPIç½‘å…³ç»„ä»¶ï¼Œå¯¹è¯·æ±‚æä¾›è·¯ç”±åŠè¿‡æ»¤åŠŸèƒ½ã€‚</p></li><li><p>Hystrixï¼šæœåŠ¡å®¹é”™ç»„ä»¶ï¼Œå®ç°äº†æ–­è·¯å™¨æ¨¡å¼ï¼Œä¸ºä¾èµ–æœåŠ¡çš„å‡ºé”™å’Œå»¶è¿Ÿæä¾›äº† å®¹é”™èƒ½åŠ›ï¼› </p></li><li><p>Bus:</p></li></ul><h1 id="5-å¾®æœåŠ¡æ¶æ„ç»„æˆ"><a href="#5-å¾®æœåŠ¡æ¶æ„ç»„æˆ" class="headerlink" title="5. å¾®æœåŠ¡æ¶æ„ç»„æˆ"></a>5. å¾®æœåŠ¡æ¶æ„ç»„æˆ</h1><h2 id="5-1-æœåŠ¡æ³¨å†Œä¸å‘ç°"><a href="#5-1-æœåŠ¡æ³¨å†Œä¸å‘ç°" class="headerlink" title="5.1 æœåŠ¡æ³¨å†Œä¸å‘ç°"></a>5.1 æœåŠ¡æ³¨å†Œä¸å‘ç°</h2><h3 id="1-æœåŠ¡æ³¨å†Œå’Œå‘ç°æ˜¯ä»€ä¹ˆ"><a href="#1-æœåŠ¡æ³¨å†Œå’Œå‘ç°æ˜¯ä»€ä¹ˆ" class="headerlink" title="1. æœåŠ¡æ³¨å†Œå’Œå‘ç°æ˜¯ä»€ä¹ˆ"></a>1. æœåŠ¡æ³¨å†Œå’Œå‘ç°æ˜¯ä»€ä¹ˆ</h3><ul><li>æœåŠ¡æ³¨å†Œ ï¼Œå°±æ˜¯å°†æä¾›æŸä¸ªæœåŠ¡çš„æ¨¡å—ä¿¡æ¯ (é€šå¸¸æ˜¯è¿™ä¸ªæœåŠ¡çš„ipå’Œç«¯å£)æ³¨å†Œåˆ°1ä¸ªå…¬å…±çš„ç»„ä»¶ä¸Šå»ã€‚</li><li>æœåŠ¡å‘ç° ï¼Œå°±æ˜¯æ–°<strong>æ³¨å†Œçš„è¿™ä¸ªæœåŠ¡æ¨¡å—èƒ½å¤ŸåŠæ—¶çš„è¢«å…¶ä»–è°ƒç”¨è€…å‘ç°ã€‚</strong></li></ul><h3 id="2-ä»€ä¹ˆæ˜¯æ³¨å†Œä¸­å¿ƒ"><a href="#2-ä»€ä¹ˆæ˜¯æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="2. ä»€ä¹ˆæ˜¯æ³¨å†Œä¸­å¿ƒ"></a>2. ä»€ä¹ˆæ˜¯æ³¨å†Œä¸­å¿ƒ</h3><p>æ³¨å†Œä¸­å¿ƒå¯ä»¥è¯´æ˜¯å¾®æœåŠ¡æ¶æ„ä¸­çš„â€é€šè®¯å½•â€œï¼Œå®ƒè®°å½•äº†æœåŠ¡å’ŒæœåŠ¡åœ°å€çš„æ˜ å°„å…³ç³»ã€‚åœ¨åˆ†å¸ƒå¼æ¶æ„ä¸­ï¼ŒæœåŠ¡ä¼šæ³¨å†Œåˆ°è¿™é‡Œï¼Œå½“æœåŠ¡éœ€è¦è°ƒç”¨å…¶å®ƒæœåŠ¡æ—¶ï¼Œå°±åˆ°è¿™é‡Œæ‰¾åˆ°æœåŠ¡çš„åœ°å€ï¼Œè¿›è¡Œè°ƒç”¨ã€‚</p><h3 id="3-æ³¨å†Œä¸­å¿ƒçš„å®ç°æ–¹å¼"><a href="#3-æ³¨å†Œä¸­å¿ƒçš„å®ç°æ–¹å¼" class="headerlink" title="3 æ³¨å†Œä¸­å¿ƒçš„å®ç°æ–¹å¼"></a>3 æ³¨å†Œä¸­å¿ƒçš„å®ç°æ–¹å¼</h3><ul><li>mysql: å°†æœåŠ¡å’ŒæœåŠ¡åœ°å€çš„æ˜ å°„å…³ç³»insertåˆ°æ•°æ®åº“ä¸­ï¼Œè°ƒç”¨æœåŠ¡å‰å»selectã€‚ç»´æŠ¤ ä¸€ä¸ªå¿ƒè·³ï¼Œå®šæœŸå»æ„Ÿåº”ä¸‹èŠ‚ç‚¹çŠ¶æ€æ˜¯å¦æ­£å¸¸ï¼Œæ¯”å¦‚pingä¸€ä¸‹ç«¯å£ï¼Œå¦‚æœä¸æ­£å¸¸ï¼Œä¿®æ”¹æ­¤æ—¶èŠ‚ç‚¹çŠ¶æ€</li><li>zookeeperï¼šåœ¨è¿™ä¸ªçˆ¶èŠ‚ç‚¹ä¸Šåˆ›å»ºä¸´æ—¶å­èŠ‚ç‚¹ï¼Œç”¨æ¥å­˜å‚¨æœåŠ¡å’ŒæœåŠ¡åœ°å€çš„æ˜ å°„å…³ç³»ï¼Œå¯¹åº”ç”Ÿæˆæ³¨å†Œè¡¨ã€‚è°ƒç”¨æœåŠ¡å‰å»èŠ‚ç‚¹é‡ŒæŸ¥è¯¢èŠ‚ç‚¹æ•°æ®ï¼Œzookeeperæœ‰ç›‘å¬é€šçŸ¥æœºåˆ¶ï¼Œæˆ‘ä»¬å¯¹æŸä¸ªèŠ‚ç‚¹è¿›è¡Œç›‘å¬ï¼Œå½“è¿™ä¸ªèŠ‚ç‚¹è¢«åˆ é™¤æ—¶ï¼Œç›‘å¬æ–¹ä¼šæ„ŸçŸ¥åˆ°é‡æ–°æ‹‰å–æœåŠ¡åˆ—è¡¨ã€‚</li><li>Eureka</li></ul><h3 id="4-Spring-Cloud-å¦‚ä½•å®ç°æœåŠ¡æ³¨å†Œå’Œå‘ç°ï¼Ÿ"><a href="#4-Spring-Cloud-å¦‚ä½•å®ç°æœåŠ¡æ³¨å†Œå’Œå‘ç°ï¼Ÿ" class="headerlink" title="4. Spring Cloud å¦‚ä½•å®ç°æœåŠ¡æ³¨å†Œå’Œå‘ç°ï¼Ÿ"></a>4. Spring Cloud å¦‚ä½•å®<strong>ç°æœåŠ¡æ³¨å†Œå’Œå‘ç°ï¼Ÿ</strong></h3><p>ç”±äºæ‰€æœ‰æœåŠ¡éƒ½åœ¨ Eureka æœåŠ¡å™¨ä¸Šæ³¨å†Œå¹¶ é€šè¿‡è°ƒç”¨ Eureka æœåŠ¡å™¨å®ŒæˆæŸ¥æ‰¾ï¼Œå› æ­¤æ— éœ€å¤„ç†æœåŠ¡åœ°ç‚¹çš„ä»»ä½•æ›´æ”¹å’Œå¤„ç†ã€‚</p><p><a href="https://pyr9.github.io/CAP%E5%8E%9F%E5%88%99%E4%BB%A5%E5%8F%8Aeureka%E5%92%8Czookeeper%E7%9A%84%E5%AF%B9%E6%AF%94/">CAPåŸåˆ™ä»¥åŠeurekaå’Œzookeeperçš„å¯¹æ¯”</a></p><h2 id="5-2-æœåŠ¡è°ƒç”¨"><a href="#5-2-æœåŠ¡è°ƒç”¨" class="headerlink" title="5.2 æœåŠ¡è°ƒç”¨"></a>5.2 æœåŠ¡è°ƒç”¨</h2><h2 id="5-3-è´Ÿè½½å‡è¡¡"><a href="#5-3-è´Ÿè½½å‡è¡¡" class="headerlink" title="5.3 è´Ÿè½½å‡è¡¡"></a>5.3 è´Ÿè½½å‡è¡¡</h2><h2 id="5-4-APIç½‘å…³"><a href="#5-4-APIç½‘å…³" class="headerlink" title="5.4 APIç½‘å…³"></a>5.4 APIç½‘å…³</h2><h3 id="Spring-Cloud-Gateway-å’Œzuul"><a href="#Spring-Cloud-Gateway-å’Œzuul" class="headerlink" title="Spring Cloud Gateway å’Œzuul"></a>Spring Cloud Gateway å’Œzuul</h3><p>ç›¸åŒç‚¹ï¼šäºŒè€…éƒ½æ˜¯å¯ä»¥ç”¨æ¥å®ç°APIç½‘å…³</p><p>ä¸åŒç‚¹ï¼š</p><ul><li>å¼€å‘å›¢é˜Ÿä¸åŒã€‚<ul><li>zuulæ˜¯netfixå¼€å‘çš„</li><li>spring Cloud Gatewayæ˜¯Spring Cloudå®˜æ–¹æ¨å‡ºçš„ç¬¬äºŒä»£ç½‘å…³æ¡†æ¶ï¼Œç”¨æ¥å–ä»£Zuulç½‘å…³ã€‚</li></ul></li><li>zuulæ€§èƒ½ç›¸å¯¹gatewayè¾ƒå·®ã€‚<ul><li>Zuul1.* æ˜¯ä¸€ä¸ªæå…·é˜»å¡IOçš„API GateWayï¼Œæ¯æ¬¡IOæ“ä½œéƒ½æ˜¯ä»å·¥ä½œçº¿ç¨‹ä¸­é€‰æ‹©ä¸€ä¸ªæ‰§è¡Œï¼Œè¯·æ±‚çº¿ç¨‹è¢«é˜»å¡åˆ°å·¥ä½œçº¿ç¨‹å®Œæˆã€‚æ‰€ä»¥zuulçš„æ€§èƒ½è¾ƒå·®ã€‚zuu2ç†å¿µæ›´å…ˆè¿›ï¼ŒåŸºäºnettyéé˜»å¡ï¼Œä½†æ˜¯springCloudè¿˜æ²¡æœ‰æ•´åˆã€‚</li><li>Spring Cloud Gateway æ˜¯åŸºäº WebFlux æ¡†æ¶å®ç°çš„ï¼Œè€Œ WebFlux æ¡†æ¶åº•å±‚åˆ™ä½¿ç”¨äº†é«˜æ€§èƒ½çš„ Reactor æ¨¡å¼é€šä¿¡æ¡†æ¶ Nettyã€‚é«˜å¹¶å‘å’Œéé˜»å¡é€šä¿¡å°±éå¸¸æœ‰ä¼˜åŠ¿</li><li>Spring Cloud Gatewayè¿˜æ”¯æŒwebSocketï¼Œå¹¶ä¸”ä¸springæœ‰å¾ˆå¥½çš„é›†æˆ</li></ul></li></ul><blockquote><p>WebSocket åè®®,å¤§ç‰¹ç‚¹å°±æ˜¯ï¼ŒæœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œæ˜¯çœŸæ­£çš„åŒå‘å¹³ç­‰å¯¹è¯ï¼Œå±äº<a href="https://en.wikipedia.org/wiki/Push_technology">æœåŠ¡å™¨æ¨é€æŠ€æœ¯</a>çš„ä¸€ç§ã€‚</p></blockquote><p> å¤šæ–¹é¢æ¯”è¾ƒï¼ŒgateWayæ˜¯å¾ˆç†æƒ³çš„ç½‘å…³é€‰æ‹©ã€‚</p><h2 id="5-5-é…ç½®ç®¡ç†"><a href="#5-5-é…ç½®ç®¡ç†" class="headerlink" title="5.5 é…ç½®ç®¡ç†"></a>5.5 é…ç½®ç®¡ç†</h2><h3 id="1-springCloud-config-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-springCloud-config-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1 springCloud config æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1 springCloud config æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li>Spring Cloud Config æ˜¯ç”± Spring Cloud å›¢é˜Ÿå¼€å‘çš„é¡¹ç›®ï¼Œå®ƒå¯ä»¥ä¸ºå¾®æœåŠ¡æ¶æ„ä¸­å„ä¸ªå¾®æœåŠ¡æä¾›é›†ä¸­åŒ–çš„å¤–éƒ¨é…ç½®æ”¯æŒã€‚</li><li>Spring Cloud Config å¯ä»¥å°†å„ä¸ªå¾®æœåŠ¡çš„é…ç½®æ–‡ä»¶é›†ä¸­å­˜å‚¨åœ¨ä¸€ä¸ªå¤–éƒ¨çš„å­˜å‚¨ä»“åº“æˆ–ç³»ç»Ÿï¼ˆä¾‹å¦‚ Git ã€SVN ç­‰ï¼‰ä¸­ï¼Œå¯¹é…ç½®çš„ç»Ÿä¸€ç®¡ç†ï¼Œä»¥æ”¯æŒå„ä¸ªå¾®æœåŠ¡çš„è¿è¡Œã€‚</li><li>Spring Cloud Config åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªéƒ¨åˆ†ï¼š<ul><li>Config Serverï¼šä¹Ÿè¢«ç§°ä¸ºåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒï¼Œå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹è¿è¡Œçš„å¾®æœåŠ¡åº”ç”¨ï¼Œç”¨æ¥è¿æ¥é…ç½®ä»“åº“å¹¶ä¸ºå®¢æˆ·ç«¯æä¾›è·å–é…ç½®ä¿¡æ¯ã€åŠ å¯†ä¿¡æ¯å’Œè§£å¯†ä¿¡æ¯çš„è®¿é—®æ¥å£ã€‚</li><li>Config Clientï¼šæŒ‡çš„æ˜¯å¾®æœåŠ¡æ¶æ„ä¸­çš„å„ä¸ªå¾®æœåŠ¡ï¼Œå®ƒä»¬é€šè¿‡ Config Server å¯¹é…ç½®è¿›è¡Œç®¡ç†ï¼Œå¹¶ä» Config Sever ä¸­è·å–å’ŒåŠ è½½é…ç½®ä¿¡æ¯ã€‚</li></ul></li></ul><h2 id="5-6-ç†”æ–­å™¨"><a href="#5-6-ç†”æ–­å™¨" class="headerlink" title="5.6 ç†”æ–­å™¨"></a>5.6 ç†”æ–­å™¨</h2><h3 id="1-ä»€ä¹ˆæ˜¯æœåŠ¡ç†”æ–­ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯æœåŠ¡ç†”æ–­ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯æœåŠ¡ç†”æ–­ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯æœåŠ¡ç†”æ–­ï¼Ÿ</h3><ul><li>æœåŠ¡ç†”æ–­å°±æ˜¯å¯¹æœåŠ¡çš„è°ƒç”¨æ‰§è¡Œç†”æ–­ï¼Œå¯¹äºåç»­çš„è¯·æ±‚ï¼Œä¸å†è°ƒç”¨ç›®æ ‡æœåŠ¡ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›ä¸€ä¸ªåˆç†çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´è¯·æ±‚é‡å¤ªå¤§ï¼Œè¿”å›ä¸€ä¸ªâ€æ­¤æ—¶æœåŠ¡è¿‡è½½â€ï¼Œä»è€Œå¯ä»¥å¿«é€Ÿé‡Šæ”¾èµ„æº</li><li>ä¿æŠ¤ç³»ç»Ÿ</li></ul><h3 id="2-ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§ç†”æ–­æœºåˆ¶çš„å‡ºç°"><a href="#2-ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§ç†”æ–­æœºåˆ¶çš„å‡ºç°" class="headerlink" title="2 ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§ç†”æ–­æœºåˆ¶çš„å‡ºç°?"></a>2 ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§ç†”æ–­æœºåˆ¶çš„å‡ºç°?</h3><p>åœ¨å¾®æœåŠ¡ç›¸äº’è°ƒç”¨çš„æ—¶å€™å¯èƒ½ä¼šå‡ºç°æœåŠ¡è°ƒç”¨å‘ç”Ÿå¼‚å¸¸æˆ–è°ƒç”¨è¶…æ—¶,å¤šæ­¤è¯·æ±‚é€ æˆæœåŠ¡ç§¯å‹å¯¼è‡´æœåŠ¡æ— æ³•ä½¿ç”¨åæ¥ç€çº§è”å¯¼è‡´è°ƒç”¨æ­¤æœåŠ¡çš„æ¶ˆè´¹è€…ä¹Ÿå‡ºç°å¼‚å¸¸æˆ–è°ƒç”¨è¶…æ—¶,æœ€åå¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„å…¨éƒ¨å´©æºƒ.è¿™å°±æ˜¯é›ªå´©æ•ˆåº”.</p><blockquote><p><a href="https://so.csdn.net/so/search?q=%E7%BA%A7%E8%81%94&spm=1001.2101.3001.7020">çº§è”</a>(å¤±è´¥)é›ªå´©ï¼šä¸€ä¸ªæœåŠ¡å¤±è´¥ï¼Œå¯¼è‡´æ•´æ¡é“¾è·¯çš„æœåŠ¡éƒ½å¤±è´¥çš„æƒ…å½¢ã€‚</p></blockquote><h3 id="3-ç†”æ–­å™¨çš„åŠŸèƒ½"><a href="#3-ç†”æ–­å™¨çš„åŠŸèƒ½" class="headerlink" title="3. ç†”æ–­å™¨çš„åŠŸèƒ½"></a>3. ç†”æ–­å™¨çš„åŠŸèƒ½</h3><ul><li>å¼‚å¸¸å¤„ç†ã€‚éœ€è¦å¯ä»¥æ ¹æ®å¼‚å¸¸çš„ç±»å‹ï¼Œå»å¤„ç†å¼‚å¸¸</li><li>æ—¥å¿—è®°å½•ã€‚è®°å½•å¤±è´¥çš„æ•°ç›®ï¼Œæ‰å¯ä»¥å¼€å¯ç†”æ–­</li><li>æµ‹è¯•å¤±è´¥çš„æ“ä½œã€‚å‘¨æœŸæ€§çš„æ£€æŸ¥æ¥æµ‹è¯•æœåŠ¡æ˜¯å¦å¥åº·ã€‚</li><li>æ‰‹åŠ¨å¤ä½ã€‚ç®¡ç†å‘˜å¯ä»¥å¼ºè¡Œå…³é—­æ–­è·¯å™¨ï¼Œé‡ç½®æ•…éšœçš„è®¡æ•°å™¨</li><li>å¹¶å‘ã€‚æ–­è·¯å™¨å¯ä»¥æ”¯æŒå¤§å¹¶å‘é‡</li><li>åŠ é€Ÿæ–­è·¯ï¼šæ£€æµ‹å‡ºé—®é¢˜çš„é€Ÿåº¦è¦å¿«ï¼ŒåŠæ—¶å“åº”</li><li>é‡è¯•å¤±è´¥è¯·æ±‚ï¼šåœ¨æœåŠ¡å¯ç”¨æ—¶ï¼Œå¯ä»¥å®‰æ’é‡è¯•</li></ul><h3 id="4-ç†”æ–­å’Œé™çº§çš„åŒºåˆ«"><a href="#4-ç†”æ–­å’Œé™çº§çš„åŒºåˆ«" class="headerlink" title="4 ç†”æ–­å’Œé™çº§çš„åŒºåˆ«"></a>4 ç†”æ–­å’Œé™çº§çš„åŒºåˆ«</h3><p>ç›¸åŒç‚¹ï¼š</p><ul><li>ç›®çš„ä¸€è‡´ã€‚é€šè¿‡æŠ€æœ¯æ‰‹æ®µæ¥ä¿æŠ¤ç³»ç»Ÿ</li><li>è¡¨ç°ç±»ä¼¼ï¼šè®©ç”¨æˆ·ä½“éªŒåˆ°æŸäº›æœåŠ¡æš‚æ—¶ä¸å¯ç”¨</li><li>ç²’åº¦ç›¸åŒï¼šéƒ½æ˜¯åŸºäºæœåŠ¡çš„</li></ul><p>ä¸åŒç‚¹</p><ul><li>è§¦å‘æ¡ä»¶ä¸åŒ<ul><li>æœåŠ¡ç†”æ–­ï¼šæœåŠ¡ç†”æ–­ç”±é“¾è·¯ä¸ŠæŸä¸ªæœåŠ¡æ•…éšœå¼•èµ·çš„</li><li>æœåŠ¡é™çº§ï¼Œæ•´ä½“è´Ÿè·æ¥è€ƒè™‘ã€‚æ¯”å¦‚ï¼šåŸæœ¬æœ‰ä¸€ä¸ªç³»ç»Ÿå¯ä»¥æ‰¿è½½100ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯åé¢ç”±äºè¯·æ±‚æ•°é™ä½ï¼Œç›¸åº”çš„æœåŠ¡æ•°é‡ä¹Ÿéœ€è¦é™ä½</li></ul></li><li>ç®¡ç†ç›®æ ‡å±‚çº§ä¸åŒ<ul><li>æœåŠ¡ç†”æ–­ï¼šæœåŠ¡ç†”æ–­æ˜¯ä¸€ä¸ªæ¡†æ¶å±‚æ¬¡çš„å¤„ç†ï¼Œ</li><li>æœåŠ¡é™çº§ï¼šæœåŠ¡é™çº§æ˜¯ä¸šåŠ¡å±‚æ¬¡çš„å¤„ç†ã€‚é™çº§ä¸€èˆ¬æ˜¯ä»å¤–å›´æœåŠ¡å¼€å§‹</li></ul></li></ul><h3 id="5-ç†”æ–­çš„æ„ä¹‰ï¼Ÿ"><a href="#5-ç†”æ–­çš„æ„ä¹‰ï¼Ÿ" class="headerlink" title="5. ç†”æ–­çš„æ„ä¹‰ï¼Ÿ"></a>5. ç†”æ–­çš„æ„ä¹‰ï¼Ÿ</h3><ul><li>è®©ç³»ç»Ÿæ›´åŠ ç¨³å®š</li><li>å‡å°‘æ€§èƒ½æŸè€—<ul><li>å“åº”å¾ˆç®€å•ï¼Œæ‰€ä»¥äº§ç”Ÿçš„æ€§èƒ½å¾ˆå°ã€‚</li><li>ç”¨æˆ·çŸ¥é“æœåŠ¡æœ‰é—®é¢˜äº†ï¼Œå°±ä¸å†è°ƒç”¨ï¼Œé¿å…ä¸€ç›´é‡è¯•ï¼Œä¹Ÿå¯ä»¥å‡å°‘æ€§èƒ½æŸè€—ã€‚</li></ul></li><li>åŠæ—¶å“åº”ã€‚ä¸éœ€è¦å…¶ä»–è®¡ç®—ï¼Œç›´æ¥å°±å¯ä»¥è¿”å›ä¸€ä¸ªç®€å•çš„å“åº”ã€‚</li><li>é˜€å€¼å¯å®šåˆ¶ï¼Œæ¯”å¦‚è¯·æ±‚åˆ°è¾¾10000ï¼Œå°±å¼€å¯ç†”æ–­å™¨</li></ul><h3 id="6-Spring-Cloud-å¦‚ä½•å®ç°æœåŠ¡æœåŠ¡ç†”æ–­"><a href="#6-Spring-Cloud-å¦‚ä½•å®ç°æœåŠ¡æœåŠ¡ç†”æ–­" class="headerlink" title="6. Spring Cloud å¦‚ä½•å®ç°æœåŠ¡æœåŠ¡ç†”æ–­"></a>6. Spring Cloud å¦‚ä½•å®<strong>ç°æœåŠ¡æœåŠ¡ç†”æ–­</strong></h3><ul><li>Feignæ˜¯Netflixå¼€å‘çš„ä¸€æ¬¾æœåŠ¡å®¹é”™å’Œä¿æŠ¤ç»„ä»¶</li><li>å½“å‡ºç°æœåŠ¡å¼‚å¸¸æˆ–è°ƒç”¨è¶…æ—¶æ—¶ï¼ŒHystrix å®šä¹‰äº†ä¸€ä¸ªå›é€€æ–¹æ³•ï¼Œä¸å…¬å¼€æœ åŠ¡ç›¸åŒçš„è¿”å›ç±»å‹ã€‚å¦‚æœæš´éœ²æœåŠ¡ä¸­å‡ºç°å¼‚å¸¸ï¼Œåˆ™å›é€€æ–¹æ³•å°†è¿”å›ä¸€äº›å€¼ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/cities&quot;)</span><br><span class="hljs-meta">@HystrixCommand(fallbackMethod=&quot;defaultCities&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">listCity</span><span class="hljs-params">()</span></span>&#123;<br>  <span class="hljs-keyword">return</span> cityClient.listCity();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">defaultCities</span><span class="hljs-params">()</span></span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Micro weather city eureka is down!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="5-7-æ¶ˆæ¯æ€»çº¿"><a href="#5-7-æ¶ˆæ¯æ€»çº¿" class="headerlink" title="5.7 æ¶ˆæ¯æ€»çº¿"></a>5.7 æ¶ˆæ¯æ€»çº¿</h2><h3 id="1-Spring-Cloud-Bus"><a href="#1-Spring-Cloud-Bus" class="headerlink" title="1. Spring Cloud Bus"></a>1. Spring Cloud Bus</h3><ul><li>Spring Cloud Bus åˆè¢«ç§°ä¸ºæ¶ˆæ¯æ€»çº¿ï¼Œå®ƒèƒ½å¤Ÿé€šè¿‡è½»é‡çº§çš„æ¶ˆæ¯ä»£ç†ï¼ˆä¾‹å¦‚ RabbitMQã€Kafka ç­‰ï¼‰æ¥æ„å»ºä¸€ä¸ªå…¬ç”¨çš„<strong>æ¶ˆæ¯ä¸»é¢˜</strong>ï¼Œå°†å¾®æœåŠ¡æ¶æ„ä¸­çš„å„ä¸ªæœåŠ¡éƒ½è¿æ¥ä¸Šæ¥èµ·æ¥ï¼Œä»è€Œå®ç°å¹¿æ’­çŠ¶æ€æ›´æ”¹ã€äº‹ä»¶æ¨é€ç­‰åŠŸèƒ½ï¼Œè¿˜å¯ä»¥å®ç°å¾®æœåŠ¡ä¹‹é—´çš„é€šä¿¡åŠŸèƒ½ã€‚</li><li>ç›®å‰ Spring Cloud Bus æ”¯æŒä¸¤ç§æ¶ˆæ¯ä»£ç†ï¼šRabbitMQ å’Œ Kafkaã€‚</li></ul><h2 id="Spring-Cloud-Bus-çš„åŸºæœ¬åŸç†"><a href="#Spring-Cloud-Bus-çš„åŸºæœ¬åŸç†" class="headerlink" title="Spring Cloud Bus çš„åŸºæœ¬åŸç†"></a>Spring Cloud Bus çš„åŸºæœ¬åŸç†</h2><ul><li>Spring Cloud Bus ä¼šä½¿ç”¨ä¸€ä¸ªè½»é‡çº§çš„æ¶ˆæ¯ä»£ç†æ¥æ„å»ºä¸€ä¸ªå…¬å…±çš„æ¶ˆæ¯ä¸»é¢˜ Topicï¼ˆé»˜è®¤ä¸ºâ€œspringCloudBusâ€ï¼‰ï¼Œ<strong>è¿™ä¸ª Topic ä¸­çš„æ¶ˆæ¯ä¼šè¢«æ‰€æœ‰æœåŠ¡å®ä¾‹ç›‘å¬å’Œæ¶ˆè´¹</strong>ã€‚</li><li>å½“å…¶ä¸­çš„ä¸€ä¸ªæœåŠ¡åˆ·æ–°æ•°æ®æ—¶ï¼ŒSpring Cloud Bus ä¼šæŠŠä¿¡æ¯ä¿å­˜åˆ° Topic ä¸­ï¼Œè¿™æ ·ç›‘å¬è¿™ä¸ª Topic çš„æœåŠ¡å°±æ”¶åˆ°æ¶ˆæ¯å¹¶è‡ªåŠ¨æ¶ˆè´¹ã€‚</li></ul><h2 id="Spring-Cloud-Bus-åŠ¨æ€åˆ·æ–°é…ç½®çš„åŸç†"><a href="#Spring-Cloud-Bus-åŠ¨æ€åˆ·æ–°é…ç½®çš„åŸç†" class="headerlink" title="Spring Cloud Bus åŠ¨æ€åˆ·æ–°é…ç½®çš„åŸç†"></a>Spring Cloud Bus åŠ¨æ€åˆ·æ–°é…ç½®çš„åŸç†</h2><ul><li>å½“ Git ä»“åº“ä¸­çš„é…ç½®å‘ç”Ÿäº†æ”¹å˜ï¼Œæˆ‘ä»¬åªéœ€è¦å‘æŸä¸€ä¸ªæœåŠ¡Config æœåŠ¡ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯ Config å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª POST è¯·æ±‚ï¼ŒSpring Cloud Bus å°±å¯ä»¥é€šè¿‡æ¶ˆæ¯ä»£ç†é€šçŸ¥å…¶ä»–æœåŠ¡é‡æ–°æ‹‰å–æœ€æ–°é…ç½®ï¼Œä»¥å®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°ã€‚</li><li>åˆ©ç”¨ Spring Cloud Bus çš„ç‰¹æ®Šæœºåˆ¶å¯ä»¥å®ç°å¾ˆå¤šåŠŸèƒ½ï¼Œå…¶ä¸­é…åˆ Spring Cloud Config å®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°å°±æ˜¯æœ€å…¸å‹çš„åº”ç”¨åœºæ™¯ä¹‹ä¸€ã€‚</li></ul><h2 id="Spring-Cloud-Bus-æ•´åˆSpring-Cloud-Configå®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°"><a href="#Spring-Cloud-Bus-æ•´åˆSpring-Cloud-Configå®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°" class="headerlink" title="Spring Cloud Bus æ•´åˆSpring Cloud Configå®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°"></a>Spring Cloud Bus æ•´åˆSpring Cloud Configå®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°</h2><ol><li>å½“ Git ä»“åº“ä¸­çš„é…ç½®å‘ç”Ÿæ”¹å˜åï¼Œè¿ç»´äººå‘˜å‘ Config æœåŠ¡ç«¯å‘é€ä¸€ä¸ª POST è¯·æ±‚ï¼Œè¯·æ±‚è·¯å¾„ä¸ºâ€œ&#x2F;actuator&#x2F;refreshâ€ã€‚</li><li>Config æœåŠ¡ç«¯æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šå°†è¯¥è¯·æ±‚è½¬å‘ç»™æœåŠ¡æ€»çº¿ Spring Cloud Busã€‚</li><li>Spring Cloud Bus æ¥åˆ°æ¶ˆæ¯åï¼Œä¼šé€šçŸ¥ç»™æ‰€æœ‰ Config å®¢æˆ·ç«¯ã€‚</li><li>Config å®¢æˆ·ç«¯æ¥æ”¶åˆ°é€šçŸ¥ï¼Œè¯·æ±‚ Config æœåŠ¡ç«¯æ‹‰å–æœ€æ–°é…ç½®ã€‚</li><li>æ‰€æœ‰ Config å®¢æˆ·ç«¯éƒ½è·å–åˆ°æœ€æ–°çš„é…ç½®ã€‚</li></ol><h3 id="Ribbon-å’Œ-Feign-çš„åŒºåˆ«å’Œè”ç³»"><a href="#Ribbon-å’Œ-Feign-çš„åŒºåˆ«å’Œè”ç³»" class="headerlink" title="Ribbon å’Œ Feign çš„åŒºåˆ«å’Œè”ç³»"></a>Ribbon å’Œ Feign çš„åŒºåˆ«å’Œè”ç³»</h3><ul><li><p>ç›¸åŒç‚¹ï¼šäºŒè€…éƒ½æ˜¯Netflixå¼€å‘çš„ï¼Œå¯ä»¥ç”¨æ¥å®ç°æœåŠ¡é—´çš„è°ƒç”¨ä»¥åŠè´Ÿè½½å‡è¡¡ã€‚Feign æ˜¯åœ¨ Ribbonçš„åŸºç¡€ä¸Šè¿›è¡Œäº†ä¸€æ¬¡æ”¹è¿›ï¼Œæ˜¯ä¸€ä¸ªä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿çš„ HTTP å®¢æˆ·ç«¯ã€‚</p></li><li><p>è°ƒç”¨æ–¹å¼ä¸åŒ</p><ul><li><p>ribbonæ˜¯ä¸€ä¸ªåŸºäº HTTP å’Œ TCP <strong>å®¢æˆ·ç«¯</strong>çš„è´Ÿè½½å‡è¡¡çš„å·¥å…·ã€‚ç®€å•æ¥è¯´ï¼Œrubbon &#x3D; è´Ÿè½½å‡è¡¡+ restTemplateï¼Œéœ€è¦è‡ªå·±æ„å»ºè¯·æ±‚ï¼Œæ­¥éª¤ç›¸å½“ç¹çã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//é¢å‘å¾®æœåŠ¡ç¼–ç¨‹ï¼Œå³é€šè¿‡å¾®æœåŠ¡çš„åç§°æ¥è·å–è°ƒç”¨åœ°å€</span><br> <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String REST_URL_PREFIX = <span class="hljs-string">&quot;http://micro-weather-city-eureka&quot;</span>;<br>    <br> <span class="hljs-meta">@RequestMapping(&quot;/cities&quot;)</span><br> <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">listCity</span><span class="hljs-params">()</span></span>&#123;<br>   <span class="hljs-keyword">return</span> restTemplate.getForObject(REST_URL_PREFIX + <span class="hljs-string">&quot;/cities&quot;</span>, String.class);<br> &#125;<br></code></pre></td></tr></table></figure></li><li><p>é‡‡ç”¨æ¥å£çš„æ–¹å¼ï¼Œ <strong><code>åªéœ€è¦åˆ›å»ºä¸€ä¸ªæ¥å£ï¼Œç„¶ååœ¨ä¸Šé¢æ·»åŠ æ³¨è§£@FeignClientå³å¯</code></strong> ï¼Œå°†éœ€è¦è°ƒç”¨çš„å…¶ä»–æœåŠ¡çš„æ–¹æ³•å®šä¹‰æˆæŠ½è±¡æ–¹æ³•å³å¯ï¼Œ ä¸éœ€è¦è‡ªå·±æ„å»ºhttpè¯·æ±‚ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FeignClient(&quot;micro-weather-city-eureka&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CityClient</span> </span>&#123;<br>  <span class="hljs-meta">@RequestMapping(&quot;/cities&quot;)</span><br>  <span class="hljs-function">String <span class="hljs-title">listCity</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul></li><li><p>å¯åŠ¨ç±»ä¸Šä½¿ç”¨çš„æ³¨è§£ä¸åŒ</p><p>Ribbonç”¨çš„æ˜¯@RibbonClientï¼ŒFeignç”¨çš„æ˜¯@EnableFeignClientsã€‚</p></li></ul><p> ç”±äºRibbonå†™èµ·æ¥è¿˜éœ€è¦è‡ªå·±æ‹¼è¯·æ±‚ï¼Œæ‰€ä»¥é‡‡ç”¨äº†æ›´ç®€å•çš„Feign</p>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
      <tag>æ•´ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å•ä½“æ¶æ„çš„ä¼˜ç¼ºç‚¹</title>
    <link href="/%E5%8D%95%E4%BD%93%E6%9E%B6%E6%9E%84%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9/"/>
    <url>/%E5%8D%95%E4%BD%93%E6%9E%B6%E6%9E%84%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9/</url>
    
    <content type="html"><![CDATA[<h1 id="å•ä½“æ¶æ„çš„ä¼˜ç¼ºç‚¹"><a href="#å•ä½“æ¶æ„çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="å•ä½“æ¶æ„çš„ä¼˜ç¼ºç‚¹"></a>å•ä½“æ¶æ„çš„ä¼˜ç¼ºç‚¹</h1><p>ä¼˜ç‚¹ï¼š</p><ul><li><p>éƒ¨ç½²ç®€å•ï¼šåªæœ‰ä¸€ä¸ªåŒ…</p></li><li><p>æŠ€æœ¯å•ä¸€ï¼šåŒä¸€ä¸ªæ¶æ„æ¥è¯´ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªä¸€ç§æŠ€æœ¯ï¼Œç±»ä¼¼springboot + java</p></li><li><p>ç”¨äººæˆæœ¬ä½ï¼šå› ä¸ºåªéœ€è¦ä¸€ç§æŠ€æœ¯</p></li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li><p>ä»£ç ç»“æ„æ··ä¹±ï¼šä¸šåŠ¡å¤æ‚ï¼Œå¯¼è‡´ä»£ç é‡å¾ˆå¤§ï¼Œç®¡ç†ä¼šè¶Šæ¥è¶Šå›°éš¾ã€‚</p></li><li><p>å¼€å‘æ•ˆç‡ä½ï¼šå¼€å‘äººå‘˜åŒæ—¶ç»´æŠ¤åŒä¸€å¥—ä»£ç ï¼Œå¾ˆéš¾é¿å…ä»£ç å†²çªã€‚å¼€å‘è¿‡ç¨‹ä¸­ä¼šä¼´éšè§£å†³å†²çªï¼Œä¸¥é‡å½±å“å¼€å‘æ•ˆç‡ã€‚</p></li><li><p>æ’æŸ¥è§£å†³é—®é¢˜æˆæœ¬é«˜ï¼šçº¿ä¸Šå‘ç°äº†bugï¼Œå¯èƒ½bu gå¾ˆç®€å•ï¼Œä½†æ˜¯ç”±äºåªæœ‰ä¸€å¥—ä»£ç ï¼Œéœ€è¦ç¼–è¯‘æ‰“åŒ…ä¸Šçº¿ï¼Œæˆæœ¬å¾ˆé«˜ã€‚</p></li><li><p>ç›‘æ§å¾ˆéš¾ï¼šå¾ˆå¤šåŠŸèƒ½ç‚¹ï¼Œæ‚åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ã€‚</p></li></ul><h1 id="å¾®æœåŠ¡"><a href="#å¾®æœåŠ¡" class="headerlink" title="å¾®æœåŠ¡"></a>å¾®æœåŠ¡</h1><ul><li>ç”±å¾ˆå¤šæœåŠ¡ç»„æˆï¼Œæ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥ç‹¬ç«‹éƒ¨ç½²ï¼Œæ¯ä¸ªæœåŠ¡ä¹‹é—´ä»¥ä¸€ç§è½»é‡çº§çš„é€šè®¯æ–¹å¼è¿›è¡Œäº¤äº’ï¼Œä¾‹å¦‚httpã€‚è¿™äº›æœåŠ¡ä¹‹é—´æ²¡æœ‰å¾ˆå¼ºçš„æŠ€æœ¯å…³è”ï¼Œå¯ä»¥Aç”¨javaï¼ŒBç”¨Go.</li><li>è®¾è®¡åŸåˆ™ï¼š<ul><li>æ‹†åˆ†è¶³å¤Ÿçš„å¾®ã€‚é¢—ç²’å¤ªå¤§ï¼Œæ²¡æ³•å‘æŒ¥å¾®æœåŠ¡çš„ä¼˜åŠ¿ï¼Œé¢—ç²’å¤ªå°ï¼Œç®¡ç†æ··ä¹±ã€‚</li><li>è½»é‡çº§é€šä¿¡ã€‚restï¼Œæ¶ˆæ¯ä¸­é—´ä»¶</li><li>é¢†åŸŸé©±åŠ¨åŸåˆ™ã€‚æ¯”å¦‚å®¢æˆ·æ˜¯ä¸€ä¸ªé¢†åŸŸï¼Œè¡¨å•æ˜¯ä¸€ä¸ªé¢†åŸŸ</li><li>å•ä¸€æŒ‡è´£ã€‚æœåŠ¡åº”è¯¥å°½å¯èƒ½ä¸ä¾èµ–å…¶ä»–æœåŠ¡ï¼Œè¾¹ç•Œåº”è¯¥è¶³å¤Ÿæ¸…æ™°ï¼Œè€Œä¸”æ¥å£åº”è¯¥å¦¥å–„è®¾è®¡ï¼Œéšè—å†…éƒ¨ç»†èŠ‚ã€‚</li><li>DevOps</li><li>ä¸é™æŠ€æœ¯æ ˆã€‚æ¯”å¦‚mongo, pg</li></ul></li><li>å¦‚ä½•è®¾è®¡ï¼š<ul><li>æœåŠ¡æ‹†åˆ†</li><li>æœåŠ¡æ³¨å†Œã€‚å¤šä¸ªæœåŠ¡é—´çš„é€šä¿¡ï¼Œéœ€è¦ä¸€ä¸ªæœåŠ¡æ³¨å†Œæœºåˆ¶ã€‚æœåŠ¡å¯åŠ¨çš„æ—¶å€™ï¼Œè¦å°†æœåŠ¡æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼›æœåŠ¡ä¸­å¿ƒå’Œå¾®æœåŠ¡ä¹‹é—´é€šè¿‡æŸç§æœºåˆ¶å…³è”ï¼Œä¾‹å¦‚å¿ƒè·³æœºåˆ¶ï¼›ä¸åŒæœåŠ¡ä¹‹é—´å¯ä»¥è¿›è¡Œå‘ç°ï¼Œä»æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œè·å–è¦è°ƒç”¨çš„æœåŠ¡çš„ä¿¡æ¯ã€‚</li><li>æœåŠ¡æ¶ˆè´¹ï¼Œè°ƒç”¨å…¶ä»–æœåŠ¡ï¼Œè°ƒç”¨æ–¹ç›¸å½“äºæ˜¯æœåŠ¡æ¶ˆè´¹è€…ï¼Œè¢«è°ƒç”¨æ–¹æ˜¯æœåŠ¡ä¾›åº”å•†</li><li>ç»Ÿä¸€å…¥å£ï¼ŒæœåŠ¡æ•°é‡å¤šèµ·æ¥ä¹‹åï¼Œæ¯ä¸€ä¸ªæ¶ˆè´¹è€…è¦è®°ä½æ‰€æœ‰æœåŠ¡çš„åç§°æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“å…¥å£çš„åç§°ï¼Œè€Œä¸éœ€è¦çŸ¥é“å…·ä½“æœåŠ¡æä¾›è€…çš„åç§°ã€‚</li><li>é…ç½®çš„ç®¡ç†ã€‚é…ç½®æ–‡ä»¶é‡Œå†™ä¸Šä¸åŒæœåŠ¡éœ€è¦çš„é…ç½®ï¼Œä¸åŒæœåŠ¡å»åšä¸ªæ€§åŒ–é…ç½®ã€‚</li><li>ç†”æ–­æœºåˆ¶ï¼šæŸä¸ªå¾®æœåŠ¡å‡ºç°å¼‚å¸¸æ—¶ï¼ˆè¯·æ±‚ååº”æ…¢æˆ–å®•æœºï¼‰ï¼Œå…¶æ•´ä¸ªæµç¨‹è¿˜æ˜¯å¯ä»¥å‹å¥½çš„è¿›è¡Œä¸‹å»ã€‚å³å‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªç¬¦åˆé¢„æœŸçš„ã€å¯å¤„ç†çš„å¤‡é€‰å“åº”(FallBack)ï¼Œè€Œä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…æˆ–è€…æŠ›å‡ºè°ƒç”¨æ–¹æ— æ³•å¤„ç†çš„å¼‚å¸¸ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯è°ƒç”¨æ–¹çš„çº¿ç¨‹ä¸ä¼šè¢«é•¿æ—¶é—´ã€æ— å˜å¤´æ»´å ç”¨ï¼Œä»è€Œä¿æŠ¤æ•´ä¸ªç³»ç»Ÿï¼Œé¿å…å´©æºƒã€‚</li><li>è‡ªåŠ¨æ‰©å±•ï¼šæœåŠ¡å¯ä»¥æ ¹æ®å½“å‰é™„åœ¨çŠ¶å†µå¯ä»¥è‡ªåŠ¨æ‰©å±•ã€‚æ¯”å¦‚å½“å‰æœ‰10ä¸ªå®ä¾‹ï¼Œå½“è´Ÿè·çªç„¶å¢å¤§ï¼Œæ¯”å¦‚è¯·æ±‚æ•°å¢å¤§ï¼Œå¯ä»¥è‡ªåŠ¨æ‰©å±•æˆ20ä¸ªã€‚</li></ul></li><li>æ‹†åˆ†çš„æ„ä¹‰<ul><li>æ˜“äºå®ç°ï¼šæœåŠ¡æ›´å°ï¼Œä»£ç æ›´å°‘ï¼Œæ›´åŠ åˆ©äºç†è§£ï¼Œå®ç°ã€‚</li><li>æ˜“äºç»´æŠ¤ï¼šæ›´å°‘çš„ä»£ç ï¼Œæ›´å®¹æ˜“ç»´æŠ¤</li><li>æ˜“äºéƒ¨ç½²ï¼šæ¯ä¸ªæœåŠ¡éƒ½æ˜¯è½»é‡çº§å®ç°ï¼ŒjaråŒ…æ¯”è¾ƒå°</li><li>æ˜“äºæ›´æ–°ï¼šæœåŠ¡ä¹‹é—´éƒ½æ˜¯éš”ç¦»çš„ï¼Œæ‰€ä»¥æ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥ç‹¬ç«‹æ›´æ–°ï¼Œä¸ä¼šå½±å“å…¶ä»–æœåŠ¡ã€‚</li></ul></li><li>æ‹†åˆ†çš„æ–¹æ³•<ul><li>æ¨ªå‘æ‹†åˆ†ã€‚æ•°æ®é‡‡é›†ï¼Œæ•°æ®å­˜å‚¨ï¼Œæ•°æ®æŸ¥è¯¢ï¼Œæ•°æ®å±•ç¤º</li><li>çºµå‘æ‹†åˆ†ã€‚åŸºç¡€è®¾æ–½å±‚ï¼Œé¢†åŸŸå±‚ï¼Œåº”ç”¨å±‚ï¼Œç”¨æˆ·ç•Œé¢</li><li>ä½¿ç”¨DDDã€‚ä¸åŒçš„é¢†åŸŸ</li></ul></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>postgreSQLã€mysqlã€Mongoldbã€redisçš„å¯¹æ¯”</title>
    <link href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E6%AF%94/"/>
    <url>/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E6%AF%94/</url>
    
    <content type="html"><![CDATA[<h1 id="1-postgreSQL-å’Œ-mysqlçš„å¯¹æ¯”"><a href="#1-postgreSQL-å’Œ-mysqlçš„å¯¹æ¯”" class="headerlink" title="1 postgreSQL å’Œ mysqlçš„å¯¹æ¯”"></a>1 postgreSQL å’Œ mysqlçš„å¯¹æ¯”</h1><p>ç›®å‰å›½å†…Mysqlæ˜¯ä¸»æµï¼ŒPGå±ˆäºäºŒçº¿ã€‚</p><ul><li><p>mysqlå’ŒPgæ—©æœŸå°±æ˜¯ä¸¤ä¸ªæç«¯ï¼ŒmysqlåŸºæœ¬ä¸Šå°±æ˜¯æ»¡è¶³æ•°æ®åº“è¯­æ³•çš„å¤§å·KVï¼Œå¯¹å…³ç³»å‹æ•°æ®åº“çš„é«˜çº§è¯­æ³•æ”¯æŒçš„ä¸æ˜¯å¾ˆå¥½ã€‚æ—©æœŸçš„å¾ˆå¤šäº’è”ç½‘å…¬å¸åªæ˜¯ä½¿ç”¨å®ƒå­˜å‚¨ï¼Œè€Œå¤æ‚çš„ä¸€äº›è®¡ç®—éƒ½åœ¨æœåŠ¡å™¨å®Œæˆï¼Œç”±äºç¡®å®éƒ¨åˆ†é«˜çº§åŠŸèƒ½å’Œæ•°æ®ä¸€è‡´æ€§ä¿éšœï¼Œmysqlæ”¯æŒç®€å•SQLæ›´åŠ å…·å¤‡é€Ÿåº¦ä¼˜åŠ¿ã€‚</p></li><li><p>mysqlå¤šçº¿ç¨‹æ¨¡å‹ï¼Œå¹¶å‘æ”¯æŒè‰¯å¥½ï¼ŒPGæ˜¯å¤šè¿›ç¨‹æ¨¡å‹ï¼Œåˆ›å»ºè¿›ç¨‹æ›´æ…¢</p></li><li><p>PostgreSQLæ”¯æŒçš„æ•°æ®ç±»å‹æ¯”MySQLæ›´ä¸ºä¸°å¯Œã€‚å¦‚array, xmlï¼ŒJSONB(äºŒè¿›åˆ¶æ ¼å¼çš„JSON, è¯»å–æ›´å¿«)ï¼Œ timestamptz(å¸¦æ—¶åŒºçš„æ—¶é—´æˆ³) ,numrange(æ•°å€¼çš„èŒƒå›´)ç­‰</p></li><li><p>äº‹åŠ¡çš„æ”¯æŒï¼šPostgreSQLæ”¯æŒäº‹åŠ¡çš„å¼ºä¸€è‡´æ€§ï¼Œäº‹åŠ¡ä¿è¯æ€§å¥½ï¼Œå®Œå…¨æ”¯æŒACIDç‰¹æ€§ã€‚MySQLåªæœ‰innodbå¼•æ“æ”¯æŒäº‹åŠ¡ï¼Œmysiamä¸æ”¯æŒäº‹åŠ¡ã€‚</p></li><li><p>PG SQLæ”¯æŒçš„ç´¢å¼•ç±»å‹å¾ˆå¤šï¼Œå¦‚ï¼šGiSTï¼ˆGeneralized Search Treeï¼Œé€šç”¨æœç´¢æ ‘ï¼‰ã€GINï¼ˆGeneralized Inverted Indexï¼Œé€šç”¨å€’æ’ç´¢å¼•ï¼‰å’ŒBRINï¼ˆBlock Range INdexï¼Œå—èŒƒå›´ç´¢å¼•ï¼‰ç­‰ï¼Œå¯ä»¥æ ¹æ®ä¸åŒçš„æŸ¥è¯¢éœ€æ±‚å’Œæ•°æ®ç±»å‹é€‰æ‹©åˆé€‚çš„ç´¢å¼•ã€‚è¿™ç§çµæ´»æ€§ä½¿å¾—PGåœ¨å¤„ç†å¤æ‚æŸ¥è¯¢å’Œå¤§æ•°æ®é‡æ—¶æ›´å…·ä¼˜åŠ¿ã€‚&#96;&#96;</p></li></ul><p>æ€»ä¹‹ï¼ŒMySQL ç®€å•æ˜“ç”¨ã€æ€§èƒ½ä¼˜è¶Šï¼Œé€‚ç”¨äºå¤„ç†å¤§é‡è¯»æ“ä½œå’Œå°å‹é¡¹ç›®ï¼›è€Œ PostgreSQL å¼ºå¤§çµæ´»ã€å…·å¤‡ä¸°å¯Œçš„æ•°æ®ç±»å‹å’Œé«˜çº§ç‰¹æ€§ï¼Œé€‚ç”¨äºå¤„ç†å¤æ‚æ•°æ®å’Œå¤§å‹é¡¹ç›®ã€‚</p><blockquote><p><strong>JSON å’ŒJSONB</strong>å¯¹æ¯”</p><ul><li><strong>JSON</strong>ï¼šä»¥æ–‡æœ¬æ ¼å¼å­˜å‚¨JSONæ•°æ®ï¼Œä¿ç•™äº†JSONæ•°æ®çš„åŸå§‹æ ¼å¼ï¼ŒåŒ…æ‹¬é”®ä¹‹é—´çš„ç©ºæ ¼ã€é”®çš„é¡ºåºä»¥åŠé‡å¤çš„é”®ã€‚å½“ä»æ•°æ®åº“ä¸­æ£€ç´¢JSONæ•°æ®æ—¶ï¼Œéœ€è¦å†æ¬¡è§£æè¿™äº›æ•°æ®ã€‚</li><li><strong>JSONB</strong>ï¼šä»¥äºŒè¿›åˆ¶æ ¼å¼å­˜å‚¨JSONæ•°æ®ï¼Œè¿™ç§æ ¼å¼åœ¨å­˜å‚¨å‰ä¼šå…ˆå¯¹æ•°æ®è¿›è¡Œè§£æå’Œè§„èŒƒåŒ–ã€‚å› æ­¤ï¼ŒJSONBåœ¨è¯»å–æ—¶ä¸éœ€è¦é‡æ–°è§£æï¼Œä»è€Œæé«˜äº†æ€§èƒ½ã€‚</li></ul><p>å¦‚æœä½ çš„åº”ç”¨åªéœ€è¦å°†JSONæ•°æ®ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œå¹¶ä¸”å¾ˆå°‘è¿›è¡Œè¯»å–å’ŒæŸ¥è¯¢æ“ä½œï¼Œé‚£ä¹ˆJSONå¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚</p><p>å¦‚æœä½ çš„åº”ç”¨éœ€è¦åœ¨æ•°æ®åº“ä¸­é¢‘ç¹åœ°è¯»å–å’ŒæŸ¥è¯¢JSONæ•°æ®ï¼Œæˆ–è€…éœ€è¦åœ¨JSONåˆ—ä¸Šä½¿ç”¨ç´¢å¼•æ¥æé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œé‚£ä¹ˆJSONBå°†æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p></blockquote><h1 id="2-Mysql-å’ŒMongoldbå¯¹æ¯”"><a href="#2-Mysql-å’ŒMongoldbå¯¹æ¯”" class="headerlink" title="2 Mysql å’ŒMongoldbå¯¹æ¯”"></a>2 Mysql å’ŒMongoldbå¯¹æ¯”</h1><ul><li>postgresqlæ˜¯å…³ç³»å‹æ•°æ®åº“ï¼ŒMongoldb æ˜¯éå…³ç³»å‹æ•°æ®åº“ï¼Œ</li><li>æŸ¥è¯¢è¯­æ³•ä¸åŒã€‚postgresqlä½¿ç”¨åŸºæœ¬çš„sqlæ“ä½œï¼Œmongodbä½¿ç”¨pipelineï¼Œæ¯”å¦‚pg join ï¼Œmongo $lookup</li><li>mongodbçš„ä¼˜åŠ¿å°±æ˜¯æ–‡æ¡£å­˜å‚¨ï¼Œä¸šåŠ¡ç»å¸¸å˜åŠ¨ï¼Œéœ€è¦ä¸æ—¶çš„æ·»åŠ å­—æ®µï¼Œé‚£ä¹ˆmongodbæ¯”è¾ƒé€‚åˆ</li><li>å¯¹äºé‚£äº›éœ€è¦å¯¹å¤šä¸ªæ–‡æ¡£ï¼ˆåœ¨å•ä¸ªæˆ–å¤šä¸ªé›†åˆä¸­ï¼‰è¿›è¡ŒåŸå­æ€§è¯»å†™çš„åœºæ™¯ï¼ŒMongoDBæ”¯æŒäº†<strong>å¤šæ–‡æ¡£äº‹åŠ¡</strong>ã€‚</li><li>mysqlé›†ç¾¤ä¸»è¦æ¨¡å¼æ˜¯ï¼šä¸»ä»+å“¨å…µ+clusterï¼ŒmongoDbçš„æ˜¯ä¸»ä»+å¤åˆ¶é›†+åˆ†ç‰‡é›†ç¾¤</li></ul><h1 id="3-Redis"><a href="#3-Redis" class="headerlink" title="3 Redis"></a>3 Redis</h1><ul><li>éå¸¸ä¸°å¯Œçš„æ•°æ®ç»“æ„</li><li>Redisæä¾›äº†äº‹åŠ¡çš„åŠŸèƒ½ï¼Œå¯ä»¥ä¿è¯ä¸€ä¸² å‘½ä»¤çš„åŸå­æ€§ï¼Œä¸­é—´ä¸ä¼šè¢«ä»»ä½•æ“ä½œæ‰“æ–­ï¼›</li><li>æ•°æ®å­˜åœ¨å†…å­˜ä¸­ï¼Œè¯»å†™éå¸¸çš„é«˜é€Ÿï¼Œå¯ä»¥è¾¾åˆ°10w&#x2F;sçš„é¢‘ç‡</li></ul><h1 id="4-eså’Œmongo"><a href="#4-eså’Œmongo" class="headerlink" title="4 eså’Œmongo"></a>4 eså’Œmongo</h1><p>ç›¸åŒç‚¹ï¼š</p><ul><li><code>MongoDB</code>å’Œ<code>Elasticsearch</code>éƒ½å±äºNoSQLå¤§å®¶æ—, ä¸”éƒ½å±äºæ–‡æ¡£å‹æ•°æ®å­˜å‚¨</li><li>ä¸¤è€…éƒ½é€šè¿‡åˆ†ç‰‡æ”¯æŒæ°´å¹³æ‰©å±•ï¼Œåˆ†ç‰‡å°†æ•°æ®è¿›è¡Œæ°´å¹³åˆ‡åˆ†ä¹‹åï¼Œå°†å…¶å­˜å‚¨åˆ°å¤šä¸ªä¸åŒçš„æœåŠ¡å™¨èŠ‚ç‚¹ä¸Šçš„ä¸€ ç§æ‰©å±•æ–¹å¼ã€‚</li></ul><blockquote><p> æ°´å¹³åˆ†ç‰‡: é€šè¿‡æŸä¸ªå­—æ®µ(æˆ–æŸå‡ ä¸ªå­—æ®µ)ï¼Œæ ¹æ®æŸç§è§„åˆ™å°†æ•°æ®åˆ†æ•£è‡³å¤šä¸ªåº“æˆ–è¡¨ä¸­ï¼Œæ¯ä¸ªåˆ†ç‰‡ä»…åŒ…å«æ•°æ®çš„ä¸€éƒ¨åˆ†ã€‚å–æ¨¡ï¼ŒèŒƒå›´</p><p> å‚ç›´åˆ†ç‰‡: æŒ‰ç…§ä¸šåŠ¡å°†è¡¨è¿›è¡Œå½’ç±»ï¼Œåˆ†å¸ƒåˆ°ä¸åŒçš„æ•°æ®åº“æˆ–è¡¨</p></blockquote><p>ä¸åŒç‚¹ï¼š</p><ul><li>å®šä½ä¸åŒ<ul><li>MongoDB æ˜¯ <strong>æ–‡æ¡£å‹æ•°æ®åº“</strong>, æä¾› <strong>æ•°æ®å­˜å‚¨å’Œç®¡ç†æœåŠ¡</strong></li><li><a href="https://so.csdn.net/so/search?q=Elasticsearch&spm=1001.2101.3001.7020">Elasticsearch</a> æ˜¯<strong>æœç´¢æœåŠ¡</strong>, æä¾› <strong>æ•°æ®æ£€ç´¢æœåŠ¡</strong></li></ul></li><li>ä½¿ç”¨åœºæ™¯ï¼š<ul><li>å¦‚æœä½ æœ‰ä¸€æ‰¹æ•°æ®è¦çœ‹, ä½†æ˜¯ä¸ç»å¸¸è¿›è¡Œä¿®æ”¹, è¿™ä¸ªæ—¶å€™æ¯«æ— ç–‘é—®å¯ä»¥ç”¨es</li><li>å¦‚æœä½ è¿˜æ‰“ç®—ç»§ç»­ä¿®æ”¹æ•°æ®, æœ€å¥½å°±æ˜¯ä½¿ç”¨MongoDB</li></ul></li></ul><h1 id="5-influxDbæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#5-influxDbæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="5. influxDbæ˜¯ä»€ä¹ˆï¼Ÿ"></a>5. influxDbæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>InfluxDB æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ã€å¼€æºçš„æ—¶é—´åºåˆ—æ•°æ®åº“ï¼Œä¸“é—¨è®¾è®¡ç”¨äºå­˜å‚¨å’Œç®¡ç†æ—¶é—´åºåˆ—æ•°æ®ï¼Œå¦‚ç›‘æ§æ•°æ®ã€ç‰©è”ç½‘æ•°æ®å’Œå®æ—¶åˆ†ææ•°æ®ã€‚</p><p>æˆ‘ä»¬å›¢é˜Ÿä½¿ç”¨çš„åœºæ™¯æ˜¯ï¼šopcæ•°æ®é‡‡é›†ï¼Œéœ€è¦å®šæ—¶å»é‡‡é›†è®¾å¤‡çš„ä¸»è½´æ•°æ®ã€‚å¦‚ï¼šä¸»è½´è½¬é€Ÿã€ä¸»è½´è´Ÿè½½ã€ä¸»è½´å€ç‡ç­‰</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¢è¯•é¢˜</tag>
      
      <tag>redis</tag>
      
      <tag>mysql</tag>
      
      <tag>postgreSQL</tag>
      
      <tag>mongo</tag>
      
      <tag>es</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>kafkaçŸ¥è¯†ç‚¹æ•´ç†</title>
    <link href="/kafka%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/kafka%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h3 id="kafkaå’ŒRabbitMqçš„å¯¹æ¯”"><a href="#kafkaå’ŒRabbitMqçš„å¯¹æ¯”" class="headerlink" title="kafkaå’ŒRabbitMqçš„å¯¹æ¯”"></a>kafkaå’ŒRabbitMqçš„å¯¹æ¯”</h3><ol><li><p>å­˜å‚¨ä¸Šï¼š</p><ul><li>kafkaæ”¯æŒäº†åˆ†å¸ƒå¼å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯åˆ†åŒºã€‚ç›¸å½“äºæŠŠåŸæ¥rabbitMq çš„queueæ‹†åˆ†æˆäº†å¾ˆå¤šä¸ªå°é˜Ÿåˆ—ï¼Œåˆ†å¸ƒå¼å­˜å‚¨åœ¨ä¸åŒçš„æœåŠ¡ä¸Šï¼Œæé«˜äº†æ¶ˆæ¯çš„å‘é€çš„æ•ˆç‡ï¼ˆä¸€æ¬¡å¯ä»¥å‘åˆ°å¤šä¸ªåˆ†åŒºï¼‰ï¼Œæé«˜äº†æ¶ˆè´¹æ•ˆç‡ï¼Œä¸åŒåˆ†åŒºï¼Œä½¿ç”¨ä¸åŒçš„æ¶ˆè´¹è€…ï¼Œæé«˜äº†å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</li></ul></li><li><p>åº”ç”¨åœºæ™¯ä¸Šï¼š</p><ul><li>RabbitMQ,éµå¾ªAMQPåè®®ï¼Œç”¨åœ¨å®æ—¶çš„å¯¹å¯é æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„æ¶ˆæ¯ä¼ é€’ä¸Šã€‚</li><li>kafkaå®ƒä¸»è¦ç”¨äºå¤„ç†æ´»è·ƒçš„æµå¼æ•°æ®,å¤§æ•°æ®é‡çš„æ•°æ®å¤„ç†ä¸Šã€‚</li></ul></li><li><p>ååé‡ä¸Šï¼š</p><ul><li>rabbitMQåœ¨ååé‡æ–¹é¢ç¨é€Šäºkafkaï¼Œä»–ä»¬çš„å‡ºå‘ç‚¹ä¸ä¸€æ ·ï¼ŒrabbitMQæ”¯æŒå¯¹æ¶ˆæ¯çš„å¯é çš„ä¼ é€’ï¼Œæ”¯æŒäº‹åŠ¡ï¼Œä¸æ”¯æŒæ‰¹é‡çš„æ“ä½œ</li><li>kafkaå…·æœ‰é«˜çš„ååé‡ï¼Œå†…éƒ¨é‡‡ç”¨æ¶ˆæ¯çš„æ‰¹é‡å¤„ç†ï¼Œzero-copyæœºåˆ¶ï¼Œæ•°æ®çš„å­˜å‚¨å’Œè·å–æ˜¯æœ¬åœ°ç£ç›˜é¡ºåºæ‰¹é‡æ“ä½œï¼Œå…·æœ‰O(1)çš„å¤æ‚åº¦ï¼Œæ¶ˆæ¯å¤„ç†çš„æ•ˆç‡å¾ˆé«˜ã€‚</li></ul></li><li><p>åœ¨å¯ç”¨æ€§æ–¹é¢:</p><ul><li>rabbitMQæ”¯æŒmirorçš„queueï¼Œä¸»queueå¤±æ•ˆï¼Œmiror queueæ¥ç®¡ã€‚</li><li>kafkaçš„brokeræ”¯æŒä¸»å¤‡æ¨¡å¼ã€‚</li></ul></li><li><p>åœ¨é›†ç¾¤è´Ÿè½½å‡è¡¡æ–¹é¢:</p><ul><li>rabbitMQçš„è´Ÿè½½å‡è¡¡éœ€è¦å•ç‹¬çš„loadbalancerè¿›è¡Œæ”¯æŒã€‚</li><li>kafkaé‡‡ç”¨zookeeperå¯¹é›†ç¾¤ä¸­çš„brokerã€consumerè¿›è¡Œç®¡ç†ï¼Œå¯ä»¥æ³¨å†Œtopicåˆ°zookeeperä¸Šï¼›é€šè¿‡zookeeperçš„åè°ƒæœºåˆ¶ï¼Œproducerä¿å­˜å¯¹åº”topicçš„brokerä¿¡æ¯ï¼Œå¯ä»¥éšæœºæˆ–è€…è½®è¯¢å‘é€åˆ°brokerä¸Šï¼›å¹¶ä¸”producerå¯ä»¥åŸºäºè¯­ä¹‰æŒ‡å®šåˆ†ç‰‡ï¼Œæ¶ˆæ¯å‘é€åˆ°brokerçš„æŸåˆ†ç‰‡ä¸Šã€‚</li></ul></li><li><p>æ¶ˆæ¯çš„åˆ é™¤æ—¶é—´ä¸Šï¼š</p><ol><li>rabbitMQ æ¶ˆè´¹å®Œäº†å°±åˆ é™¤ã€‚</li><li>kafkaä¸€èˆ¬ä¸ä¼šåˆ é™¤æ¶ˆæ¯ï¼Œä¸ç®¡è¿™äº›æ¶ˆæ¯æœ‰æ²¡æœ‰è¢«æ¶ˆè´¹ã€‚åªä¼šæ ¹æ®é…ç½®çš„æ—¥å¿—ä¿ç•™æ—¶é—´(log.retention.hours)ç¡®è®¤æ¶ˆæ¯å¤šä¹…è¢«åˆ é™¤ï¼Œé»˜è®¤ä¿ç•™æœ€è¿‘ä¸€å‘¨çš„æ—¥å¿—æ¶ˆæ¯ã€‚è¿™äº›æ—¥å¿—å¯ä»¥è¢«é‡å¤è¯»å–å’Œæ— é™æœŸä¿ç•™ã€‚</li></ol></li></ol><h3 id="ä¸ºä»€ä¹ˆè¦å¯¹Topicä¸‹æ•°æ®è¿›è¡Œåˆ†åŒºå­˜å‚¨ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦å¯¹Topicä¸‹æ•°æ®è¿›è¡Œåˆ†åŒºå­˜å‚¨ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å¯¹Topicä¸‹æ•°æ®è¿›è¡Œåˆ†åŒºå­˜å‚¨ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦å¯¹Topicä¸‹æ•°æ®è¿›è¡Œåˆ†åŒºå­˜å‚¨ï¼Ÿ</h3><ol><li>commit logæ–‡ä»¶ä¼šå—åˆ°æ‰€åœ¨æœºå™¨çš„æ–‡ä»¶ç³»ç»Ÿå¤§å°çš„é™åˆ¶ï¼Œåˆ†åŒºä¹‹åå¯ä»¥å°†ä¸åŒçš„åˆ†åŒºæ”¾åœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œç›¸å½“äºå¯¹</li></ol><p>æ•°æ®åšäº†<strong>åˆ†å¸ƒå¼å­˜å‚¨</strong>ï¼Œç†è®ºä¸Šä¸€ä¸ªtopicå¯ä»¥å¤„ç†ä»»æ„æ•°é‡çš„æ•°æ®ã€‚ </p><p>  2ã€ä¸ºäº†<strong>æé«˜å¹¶è¡Œåº¦</strong>ï¼Œconsumerå¯ä»¥å¹¶è¡Œå»å¤„ç†ä¸åŒåˆ†åŒºæ‹¿åˆ°çš„æ•°æ®ã€‚</p><h3 id="æ€ä¹ˆç†è§£Topicï¼ŒPartitionå’ŒBroker-ï¼Ÿ"><a href="#æ€ä¹ˆç†è§£Topicï¼ŒPartitionå’ŒBroker-ï¼Ÿ" class="headerlink" title="æ€ä¹ˆç†è§£Topicï¼ŒPartitionå’ŒBroker ï¼Ÿ"></a>æ€ä¹ˆç†è§£<strong>Topicï¼ŒPartitionå’ŒBroker</strong> ï¼Ÿ</h3><ol><li><p>ä¸€ä¸ªtopicï¼Œä»£è¡¨é€»è¾‘ä¸Šçš„ä¸€ä¸ªä¸šåŠ¡æ•°æ®é›†ï¼Œæ¯”å¦‚æŒ‰æ•°æ®åº“é‡Œä¸åŒè¡¨çš„æ•°æ®æ“ä½œæ¶ˆæ¯åŒºåˆ†æ”¾å…¥ä¸åŒtopicã€‚</p></li><li><p>è®¢å•ç›¸å…³æ“ä½œæ¶ˆæ¯æ”¾å…¥è®¢å•topicï¼Œç”¨æˆ·ç›¸å…³æ“ä½œæ¶ˆæ¯æ”¾å…¥ç”¨æˆ·topicï¼Œå¯¹äºå¤§å‹ç½‘ç«™æ¥è¯´ï¼Œåç«¯æ•°æ®éƒ½æ˜¯æµ·é‡çš„ï¼Œè®¢å•æ¶ˆæ¯å¾ˆå¯èƒ½æ˜¯éå¸¸å·¨é‡çš„ï¼Œæ¯”å¦‚æœ‰å‡ ç™¾ä¸ªGç”šè‡³è¾¾åˆ°TBçº§åˆ«ï¼Œå¦‚æœæŠŠè¿™ä¹ˆå¤šæ•°æ®éƒ½æ”¾åœ¨ä¸€å°æœºå™¨ä¸Šå¯å®šä¼šæœ‰å®¹é‡é™åˆ¶é—®é¢˜ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨ topicå†…éƒ¨åˆ’åˆ†å¤šä¸ªpartitionæ¥åˆ†ç‰‡å­˜å‚¨æ•°æ®ã€‚</p></li><li><p>ä¸åŒçš„partitionå¯ä»¥ä½äºä¸åŒçš„æœºå™¨ä¸Šï¼Œæ¯å°æœºå™¨ä¸Šéƒ½è¿è¡Œä¸€ä¸ªKafkaçš„è¿›ç¨‹Brokerã€‚</p></li></ol><h3 id="kafkaçš„æ¶ˆè´¹è€…æ˜¯-pull-æ‹‰-è¿˜æ˜¯push-æ¨-æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ"><a href="#kafkaçš„æ¶ˆè´¹è€…æ˜¯-pull-æ‹‰-è¿˜æ˜¯push-æ¨-æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ" class="headerlink" title="kafkaçš„æ¶ˆè´¹è€…æ˜¯**pull(æ‹‰)è¿˜æ˜¯push(æ¨)**æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ"></a><strong>kafka</strong>çš„æ¶ˆè´¹è€…æ˜¯**pull(<strong>æ‹‰</strong>)<strong>è¿˜æ˜¯</strong>push(<strong>æ¨</strong>)**æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</h3><p>Kafka éµå¾ªäº†ä¸€ç§å¤§éƒ¨åˆ†æ¶ˆæ¯ç³»ç»Ÿå…±åŒçš„ä¼ ç»Ÿçš„è®¾è®¡ï¼šproducer å°†æ¶ˆæ¯æ¨é€åˆ° brokerï¼Œconsumer ä»broker æ‹‰å–æ¶ˆæ¯ã€‚</p><p>ä¼˜ç‚¹ï¼špullæ¨¡å¼æ¶ˆè´¹è€…è‡ªä¸»å†³å®šæ˜¯å¦æ‰¹é‡ä»brokeræ‹‰å–æ•°æ®ï¼Œè€Œpushæ¨¡å¼åœ¨æ— æ³•çŸ¥é“æ¶ˆè´¹è€…æ¶ˆè´¹èƒ½åŠ›æƒ…å†µä¸‹ï¼Œä¸æ˜“æ§åˆ¶æ¨é€é€Ÿåº¦ï¼Œå¤ªå¿«å¯èƒ½é€ æˆæ¶ˆè´¹è€…å¥”æºƒï¼Œå¤ªæ…¢åˆå¯èƒ½é€ æˆæµªè´¹ã€‚</p><p>ç¼ºç‚¹ï¼šå¦‚æœ broker æ²¡æœ‰å¯ä¾›æ¶ˆè´¹çš„æ¶ˆæ¯ï¼Œå°†å¯¼è‡´ consumer ä¸æ–­åœ¨å¾ªç¯ä¸­è½®è¯¢ï¼Œç›´åˆ°æ–°æ¶ˆæ¯åˆ°åˆ°è¾¾ã€‚ä¸ºäº†é¿å…è¿™ç‚¹ï¼ŒKafka æœ‰ä¸ªå‚æ•°å¯ä»¥è®© consumeré˜»å¡ç›´åˆ°æ–°æ¶ˆæ¯åˆ°è¾¾ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é˜»å¡ç›´åˆ°æ¶ˆæ¯çš„æ•°é‡è¾¾åˆ°æŸä¸ªç‰¹å®šçš„é‡è¿™æ ·å°±å¯ä»¥æ‰¹é‡å‘é€ã€‚</p><h2 id="é›†ç¾¤æ¶ˆè´¹"><a href="#é›†ç¾¤æ¶ˆè´¹" class="headerlink" title="é›†ç¾¤æ¶ˆè´¹"></a>é›†ç¾¤æ¶ˆè´¹</h2><ul><li>leaderå¤„ç†æ‰€æœ‰çš„é’ˆå¯¹è¿™ä¸ªpartitionçš„è¯»å†™è¯·æ±‚ã€‚</li><li>è€Œfollowersè¢«åŠ¨å¤åˆ¶leaderçš„ç»“æœï¼Œä¸æä¾›è¯»å†™(ä¸»è¦æ˜¯ä¸ºäº†ä¿è¯å¤šå‰¯æœ¬æ•°æ®ä¸æ¶ˆè´¹çš„ä¸€è‡´æ€§ï¼‰ã€‚å¦‚æœè¿™ä¸ªleaderå¤±æ•ˆäº†ï¼Œå…¶ä¸­çš„ä¸€ä¸ªfollowerå°†ä¼šè‡ªåŠ¨çš„å˜æˆæ–°çš„leaderã€‚</li></ul><h2 id="æ¶ˆè´¹é¡ºåºæ€ä¹ˆä¿è¯ï¼Ÿ"><a href="#æ¶ˆè´¹é¡ºåºæ€ä¹ˆä¿è¯ï¼Ÿ" class="headerlink" title="æ¶ˆè´¹é¡ºåºæ€ä¹ˆä¿è¯ï¼Ÿ"></a>æ¶ˆè´¹é¡ºåºæ€ä¹ˆä¿è¯ï¼Ÿ</h2><h4 id="æ–¹æ¡ˆä¸€ï¼š"><a href="#æ–¹æ¡ˆä¸€ï¼š" class="headerlink" title="æ–¹æ¡ˆä¸€ï¼š"></a>æ–¹æ¡ˆä¸€ï¼š</h4><ul><li><p><strong>å‘é€ç«¯ï¼š</strong>å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œå¾€ä¸€ä¸ªpartition ä¸­å»å‘ã€‚</p><p>å¦‚æœå‘é€ç«¯é…ç½®äº†é‡è¯•æœºåˆ¶ï¼Œå°±å¯èƒ½å‡ºç°å‘é€æ–¹å‘é€æ—¶æ˜¯1ï¼Œ2ï¼Œ3ï¼Œä½†1å‘é€å¤±è´¥ï¼Œé‡è¯•å‘é€1ï¼Œè¿™æ ·æ”¶åˆ°çš„æ¶ˆæ¯å°±æ˜¯2ï¼Œ3ï¼Œ1ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦åŒæ­¥çš„å»å‘æ¶ˆæ¯ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªæ¶ˆæ¯å‘é€æˆåŠŸäº†ï¼Œå†å»å‘é€2ï¼Œ3ã€‚</p></li><li><p><strong>æ¶ˆè´¹ç«¯ï¼š</strong>å–æ¶ˆæ¯çš„æ—¶å€™ä¹Ÿä»ä¸€ä¸ªpartition ä¸­å»å–ã€‚ä¸€ä¸ªpartitionåŒä¸€ä¸ªæ—¶åˆ»ï¼Œåœ¨ä¸€ä¸ªconsumer groupé‡Œåªèƒ½æœ‰ä¸€ä¸ªconsumerå»æ¶ˆè´¹ï¼Œä»è€Œä¿è¯æ¶ˆè´¹é¡ºåºã€‚</p></li></ul><h4 id="æ–¹æ¡ˆäºŒï¼š"><a href="#æ–¹æ¡ˆäºŒï¼š" class="headerlink" title="æ–¹æ¡ˆäºŒï¼š"></a>æ–¹æ¡ˆäºŒï¼š</h4><ul><li><strong>å‘é€ç«¯ï¼š</strong>å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œå¾€å¤šä¸ªpartition ä¸­å»å‘ã€‚</li><li><strong>æ¶ˆè´¹ç«¯ï¼š</strong>åªè®¾ç½®ä¸€ä¸ªconsumerï¼Œæ¶ˆæ¯æ¥äº†ä¸ç«‹å³å¤„ç†ï¼Œè€Œæ˜¯è‡ªå·±é€»è¾‘æ’åºåå¤„ç†ã€‚æä¸€ä¸ªç±»ä¼¼CountDownLatchï¼Œæ¯”å¦‚æ€»å…±æœ‰3æ¡æ¶ˆæ¯ï¼Œå°±åªæœ‰å½“3æ¡æ¶ˆæ¯éƒ½æ¥å—åˆ°äº†åï¼Œæ‰è¿›è¡Œå¤„ç†ï¼Œconsumerç«¯è‡ªå·±å¯ä»¥åœ¨ä¸šåŠ¡é€»è¾‘ä¸­æ’åºï¼Œæ¯”å¦‚ç»™æ¶ˆæ¯é‡ŒåŠ ä¸Šä¸€ä¸ªtypeç±»å‹ï¼Œæ£€æµ‹æ˜¯ä¸‹å•çš„æ¶ˆæ¯ï¼Œå°±ä¼˜å…ˆå¤„ç†ï¼Œç„¶åå†å¤„ç†å‡åº“å­˜ï¼Œé€šçŸ¥å¿«é€’ã€‚å¦‚æœè€ƒè™‘åˆ°æ€§èƒ½è¿˜ä¸å¤Ÿé«˜ï¼Œå¯ä»¥åœ¨consumerç«¯ï¼Œè€ƒè™‘å¢åŠ <strong>å¤šçº¿ç¨‹</strong>å»å¤„ç†ã€‚</li></ul><p>æ³¨æ„ï¼š</p><ul><li>consumer groupä¸­ä¿è¯ï¼Œconsumer çš„æ•°é‡ &lt; partitionçš„æ•°é‡ï¼Œå¦åˆ™å¤šå‡ºçš„consumerå¾—ä¸åˆ°ä¿¡æ¯ã€‚</li><li>å¦‚æœæœ‰åœ¨æ€»ä½“ä¸Šä¿è¯æ¶ˆè´¹é¡ºåºçš„éœ€æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†topicçš„partitionæ•°é‡è®¾ç½®ä¸º1ï¼Œå°†consumer groupä¸­çš„consumer æ•°é‡ä¹Ÿè®¾ç½®ä¸º1ï¼Œä½†æ˜¯è¿™æ ·ä¼šå½±å“æ€§èƒ½ï¼Œæ‰€ä»¥kafkaçš„é¡ºåºæ¶ˆè´¹å¾ˆå°‘ç”¨ã€‚</li></ul><h2 id="æ¶ˆæ¯ç§¯å‹å’Œè§£å†³"><a href="#æ¶ˆæ¯ç§¯å‹å’Œè§£å†³" class="headerlink" title="æ¶ˆæ¯ç§¯å‹å’Œè§£å†³"></a>æ¶ˆæ¯ç§¯å‹å’Œè§£å†³</h2><h3 id="1-ç”Ÿäº§è€…å‘é€æµé‡å¤ªå¤§"><a href="#1-ç”Ÿäº§è€…å‘é€æµé‡å¤ªå¤§" class="headerlink" title="1.ç”Ÿäº§è€…å‘é€æµé‡å¤ªå¤§"></a>1.ç”Ÿäº§è€…å‘é€æµé‡å¤ªå¤§</h3><ul><li>é™ä½æ¶ˆæ¯ç”Ÿäº§çš„é€Ÿåº¦ã€‚ç”Ÿäº§è€…ç«¯äº§ç”Ÿæ¶ˆæ¯çš„é€Ÿåº¦é€šå¸¸æ˜¯è·Ÿä¸šåŠ¡æ¯æ¯ç›¸å…³çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸å¤ªå¥½ç›´æ¥ä¼˜åŒ–ã€‚ä½†æ˜¯å¯ä»¥é‡‡ç”¨æ‰¹é‡å‘é€æ¶ˆæ¯çš„æ–¹å¼ï¼Œé™ä½IOé¢‘ç‡ã€‚</li></ul><h3 id="2-æ¶ˆè´¹è€…èƒ½åŠ›ä¸è¶³"><a href="#2-æ¶ˆè´¹è€…èƒ½åŠ›ä¸è¶³" class="headerlink" title="2. æ¶ˆè´¹è€…èƒ½åŠ›ä¸è¶³"></a>2. æ¶ˆè´¹è€…èƒ½åŠ›ä¸è¶³</h3><ul><li>ä¿®æ”¹æ¶ˆè´¹ç«¯ç¨‹åºï¼Œå†™ä¸€ä¸ªä¸´æ—¶çš„åˆ†å‘æ•°æ®çš„ consumer ç¨‹åºï¼Œå°†æ”¶åˆ°çš„æ¶ˆæ¯å¿«é€Ÿè½¬å‘ç»™æŒ‡å®šçš„æ–°åˆ›å»ºçš„topicï¼Œç»™è¿™ä¸ªtopicè®¾ç½®åŸæ¥10å€çš„åˆ†åŒºã€‚ä¸´æ—¶å¾ç”¨ 10 å€çš„æœºå™¨æ¥éƒ¨ç½² consumerï¼Œæ¯ä¸€ä¸ª consumer æ¶ˆè´¹ä¸€ä¸ªæ–°ä¸»é¢˜çš„åˆ†åŒºã€‚</li><li>å°†æ¶ˆæ¯å¿«é€Ÿè½¬å½•ã€‚ä¿å­˜åˆ°æ•°æ®åº“æˆ–è€…Redisï¼Œç„¶åå†æ…¢æ…¢è¿›è¡Œå¤„ç†ã€‚</li><li>kafkaæ¶ˆè´¹èƒ½åŠ›ä¸è¶³ï¼Œåˆ™å¯ä»¥è€ƒè™‘å¢åŠ Topicçš„Partitionçš„ä¸ªæ•°ï¼ŒåŒæ—¶æå‡æ¶ˆè´¹è€…ç»„çš„æ¶ˆè´¹è€…æ•°é‡ã€‚</li></ul><h3 id="3-æ•°æ®æ ¼å¼å˜åŠ¨æˆ–è€…æ¶ˆè´¹è€…æœ‰bug"><a href="#3-æ•°æ®æ ¼å¼å˜åŠ¨æˆ–è€…æ¶ˆè´¹è€…æœ‰bug" class="headerlink" title="3. æ•°æ®æ ¼å¼å˜åŠ¨æˆ–è€…æ¶ˆè´¹è€…æœ‰bug"></a>3. æ•°æ®æ ¼å¼å˜åŠ¨æˆ–è€…æ¶ˆè´¹è€…æœ‰bug</h3><ul><li>å°†æ¶ˆè´¹ä¸æˆåŠŸçš„æ¶ˆæ¯è½¬å‘åˆ°å…¶ä»–é˜Ÿåˆ—é‡Œï¼Œç±»ä¼¼æ­»ä¿¡é˜Ÿåˆ—ï¼Œåé¢å†æ…¢æ…¢åˆ†æã€‚kafkaæ²¡æœ‰æ­»ä¿¡é˜Ÿåˆ—éœ€è¦è‡ªå·±å®ç°ã€‚</li></ul><h3 id="kafka-å¦‚ä½•ä¸æ¶ˆè´¹é‡å¤æ•°æ®ï¼Ÿ"><a href="#kafka-å¦‚ä½•ä¸æ¶ˆè´¹é‡å¤æ•°æ®ï¼Ÿ" class="headerlink" title="kafka å¦‚ä½•ä¸æ¶ˆè´¹é‡å¤æ•°æ®ï¼Ÿ"></a>kafka å¦‚ä½•ä¸æ¶ˆè´¹é‡å¤æ•°æ®ï¼Ÿ</h3><p>é‡å¤æ•°æ®çš„äº§ç”Ÿï¼š</p><ul><li><p>å‘é€æ–¹ï¼šå‘é€æ¶ˆæ¯å¦‚æœé…ç½®äº†é‡è¯•æœºåˆ¶ï¼Œæ¯”å¦‚ç½‘ç»œæŠ–åŠ¨æ—¶é—´è¿‡é•¿å¯¼è‡´å‘é€ç«¯å‘é€è¶…æ—¶ï¼Œå®é™…brokerå¯èƒ½å·²ç»æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œä½†å‘é€æ–¹ä¼šé‡æ–°å‘é€æ¶ˆæ¯</p></li><li><p>æ¶ˆè´¹æ–¹ï¼šå¦‚æœæ¶ˆè´¹è¿™è¾¹é…ç½®çš„æ˜¯è‡ªåŠ¨æäº¤ï¼Œåˆšæ‹‰å–äº†ä¸€æ‰¹æ•°æ®å¤„ç†äº†ä¸€éƒ¨åˆ†ï¼Œä½†è¿˜æ²¡æ¥å¾—åŠæäº¤ï¼ŒæœåŠ¡æŒ‚äº†ï¼Œä¸‹æ¬¡é‡å¯åˆä¼šæ‹‰å–ç›¸åŒçš„ä¸€æ‰¹æ•°æ®é‡å¤å¤„ç†ã€‚</p></li></ul><p> è§£å†³æ–¹å¼ï¼š</p><ul><li><p>æ¶ˆè´¹æ¶ˆæ¯æœåŠ¡åšå¹‚ç­‰æ ¡éªŒï¼Œæ¯”å¦‚ï¼šæ•°æ®åº“&#x2F;redisï¼šè®¾ç½®ä¸€ä¸ªå”¯ä¸€çš„idå»æ ‡å¿—è¿™æ¡æ¶ˆæ¯ï¼Œæ¶ˆè´¹æ—¶å»æŸ¥è¯¢ä¸€ä¸‹ï¼Œå¦‚æœå·²ç»æ¶ˆè´¹è¿‡äº†ï¼Œåˆ™ä¸è¿›è¡Œæ¶ˆè´¹ã€‚ </p></li><li><p>å°†<code>enable.auto.commit</code>å‚æ•°è®¾ç½®ä¸º falseï¼Œå…³é—­è‡ªåŠ¨æäº¤ï¼Œå¼€å‘è€…åœ¨ä»£ç ä¸­æ‰‹åŠ¨æäº¤ offsetã€‚é‚£ä¹ˆè¿™é‡Œä¼šæœ‰ä¸ªé—®é¢˜ï¼š</p><p>ä»€ä¹ˆæ—¶å€™æäº¤offsetåˆé€‚ï¼Ÿ</p><ul><li>å¤„ç†å®Œæ¶ˆæ¯å†æäº¤ï¼šä¾æ—§æœ‰æ¶ˆæ¯é‡å¤æ¶ˆè´¹çš„é£é™©ï¼Œå’Œè‡ªåŠ¨æäº¤ä¸€æ ·</li><li>æ‹‰å–åˆ°æ¶ˆæ¯å³æäº¤ï¼šä¼šæœ‰æ¶ˆæ¯ä¸¢å¤±çš„é£é™©ã€‚å…è®¸æ¶ˆæ¯å»¶æ—¶çš„åœºæ™¯ï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨è¿™ç§æ–¹å¼ã€‚ç„¶åï¼Œé€šè¿‡å®šæ—¶ä»»åŠ¡åœ¨ä¸šåŠ¡ä¸ç¹å¿™ï¼ˆæ¯”å¦‚å‡Œæ™¨ï¼‰çš„æ—¶å€™åšæ•°æ®å…œåº•ã€‚</li></ul></li><li><h1 id="6-Zookeeper-åœ¨-Kafka-ä¸­çš„ä½œç”¨"><a href="#6-Zookeeper-åœ¨-Kafka-ä¸­çš„ä½œç”¨" class="headerlink" title="6 Zookeeper åœ¨ Kafka ä¸­çš„ä½œç”¨?"></a>6 Zookeeper åœ¨ Kafka ä¸­çš„ä½œç”¨?</h1><p>ZooKeeper ä¸»è¦ä¸º Kafka æä¾›å…ƒæ•°æ®çš„ç®¡ç†çš„åŠŸèƒ½ã€‚</p><ol><li><p><strong>Broker æ³¨å†Œ</strong> ï¼šåœ¨Zookeeperä¸Šä¼šæœ‰ä¸€ä¸ªä¸“é—¨<strong>ç”¨æ¥è¿›è¡ŒBrokeræœåŠ¡å™¨åˆ—è¡¨è®°å½•</strong>çš„èŠ‚ç‚¹&#x2F;brokers&#x2F;idsï¼Œæ¯ä¸ªBrokeråœ¨å¯åŠ¨æ—¶ï¼Œéƒ½ä¼šåˆ°Zookeeperä¸Šè¿›è¡Œæ³¨å†Œï¼Œå³åˆ°&#x2F;brokers&#x2F;idsä¸‹åˆ›å»ºå±äºè‡ªå·±çš„èŠ‚ç‚¹ï¼Œå¦‚&#x2F;brokers&#x2F;ids&#x2F;[0â€¦N]ã€‚Kafkaä½¿ç”¨äº†å…¨å±€å”¯ä¸€çš„æ•°å­—æ¥æŒ‡ä»£æ¯ä¸ªBrokeræœåŠ¡å™¨ï¼Œä¸åŒçš„Brokerå¿…é¡»ä½¿ç”¨ä¸åŒçš„Broker IDè¿›è¡Œæ³¨å†Œï¼Œåˆ›å»ºå®ŒèŠ‚ç‚¹åï¼Œ<strong>æ¯ä¸ªBrokerå°±ä¼šå°†è‡ªå·±çš„IPåœ°å€å’Œç«¯å£ä¿¡æ¯è®°å½•</strong>åˆ°è¯¥èŠ‚ç‚¹ä¸­å»ã€‚å…¶ä¸­ï¼ŒBrokeråˆ›å»ºçš„èŠ‚ç‚¹ç±»å‹æ˜¯ä¸´æ—¶èŠ‚ç‚¹ï¼Œä¸€æ—¦Brokerå®•æœºï¼Œåˆ™å¯¹åº”çš„ä¸´æ—¶èŠ‚ç‚¹ä¹Ÿä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚</p></li><li><p><strong>Topic æ³¨å†Œ</strong>ï¼š åœ¨ Kafka ä¸­ï¼ŒåŒä¸€ä¸ª<strong>Topic çš„æ¶ˆæ¯ä¼šè¢«åˆ†æˆå¤šä¸ªåˆ†åŒº</strong>å¹¶å°†å…¶åˆ†å¸ƒåœ¨å¤šä¸ª Broker ä¸Šï¼Œ<strong>è¿™äº›åˆ†åŒºä¿¡æ¯åŠä¸ Broker çš„å¯¹åº”å…³ç³»</strong>ä¹Ÿéƒ½æ˜¯ç”± Zookeeper åœ¨ç»´æŠ¤ã€‚æ¯”å¦‚æˆ‘åˆ›å»ºäº†ä¸€ä¸ªåå­—ä¸º my-topic çš„ä¸»é¢˜å¹¶ä¸”å®ƒæœ‰ä¸¤ä¸ªåˆ†åŒºï¼Œå¯¹åº”åˆ° zookeeper ä¸­ä¼šåˆ›å»ºè¿™äº›æ–‡ä»¶å¤¹ï¼š<code>/brokers/topics/my-topic/Partitions/0</code>ã€<code>/brokers/topics/my-topic/Partitions/1</code></p></li><li><p><strong>è´Ÿè½½å‡è¡¡</strong> ï¼šKafka é€šè¿‡ç»™ç‰¹å®š Topic æŒ‡å®šå¤šä¸ª Partition, è€Œå„ä¸ª Partition å¯ä»¥åˆ†å¸ƒåœ¨ä¸åŒçš„ Broker ä¸Š, è¿™æ ·ä¾¿èƒ½æä¾›æ¯”è¾ƒå¥½çš„å¹¶å‘èƒ½åŠ›ã€‚ å¯¹äºåŒä¸€ä¸ª Topic çš„ä¸åŒ Partitionï¼ŒKafka ä¼šå°½åŠ›å°†è¿™äº› Partition åˆ†å¸ƒåˆ°ä¸åŒçš„ Broker æœåŠ¡å™¨ä¸Šã€‚å½“ç”Ÿäº§è€…äº§ç”Ÿæ¶ˆæ¯åä¹Ÿä¼šå°½é‡æŠ•é€’åˆ°ä¸åŒ Broker çš„ Partition é‡Œé¢ã€‚<strong>å½“ Consumer æ¶ˆè´¹çš„æ—¶å€™ï¼ŒZookeeper å¯ä»¥æ ¹æ®å½“å‰çš„ Partition æ•°é‡ä»¥åŠ Consumer æ•°é‡æ¥å®ç°åŠ¨æ€è´Ÿè½½å‡è¡¡ã€‚</strong></p></li><li><p>ä¹‹å‰ï¼Œåœ¨æ¶ˆè´¹è€…å¯¹æŒ‡å®šæ¶ˆæ¯åˆ†åŒºè¿›è¡Œæ¶ˆæ¯æ¶ˆè´¹çš„è¿‡ç¨‹ä¸­ï¼Œ<strong>éœ€è¦å®šæ—¶åœ°å°†åˆ†åŒºæ¶ˆæ¯çš„æ¶ˆè´¹è¿›åº¦Offsetè®°å½•åˆ°Zookeeperä¸Š</strong>ï¼Œä»¥ä¾¿åœ¨è¯¥æ¶ˆè´¹è€…è¿›è¡Œé‡å¯æˆ–è€…å…¶ä»–æ¶ˆè´¹è€…é‡æ–°æ¥ç®¡è¯¥æ¶ˆæ¯åˆ†åŒºçš„æ¶ˆæ¯æ¶ˆè´¹åï¼Œèƒ½å¤Ÿä»ä¹‹å‰çš„è¿›åº¦å¼€å§‹ç»§ç»­è¿›è¡Œæ¶ˆæ¯æ¶ˆè´¹ã€‚</p></li></ol></li></ul><h2 id="æ¶ˆè´¹è¿›åº¦Offsetçš„ç†è§£"><a href="#æ¶ˆè´¹è¿›åº¦Offsetçš„ç†è§£" class="headerlink" title="æ¶ˆè´¹è¿›åº¦Offsetçš„ç†è§£"></a>æ¶ˆè´¹è¿›åº¦Offsetçš„ç†è§£</h2><ul><li><p>åœ¨æ¶ˆè´¹è€…å¯¹æŒ‡å®šæ¶ˆæ¯åˆ†åŒºè¿›è¡Œæ¶ˆæ¯æ¶ˆè´¹çš„è¿‡ç¨‹ä¸­ï¼Œ<strong>éœ€è¦å®šæ—¶åœ°å°†åˆ†åŒºæ¶ˆæ¯çš„æ¶ˆè´¹è¿›åº¦Offsetè®°å½•åˆ°Zookeeperä¸Š</strong>ï¼Œä»¥ä¾¿åœ¨è¯¥æ¶ˆè´¹è€…è¿›è¡Œé‡å¯æˆ–è€…å…¶ä»–æ¶ˆè´¹è€…é‡æ–°æ¥ç®¡è¯¥æ¶ˆæ¯åˆ†åŒºçš„æ¶ˆæ¯æ¶ˆè´¹åï¼Œèƒ½å¤Ÿä»ä¹‹å‰çš„è¿›åº¦å¼€å§‹ç»§ç»­è¿›è¡Œæ¶ˆæ¯æ¶ˆè´¹ã€‚</p></li><li><p>ç°åœ¨æ˜¯æ”¾åœ¨äº†ä¸€ä¸ªå«åš__consumer_offset çš„topic é‡Œï¼Œ<strong>keyæ˜¯</strong> consumerGroupId+topic+åˆ†åŒºå·ï¼Œvalueå°±æ˜¯å½“å‰offsetçš„å€¼ã€‚é»˜è®¤æ˜¯50ä¸ªåˆ†åŒºï¼Œç”±consumerè‡ªå·±ç®¡ç†ã€‚ </p></li><li><p><strong>æ¯ä¸ªconsumeræ˜¯åŸºäºè‡ªå·±åœ¨commit logä¸­çš„æ¶ˆè´¹è¿›åº¦(offset)æ¥è¿›è¡Œå·¥ä½œçš„</strong>ã€‚</p></li><li><p>è¿™æ„å‘³kafkaä¸­çš„consumerå¯¹é›†ç¾¤çš„å½±å“æ˜¯éå¸¸å°çš„ï¼Œæ·»åŠ ä¸€ä¸ªæˆ–è€…å‡å°‘ä¸€ä¸ªconsumerï¼Œå¯¹äºé›†ç¾¤æˆ–è€…å…¶ä»–consumer æ¥è¯´ï¼Œéƒ½æ˜¯æ²¡æœ‰å½±å“çš„ï¼Œå› ä¸ºæ¯ä¸ªconsumerç»´æŠ¤å„è‡ªçš„æ¶ˆè´¹offsetã€‚</p></li><li><p>ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬æŒ‰ç…§é¡ºåºé€æ¡æ¶ˆè´¹commit logä¸­çš„æ¶ˆæ¯ï¼Œå½“ç„¶æˆ‘å¯ä»¥é€šè¿‡æŒ‡å®šoffsetæ¥é‡å¤æ¶ˆè´¹æŸäº›æ¶ˆæ¯ï¼Œ æˆ–è€…è·³è¿‡æŸäº›æ¶ˆæ¯ã€‚</p></li></ul><h2 id="å»¶è¿Ÿé˜Ÿåˆ—çš„å®ç°"><a href="#å»¶è¿Ÿé˜Ÿåˆ—çš„å®ç°" class="headerlink" title="å»¶è¿Ÿé˜Ÿåˆ—çš„å®ç°"></a>å»¶è¿Ÿé˜Ÿåˆ—çš„å®ç°</h2><ol><li>å‘é€å»¶æ—¶æ¶ˆæ¯æ—¶å…ˆæŠŠæ¶ˆæ¯æŒ‰ç…§ä¸åŒçš„å»¶è¿Ÿæ—¶é—´æ®µå‘é€åˆ°æŒ‡å®šçš„é˜Ÿåˆ—ä¸­ï¼ˆtopic_1sï¼Œtopic_5sï¼Œtopic_10sï¼Œâ€¦topic_2hï¼Œè¿™ä¸ªä¸€ èˆ¬ä¸èƒ½æ”¯æŒä»»æ„æ—¶é—´æ®µçš„å»¶æ—¶ï¼‰ã€‚</li><li>consumeré€šè¿‡å®šæ—¶å™¨è¿›è¡Œè½®è®­æ¶ˆè´¹è¿™äº›topicï¼ŒæŸ¥çœ‹æ¶ˆæ¯æ˜¯å¦åˆ°æœŸï¼Œå¦‚æœåˆ°æœŸå°±æŠŠè¿™ä¸ªæ¶ˆæ¯å‘é€åˆ°å…·ä½“ä¸šåŠ¡å¤„ç†çš„topicä¸­ã€‚æäº¤æ—¶éœ€è¦å¸¦ä¸Šoffsetï¼Œä¾¿äºä¸‹æ¬¡çŸ¥é“ä»å“ªé‡Œå¼€å§‹æ¶ˆè´¹ã€‚</li><li>é˜Ÿåˆ—ä¸­æ¶ˆæ¯è¶Šé å‰çš„åˆ°æœŸæ—¶é—´è¶Šæ—©ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯å®šæ—¶å™¨åœ¨ä¸€æ¬¡æ¶ˆè´¹è¿‡ç¨‹ä¸­ï¼Œå¯¹æ¶ˆæ¯çš„å‘é€æ—¶é—´åšåˆ¤æ–­ï¼Œçœ‹ä¸‹æ˜¯å¦å»¶è¿Ÿåˆ°å¯¹ åº”æ—¶é—´äº†ï¼Œå¦‚æœåˆ°äº†å°±è½¬å‘ï¼Œå¦‚æœè¿˜æ²¡åˆ°è¿™ä¸€æ¬¡å®šæ—¶ä»»åŠ¡å°±å¯ä»¥æå‰ç»“æŸäº†ã€‚</li></ol><h2 id="kafka-é«˜æ€§èƒ½çš„åŸå› ï¼Ÿ"><a href="#kafka-é«˜æ€§èƒ½çš„åŸå› ï¼Ÿ" class="headerlink" title="kafka é«˜æ€§èƒ½çš„åŸå› ï¼Ÿ"></a>kafka é«˜æ€§èƒ½çš„åŸå› ï¼Ÿ</h2><ul><li><p>ç£ç›˜é¡ºåºè¯»å†™ï¼škafkaæ¶ˆæ¯ä¸èƒ½ä¿®æ”¹ä»¥åŠä¸ä¼šä»æ–‡ä»¶ä¸­é—´åˆ é™¤ä¿è¯äº†ç£ç›˜é¡ºåºè¯»ï¼Œkafkaçš„æ¶ˆæ¯å†™å…¥æ–‡ä»¶éƒ½æ˜¯è¿½åŠ åœ¨æ–‡ä»¶æœ«å°¾ï¼Œ </p><p>ä¸ä¼šå†™å…¥æ–‡ä»¶ä¸­çš„æŸä¸ªä½ç½®(éšæœºå†™)ä¿è¯äº†ç£ç›˜é¡ºåºå†™ã€‚ </p></li><li><p>è¯»å†™æ•°æ®çš„æ‰¹é‡batchå¤„ç†ä»¥åŠå‹ç¼©ä¼ è¾“ ã€‚Kafkaé‡‡ç”¨çš„æ•°æ®å‹ç¼©çš„æ–¹å¼ï¼Œä»¥æ—¶é—´æ¢ç©ºé—´ï¼Œé€šè¿‡cpuæ—¶é—´çš„å¢åŠ æ¥å°½é‡çš„å‡å°‘ç£ç›˜ç©ºé—´çš„å ç”¨å’Œç½‘ç»œIOçš„ä¼ è¾“é‡ï¼ŒKafkaä¸­æ¶ˆæ¯çš„å‹ç¼©æ˜¯å‘ç”Ÿåœ¨ç”Ÿäº§è€…å’ŒBrokerç«¯çš„ã€‚</p><ul><li>åœ¨ç”Ÿäº§è€…ç«¯ï¼Œæ¶ˆæ¯å‘é€çš„æ—¶å€™å°†æ¶ˆæ¯è¿›è¡Œå‹ç¼©ï¼Œå¯ä»¥é€šè¿‡å‚æ•°æ¥é…ç½®è¿›è¡Œå‹ç¼©çš„ç®—æ³•</li><li>åœ¨æ¶ˆè´¹è€…ç«¯å°±éœ€è¦å¯¹æ¶ˆæ¯è¿›è¡Œè§£å‹ç¼©æ“ä½œ</li></ul></li><li><p>æ•°æ®ä¼ è¾“çš„é›¶æ‹·è´</p><ul><li><p>ä¼ ç»Ÿçš„IOæµç¨‹ï¼ŒæŸå°æœºå™¨å°†ä¸€ä»½æ•°æ®ï¼ˆæ¯”å¦‚ä¸€ä¸ªæ–‡ä»¶ï¼‰é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°å¦å¤–ä¸€å°æœºå™¨ï¼Œä¸»è¦åŒ…æ‹¬ read å’Œ write è¿‡ç¨‹ã€‚</p><ul><li>readï¼šæŠŠæ•°æ®ä»ç£ç›˜è¯»å–åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œå†æ‹·è´åˆ°ç”¨æˆ·ç¼“å†²åŒº</li><li>writeï¼šå…ˆæŠŠç”¨æˆ·ç¼“å†²åŒºçš„æ•°æ®å†™å…¥åˆ° socketç¼“å†²åŒºï¼Œæœ€åå†™å…¥ç½‘å¡è®¾å¤‡</li></ul></li><li><p>éœ€è¦ç»è¿‡å››æ¬¡æ‹·è´å’Œå››æ¬¡çŠ¶æ€çš„è½¬æ¢</p><ul><li><p>ç”¨æˆ·ç©ºé—´çš„åº”ç”¨ç¨‹åºé€šè¿‡read()å‡½æ•°ï¼Œå‘æ“ä½œç³»ç»Ÿå‘èµ·IOè°ƒç”¨ï¼Œ<strong>ä¸Šä¸‹æ–‡ä»ç”¨æˆ·æ€åˆ°åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼ˆåˆ‡æ¢1ï¼‰</strong>ï¼Œç„¶åå†é€šè¿‡ DMA æ§åˆ¶å™¨å°†æ•°æ®ä»ã€ç£ç›˜æ–‡ä»¶ã€‘æ‹·è´åˆ°ã€æ“ä½œç³»ç»Ÿå†…æ ¸ç¼“å†²åŒºã€‘</p></li><li><p>CPUå°†æ•°æ®ä»ã€å†…æ ¸ç¼“å†²åŒºã€‘æ‹·è´åˆ°ã€ç”¨æˆ·ç¼“å†²åŒºã€‘ï¼Œ<strong>ä¸Šä¸‹æ–‡ä»å†…æ ¸æ€è½¬ä¸ºç”¨æˆ·æ€ï¼ˆåˆ‡æ¢2ï¼‰</strong>ï¼Œreadå‡½æ•°è¿”å›ã€‚</p></li><li><p>ç”¨æˆ·åº”ç”¨è¿›ç¨‹é€šè¿‡writeå‡½æ•°ï¼Œå‘èµ·IOè°ƒç”¨ï¼Œ<strong>ä¸Šä¸‹æ–‡ä»ç”¨æˆ·æ€è½¬ä¸ºå†…æ ¸æ€ï¼ˆåˆ‡æ¢3ï¼‰</strong>ï¼ŒCPUå°†æ•°æ®ä»ã€ç”¨æˆ·ç¼“å†²åŒºã€‘æ‹·è´åˆ°ã€å†…æ ¸ä¸­Socketç¼“å†²åŒºã€‘</p></li><li><p>MAæ§åˆ¶å™¨æŠŠæ•°æ®ä»ã€å†…æ ¸ä¸­Socketç¼“å†²åŒºã€‘æ‹·è´åˆ°ã€å†…æ ¸ä¸­ç½‘å¡çš„ç¼“å†²åŒºã€‘<strong>ä¸Šä¸‹æ–‡ä»å†…æ ¸æ€åˆ‡æ¢å›ç”¨æˆ·æ€ï¼ˆåˆ‡æ¢4ï¼‰</strong>ï¼Œwriteå‡½æ•°è¿”å›</p></li></ul></li><li><p>Kafka ä½¿ç”¨sendfile æ¥å®ç°é›¶æ‹·è´</p><ul><li>æ•°æ®ä»ä»ã€ç£ç›˜æ–‡ä»¶ã€‘æ‹·è´åˆ°ã€æ“ä½œç³»ç»Ÿå†…æ ¸ç¼“å†²åŒºã€‘åï¼Œç›´æ¥è®©æ“ä½œç³»ç»Ÿå†…æ ¸ç¼“å†²åŒºçš„æ•°æ®å‘é€åˆ°ç½‘å¡ï¼Œè·³è¿‡äº†ä¸¤æ¬¡CPUæ‹·è´æ•°æ®çš„æ­¥éª¤ã€‚å‡å°‘äº†å†…æ ¸æ€å’Œç”¨æˆ·æ€ä¸Šä¸‹æ–‡çŠ¶æ€çš„åˆ‡æ¢</li></ul></li></ul><p>æ³¨ï¼š<strong>å…¶å®é›¶æ‹·è´ï¼Œå¹¶ä¸æ˜¯è¯´æ‹·è´çš„æ¬¡æ•°ä¸ºé›¶ï¼Œåªæ˜¯è¯´æ²¡æœ‰cupæ‹·è´çš„è¿‡ç¨‹ï¼Œè¿™é‡Œçš„é›¶æ‹·è´æŒ‡çš„æ˜¯cpuæ‹·è´æ¬¡æ•°ä¸ºé›¶</strong>ï¼Œ</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228234101159.png" alt="image-20230228234101159"></p></li></ul><blockquote><p> ä»€ä¹ˆæ˜¯ç”¨æˆ·æ€ã€å†…æ ¸æ€?</p></blockquote><blockquote><ul><li>å¦‚æœè¿›ç¨‹è¿è¡Œäºå†…æ ¸ç©ºé—´ï¼Œè¢«ç§°ä¸ºè¿›ç¨‹çš„å†…æ ¸æ€</li><li>å¦‚æœè¿›ç¨‹è¿è¡Œäºç”¨æˆ·ç©ºé—´ï¼Œè¢«ç§°ä¸ºè¿›ç¨‹çš„ç”¨æˆ·æ€ã€‚</li></ul><p>æ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªè¿›ç¨‹éƒ½åˆ†é…äº†å†…å­˜ç©ºé—´ï¼Œä¸€éƒ¨åˆ†æ˜¯ç”¨æˆ·ç©ºé—´ï¼Œä¸€éƒ¨åˆ†æ˜¯å†…æ ¸ç©ºé—´ã€‚<strong>å†…æ ¸ç©ºé—´æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸è®¿é—®çš„åŒºåŸŸï¼Œæ˜¯å—ä¿æŠ¤çš„å†…å­˜ç©ºé—´ï¼Œè€Œç”¨æˆ·ç©ºé—´æ˜¯ç”¨æˆ·åº”ç”¨ç¨‹åºè®¿é—®çš„å†…å­˜åŒºåŸŸ</strong></p></blockquote><h2 id="è®¾è®¡ä¸€ä¸ªMQçš„æ€è·¯"><a href="#è®¾è®¡ä¸€ä¸ªMQçš„æ€è·¯" class="headerlink" title="è®¾è®¡ä¸€ä¸ªMQçš„æ€è·¯"></a>è®¾è®¡ä¸€ä¸ªMQçš„æ€è·¯</h2><ul><li>å¯ä¼¸ç¼©æ€§ï¼šéœ€è¦çš„æ—¶å€™å¿«é€Ÿæ‰©å®¹ï¼Œå°±å¯ä»¥å¢åŠ ååé‡å’Œå®¹é‡ã€‚å‚ç…§ä¸€ä¸‹ kafka çš„è®¾è®¡ç†å¿µï¼Œ broker -&gt; topic -&gt; partitionï¼Œæ¯ä¸ª partition æ”¾ä¸€ä¸ªæœºå™¨ï¼Œå°±å­˜ä¸€éƒ¨åˆ†æ•°æ®ã€‚ å¦‚æœç°åœ¨èµ„æºä¸å¤Ÿäº†ï¼Œç»™ topic å¢åŠ  partitionã€‚</li><li>æŒä¹…åŒ–ï¼šmq çš„æ•°æ®è¦è½åœ°ç£ç›˜ï¼Œå‚è€ƒkafkaé¡ºåºå†™ï¼Œé¡ºåºè¯»ã€‚è¿™æ ·å°±æ²¡æœ‰ç£ç›˜éšæœºè¯»å†™çš„å¯»å€å¼€é”€ï¼Œç£ç›˜é¡ºåºè¯»å†™çš„æ€§èƒ½æ˜¯å¾ˆé«˜çš„</li><li>é«˜å¯ç”¨æ€§ï¼šå¤šå‰¯æœ¬ -&gt; leader &amp; followerï¼Œbroker æŒ‚äº†é‡æ–°é€‰ä¸¾ leader</li><li>æ•°æ® 0 ä¸¢å¤±ï¼šå‚è€ƒï¼š<a href="https://pyr9.github.io/RabbitMQ%E7%9A%84%E6%B6%88%E6%81%AF%E9%9B%B6%E4%B8%A2%E5%A4%B1%E6%96%B9%E6%A1%88/">RabbitMQçš„æ¶ˆæ¯é›¶ä¸¢å¤±æ–¹æ¡ˆ - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a>ï¼Œ <a href="https://pyr9.github.io/kafka%E7%9A%84%E6%B6%88%E6%81%AF%E9%9B%B6%E4%B8%A2%E5%A4%B1%E6%96%B9%E6%A1%88/">kafkaçš„æ¶ˆæ¯é›¶ä¸¢å¤±æ–¹æ¡ˆ - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Kafka</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•´ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>java ä»£ç†</title>
    <link href="/java-%E4%BB%A3%E7%90%86/"/>
    <url>/java-%E4%BB%A3%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h1><p> ä»£ç†æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼</p><ul><li>å®šä¹‰ï¼šé€šè¿‡ä»£ç†å¯¹è±¡è®¿é—®ç›®æ ‡å¯¹è±¡ã€‚</li><li>å¥½å¤„ï¼šå¯ä»¥åœ¨ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œæ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½</li></ul><p> ä»£ç†ç±»å¯ä»¥åˆ†ä¸ºé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ã€‚</p><h2 id="1-é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†"><a href="#1-é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†" class="headerlink" title="1.é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†"></a><strong>1.é™æ€ä»£ç†</strong>å’ŒåŠ¨æ€ä»£ç†</h2><h3 id="é™æ€ä»£ç†"><a href="#é™æ€ä»£ç†" class="headerlink" title="é™æ€ä»£ç†"></a>é™æ€ä»£ç†</h3><ol><li><p>å®šä¹‰ï¼š é€šè¿‡å£°æ˜ä¸€ä¸ªæ˜ç¡®çš„ä»£ç†ç±»æ¥è®¿é—®æºå¯¹è±¡ã€‚éœ€è¦å’Œç›®æ ‡å¯¹è±¡ä¸€èµ·å®ç°ç›¸åŒçš„æ¥å£æˆ–è€…ç»§æ‰¿ç›¸åŒçš„çˆ¶ç±»ã€‚</p></li><li><p>ç‰¹ç‚¹ï¼šåœ¨ç¼–è¯‘å™¨ç¡®å®šä»£ç†å¯¹è±¡ï¼Œåœ¨ç¨‹åºè¿è¡Œå‰ï¼Œä»£ç†ç±»çš„.classæ–‡ä»¶å°±å·²ç»å­˜åœ¨äº†ã€‚</p></li><li><p>ä¼˜ç‚¹ï¼šå¯ä»¥åšåˆ°ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„å‰æä¸‹ï¼Œå¯¹ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•è¿›è¡Œæ‰©å±•ã€‚</p></li><li><p>ç¼ºç‚¹ï¼š</p><ul><li><p>ä»£ç†ç±»éœ€è¦å’Œç›®æ ‡ç±»å®ç°ç›¸åŒçš„æ¥å£ï¼ŒåŒæ—¶è¦å®ç°ç›¸åŒçš„æ–¹æ³•ï¼Œè¿™æ ·å°±å‡ºç°äº†å¾ˆå¤šé‡å¤ä»£ç ã€‚</p></li><li><p>å¦‚æœæ¥å£å¢åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œä»£ç†ç±»å’Œç›®æ ‡ç±»éƒ½éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œå¢åŠ äº†ä»£ç ç»´æŠ¤çš„å¤æ‚åº¦ã€‚</p></li></ul></li></ol><h3 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h3><h4 id="JDKåŠ¨æ€ä»£ç†"><a href="#JDKåŠ¨æ€ä»£ç†" class="headerlink" title="JDKåŠ¨æ€ä»£ç†"></a>JDKåŠ¨æ€ä»£ç†</h4><ol><li><p>å®šä¹‰ï¼šä½¿ç”¨JDKå®˜æ–¹çš„Proxyç±»åˆ›å»ºä»£ç†å¯¹è±¡ã€‚</p></li><li><p>ç‰¹ç‚¹ï¼šåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼ŒåŠ¨æ€ç”Ÿæˆä»£ç†ç±»ï¼Œä»£ç†ç±»éœ€è¦å®ç°<strong>InvocationHandler</strong>ï¼Œé‡å†™invokeæ–¹æ³•ã€‚</p></li><li><p>ä¼˜ç‚¹ï¼š</p><ul><li>æ¥å£ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•è¢«è¿ç§»åˆ°ä»£ç†ç±»ä¸­çš„invokeæ–¹æ³•è¿›è¡Œå®ç°ï¼Œè¿™æ ·ï¼Œå¦‚æœæ¥å£æ–¹æ³•å¾ˆå¤šçš„è¯ï¼Œä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªæ–¹æ³•è¿›è¡Œä¸­è½¬ï¼Œå¯ä»¥çµæ´»å¤„ç†ã€‚</li></ul></li></ol><h4 id="CGLIBåŠ¨æ€ä»£ç†"><a href="#CGLIBåŠ¨æ€ä»£ç†" class="headerlink" title="CGLIBåŠ¨æ€ä»£ç†"></a>CGLIBåŠ¨æ€ä»£ç†</h4><ol><li><p>ä½¿ç”¨ï¼šç¬¬ä¸‰æ–¹CGLibçš„Enhancerç±»åˆ›å»ºä»£ç†å¯¹è±¡, è®¾ç½®Superclassä¸ºç›®æ ‡ç±»ï¼Œ ä½¿ç”¨çš„æ˜¯æ–¹æ³•æ‹¦æˆªå™¨ <strong>MethodInterceptor</strong>ï¼Œé‡å†™interceptæ–¹æ³•ã€‚</p></li><li><p>ç‰¹ç‚¹ï¼šCglibæ˜¯é€šè¿‡ç”Ÿæˆå­ç±»æ¥å®ç°çš„ï¼Œä»£ç†å¯¹è±¡æ—¢å¯ä»¥èµ‹å€¼ç»™å®ç°ç±»ï¼Œåˆå¯ä»¥èµ‹å€¼ç»™æ¥å£ã€‚</p></li><li><p>ä¼˜ç‚¹ï¼šCglibé€Ÿåº¦æ¯”jdkåŠ¨æ€ä»£ç†æ›´å¿«ï¼Œæ€§èƒ½æ›´å¥½ã€‚</p></li></ol><h2 id="é™æ€ä»£ç†ç¨‹åºç¤ºä¾‹"><a href="#é™æ€ä»£ç†ç¨‹åºç¤ºä¾‹" class="headerlink" title="é™æ€ä»£ç†ç¨‹åºç¤ºä¾‹"></a>é™æ€ä»£ç†ç¨‹åºç¤ºä¾‹</h2><p>step1:å®šä¹‰å§”æ‰˜ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Email</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">receive</span><span class="hljs-params">()</span></span>;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlashEmail</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Email</span> </span>&#123;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-comment">// TODO Auto-generated method stub</span><br>            System.out.println(<span class="hljs-string">&quot;é‚®ä»¶å‘é€ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">receive</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-comment">// TODO Auto-generated method stub</span><br>       System.out.println(<span class="hljs-string">&quot;é‚®ä»¶æ¥å—ä¸­..........&quot;</span>);<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>step2:å®šä¹‰ä»£ç†ç±»ï¼Œä¸å§”æ‰˜ç±»æœ‰åŒæ ·çš„æ¥å£</p><p> ä¸æ”¹å˜åŸæ¥å£å®ç°ç±»çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥å¯¹æ¥å£çš„åŠŸèƒ½è¿›è¡Œéœ€æ±‚å˜æ›´</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmailProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Email</span> </span>&#123;<br><br>Email email;<br>     <span class="hljs-comment">//ä¼ å…¥å§”æ‰˜ç±»åˆå§‹åŒ–ä»£ç†ç±»</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">EmailProxy</span><span class="hljs-params">(Email email)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">this</span>.email=email;<br>&#125;<br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span><span class="hljs-params">()</span> </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;å‘é€é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚&quot;</span>);<br>    email.send();<br>    System.out.println(<span class="hljs-string">&quot;å‘é€åã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">revieve</span><span class="hljs-params">()</span> </span>&#123;<br><br>System.out.println(<span class="hljs-string">&quot;æ¥å—é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚&quot;</span>); <br>email.receive();<br>System.out.println(<span class="hljs-string">&quot;æ¥å—é‚®ä»¶æˆåŠŸ....&quot;</span>);<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>step3:æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br><span class="hljs-comment">//åŸå§‹å¯¹è±¡</span><br>   Email email=<span class="hljs-keyword">new</span> FlashEmail();<br>   <span class="hljs-comment">//æ¥å£çš„ä»£ç†ç±»</span><br>   EmailProxy ep=<span class="hljs-keyword">new</span> EmailProxy(email);<br>   ep.send();<br>   System.out.println(<span class="hljs-string">&quot;-----------------------------------------&quot;</span>);<br>   ep.receive();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>æµ‹è¯•ç»“æœï¼š</p><p>å‘é€é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚<br> é‚®ä»¶å‘é€ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚<br> å‘é€åã€‚ã€‚ã€‚ã€‚ã€‚ã€‚<br> -â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-<br> æ¥å—é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚<br> é‚®ä»¶æ¥å—ä¸­â€¦â€¦â€¦.<br> æ¥å—é‚®ä»¶æˆåŠŸâ€¦.</p><h3 id="2-JDKåŠ¨æ€ä»£ç†ç¨‹åºç¤ºä¾‹"><a href="#2-JDKåŠ¨æ€ä»£ç†ç¨‹åºç¤ºä¾‹" class="headerlink" title="2 JDKåŠ¨æ€ä»£ç†ç¨‹åºç¤ºä¾‹"></a>2 JDKåŠ¨æ€ä»£ç†ç¨‹åºç¤ºä¾‹</h3><p>Step1: å®šä¹‰æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Email</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">revieve</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>step1:å®šä¹‰å§”æ‰˜ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlashEmail</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Email</span> </span>&#123;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-comment">// TODO Auto-generated method stub</span><br>            System.out.println(<span class="hljs-string">&quot;é‚®ä»¶å‘é€ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">receive</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-comment">// TODO Auto-generated method stub</span><br>       System.out.println(<span class="hljs-string">&quot;é‚®ä»¶æ¥å—ä¸­..........&quot;</span>);<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>step2:åœ¨ä½¿ç”¨åŠ¨æ€ä»£ç†æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªä½äºä»£ç†ç±»ä¸å§”æ‰˜ç±»ä¹‹é—´çš„ä¸­ä»‹ç±»ï¼Œä¹Ÿå«åŠ¨æ€ä»£ç†ç±»ï¼Œä»¥å®Œæˆä»£ç†è¦å®Œæˆçš„å…·ä½“æ“ä½œï¼Œè¿™ä¸ªç±»è¢«è¦æ±‚å®ç°<strong>InvocationHandler</strong>æ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.my.test.proxy;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationHandler;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmailProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">InvocationHandler</span> </span>&#123;<br><br>Object obj;<span class="hljs-comment">//å§”æ‰˜å¯¹è±¡</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">EmailProxy</span><span class="hljs-params">(Object obj)</span> </span>&#123;<br><span class="hljs-keyword">super</span>();<br><span class="hljs-keyword">this</span>.obj = obj;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;send&quot;</span>.equals(method.getName())) &#123;<br> System.out.println(<span class="hljs-string">&quot;å‘é€é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚&quot;</span>);<br> method.invoke(obj);<span class="hljs-comment">//ä»å§”æ‰˜å¯¹è±¡ä¸­ï¼Œè°ƒç”¨è¯¥å¯¹è±¡çš„æŒ‡å®šæ–¹æ³•ï¼Œè¿™é‡Œç›¸å½“äºsendæ–¹æ³•</span><br>     System.out.println(<span class="hljs-string">&quot;å‘é€åã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;receive&quot;</span>.equals(method.getName())) &#123;<br>System.out.println(<span class="hljs-string">&quot;æ¥å—é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚&quot;</span>); <br>method.invoke(obj);<br>System.out.println(<span class="hljs-string">&quot;æ¥å—é‚®ä»¶æˆåŠŸ....&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>step4:æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    Email email=<span class="hljs-keyword">new</span> FlashEmail();<br>    Email emailProxy=(Email) Proxy.newProxyInstance(<br>      email.getClass().getClassLoader(),<br>      email.getClass().getInterfaces(),<br>      <span class="hljs-keyword">new</span> EmailProxy(email) );<br>    emailProxy.send();<br>    System.out.println(<span class="hljs-string">&quot;---------------------------------------------------&quot;</span>);<br>    emailProxy.receive();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>æµ‹è¯•ç»“æœï¼š</p><p>å‘é€é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚<br> é‚®ä»¶å‘é€ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚<br> å‘é€åã€‚ã€‚ã€‚ã€‚ã€‚ã€‚<br> -â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-<br> æ¥å—é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚<br> é‚®ä»¶æ¥å—ä¸­â€¦â€¦â€¦.<br> æ¥å—é‚®ä»¶æˆåŠŸâ€¦.</p><h3 id="CGLIBåŠ¨æ€ä»£ç†ç¨‹åºç¤ºä¾‹"><a href="#CGLIBåŠ¨æ€ä»£ç†ç¨‹åºç¤ºä¾‹" class="headerlink" title="CGLIBåŠ¨æ€ä»£ç†ç¨‹åºç¤ºä¾‹"></a>CGLIBåŠ¨æ€ä»£ç†ç¨‹åºç¤ºä¾‹</h3><p>Step1: å¼•å…¥cglibä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>  &lt;groupId&gt;cglib&lt;/groupId&gt;<br>  &lt;artifactId&gt;cglib&lt;/artifactId&gt;<br>  &lt;version&gt;<span class="hljs-number">3.2</span><span class="hljs-number">.5</span>&lt;/version&gt;<br>  &lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>Step2: å®šä¹‰å§”æ‰˜ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlashEmail</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span><span class="hljs-params">()</span> </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;é‚®ä»¶å‘é€ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">receive</span><span class="hljs-params">()</span> </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;é‚®ä»¶æ¥å—ä¸­..........&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Step3: åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œå®ç°æ¥å£net.sf.cglib.proxy.MethodInterceptorï¼Œç”¨äºæ–¹æ³•çš„æ‹¦æˆªå›è°ƒã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MethodInterceptor</span> </span>&#123;<br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">intercept</span><span class="hljs-params">(Object proxy, Method method, Object[] args, MethodProxy methodProxy)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>    Object result = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;send&quot;</span>.equals(method.getName())) &#123;<br>      System.out.println(<span class="hljs-string">&quot;å‘é€é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚&quot;</span>);<br>      result = methodProxy.invokeSuper(proxy,args);<br>      System.out.println(<span class="hljs-string">&quot;å‘é€åã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;receive&quot;</span>.equals(method.getName())) &#123;<br>      System.out.println(<span class="hljs-string">&quot;æ¥å—é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚&quot;</span>);<br>      result = methodProxy.invokeSuper(proxy,args);<br>      System.out.println(<span class="hljs-string">&quot;æ¥å—é‚®ä»¶æˆåŠŸ....&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> result;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Step4: æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> proxy;<br><br><span class="hljs-keyword">import</span> net.sf.cglib.proxy.Enhancer;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    <span class="hljs-comment">// åˆ›å»ºEnhancerå¯¹è±¡ï¼Œç±»ä¼¼äºJDKåŠ¨æ€ä»£ç†çš„Proxyç±»</span><br>    Enhancer enhancer = <span class="hljs-keyword">new</span> Enhancer();<br>    enhancer.setSuperclass(FlashEmail.class);<br>    enhancer.setCallback(<span class="hljs-keyword">new</span> LogInterceptor());<br>    <span class="hljs-comment">// createæ–¹æ³•æ­£å¼åˆ›å»ºä»£ç†ç±»</span><br>    FlashEmail emailProxy = (FlashEmail)enhancer.create();<br>    emailProxy.send();<br>    emailProxy.receive();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœï¼š</p><p>å‘é€é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚<br> é‚®ä»¶å‘é€ä¸­ã€‚ã€‚ã€‚ã€‚ã€‚<br> å‘é€åã€‚ã€‚ã€‚ã€‚ã€‚ã€‚<br> -â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-<br> æ¥å—é‚®ä»¶å‰å‡†å¤‡ã€‚ã€‚ã€‚<br> é‚®ä»¶æ¥å—ä¸­â€¦â€¦â€¦.<br> æ¥å—é‚®ä»¶æˆåŠŸâ€¦.</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¢è¯•é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringçŸ¥è¯†ç‚¹æ•´ç†</title>
    <link href="/Spring%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/Spring%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Springæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç‚¹"><a href="#1-Springæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç‚¹" class="headerlink" title="1. Springæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç‚¹"></a>1. Springæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç‚¹</h1><ul><li>Springæ˜¯ä¸€ä¸ªè½»é‡çº§çš„javaæ¡†æ¶ï¼ŒSpringçš„æ ¸å¿ƒæ˜¯IOCå’ŒAOPã€‚ä¸»è¦çš„ä¼˜ç‚¹åŒ…æ‹¬ï¼š<ul><li>æ–¹ä¾¿è§£è€¦ï¼Œç®€åŒ–å¼€å‘ã€‚é€šè¿‡Springæä¾›çš„IOCå®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¯¹è±¡çš„ä¾èµ–å…³ç³»äº¤ç»™Springè¿›è¡Œæ§åˆ¶ï¼Œé¿å…ç¡¬ç¼–ç é€ æˆçš„è€¦åˆæ€§é«˜ã€‚ç®€å•æ¥è¯´ï¼Œä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬controller éœ€è¦ä¸€ä¸ªserviceï¼Œåˆ™éœ€è¦new serviceï¼Œç°åœ¨æ˜¯Springå‘ç°ä½ çš„controller éœ€è¦serviceï¼Œå°±ç»™ä½ è‡ªåŠ¨æ³¨å…¥ã€‚</li><li>AOPç¼–ç¨‹çš„æ”¯æŒã€‚Springæä¾›é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œæ–¹ä¾¿çš„å®ç°å¯¹ç¨‹åºè¿›è¡Œæ‹¦æˆªï¼Œè¿è¡Œç›‘æ§ç­‰ã€‚ä¸»è¦é€šè¿‡BeanPostProcessor çš„postProcessBeforeInitializationï¼ŒpostProcessAfterInitializationï¼Œ + åŠ¨æ€ä»£ç†å®ç°ã€‚ï¼ˆæœ‰æ¥å£å°±ç”¨JDKçš„åŠ¨æ€ä»£ç†ï¼Œå¦åˆ™CJLIBï¼‰</li><li>å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒã€‚åªéœ€è¦é…ç½®å°±å¯ä»¥å®ç°å¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œè€Œæ— éœ€æ‰‹åŠ¨ç¼–ç¨‹ã€‚</li><li>å¯¹Junitæ”¯æŒï¼Œæ–¹ä¾¿ç¨‹åºæµ‹è¯•ã€‚<ul><li>é›†æˆäº†å„ç§ä¼˜ç§€æ¡†æ¶ï¼Œå¦‚mybatis, quartzã€‚</li></ul></li></ul></li></ul><h1 id="2-åœ¨-Spring-ä¸­ï¼ŒBean-æ˜¯å¦‚ä½•ç”Ÿæˆçš„ï¼Ÿ-x2F-bean-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#2-åœ¨-Spring-ä¸­ï¼ŒBean-æ˜¯å¦‚ä½•ç”Ÿæˆçš„ï¼Ÿ-x2F-bean-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="2 åœ¨ Spring ä¸­ï¼ŒBean æ˜¯å¦‚ä½•ç”Ÿæˆçš„ï¼Ÿ&#x2F; bean çš„ç”Ÿå‘½å‘¨æœŸ"></a>2 åœ¨ Spring ä¸­ï¼ŒBean æ˜¯å¦‚ä½•ç”Ÿæˆçš„ï¼Ÿ&#x2F; bean çš„ç”Ÿå‘½å‘¨æœŸ</h1><ul><li>Springæ‰«æclass æ–‡ä»¶ï¼Œå¾—åˆ°BeanDefinition</li><li>æ ¹æ®BeanDefinitionå»ç”Ÿæˆbean<ul><li>å®ä¾‹åŒ–é˜¶æ®µï¼šæ ¹æ®æ„é€ å‡½æ•°æ¥å®Œæˆå®ä¾‹åŒ– ï¼ˆ<strong>æœªå±æ€§æ³¨å…¥ä»¥åŠåˆå§‹åŒ–çš„å¯¹è±¡</strong> è¿™é‡Œç®€ç§°ä¸º <strong>åŸå§‹å¯¹è±¡</strong>ï¼‰</li><li>å±æ€§æ³¨å…¥é˜¶æ®µï¼šå¯¹ Bean çš„å±æ€§è¿›è¡Œä¾èµ–æ³¨å…¥ ï¼ˆè¿™é‡Œå°±æ˜¯<strong>å‘ç”Ÿå¾ªç¯ä¾èµ–é—®é¢˜çš„ç¯èŠ‚</strong>ï¼‰</li><li>å¦‚æœ Bean çš„æŸä¸ªæ–¹æ³•æœ‰AOPæ“ä½œï¼Œåˆ™éœ€è¦æ ¹æ®åŸå§‹å¯¹è±¡ç”Ÿæˆ<strong>ä»£ç†å¯¹è±¡</strong>ã€‚ï¼ˆbeanPostProcessorï¼‰</li></ul></li><li>æœ€åæŠŠä»£ç†å¯¹è±¡æ”¾å…¥å•ä¾‹æ± ï¼ˆä¸€çº§ç¼“å­˜singletonObjectsï¼‰ä¸­ï¼Œä¸‹æ¬¡è·å–å¯¹è±¡å°±ç›´æ¥ä»å•ä¾‹æ± ä¸­è·å–ã€‚</li></ul><h1 id="3-Springçš„å¾ªç¯ä¾èµ–"><a href="#3-Springçš„å¾ªç¯ä¾èµ–" class="headerlink" title="3. Springçš„å¾ªç¯ä¾èµ–"></a>3. Springçš„å¾ªç¯ä¾èµ–</h1><p>å¾ªç¯ä¾èµ–å°±æ˜¯åœ¨åˆ›å»ºbeançš„è¿‡ç¨‹ä¸­ï¼ˆå®ä¾‹åŒ– Bean åä¼šè¿›è¡Œ å±æ€§æ³¨å…¥ï¼ˆä¾èµ–æ³¨å…¥ï¼‰ï¼‰ï¼ŒAå¯¹è±¡ä¾èµ–äº†Bå¯¹è±¡ï¼ŒBå¯¹è±¡ä¾èµ–äº†Aå¯¹è±¡ï¼Œå¯¼è‡´Aï¼ŒBä¸¤ä¸ªå¯¹è±¡éƒ½åˆ›å»ºä¸å‡ºæ¥ã€‚</p><blockquote><p> ABean åˆ›å»ºâ€“&gt;ä¾èµ–äº† B å±æ€§â€“&gt;è§¦å‘ BBean åˆ›å»ºâ€”&gt;B ä¾èµ–äº† A å±æ€§â€”&gt;éœ€è¦ ABeanï¼ˆä½† ABean è¿˜åœ¨åˆ›å»ºè¿‡ç¨‹ä¸­ï¼‰</p></blockquote><p>è€Œè¿™ç§æƒ…å†µåªä¼šåœ¨å°†Beanäº¤ç»™Springç®¡ç†çš„æ—¶å€™æ‰ä¼šå‡ºç°ï¼Œå› ä¸ºä¸Šé¢çš„è¿™äº›å±æ€§æ³¨å…¥æ“ä½œéƒ½æ˜¯Springå»åšçš„ï¼Œå¦‚æœåªæ˜¯æˆ‘ä»¬è‡ªå·±åœ¨Javaä¸­åˆ›å»ºå¯¹è±¡å¯ä»¥ä¸å»æ³¨å…¥å±æ€§ï¼Œè®©æˆå‘˜å±æ€§ä¸ºNULLä¹Ÿå¯ä»¥æ­£å¸¸æ‰§è¡Œçš„ï¼Œè¿™æ ·ä¹Ÿå°±ä¸ä¼šå‡ºç°å¾ªç¯ä¾èµ–çš„é—®é¢˜äº†ã€‚</p><p>åœ¨ Spring ä¸­ï¼Œé€šè¿‡<strong>ä¸‰çº§ç¼“å­˜</strong>æœºåˆ¶å¸®å¼€å‘è€…è§£å†³äº†éƒ¨åˆ†å¾ªç¯ä¾èµ–çš„é—®é¢˜ã€‚</p><ul><li>ä¸€çº§ç¼“å­˜ä¸ºï¼š<strong>singletonObjects</strong>: ç¼“å­˜å·²ç»ç»å†äº†å®Œæ•´ç”Ÿå‘½å‘¨æœŸçš„ bean å¯¹è±¡ã€‚</li><li>äºŒçº§ç¼“å­˜ä¸ºï¼š<strong>earlySingletonObjects</strong>: ç¼“å­˜çš„æ˜¯æ—©æœŸçš„ bean å¯¹è±¡ã€‚è¡¨ç¤º Bean çš„ç”Ÿå‘½å‘¨æœŸè¿˜æ²¡èµ°å®Œå°±æŠŠè¿™ä¸ª Bean æ”¾å…¥äº† earlySingletonObjectsã€‚</li><li>ä¸‰çº§ç¼“å­˜ä¸ºï¼š<strong>singletonFactories</strong>: ç¼“å­˜çš„æ˜¯ ObjectFactoryï¼Œå¯¹è±¡å·¥å‚ï¼Œç”¨æ¥åˆ›å»ºæ—©æœŸ bean å¯¹è±¡çš„å·¥å‚ã€‚å®é™…ä¸Šæ˜¯ä¸€ä¸ª Lambda è¡¨è¾¾å¼ï¼Œ æ‰§è¡Œlambdaè¡¨è¾¾å¼ï¼Œå¾—åˆ°å°±æ˜¯å¯¹åº”çš„ä»£ç†å¯¹è±¡ã€‚</li></ul><p>ç®€å•ç‚¹è¯´ï¼ŒSpringè§£å†³å¾ªç¯ä¾èµ–çš„æ€è·¯å°±æ˜¯ï¼šå½“Açš„beanéœ€è¦Bçš„beançš„æ—¶å€™ï¼Œæå‰å°†Açš„beanæ”¾åœ¨ç¼“å­˜ä¸­ï¼ˆå®é™…æ˜¯å°†Açš„ObjectFactoryæ”¾åˆ°ä¸‰çº§ç¼“å­˜ï¼‰ï¼Œç„¶åå†å»åˆ›å»ºBçš„beanï¼Œä½†æ˜¯Bçš„beanä¹Ÿéœ€è¦Açš„beanï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å»ç¼“å­˜ä¸­æ‹¿Açš„beanï¼ŒBçš„beanåˆ›å»ºå®Œæ¯•åï¼Œå†å›æ¥ç»§ç»­åˆ›å»ºAçš„beanï¼Œæœ€ç»ˆå®Œæˆå¾ªç¯ä¾èµ–çš„è§£å†³ã€‚</p><p>Spring åˆ©ç”¨ ä¸‰çº§ç¼“å­˜ å·§å¦™åœ°å°†å‡ºç° å¾ªç¯ä¾èµ– æ—¶çš„ AOP æ“ä½œ æå‰åˆ°äº† å±æ€§æ³¨å…¥ ä¹‹å‰ï¼ˆé€šè¿‡ç¬¬ä¸‰çº§ç¼“å­˜å®ç°çš„ï¼‰ï¼Œè§£å†³äº†å¾ªç¯ä¾èµ–é—®é¢˜ã€‚</p><h1 id="4-Springå‰åç½®ç¯ç»•å¼‚å¸¸é€šçŸ¥"><a href="#4-Springå‰åç½®ç¯ç»•å¼‚å¸¸é€šçŸ¥" class="headerlink" title="4 Springå‰åç½®ç¯ç»•å¼‚å¸¸é€šçŸ¥"></a>4 Springå‰åç½®ç¯ç»•å¼‚å¸¸é€šçŸ¥</h1><ul><li>before: æ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œï¼Œå¦‚æœé€šçŸ¥æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™æ–¹æ³•æ— æ³•æ‰§è¡Œã€‚</li><li>after: æ–¹æ³•æ‰§è¡Œåæ‰§è¡Œï¼Œä¸è®ºæ–¹æ³•ä¸­æ˜¯å¦æŠ›å‡ºå¼‚å¸¸ã€‚ä¸»è¦ç”¨æ¥æ¸…ç†ç°åœºã€‚</li><li>aroundï¼šç¯ç»•é€šçŸ¥ï¼Œæ–¹æ³•æ‰§è¡Œå‰ååˆ†åˆ«æ‰§è¡Œï¼Œå¿…é¡»æ‰‹åŠ¨è°ƒç”¨ç›®æ ‡æ–¹æ³•ã€‚</li><li>afterReturning: æ–¹æ³•æ‰§è¡Œåæ‰§è¡Œï¼Œå¯ä»¥è·å¾—æ–¹æ³•çš„è¿”å›å€¼ï¼Œæ–¹æ³•ä¸­æŠ›å‡ºå¼‚å¸¸åˆ™æ— æ³•æ‰§è¡Œã€‚</li><li>afterThrowing: æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åæ‰§è¡Œã€‚</li></ul><h1 id="5-Springäº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼ˆå¤šä¸ªäº‹åŠ¡å­˜åœ¨æ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Ÿï¼‰"><a href="#5-Springäº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼ˆå¤šä¸ªäº‹åŠ¡å­˜åœ¨æ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Ÿï¼‰" class="headerlink" title="5 Springäº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼ˆå¤šä¸ªäº‹åŠ¡å­˜åœ¨æ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Ÿï¼‰"></a>5 Springäº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼ˆå¤šä¸ªäº‹åŠ¡å­˜åœ¨æ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Ÿï¼‰</h1><ul><li><p>equired(éœ€è¦)ï¼š é»˜è®¤å€¼ã€‚å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡åˆ™åŠ å…¥è¿™ä¸ªäº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡å°±æ–°åˆ›å»ºä¸€ä¸ªã€‚</p></li><li><p>supports(æ”¯æŒ)ï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¿™ä¸ªäº‹åŠ¡ï¼Œå¦åˆ™å°±ä»¥éäº‹åŠ¡çš„æ–¹å¼è¿è¡Œã€‚</p></li><li><p>Mandatory(å¿…é¡»ï¼Œå¼ºåˆ¶)ï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¿™ä¸ªäº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚</p></li><li><p>Requires_new: å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±å°†è¯¥äº‹åŠ¡æŒ‚èµ·ã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡æ¥è¿è¡Œã€‚</p></li><li><p>Not_supported: å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±å°†è¯¥äº‹åŠ¡æŒ‚èµ·ã€‚ä»¥éäº‹åŠ¡çš„æ–¹å¼è¿è¡Œã€‚</p></li><li><p>never:  å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ï¼Œä»¥éäº‹åŠ¡çš„æ–¹å¼è¿è¡Œã€‚</p></li><li><p>nested(åµŒå¥—)ï¼š  å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åˆ›å»ºä¸€ä¸ªäº‹åŠ¡å½“ä½œå½“å‰äº‹åŠ¡çš„åµŒå¥—äº‹åŠ¡æ¥è¿è¡Œï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±åˆ›å»ºä¸€ä¸ªäº‹åŠ¡ã€‚</p><p>(åŠ å…¥<em>3+ æŒ‚èµ·</em> * 2+ å¼‚å¸¸ * 1 + åµŒå¥—äº‹åŠ¡ *1 s)</p></li></ul><h1 id="6-Resourceå’Œ-Autowiredçš„åŒºåˆ«ï¼Ÿ"><a href="#6-Resourceå’Œ-Autowiredçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="6. @Resourceå’Œ@Autowiredçš„åŒºåˆ«ï¼Ÿ"></a>6. @Resourceå’Œ@Autowiredçš„åŒºåˆ«ï¼Ÿ</h1><ol><li>æ¥æºä¸åŒ</li></ol><p>@Autowired æ˜¯ Spring å®šä¹‰çš„æ³¨è§£ï¼Œè€Œ @Resource æ˜¯ JDK å®šä¹‰çš„æ³¨è§£ï¼Œ</p><ol start="2"><li>ä¾èµ–æŸ¥æ‰¾é¡ºåºä¸åŒ</li></ol><ul><li><p>@Autowired æ˜¯å…ˆæ ¹æ®ç±»å‹ï¼ˆbyTypeï¼‰æŸ¥æ‰¾ï¼Œå¦‚æœå­˜åœ¨å¤šä¸ª Bean å†æ ¹æ®åç§°ï¼ˆbyNameï¼‰è¿›è¡ŒæŸ¥æ‰¾ï¼Œï¼Œå¯ä»¥é€šè¿‡ <code>@Qualifier</code> æ³¨è§£æŒ‡å®šè¦æ³¨å…¥çš„ bean åç§°ã€‚</p></li><li><p>@Resource æ˜¯å…ˆæ ¹æ®åç§°æŸ¥æ‰¾ï¼Œå¦‚æœï¼ˆæ ¹æ®åç§°ï¼‰æŸ¥æ‰¾ä¸åˆ°ï¼Œå†æ ¹æ®ç±»å‹è¿›è¡ŒæŸ¥æ‰¾</p></li></ul><ol start="3"><li>ä¾èµ–æ³¨å…¥çš„ç”¨æ³•æ”¯æŒä¸åŒ</li></ol><ul><li>@Autowired æ—¢æ”¯æŒæ„é€ æ–¹æ³•æ³¨å…¥ï¼Œåˆæ”¯æŒå±æ€§æ³¨å…¥å’Œ Setter æ³¨å…¥</li><li>@Resource åªæ”¯æŒå±æ€§æ³¨å…¥å’Œ Setter æ³¨å…¥ï¼›</li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•´ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ­»é”</title>
    <link href="/%E6%AD%BB%E9%94%81/"/>
    <url>/%E6%AD%BB%E9%94%81/</url>
    
    <content type="html"><![CDATA[<h3 id="æ­»é”"><a href="#æ­»é”" class="headerlink" title="æ­»é”"></a>æ­»é”</h3><ul><li><p>å®šä¹‰ï¼šæ­»é”æ˜¯ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹äº’ç›¸éƒ½æŒæœ‰å¯¹æ–¹æ‰€éœ€è¦çš„èµ„æºï¼Œå¯¼è‡´è¿™äº›çº¿ç¨‹éƒ½å¤„äºç­‰å¾…çŠ¶æ€ã€‚</p></li><li><p>æ­»é”äº§ç”Ÿçš„æ¡ä»¶ï¼š</p><ul><li>äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºåªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹å ç”¨ã€‚</li><li>è¯·æ±‚å’Œä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚è¢«å ç”¨èµ„æºè€Œå‘ç”Ÿé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸å˜ã€‚</li><li>ä¸å‰¥å¤ºæ¡ä»¶ï¼šä»»ä½•ä¸€ä¸ªèµ„æºåœ¨æ²¡è¢«è¯¥è¿›ç¨‹é‡Šæ”¾ä¹‹å‰ï¼Œå…¶ä»–çº¿ç¨‹éƒ½æ— æ³•å¯¹ä»–å‰¥å¤ºå ç”¨ã€‚</li><li>å¾ªç¯ç­‰å¾…ï¼šå½“å‘ç”Ÿæ­»é”æ—¶ï¼Œæ‰€ç­‰å¾…çš„çº¿ç¨‹ä¼šè¿›å…¥ä¸€ä¸ªç±»ä¼¼æ­»å¾ªç¯ï¼Œé€ æˆé˜»å¡ã€‚</li></ul></li><li><p>å¦‚ä½•é¿å…</p><ul><li>è®¾ç½®åŠ é”é¡ºåºã€‚å½“å¤šä¸ªçº¿ç¨‹éœ€è¦ä¸€äº›ç›¸åŒçš„é”æ—¶ï¼ŒæŒ‰ç…§ä¸åŒçš„åŠ é”é¡ºåºå»åŠ é”ã€‚è¿™ç§éœ€è¦ä½ äº‹å…ˆçŸ¥é“æ‰€æœ‰çš„é”ï¼Œä½†æŸäº›æƒ…å†µæ˜¯æœªçŸ¥çš„ã€‚</li><li>è®¾ç½®åŠ é”æ—¶é™ã€‚å½“ä¸€ä¸ªçº¿ç¨‹åœ¨åˆ¶å®šæ—¶é™å†…æ²¡æœ‰è·å–åˆ°æ‰€éœ€è¦çš„é”ï¼Œåˆ™ä¼šé‡Šæ”¾å·²ç»è·å–åˆ°çš„é”ï¼Œç„¶åç­‰å¾…ä¸€æ®µæ—¶é—´å†é‡è¯•ã€‚</li></ul></li><li><p>æ­»é”æ£€æŸ¥</p></li><li><p>æ–¹å¼ä¸€ï¼šjps+jstack</p><ul><li>è¿è¡Œ<code>jps</code>ï¼ŒæŸ¥çœ‹å½“å‰æ‰€æœ‰javaè¿›ç¨‹çš„pid</li><li><code>jstack pid</code> æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„å †æ ˆçŠ¶æ€ï¼Œå¦‚æœæœ‰æ­»é”ä¼šæ‰“å°å‡ºæ¥found 1 deadLock</li></ul></li><li><p>æ–¹å¼äºŒï¼šjvisualvm</p><p>ä»£ç è¿è¡Œèµ·æ¥åï¼Œå¯åŠ¨jvisualvmï¼Œåœ¨çº¿ç¨‹é¡µé¢ä¼šç›´æ¥æœ‰ä¸€ä¸ªçº¢è‰²çš„æ˜¾ç¤ºï¼šç›‘æµ‹åˆ°æ­»é”</p></li><li><p>å‚è€ƒåœ°å€ï¼š<a href="https://pyr9.github.io/java%E5%91%BD%E4%BB%A4-jstack-%E5%B7%A5%E5%85%B7/">javaå‘½ä»¤â€“jstackçš„ä½¿ç”¨ - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•´ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NIO,BIO,AIO</title>
    <link href="/NIO-BIO-AIO/"/>
    <url>/NIO-BIO-AIO/</url>
    
    <content type="html"><![CDATA[<h3 id="1-BIOã€NIOã€AIOå®šä¹‰"><a href="#1-BIOã€NIOã€AIOå®šä¹‰" class="headerlink" title="1.BIOã€NIOã€AIOå®šä¹‰"></a>1.BIOã€NIOã€AIOå®šä¹‰</h3><p>Javaå…±æ”¯æŒ3ç§<a href="https://so.csdn.net/so/search?q=%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B&spm=1001.2101.3001.7020">ç½‘ç»œç¼–ç¨‹</a>æ¨¡å‹IOæ¨¡å¼</p><ul><li><p><strong>BIO</strong>ï¼š(blocking ioï¼‰åŒæ­¥å¹¶é˜»å¡ï¼ˆä¼ ç»Ÿé˜»å¡å‹ï¼‰ï¼ŒæœåŠ¡å™¨å®ç°æ¨¡å¼ä¸ºä¸€ä¸ªè¿æ¥ä¸€ä¸ªçº¿ç¨‹ï¼Œå³å®¢æˆ·ç«¯æœ‰è¿æ¥è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨å°±è¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œå¦‚æœè¿™ä¸ªé“¾æ¥ä¸åšä»»ä½•äº‹ï¼Œå°±å®¹æ˜“é€ æˆä¸å¿…è¦çš„çº¿ç¨‹å¼€é”€ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ <code>read()</code> æˆ– <code>write()</code> æ—¶ï¼Œè¯¥çº¿ç¨‹è¢«é˜»å¡ï¼Œç›´åˆ°æœ‰ä¸€äº›æ•°æ®è¢«è¯»å–ï¼Œæˆ–æ•°æ®å®Œå…¨å†™å…¥ã€‚è¯¥çº¿ç¨‹åœ¨æ­¤æœŸé—´ä¸èƒ½å†å¹²ä»»ä½•äº‹æƒ…äº†ã€‚</p></li><li><p><strong>NIO</strong>ï¼š(non blocking io æˆ– new io)å¼‚æ­¥éé˜»å¡ï¼ŒNIOç›¸å¯¹äºBIOæ¥è¯´å‡ºç°äº†å‡ ä¸ªæ ¸å¿ƒçš„ç»„ä»¶ï¼Œåˆ†åˆ«æ˜¯ Channleï¼ˆé€šé“ï¼‰ å’Œ Bufferï¼ˆç¼“å†²åŒºï¼‰ã€Selectorï¼ˆé€‰æ‹©å™¨ï¼‰  ã€‚NIOå‡ºç°äºJDK 1.4ä¹‹åã€‚</p><ul><li><p>Channelï¼šNIOçš„æ‰€æœ‰IOæ“ä½œéƒ½ä»Channlå¼€å§‹ï¼š </p><ul><li>ä»é€šé“è¿›è¡Œæ•°æ®è¯»å– ï¼šåˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œç„¶åè¯·æ±‚é€šé“è¯»å–æ•°æ®ã€‚</li><li>ä»é€šé“è¿›è¡Œæ•°æ®å†™å…¥ ï¼šåˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œå¡«å……æ•°æ®ï¼Œå¹¶è¦æ±‚é€šé“å†™å…¥æ•°æ®ã€‚</li></ul></li><li><p>Buffer: ç¼“å†²åŒºçš„å‡ºç°å¯¼è‡´äº†NIOå’ŒBIOçš„ä¸åŒï¼šè¯»æ•°æ®æ—¶å¯ä»¥å…ˆè¯»ä¸€éƒ¨åˆ†åˆ°ç¼“å†²åŒºä¸­ï¼Œç„¶åå¤„ç†å…¶ä»–äº‹æƒ…ï¼›å†™æ•°æ®æ—¶å¯ä»¥å…ˆå†™ä¸€éƒ¨åˆ†åˆ°ç¼“å†²åŒºä¸­ï¼Œç„¶åå¤„ç†å…¶ä»–äº‹æƒ…ã€‚è¯»å’Œå†™æ“ä½œå¯ä»¥ä¸å†æŒç»­ï¼Œæ‰€ä»¥ä¸ä¼šé˜»å¡ã€‚å½“ç¼“å†²åŒºæ»¡åæ‰ä¼šå°†å…¶æ”¾å…¥çœŸæ­£åœ°è¯»&#x2F;å†™ã€‚</p></li></ul></li><li><p><strong>Selector</strong>ï¼šé€‰æ‹©å™¨å¯ä»¥è®©å•ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªé€šé“ï¼Œè¾¾åˆ°å¤ç”¨çš„ç›®çš„ã€‚</p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h57mhubk5zj210y0u0acq.jpg" style="zoom:50%;" /></li><li><p><strong>AIO</strong>:å¼‚æ­¥éé˜»å¡ï¼šAIOå‡ºç°äºJDK 1.7ï¼Œæ˜¯NIOçš„æ”¹è¿›ç‰ˆã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ç”±æ“ä½œç³»ç»Ÿå®Œæˆåï¼Œæ‰é€šçŸ¥æœåŠ¡å™¨å¯åŠ¨çº¿ç¨‹å»å¤„ç†ã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œçŸ¥è¯†ç‚¹æ•´ç†</title>
    <link href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-getå’Œpostçš„åŒºåˆ«"><a href="#1-getå’Œpostçš„åŒºåˆ«" class="headerlink" title="1. getå’Œpostçš„åŒºåˆ«"></a>1. getå’Œpostçš„åŒºåˆ«</h1><ul><li>è¡¨ç°å½¢å¼<ul><li>get è¯·æ±‚çš„æ•°æ®ä¼šé™„åœ¨urlä¹‹åï¼Œä»¥ï¼Ÿå½¢å¼åˆ†å‰²URLå’Œä¼ è¾“çš„æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥&amp;è¿æ¥ã€‚</li><li>postè¯·æ±‚çš„æ•°æ®æ˜¯æäº¤åœ¨HTTPçš„åŒ…ä½“ä¸­ã€‚</li></ul></li><li>å¯¹æ•°æ®é•¿åº¦çš„é™åˆ¶<ul><li>getæ˜¯é€šè¿‡URlæäº¤æ•°æ®ï¼Œæ‰€ä»¥ä»–çš„é•¿åº¦å—æµè§ˆå™¨çš„é™åˆ¶</li><li>postæ˜¯æ²¡æœ‰æ•°æ®é•¿åº¦çš„é™åˆ¶çš„ï¼Œèµ·é™åˆ¶ä½œç”¨çš„æ˜¯ï¼šæœåŠ¡å™¨çš„å¤„ç†èƒ½åŠ›ã€‚</li></ul></li><li>å®‰å…¨æ€§<ul><li>ä¸postç›¸æ¯”ï¼ŒGetå®‰å…¨æ€§è¾ƒå·®ã€‚getæäº¤æ•°æ®çš„æ—¶å€™ï¼Œç”¨æˆ·åå’Œå¯†ç éƒ½ä¼šæ˜æ–‡çš„å‡ºç°åœ¨URLä¸Šã€‚å› ä¸ºç™»å½•é¡µé¢æœ‰å¯èƒ½è¢«æµè§ˆå™¨ç¼“å­˜ï¼Œæ‰€ä»¥å…¶ä»–äººæŸ¥çœ‹æµè§ˆå™¨çš„è®°å½•ï¼Œå°±å¯ä»¥æ‹¿åˆ°ä½ çš„è´¦æˆ·å¯†ç äº†ã€‚</li><li>postå‚æ•°ä¸ä¼šä¿ç•™åœ¨æµè§ˆå™¨å†å²ä¸­ã€‚</li></ul></li></ul><h1 id="2-httpçš„å¸¸ç”¨æ–¹æ³•"><a href="#2-httpçš„å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2. httpçš„å¸¸ç”¨æ–¹æ³•"></a>2. httpçš„å¸¸ç”¨æ–¹æ³•</h1><ul><li>Get: ä½¿ç”¨ç»™å®šçš„URLè¯·æ±‚èµ„æº</li><li>postï¼šå°†æ•°æ®å‘é€åˆ°æœåŠ¡å™¨ï¼Œç”¨æ¥åˆ›å»ºæˆ–è€…æ›´æ–°èµ„æº</li><li>head: è·å–æŠ¥æ–‡é¦–éƒ¨</li><li>Put: ä¼ è¾“æ•°æ®ï¼Œä¸postä¸åŒçš„æ˜¯ï¼Œä»–åˆ¶å®šäº†èµ„æºçš„å­˜æ”¾ä½ç½®ï¼Œpostæ˜¯ç”±æœåŠ¡å™¨è‡ªå·±å†³å®šã€‚</li><li>Delete: åˆ é™¤æ–‡ä»¶</li><li>trace: è¿½è¸ªè·¯å¾„</li><li>permissionï¼šè®¿é—®æ”¯æŒçš„æ–¹æ³•ã€‚</li></ul><h1 id="3-TCPå’ŒUDPçš„åŒºåˆ«ä¸è”ç³»"><a href="#3-TCPå’ŒUDPçš„åŒºåˆ«ä¸è”ç³»" class="headerlink" title="3. TCPå’ŒUDPçš„åŒºåˆ«ä¸è”ç³»"></a>3. TCPå’ŒUDPçš„åŒºåˆ«ä¸è”ç³»</h1><ul><li><p>ç›¸åŒç‚¹ï¼šéƒ½æ˜¯åŸºäºIPåè®®çš„ä¼ è¾“åè®®ã€‚</p></li><li><p>ä¸åŒç‚¹ï¼š</p><ul><li><p>TCP: é¢å‘è¿æ¥ï¼Œä¼ è¾“é€Ÿåº¦æ…¢ï¼Œå¯é æ€§é«˜ï¼ˆTCPåœ¨ä¼ è¾“æ•°æ®ä¹‹å‰ï¼Œéƒ½ä¼šé€šè¿‡ä¸‰æ¬¡æ¡æ‰‹æ¥å»ºç«‹è¿æ¥ï¼‰ï¼Œä¿è¯æ•°æ®çš„å‡†ç¡®æ€§ï¼Œé¢å‘å­—èŠ‚æµ</p></li><li><p>UDP: é¢å‘æ— è¿æ¥ï¼Œä¼ è¾“é€Ÿåº¦å¿«ï¼Œå¯é æ€§ä½ï¼ˆå°½æœ€å¤§å¯èƒ½äº¤ä»˜ï¼Œå¦‚æœç½‘ç»œè´¨é‡ä¸å¥½ï¼Œå°±å¯èƒ½ä¸¢åŒ…ï¼‰ï¼Œé¢å‘æŠ¥æ–‡</p></li></ul></li><li><p>ä½¿ç”¨åœºæ™¯ï¼š</p><ul><li>TCPï¼šå¯¹é€šä¿¡è´¨é‡æœ‰è¦æ±‚çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼šHttpã€httpsã€FTPç­‰ä¼ è¾“æ–‡ä»¶çš„åè®®ï¼ŒSMTPç­‰ä¼ è¾“é‚®ä»¶çš„åè®®ã€‚kafkaä¸­æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„é€šä¿¡ã€‚</li><li>UDP: é€šä¿¡è´¨é‡è¦æ±‚ä¸é«˜ï¼Œä½†æ˜¯è¦æ±‚ç½‘ç»œé€šè®¯é€Ÿåº¦å°½å¯èƒ½å¿«ï¼Œæ¯”å¦‚ï¼šQQè¯­éŸ³ï¼ŒQQè§†é¢‘</li></ul></li><li><p>TCPå­˜åœ¨æ‹†åŒ…ï¼Œç²˜åŒ…é—®é¢˜ã€‚å› ä¸ºä»–æ˜¯é¢å‘å­—èŠ‚æµçš„ï¼Œä¸å‘UDPé‚£æ ·é¦–éƒ¨æœ‰æ•°æ®é•¿åº¦ï¼Œè€Œå‘é€æ•°æ®ï¼Œæ˜¯ç¼“å†²åŒºæ»¡æ‰ä¼šå‘é€ï¼Œå®¹æ˜“é€ æˆç²˜åŒ…ã€‚æ¥å—æ•°æ®ï¼Œæ˜¯ç¼“å†²åŒºæ»¡äº†ï¼Œæ‰ä¼šæ¥å—ï¼Œæ¥å—æ—¶ä¹Ÿä¼šé€ æˆç²˜åŒ…ã€‚</p><ul><li>è§£å†³æ‹†åŒ…å’Œç²˜åŒ…é—®é¢˜çš„æ–¹å¼ï¼š<ul><li>å‘é€ç«¯ç»™æ•°æ®åŠ é¦–éƒ¨</li><li>è®¾ç½®æ•°æ®åŒ…ä¸ºåˆ¶å®šé•¿åº¦ï¼Œä¸å¤Ÿç”¨ç©ºæ ¼æ¥è¡¥</li><li>ç»™æ•°æ®åŠ åˆ†ç•Œæ ‡è®°</li></ul></li></ul></li></ul><h1 id="4-HTTPçš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥"><a href="#4-HTTPçš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥" class="headerlink" title="4. HTTPçš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥"></a>4. HTTPçš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥</h1><ul><li>httpçš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥æœ¬è´¨ä¸Šå°±æ˜¯ï¼šTcpçš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥</li><li>åœ¨http1.0 ä¸­é»˜è®¤ä½¿ç”¨çŸ­è¿æ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ¯è¿›è¡Œä¸€æ¬¡HTTPæ“ä½œï¼Œå°±å»ºç«‹ä¸€æ¬¡çŸ­è¿æ¥ï¼Œä»»åŠ¡ç»“æŸå°±ä¸­æ–­ã€‚ä»HTTP1.0 èµ·ï¼Œé»˜è®¤ä½¿ç”¨é•¿è¿æ¥ï¼Œå½“ä¸€ä¸ªç½‘é¡µæ‰“å¼€å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨æˆ·ä¼ è¾“HTTPæ•°æ®çš„TCPè¿æ¥å°±ä¸ä¼šå…³é—­ï¼Œå®¢æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨ï¼Œä¼šä½¿ç”¨è¿™ä¸€æ¡å·²ç»å»ºç«‹çš„è¿æ¥ã€‚å¯ä»¥è®¾ç½®è¿™ä¸ªä¿æŒæ—¶é—´ã€‚</li><li>é€šè¿‡å¿ƒè·³æœºåˆ¶ç»´æŠ¤é•¿è¿æ¥ï¼Œå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªå¿ƒè·³ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ç»™å®¢æˆ·ä¸€ä¸ªå¿ƒè·³åº”ç­”ï¼Œè¿™æ ·åŒæ–¹å°±å¯ä»¥çŸ¥é“ä»–ä»¬çš„è¿æ¥æ²¡æœ‰æ–­å¼€ã€‚</li></ul><p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p><ul><li>é•¿è¿æ¥ï¼šå¤šç”¨äºæ“ä½œé¢‘ç¹ï¼Œç‚¹å¯¹ç‚¹çš„é€šè®¯ã€‚</li><li>çŸ­è¿æ¥ï¼šwebç½‘ç«™çš„HttpæœåŠ¡ä¸€èˆ¬éƒ½ä½¿ç”¨çŸ­è¿æ¥ï¼Œå› ä¸ºé•¿è¿æ¥æ¯”è¾ƒè€—è´¹èµ„æºã€‚</li></ul><h1 id="5-HTTPå’ŒHTTPsçš„åŒºåˆ«"><a href="#5-HTTPå’ŒHTTPsçš„åŒºåˆ«" class="headerlink" title="5. HTTPå’ŒHTTPsçš„åŒºåˆ«"></a>5. HTTPå’ŒHTTPsçš„åŒºåˆ«</h1><ul><li><p>Httpæ˜æ–‡ä¼ è¾“ï¼Œæ•°æ®éƒ½æ˜¯æœªåŠ å¯†çš„ï¼Œå®‰å…¨æ€§æ¯”è¾ƒå·®ï¼Œhttpsï¼ˆssl+httpï¼‰ä¼ è¾“è¿‡ç¨‹æ˜¯åŠ å¯†çš„ï¼Œå®‰å…¨æ€§è¾ƒå¥½ï¼Œé‡‡ç”¨æ··åˆåŠ å¯†ç®—æ³•ã€‚</p></li><li><p>Httpä½¿ç”¨80ç«¯å£ï¼Œhttpsä½¿ç”¨çš„æ˜¯443ç«¯å£</p></li><li><p>httpsåè®®éœ€è¦åˆ°CAï¼ˆCertificate Authorityï¼Œæ•°å­—è¯ä¹¦è®¤è¯æœºæ„ï¼‰å»ç”³è¯·è¯ä¹¦ï¼Œä¸€èˆ¬å…è´¹è¯ä¹¦æ¯”è¾ƒå°‘ï¼Œéœ€è¦ä¸€å®šçš„è´¹ç”¨ã€‚</p></li><li><p>httpsé™¤äº†TCPè¿æ¥å“åº”å¤–ï¼Œè¿˜è¦è¿›è¡ŒSSLé€šä¿¡ï¼Œæ‰€ä»¥é€šä¿¡é€Ÿç‡è¾ƒä½ä¸”ç”±äºåŠ å¯†è§£å¯†ï¼Œä¹Ÿä¼šæ¶ˆè€—æ›´å¤šçš„æœåŠ¡å™¨èµ„æºã€‚</p><blockquote><ul><li><p>SSLæ˜¯ç‹¬ç«‹ä¸TCPçš„åè®®ï¼Œä»–ä¹Ÿå¯ç”¨æ¥å¯¹å…¶ä»–åè®®çš„åŠ å¯†</p></li><li><p>Https å…¶å®å°±æ˜¯åœ¨HTTPåè®®çš„åŸºç¡€ä¸ŠåŠ äº†ï¼šé€šä¿¡åŠ å¯†ï¼Œè¯ä¹¦è®¤è¯ï¼ŒæŠ¥æ–‡å®Œæ•´æ€§ä¿æŠ¤ï¼Œä»–åœ¨æ‰€ä»¥HTTPSè¦æ¯”HTTPæ›´åŠ è€—è´¹èµ„æºã€‚</p></li></ul></blockquote></li></ul><h1 id="6-åŠ å¯†æ–¹å¼"><a href="#6-åŠ å¯†æ–¹å¼" class="headerlink" title="6 åŠ å¯†æ–¹å¼"></a>6 åŠ å¯†æ–¹å¼</h1><h4 id="å¯¹ç§°åŠ å¯†ï¼š"><a href="#å¯¹ç§°åŠ å¯†ï¼š" class="headerlink" title="å¯¹ç§°åŠ å¯†ï¼š"></a>å¯¹ç§°åŠ å¯†ï¼š</h4><ul><li>å®šä¹‰ï¼šæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯éƒ½æ‹¥æœ‰ä¸€æŠŠç›¸åŒçš„é’¥åŒ™ï¼Œå¯¹æŠ¥æ–‡çš„åŠ å¯†å’Œè§£å¯†éƒ½ç”¨çš„æ˜¯è¿™æŠŠé’¥åŒ™ã€‚</li><li>æµç¨‹ï¼šåˆšå¼€å§‹çš„æ—¶å€™Bæ²¡æœ‰é’¥åŒ™ï¼ŒAæœ‰ï¼Œé‚£Aéœ€è¦å°†é’¥åŒ™å‘ç»™Bï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸€æ—¦é’¥åŒ™è¢«æ”»å‡»è€…Xè·å–åˆ°ï¼ŒåŠ å¯†å°±å¤±äº†æ„ä¹‰ã€‚</li></ul><h4 id="éå¯¹ç§°åŠ å¯†"><a href="#éå¯¹ç§°åŠ å¯†" class="headerlink" title="éå¯¹ç§°åŠ å¯†"></a>éå¯¹ç§°åŠ å¯†</h4><ul><li>å®šä¹‰ï¼šä¸€æŠŠå…±æœ‰å¯†é’¥ï¼Œä¸€æŠŠç§æœ‰å¯†é’¥ã€‚å…¬æœ‰å¯†é’¥æ˜¯å…¬å¼€çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å–ï¼Œç§æœ‰çš„ä¸å…¬å¼€ã€‚å‘é€æ–¹ç”¨å…¬æœ‰å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œæ¥å—æ–¹ç”¨ç§æœ‰å¯†é’¥è§£å¯†ã€‚</li><li>æµç¨‹ï¼šåˆšå¼€å§‹çš„æ—¶å€™Aæ‹¥æœ‰ä¸€æŠŠç§æœ‰å¯†é’¥å’Œä¸€æŠŠå…¬æœ‰å…¬é’¥ï¼ŒBæ²¡æœ‰å…¬é’¥åŒ™ï¼ŒAå°†å…¬é’¥å‘ç»™Bï¼Œå†å°†é€šè¿‡ç§æœ‰å¯†é’¥åŠ å¯†åçš„å†…å®¹å‘ç»™Bï¼Œå³ä½¿æ”»å‡»è€…çªƒå–ä¹Ÿåªèƒ½æ‹¿åˆ°å…¬é’¥å’ŒåŠ å¯†åçš„æ˜æ–‡ï¼Œæ‰€ä»¥æ¯”è¾ƒå®‰å…¨ï¼Œä½†æ˜¯æ€§èƒ½æ¯”è¾ƒä½ã€‚</li></ul><h4 id="æ··åˆåŠ å¯†"><a href="#æ··åˆåŠ å¯†" class="headerlink" title="æ··åˆåŠ å¯†"></a>æ··åˆåŠ å¯†</h4><ul><li>httpé¦–å…ˆé€šè¿‡éå¯¹ç§°åŠ å¯†æ¥å¯¹å¯¹ç§°å¯†é’¥åŠ å¯†ï¼Œå½“å¯¹ç§°å¯†é’¥å®‰å…¨ä¼ è¾“åï¼ŒåŒæ–¹åˆ™é‡‡å–å¯¹ç§°å¯†é’¥çš„æ–¹å¼æ¥è¿›è¡Œä¼ è¾“ã€‚</li></ul><h1 id="7-cookie-å’Œsession-çš„åŒºåˆ«å’Œè”ç³»"><a href="#7-cookie-å’Œsession-çš„åŒºåˆ«å’Œè”ç³»" class="headerlink" title="7 cookie å’Œsession çš„åŒºåˆ«å’Œè”ç³»"></a>7 cookie å’Œsession çš„åŒºåˆ«å’Œè”ç³»</h1><ul><li>sessionæ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯çš„ï¼Œcookieæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯çš„ã€‚</li><li>cookieä¸æ˜¯å¾ˆå®‰å…¨ï¼Œå› ä¸ºåˆ«äººå¯ä»¥åˆ†æä½ å­˜æ”¾åœ¨æœ¬åœ°çš„cookieè¿›è¡Œcookieæ¬ºéª—ï¼Œè€ƒè™‘åˆ°å®‰å…¨åº”è¯¥æ”¾åˆ°sessionã€‚</li><li>ç”±äºsessionå­˜æ”¾åœ¨æœåŠ¡å™¨ä¸Šï¼Œæ‰€ä»¥å½“è®¿é—®å¢å¤šçš„æ—¶å€™ï¼Œä¼šæ¯”è¾ƒå ç”¨æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œè€ƒè™‘åˆ°æœåŠ¡å™¨æ€§èƒ½ï¼Œ</li><li>sessionä¸€èˆ¬æ˜¯é€šè¿‡cookieæ¥å®ç°ä¼šè¯è·Ÿè¸ªçš„ã€‚ç¬¬ä¸€æ¬¡åˆ›å»ºsessionçš„æ—¶å€™ï¼ŒæœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ç«¯éœ€è¦åœ¨cookieé‡Œè®°å½•ä¸€ä¸ªsession_id&#x3D;XXï¼Œä¹‹åå®¢æˆ·ç«¯é€šè¿‡httpè¯·æ±‚æ¥è®¿é—®æœåŠ¡ç«¯çš„æ—¶å€™ï¼Œéƒ½åœ¨è¯·æ±‚é‡Œå¸¦ä¸Šè¿™ä¸ªsession_idï¼Œå°±å¯ä»¥å‘Šè¯‰æœåŠ¡å™¨æˆ‘æ˜¯è°äº†ã€‚å¦‚æœå®¢æˆ·ç«¯ç¦ç”¨cookieï¼Œå°±éœ€è¦é€šè¿‡urlé‡å†™çš„æ–¹å¼æ¥è®°å½•ï¼Œå°±æ˜¯URLä¸Šé™„åŠ ä¸€ä¸ªsid&#x3D;XXXï¼Œè¿™æ ·æœåŠ¡å™¨å°±çŸ¥é“ä½ æ˜¯è°äº†ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•´ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸‰æ¬¡æ¡æ‰‹</title>
    <link href="/%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B/"/>
    <url>/%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸‰æ¬¡æ¡æ‰‹</h1><ol><li><p>å®šä¹‰ï¼šä¸‰æ¬¡æ¡æ‰‹ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„ä¸‰æ¬¡é€šä¿¡</p></li><li><p>æµç¨‹ï¼š</p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h57al19dnpj211a0u077e.jpg" style="zoom:50%;" /></li></ol><ul><li>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå»ºç«‹è¿æ¥ã€‚å®¢æˆ·ç«¯å‘é€è¯·æ±‚è¿æ¥æŠ¥æ–‡æ®µï¼Œç„¶åå®¢æˆ·ç«¯è¿›å…¥SYN_SENDï¼ˆè¿æ¥è¯·æ±‚ï¼‰çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯çš„ç¡®è®¤ã€‚</li><li>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„SYNæŠ¥æ–‡æ®µï¼Œå¯¹è¿™ä¸ªæŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤ï¼ŒåŒæ—¶ï¼Œè‡ªå·±è¿˜è¦å‘é€è¯·æ±‚å»ºç«‹è¿æ¥ä¿¡æ¯ï¼ŒæœåŠ¡ç«¯è¦å°†æ‰€æœ‰çš„ä¿¡æ¯æ”¾åˆ°ä¸€ä¸ªæŠ¥æ–‡æ®µï¼ˆå³SYN+ACKæŠ¥æ–‡æ®µï¼‰ä¸­ï¼Œä¸€å¹¶å‘é€ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶æœåŠ¡ç«¯è¿›å…¥SYN_RCVDï¼ˆæ¥å—è¯·æ±‚ï¼‰çŠ¶æ€ã€‚</li><li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„SYN+ACKæŠ¥æ–‡æ®µã€‚å‘æœåŠ¡ç«¯å‘é€ACKæŠ¥æ–‡æ®µï¼Œè¿™ä¸ªæŠ¥æ–‡æ®µå‘é€å®Œæ¯•åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½è¿›å…¥ESTABLISHçŠ¶æ€ï¼Œå®ŒæˆTCPä¸‰æ¬¡æ¡æ‰‹ã€‚</li></ul><ol start="3"><li>ä¸ºä»€ä¹ˆè¦è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</li></ol><p>ä¸‰æ¬¡æ¡æ‰‹çš„ç›®çš„å°±æ˜¯ï¼šå»ºç«‹å¯é çš„é€šä¿¡æ¸ é“ã€‚ç¡®è®¤åŒæ–¹çš„å‘é€å’Œæ¥æ”¶éƒ½æ˜¯æ­£å¸¸çš„ã€‚</p><ul><li>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯ä»€ä¹ˆéƒ½ä¸èƒ½ç¡®è®¤ï¼ŒæœåŠ¡ç«¯èƒ½ç¡®è®¤å®¢æˆ·ç«¯å‘é€æ•°æ®æ˜¯æ­£å¸¸çš„ï¼Œè‡ªå·±æ¥å—æ•°æ®æ­£å¸¸çš„ã€‚</li><li>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å¯ä»¥ç¡®è®¤è‡ªå·±ï¼šæ¥å—å’Œå‘é€æ•°æ®éƒ½æ˜¯æ­£å¸¸çš„ï¼Œ æœåŠ¡ç«¯å‘é€æ•°æ®ï¼Œæ¥å—æ•°æ®æ˜¯æ­£å¸¸çš„ã€‚</li><li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯å¯ä»¥ç¡®è®¤è‡ªå·±å‘é€å’Œæ¥å—æ­£å¸¸ï¼Œå®¢æˆ·ç«¯å‘é€å’Œæ¥å—æ­£å¸¸ã€‚</li></ul><p>å‡è®¾ä¸è€ƒè™‘ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¼šå‡ºç°çš„ä¸€ç§æƒ…å†µæ˜¯ï¼š</p><p>å·²ç»å®æ•ˆçš„æŠ¥æ–‡æ®µçªç„¶ä¼ é€åˆ°äº†ä¸»æœºBï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚</p><p>è€ƒè™‘è¿™æ ·ä¸€ç§æƒ…å†µï¼šå½“Aå‘é€è¿æ¥è¯·æ±‚ï¼Œä½†å› è¿æ¥è¯·æ±‚æŠ¥æ–‡ä¸¢å¤±è€Œæœªæ”¶åˆ°ç¡®è®¤ã€‚äºæ˜¯Aå†é‡ä¼ ä¸€æ¬¡ã€‚ç¬¬äºŒä¸ªæŠ¥æ–‡æ®µåˆ°è¾¾äº†ä¸»æœºBï¼Œæ”¶åˆ°äº†ç¡®è®¤ï¼Œå»ºç«‹äº†è¿æ¥ã€‚ä¼ è¾“å®Œæ¯•åï¼Œå°±é‡Šæ”¾è¿æ¥ã€‚       </p><p>   ç°å‡å®šå‡ºç°å¦ä¸€ç§æƒ…å†µï¼šAå‘é€çš„ç¬¬ä¸€ä¸ªè¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸäº›ç½‘ç‚¹æ»ç•™æ—¶é—´å¤ªé•¿ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿™æ¬¡çš„è¿æ¥é‡Šæ”¾åæ‰åˆ°å¤§ä¸»æœºBï¼Œæœ¬æ¥è¿™å·²ç»æ˜¯ä¸€ä¸ªå·²ç»å¤±æ•ˆçš„æŠ¥æ–‡æ®µï¼Œä½†ä¸»æœºBæ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ®µï¼Œå´è¯¯è®¤ä¸ºä¸»æœºAåˆå‘é€äº†ä¸€æ¬¡æ–°çš„è¯·æ±‚ï¼Œäºæ˜¯å‘Aå‘é€ç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚</p><p>  ä¸»æœºAå¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¿æ¥ï¼Œå› æ­¤ä¸ä¼šç†ç¬ä¸»æœºBçš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘ä¸»æœºBå‘é€æ•°æ®ï¼Œä½†ä¸»æœºBå´ä»¥ä¸ºè¿æ¥å·²ç»å»ºç«‹ï¼Œå¹¶ä¸”ä¸€ç›´ç­‰å¾…ä¸»æœºAå‘é€æ•°æ®ï¼Œäºæ˜¯ä¸»æœºBçš„è®¸å¤šèµ„æºå°±è¿™æ ·è¢«æµªè´¹äº†ã€‚</p><p>   è€Œå¦‚æœé‡‡ç”¨äº†ä¸‰æ¬¡è¿æ¥å°±å¯ä»¥é˜²æ­¢ä»¥ä¸Šç°è±¡çš„å‘ç”Ÿã€‚ä¾‹å¦‚åœ¨åˆšæ‰çš„æƒ…å†µä¸‹ï¼Œä¸»æœºAä¸ä¼šå†å‘ä¸»æœºBçš„ç¡®è®¤å‘é€ç¡®è®¤ã€‚ä¸»æœºBæ”¶ä¸åˆ°ç¡®è®¤ï¼Œå°±å»ºç«‹ä¸äº†è¿æ¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>TCP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å››æ¬¡æŒ¥æ‰‹</title>
    <link href="/%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/"/>
    <url>/%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="å››æ¬¡æŒ¥æ‰‹"><a href="#å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="å››æ¬¡æŒ¥æ‰‹"></a>å››æ¬¡æŒ¥æ‰‹</h1><ol><li><p>å®šä¹‰ï¼šå››æ¬¡æŒ¥æ‰‹å°±æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯é‡Šæ”¾è¿æ¥æ—¶çš„å››ä¸ªæ­¥éª¤ã€‚</p></li><li><p>äº§ç”ŸåŸå› ï¼šTCPè¿æ¥æ˜¯å…¨åŒå·¥çš„ï¼Œå› æ­¤æ¯ä¸ªæ–¹å‘éƒ½éœ€è¦å•ç‹¬å…³é—­ï¼Œä¸€æ–¹å‘é€FINåªè¡¨ç¤ºè‡ªå·±å‘å®Œäº†è¦å‘é€çš„æ•°æ®ã€‚</p></li><li><p>æµç¨‹ï¼š</p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h578ibfbfnj20yk0qeq6p.jpg" style="zoom:50%;" /><ol><li><p>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šå½“å®¢æˆ·ç«¯ä¸å†å‘æœåŠ¡ç«¯å‘é€æ•°æ®äº†ã€‚å®¢æˆ·ç«¯å…ˆå‘TCPå‘å‡ºè¿æ¥é‡Šæ”¾è¯·æ±‚ï¼ŒTCPé€šçŸ¥æœåŠ¡ç«¯éœ€è¦é‡Šæ”¾ä»å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„è¿™ä¸ªè¿æ¥ï¼Œå®¢æˆ·ç«¯è¿›å…¥FIN_WAIT-1 ï¼ˆç»ˆæ­¢ç­‰å¾…çŠ¶æ€ï¼‰ã€‚</p></li><li><p>ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šæœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„é‡Šæ”¾è¿æ¥è¯·æ±‚åï¼Œç«‹å³é‡Šæ”¾è¿æ¥ã€‚è¿™æ ·å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„è¿æ¥å°±é‡Šæ”¾äº†ï¼ŒæœåŠ¡ç«¯è¿›å…¥CLOSE_WAITï¼ˆåŠå…³é—­çŠ¶æ€ï¼‰ã€‚ç›¸å½“äºå®¢æˆ·ç«¯å¯¹æœåŠ¡ç«¯è¯´ï¼šæˆ‘å·²ç»å‘å®Œäº†æˆ‘è¦å‘çš„æ•°æ®ï¼Œä½†ä»ç„¶å¯ä»¥æ¥æ”¶ä½ å‘çš„æ•°æ®ã€‚</p></li><li><p>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šå½“æœåŠ¡ç«¯ä¸å†å‘å®¢æˆ·ç«¯å‘é€æ•°æ®äº†ã€‚æœåŠ¡ç«¯å…ˆå‘TCPå‘å‡ºè¿æ¥é‡Šæ”¾è¯·æ±‚ï¼ŒTCPé€šçŸ¥å®¢æˆ·ç«¯éœ€è¦é‡Šæ”¾ä»æœåŠ¡ç«¯åˆ°å®¢æˆ·ç«¯çš„è¿™ä¸ªè¿æ¥ï¼ŒæœåŠ¡ç«¯è¿›å…¥LAST_WAITï¼ˆæœ€åç¡®è®¤çŠ¶æ€ï¼‰ã€‚</p></li><li><p>ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„é‡Šæ”¾è¯·æ±‚åï¼Œè¿›å…¥2MSLï¼ˆä¸€ä¸ªæŠ¥æ–‡çš„æ¥å›æ—¶é—´ï¼‰çš„TIME_WAITï¼ˆæ—¶é—´ç­‰å¾…ï¼‰çŠ¶æ€ï¼Œæ¥ç€å‘é€ä¸€ä¸ªACKç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯è¿›å…¥CLOSEï¼ˆå…³é—­çŠ¶æ€ï¼‰æ•´ä¸ªè¿æ¥å…¨éƒ¨é‡Šæ”¾ã€‚å®¢æˆ·ç«¯åœ¨2MSLçš„TIME_WAITåè¿›å…¥CLOSEçŠ¶æ€ã€‚</p></li></ol></li></ol><p><strong>ä»¥ä¸Šé‡Šæ”¾è¿‡ç¨‹æ˜¯4æ¬¡è”ç»œï¼Œä¹Ÿå¯ä»¥çœ‹æˆ2ä¸ª2æ¬¡è”ç»œã€‚</strong></p><ol start="4"><li><p>TIME_WAITçš„çŠ¶æ€å¿…é¡»ç­‰å¾…2MSLçš„åŸå› ï¼Ÿ</p><ul><li><p>ä¿è¯å½“å®¢æˆ·ç«¯æœ€åä¸€ä¸ªACKä¸¢å¤±åï¼Œèƒ½æ”¶åˆ°æœåŠ¡ç«¯é‡ä¼ çš„FINåŒ…ã€‚è¿™ä¸ªACKæŠ¥æ–‡æ®µå¯èƒ½ä¸¢å¤±ï¼Œå› è€Œå¤„äºLAST_ACKçŠ¶æ€çš„Bå¯èƒ½æ”¶ä¸åˆ°å¯¹å·²å‘é€çš„FIN+ACKæŠ¥æ–‡æ®µçš„ç¡®è®¤ï¼ŒæœåŠ¡ç«¯ä¼šè¶…æ—¶é‡ä¼ è¿™ä¸ªæŠ¥æ–‡æ®µï¼Œåˆ™å®¢æˆ·ç«¯å°±å¯ä»¥åœ¨2MSLè¿™ä¸ªæ—¶é—´å†…æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„FIN+ACKæŠ¥æ–‡æ®µã€‚æ¥ç€å®¢æˆ·ç«¯ä¼šé‡ä¼ ä¸€æ¬¡ç¡®è®¤ï¼Œç„¶åå¯åŠ¨2MSLè®¡æ—¶å™¨ã€‚</p></li><li><p>å¦‚æœå®¢æˆ·ç«¯åœ¨TIME_WAITè¿™ä¸ªçŠ¶æ€ä¸ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œè€Œæ˜¯åœ¨å‘é€ACKæŠ¥æ–‡æ®µåç«‹å³é‡Šæ”¾è¿æ¥ï¼Œé‚£ä¹ˆå°±æ— æ³•æ”¶åˆ°æœåŠ¡ç«¯é‡ä¼ çš„FIN+ACKæŠ¥æ–‡æ®µï¼Œå› è€Œä¹Ÿä¸ä¼šå†å‘é€ä¸€æ¬¡ç¡®è®¤æŠ¥æ–‡æ®µï¼ŒBåˆ™æ— æ³•æŒ‰æ­£å¸¸æ­¥éª¤è¿›å…¥CLOSEDçŠ¶æ€ã€‚ï¼ˆæ³¨ï¼šTIME_WAITçŠ¶æ€ä¸€èˆ¬ç»´æŒåœ¨1-4åˆ†é’Ÿï¼‰</p></li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>TCP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŠ¨æ€ä»£ç†çš„å®ç°æ–¹å¼</title>
    <link href="/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/"/>
    <url>/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<p>User_setting çš„è¡¨ç»“æ„(last_visted_project_id)+ åˆ‡é¢(el-&gt; app -&gt;) </p><p>åŠ¨æ€ä»£ç†ï¼š c g li b+ jdk</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">InvocationHandler</span> ï¼š è¯¥ç±»å¿…é¡»æœ‰æ¥å£<br></code></pre></td></tr></table></figure><p> c g li bï¼šEnhancer ï¼šæ˜¯åŸºäº<strong>çˆ¶å­ç±»</strong>çš„ï¼Œè¢«ä»£ç†ç±»ï¼ˆUserServiceï¼‰æ˜¯çˆ¶ç±»ï¼Œä»£ </p><p>ç†ç±»æ˜¯å­ç±»ï¼Œä»£ç†å¯¹è±¡å°±æ˜¯ä»£ç†ç±»çš„å®ä¾‹å¯¹è±¡</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">invoke</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Kafka æŒä¹…åŒ–</title>
    <link href="/Kafka%20%E6%8C%81%E4%B9%85%E5%8C%96/"/>
    <url>/Kafka%20%E6%8C%81%E4%B9%85%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Kafka-æŒä¹…åŒ–"><a href="#1-Kafka-æŒä¹…åŒ–" class="headerlink" title="1 Kafka æŒä¹…åŒ–"></a>1 Kafka æŒä¹…åŒ–</h1><ul><li>æ¯ä¸ª Topic å°†æ¶ˆæ¯åˆ†æˆå¤š Partitionï¼Œæ¯ä¸ª Partition åœ¨å­˜å‚¨å±‚é¢æ˜¯ append log æ–‡ä»¶ã€‚</li><li>ä»»ä½•å‘å¸ƒåˆ°æ­¤ Partition çš„æ¶ˆæ¯éƒ½ä¼šè¢«ç›´æ¥è¿½åŠ åˆ° log æ–‡ä»¶çš„å°¾éƒ¨ï¼Œæ¯æ¡æ¶ˆæ¯åœ¨æ–‡ä»¶ä¸­çš„ä½ç½®ç§°ä¸º Offestï¼ˆåç§»é‡ï¼‰</li><li>Partition æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­</li><li>log æ–‡ä»¶æ ¹æ® Broker ä¸­çš„é…ç½®ä¿ç•™ä¸€å®šæ—¶é—´ååˆ é™¤æ¥é‡Šæ”¾ç£ç›˜ç©ºé—´ã€‚</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228234231530.png" alt="image-20230228234231530"></p>]]></content>
    
    
    <categories>
      
      <category>Kafka</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¶ˆæ¯é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>kafkaå…¥é—¨</title>
    <link href="/kafka%E5%85%A5%E9%97%A8/"/>
    <url>/kafka%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-kafka-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-kafka-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1 kafka æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1 kafka æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>Kafka æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ï¼Œæ”¯æŒåˆ†åŒºï¼ˆpartitionï¼‰, å¤šå‰¯æœ¬ï¼ˆreplicationï¼‰,åŸºäºzookeeper çš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿã€‚å®ƒæœ€å¤§çš„ç‰¹æ€§å°±æ˜¯å¯ä»¥å®æ—¶çš„å¤„ç†å¤§æ•°æ®é‡ã€‚</p><p>Kafkaçš„ä½¿ç”¨åœºæ™¯ï¼š</p><ul><li>æ—¥å¿—çš„æ”¶é›†ï¼šè®°å½•å„ç§æœåŠ¡çš„logã€‚ï¼Œé€šè¿‡kafkaä»¥ç»Ÿä¸€æ¥å£æœåŠ¡çš„æ–¹å¼å¼€æ”¾ç»™å„ç§ consumerï¼Œä¾‹å¦‚hadoopã€Hbaseã€Solrç­‰ã€‚</li><li>æ¶ˆæ¯ç³»ç»Ÿï¼šè§£è€¦å’Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€ç¼“å­˜æ¶ˆæ¯ç­‰ã€‚</li><li>ç”¨æˆ·æ´»åŠ¨è·Ÿè¸ªï¼šKafkaç»å¸¸è¢«ç”¨æ¥è®°å½•webç”¨æˆ·æˆ–è€…appç”¨æˆ·çš„å„ç§æ´»åŠ¨ï¼Œå¦‚æµè§ˆç½‘é¡µã€æœç´¢ã€ç‚¹å‡»ç­‰æ´»åŠ¨ï¼Œè¿™äº›æ´»åŠ¨ä¿¡æ¯è¢«å„ä¸ªæœåŠ¡å™¨å‘å¸ƒåˆ°kafkaçš„topicä¸­ï¼Œç„¶åè®¢é˜…è€…é€šè¿‡è®¢é˜…è¿™äº›topicæ¥åšå®æ—¶çš„ç›‘æ§åˆ†æï¼Œæˆ–è€…è£…è½½åˆ°hadoopã€æ•°æ®ä»“åº“ä¸­åšç¦»çº¿åˆ†æå’Œæ˜ã€‚</li><li>è¿è¥æŒ‡æ ‡ï¼šKafkaä¹Ÿç»å¸¸ç”¨æ¥è®°å½•è¿è¥ç›‘æ§æ•°æ®ã€‚åŒ…æ‹¬æ”¶é›†å„ç§åˆ†å¸ƒå¼åº”ç”¨çš„æ•°æ®ï¼Œç”Ÿäº§å„ç§æ“ä½œçš„é›†ä¸­åé¦ˆï¼Œæ¯”å¦‚æŠ¥è­¦å’ŒæŠ¥å‘Šã€‚</li></ul><h1 id="2-kafka-çš„æ•´ä½“è®¾è®¡"><a href="#2-kafka-çš„æ•´ä½“è®¾è®¡" class="headerlink" title="2 kafka çš„æ•´ä½“è®¾è®¡"></a>2 kafka çš„æ•´ä½“è®¾è®¡</h1><p>ä»ä¸€ä¸ªè¾ƒé«˜çš„å±‚é¢ä¸Šæ¥çœ‹ï¼Œproduceré€šè¿‡ç½‘ç»œå‘é€æ¶ˆæ¯åˆ°Kafkaé›†ç¾¤ï¼Œç„¶åconsumeræ¥è¿›è¡Œæ¶ˆè´¹ï¼Œå¦‚ä¸‹å›¾</p><blockquote><p>æœåŠ¡ç«¯(brokers)å’Œå®¢æˆ·ç«¯(producerã€consumer)ä¹‹é—´é€šä¿¡é€šè¿‡<strong>TCPåè®®</strong>æ¥å®Œæˆã€‚ </p></blockquote><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231340194.png" alt="image-20230228231340194"></p><p>è¿˜æœ‰å‡ ä¸ªæ¦‚å¿µï¼š</p><ul><li><p>Producer: æ¶ˆæ¯ç”Ÿäº§è€…ï¼Œå‘Brokerå‘é€æ¶ˆæ¯çš„å®¢æˆ·ç«¯ ã€‚</p></li><li><p>Broker: æ¶ˆæ¯ä¸­é—´ä»¶å¤„ç†èŠ‚ç‚¹ï¼Œä¸€ä¸ªKafkaå®ä¾‹å°±æ˜¯ä¸€ä¸ªbrokerï¼Œä¸€ä¸ªæˆ–è€…å¤šä¸ªBrokerå¯ä»¥ç»„æˆä¸€ä¸ªKafkaé›†ç¾¤ã€‚</p></li><li><p>Topicï¼šKafkaæ ¹æ®topicå¯¹æ¶ˆæ¯è¿›è¡Œå½’ç±»ï¼Œå‘å¸ƒåˆ°Kafkaé›†ç¾¤çš„æ¯æ¡æ¶ˆæ¯éƒ½éœ€è¦æŒ‡å®šä¸€ä¸ªtopic ï¼Œç±»ä¼¼activeMqçš„queue</p></li><li><p>Partition: ä¸€ä¸ªtopicå¯ä»¥åˆ†ä¸ºå¤šä¸ªpartitionï¼Œæ¯ä¸ª partitionå†…éƒ¨æ¶ˆæ¯æ˜¯æœ‰åºçš„.</p></li><li><p>ConsumerGroup:æ¯ä¸ªConsumerå±äºä¸€ä¸ªç‰¹å®šçš„Consumer Groupï¼Œä¸€æ¡æ¶ˆæ¯å¯ä»¥è¢«å¤šä¸ªä¸åŒçš„Consumer Groupæ¶ˆè´¹ï¼Œä½†æ˜¯ä¸€ä¸ª </p><p>Consumer Groupä¸­åªèƒ½æœ‰ä¸€ä¸ªConsumerèƒ½å¤Ÿæ¶ˆè´¹è¯¥æ¶ˆæ¯</p></li><li><p>Consumer: æ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œä»Brokerè¯»å–æ¶ˆæ¯çš„å®¢æˆ·ç«¯</p></li></ul><h1 id="3-Kafka-çš„åŸºæœ¬ä½¿ç”¨"><a href="#3-Kafka-çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="3 Kafka çš„åŸºæœ¬ä½¿ç”¨"></a>3 Kafka çš„åŸºæœ¬ä½¿ç”¨</h1><ol><li><p>å¯åŠ¨zookeeper <a href="https://pyr9.github.io/2021/09/22/zookeeper%E7%89%B9%E6%80%A7%E4%B8%8E%E8%8A%82%E7%82%B9%E4%BB%8B%E7%BB%8D/">zookeeperç‰¹æ€§ä¸èŠ‚ç‚¹ä»‹ç» - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p></li><li><p>ä¸‹è½½å¹¶è§£å‹ï¼š <a href="https://kafka.apache.org/downloads">Apache Kafka</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">cd kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span><br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶config&#x2F;server.propertiesï¼Œæ ¹æ®éœ€è¦ä¿®æ”¹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">broker.id=<span class="hljs-number">0</span>     <span class="hljs-comment">//å¦‚æœæ˜¯å•æœºå®‰è£…åˆ™ä¸ç”¨ä¿®æ”¹ï¼Œå¦‚æœæ˜¯é›†ç¾¤å®‰è£…åˆ™è¦ä¿è¯æ¯ä¸ªbroker.idé…ç½®ä¸åŒçš„å€¼</span><br>log.dirs=/Tools/kafka_2<span class="hljs-number">.13</span>-<span class="hljs-number">2.4</span><span class="hljs-number">.1</span>/logs    <span class="hljs-comment">//æ—¥å¿—ä½ç½®ï¼Œè¯¥æ–‡ä»¶å¤¹å¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™å¯åŠ¨æ—¶ä¼šæŠ¥é”™</span><br>zookeeper.connect=localhost:<span class="hljs-number">2181</span>     <span class="hljs-comment">//zookeeperçš„è¿æ¥åœ°å€ï¼Œå¤šä¸ªåœ°å€ç”¨é€—å·åˆ†éš”</span><br></code></pre></td></tr></table></figure></li><li><p>å¯åŠ¨æœåŠ¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">bin/kafka-server-start.sh -daemon  config/server.properties<br></code></pre></td></tr></table></figure><ul><li>server.propertiesçš„é…ç½®è·¯å¾„æ˜¯ä¸€ä¸ªå¼ºåˆ¶çš„å‚æ•°</li><li>Â­daemonè¡¨ç¤ºä»¥åå°è¿›ç¨‹è¿è¡Œ</li></ul><p><strong>æˆ‘ä»¬è¿›å…¥zookeeperç›®å½•é€šè¿‡zookeeperå®¢æˆ·ç«¯æŸ¥çœ‹ä¸‹zookeeperçš„ç›®å½•æ ‘</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">2</span>] ls /<br>[admin, brokers, cluster, config, consumers, controller, controller_epoch, feature, isr_change_notification, latest_producer_id_block, log_dir_event_notification, zookeeper]<br></code></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹kafkaèŠ‚ç‚¹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">3</span>]  ls /brokers/ids<br>[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure></li><li><p>åœæ­¢æœåŠ¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">bin/kafkaâ€serverâ€stop.sh<br></code></pre></td></tr></table></figure></li><li><p>åˆ›å»ºä¸»é¢˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-topics.sh --create --topic test --bootstrap-server localhost:<span class="hljs-number">9092</span><br>Created topic test.<br></code></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹kafkaä¸­ç›®å‰å­˜åœ¨çš„topic </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span>  bin/kafka-topics.sh --list --bootstrap-server localhost:<span class="hljs-number">9092</span><br>test<br></code></pre></td></tr></table></figure></li><li><p>å‘é€æ¶ˆæ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-console-producer.sh --topic test --bootstrap-server localhost:<span class="hljs-number">9092</span><br>&gt;my first event<br>&gt;my second event<br></code></pre></td></tr></table></figure></li><li><p>æ¶ˆè´¹æ¶ˆæ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-console-consumer.sh --topic test --from-beginning --bootstrap-server localhost:<span class="hljs-number">9092</span><br><br>my first event<br>my second event<br></code></pre></td></tr></table></figure><blockquote><p>â€“from-beginning å¯é€‰ï¼ŒåŠ ä¸Šçš„è¯ï¼Œå°±å¯ä»¥æ”¶åˆ°å†å²å·²ç»å‘é€çš„æ•°æ®ã€‚é»˜è®¤ä¸åŠ çš„è¯ï¼Œæ˜¯æ¶ˆè´¹æœ€æ–°çš„æ¶ˆæ¯</p></blockquote></li><li><p>å•æ’­æ¶ˆè´¹</p><ul><li>ä¸€æ¡æ¶ˆæ¯åªèƒ½è¢«æŸä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹çš„æ¨¡å¼ã€‚ç±»ä¼¼queueæ¨¡å¼ã€‚</li><li>åªéœ€è®©æ‰€æœ‰æ¶ˆè´¹è€…åœ¨åŒä¸€ä¸ªæ¶ˆè´¹ç»„é‡Œå³å¯ã€‚</li></ul><p>åˆ†åˆ«åœ¨ä¸¤ä¸ªå®¢æˆ·ç«¯æ‰§è¡Œå¦‚ä¸‹æ¶ˆè´¹å‘½ä»¤ï¼Œç„¶åå¾€ä¸»é¢˜é‡Œå‘é€æ¶ˆæ¯ï¼Œç»“æœåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯èƒ½æ”¶åˆ°æ¶ˆæ¯ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-console-consumer.sh --bootstrap-server localhost:<span class="hljs-number">9092</span> --consumer-property group.id=group1 --topic test<br></code></pre></td></tr></table></figure></li><li><p>å¤šæ’­æ¶ˆè´¹</p><ul><li>ä¸€æ¡æ¶ˆæ¯èƒ½è¢«å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹çš„æ¨¡å¼ï¼Œç±»ä¼¼publish-subscribeæ¨¡å¼ã€‚</li><li>é’ˆå¯¹KafkaåŒä¸€æ¡æ¶ˆæ¯åªèƒ½è¢«åŒä¸€ä¸ªæ¶ˆè´¹ç»„ä¸‹çš„æŸä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹çš„ç‰¹æ€§ï¼Œè¦å®ç°å¤šæ’­åªè¦ä¿è¯è¿™äº›æ¶ˆè´¹è€…å±äºä¸åŒçš„æ¶ˆè´¹ç»„å³å¯ã€‚</li><li>æˆ‘ä»¬å†å¢åŠ ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œè¯¥æ¶ˆè´¹è€…å±äºgroup2æ¶ˆè´¹ç»„ï¼Œç»“æœä¸¤ä¸ªå®¢æˆ·ç«¯éƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java'">âœ  kafka_2.12-3.2.1 bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --consumer-property group.id=group2 --topic test<br></code></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹æ¶ˆè´¹ç»„å</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-consumer-groups.sh --bootstrap-server localhost:<span class="hljs-number">9092</span> --list<br>testGroup1<br>group2<br>group1<br></code></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹æ¶ˆè´¹ç»„çš„æ¶ˆè´¹åç§»é‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-consumer-groups.sh --bootstrap-server localhost:<span class="hljs-number">9092</span> --describe --group group1<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231400113.png" alt="image-20230228231400113"></p><ul><li>current-offsetï¼šå½“å‰æ¶ˆè´¹ç»„çš„å·²æ¶ˆè´¹åç§»é‡</li><li>log-end-offsetï¼šä¸»é¢˜å¯¹åº”åˆ†åŒºæ¶ˆæ¯çš„ç»“æŸåç§»é‡(HW) </li><li>lagï¼šå½“å‰æ¶ˆè´¹ç»„æœªæ¶ˆè´¹çš„æ¶ˆæ¯æ•°</li></ul></li></ol><h1 id="4-Topic-å’Œ-partition-è¯¦è§£"><a href="#4-Topic-å’Œ-partition-è¯¦è§£" class="headerlink" title="4 Topic å’Œ partition è¯¦è§£"></a>4 Topic å’Œ partition è¯¦è§£</h1><ul><li><p>topic æ˜¯ä¸€ä¸ªç±»åˆ«çš„åç§°ï¼ŒåŒç±»æ¶ˆæ¯ï¼Œå‘é€åˆ°ä¸€ä¸ªtopicä¸‹ï¼Œå¯¹äºæ¯ä¸€ä¸ªtopicå¯ä»¥æœ‰å¤šä¸ªåˆ†åŒº(partition)ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231408951.png" alt="image-20230228231408951"></p></li><li><p>partition æ˜¯ä¸€ä¸ªæœ‰åºçš„messageåºåˆ—ï¼Œè¿™äº›messageå°†æŒ‰é¡ºåºæ·»åŠ åˆ°commitlogæ–‡ä»¶ä¸­ã€‚ä¸€ä¸ªpartition å¯¹åº”ä¸€ä¸ªcommit log æ–‡ä»¶ï¼Œå¯¹åº”å­˜æ”¾åœ¨é…ç½®çš„logæ–‡ä»¶ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> cd /tmp/kafka-logs<br>âœ  kafka-logs cd test-<span class="hljs-number">0</span><br>âœ  test-<span class="hljs-number">0</span> ls<br><span class="hljs-number">00000000000000000000.</span>index     <span class="hljs-number">00000000000000000000.</span>timeindex partition.metadata<br><span class="hljs-number">00000000000000000000.</span>log       leader-epoch-checkpoint<br>âœ  test-<span class="hljs-number">0</span> cat <span class="hljs-number">00000000000000000000.</span>log<br>F_:ï¿½ï¿½ï¿½ï¿½ï¿½<span class="hljs-number">6</span>ï¿½ï¿½ï¿½ï¿½<span class="hljs-number">6</span>ï¿½(my first eventGï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½*my second event&gt;I=;ï¿½ï¿½ï¿½Rï¿½ï¿½ï¿½ï¿½Rï¿½<br></code></pre></td></tr></table></figure></li><li><p>æ¯ä¸ªpartion ä¸­çš„æ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç¼–å·ï¼Œå«åšoffsetï¼Œç”¨æ¥æ ‡è¯†è¿™æ¡æ¶ˆæ¯ã€‚</p></li><li><p>åˆ›å»ºå¤šä¸ªåˆ†åŒºçš„ä¸»é¢˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-topics.sh --create --topic test2 --bootstrap-server localhost:<span class="hljs-number">9092</span> â€â€replicationâ€factor <span class="hljs-number">1</span> â€â€partitions <span class="hljs-number">2</span><br>Created topic test2.<br></code></pre></td></tr></table></figure></li></ul><h1 id="5-Kafkaå‰¯æœ¬é›†"><a href="#5-Kafkaå‰¯æœ¬é›†" class="headerlink" title="5 Kafkaå‰¯æœ¬é›†"></a>5 <strong>Kafkaå‰¯æœ¬é›†</strong></h1><ul><li>Kafkaå‰¯æœ¬é›†æ˜¯æŒ‡å°†æ—¥å¿—å¤åˆ¶å¤šä»½ï¼Œæˆ‘ä»¬çŸ¥é“Kafkaçš„æ•°æ®æ˜¯å­˜å‚¨åœ¨æ—¥å¿—æ–‡ä»¶ä¸­çš„ï¼Œè¿™å°±ç›¸å½“äºæ•°æ®çš„å¤‡ä»½ã€å†—ä½™</li><li>Kafkaå¯ä»¥ä¸ºæ¯ä¸ªTopicè®¾ç½®å‰¯æœ¬é›†ï¼ŒKafkaä¸­çš„Topicåªæ˜¯ä¸ªé€»è¾‘æ¦‚å¿µï¼Œå®é™…å­˜å‚¨æ•°æ®çš„æ˜¯Partitionï¼Œæ‰€ä»¥çœŸæ­£è¢«å¤åˆ¶çš„ä¹Ÿæ˜¯Partitionï¼Œå‰¯æœ¬é›†æ˜¯ç›¸å¯¹äºPartitionæ¥è¯´çš„</li><li>ä¸€ä¸ªTopicçš„å‰¯æœ¬é›†å¯ä»¥åˆ†å¸ƒåœ¨å¤šä¸ªBrokerä¸­ï¼Œå½“ä¸€ä¸ªBrokeræŒ‚æ‰äº†ï¼Œå…¶ä»–çš„Brokerä¸Šè¿˜æœ‰æ•°æ®ï¼Œè¿™å°±æé«˜äº†æ•°æ®çš„å¯é æ€§ï¼Œè¿™ä¹Ÿæ˜¯å‰¯æœ¬é›†çš„ä¸»è¦ä½œç”¨ã€‚</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231420153.png" alt="image-20230228231420153"></p><ul><li>æŸ¥çœ‹ä¸‹topicçš„æƒ…å†µ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-topics.sh --bootstrap-server localhost:<span class="hljs-number">9092</span> --describe --topic test2<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231430788.png" alt="image-20230228231430788"></p><ul><li>leaderèŠ‚ç‚¹è´Ÿè´£ç»™å®špartitionçš„æ‰€æœ‰è¯»å†™è¯·æ±‚ã€‚</li><li>replicas è¡¨ç¤ºæŸä¸ªpartitionåœ¨å“ªå‡ ä¸ªbrokerä¸Šå­˜åœ¨å¤‡ä»½ã€‚ä¸ç®¡è¿™ä¸ªå‡ ç‚¹æ˜¯ä¸æ˜¯â€leaderâ€œï¼Œç”šè‡³è¿™ä¸ªèŠ‚ç‚¹æŒ‚äº†ï¼Œä¹Ÿä¼šåˆ—å‡ºã€‚</li><li>isr**(InSyncRepli)** ï¼šleaderå‰¯æœ¬ä¿æŒä¸€å®šåŒæ­¥ç¨‹åº¦çš„å‰¯æœ¬ï¼ˆåŒ…æ‹¬leaderï¼‰ç»„æˆISRã€‚æ˜¯replicasçš„ä¸€ä¸ªå­é›†ã€‚</li></ul><h1 id="6-KafkaèŠ‚ç‚¹æ•…éšœåŸå› åŠå¤„ç†æ–¹å¼"><a href="#6-KafkaèŠ‚ç‚¹æ•…éšœåŸå› åŠå¤„ç†æ–¹å¼" class="headerlink" title="6 KafkaèŠ‚ç‚¹æ•…éšœåŸå› åŠå¤„ç†æ–¹å¼"></a>6 <strong>KafkaèŠ‚ç‚¹æ•…éšœåŸå› åŠå¤„ç†æ–¹å¼</strong></h1><p>KafkaèŠ‚ç‚¹ï¼ˆBrokerï¼‰æ•…éšœçš„ä¸¤ç§æƒ…å†µï¼š</p><ul><li>KafkaèŠ‚ç‚¹ä¸Zookeeperå¿ƒè·³æœªä¿æŒè§†ä¸ºèŠ‚ç‚¹æ•…éšœ</li><li>å½“followerçš„æ¶ˆæ¯è½åäºleaderå¤ªå¤šä¹Ÿä¼šè§†ä¸ºèŠ‚ç‚¹æ•…éšœ</li></ul><p>Kafkaå¯¹èŠ‚ç‚¹æ•…éšœçš„å¤„ç†æ–¹å¼ï¼š</p><ul><li>Kafkaä¼šå¯¹æ•…éšœèŠ‚ç‚¹è¿›è¡Œç§»é™¤ï¼Œæ‰€ä»¥åŸºæœ¬ä¸ä¼šå› ä¸ºèŠ‚ç‚¹æ•…éšœè€Œä¸¢å¤±æ•°æ®</li><li>Kafkaçš„è¯­ä¹‰æ‹…ä¿ä¹Ÿå¾ˆå¤§ç¨‹åº¦ä¸Šé¿å…äº†æ•°æ®ä¸¢å¤±</li><li>Kafkaä¼šå¯¹æ¶ˆæ¯è¿›è¡Œé›†ç¾¤å†…å¹³è¡¡ï¼Œå‡å°‘æ¶ˆæ¯åœ¨æŸäº›èŠ‚ç‚¹çƒ­åº¦è¿‡é«˜</li></ul>]]></content>
    
    
    <categories>
      
      <category>Kafka</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
      <tag>æ¶ˆæ¯é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>kafkaé›†ç¾¤</title>
    <link href="/kafka%E9%9B%86%E7%BE%A4/"/>
    <url>/kafka%E9%9B%86%E7%BE%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="kafka-é›†ç¾¤"><a href="#kafka-é›†ç¾¤" class="headerlink" title="kafka é›†ç¾¤"></a>kafka é›†ç¾¤</h1><h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1 æ¦‚å¿µ"></a>1 æ¦‚å¿µ</h1><ul><li><p>Kafkaé›†ç¾¤ä¾èµ–äºZookeeperè¿›è¡Œåè°ƒï¼ŒKafkaèŠ‚ç‚¹åªè¦æ³¨å†Œåˆ°åŒä¸€ä¸ªZookeeperä¸Šå°±ä»£è¡¨å®ƒä»¬æ˜¯åŒä¸€ä¸ªé›†ç¾¤çš„</p></li><li><p>Kafkaé€šè¿‡brokerIdæ¥åŒºåˆ†é›†ç¾¤ä¸­çš„ä¸åŒèŠ‚ç‚¹</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231625775.png" alt="image-20230228231625775"></p></li></ul><h1 id="2-Kafkaé›†ç¾¤ä¸­çš„å‡ ä¸ªè§’è‰²ï¼š"><a href="#2-Kafkaé›†ç¾¤ä¸­çš„å‡ ä¸ªè§’è‰²ï¼š" class="headerlink" title="2 Kafkaé›†ç¾¤ä¸­çš„å‡ ä¸ªè§’è‰²ï¼š"></a>2 <strong>Kafkaé›†ç¾¤ä¸­çš„å‡ ä¸ªè§’è‰²ï¼š</strong></h1><ul><li>Brokerï¼šä¸€èˆ¬æŒ‡Kafkaçš„éƒ¨ç½²èŠ‚ç‚¹</li><li>Leaderï¼šç”¨äºå¤„ç†æ¶ˆæ¯çš„æ¥æ”¶å’Œæ¶ˆè´¹ç­‰è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´produceræ˜¯å°†æ¶ˆæ¯pushåˆ°leaderï¼Œè€Œconsumerä¹Ÿæ˜¯ä»leaderä¸Šå»pollæ¶ˆæ¯</li><li>Followerï¼šä¸»è¦ç”¨äºå¤‡ä»½æ¶ˆæ¯æ•°æ®ï¼Œä¸€ä¸ªleaderä¼šæœ‰å¤šä¸ªfollowerï¼Œä¸æä¾›è¯»å†™(ä¸»è¦æ˜¯ä¸ºäº†ä¿è¯å¤šå‰¯æœ¬æ•°æ®ä¸æ¶ˆè´¹çš„ä¸€è‡´æ€§ï¼‰ã€‚å¦‚æœè¿™ä¸ªleaderå¤±æ•ˆäº†ï¼Œå…¶ä¸­çš„ä¸€ä¸ªfollowerå°†ä¼šè‡ªåŠ¨çš„å˜æˆæ–°çš„leaderã€‚</li></ul><h1 id="3-kafkaé…ç½®ä¸­request-required-acks"><a href="#3-kafkaé…ç½®ä¸­request-required-acks" class="headerlink" title="3 kafkaé…ç½®ä¸­request.required.acks"></a>3 kafkaé…ç½®ä¸­request.required.acks</h1><p><strong>Kafkaé€šè¿‡é…ç½®request.required.ackså±æ€§æ¥ç¡®è®¤æ¶ˆæ¯çš„ç”Ÿäº§</strong></p><ul><li>0 ç”Ÿäº§è€…å°†æ•°æ®å‘é€å‡ºå»å°±ä¸ç®¡äº†ï¼Œä¸å»ç­‰å¾…ä»»ä½•è¿”å›ã€‚è¿™ç§æƒ…å†µä¸‹æ•°æ®ä¼ è¾“æ•ˆç‡æœ€é«˜ï¼Œä½†æ˜¯æ•°æ®å¯é æ€§ç¡®æ˜¯æœ€ä½çš„ï¼Œå­˜åœ¨ä¸¢æ¶ˆæ¯ï¼šæ•°æ®è¿˜æ²¡å†™å…¥leaderï¼Œleaderå°±æŒ‚äº†</li><li>1ï¼ˆé»˜è®¤ï¼‰ æ•°æ®å‘é€åˆ°Kafkaåï¼Œç»è¿‡leaderæˆåŠŸæ¥æ”¶æ¶ˆæ¯çš„çš„ç¡®è®¤ï¼Œå°±ç®—æ˜¯å‘é€æˆåŠŸäº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœleaderå®•æœºäº†ï¼Œåˆ™ä¼šä¸¢å¤±æ•°æ®ã€‚</li><li>-1æˆ–all produceréœ€è¦ç­‰å¾…ISRä¸­çš„æ‰€æœ‰å‰¯æœ¬éƒ½ç¡®è®¤æ¥æ”¶åˆ°æ•°æ®åæ‰ç®—ä¸€æ¬¡å‘é€å®Œæˆï¼Œå¯é æ€§æœ€é«˜ã€‚å½“ISRä¸­æ‰€æœ‰å‰¯æœ¬éƒ½å‘Leaderå‘é€ACKæ—¶ï¼Œleaderæ‰commitï¼Œè¿™æ—¶å€™produceræ‰èƒ½è®¤ä¸ºä¸€ä¸ªè¯·æ±‚ä¸­çš„æ¶ˆæ¯éƒ½commitäº†ã€‚è¿™ç§æ€§èƒ½ä¸é«˜ï¼Œä¸€èˆ¬æ˜¯é‡‘èçº§åˆ«æˆ–è€…å’Œé’±æ‰“äº¤é“çš„æ—¶å€™é‡‡ç”¨ã€‚</li></ul><p><strong>é¿å…æ¶ˆæ¯ä¸¢å¤±å°±å¯ä»¥å°†ackè®¾ç½®æˆ-1æˆ–all</strong></p><h1 id="4-producer-çš„å†™å…¥æµç¨‹"><a href="#4-producer-çš„å†™å…¥æµç¨‹" class="headerlink" title="4 producer çš„å†™å…¥æµç¨‹"></a>4 producer çš„å†™å…¥æµç¨‹</h1><ol><li>producer å…ˆä» zookeeper çš„ â€œ&#x2F;brokers&#x2F;â€¦&#x2F;stateâ€ èŠ‚ç‚¹æ‰¾åˆ°è¯¥ partition çš„ leader </li><li>producer å°†æ¶ˆæ¯å‘é€ç»™è¯¥ leader </li><li>leader å°†æ¶ˆæ¯å†™å…¥æœ¬åœ° log </li><li>followers ä» leader pull  æ¶ˆæ¯ï¼Œå†™å…¥æœ¬åœ° log å leader å‘é€ ACK </li><li>leader æ”¶åˆ°æ‰€æœ‰ ISR ä¸­çš„ replica çš„ ACK åï¼Œå¢åŠ  HWï¼ˆhigh watermarkï¼Œæœ€å commit çš„ offsetï¼‰ å¹¶å‘ producer å‘é€ ACK</li></ol><h1 id="5-Partitionå‰¯æœ¬é€‰ä¸¾Leaderæœºåˆ¶"><a href="#5-Partitionå‰¯æœ¬é€‰ä¸¾Leaderæœºåˆ¶" class="headerlink" title="5 Partitionå‰¯æœ¬é€‰ä¸¾Leaderæœºåˆ¶"></a>5 Partitionå‰¯æœ¬é€‰ä¸¾Leaderæœºåˆ¶</h1><ul><li>å¦‚æœæœ‰æ¥è§¦è¿‡å…¶ä»–ä¸€äº›åˆ†å¸ƒå¼ç»„ä»¶å°±ä¼šäº†è§£åˆ°å¤§éƒ¨åˆ†ç»„ä»¶éƒ½æ˜¯é€šè¿‡æŠ•ç¥¨é€‰ä¸¾æ¥åœ¨ä¼—å¤šèŠ‚ç‚¹ä¸­é€‰ä¸¾å‡ºä¸€ä¸ªleaderï¼Œä½†åœ¨Kafkaä¸­æ²¡æœ‰é‡‡ç”¨æŠ•ç¥¨é€‰ä¸¾æ¥é€‰ä¸¾leader</li><li>Kafkaä¼šåŠ¨æ€ç»´æŠ¤ä¸€ç»„Leaderæ•°æ®çš„å‰¯æœ¬ï¼ˆISRï¼‰</li><li>Kafkaä¼šåœ¨ISRåˆ—è¡¨é‡ŒæŒ‘ç¬¬ä¸€ä¸ªbrokerä½œä¸ºleader(ç¬¬ä¸€ä¸ªbrokeræœ€å…ˆæ”¾è¿›ISRåˆ—è¡¨ï¼Œå¯èƒ½æ˜¯åŒæ­¥æ•°æ®æœ€å¤šçš„å‰¯æœ¬)</li></ul><p>Kafkaæœ‰ä¸€ç§æ— å¥ˆçš„æƒ…å†µï¼Œå°±æ˜¯ISRä¸­å‰¯æœ¬å…¨éƒ¨å®•æœºã€‚å¯¹äºè¿™ç§æƒ…å†µï¼ŒKafkaé»˜è®¤ä¼šè¿›è¡Œunclean leaderé€‰ä¸¾ã€‚Kafkaæä¾›äº†ä¸¤ç§ä¸åŒçš„æ–¹å¼è¿›è¡Œå¤„ç†ï¼š</p><ol><li>ç­‰å¾…ISRä¸­ä»»ä¸€Replicaæ¢å¤ï¼Œå¹¶é€‰å®ƒä¸ºLeader</li></ol><ul><li>ç­‰å¾…æ—¶é—´è¾ƒé•¿ï¼Œä¼šé™ä½å¯ç”¨æ€§ï¼Œæˆ–ISRä¸­çš„æ‰€æœ‰Replicaéƒ½æ— æ³•æ¢å¤æˆ–è€…æ•°æ®ä¸¢å¤±ï¼Œåˆ™è¯¥Partitionå°†æ°¸ä¸å¯ç”¨</li></ul><ol><li>é€‰æ‹©ç¬¬ä¸€ä¸ªæ¢å¤çš„Replicaä¸ºæ–°çš„Leaderï¼Œæ— è®ºå®ƒæ˜¯å¦åœ¨ISRä¸­</li></ol><ul><li>å¹¶æœªåŒ…å«æ‰€æœ‰å·²è¢«ä¹‹å‰Leader Commitè¿‡çš„æ¶ˆæ¯ï¼Œå› æ­¤ä¼šé€ æˆæ•°æ®ä¸¢å¤±ï¼Œä½†å¯ç”¨æ€§è¾ƒé«˜</li></ul><h1 id="6-Controller"><a href="#6-Controller" class="headerlink" title="6 Controller"></a>6 Controller</h1><p>åœ¨kafkaé›†ç¾¤å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨é€‰ä¸¾ä¸€å°brokerä½œä¸ºcontrollerï¼Œå®ƒè´Ÿè´£ç®¡ç†æ•´ä¸ªé›†ç¾¤ä¸­æ‰€æœ‰åˆ†åŒºå’Œå‰¯æœ¬çš„çŠ¶æ€ã€‚</p><ul><li>å½“æŸä¸ªåˆ†åŒºçš„leaderå‰¯æœ¬å‡ºç°æ•…éšœæ—¶ï¼Œç”±æ§åˆ¶å™¨è´Ÿè´£ä¸ºè¯¥åˆ†åŒº<strong>é€‰ä¸¾æ–°çš„leader</strong>å‰¯æœ¬ã€‚</li><li>å½“æ£€æµ‹åˆ°æŸä¸ªåˆ†åŒºçš„ISRé›†åˆå‘ç”Ÿå˜åŒ–æ—¶ï¼Œç”±æ§åˆ¶å™¨è´Ÿè´£<strong>é€šçŸ¥æ‰€æœ‰brokeræ›´æ–°å…¶å…ƒæ•°æ®ä¿¡æ¯</strong>ã€‚</li><li>å½“ä½¿ç”¨kafka-topics.shè„šæœ¬ä¸ºæŸä¸ªtopic<strong>å¢åŠ åˆ†åŒºæ•°é‡</strong>æ—¶ï¼ŒåŒæ ·è¿˜æ˜¯ç”±æ§åˆ¶å™¨è´Ÿè´£è®©æ–°åˆ†åŒºè¢«å…¶ä»–èŠ‚ç‚¹æ„ŸçŸ¥åˆ°ã€‚</li></ul><h1 id="7-Controlleré€‰ä¸¾æœºåˆ¶"><a href="#7-Controlleré€‰ä¸¾æœºåˆ¶" class="headerlink" title="7 Controlleré€‰ä¸¾æœºåˆ¶"></a>7 Controlleré€‰ä¸¾æœºåˆ¶</h1><ul><li>é›†ç¾¤ä¸­æ¯ä¸ªbrokeréƒ½ä¼šå°è¯•åœ¨zookeeperä¸Šåˆ›å»ºä¸€ä¸ª &#x2F;controller ä¸´æ—¶èŠ‚ç‚¹</li><li>zookeeperä¼šä¿è¯æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªbrokerèƒ½åˆ›å»ºæˆåŠŸï¼Œè¿™ä¸ªbrokerå°±ä¼šæˆä¸ºé›†ç¾¤çš„æ€»æ§å™¨controller</li><li>å½“è¿™ä¸ªcontrollerè§’è‰²çš„brokerå®•æœºäº†ï¼Œæ­¤æ—¶zookeeperä¸´æ—¶èŠ‚ç‚¹ä¼šæ¶ˆå¤±ï¼Œé›†ç¾¤é‡Œå…¶ä»–brokerä¼šä¸€ç›´ç›‘å¬è¿™ä¸ªä¸´æ—¶èŠ‚ç‚¹ï¼Œå‘ç°ä¸´æ—¶èŠ‚ç‚¹æ¶ˆå¤±äº†ï¼Œå°±ç«äº‰å†æ¬¡åˆ›å»ºä¸´æ—¶èŠ‚ç‚¹</li></ul><h1 id="3-é›†ç¾¤é…ç½®æµç¨‹"><a href="#3-é›†ç¾¤é…ç½®æµç¨‹" class="headerlink" title="3 é›†ç¾¤é…ç½®æµç¨‹"></a>3 é›†ç¾¤é…ç½®æµç¨‹</h1><ol><li><p>ç¼–å†™é…ç½®æ–‡ä»¶</p><ul><li><p><code>vim config/server.properties</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">broker</span>.id=<span class="hljs-number">0</span>     //å¦‚æœæ˜¯å•æœºå®‰è£…åˆ™ä¸ç”¨ä¿®æ”¹ï¼Œå¦‚æœæ˜¯é›†ç¾¤å®‰è£…åˆ™è¦ä¿è¯æ¯ä¸ªbroker.idé…ç½®ä¸åŒçš„å€¼<br><span class="hljs-attribute">listeners</span>=PLAINTEXT://localhost:<span class="hljs-number">9092</span> <br><span class="hljs-attribute">log</span>.dirs=/Tools/kafka_<span class="hljs-number">2</span>.<span class="hljs-number">13</span>-<span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">1</span>/logs    //æ—¥å¿—ä½ç½®ï¼Œè¯¥æ–‡ä»¶å¤¹å¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™å¯åŠ¨æ—¶ä¼šæŠ¥é”™<br><span class="hljs-attribute">zookeeper</span>.connect=localhost:<span class="hljs-number">2181</span>     //zookeeperçš„è¿æ¥åœ°å€ï¼Œå¤šä¸ªåœ°å€ç”¨é€—å·åˆ†éš”<br></code></pre></td></tr></table></figure></li></ul></li><li><p>å»ºç«‹å¥½å…¶ä»–2ä¸ªbrokerçš„é…ç½®æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">cp config/server.properties config/serverâ€<span class="hljs-number">1.</span>properties<br>cp config/server.properties config/serverâ€<span class="hljs-number">2.</span>properties<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">broker</span>.id=<span class="hljs-number">1</span>     //å¦‚æœæ˜¯å•æœºå®‰è£…åˆ™ä¸ç”¨ä¿®æ”¹ï¼Œå¦‚æœæ˜¯é›†ç¾¤å®‰è£…åˆ™è¦ä¿è¯æ¯ä¸ªbroker.idé…ç½®ä¸åŒçš„å€¼<br><span class="hljs-attribute">listeners</span>=PLAINTEXT://localhost:<span class="hljs-number">9093</span> <br><span class="hljs-attribute">log</span>.dirs=/Tools/kafka_<span class="hljs-number">2</span>.<span class="hljs-number">13</span>-<span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">1</span>/logs-<span class="hljs-number">1</span>    //æ—¥å¿—ä½ç½®ï¼Œè¯¥æ–‡ä»¶å¤¹å¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™å¯åŠ¨æ—¶ä¼šæŠ¥é”™<br><span class="hljs-attribute">zookeeper</span>.connect=localhost:<span class="hljs-number">2181</span>     //zookeeperçš„è¿æ¥åœ°å€ï¼Œå¤šä¸ªåœ°å€ç”¨é€—å·åˆ†éš”<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">broker</span>.id=<span class="hljs-number">2</span>     //å¦‚æœæ˜¯å•æœºå®‰è£…åˆ™ä¸ç”¨ä¿®æ”¹ï¼Œå¦‚æœæ˜¯é›†ç¾¤å®‰è£…åˆ™è¦ä¿è¯æ¯ä¸ªbroker.idé…ç½®ä¸åŒçš„å€¼<br><span class="hljs-attribute">listeners</span>=PLAINTEXT://localhost:<span class="hljs-number">9094</span> <br><span class="hljs-attribute">log</span>.dirs=/Tools/kafka_<span class="hljs-number">2</span>.<span class="hljs-number">13</span>-<span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">1</span>/logs-<span class="hljs-number">2</span>    //æ—¥å¿—ä½ç½®ï¼Œè¯¥æ–‡ä»¶å¤¹å¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™å¯åŠ¨æ—¶ä¼šæŠ¥é”™<br><span class="hljs-attribute">zookeeper</span>.connect=localhost:<span class="hljs-number">2181</span>     //zookeeperçš„è¿æ¥åœ°å€ï¼Œå¤šä¸ªåœ°å€ç”¨é€—å·åˆ†éš”<br></code></pre></td></tr></table></figure></li><li><p>åˆ†åˆ«å¯åŠ¨brokerå®ä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-server-start.sh -daemon config/server.properties<br>âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-server-start.sh -daemon config/server-<span class="hljs-number">1.</span>properties<br>âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-server-start.sh -daemon config/server-<span class="hljs-number">2.</span>properties<br></code></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹zookeeperç¡®è®¤é›†ç¾¤èŠ‚ç‚¹æ˜¯å¦éƒ½æ³¨å†ŒæˆåŠŸ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">19</span>]  ls /brokers/ids<br>[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]<br></code></pre></td></tr></table></figure></li></ol><h2 id="é›†ç¾¤ä½¿ç”¨"><a href="#é›†ç¾¤ä½¿ç”¨" class="headerlink" title="é›†ç¾¤ä½¿ç”¨"></a>é›†ç¾¤ä½¿ç”¨</h2><ol><li><p>åˆ›å»ºä¸€ä¸ªæ–°çš„topicï¼Œå‰¯æœ¬æ•°è®¾ç½®ä¸º3ï¼Œåˆ†åŒºæ•°è®¾ç½®ä¸º2ï¼š </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-topics.sh --bootstrap-server localhost:<span class="hljs-number">9092</span> --create --replication-factor <span class="hljs-number">3</span> --partitions <span class="hljs-number">2</span> --topic test6<br></code></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹ä¸‹topicçš„æƒ…å†µ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-topics.sh --bootstrap-server localhost:<span class="hljs-number">9092</span> --describe --topic test6<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231644650.png" alt="image-20230228231644650"></p></li><li><p>å‘æ–°å»ºçš„ test6 ä¸­å‘é€ä¸€äº›messageï¼Œkafkaé›†ç¾¤å¯ä»¥åŠ ä¸Šæ‰€æœ‰kafkaèŠ‚ç‚¹</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim">âœ  kafka_2.<span class="hljs-number">12</span>-<span class="hljs-number">3.2</span>.<span class="hljs-number">1</span>  bin/kafka-console-producer.<span class="hljs-keyword">sh</span> â€â€brokerâ€<span class="hljs-keyword">list</span> localhos<span class="hljs-variable">t:9092</span>,localhos<span class="hljs-variable">t:9093</span>,localhos<span class="hljs-variable">t:9094</span> --topic test6  --bootstrap-server localhos<span class="hljs-variable">t:9092</span><br>&gt;my test msg <span class="hljs-number">1</span><br>&gt;my test msg <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure></li><li><p>å¼€å§‹æ¶ˆè´¹</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata">âœ  kafka_2.12-3.2.1 bin/kafka-console-consumer.<span class="hljs-keyword">sh</span> --topic test6 --from-beginning --<span class="hljs-keyword">bootstrap</span>-server localhost:9092,localhost:9093,localhost:9094<br>my <span class="hljs-keyword">test</span> msg 1<br>my <span class="hljs-keyword">test</span> msg 2<br></code></pre></td></tr></table></figure></li><li><p>æµ‹è¯•å®¹é”™æ€§ï¼Œç›®å‰broker2 æ˜¯åˆ†åŒº0çš„leaderï¼Œç°åœ¨å°†ä»–kill</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> ps -ef|grep serverâ€<span class="hljs-number">2.</span>properties<br>âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> kill -<span class="hljs-number">9</span> <span class="hljs-number">80024</span><br></code></pre></td></tr></table></figure></li><li><p>å†æ¬¡æŸ¥çœ‹topicçš„æƒ…å†µ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">âœ  kafka_2<span class="hljs-number">.12</span>-<span class="hljs-number">3.2</span><span class="hljs-number">.1</span> bin/kafka-topics.sh --bootstrap-server localhost:<span class="hljs-number">9092</span> --describe --topic test6<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231658763.png" alt="image-20230228231658763"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶åˆ†åŒº0çš„leaderå˜æˆäº†broker1ï¼Œåœ¨isrä¸­ä¹Ÿå·²ç»æ²¡æœ‰äº†2å·èŠ‚ç‚¹ã€‚</p></li></ol><p>  æ­¤æ—¶ï¼Œä¾æ—§å¯ä»¥æ¶ˆè´¹æ¶ˆæ¯ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231708348.png" alt="image-20230228231708348"></p>]]></content>
    
    
    <categories>
      
      <category>Kafka</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
      <tag>é›†ç¾¤</tag>
      
      <tag>æ¶ˆæ¯é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springCloudä¹‹Config+Bus</title>
    <link href="/springCloud%E4%B9%8BConfig-Bus/"/>
    <url>/springCloud%E4%B9%8BConfig-Bus/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¶ˆæ¯æ€»çº¿"><a href="#æ¶ˆæ¯æ€»çº¿" class="headerlink" title="æ¶ˆæ¯æ€»çº¿"></a>æ¶ˆæ¯æ€»çº¿</h1><ul><li><p>åœ¨å¾®æœåŠ¡æ¶æ„çš„ç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨<strong>è½»é‡çº§çš„æ¶ˆæ¯ä»£ç†</strong>æ¥æ„å»ºä¸€ä¸ªå…¬ç”¨çš„<strong>æ¶ˆæ¯ä¸»é¢˜</strong>ï¼Œå¹¶è®©ç³»ç»Ÿä¸­çš„æ‰€æœ‰å®ä¾‹éƒ½è¿æ¥ä¸Šæ¥ã€‚ç”±äºè¯¥<strong>ä¸»é¢˜çš„æ¶ˆæ¯ä¼šè¢«æ‰€æœ‰å®ä¾‹ç›‘å¬å’Œæ¶ˆè´¹</strong>ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºæ¶ˆæ¯æ€»çº¿ã€‚</p></li><li><p>åœ¨æ€»çº¿ä¸Šçš„å„ä¸ªå®ä¾‹ï¼Œéƒ½å¯ä»¥æ–¹ä¾¿çš„å¹¿æ’­ä¸€äº›è®©å…¶ä»–è¿æ¥åœ¨ç»™ä¸»é¢˜å®ä¾‹ä¸Šéƒ½çŸ¥é“çš„æ¶ˆæ¯ã€‚</p></li></ul><h1 id="Spring-Cloud-Bus"><a href="#Spring-Cloud-Bus" class="headerlink" title="Spring Cloud Bus"></a>Spring Cloud Bus</h1><ul><li><p>Spring Cloud Bus åˆè¢«ç§°ä¸ºæ¶ˆæ¯æ€»çº¿ï¼Œå®ƒèƒ½å¤Ÿé€šè¿‡è½»é‡çº§çš„æ¶ˆæ¯ä»£ç†ï¼ˆä¾‹å¦‚ RabbitMQã€Kafka ç­‰ï¼‰å°†å¾®æœåŠ¡æ¶æ„ä¸­çš„å„ä¸ªæœåŠ¡è¿æ¥èµ·æ¥ï¼Œå®ç°å¹¿æ’­çŠ¶æ€æ›´æ”¹ã€äº‹ä»¶æ¨é€ç­‰åŠŸèƒ½ï¼Œè¿˜å¯ä»¥å®ç°å¾®æœåŠ¡ä¹‹é—´çš„é€šä¿¡åŠŸèƒ½ã€‚</p></li><li><p>ç›®å‰ Spring Cloud Bus æ”¯æŒä¸¤ç§æ¶ˆæ¯ä»£ç†ï¼šRabbitMQ å’Œ Kafkaã€‚</p></li></ul><h2 id="Spring-Cloud-Bus-çš„åŸºæœ¬åŸç†"><a href="#Spring-Cloud-Bus-çš„åŸºæœ¬åŸç†" class="headerlink" title="Spring Cloud Bus çš„åŸºæœ¬åŸç†"></a>Spring Cloud Bus çš„åŸºæœ¬åŸç†</h2><ul><li>Spring Cloud Bus ä¼šä½¿ç”¨ä¸€ä¸ªè½»é‡çº§çš„æ¶ˆæ¯ä»£ç†æ¥æ„å»ºä¸€ä¸ªå…¬å…±çš„æ¶ˆæ¯ä¸»é¢˜ Topicï¼ˆé»˜è®¤ä¸ºâ€œspringCloudBusâ€ï¼‰ï¼Œ<strong>è¿™ä¸ª Topic ä¸­çš„æ¶ˆæ¯ä¼šè¢«æ‰€æœ‰æœåŠ¡å®ä¾‹ç›‘å¬å’Œæ¶ˆè´¹</strong>ã€‚</li><li>å½“å…¶ä¸­çš„ä¸€ä¸ªæœåŠ¡åˆ·æ–°æ•°æ®æ—¶ï¼ŒSpring Cloud Bus ä¼šæŠŠä¿¡æ¯ä¿å­˜åˆ° Topic ä¸­ï¼Œè¿™æ ·ç›‘å¬è¿™ä¸ª Topic çš„æœåŠ¡å°±æ”¶åˆ°æ¶ˆæ¯å¹¶è‡ªåŠ¨æ¶ˆè´¹ã€‚</li></ul><h2 id="Spring-Cloud-Bus-åŠ¨æ€åˆ·æ–°é…ç½®çš„åŸç†"><a href="#Spring-Cloud-Bus-åŠ¨æ€åˆ·æ–°é…ç½®çš„åŸç†" class="headerlink" title="Spring Cloud Bus åŠ¨æ€åˆ·æ–°é…ç½®çš„åŸç†"></a>Spring Cloud Bus åŠ¨æ€åˆ·æ–°é…ç½®çš„åŸç†</h2><ul><li><p>å½“ Git ä»“åº“ä¸­çš„é…ç½®å‘ç”Ÿäº†æ”¹å˜ï¼Œæˆ‘ä»¬åªéœ€è¦å‘æŸä¸€ä¸ªæœåŠ¡ï¼ˆæ—¢å¯ä»¥æ˜¯ Config æœåŠ¡ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯ Config å®¢æˆ·ç«¯ï¼‰å‘é€ä¸€ä¸ª POST è¯·æ±‚ï¼ŒSpring Cloud Bus å°±å¯ä»¥é€šè¿‡æ¶ˆæ¯ä»£ç†é€šçŸ¥å…¶ä»–æœåŠ¡é‡æ–°æ‹‰å–æœ€æ–°é…ç½®ï¼Œä»¥å®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°ã€‚</p></li><li><p>åˆ©ç”¨ Spring Cloud Bus çš„ç‰¹æ®Šæœºåˆ¶å¯ä»¥å®ç°å¾ˆå¤šåŠŸèƒ½ï¼Œå…¶ä¸­é…åˆ Spring Cloud Config å®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°å°±æ˜¯æœ€å…¸å‹çš„åº”ç”¨åœºæ™¯ä¹‹ä¸€ã€‚</p></li></ul><h2 id="Spring-Cloud-Bus-æ•´åˆSpring-Cloud-Configå®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°"><a href="#Spring-Cloud-Bus-æ•´åˆSpring-Cloud-Configå®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°" class="headerlink" title="Spring Cloud Bus æ•´åˆSpring Cloud Configå®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°"></a>Spring Cloud Bus æ•´åˆSpring Cloud Configå®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°</h2><ol><li>å½“ Git ä»“åº“ä¸­çš„é…ç½®å‘ç”Ÿæ”¹å˜åï¼Œè¿ç»´äººå‘˜å‘ Config æœåŠ¡ç«¯å‘é€ä¸€ä¸ª POST è¯·æ±‚ï¼Œè¯·æ±‚è·¯å¾„ä¸ºâ€œ&#x2F;actuator&#x2F;refreshâ€ã€‚</li><li>Config æœåŠ¡ç«¯æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šå°†è¯¥è¯·æ±‚è½¬å‘ç»™æœåŠ¡æ€»çº¿ Spring Cloud Busã€‚</li><li>Spring Cloud Bus æ¥åˆ°æ¶ˆæ¯åï¼Œä¼šé€šçŸ¥ç»™æ‰€æœ‰ Config å®¢æˆ·ç«¯ã€‚</li><li>Config å®¢æˆ·ç«¯æ¥æ”¶åˆ°é€šçŸ¥ï¼Œè¯·æ±‚ Config æœåŠ¡ç«¯æ‹‰å–æœ€æ–°é…ç½®ã€‚</li><li>æ‰€æœ‰ Config å®¢æˆ·ç«¯éƒ½è·å–åˆ°æœ€æ–°çš„é…ç½®ã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloudé›†æˆconsul</title>
    <link href="/SpringCloud%E9%9B%86%E6%88%90consul/"/>
    <url>/SpringCloud%E9%9B%86%E6%88%90consul/</url>
    
    <content type="html"><![CDATA[<h1 id="Consul"><a href="#Consul" class="headerlink" title="Consul"></a>Consul</h1><ul><li><p>Consul æ˜¯ä¸€å¥—å¼€æºçš„åˆ†å¸ƒå¼æœåŠ¡å‘ç°å’Œé…ç½®ç®¡ç†ç³»ç»Ÿï¼Œç”±HashCorpå…¬å¸ç”¨Goè¯­è¨€å¼€å‘</p></li><li><p>å®ƒæä¾›äº†å‡ ä¸ªå…³é”®åŠŸèƒ½ï¼š</p><ul><li>æœåŠ¡å‘ç°ï¼šConsul client å¯ä»¥æä¾›æœåŠ¡ï¼Œä¾‹å¦‚apiæˆ–mysqlï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Consul clientæ¥å‘ç°æŒ‡å®šæœåŠ¡çš„æä¾›è€…ã€‚ ä½¿ç”¨DNSæˆ–HTTPï¼Œåº”ç”¨ç¨‹åºå¯ä»¥è½»æ¾æ‰¾åˆ°ä»–ä»¬æ‰€ä¾èµ–çš„æœåŠ¡ã€‚</li><li>å¥åº·æ£€æŸ¥ï¼šConsul client å¯ä»¥æä¾›ä»»ä½•æ•°é‡çš„å¥åº·æ£€æŸ¥ï¼Œæˆ–è€…ä¸ç»™å®šçš„æœåŠ¡ï¼ˆâ€œWebæœåŠ¡å™¨æ˜¯å¦è¿”å›200 OKâ€ï¼‰ï¼Œæˆ–ä¸æœ¬åœ°èŠ‚ç‚¹ï¼ˆâ€œå†…å­˜åˆ©ç”¨ç‡æ˜¯å¦ä½äº90ï¼…â€ï¼‰ç›¸å…³è”ã€‚ å¯ä»¥ä½¿ç”¨æ­¤ä¿¡æ¯æ¥ç›‘æ§é›†ç¾¤è¿è¡ŒçŠ¶å†µï¼ŒæœåŠ¡å‘ç°ç»„ä»¶ä½¿ç”¨æ­¤ä¿¡æ¯å°†æµé‡ä»æœ‰é—®é¢˜çš„ä¸»æœºä¸­ç§»é™¤å‡ºå»ã€‚</li><li>KV Storeï¼šåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨Consulçš„åˆ†å±‚é”®&#x2F;å€¼å­˜å‚¨ï¼ŒåŒ…æ‹¬åŠ¨æ€é…ç½®ï¼ŒåŠŸèƒ½æ ‡è®°ï¼Œåè°ƒï¼Œleaderé€‰ä¸¾ç­‰ç­‰ã€‚ ç®€å•çš„HTTP APIä½¿å…¶æ˜“äºä½¿ç”¨ã€‚</li><li>å¤šæ•°æ®ä¸­å¿ƒï¼šConsulæ”¯æŒå¤šä¸ªæ•°æ®ä¸­å¿ƒã€‚ è¿™æ„å‘³ç€Consulçš„ç”¨æˆ·ä¸å¿…æ‹…å¿ƒæ„å»ºé¢å¤–çš„æŠ½è±¡å±‚ä»¥æ‰©å±•åˆ°å¤šä¸ªåŒºåŸŸã€‚</li></ul></li><li><p>ä½¿ç”¨åœºæ™¯</p><p>Consulçš„åº”ç”¨åœºæ™¯åŒ…æ‹¬æœåŠ¡å‘ç°ã€æœåŠ¡éš”ç¦»ã€æœåŠ¡é…ç½®ï¼š</p><ul><li><p>æœåŠ¡å‘ç°åœºæ™¯ä¸­consulä½œä¸ºæ³¨å†Œä¸­å¿ƒï¼ŒæœåŠ¡åœ°å€è¢«æ³¨å†Œåˆ°consulä¸­ä»¥åï¼Œå¯ä»¥ä½¿ç”¨consulæä¾›çš„dnsã€httpæ¥å£æŸ¥è¯¢ï¼Œconsulæ”¯æŒhealth checkã€‚</p></li><li><p>æœåŠ¡éš”ç¦»åœºæ™¯ä¸­consulæ”¯æŒä»¥æœåŠ¡ä¸ºå•ä½è®¾ç½®è®¿é—®ç­–ç•¥ï¼Œèƒ½åŒæ—¶æ”¯æŒç»å…¸çš„å¹³å°å’Œæ–°å…´çš„å¹³å°ï¼Œæ”¯æŒtlsè¯ä¹¦åˆ†å‘ï¼Œservice-to-serviceåŠ å¯†ã€‚</p></li><li><p>æœåŠ¡é…ç½®åœºæ™¯ä¸­consulæä¾›key-valueæ•°æ®å­˜å‚¨åŠŸèƒ½ï¼Œå¹¶ä¸”èƒ½å°†å˜åŠ¨è¿…é€Ÿåœ°é€šçŸ¥å‡ºå»ï¼Œé€šè¿‡å·¥å…·consul-templateå¯ä»¥æ›´æ–¹ä¾¿åœ°å®æ—¶æ¸²æŸ“é…ç½®æ–‡ä»¶ã€‚</p></li></ul></li></ul><h1 id="SpringCloudé›†æˆconsul"><a href="#SpringCloudé›†æˆconsul" class="headerlink" title="SpringCloudé›†æˆconsul"></a>SpringCloudé›†æˆconsul</h1><p><a href="https://www.springcloud.cc/spring-cloud-consul.html">Spring Cloud Consul ä¸­æ–‡æ–‡æ¡£ å‚è€ƒæ‰‹å†Œ ä¸­æ–‡ç‰ˆ</a></p><h2 id="1-consul-å®‰è£…å’Œå¯åŠ¨"><a href="#1-consul-å®‰è£…å’Œå¯åŠ¨" class="headerlink" title="1. consul å®‰è£…å’Œå¯åŠ¨"></a>1. consul å®‰è£…å’Œå¯åŠ¨</h2><p>å‚è€ƒ<a href="https://learn.hashicorp.com/tutorials/consul/get-started-install">Install Consul | Consul - HashiCorp Learn</a></p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q">âœ  ~ consul agent -<span class="hljs-built_in">dev</span><br></code></pre></td></tr></table></figure><p>è®¿é—®<a href="http://localhost:8500/">http://localhost:8500/</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232955363.png" alt="image-20230228232955363"></p><h2 id="2-å¼•å…¥ä¾èµ–"><a href="#2-å¼•å…¥ä¾èµ–" class="headerlink" title="2. å¼•å…¥ä¾èµ–"></a>2. å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs xml">plugins&#123;<br>id &#x27;org.springframework.boot&#x27; version &#x27;2.6.1&#x27;<br>id &#x27;io.spring.dependency-management&#x27; version &#x27;1.0.8.RELEASE&#x27;<br>id &#x27;java&#x27;<br>&#125;<br><br>ext &#123;<br>set(&#x27;springCloudVersion&#x27;, &quot;2021.0.0&quot;)<br>name = &#x27;Eureka Server&#x27;<br>description = &#x27;Eureka Server demo project&#x27;<br>version=&#x27;0.0.1-SNAPSHOT&#x27;<br>sourceEncoding=&#x27;UTF-8&#x27;<br>&#125;<br><br>repositories &#123;<br>mavenCentral()<br>maven &#123; url &#x27;https://repo.spring.io/release/&#x27; &#125;<br>maven &#123; url &quot;https://repo.spring.io/libs-snapshot-local&quot; &#125;<br>maven &#123; url &quot;https://repo.spring.io/libs-milestone-local&quot; &#125;<br>maven &#123; url &quot;https://repo.spring.io/libs-release-local&quot; &#125;<br>maven &#123; url &quot;https://repo.springsource.org/plugins-release&quot; &#125;<br>&#125;<br><br>dependencyManagement &#123;<br>imports &#123;<br>mavenBom &quot;org.springframework.cloud:spring-cloud-dependencies:$&#123;springCloudVersion&#125;&quot;<br>&#125;<br>&#125;<br><br>dependencies &#123;<br>//consul ä¾èµ–<br>implementation &#x27;org.springframework.cloud:spring-cloud-starter-consul-discovery&#x27;<br>implementation &#x27;org.springframework.boot:spring-boot-starter-web&#x27;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#3-ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="3.  ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>3.  ä¿®æ”¹é…ç½®æ–‡ä»¶</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml">server.port=9091<br><br>spring.application.name= micro-weather-consul<br>spring.cloud.consul.host= localhost<br>spring.cloud.consul.port= 8500<br>spring.cloud.consul.discovery.service-name= $&#123;spring.application.name&#125;<br># æ‰“å¼€å¿ƒè·³æœºåˆ¶<br>spring.cloud.consul.discovery.heartbeat.enabled= true<br></code></pre></td></tr></table></figure><h3 id="3-ä¿®æ”¹å¯åŠ¨ç±»"><a href="#3-ä¿®æ”¹å¯åŠ¨ç±»" class="headerlink" title="3. ä¿®æ”¹å¯åŠ¨ç±»"></a>3. ä¿®æ”¹å¯åŠ¨ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><span class="hljs-keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@EnableDiscoveryClient</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    SpringApplication.run(Application.class, args);<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="4-æµ‹è¯•"><a href="#4-æµ‹è¯•" class="headerlink" title="4.æµ‹è¯•"></a>4.æµ‹è¯•</h2><p>å†æ¬¡è®¿é—®<a href="http://localhost:8500/%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0micro-weather-consul%E6%9C%8D%E5%8A%A1%E5%B7%B2%E7%BB%8F%E6%B3%A8%E5%86%8C%E6%88%90%E5%8A%9F">http://localhost:8500/ï¼Œå¯ä»¥çœ‹åˆ°micro-weather-consulæœåŠ¡å·²ç»æ³¨å†ŒæˆåŠŸ</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228233006492.png" alt="image-20230228233006492"></p>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
      <tag>æ³¨å†Œä¸­å¿ƒ</tag>
      
      <tag>consul</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springCloudä¹‹Eurekaé›†ç¾¤æ­å»º</title>
    <link href="/springCloud%E4%B9%8BEureka%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/"/>
    <url>/springCloud%E4%B9%8BEureka%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="springCloudä¹‹Eurekaé›†ç¾¤æ­å»º"><a href="#springCloudä¹‹Eurekaé›†ç¾¤æ­å»º" class="headerlink" title="springCloudä¹‹Eurekaé›†ç¾¤æ­å»º"></a>springCloudä¹‹Eurekaé›†ç¾¤æ­å»º</h1><h2 id="1-æ­å»º3ä¸ªEureka-server"><a href="#1-æ­å»º3ä¸ªEureka-server" class="headerlink" title="1. æ­å»º3ä¸ªEureka server"></a>1. æ­å»º3ä¸ªEureka server</h2><ul><li><p>å‚è€ƒï¼š<a href="https://pyr9.github.io/2022/08/17/springCloud%E4%B9%8BEureka%E6%90%AD%E5%BB%BA/">springCloudä¹‹Eurekaæ­å»º - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p></li><li><p>ä¸‰ä¸ªeureka-serverçš„application.ymlæ–‡ä»¶å¦‚ä¸‹ï¼š</p><ul><li><p>eureka-server</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml">server.port: 8761<br><br>eureka.instance.hostname: localhost<br>#falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±ã€‚<br>eureka.client.registerWithEureka: false<br> #falseè¡¨ç¤ºè‡ªå·±ç«¯å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼Œæˆ‘çš„èŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡<br>eureka.client.fetchRegistry: false<br>#eureka.client.serviceUrl.defaultZone: http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/<br>eureka.client.serviceUrl.defaultZone: http://eureka8762.com:8762/eureka/,http://eureka8763.com:8763/eureka/<br></code></pre></td></tr></table></figure></li><li><p>eureka-server1</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml">server.port: 8762<br>spring.application.name = micro-weather-eureka-server2<br><br>eureka.instance.hostname: localhost<br>eureka.client.registerWithEureka: false<br>eureka.client.fetchRegistry: false<br>eureka.client.serviceUrl.defaultZone: http://eureka8761.com:8761/eureka/,http://eureka8763.com:8763/eureka/<br></code></pre></td></tr></table></figure></li><li><p>eureka-server2</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml">server.port: 8763<br>spring.application.name = micro-weather-eureka-server1<br><br>eureka.instance.hostname: localhost<br>eureka.client.registerWithEureka: false<br>eureka.client.fetchRegistry: false<br>eureka.client.serviceUrl.defaultZone: http://eureka8761.com:8761/eureka/,http://eureka8762.com:8762/eureka/<br></code></pre></td></tr></table></figure></li></ul></li></ul><h2 id="2-é…ç½®ä¸‰ä¸ªhostname"><a href="#2-é…ç½®ä¸‰ä¸ªhostname" class="headerlink" title="2.é…ç½®ä¸‰ä¸ªhostname"></a>2.é…ç½®ä¸‰ä¸ªhostname</h2><p>sudo vim &#x2F;etc&#x2F;hosts</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml">127.0.0.1       eureka8761.com<br>127.0.0.1       eureka8762.com<br>127.0.0.1       eureka8763.com<br></code></pre></td></tr></table></figure><h2 id="3-å¯åŠ¨ä¸‰ä¸ªeureka-serverï¼Œå¹¶è®¿é—®"><a href="#3-å¯åŠ¨ä¸‰ä¸ªeureka-serverï¼Œå¹¶è®¿é—®" class="headerlink" title="3. å¯åŠ¨ä¸‰ä¸ªeureka-serverï¼Œå¹¶è®¿é—®"></a>3. å¯åŠ¨ä¸‰ä¸ªeureka-serverï¼Œå¹¶è®¿é—®</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231901993.png" alt="image-20230228231901993"></p><p>æ³¨æ„âš ï¸ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231913871.png" alt="image-20230228231913871"></p><ul><li><p>è¿™é‡Œçš„æ„æ€å°±æ˜¯è¿™ä¸¤ä¸ªæ³¨å†Œä¸­å¿ƒæ˜¯å½“å‰æ³¨å†Œä¸­å¿ƒçš„é›†ç¾¤èŠ‚ç‚¹ï¼Œå½“å‰æ³¨å†Œä¸­å¿ƒä¼šä»è¿™ä¸¤ä¸ªèŠ‚ç‚¹åŒæ­¥æœåŠ¡</p></li><li><p>è¿™é‡Œæ˜¯é€šè¿‡hostnameè¾¨åˆ«çš„ï¼Œæ‰€ä»¥é…ç½®ymlå‚æ•°çš„æ—¶å€™éœ€è¦é…ç½®ä¸åŒçš„hostnameã€‚</p></li><li><p>è¿™é‡Œæœ‰æ˜¾ç¤ºé…ç½®çš„é›†ç¾¤èŠ‚ç‚¹ï¼Œå°±è¯æ˜é›†ç¾¤é…ç½®æˆåŠŸäº†ã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
      <tag>eureka</tag>
      
      <tag>é›†ç¾¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springCloudä¹‹é›†æˆzookeeper</title>
    <link href="/springCloud%E4%B9%8B%E9%9B%86%E6%88%90zookeeper/"/>
    <url>/springCloud%E4%B9%8B%E9%9B%86%E6%88%90zookeeper/</url>
    
    <content type="html"><![CDATA[<h1 id="zookeeper"><a href="#zookeeper" class="headerlink" title="zookeeper"></a>zookeeper</h1><ul><li>zookeeperåŸºæœ¬æ¦‚å¿µï¼š<a href="https://pyr9.github.io/2021/09/22/zookeeper%E7%89%B9%E6%80%A7%E4%B8%8E%E8%8A%82%E7%82%B9%E4%BB%8B%E7%BB%8D/">zookeeperç‰¹æ€§ä¸èŠ‚ç‚¹ä»‹ç» - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></li><li>zookeeper æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼åè°ƒæœåŠ¡ï¼Œå¯ä»¥ç”¨æ¥å®ç°æ³¨å†Œä¸­å¿ƒåŠŸèƒ½ï¼Œç±»ä¼¼eureka</li><li>æœåŠ¡èŠ‚ç‚¹æ˜¯ä¸´æ—¶ç»“ç‚¹</li></ul><h1 id="springCloudä¹‹é›†æˆzookeeper"><a href="#springCloudä¹‹é›†æˆzookeeper" class="headerlink" title="springCloudä¹‹é›†æˆzookeeper"></a>springCloudä¹‹é›†æˆzookeeper</h1><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>å¯åŠ¨zookeeper</p><h2 id="1-å¼•å…¥ä¾èµ–"><a href="#1-å¼•å…¥ä¾èµ–" class="headerlink" title="1.å¼•å…¥ä¾èµ–"></a>1.å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs xml">plugins&#123;<br>id &#x27;org.springframework.boot&#x27; version &#x27;2.6.1&#x27;<br>id &#x27;io.spring.dependency-management&#x27; version &#x27;1.0.8.RELEASE&#x27;<br>id &#x27;java&#x27;<br>&#125;<br><br>ext &#123;<br>set(&#x27;springCloudVersion&#x27;, &quot;2021.0.0&quot;)<br>name = &#x27;Eureka Server&#x27;<br>description = &#x27;Eureka Server demo project&#x27;<br>version=&#x27;0.0.1-SNAPSHOT&#x27;<br>sourceEncoding=&#x27;UTF-8&#x27;<br>&#125;<br><br>repositories &#123;<br>mavenCentral()<br>maven &#123; url &#x27;https://repo.spring.io/release/&#x27; &#125;<br>maven &#123; url &quot;https://repo.spring.io/libs-snapshot-local&quot; &#125;<br>maven &#123; url &quot;https://repo.spring.io/libs-milestone-local&quot; &#125;<br>maven &#123; url &quot;https://repo.spring.io/libs-release-local&quot; &#125;<br>maven &#123; url &quot;https://repo.springsource.org/plugins-release&quot; &#125;<br>&#125;<br><br>dependencyManagement &#123;<br>imports &#123;<br>mavenBom &quot;org.springframework.cloud:spring-cloud-dependencies:$&#123;springCloudVersion&#125;&quot;<br>&#125;<br>&#125;<br><br>dependencies &#123;<br>implementation &#x27;org.springframework.cloud:spring-cloud-starter-zookeeper-discovery&#x27;<br>implementation &#x27;org.springframework.boot:spring-boot-starter-web&#x27;<br>&#125;<br><br>test&#123;<br>useJUnitPlatform()<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#2-ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="2. ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>2. ä¿®æ”¹é…ç½®æ–‡ä»¶</h2><ul><li>é…ç½®æœåŠ¡çš„åç§°å’Œzookeeperçš„åœ°å€</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml">server.port=9091<br><br>spring.application.name: micro-weather-zookeeper<br>spring.cloud.zookeeper.connect-string: localhost:2181<br></code></pre></td></tr></table></figure><h2 id="3-ä¿®æ”¹å¯åŠ¨ç±»"><a href="#3-ä¿®æ”¹å¯åŠ¨ç±»" class="headerlink" title="3. ä¿®æ”¹å¯åŠ¨ç±»"></a>3. ä¿®æ”¹å¯åŠ¨ç±»</h2><ul><li>åŠ ä¸Š@EnableDiscoveryClientæ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><span class="hljs-keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@EnableDiscoveryClient</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    SpringApplication.run(Application.class, args);<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="4-è¿›å…¥zookeeperå®¢æˆ·ç«¯ï¼ŒæŸ¥çœ‹å·²ç»æ³¨å†Œçš„æœåŠ¡"><a href="#4-è¿›å…¥zookeeperå®¢æˆ·ç«¯ï¼ŒæŸ¥çœ‹å·²ç»æ³¨å†Œçš„æœåŠ¡" class="headerlink" title="4.è¿›å…¥zookeeperå®¢æˆ·ç«¯ï¼ŒæŸ¥çœ‹å·²ç»æ³¨å†Œçš„æœåŠ¡"></a>4.è¿›å…¥zookeeperå®¢æˆ·ç«¯ï¼ŒæŸ¥çœ‹å·²ç»æ³¨å†Œçš„æœåŠ¡</h2><p>å¯ä»¥çœ‹åˆ° micro-weather-zookeeperæœåŠ¡å·²ç»å­˜åœ¨ï¼ŒSpringCloudä»¥[Zookeeper]ä¸ºæ³¨å†Œä¸­å¿ƒæ•´åˆæˆåŠŸ</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228233716687.png" alt="image-20230228233716687"></p>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
      <tag>æ³¨å†Œä¸­å¿ƒ</tag>
      
      <tag>zookeeper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloudé›†æˆRibbon</title>
    <link href="/SpringCloud%E9%9B%86%E6%88%90Ribbon/"/>
    <url>/SpringCloud%E9%9B%86%E6%88%90Ribbon/</url>
    
    <content type="html"><![CDATA[<h1 id="è´Ÿè½½å‡è¡¡ï¼ˆload-balanceï¼‰"><a href="#è´Ÿè½½å‡è¡¡ï¼ˆload-balanceï¼‰" class="headerlink" title="è´Ÿè½½å‡è¡¡ï¼ˆload balanceï¼‰"></a>è´Ÿè½½å‡è¡¡ï¼ˆload balanceï¼‰</h1><ul><li>ç®€å•æ¥è¯´è´Ÿè½½å‡è¡¡å°±æ˜¯å°†å®¢æˆ·çš„è¯·æ±‚å¹³æ‘Šåˆ°å¤šä¸ªæœåŠ¡ä¸Šï¼Œä»è€Œè¾¾åˆ°ç³»ç»Ÿçš„é«˜å¯ç”¨ï¼Œå¸¸ç”¨çš„è´Ÿè½½å‡è¡¡æ–¹å¼æœ‰Nginxï¼ŒF5</li><li>å¸¸è§çš„è´Ÿè½½å‡è¡¡æ–¹å¼æœ‰ä¸¤ç§ï¼š<ul><li>æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡</li><li>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡</li></ul></li></ul><h2 id="æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡"><a href="#æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡" class="headerlink" title="æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡"></a>æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡</h2><h3 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h3><p>æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡æ˜¯æœ€å¸¸è§çš„è´Ÿè½½å‡è¡¡æ–¹å¼ï¼Œå…¶å·¥ä½œåŸç†å¦‚ä¸‹å›¾ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225113562.png" alt="image-20230228225113562"></p><ul><li>åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´å»ºç«‹ä¸€ä¸ªç‹¬ç«‹çš„è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨æ—¢å¯ä»¥æ˜¯ç¡¬ä»¶è®¾å¤‡ï¼ˆä¾‹å¦‚ F5ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯è½¯ä»¶ï¼ˆä¾‹å¦‚ Nginxï¼‰</li><li>è¿™ä¸ªè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ç»´æŠ¤äº†ä¸€ä»½å¯ç”¨æœåŠ¡ç«¯æ¸…å•ï¼Œç„¶åé€šè¿‡å¿ƒè·³æœºåˆ¶æ¥åˆ é™¤æ•…éšœçš„æœåŠ¡ç«¯èŠ‚ç‚¹ï¼Œä»¥ä¿è¯æ¸…å•ä¸­çš„æ‰€æœ‰æœåŠ¡èŠ‚ç‚¹éƒ½æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„ã€‚</li><li>å½“å®¢æˆ·ç«¯å‘é€è¯·æ±‚æ—¶ï¼Œè¯¥è¯·æ±‚ä¸ä¼šç›´æ¥å‘é€åˆ°æœåŠ¡ç«¯è¿›è¡Œå¤„ç†ï¼Œè€Œæ˜¯å…¨éƒ¨äº¤ç»™è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œç”±è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æŒ‰ç…§æŸç§ç®—æ³•ï¼ˆä¾‹å¦‚è½®è¯¢ã€éšæœºç­‰ï¼‰ï¼Œä»å…¶ç»´æŠ¤çš„å¯ç”¨æœåŠ¡æ¸…å•ä¸­é€‰æ‹©ä¸€ä¸ªæœåŠ¡ç«¯ï¼Œç„¶åè¿›è¡Œè½¬å‘ã€‚</li></ul><h3 id="æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡çš„ç‰¹ç‚¹"><a href="#æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡çš„ç‰¹ç‚¹" class="headerlink" title="æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡çš„ç‰¹ç‚¹"></a>æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡çš„ç‰¹ç‚¹</h3><p>æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>éœ€è¦å»ºç«‹ä¸€ä¸ªç‹¬ç«‹çš„è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ã€‚</li><li>è´Ÿè½½å‡è¡¡æ˜¯åœ¨å®¢æˆ·ç«¯å‘é€è¯·æ±‚åè¿›è¡Œçš„ï¼Œå› æ­¤å®¢æˆ·ç«¯å¹¶ä¸çŸ¥é“åˆ°åº•æ˜¯å“ªä¸ªæœåŠ¡ç«¯æä¾›çš„æœåŠ¡ã€‚</li><li>å¯ç”¨æœåŠ¡ç«¯æ¸…å•å­˜å‚¨åœ¨è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ä¸Šã€‚</li></ul><h2 id="å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡"><a href="#å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡" class="headerlink" title="å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡"></a>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡</h2><p>ç›¸è¾ƒäºæœåŠ¡ç«¯è´Ÿè½½å‡è¡¡ï¼Œå®¢æˆ·ç«¯æœåŠ¡æ˜¯å°†è´Ÿè½½å‡è¡¡é€»è¾‘ä»¥ä»£ç çš„å½¢å¼å°è£…åˆ°å®¢æˆ·ç«¯ä¸Š</p><h3 id="å·¥ä½œåŸç†-1"><a href="#å·¥ä½œåŸç†-1" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h3><p>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„å·¥ä½œåŸç†å¦‚ä¸‹å›¾ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225122260.png" alt="image-20230228225122260"></p><ul><li>å®¢æˆ·ç«¯é€šè¿‡æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ˆä¾‹å¦‚ Eureka Serverï¼‰è·å–åˆ°ä¸€ä»½æœåŠ¡ç«¯æä¾›çš„å¯ç”¨æœåŠ¡æ¸…å•ã€‚</li><li>æœ‰äº†æœåŠ¡æ¸…å•åï¼Œè´Ÿè½½å‡è¡¡å™¨ä¼šåœ¨å®¢æˆ·ç«¯å‘é€è¯·æ±‚å‰é€šè¿‡è´Ÿè½½å‡è¡¡ç®—æ³•ï¼ˆå¦‚ç®€å•è½®è®­ï¼Œéšæœºè¿æ¥ç­‰ï¼‰é€‰æ‹©ä¸€ä¸ªæœåŠ¡ç«¯å®ä¾‹å†è¿›è¡Œè®¿é—®</li><li>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ä¹Ÿéœ€è¦å¿ƒè·³æœºåˆ¶å»ç»´æŠ¤æœåŠ¡ç«¯æ¸…å•çš„æœ‰æ•ˆæ€§ï¼Œè¿™ä¸ªè¿‡ç¨‹éœ€è¦é…åˆæœåŠ¡æ³¨å†Œä¸­å¿ƒä¸€èµ·å®Œæˆã€‚</li></ul><h3 id="å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„ç‰¹ç‚¹ï¼š"><a href="#å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„ç‰¹ç‚¹ï¼š" class="headerlink" title="å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„ç‰¹ç‚¹ï¼š"></a>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„ç‰¹ç‚¹ï¼š</h3><ul><li><p>è´Ÿè½½å‡è¡¡å™¨ä½äºå®¢æˆ·ç«¯ï¼Œä¸éœ€è¦å•ç‹¬æ­å»ºä¸€ä¸ªè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ã€‚</p></li><li><p>è´Ÿè½½å‡è¡¡æ˜¯åœ¨å®¢æˆ·ç«¯å‘é€è¯·æ±‚å‰è¿›è¡Œçš„ï¼Œå› æ­¤å®¢æˆ·ç«¯æ¸…æ¥šåœ°çŸ¥é“æ˜¯å“ªä¸ªæœåŠ¡ç«¯æä¾›çš„æœåŠ¡ã€‚</p></li><li><p>å®¢æˆ·ç«¯éƒ½ç»´æŠ¤äº†ä¸€ä»½å¯ç”¨æœåŠ¡æ¸…å•ï¼Œè€Œè¿™ä»½æ¸…å•éƒ½æ˜¯ä»æœåŠ¡æ³¨å†Œä¸­å¿ƒè·å–çš„ã€‚</p></li></ul><h2 id="Ribbonå’ŒNginxå®ç°è´Ÿè½½å‡è¡¡çš„åŒºåˆ«"><a href="#Ribbonå’ŒNginxå®ç°è´Ÿè½½å‡è¡¡çš„åŒºåˆ«" class="headerlink" title="Ribbonå’ŒNginxå®ç°è´Ÿè½½å‡è¡¡çš„åŒºåˆ«"></a>Ribbonå’ŒNginxå®ç°è´Ÿè½½å‡è¡¡çš„åŒºåˆ«</h2><ul><li>Ribbon å°±æ˜¯ä¸€ä¸ªåŸºäº HTTP å’Œ TCP çš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨ï¼Œå½“æˆ‘ä»¬å°† Ribbon å’Œ Eureka ä¸€èµ·ä½¿ç”¨æ—¶ï¼ŒRibbon ä¼šä» Eureka Serverï¼ˆæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼‰ä¸­è·å–æœåŠ¡ç«¯åˆ—è¡¨ï¼Œç„¶åé€šè¿‡è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼ˆå¦‚ç®€å•è½®è®­ï¼Œéšæœºè¿æ¥ç­‰ï¼‰ï¼Œä»æœåŠ¡ç«¯åˆ—è¡¨é€‰æ‹©ä¸€ä¸ªæœåŠ¡å®ä¾‹è¿›è¡Œè®¿é—®ï¼Œä»è€Œè¾¾åˆ°è´Ÿè½½å‡è¡¡çš„ç›®çš„ã€‚</li><li>è€ŒNginxæ˜¯æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡ï¼Œå®¢æˆ·ç«¯çš„æ‰€æœ‰è¯·æ±‚ä¼šäº¤ç»™Nginxï¼Œç„¶åNginxå®ç°è½¬å‘è¯·æ±‚</li></ul><h1 id="Ribbon"><a href="#Ribbon" class="headerlink" title="Ribbon"></a>Ribbon</h1><ul><li>ribbonæ˜¯Netflixå¼€å‘çš„ä¸€æ¬¾è´Ÿè½½å‡è¡¡çš„æœåŠ¡è°ƒç”¨ç»„ä»¶ï¼Œå…·æœ‰å¤šç§è´Ÿè½½å‡è¡¡è°ƒç”¨ç­–ç•¥ï¼› </li><li>Ribbon æ˜¯ Spring Cloud Netflix æ¨¡å—çš„å­æ¨¡å—ï¼Œå®ƒæ˜¯ Spring Cloud å¯¹ Netflix Ribbon çš„äºŒæ¬¡å°è£…ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥å°†é¢å‘æœåŠ¡çš„ RestTemplateè¯·æ±‚è½¬æ¢ä¸ºå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„æœåŠ¡è°ƒç”¨ã€‚</li><li>ç®€å•æ¥è¯´ï¼Œrubbon &#x3D; è´Ÿè½½å‡è¡¡+ restTemplate</li></ul><h1 id="Ribbon-å®ç°æœåŠ¡è°ƒç”¨"><a href="#Ribbon-å®ç°æœåŠ¡è°ƒç”¨" class="headerlink" title="Ribbon å®ç°æœåŠ¡è°ƒç”¨"></a>Ribbon å®ç°æœåŠ¡è°ƒç”¨</h1><ol><li><p>æ­å»ºEureka Client : <a href="https://pyr9.github.io/2022/08/17/springCloud%E4%B9%8BEureka%E6%90%AD%E5%BB%BA/">springCloudä¹‹Eurekaæ­å»º - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p></li><li><p>å¼•å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">implementation &#x27;org.springframework.cloud:spring-cloud-starter-netflix-ribbon&#x27;<br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹application.properties</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml">server.port=8085<br>spring.application.name: micro-weather-eureka-client-ribbon<br>eureka.client.serviceUrl.defaultZone: http://localhost:8761//eureka/<br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹å¯åŠ¨ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@EnableDiscoveryClient</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> </span>&#123;<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    SpringApplication.run(Application.class, args);<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>åˆ›å»ºä¸€ä¸ªåä¸º RestConfiguration çš„é…ç½®ç±»ï¼Œå°† RestTemplate æ³¨å…¥åˆ°å®¹å™¨ä¸­ï¼Œä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather.config;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.web.client.RestTemplateBuilder;<br><span class="hljs-keyword">import</span> org.springframework.cloud.client.loadbalancer.LoadBalanced;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.client.RestTemplate;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RestConfiguration</span> </span>&#123;<br><br>  <span class="hljs-meta">@Autowired</span><br>  <span class="hljs-keyword">private</span> RestTemplateBuilder restTemplateBuilder;<br><br>  <span class="hljs-meta">@Bean</span><br>  <span class="hljs-meta">@LoadBalanced</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> RestTemplate <span class="hljs-title">restTemplate</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> restTemplateBuilder.build();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>åˆ›å»ºä¸€ä¸ªCityControlleræ¥å®ç°é€šè¿‡restTemplateå¯¹æœåŠ¡çš„è°ƒç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><span class="hljs-keyword">import</span> org.springframework.web.client.RestTemplate;<br><br><span class="hljs-keyword">import</span> java.util.Objects;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CityController</span> </span>&#123;<br><br>  <span class="hljs-meta">@Autowired</span><br>  <span class="hljs-keyword">private</span> RestTemplate restTemplate;<br><br>  <span class="hljs-comment">//é¢å‘å¾®æœåŠ¡ç¼–ç¨‹ï¼Œå³é€šè¿‡å¾®æœåŠ¡çš„åç§°æ¥è·å–è°ƒç”¨åœ°å€</span><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String REST_URL_PREFIX = <span class="hljs-string">&quot;http://micro-weather-city-eureka&quot;</span>;<br><br>  <span class="hljs-meta">@RequestMapping(&quot;/cities&quot;)</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">listCity</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> restTemplate.getForObject(REST_URL_PREFIX + <span class="hljs-string">&quot;/cities&quot;</span>, String.class);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>è®¿é—®[localhost:8085&#x2F;citiesï¼Œå¯ä»¥è·å–åˆ°æŒ‡å®šæœåŠ¡æ¥å£çš„è¿”å›</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225138488.png" alt="image-20230228225138488"></p></li></ol><h1 id="Ribbon-å®ç°è´Ÿè½½å‡è¡¡"><a href="#Ribbon-å®ç°è´Ÿè½½å‡è¡¡" class="headerlink" title="Ribbon å®ç°è´Ÿè½½å‡è¡¡"></a>Ribbon å®ç°è´Ÿè½½å‡è¡¡</h1><p>java -jar msa-weather-city-eureka-0.0.1-SNAPSHOT.jar â€“server.port&#x3D;8084</p><p>java -jar msa-weather-city-eureka-0.0.1-SNAPSHOT.jar â€“server.port&#x3D;8083</p><p>java -jar msa-weather-city-eureka-0.0.1-SNAPSHOT.jar â€“server.port&#x3D;8086</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228233156385.png" alt="image-20230228233156385"></p><p>å†æ¬¡è®¿é—®<a href="http://localhost:8085/cities">localhost:8085&#x2F;cities</a></p>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
      <tag>è´Ÿè½½å‡è¡¡</tag>
      
      <tag>Ribbon</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springCloudä¹‹è‡ªåŠ¨æ‰©å±•</title>
    <link href="/springCloud%E4%B9%8B%E8%87%AA%E5%8A%A8%E6%89%A9%E5%B1%95/"/>
    <url>/springCloud%E4%B9%8B%E8%87%AA%E5%8A%A8%E6%89%A9%E5%B1%95/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‰©å±•ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‰©å±•ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‰©å±•ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‰©å±•ï¼Ÿ</h1><p>è‡ªåŠ¨æ‰©å±•åˆ†ä¸ºæ°´å¹³æ‰©å±•å’Œå‚ç›´æ‰©å±•</p><ul><li>æ°´å¹³æ‰©å±•å°±æ˜¯ä¸€å°æœºå­ä¸å¤Ÿäº†ï¼Œå°±å†æå‡ å°</li><li>å‚ç›´æ‰©å±•æ˜¯ç¡¬ä»¶å±‚é¢çš„ï¼Œæ¯”å¦‚åŒæ ¸ä¸å¤Ÿäº†ï¼Œå°±4æ ¸</li></ul><h1 id="è‡ªåŠ¨æ‰©å±•çš„æ„ä¹‰"><a href="#è‡ªåŠ¨æ‰©å±•çš„æ„ä¹‰" class="headerlink" title="è‡ªåŠ¨æ‰©å±•çš„æ„ä¹‰"></a>è‡ªåŠ¨æ‰©å±•çš„æ„ä¹‰</h1><ul><li>æé«˜äº†é«˜å¯ç”¨æ€§å’Œå®¹é”™èƒ½åŠ›ã€‚æ¯”å¦‚æŸä¸ªæœåŠ¡ä¸å¯ç”¨äº†ï¼Œè‡ªåŠ¨æ‰©å±•å¯ä»¥å†å¢åŠ ä¸€ä¸ªæ–°æœåŠ¡æ¥æ›¿æ¢ä»–ã€‚</li><li>å¢åŠ äº†å¯ä¼¸ç¼©æ€§ã€‚å…è®¸è®¿é—®æµé‡å¯ä»¥è‡ªåŠ¨é€‰æ‹©æ°´å¹³æ‰©å±•çš„è§„æ¨¡ã€‚</li><li>å…·æœ‰æœ€ä½³ä½¿ç”¨ç‡ï¼Œå¹¶èŠ‚çº¦æˆæœ¬ã€‚æŒ‰éœ€ä½¿ç”¨ï¼Œéœ€è¦å‡ å°å°±éƒ¨ç½²å‡ å°</li><li>ä¼˜å…ˆè€ƒè™‘æŸäº›æœåŠ¡æˆ–æœåŠ¡ç»„ã€‚ä½ä¼˜å…ˆçº§æœåŠ¡ä¸­å®ä¾‹ç§»é™¤ï¼Œæ·»åŠ åˆ°é«˜ä¼˜å…ˆçº§çš„æœåŠ¡å®ä¾‹ä¸­ã€‚</li></ul><h1 id="è‡ªåŠ¨æ‰©å±•çš„å¸¸ç”¨æ–¹æ³•"><a href="#è‡ªåŠ¨æ‰©å±•çš„å¸¸ç”¨æ–¹æ³•" class="headerlink" title="è‡ªåŠ¨æ‰©å±•çš„å¸¸ç”¨æ–¹æ³•"></a>è‡ªåŠ¨æ‰©å±•çš„å¸¸ç”¨æ–¹æ³•</h1><ul><li>èµ„æºé™åˆ¶ã€‚æ¯”å¦‚Cpuä½¿ç”¨ç‡&gt;60%</li><li>ç‰¹å®šæ—¶é—´æ®µã€‚æŒ‡å®šæ—¶é—´å»æ‰©å±•</li><li>æ¶ˆæ¯é•¿åº¦ã€‚æ¶ˆæ¯é˜Ÿåˆ—çš„é•¿åº¦&gt; è®¾ç½®çš„é•¿åº¦ï¼ˆæ­¤æ—¶é˜Ÿåˆ—é‡Œå †ç§¯çš„æ¶ˆæ¯å¤ªå¤šäº†ï¼‰å°±å»æ‰©å±•</li><li>ä¸šåŠ¡äº‹ä»¶ã€‚æ¯”å¦‚æ–°äº§ç”Ÿäº†10ç¬”è®¢å•ï¼Œå°±å¢åŠ ä¸€ä¸ªå®ä¾‹</li><li>æ ¹æ®é¢„æµ‹<ul><li>å†å²ä¿¡æ¯</li><li>å½“å‰è¶‹åŠ¿</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
      <tag>è‡ªåŠ¨æ‰©å±•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springCloudä¹‹é›†æˆHystrix</title>
    <link href="/springCloud%E4%B9%8B%E9%9B%86%E6%88%90Hystrix/"/>
    <url>/springCloud%E4%B9%8B%E9%9B%86%E6%88%90Hystrix/</url>
    
    <content type="html"><![CDATA[<h1 id="æœåŠ¡ç†”æ–­"><a href="#æœåŠ¡ç†”æ–­" class="headerlink" title="æœåŠ¡ç†”æ–­"></a>æœåŠ¡ç†”æ–­</h1><h2 id="ä»€ä¹ˆæ˜¯æœåŠ¡ç†”æ–­ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æœåŠ¡ç†”æ–­ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æœåŠ¡ç†”æ–­ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æœåŠ¡ç†”æ–­ï¼Ÿ</h2><ul><li><p>æœåŠ¡ç†”æ–­å°±æ˜¯å¯¹æœåŠ¡çš„è°ƒç”¨æ‰§è¡Œç†”æ–­ï¼Œå¯¹äºåç»­çš„è¯·æ±‚ï¼Œä¸å†è°ƒç”¨ç›®æ ‡æœåŠ¡ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›ä¸€ä¸ªåˆç†çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´è¯·æ±‚é‡å¤ªå¤§ï¼Œè¿”å›ä¸€ä¸ªâ€æ­¤æ—¶æœåŠ¡è¿‡è½½â€ï¼Œä»è€Œå¯ä»¥å¿«é€Ÿé‡Šæ”¾èµ„æº</p></li><li><p>ä¿æŠ¤ç³»ç»Ÿ</p></li></ul><h2 id="ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§ç†”æ–­æœºåˆ¶çš„å‡ºç°"><a href="#ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§ç†”æ–­æœºåˆ¶çš„å‡ºç°" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§ç†”æ–­æœºåˆ¶çš„å‡ºç°?"></a>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§ç†”æ–­æœºåˆ¶çš„å‡ºç°?</h2><p>åœ¨å¾®æœåŠ¡ç›¸äº’è°ƒç”¨çš„æ—¶å€™å¯èƒ½ä¼šå‡ºç°æœåŠ¡è°ƒç”¨å‘ç”Ÿå¼‚å¸¸æˆ–è°ƒç”¨è¶…æ—¶,å¤šæ­¤è¯·æ±‚é€ æˆæœåŠ¡ç§¯å‹å¯¼è‡´æœåŠ¡æ— æ³•ä½¿ç”¨åæ¥ç€çº§è”å¯¼è‡´è°ƒç”¨æ­¤æœåŠ¡çš„æ¶ˆè´¹è€…ä¹Ÿå‡ºç°å¼‚å¸¸æˆ–è°ƒç”¨è¶…æ—¶,æœ€åå¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„å…¨éƒ¨å´©æºƒ.è¿™å°±æ˜¯é›ªå´©æ•ˆåº”.</p><blockquote><p><a href="https://so.csdn.net/so/search?q=%E7%BA%A7%E8%81%94&spm=1001.2101.3001.7020">çº§è”</a>(å¤±è´¥)é›ªå´©ï¼šä¸€ä¸ªæœåŠ¡å¤±è´¥ï¼Œå¯¼è‡´æ•´æ¡é“¾è·¯çš„æœåŠ¡éƒ½å¤±è´¥çš„æƒ…å½¢ã€‚</p></blockquote><h2 id="ç†”æ–­çš„æ„ä¹‰ï¼Ÿ"><a href="#ç†”æ–­çš„æ„ä¹‰ï¼Ÿ" class="headerlink" title="ç†”æ–­çš„æ„ä¹‰ï¼Ÿ"></a>ç†”æ–­çš„æ„ä¹‰ï¼Ÿ</h2><ul><li>è®©ç³»ç»Ÿæ›´åŠ ç¨³å®š</li><li>å‡å°‘æ€§èƒ½æŸè€—<ul><li>å“åº”å¾ˆç®€å•ï¼Œæ‰€ä»¥äº§ç”Ÿçš„æ€§èƒ½å¾ˆå°ã€‚</li><li>ç”¨æˆ·çŸ¥é“æœåŠ¡æœ‰é—®é¢˜äº†ï¼Œå°±ä¸å†è°ƒç”¨ï¼Œé¿å…ä¸€ç›´é‡è¯•ï¼Œä¹Ÿå¯ä»¥å‡å°‘æ€§èƒ½æŸè€—ã€‚</li></ul></li><li>åŠæ—¶å“åº”ã€‚ä¸éœ€è¦å…¶ä»–è®¡ç®—ï¼Œç›´æ¥å°±å¯ä»¥è¿”å›ä¸€ä¸ªç®€å•çš„å“åº”ã€‚</li><li>é˜€å€¼å¯å®šåˆ¶ï¼Œæ¯”å¦‚è¯·æ±‚åˆ°è¾¾10000ï¼Œå°±å¼€å¯ç†”æ–­å™¨</li></ul><h2 id="ç†”æ–­å™¨çš„åŠŸèƒ½"><a href="#ç†”æ–­å™¨çš„åŠŸèƒ½" class="headerlink" title="ç†”æ–­å™¨çš„åŠŸèƒ½"></a>ç†”æ–­å™¨çš„åŠŸèƒ½</h2><ul><li>å¼‚å¸¸å¤„ç†ã€‚éœ€è¦å¯ä»¥æ ¹æ®å¼‚å¸¸çš„ç±»å‹ï¼Œå»å¤„ç†å¼‚å¸¸</li><li>æ—¥å¿—è®°å½•ã€‚è®°å½•å¤±è´¥çš„æ•°ç›®ï¼Œæ‰å¯ä»¥å¼€å¯ç†”æ–­</li><li>æµ‹è¯•å¤±è´¥çš„æ“ä½œã€‚å‘¨æœŸæ€§çš„æ£€æŸ¥æ¥æµ‹è¯•æœåŠ¡æ˜¯å¦å¥åº·ã€‚</li><li>æ‰‹åŠ¨å¤ä½ã€‚ç®¡ç†å‘˜å¯ä»¥å¼ºè¡Œå…³é—­æ–­è·¯å™¨ï¼Œé‡ç½®æ•…éšœçš„è®¡æ•°å™¨</li><li>å¹¶å‘ã€‚æ–­è·¯å™¨å¯ä»¥æ”¯æŒå¤§å¹¶å‘é‡</li><li>åŠ é€Ÿæ–­è·¯ï¼šæ£€æµ‹å‡ºé—®é¢˜çš„é€Ÿåº¦è¦å¿«ï¼ŒåŠæ—¶å“åº”</li><li>é‡è¯•å¤±è´¥è¯·æ±‚ï¼šåœ¨æœåŠ¡å¯ç”¨æ—¶ï¼Œå¯ä»¥å®‰æ’é‡è¯•</li></ul><h2 id="ç†”æ–­å’Œé™çº§çš„åŒºåˆ«"><a href="#ç†”æ–­å’Œé™çº§çš„åŒºåˆ«" class="headerlink" title="ç†”æ–­å’Œé™çº§çš„åŒºåˆ«"></a>ç†”æ–­å’Œé™çº§çš„åŒºåˆ«</h2><p>ç›¸åŒç‚¹ï¼š</p><ul><li>ç›®çš„ä¸€è‡´ã€‚é€šè¿‡æŠ€æœ¯æ‰‹æ®µæ¥ä¿æŠ¤ç³»ç»Ÿ</li><li>è¡¨ç°ç±»ä¼¼ï¼šè®©ç”¨æˆ·ä½“éªŒåˆ°æŸäº›æœåŠ¡æš‚æ—¶ä¸å¯ç”¨</li><li>ç²’åº¦ç›¸åŒï¼šéƒ½æ˜¯åŸºäºæœåŠ¡çš„</li></ul><p>ä¸åŒç‚¹</p><ul><li>è§¦å‘æ¡ä»¶ä¸åŒ<ul><li>æœåŠ¡ç†”æ–­ï¼šæœåŠ¡ç†”æ–­ç”±é“¾è·¯ä¸ŠæŸä¸ªæœåŠ¡æ•…éšœå¼•èµ·çš„</li><li>æœåŠ¡é™çº§ï¼Œæ•´ä½“è´Ÿè·æ¥è€ƒè™‘ã€‚æ¯”å¦‚ï¼šåŸæœ¬æœ‰ä¸€ä¸ªç³»ç»Ÿå¯ä»¥æ‰¿è½½100ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯åé¢ç”±äºè¯·æ±‚æ•°é™ä½ï¼Œç›¸åº”çš„æœåŠ¡æ•°é‡ä¹Ÿéœ€è¦é™ä½</li></ul></li><li>ç®¡ç†ç›®æ ‡å±‚çº§ä¸åŒ<ul><li>æœåŠ¡ç†”æ–­ï¼šæœåŠ¡ç†”æ–­æ˜¯ä¸€ä¸ªæ¡†æ¶å±‚æ¬¡çš„å¤„ç†ï¼Œ</li><li>æœåŠ¡é™çº§ï¼šæœåŠ¡é™çº§æ˜¯ä¸šåŠ¡å±‚æ¬¡çš„å¤„ç†ã€‚é™çº§ä¸€èˆ¬æ˜¯ä»å¤–å›´æœåŠ¡å¼€å§‹</li></ul></li></ul><h1 id="hystrix"><a href="#hystrix" class="headerlink" title="hystrix"></a>hystrix</h1><h2 id="hystrixæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#hystrixæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="hystrixæ˜¯ä»€ä¹ˆï¼Ÿ"></a>hystrixæ˜¯ä»€ä¹ˆï¼Ÿ</h2><ul><li>Feignæ˜¯Netflixå¼€å‘çš„ä¸€æ¬¾æœåŠ¡å®¹é”™å’Œä¿æŠ¤ç»„ä»¶</li></ul><h2 id="SpringCloud-é›†æˆhystrix"><a href="#SpringCloud-é›†æˆhystrix" class="headerlink" title="SpringCloud é›†æˆhystrix"></a>SpringCloud é›†æˆhystrix</h2><ol><li><p>æ­å»ºEureka Clientå¹¶é›†æˆFeign ï¼š<a href="https://pyr9.github.io/2022/08/18/springCloud%E4%B9%8BFeign%E6%90%AD%E5%BB%BA/">springCloudä¹‹Feignæ­å»º - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p></li><li><p>å¯¼å…¥ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;org.springframework.cloud:spring-cloud-starter-netflix-hystrix&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>å¯åŠ¨ç±»åŠ ä¸Š@EnableCircuitBreakeræ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><span class="hljs-keyword">import</span> org.springframework.cloud.client.circuitbreaker.EnableCircuitBreaker;<br><span class="hljs-keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;<br><span class="hljs-keyword">import</span> org.springframework.cloud.openfeign.EnableFeignClients;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@EnableDiscoveryClient</span><br><span class="hljs-meta">@EnableFeignClients</span><br><span class="hljs-meta">@EnableCircuitBreaker</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    SpringApplication.run(Application.class, args);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>propertiesä¿®æ”¹é…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml">server.port=8085<br>spring.application.name: micro-weather-eureka-client-feign-hystrix<br>eureka.client.serviceUrl.defaultZone: http://localhost:8761//eureka/<br>feign.client.config.feignName.connectTimeout: 5000<br>feign.client.config.feignName.readTimeout: 5000<br><br># å¼€å¯feign.hystrix<br>feign.hystrix.enabled=true<br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹CityClient</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FeignClient(name=&quot;micro-weather-city-eureka&quot;, fallback = CityClientFallBack.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CityClient</span> </span>&#123;<br>  <span class="hljs-meta">@RequestMapping(&quot;/cities&quot;)</span><br>  <span class="hljs-function">String <span class="hljs-title">listCity</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å®šä¹‰CityClientFallBackå®ç°CityClient</p></li></ol>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather.service;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CityClientFallBack</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CityClient</span></span>&#123;<br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">listCity</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;City is empty!&quot;</span>;<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><ol start="7"><li><p>è®¿é—®<a href="http://localhost:8085/cities">localhost:8085&#x2F;cities</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232404189.png" alt="image-20230228232404189"></p></li></ol><p><strong>å¦ä¸€ç§å®ç°æ–¹å¼</strong></p><ol><li><p>ä¿®æ”¹ä¸šåŠ¡ç±»ï¼Œä½¿ç”¨@HystrixCommand(fallbackMethod&#x3D;XXX)ï¼ŒæŒ‡æ˜ç†”æ–­æ—¶è°ƒç”¨çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather.controller;<br><br><span class="hljs-keyword">import</span> com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;<br><span class="hljs-keyword">import</span> com.pyr.spring.cloud.weather.service.CityClient;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CityController</span> </span>&#123;<br>  <span class="hljs-meta">@Autowired</span><br>  <span class="hljs-keyword">private</span> CityClient cityClient;<br><br>  <span class="hljs-meta">@RequestMapping(&quot;/cities&quot;)</span><br>  <span class="hljs-meta">@HystrixCommand(fallbackMethod=&quot;defaultCities&quot;)</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">listCity</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> cityClient.listCity();<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">defaultCities</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Micro weather city eureka is down!&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><ul><li><p>CityClientä¸éœ€è¦ä¿®æ”¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather.service;<br><br><span class="hljs-keyword">import</span> org.springframework.cloud.openfeign.FeignClient;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><br><span class="hljs-meta">@FeignClient(name=&quot;micro-weather-city-eureka&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CityClient</span> </span>&#123;<br>  <span class="hljs-meta">@RequestMapping(&quot;/cities&quot;)</span><br>  <span class="hljs-function">String <span class="hljs-title">listCity</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><ol start="5"><li><p>åœæ­¢micro-weather-city-eurekaæœåŠ¡ï¼Œè®¿é—®<a href="http://localhost:8085/cities">localhost:8085&#x2F;cities</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232412332.png" alt="image-20230228232412332"></p></li></ol><p>æ³¨ï¼šè¿™ç§æ–¹å¼ä¸éœ€è¦æ·»åŠ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">feign.hystrix.enabled=<span class="hljs-keyword">true</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
      <tag>æœåŠ¡ç†”æ–­</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springCloudç½‘å…³</title>
    <link href="/springCloud%E7%BD%91%E5%85%B3/"/>
    <url>/springCloud%E7%BD%91%E5%85%B3/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ç½‘å…³æ˜¯ä»€ä¹ˆ"><a href="#1-ç½‘å…³æ˜¯ä»€ä¹ˆ" class="headerlink" title="1.ç½‘å…³æ˜¯ä»€ä¹ˆ"></a>1.ç½‘å…³æ˜¯ä»€ä¹ˆ</h1><h2 id="1-1-ç½‘å…³äº§ç”Ÿçš„åŸå› ï¼Ÿ"><a href="#1-1-ç½‘å…³äº§ç”Ÿçš„åŸå› ï¼Ÿ" class="headerlink" title="1.1 ç½‘å…³äº§ç”Ÿçš„åŸå› ï¼Ÿ"></a>1.1 ç½‘å…³äº§ç”Ÿçš„åŸå› ï¼Ÿ</h2><ol><li><p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸€ä¸ªç³»ç»Ÿå¾€å¾€ç”±å¤šä¸ªå¾®æœåŠ¡ç»„æˆï¼Œè€Œè¿™äº›æœåŠ¡å¯èƒ½éƒ¨ç½²åœ¨ä¸åŒæœºæˆ¿ã€ä¸åŒåœ°åŒºã€ä¸åŒåŸŸåä¸‹ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯æƒ³è¦ç›´æ¥è¯·æ±‚è¿™äº›æœåŠ¡ï¼Œå°±éœ€è¦çŸ¥é“å®ƒä»¬å…·ä½“çš„åœ°å€ä¿¡æ¯ï¼Œä¾‹å¦‚ IP åœ°å€ã€ç«¯å£å·ç­‰ã€‚è¿™ç§å®¢æˆ·ç«¯ç›´æ¥è¯·æ±‚æœåŠ¡çš„æ–¹å¼å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li><p>å½“æœåŠ¡æ•°é‡ä¼—å¤šæ—¶ï¼Œå®¢æˆ·ç«¯éœ€è¦ç»´æŠ¤å¤§é‡çš„æœåŠ¡åœ°å€ï¼Œè¿™å¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œæ˜¯éå¸¸ç¹çå¤æ‚çš„ã€‚</p></li><li><p>åœ¨æŸäº›åœºæ™¯ä¸‹å¯èƒ½ä¼šå­˜åœ¨è·¨åŸŸè¯·æ±‚çš„é—®é¢˜ã€‚</p></li><li><p>èº«ä»½è®¤è¯çš„éš¾åº¦å¤§ï¼Œæ¯ä¸ªå¾®æœåŠ¡éœ€è¦ç‹¬ç«‹è®¤è¯ã€‚</p></li></ul></li><li><p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæ¯ä¸ªæœåŠ¡éƒ½æœ‰å¯¹å¤–æä¾›æœåŠ¡çš„åœ°å€å’Œç«¯å£ï¼Œéƒ½æœ‰ä¸€äº›<strong>å…±åŒçš„åŠŸèƒ½</strong>ï¼Œæ¯”å¦‚ï¼š<strong>æƒé™æ ¡éªŒã€æ—¥å¿—è®°å½•ã€é™æµã€ç†”æ–­ã€ç›‘æ§</strong>ç­‰ç­‰ã€‚å¦‚æœä»»ç”±æ¯ä¸ªæœåŠ¡ç‹¬ç«‹å¯¹å¤–æä¾›æ¥å£ã€‚<strong>åè°ƒç®¡ç†è¿™äº›æ¥å£</strong>å°±ä¼šå˜å¾—éå¸¸éº»çƒ¦ï¼Œ ä¸”ä¼š<strong>é€ æˆä»£ç çš„é‡å¤</strong>ã€‚</p></li></ol><h2 id="1-2-ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-2-ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.2 ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.2 ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>API ç½‘å…³æ˜¯ä¸€ä¸ª<strong>æ­å»ºåœ¨å®¢æˆ·ç«¯å’Œå¾®æœåŠ¡ä¹‹é—´çš„æœåŠ¡</strong>ã€‚</p><ul><li><p>API ç½‘å…³å°±åƒæ•´ä¸ªå¾®æœåŠ¡ç³»ç»Ÿçš„é—¨é¢ä¸€æ ·ï¼Œæ˜¯ç³»ç»Ÿå¯¹å¤–çš„å”¯ä¸€å…¥å£ã€‚æœ‰äº†å®ƒï¼Œå®¢æˆ·ç«¯ä¼šå…ˆå°†è¯·æ±‚å‘é€åˆ° API ç½‘å…³ï¼Œç„¶åç”± API ç½‘å…³æ ¹æ®è¯·æ±‚çš„æ ‡è¯†ä¿¡æ¯å°†è¯·æ±‚è½¬å‘åˆ°å¾®æœåŠ¡å®ä¾‹ã€‚</p></li><li><p>æˆ‘ä»¬å¯ä»¥åœ¨ API ç½‘å…³ä¸­å¤„ç†ä¸€äº›éä¸šåŠ¡åŠŸèƒ½çš„é€»è¾‘ï¼Œä¾‹å¦‚æƒé™éªŒè¯ã€ç›‘æ§ã€ç¼“å­˜ã€è¯·æ±‚è·¯ç”±ç­‰ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232252488.png" alt="image-20230228232252488"></p></li></ul><h2 id="1-3-ç½‘å…³çš„ä¼˜ç‚¹å’Œç¼ºç‚¹"><a href="#1-3-ç½‘å…³çš„ä¼˜ç‚¹å’Œç¼ºç‚¹" class="headerlink" title="1.3 ç½‘å…³çš„ä¼˜ç‚¹å’Œç¼ºç‚¹"></a>1.3 ç½‘å…³çš„ä¼˜ç‚¹å’Œç¼ºç‚¹</h2><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>é›†åˆå¤šä¸ªAPI</li><li>ç»Ÿä¸€APIå…¥å£ï¼Œå®¢æˆ·ç«¯é€šè¿‡ API ç½‘å…³ä¸å¾®æœåŠ¡äº¤äº’æ—¶ï¼Œå®¢æˆ·ç«¯åªéœ€è¦çŸ¥é“ API ç½‘å…³åœ°å€å³å¯ï¼Œè€Œä¸éœ€è¦ç»´æŠ¤å¤§é‡çš„æœåŠ¡åœ°å€ï¼Œç®€åŒ–äº†å®¢æˆ·ç«¯çš„å¼€å‘ã€‚</li><li>å®¢æˆ·ç«¯ç›´æ¥ä¸ API ç½‘å…³é€šä¿¡ï¼Œèƒ½å¤Ÿå‡å°‘å®¢æˆ·ç«¯ä¸å„ä¸ªæœåŠ¡çš„äº¤äº’æ¬¡æ•°ã€‚</li><li>API ç½‘å…³è¿˜æä¾›äº†å®‰å…¨ã€æµæ§ã€è¿‡æ»¤ã€ç¼“å­˜ã€è®¡è´¹ä»¥åŠç›‘æ§ç­‰ API ç®¡ç†åŠŸèƒ½ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>åœ¨æ¶æ„ä¸Šéœ€è¦è€ƒè™‘æ›´å¤šçš„ç®¡ç†ï¼Œæ¯”å¦‚å“ªäº›APIæ”¾åœ¨å“ªä¸ªç½‘å…³ä¸Š</li><li>è·¯ç”±ä¸Šéœ€è¦è¿›è¡Œç»Ÿä¸€çš„é…ç½®</li><li>å¯èƒ½å¼•å‘å•ç‚¹æ•…éšœï¼ŒAPIæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å…¥å£ï¼Œå¾ˆå®¹æ˜“å‡ºç°é«˜å¹¶å‘ï¼Œè®¾è®¡ä¸å¥½ï¼Œå¦‚æœAPIç½‘ç®¡ä¸å¯ç”¨ï¼Œæ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨</li></ul><h2 id="1-4-APIç½‘å…³çš„å®ç°æ–¹å¼"><a href="#1-4-APIç½‘å…³çš„å®ç°æ–¹å¼" class="headerlink" title="1.4 APIç½‘å…³çš„å®ç°æ–¹å¼"></a>1.4 APIç½‘å…³çš„å®ç°æ–¹å¼</h2><ul><li>Spring Cloud Gateway</li><li>pring Cloud Netflix Zuul</li><li>Nginx</li><li>Traefik</li><li>Kong: åº•å±‚ä¹Ÿæ˜¯åŸºäºngin x</li></ul><h1 id="2-Zuul"><a href="#2-Zuul" class="headerlink" title="2 Zuul"></a>2 Zuul</h1><p>Zuul æ˜¯Netflixå¼€å‘çš„ä¸€æ¬¾APIç½‘å…³ç»„ä»¶ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ol><li>æˆç†Ÿç¨³å®šï¼šZuul æ˜¯ Netflix å¼€æºçš„é¡¹ç›®ï¼Œå·²ç»åœ¨å¤§è§„æ¨¡ç”Ÿäº§ç¯å¢ƒä¸­è¢«éªŒè¯è¿‡ã€‚</li><li>ç¤¾åŒºæ”¯æŒï¼šæ‹¥æœ‰æˆç†Ÿçš„ç¤¾åŒºï¼Œæœ‰å¤§é‡çš„æ–‡æ¡£å’Œæ¡ˆä¾‹å¯ä¾›å‚è€ƒã€‚</li><li>æ˜“äºä¸Šæ‰‹ï¼šç›¸å¯¹è¾ƒç®€å•ï¼Œæ˜“äºé…ç½®å’Œä½¿ç”¨ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>é˜»å¡å¼ I&#x2F;Oï¼šZuul ä½¿ç”¨é˜»å¡å¼ I&#x2F;Oï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼šå ç”¨ä¸€ä¸ªçº¿ç¨‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´çº¿ç¨‹èµ„æºè€—å°½ã€‚</li><li>åŠ¨æ€è·¯ç”±å›°éš¾ï¼šZuul åœ¨è¿è¡Œæ—¶åŠ¨æ€æ›´æ–°è·¯ç”±è§„åˆ™æ¯”è¾ƒå›°éš¾ï¼Œéœ€è¦é‡å¯æœåŠ¡ã€‚</li><li>ä¸æ”¯æŒå“åº”å¼ç¼–ç¨‹ï¼šZuul 1.x ä¸æ”¯æŒå“åº”å¼ç¼–ç¨‹æ¨¡å‹ï¼Œæ— æ³•å……åˆ†åˆ©ç”¨å¼‚æ­¥å’Œéé˜»å¡çš„ç‰¹æ€§ã€‚</li></ol><h2 id="2-1-SpringCloud-é›†æˆZuul"><a href="#2-1-SpringCloud-é›†æˆZuul" class="headerlink" title="2.1 SpringCloud é›†æˆZuul"></a>2.1 SpringCloud é›†æˆZuul</h2><ol><li><p>æ­å»ºEureka Client : <a href="https://pyr9.github.io/2022/08/17/springCloud%E4%B9%8BEureka%E6%90%AD%E5%BB%BA/">springCloudä¹‹Eurekaæ­å»º - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p></li><li><p>å¼•å…¥ä¾èµ–</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;org.springframework.cloud:spring-cloud-starter-netflix-zuul&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨ï¼šspringCloud ç‰ˆæœ¬è¿‡é«˜ï¼Œä¼šå­˜åœ¨zuulæ— æ³•å¼•å…¥çš„é—®é¢˜ï¼Œæ‰€ä»¥æœ¬åœ°ï¼Œå°†SpringCloudç‰ˆæœ¬é™ä½äº†ï¼Œç›¸åº”çš„SpringBootç‰ˆæœ¬ä¹Ÿé™ä½äº†</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">plugins&#123;<br>id <span class="hljs-string">&#x27;org.springframework.boot&#x27;</span> version <span class="hljs-string">&#x27;2.2.0.RELEASE&#x27;</span><br>&#125;<br>ext &#123;<br>set(<span class="hljs-string">&#x27;springCloudVersion&#x27;</span>, <span class="hljs-string">&quot;Hoxton.SR12&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li>propertiesä¿®æ”¹é…ç½®</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml">server.port=9090<br>spring.application.name: micro-weather-eureka-client-zuul<br>eureka.client.serviceUrl.defaultZone: http://localhost:8761//eureka/<br><br># å¯é…ç½®å¤šå¯¹è·¯ç”±<br>zuul.routes.demo.path: /demo/**<br>zuul.routes.demo.serviceId: micro-weather-eureka-client<br><br>#zuul.routes.city.path: /city/**<br>#zuul.routes.city.serviceId: msa-weather-city-eureka<br><br>#zuul.routes.data.path: /data/**<br>#zuul.routes.data.serviceId: msa-weather-data-eureka<br></code></pre></td></tr></table></figure><ol start="4"><li>å¯åŠ¨ç±»åŠ å…¥æ³¨è§£@EnableZuulProxy</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><span class="hljs-keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;<br><span class="hljs-keyword">import</span> org.springframework.cloud.netflix.zuul.EnableZuulProxy;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@EnableDiscoveryClient</span><br><span class="hljs-meta">@EnableZuulProxy</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    SpringApplication.run(Application.class, args);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="5"><li>è®¿é—®<a href="http://localhost:9090/demo/hello">localhost:9090&#x2F;demo&#x2F;hello</a>ï¼Œå¾—åˆ°micro-weather-eureka-client æœåŠ¡çš„æ•°æ®</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232304736.png" alt="image-20230228232304736"></p><h1 id="3-Spring-Cloud-Gateway"><a href="#3-Spring-Cloud-Gateway" class="headerlink" title="3 Spring Cloud Gateway"></a>3 Spring Cloud Gateway</h1><p>åœ¨Zulu2 ä¸­ï¼Œzuulçš„æŠ€æœ¯æ–¹æ¡ˆä¸€ç›´åœ¨è·³ç¥¨ï¼Œspring cloud è‡ªå·±å¼€å‘äº†ä¸€ä¸ªç½‘å…³Spring Cloud Gatewayï¼Œç”¨æ¥å–ä»£Zuulç½‘å…³ã€‚</p><ul><li><p><strong>å“åº”å¼ç¼–ç¨‹æ”¯æŒ</strong>ï¼šSpring Cloud Gateway æ˜¯åŸºäº WebFlux æ¡†æ¶å®ç°çš„ï¼Œè€Œ WebFlux æ¡†æ¶åº•å±‚åˆ™ä½¿ç”¨äº†é€šä¿¡æ¡†æ¶ Nettyã€‚è¿™æ„å‘³ç€å®ƒèƒ½å¤Ÿæ›´é«˜æ•ˆåœ°å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚ï¼Œè€Œä¸ä¼šå‡ºç°çº¿ç¨‹é˜»å¡å’Œèµ„æºæµªè´¹çš„é—®é¢˜ã€‚ï¼ˆNetty ä½¿ç”¨äº† Java NIO æä¾›çš„éé˜»å¡ I&#x2F;O æ¨¡å‹ï¼Œèƒ½å¤Ÿå¤„ç†å¤§é‡å¹¶å‘çš„è¿æ¥å’Œè¯·æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œæé«˜äº†ç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›å’Œæ€§èƒ½ã€‚ï¼‰</p></li><li><p><strong>Spring Cloud ç”Ÿæ€é›†æˆ</strong>ï¼šä½œä¸º Spring Cloud ç”Ÿæ€ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼ŒSpring Cloud Gateway ä¸å…¶ä»– Spring Cloud ç»„ä»¶ï¼ˆå¦‚ Eurekaã€Consulã€Ribbon ç­‰ï¼‰æœ‰ç€è‰¯å¥½çš„é›†æˆï¼Œå¯ä»¥æ–¹ä¾¿åœ°æ„å»ºå’Œç®¡ç†å¾®æœåŠ¡æ¶æ„ã€‚</p></li></ul><h2 id="3-1-Spring-Cloud-Gateway-æ ¸å¿ƒæ¦‚å¿µ"><a href="#3-1-Spring-Cloud-Gateway-æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="3.1 Spring Cloud Gateway æ ¸å¿ƒæ¦‚å¿µ"></a>3.1 Spring Cloud Gateway æ ¸å¿ƒæ¦‚å¿µ</h2><ul><li>Routeï¼ˆè·¯ç”±ï¼‰ï¼š ç½‘å…³æœ€åŸºæœ¬çš„æ¨¡å—ã€‚å®ƒç”±ä¸€ä¸ª IDã€ä¸€ä¸ªç›®æ ‡ URIã€ä¸€ç»„æ–­è¨€ï¼ˆPredicateï¼‰å’Œä¸€ç»„è¿‡æ»¤å™¨ï¼ˆFilterï¼‰ç»„æˆã€‚</li><li>Predicateï¼ˆæ–­è¨€ï¼‰:è·¯ç”±è½¬å‘çš„åˆ¤æ–­æ¡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Predicate å¯¹ HTTP è¯·æ±‚è¿›è¡ŒåŒ¹é…ï¼Œä¾‹å¦‚è¯·æ±‚æ–¹å¼ã€è¯·æ±‚è·¯å¾„ã€è¯·æ±‚å¤´ã€å‚æ•°ç­‰ï¼Œ<strong>å¦‚æœè¯·æ±‚ä¸æ–­è¨€åŒ¹é…æˆåŠŸï¼Œåˆ™å°†è¯·æ±‚è½¬å‘åˆ°ç›¸åº”çš„æœåŠ¡ã€‚</strong></li><li>Filterï¼ˆè¿‡æ»¤å™¨ï¼‰:è¿‡æ»¤å™¨ï¼Œä½¿ç”¨è¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¯·æ±‚è¿›è¡Œæ‹¦æˆªå’Œä¿®æ”¹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å®ƒå¯¹ä¸Šæ–‡çš„å“åº”è¿›è¡Œå†å¤„ç†ã€‚</li></ul><p><strong>æ³¨æ„ï¼šå…¶ä¸­ Route å’Œ Predicate å¿…é¡»åŒæ—¶å£°æ˜ã€‚</strong></p><p>ä½¿ç”¨äº†ä¸€ä¸ªRouteLocatorBuilderçš„beanå»åˆ›å»ºè·¯ç”±ï¼Œé™¤äº†åˆ›å»ºè·¯ç”± RouteLocatorBuilderå¯ä»¥è®©ä½ æ·»åŠ å„ç§predicateså’Œfiltersï¼Œpredicatesæ–­è¨€ çš„æ„æ€ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æ ¹æ®å…·ä½“çš„è¯·æ±‚çš„è§„åˆ™ï¼Œç”±å…·ä½“çš„routeå»å¤„ç†ï¼Œfilters æ˜¯å„ç§è¿‡æ»¤å™¨ï¼Œç”¨æ¥å¯¹è¯·æ±‚åšå„ç§åˆ¤æ–­å’Œä¿®æ”¹ã€‚</p><h2 id="3-2-Spring-Cloud-Gateway-ç‰¹æ€§"><a href="#3-2-Spring-Cloud-Gateway-ç‰¹æ€§" class="headerlink" title="3.2 Spring Cloud Gateway ç‰¹æ€§"></a>3.2 Spring Cloud Gateway ç‰¹æ€§</h2><ul><li>åŸºäº Spring Framework 5ã€Project Reactor å’Œ Spring Boot 2.0 æ„å»ºã€‚</li><li>èƒ½å¤Ÿåœ¨ä»»æ„è¯·æ±‚å±æ€§ä¸ŠåŒ¹é…è·¯ç”±ã€‚</li><li>predicatesï¼ˆæ–­è¨€ï¼‰ å’Œ filtersï¼ˆè¿‡æ»¤å™¨ï¼‰æ˜¯ç‰¹å®šäºè·¯ç”±çš„ã€‚</li><li>é›†æˆäº† Hystrix ç†”æ–­å™¨ã€‚</li><li>é›†æˆäº† Spring Cloud DiscoveryClientï¼ˆæœåŠ¡å‘ç°å®¢æˆ·ç«¯ï¼‰ã€‚</li><li>æ˜“äºç¼–å†™æ–­è¨€å’Œè¿‡æ»¤å™¨ã€‚</li><li>èƒ½å¤Ÿé™åˆ¶è¯·æ±‚é¢‘ç‡ã€‚</li><li>èƒ½å¤Ÿé‡å†™è¯·æ±‚è·¯å¾„ã€‚</li></ul><h2 id="3-3-Gateway-çš„å·¥ä½œæµç¨‹"><a href="#3-3-Gateway-çš„å·¥ä½œæµç¨‹" class="headerlink" title="3.3 Gateway çš„å·¥ä½œæµç¨‹"></a>3.3 Gateway çš„å·¥ä½œæµç¨‹</h2><p><strong>æ ¸å¿ƒé€»è¾‘ï¼šè·¯ç”±è½¬å‘+æ‰§è¡Œè¿‡æ»¤å™¨</strong></p><ol><li><p>å®¢æˆ·ç«¯å°†è¯·æ±‚å‘é€åˆ° Spring Cloud Gateway ä¸Šã€‚</p></li><li><p>Spring Cloud Gateway é€šè¿‡ Gateway Handler Mapping æ‰¾åˆ°ä¸è¯·æ±‚ç›¸åŒ¹é…çš„è·¯ç”±ï¼Œå°†å…¶å‘é€ç»™ Gateway Web Handlerã€‚</p></li><li><p>Gateway Web Handler é€šè¿‡æŒ‡å®šçš„è¿‡æ»¤å™¨é“¾ï¼ˆFilter Chainï¼‰ï¼Œå°†è¯·æ±‚è½¬å‘åˆ°å®é™…çš„æœåŠ¡èŠ‚ç‚¹ä¸­ï¼Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘è¿”å›å“åº”ç»“æœã€‚</p></li><li><p>è¿‡æ»¤å™¨ä¹‹é—´ç”¨è™šçº¿åˆ†å¼€æ˜¯å› ä¸ºè¿‡æ»¤å™¨å¯èƒ½ä¼šåœ¨è½¬å‘è¯·æ±‚ä¹‹å‰ï¼ˆpreï¼‰æˆ–ä¹‹åï¼ˆpostï¼‰æ‰§è¡Œä¸šåŠ¡é€»è¾‘ã€‚</p></li><li><p>è¿‡æ»¤å™¨ï¼ˆFilterï¼‰å¯ä»¥åœ¨è¯·æ±‚è¢«è½¬å‘åˆ°æœåŠ¡ç«¯å‰ï¼Œå¯¹è¯·æ±‚è¿›è¡Œæ‹¦æˆªå’Œä¿®æ”¹ï¼Œä¾‹å¦‚å‚æ•°æ ¡éªŒã€æƒé™æ ¡éªŒã€æµé‡ç›‘æ§ã€æ—¥å¿—è¾“å‡ºä»¥åŠåè®®è½¬æ¢ç­‰ã€‚</p></li><li><p>è¿‡æ»¤å™¨å¯ä»¥åœ¨å“åº”è¿”å›å®¢æˆ·ç«¯ä¹‹å‰ï¼Œå¯¹å“åº”è¿›è¡Œæ‹¦æˆªå’Œå†å¤„ç†ï¼Œä¾‹å¦‚ä¿®æ”¹å“åº”å†…å®¹æˆ–å“åº”å¤´ã€æ—¥å¿—è¾“å‡ºã€æµé‡ç›‘æ§ç­‰ã€‚</p></li><li><p>å“åº”åŸè·¯è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224346059.png" alt="image-20230228224346059"></p></li></ol><h2 id="3-4-Spring-Cloud-Gateway-åŠ¨æ€è·¯ç”±"><a href="#3-4-Spring-Cloud-Gateway-åŠ¨æ€è·¯ç”±" class="headerlink" title="3.4 Spring Cloud Gateway åŠ¨æ€è·¯ç”±"></a>3.4 Spring Cloud Gateway åŠ¨æ€è·¯ç”±</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Cloud Gateway ä¼šæ ¹æ®æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ˆä¾‹å¦‚ Eureka Serverï¼‰ä¸­ç»´æŠ¤çš„æœåŠ¡åˆ—è¡¨ï¼Œä»¥æœåŠ¡åï¼ˆspring.application.nameï¼‰ä½œä¸ºè·¯å¾„åˆ›å»ºåŠ¨æ€è·¯ç”±è¿›è¡Œè½¬å‘ï¼Œä»è€Œå®ç°åŠ¨æ€è·¯ç”±åŠŸèƒ½ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå°† Route çš„ uri åœ°å€ä¿®æ”¹ä¸ºä»¥ä¸‹å½¢å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">lb:<span class="hljs-comment">//service-name</span><br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šé…ç½®è¯´æ˜å¦‚ä¸‹ï¼š</p><ul><li>lbï¼šuri çš„åè®®ï¼Œè¡¨ç¤ºå¼€å¯ Spring Cloud Gateway çš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚</li><li>service-nameï¼šæœåŠ¡åï¼ŒSpring Cloud Gateway ä¼šæ ¹æ®å®ƒè·å–åˆ°å…·ä½“çš„å¾®æœåŠ¡åœ°å€ã€‚</li></ul><h2 id="3-5-SpringCloud-ä½¿ç”¨GateWay"><a href="#3-5-SpringCloud-ä½¿ç”¨GateWay" class="headerlink" title="3.5 SpringCloud ä½¿ç”¨GateWay"></a>3.5 SpringCloud ä½¿ç”¨GateWay</h2><ol><li><p>æ­å»ºEureka Client : <a href="https://pyr9.github.io/2022/08/17/springCloud%E4%B9%8BEureka%E6%90%AD%E5%BB%BA/">springCloudä¹‹Eurekaæ­å»º - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p></li><li><p>å¼•å…¥ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;org.springframework.cloud:spring-cloud-starter-gateway&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹application.yml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml">server:<br>  port: 9090<br>spring:<br>  application:<br>    name: micro-weather-eureka-client-gateway<br>  cloud:<br>    gateway: #ç½‘å…³è·¯ç”±é…ç½®<br>      routes:<br>        #å°† micro-service-cloud-provider-dept-8001 æä¾›çš„æœåŠ¡éšè—èµ·æ¥ï¼Œä¸æš´éœ²ç»™å®¢æˆ·ç«¯ï¼Œåªç»™å®¢æˆ·ç«¯æš´éœ² API ç½‘å…³çš„åœ°å€ 9527<br>        - id: micro_weather_eureka_client_path #è·¯ç”± id,æ²¡æœ‰å›ºå®šè§„åˆ™ï¼Œä½†å”¯ä¸€ï¼Œå»ºè®®ä¸æœåŠ¡åå¯¹åº”<br>          uri: http://localhost:9091         #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€<br>          predicates:<br>            #ä»¥ä¸‹æ˜¯æ–­è¨€æ¡ä»¶ï¼Œå¿…é€‰å…¨éƒ¨ç¬¦åˆæ¡ä»¶<br>            - Path=/test/**               #æ–­è¨€ï¼Œè·¯å¾„åŒ¹é… æ³¨æ„ï¼šPath ä¸­ P ä¸ºå¤§å†™<br>            - Method=GET #åªèƒ½æ—¶ GET è¯·æ±‚æ—¶ï¼Œæ‰èƒ½è®¿é—®<br>eureka:<br>  client:<br>    fetch-registry: true<br>    register-with-eureka: true<br>    service-url:<br>      defaultZone: http://localhost:8761//eureka/<br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹å¯åŠ¨ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@EnableDiscoveryClient</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    SpringApplication.run(Application.class, args);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æµ‹è¯•</p><p>å¯ä»¥çœ‹åˆ°æ ¹æ®è·¯ç”±åŒ¹é…ï¼Œé€šè¿‡<a href="http://localhost:9090/%E8%AE%BF%E9%97%AE%E5%88%B0%E4%BA%86http://localhost:9091/%E7%9A%84%E6%8E%A5%E5%8F%A3">http://localhost:9090/è®¿é—®åˆ°äº†http://localhost:9091/çš„æ¥å£</a></p><ul><li>è®¿é—®<a href="http://localhost:9091/test/%E5%BC%A0%E4%B8%89">localhost:9091&#x2F;test&#x2F;å¼ ä¸‰</a></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224437860.png" alt="image-20230228224437860"></p><ul><li>è®¿é—®<a href="http://localhost:9090/test/%E5%BC%A0%E4%B8%89">localhost:9090&#x2F;test&#x2F;å¼ ä¸‰</a></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224445551.png" alt="image-20230228224445551"></p></li></ol><p><strong>Spring Cloud Gateway åŠ¨æ€è·¯ç”±</strong></p><p>ä¿®æ”¹application.yml çš„é…ç½®ï¼Œä½¿ç”¨æ³¨å†Œä¸­å¿ƒä¸­çš„å¾®æœåŠ¡ååˆ›å»ºåŠ¨æ€è·¯ç”±è¿›è¡Œè½¬å‘</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224403815.png" alt="image-20230228224403815"></p><h1 id="4-zuulå’Œspring-cloudgatewayæ¯”è¾ƒ"><a href="#4-zuulå’Œspring-cloudgatewayæ¯”è¾ƒ" class="headerlink" title="4 zuulå’Œspring cloudgatewayæ¯”è¾ƒ"></a>4 zuulå’Œspring cloudgatewayæ¯”è¾ƒ</h1><table><thead><tr><th></th><th>Gateway</th><th>Zuul1</th><th>Zuul2</th></tr></thead><tbody><tr><td>é è°±æ€§</td><td>spring cloudå®˜æ–¹æ”¯æŒ</td><td>æ›¾ç»é è°±</td><td>ä¸“ä¸šæ”¾é¸½å­</td></tr><tr><td>æ€§èƒ½</td><td>Netty</td><td>åŒæ­¥é˜»å¡ï¼Œæ€§èƒ½æ…¢</td><td>Netty</td></tr><tr><td>RPS</td><td>&gt;32000</td><td>20000å·¦å³</td><td>25000å·¦å³</td></tr><tr><td>spring cloud</td><td>å·²æ•´åˆ</td><td>å·²æ•´åˆ</td><td>æš‚æ— æ•´åˆè®¡åˆ’</td></tr><tr><td>é•¿é“¾æ¥</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springCloudä¹‹é›†æˆFeign</title>
    <link href="/springCloud%E4%B9%8BFeign%E6%90%AD%E5%BB%BA/"/>
    <url>/springCloud%E4%B9%8BFeign%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="Feignæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Feignæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Feignæ˜¯ä»€ä¹ˆï¼Ÿ"></a>Feignæ˜¯ä»€ä¹ˆï¼Ÿ</h1><ul><li>Feignæ˜¯Netflixå¼€å‘çš„ä¸€æ¬¾å£°æ˜å¼æœåŠ¡è°ƒç”¨ç»„ä»¶</li><li>Feignå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¿«æ·ã€ä¼˜é›…åœ°è°ƒç”¨HTTP APIã€‚</li><li>Feign æ˜¯ Spring Cloud Netflix æ¨¡å—çš„å­æ¨¡å—ï¼Œå®ƒæ˜¯ Spring Cloud å¯¹ Netflix Feign çš„äºŒæ¬¡å°è£…ï¼Œä¸»è¦è´Ÿè´£ Spring Cloud çš„æœåŠ¡è°ƒç”¨åŠŸèƒ½ã€‚</li></ul><h1 id="SpringCloud-é›†æˆFeign"><a href="#SpringCloud-é›†æˆFeign" class="headerlink" title="SpringCloud é›†æˆFeign"></a>SpringCloud é›†æˆFeign</h1><ol><li><p>æ­å»ºEureka Client : <a href="https://pyr9.github.io/2022/08/17/springCloud%E4%B9%8BEureka%E6%90%AD%E5%BB%BA/">springCloudä¹‹Eurekaæ­å»º - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p></li><li><p>å¼•å…¥ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;org.springframework.cloud:spring-cloud-starter-openfeign&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹application.properties</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml">server.port=8085<br>spring.application.name: micro-weather-eureka-client-feign<br>eureka.client.serviceUrl.defaultZone: http://localhost:8761//eureka/<br># è¿æ¥çš„è¶…æ—¶æ—¶é—´<br>feign.client.config.feignName.connectTimeout: 5000<br># è¯»æ•°æ®çš„è¶…æ—¶æ—¶é—´<br>feign.client.config.feignName.readTimeout: 5000<br></code></pre></td></tr></table></figure></li><li><p>åˆ›å»ºä¸€ä¸ªæ¥å£ï¼Œç”¨FeignClientæ³¨è§£ï¼ŒæŒ‡æ˜éœ€è¦è°ƒç”¨çš„æœåŠ¡åå’Œrestæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FeignClient(&quot;micro-weather-city-eureka&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CityClient</span> </span>&#123;<br>  <span class="hljs-meta">@RequestMapping(&quot;/cities&quot;)</span><br>  <span class="hljs-function">String <span class="hljs-title">listCity</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹å¯åŠ¨ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java">   <span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather;<br>   <br>   <span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br>   <span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br>   <span class="hljs-keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;<br>   <span class="hljs-keyword">import</span> org.springframework.cloud.openfeign.EnableFeignClients;<br>   <br>   <span class="hljs-meta">@SpringBootApplication</span><br>   <span class="hljs-meta">@EnableDiscoveryClient</span><br>   <span class="hljs-meta">@EnableFeignClients</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> </span>&#123;<br>   <br>     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>       SpringApplication.run(Application.class, args);<br>     &#125;<br>   &#125;<br>   <br><br><span class="hljs-number">6.</span> åˆ›å»ºä¸€ä¸ªRestClientControlleræ¥å®ç°å¯¹Feignå®¢æˆ·ç«¯çš„è°ƒç”¨<br><br>   ```java<br>   <span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather.controller;<br>   <br>   <span class="hljs-keyword">import</span> com.pyr.spring.cloud.weather.service.CityClient;<br>   <span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br>   <span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br>   <span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br>   <br>   <span class="hljs-meta">@RestController</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CityController</span> </span>&#123;<br>     <span class="hljs-meta">@Autowired</span><br>     <span class="hljs-keyword">private</span> CityClient cityClient;<br>   <br>     <span class="hljs-meta">@RequestMapping(&quot;/cities&quot;)</span><br>     <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">listCity</span><span class="hljs-params">()</span></span>&#123;<br>       <span class="hljs-keyword">return</span> cityClient.listCity();<br>     &#125;<br>   &#125;<br></code></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹eurakaæœåŠ¡ç«¯ï¼Œå¯ä»¥çœ‹åˆ°è¯¥å®¢æˆ·ç«¯æ³¨å†ŒæˆåŠŸï¼Œè®¿é—®[localhost:8085&#x2F;citiesï¼Œå¯ä»¥è·å–åˆ°æŒ‡å®šæœåŠ¡æ¥å£çš„è¿”å›</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232728757.png" alt="image-20230228232728757"></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springCloudä¹‹é›†æˆSpringCloud Config</title>
    <link href="/springCloud%E4%B9%8B%E9%9B%86%E6%88%90SpringCloud-Config/"/>
    <url>/springCloud%E4%B9%8B%E9%9B%86%E6%88%90SpringCloud-Config/</url>
    
    <content type="html"><![CDATA[<h1 id="é›†ä¸­åŒ–é…ç½®"><a href="#é›†ä¸­åŒ–é…ç½®" class="headerlink" title="é›†ä¸­åŒ–é…ç½®"></a>é›†ä¸­åŒ–é…ç½®</h1><h2 id="ä»€ä¹ˆåœºæ™¯ä¼šç”¨åˆ°é…ç½®"><a href="#ä»€ä¹ˆåœºæ™¯ä¼šç”¨åˆ°é…ç½®" class="headerlink" title="ä»€ä¹ˆåœºæ™¯ä¼šç”¨åˆ°é…ç½®"></a>ä»€ä¹ˆåœºæ™¯ä¼šç”¨åˆ°é…ç½®</h2><ul><li>æƒ³åˆ°æŸä¸€ä¸ªåœ°æ–¹å»è¯»å–æ–‡ä»¶</li><li>Application.yml&#x2F; bootstrap.yml</li><li>ç¯å¢ƒå˜é‡ï¼š æ¯”å¦‚å¯åŠ¨å‚æ•°</li><li>æ•°æ®åº“å­˜å‚¨ï¼ˆç³»ç»Ÿå˜é‡ï¼‰</li></ul><h2 id="ä¸ºä»€ä¹ˆè¦é›†ä¸­åŒ–é…ç½®ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦é›†ä¸­åŒ–é…ç½®ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦é›†ä¸­åŒ–é…ç½®ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦é›†ä¸­åŒ–é…ç½®ï¼Ÿ</h2><ul><li>å¾®æœåŠ¡æ•°é‡å¤šï¼Œé…ç½®å¤š</li><li>æ²¡æœ‰ç‰ˆæœ¬æ§åˆ¶ï¼ˆå°¤å…¶æ•°æ®åº“çš„ç³»ç»Ÿå˜é‡ï¼‰</li><li>åˆ†å¸ƒé›¶æ•£ï¼šæœ‰çš„é…ç½®åœ¨ä»£ç é‡Œï¼Œæœ‰çš„åœ¨ymlé…ç½®æ–‡ä»¶ï¼Œæœ‰çš„åœ¨æ•°æ®åº“</li><li>åŸºäºé™æ€çš„é…ç½®ï¼šæ¯æ¬¡ä¿®æ”¹éƒ½éœ€è¦é‡æ–°å‘å¸ƒ</li><li>æ‰‹å·¥ç®¡ç†é…ç½®ç¹ç</li></ul><h2 id="é…ç½®åˆ†ç±»"><a href="#é…ç½®åˆ†ç±»" class="headerlink" title="é…ç½®åˆ†ç±»"></a>é…ç½®åˆ†ç±»</h2><p>æŒ‰ç…§åŠ¨æ€é™æ€åŒºåˆ†</p><ul><li>é™æ€ï¼š<ul><li>ç¯å¢ƒé…ç½®ï¼šæ•°æ®åº“è¿æ¥ä¸²ï¼Œeurekaæ³¨å†Œä¸­å¿ƒï¼ŒkÄfkaè¿æ¥ï¼Œåº”ç”¨åç§°</li><li>å®‰å…¨é…ç½®ï¼šè¿æ¥å¯†ç ï¼Œå…¬é’¥ç§é’¥ï¼Œhttpè¿æ¥çš„è¯ä¹¦</li></ul></li><li>åŠ¨æ€ï¼š<ul><li>åº”ç”¨å‚æ•°ï¼šç™½åå•ï¼Œç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œæ—¥å¿—çº§åˆ«</li><li>ä¸šåŠ¡ç›¸å…³ï¼šéšç§åè®®å†…å®¹ï¼ŒåŠ¨æ€æ–‡æ¡ˆ</li><li>åŠŸèƒ½å¼€å…³ï¼šç°åº¦å‘å¸ƒï¼ŒåŠŸèƒ½å¼€å…³</li></ul></li></ul><h2 id="é…ç½®ä¸­å¿ƒçš„è¦æ±‚"><a href="#é…ç½®ä¸­å¿ƒçš„è¦æ±‚" class="headerlink" title="é…ç½®ä¸­å¿ƒçš„è¦æ±‚"></a>é…ç½®ä¸­å¿ƒçš„è¦æ±‚</h2><ul><li><p>ç‰ˆæœ¬ç®¡ç†ï¼šå¯ä»¥çœ‹åˆ°ä¿®æ”¹è®°å½•</p></li><li><p>æƒé™æ§åˆ¶ï¼šæŸäº›äººå¯æ”¹æŸäº›é…ç½®</p></li><li><p>é…ç½®ä¸šåŠ¡åˆ†ç¦»ï¼šå¯¹é…ç½®å•ç‹¬è¿›è¡Œç®¡ç†</p></li><li><p>ä¸šåŠ¡éœ€æ±‚ï¼šåŠ¨æ€æ¨é€å˜æ›´ï¼Œå†…å®¹åŠ å¯†</p></li><li><p>é«˜å¯ç”¨</p></li><li><p>é¢å‘å¯é…ç½®çš„ç¼–ç ï¼šé¿å…ç¡¬ç¼–ç ï¼Œè®¾ç½®å¸¸é‡ï¼Œè¿è¡Œæ—¶å¯è¯»å–</p></li><li><p>ä¸ªç†æ€§ï¼šç”Ÿäº§ç¯å¢ƒçš„é…ç½®å’Œæµ‹è¯•ç¯å¢ƒé…ç½®ä¸ä¸€æ ·</p></li><li><p>ä¸€è‡´æ€§ï¼šç›¸åŒéƒ¨ç½²ç¯å¢ƒä¸‹ï¼Œåº”è¯¥é…ç½®ç›¸åŒ</p></li><li><p>é›†ä¸­åŒ–é…ç½®ï¼šåˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œåº”ç”¨çš„é…ç½®åº”è¯¥å…·å¤‡å¯ä»¥ç®¡ç†æ€§ï¼Œæä¾›è¿œç¨‹ç®¡ç†çš„èƒ½åŠ›ã€‚</p></li></ul><h1 id="SpringCloud-Config"><a href="#SpringCloud-Config" class="headerlink" title="SpringCloud Config"></a>SpringCloud Config</h1><h2 id="springCloud-config-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#springCloud-config-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="springCloud config æ˜¯ä»€ä¹ˆï¼Ÿ"></a>springCloud config æ˜¯ä»€ä¹ˆï¼Ÿ</h2><ul><li>Spring Cloud Config æ˜¯ç”± Spring Cloud å›¢é˜Ÿå¼€å‘çš„é¡¹ç›®ï¼Œå®ƒå¯ä»¥ä¸ºå¾®æœåŠ¡æ¶æ„ä¸­å„ä¸ªå¾®æœåŠ¡æä¾›é›†ä¸­åŒ–çš„å¤–éƒ¨é…ç½®æ”¯æŒã€‚</li><li>Spring Cloud Config å¯ä»¥å°†å„ä¸ªå¾®æœåŠ¡çš„é…ç½®æ–‡ä»¶é›†ä¸­å­˜å‚¨åœ¨ä¸€ä¸ªå¤–éƒ¨çš„å­˜å‚¨ä»“åº“æˆ–ç³»ç»Ÿï¼ˆä¾‹å¦‚ Git ã€SVN ç­‰ï¼‰ä¸­ï¼Œå¯¹é…ç½®çš„ç»Ÿä¸€ç®¡ç†ï¼Œä»¥æ”¯æŒå„ä¸ªå¾®æœåŠ¡çš„è¿è¡Œã€‚</li><li>Spring Cloud Config åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªéƒ¨åˆ†ï¼š<ul><li>Config Serverï¼šä¹Ÿè¢«ç§°ä¸ºåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒï¼Œå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹è¿è¡Œçš„å¾®æœåŠ¡åº”ç”¨ï¼Œç”¨æ¥è¿æ¥é…ç½®ä»“åº“å¹¶ä¸ºå®¢æˆ·ç«¯æä¾›è·å–é…ç½®ä¿¡æ¯ã€åŠ å¯†ä¿¡æ¯å’Œè§£å¯†ä¿¡æ¯çš„è®¿é—®æ¥å£ã€‚</li><li>Config Clientï¼šæŒ‡çš„æ˜¯å¾®æœåŠ¡æ¶æ„ä¸­çš„å„ä¸ªå¾®æœåŠ¡ï¼Œå®ƒä»¬é€šè¿‡ Config Server å¯¹é…ç½®è¿›è¡Œç®¡ç†ï¼Œå¹¶ä» Config Sever ä¸­è·å–å’ŒåŠ è½½é…ç½®ä¿¡æ¯ã€‚</li></ul></li></ul><h2 id="æ­å»º-Config-æœåŠ¡ç«¯"><a href="#æ­å»º-Config-æœåŠ¡ç«¯" class="headerlink" title="æ­å»º Config æœåŠ¡ç«¯"></a>æ­å»º Config æœåŠ¡ç«¯</h2><ol><li><p>æ­å»ºEureka Client : <a href="https://pyr9.github.io/2022/08/17/springCloud%E4%B9%8BEureka%E6%90%AD%E5%BB%BA/">springCloudä¹‹Eurekaæ­å»º - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p></li><li><p>githubæˆ–è€…ç äº‘ä¸Šåˆ›å»ºä¸€ä¸ªä»“åº“å­˜å‚¨é…ç½®ä¿¡æ¯ï¼Œgithubå›½å†…ä¸æ˜¯å¾ˆç¨³å®šï¼Œæˆ‘ç”¨äº†ç äº‘</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232125832.png" alt="image-20230228232125832"></p></li><li><p>åœ¨config-repoè·¯å¾„ä¸‹ï¼Œç¼–å†™é…ç½®æ–‡ä»¶config-dev.yml</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232134545.png" alt="image-20230228232134545"></p></li><li><p>å¼•å…¥ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;org.springframework.cloud:spring-cloud-config-server&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>propertiesä¿®æ”¹é…ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">server.port=<span class="hljs-number">8888</span><br>spring.application.name: micro-weather-eureka-server-config<br>eureka.client.serviceUrl.defaultZone: http:<span class="hljs-comment">//localhost:8761//eureka/</span><br><br># git åœ°å€ï¼Œç”¨æ¥å­˜å‚¨é…ç½®æ–‡ä»¶<br>spring.cloud.config.server.git.uri=https:<span class="hljs-comment">//gitee.com/panyuro/spring-cloud-microservice-config.git</span><br><br>#å­˜å‚¨é…ç½®æ–‡ä»¶çš„ç›®å½•<br>spring.cloud.config.server.git.searchPaths=config-repo<br></code></pre></td></tr></table></figure></li><li><p>å¯åŠ¨ç±»åŠ å…¥æ³¨è§£@EnableConfigServer</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@EnableDiscoveryClient</span><br><span class="hljs-meta">@EnableConfigServer</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    SpringApplication.run(Application.class, args);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®<a href="http://localhost:8888/config-dev.yml">localhost:8888&#x2F;config-dev.yml</a>ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°8888å¾®æœåŠ¡å¯ä»¥æˆåŠŸçš„è¯»å–åˆ°è¿œç«¯çš„é…ç½®æ–‡ä»¶ã€‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232147874.png" alt="image-20230228232147874"></p></li></ol><p>è®¿é—®<a href="http://localhost:8888/config/dev/master">localhost:8888&#x2F;config&#x2F;dev&#x2F;master</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232155081.png" alt="image-20230228232155081"></p><h2 id="æ­å»º-Configå®¢æˆ·ç«¯"><a href="#æ­å»º-Configå®¢æˆ·ç«¯" class="headerlink" title="æ­å»º Configå®¢æˆ·ç«¯"></a>æ­å»º Configå®¢æˆ·ç«¯</h2><ol><li><p>æ­å»ºEureka Client : <a href="https://pyr9.github.io/2022/08/17/springCloud%E4%B9%8BEureka%E6%90%AD%E5%BB%BA/">springCloudä¹‹Eurekaæ­å»º - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p></li><li><p>å¼•å…¥ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;org.springframework.cloud:spring-cloud-config-client&#x27;</span><br></code></pre></td></tr></table></figure><p>springcloud ç‰ˆæœ¬è¾ƒé«˜ï¼Œæ— æ³•æˆåŠŸå¯åŠ¨é¡¹ç›®çš„æ—¶å€™ï¼Œéœ€è¦å†å¼•å…¥starter-bootstrap</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;org.springframework.cloud:spring-cloud-starter-bootstrap&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>propertiesä¿®æ”¹é…ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">server.port=<span class="hljs-number">9091</span><br>spring.application.name: micro-weather-config-client<br>eureka.client.serviceUrl.defaultZone: http:<span class="hljs-comment">//localhost:8761//eureka/</span><br><br>spring.cloud.config.profile=dev<br>spring.cloud.config.uri=http:<span class="hljs-comment">//localhost:8888/</span><br>spring.cloud.config.name=config<br></code></pre></td></tr></table></figure></li><li><p>ç¼–å†™æµ‹è¯•ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConfigController</span> </span>&#123;<br><br>  <span class="hljs-meta">@Value(&quot;$&#123;config.info&#125;&quot;)</span><br>  <span class="hljs-keyword">private</span> String info;<br><br>  <span class="hljs-meta">@Value(&quot;$&#123;config.version&#125;&quot;)</span><br>  <span class="hljs-keyword">private</span> String version;<br><br>  <span class="hljs-meta">@GetMapping(&quot;/config&quot;)</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">config</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;info: &quot;</span>+info+<span class="hljs-string">&quot; version: &quot;</span>+version;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æµ‹è¯•ï¼Œè®¿é—®<a href="http://localhost:9091/config">localhost:9091&#x2F;config</a>ï¼Œå¯ä»¥æŸ¥è¯¢åˆ°æ­£ç¡®çš„é…ç½®</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232205076.png" alt="image-20230228232205076"></p></li></ol><h1 id="Configå®¢æˆ·ç«¯ä¹‹åŠ¨æ€åˆ·æ–°"><a href="#Configå®¢æˆ·ç«¯ä¹‹åŠ¨æ€åˆ·æ–°" class="headerlink" title="Configå®¢æˆ·ç«¯ä¹‹åŠ¨æ€åˆ·æ–°"></a>Configå®¢æˆ·ç«¯ä¹‹åŠ¨æ€åˆ·æ–°</h1><p>é¿å…æ¯æ¬¡ä¿®æ”¹githibä¸Šçš„é…ç½®éƒ½éœ€è¦é‡å¯å®¢æˆ·ç«¯</p><h2 id="æ‰‹åŠ¨ç‰ˆ"><a href="#æ‰‹åŠ¨ç‰ˆ" class="headerlink" title="æ‰‹åŠ¨ç‰ˆ"></a>æ‰‹åŠ¨ç‰ˆ</h2><p>ä¼˜ç‚¹ï¼šè§£å†³äº†é‡å¯ Config å®¢æˆ·ç«¯æ‰èƒ½è·å–æœ€æ–°é…ç½®çš„é—®é¢˜ï¼Œ</p><p>ç¼ºç‚¹ï¼šåªè¦é…ç½®ä»“åº“ä¸­çš„é…ç½®å‘ç”Ÿæ”¹å˜ï¼Œå°±éœ€è¦æˆ‘ä»¬æŒ¨ä¸ªå‘ Config å®¢æˆ·ç«¯æ‰‹åŠ¨å‘é€ POST è¯·æ±‚ï¼Œé€šçŸ¥å®ƒä»¬é‡æ–°æ‹‰å–é…ç½®ã€‚</p><p>é‚£ä¹ˆæœ‰æ²¡æœ‰â€œä¸€æ¬¡é€šçŸ¥ï¼Œå¤„å¤„ç”Ÿæ•ˆâ€çš„æ–¹å¼å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚Spring Cloud Config é…åˆ Bus å°±å¯ä»¥å®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
      <tag>é›†ä¸­åŒ–é…ç½®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springCloudä¹‹Eurekaæ­å»º</title>
    <link href="/springCloud%E4%B9%8BEureka%E6%90%AD%E5%BB%BA/"/>
    <url>/springCloud%E4%B9%8BEureka%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="Eurekaæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Eurekaæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Eurekaæ˜¯ä»€ä¹ˆï¼Ÿ"></a>Eurekaæ˜¯ä»€ä¹ˆï¼Ÿ</h1><ul><li>Eurekaæ˜¯ Netflix å…¬å¸å¼€å‘çš„ä¸€æ¬¾å¼€æºçš„æœåŠ¡æ³¨å†Œä¸å‘ç°ç»„ä»¶ã€‚</li><li>Spring Cloud å°† Eureka ä¸ Netflix ä¸­çš„å…¶ä»–å¼€æºæœåŠ¡ç»„ä»¶ï¼ˆä¾‹å¦‚ Ribbonã€Feign ä»¥åŠ Hystrix ç­‰ï¼‰ä¸€èµ·æ•´åˆè¿› Spring Cloud Netflix æ¨¡å—ä¸­ï¼Œæ•´åˆåçš„ç»„ä»¶å…¨ç§°ä¸º Spring Cloud Netflix Eurekaã€‚</li><li>Eureka æ˜¯ Spring Cloud Netflix æ¨¡å—çš„å­æ¨¡å—ï¼Œå®ƒæ˜¯ Spring Cloud å¯¹ Netflix Eureka çš„äºŒæ¬¡å°è£…ï¼Œä¸»è¦è´Ÿè´£ Spring Cloud çš„æœåŠ¡æ³¨å†Œä¸å‘ç°åŠŸèƒ½ã€‚</li></ul><h1 id="Eureka-ä¸¤å¤§ç»„ä»¶"><a href="#Eureka-ä¸¤å¤§ç»„ä»¶" class="headerlink" title="Eureka ä¸¤å¤§ç»„ä»¶"></a>Eureka ä¸¤å¤§ç»„ä»¶</h1><p>Eureka é‡‡ç”¨ CSï¼ˆClient&#x2F;Serverï¼Œå®¢æˆ·ç«¯&#x2F;æœåŠ¡å™¨ï¼‰ æ¶æ„ï¼Œå®ƒåŒ…æ‹¬ä»¥ä¸‹ä¸¤å¤§ç»„ä»¶ï¼š</p><ul><li><p><strong>Eureka Server</strong>ï¼šEureka æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œä¸»è¦ç”¨äºæä¾›æœåŠ¡æ³¨å†ŒåŠŸèƒ½ã€‚å½“å¾®æœåŠ¡å¯åŠ¨æ—¶ï¼Œä¼šå°†è‡ªå·±çš„æœåŠ¡æ³¨å†Œåˆ° Eureka Serverã€‚Eureka Server ç»´æŠ¤äº†ä¸€ä¸ªå¯ç”¨æœåŠ¡åˆ—è¡¨ï¼Œå­˜å‚¨äº†æ‰€æœ‰æ³¨å†Œåˆ° Eureka Server çš„å¯ç”¨æœåŠ¡çš„ä¿¡æ¯ï¼Œè¿™äº›å¯ç”¨æœåŠ¡å¯ä»¥åœ¨ Eureka Server çš„ç®¡ç†ç•Œé¢ä¸­ç›´è§‚çœ‹åˆ°ã€‚</p></li><li><p><strong>Eureka Client</strong>ï¼šEureka å®¢æˆ·ç«¯ï¼Œé€šå¸¸æŒ‡çš„æ˜¯å¾®æœåŠ¡ç³»ç»Ÿä¸­å„ä¸ªå¾®æœåŠ¡ï¼Œä¸»è¦ç”¨äºå’Œ Eureka Server è¿›è¡Œäº¤äº’ã€‚åœ¨å¾®æœåŠ¡åº”ç”¨å¯åŠ¨åï¼ŒEureka Client ä¼šå‘ Eureka Server å‘é€å¿ƒè·³ï¼ˆé»˜è®¤å‘¨æœŸä¸º 30 ç§’ï¼‰ã€‚è‹¥ Eureka Server åœ¨å¤šä¸ªå¿ƒè·³å‘¨æœŸå†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ª Eureka Client çš„å¿ƒè·³ï¼ŒEureka Server å°†å®ƒä»å¯ç”¨æœåŠ¡åˆ—è¡¨ä¸­ç§»é™¤ï¼ˆé»˜è®¤ 90 ç§’</p></li></ul><h1 id="Eureka-è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶"><a href="#Eureka-è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶" class="headerlink" title="Eureka è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶"></a>Eureka è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶</h1><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><ul><li>é»˜è®¤æƒ…å†µä¸‹,EurekaClientä¼šå®šæ—¶å‘EurekaServerç«¯å‘é€å¿ƒè·³ï¼Œå¦‚æœEurekaServeråœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°EurekaClientå‘é€çš„å¿ƒè·³ï¼Œä¾¿ä¼šæŠŠè¯¥å®ä¾‹ä»æ³¨å†ŒæœåŠ¡åˆ—è¡¨ä¸­å‰”é™¤ï¼ˆé»˜è®¤æ˜¯90ç§’)</li><li>ä½†æ˜¯åœ¨çŸ­æ—¶é—´å†…ä¸¢å¤±å¤§é‡çš„å®ä¾‹å¿ƒè·³ï¼Œè¿™æ—¶å€™EurekaServerä¼šå¼€å¯è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œ<a href="https://so.csdn.net/so/search?q=Eureka&spm=1001.2101.3001.7020">Eureka</a>ä¸ä¼šè¸¢å‡ºè¯¥æœåŠ¡ï¼Œè€Œæ˜¯ä¼šå¯¹è¯¥æœåŠ¡çš„ä¿¡æ¯è¿›è¡Œä¿å­˜ã€‚</li><li>Eurekaä»ç„¶èƒ½å¤Ÿæ¥å—æ–°æœåŠ¡çš„æ³¨å†Œå’ŒæŸ¥è¯¢è¯·æ±‚ï¼Œä½†æ˜¯ä¸ä¼šè¢«åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Š (å³ä¿è¯å½“å‰èŠ‚ç‚¹ä¾ç„¶å¯ç”¨)</li><li>å½“ç½‘ç»œç¨³å®šæ—¶ï¼Œå½“å‰å®ä¾‹æ–°çš„æ³¨å†Œä¿¡æ¯ä¼šè¢«åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ä¸­</li></ul><h2 id="äº§ç”ŸåŸå› "><a href="#äº§ç”ŸåŸå› " class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h2><p>ä¸ºäº†é˜²æ­¢EurekaClientæ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯ä¸EurekaServerç½‘ç»œä¸é€šï¼ˆå»¶è¿Ÿã€æ‹¥å µã€å¡é¡¿ï¼‰çš„æƒ…å†µä¸‹ï¼ŒEurekaServerä¸ä¼šå¯¹EurekaClientæœåŠ¡è¿›è¡Œå‰”é™¤ï¼Œå› ä¸ºå¾®æœåŠ¡æœ¬èº«æ˜¯å»ºåº·çš„ï¼Œæ­¤æ—¶ä¸åº”è¯¥æ³¨é”€è¿™ä¸ªå¾®æœåŠ¡ã€‚</p><h2 id="ä½•æ—¶ä½¿ç”¨"><a href="#ä½•æ—¶ä½¿ç”¨" class="headerlink" title="ä½•æ—¶ä½¿ç”¨"></a>ä½•æ—¶ä½¿ç”¨</h2><p>æœ¬åœ°ç¯å¢ƒå»ºè®®ç¦æ­¢è‡ªæˆ‘ä¿æŠ¤ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®å¼€å¯è‡ªæˆ‘ä¿æŠ¤ã€‚</p><h2 id="eurekaåœæ­¢æ›´æ–°äº†"><a href="#eurekaåœæ­¢æ›´æ–°äº†" class="headerlink" title="eurekaåœæ­¢æ›´æ–°äº†"></a>eurekaåœæ­¢æ›´æ–°äº†</h2><p><a href="https://github.com/Netflix/eureka/wiki">Home Â· Netflix&#x2F;eureka Wiki (github.com)</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232003650.png" alt="image-20230228232003650"></p><h1 id="Eureka-Serveræ­å»º"><a href="#Eureka-Serveræ­å»º" class="headerlink" title="Eureka Serveræ­å»º"></a>Eureka Serveræ­å»º</h1><p>å‚è€ƒ<a href="https://github.com/spring-cloud-samples/eureka">GitHub - spring-cloud-samples&#x2F;eureka</a></p><ul><li><p>Step1: æ–°å»ºä¸€ä¸ªspringBooté¡¹ç›®</p></li><li><p>Step2: ä¿®æ”¹ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java">plugins&#123;<br>id <span class="hljs-string">&#x27;org.springframework.boot&#x27;</span> version <span class="hljs-string">&#x27;2.6.1&#x27;</span><br>id <span class="hljs-string">&#x27;io.spring.dependency-management&#x27;</span> version <span class="hljs-string">&#x27;1.0.8.RELEASE&#x27;</span><br>id <span class="hljs-string">&#x27;java&#x27;</span><br>&#125;<br><br>ext &#123;<br>set(<span class="hljs-string">&#x27;springCloudVersion&#x27;</span>, <span class="hljs-string">&quot;2021.0.0&quot;</span>)<br>name = <span class="hljs-string">&#x27;Eureka Server&#x27;</span><br>description = <span class="hljs-string">&#x27;Eureka Server demo project&#x27;</span><br>version=<span class="hljs-string">&#x27;0.0.1-SNAPSHOT&#x27;</span><br>sourceEncoding=<span class="hljs-string">&#x27;UTF-8&#x27;</span><br>&#125;<br><br>repositories &#123;<br>mavenCentral()<br>maven &#123; url <span class="hljs-string">&#x27;https://repo.spring.io/release/&#x27;</span> &#125;<br>maven &#123; url <span class="hljs-string">&quot;https://repo.spring.io/libs-snapshot-local&quot;</span> &#125;<br>maven &#123; url <span class="hljs-string">&quot;https://repo.spring.io/libs-milestone-local&quot;</span> &#125;<br>maven &#123; url <span class="hljs-string">&quot;https://repo.spring.io/libs-release-local&quot;</span> &#125;<br>maven &#123; url <span class="hljs-string">&quot;https://repo.springsource.org/plugins-release&quot;</span> &#125;<br>&#125;<br><br>dependencyManagement &#123;<br>imports &#123;<br>mavenBom <span class="hljs-string">&quot;org.springframework.cloud:spring-cloud-dependencies:$&#123;springCloudVersion&#125;&quot;</span><br>&#125;<br>&#125;<br><br>dependencies &#123;<br>implementation <span class="hljs-string">&#x27;org.springframework.cloud:spring-cloud-starter-netflix-eureka-server&#x27;</span><br>testImplementation <span class="hljs-string">&#x27;org.springframework.boot:spring-boot-starter-test&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Step3: applicationé…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml">server.port: 8761<br><br>eureka.instance.hostname: localhost<br>#eurekaå¯ä»¥åŒæ—¶ä½œä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œè¿™é‡Œç¦ç”¨æ‰ä»–å®¢æˆ·ç«¯çš„èƒ½åŠ›<br>eureka.client.registerWithEureka: false<br>eureka.client.fetchRegistry: false<br>eureka.client.serviceUrl.defaultZone: http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/<br><br>#å…³é—­è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œä»¥ç¡®ä¿æ³¨å†Œä¸­å¿ƒå°†ä¸å¯ç”¨çš„å®ä¾‹åŠæ—¶æ­£ç¡®å‰”é™¤<br>eureka.server.enable-self-preservation=false<br></code></pre></td></tr></table></figure></li><li><p>step4.å¯åŠ¨ç±»åŠ ä¸Š@EnableEurekaServeræ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><span class="hljs-keyword">import</span> org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@EnableEurekaServer</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> </span>&#123;<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    SpringApplication.run(Application.class, args);<br>  &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure></li><li><p>å¯åŠ¨æˆåŠŸåï¼Œè®¿é—®<a href="http://localhost:8761/">Eureka</a>å¯ä»¥çœ‹åˆ°å¦‚ä¸‹é¡µé¢ï¼Œå¯ä»¥çœ‹å‡ºæ­¤æ—¶è¿˜æ²¡æœ‰å®ä¾‹æ³¨å†Œåˆ°è¯¥æœåŠ¡ä¸Šã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232017385.png" alt="image-20230228232017385"></p></li></ul><h1 id="Eureka-Clientæ­å»º"><a href="#Eureka-Clientæ­å»º" class="headerlink" title="Eureka Clientæ­å»º"></a>Eureka Clientæ­å»º</h1><ul><li><p>Step1: æ–°å»ºä¸€ä¸ªspringBooté¡¹ç›®</p></li><li><p>Step2: ä¿®æ”¹ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java">plugins&#123;<br>id <span class="hljs-string">&#x27;org.springframework.boot&#x27;</span> version <span class="hljs-string">&#x27;2.6.1&#x27;</span><br>id <span class="hljs-string">&#x27;io.spring.dependency-management&#x27;</span> version <span class="hljs-string">&#x27;1.0.8.RELEASE&#x27;</span><br>id <span class="hljs-string">&#x27;java&#x27;</span><br>&#125;<br><br>ext &#123;<br>set(<span class="hljs-string">&#x27;springCloudVersion&#x27;</span>, <span class="hljs-string">&quot;2021.0.0&quot;</span>)<br>name = <span class="hljs-string">&#x27;Eureka Server&#x27;</span><br>description = <span class="hljs-string">&#x27;Eureka Server demo project&#x27;</span><br>version=<span class="hljs-string">&#x27;0.0.1-SNAPSHOT&#x27;</span><br>    <br>sourceEncoding=<span class="hljs-string">&#x27;UTF-8&#x27;</span><br>&#125;<br><br>repositories &#123;<br>mavenCentral()<br>maven &#123; url <span class="hljs-string">&#x27;https://repo.spring.io/release/&#x27;</span> &#125;<br>maven &#123; url <span class="hljs-string">&quot;https://repo.spring.io/libs-snapshot-local&quot;</span> &#125;<br>maven &#123; url <span class="hljs-string">&quot;https://repo.spring.io/libs-milestone-local&quot;</span> &#125;<br>maven &#123; url <span class="hljs-string">&quot;https://repo.spring.io/libs-release-local&quot;</span> &#125;<br>maven &#123; url <span class="hljs-string">&quot;https://repo.springsource.org/plugins-release&quot;</span> &#125;<br>&#125;<br><br>dependencyManagement &#123;<br>imports &#123;<br>mavenBom <span class="hljs-string">&quot;org.springframework.cloud:spring-cloud-dependencies:$&#123;springCloudVersion&#125;&quot;</span><br>&#125;<br>&#125;<br><br>dependencies &#123;<br>implementation <span class="hljs-string">&#x27;org.springframework.cloud:spring-cloud-starter-netflix-eureka-client&#x27;</span><br>implementation <span class="hljs-string">&#x27;org.springframework.boot:spring-boot-starter-web&#x27;</span><br><br>testImplementation <span class="hljs-string">&#x27;org.springframework.boot:spring-boot-starter-test&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Step3: applicationé…ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">spring.application.name: micro-weather-eureka-client<br>eureka.client.serviceUrl.defaultZone: http:<span class="hljs-comment">//localhost:8761//eureka/</span><br></code></pre></td></tr></table></figure></li><li><p>step4.å¯åŠ¨ç±»åŠ ä¸Š@EnableDiscoveryClientæ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><span class="hljs-keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@EnableDiscoveryClient</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    SpringApplication.run(Application.class, args);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>åˆ·æ–°</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232035911.png" alt="image-20230228232035911"></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¾®æœåŠ¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>java åå°„</title>
    <link href="/java-%E5%8F%8D%E5%B0%84/"/>
    <url>/java-%E5%8F%8D%E5%B0%84/</url>
    
    <content type="html"><![CDATA[<h1 id="åå°„æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#åå°„æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="åå°„æ˜¯ä»€ä¹ˆï¼Ÿ"></a>åå°„æ˜¯ä»€ä¹ˆï¼Ÿ</h1><ul><li><p>åå°„å°±æ˜¯æŒ‡åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»ä½•ä¸€ä¸ªç±»ï¼Œèƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚</p></li><li><p>å¯¹äºä»»ä½•ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½è°ƒç”¨å®ƒçš„ä»»æ„å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸”å¯ä»¥æ”¹å˜ä»–çš„å±æ€§ã€‚</p></li><li><p>åå°„æ˜¯javaè¢«å¸‚å§”å‡†åŠ¨æ€è¯­è¨€çš„å…³é”®ï¼Œåå°„æœºåˆ¶å…è®¸ç¨‹åºåœ¨æ‰§è¡ŒæœŸé—´å€ŸåŠ©åå°„Apiæ¥è·å–ä»»ä½•ç±»çš„å†…éƒ¨ä¿¡æ¯ï¼Œå¹¶èƒ½å¤Ÿç›´æ¥æ“ä½œä»»æ„å¯¹è±¡çš„å†…éƒ¨å±æ€§åŠæ–¹æ³•ã€‚</p></li><li><p>åŠ è½½å®Œç±»åï¼Œåœ¨å †å†…å­˜çš„æ–¹æ³•åŒºå°±äº§ç”Ÿäº†ä¸€ä¸ªClassç±»å‹çš„å¯¹è±¡ï¼Œå¯¹åº”è¿™ä¸ªç±»ã€‚è¿™ä¸ªå¯¹è±¡å°±åŒ…å«äº†è¿™ä¸ªç±»çš„å®Œæ•´ç»“æ„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡çœ‹åˆ°ç±»çš„ç»“æ„ã€‚è¿™ä¸ªå¯¹è±¡å°±åƒä¸€é¢é•œå­ï¼Œé€šè¿‡è¿™é¢é•œå­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç±»çš„ç»“æ„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç§°ä¹‹ä¸ºï¼šåå°„ã€‚</p></li></ul><h1 id="åå°„å¯ä»¥åšä»€ä¹ˆ"><a href="#åå°„å¯ä»¥åšä»€ä¹ˆ" class="headerlink" title="åå°„å¯ä»¥åšä»€ä¹ˆ"></a>åå°„å¯ä»¥åšä»€ä¹ˆ</h1><p>åå°„å…è®¸æˆ‘ä»¬åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œå–å¾—ä»»ä½•ä¸€ä¸ªå·²çŸ¥classçš„å†…éƒ¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…¶å±æ€§ï¼Œæ–¹æ³•ç­‰ï¼Œå¹¶å¯ä»¥åœ¨è¿è¡Œæ—¶æ”¹å˜ä»–ä»¬å‘¢ã€‚</p><p>è·å–classå¯¹è±¡çš„äº”ç§æ–¹å¼ï¼š<a href="https://pyr9.github.io/2022/07/13/Java%E8%8E%B7%E5%8F%96class%E7%9A%84%E5%9B%9B%E7%A7%8D%E6%96%B9%E5%BC%8F/">Javaè·å–classçš„äº”ç§æ–¹å¼ - æ¥¼ä¸Šæœ‰åªå–µ (pyr9.github.io)</a></p><h1 id="åå°„çš„å…·ä½“å®ç°"><a href="#åå°„çš„å…·ä½“å®ç°" class="headerlink" title="åå°„çš„å…·ä½“å®ç°"></a>åå°„çš„å…·ä½“å®ç°</h1><p>æŸ¥é˜… API å¯ä»¥çœ‹åˆ° Class æœ‰å¾ˆå¤šæ–¹æ³•ï¼š</p><ul><li><p>getName()ï¼šè·å¾—ç±»çš„å®Œæ•´åå­—ã€‚</p></li><li><p>getFields()ï¼šè·å¾—ç±»çš„publicç±»å‹çš„å±æ€§ã€‚</p><ul><li>getDeclaredFields()ï¼šè·å¾—ç±»çš„æ‰€æœ‰å±æ€§ã€‚åŒ…æ‹¬private å£°æ˜çš„å’Œç»§æ‰¿ç±»</li><li>getMethods()ï¼šè·å¾—ç±»çš„publicç±»å‹çš„æ–¹æ³•ã€‚</li><li>getDeclaredMethods()ï¼šè·å¾—ç±»çš„æ‰€æœ‰æ–¹æ³•ã€‚åŒ…æ‹¬private å£°æ˜çš„å’Œç»§æ‰¿ç±»</li><li>getMethod(String name, Class[] parameterTypes)ï¼šè·å¾—ç±»çš„ç‰¹å®šæ–¹æ³•ï¼Œnameå‚æ•°æŒ‡å®šæ–¹æ³•çš„åå­—ï¼ŒparameterTypes å‚æ•°æŒ‡å®šæ–¹æ³•çš„å‚æ•°ç±»å‹ã€‚</li><li>getConstructors()ï¼šè·å¾—ç±»çš„publicç±»å‹çš„æ„é€ æ–¹æ³•ã€‚</li><li>getConstructor(Class[] parameterTypes)ï¼šè·å¾—ç±»çš„ç‰¹å®šæ„é€ æ–¹æ³•ï¼ŒparameterTypes å‚æ•°æŒ‡å®šæ„é€ æ–¹æ³•çš„å‚æ•°ç±»</li><li>newInstance()ï¼šé€šè¿‡ç±»çš„ä¸å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•åˆ›å»ºè¿™ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡</li></ul></li></ul><p><strong>ä»£ç æµ‹è¯•ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.my.test.reflection;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Father</span></span>&#123;<br>  <span class="hljs-keyword">public</span> String fatherId;<br>  <span class="hljs-keyword">private</span> String fatherName;<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getFatherHobbies</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;eat&quot;</span>;<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getFatherWork</span><span class="hljs-params">()</span></span>&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;computer&quot;</span>;<br>  &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Son</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Father</span></span>&#123;<br>  <span class="hljs-keyword">public</span> String sonId;<br>  <span class="hljs-keyword">private</span> String name;<br>  <span class="hljs-keyword">private</span> Integer age;<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getSonHobbies</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;study&quot;</span>;<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getSonWork</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;student&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.my.test.reflection;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> NoSuchFieldException, NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException </span>&#123;<br>    <span class="hljs-keyword">final</span> Class&lt;Son&gt; clazz = Son.class;<br>    System.out.println(<span class="hljs-string">&quot;è·å¾—ç±»çš„å®Œæ•´åå­—-------------------&quot;</span>);<br>    System.out.println(clazz.getName());<br><br>    System.out.println(<span class="hljs-string">&quot;è·å¾—ç±»çš„publicç±»å‹çš„å±æ€§-------------------&quot;</span>);<br>    <span class="hljs-keyword">for</span> (Field field : clazz.getFields()) &#123;<br>      <span class="hljs-comment">// ç”±äºJDKçš„å®‰å…¨æ£€æŸ¥è€—æ—¶è¾ƒå¤š.æ‰€ä»¥é€šè¿‡setAccessible(true)çš„æ–¹å¼å…³é—­å®‰å…¨æ£€æŸ¥å°±å¯ä»¥è¾¾åˆ°æå‡åå°„é€Ÿåº¦çš„ç›®çš„</span><br>      field.setAccessible(<span class="hljs-keyword">true</span>);<br>      System.out.println(field.getName());<br>    &#125;<br><br>    System.out.println(<span class="hljs-string">&quot;è·å¾—ç±»çš„æ‰€æœ‰å±æ€§ã€‚åŒ…æ‹¬privateçš„---------------&quot;</span>);<br>    <span class="hljs-keyword">for</span> (Field field : clazz.getDeclaredFields()) &#123;<br>      System.out.println(field.getName());<br>    &#125;<br><br><br>    System.out.println(<span class="hljs-string">&quot;è·å¾—ç±»çš„publicç±»å‹çš„æ–¹æ³•,åŒ…æ‹¬Objectçš„-------------------&quot;</span>);<br>    <span class="hljs-keyword">for</span> (Method method : clazz.getMethods()) &#123;<br>      System.out.println(method.getName());<br>    &#125;<br><br>    System.out.println(<span class="hljs-string">&quot;è·å¾—ç±»çš„æ‰€æœ‰æ–¹æ³•ã€‚-------------------&quot;</span>);<br>    <span class="hljs-keyword">for</span> (Method method : clazz.getDeclaredMethods()) &#123;<br>      System.out.println(method.getName());<br>    &#125;<br><br>    System.out.println(<span class="hljs-string">&quot;è·å¾—æŒ‡å®šçš„publicå±æ€§ã€‚-------------------&quot;</span>);<br>    Field sonId = clazz.getField(<span class="hljs-string">&quot;sonId&quot;</span>);<br>    System.out.println(sonId);<br><br>    System.out.println(<span class="hljs-string">&quot;è·å¾—æŒ‡å®šçš„privateå±æ€§ã€‚-------------------&quot;</span>);<br>    Field age = clazz.getDeclaredField(<span class="hljs-string">&quot;age&quot;</span>);<br>    age.setAccessible(<span class="hljs-keyword">true</span>);<br>    System.out.println(age);<br><br>    System.out.println(<span class="hljs-string">&quot;åˆ›å»ºè¿™ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡-------------------&quot;</span>);<br>    <span class="hljs-keyword">final</span> Son son = clazz.getDeclaredConstructor().newInstance();<br>    System.out.println(son);<br><br>    System.out.println(<span class="hljs-string">&quot;å°†sonå¯¹è±¡çš„ageå±æ€§èµ‹å€¼ä¸º19------------&quot;</span>);<br>    age.set(son, <span class="hljs-number">19</span>);<br>    System.out.println(age.get(son));<br><br>    System.out.println(<span class="hljs-string">&quot;è·å–æ„é€ æ–¹æ³•-------------&quot;</span>);<br>    <span class="hljs-keyword">final</span> Constructor&lt;?&gt;[] constructors = clazz.getConstructors();<br>    <span class="hljs-keyword">for</span> (Constructor&lt;?&gt; constructor : constructors) &#123;<br>      System.out.println(constructor.toString());<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Console:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs stylus">è·å¾—ç±»çš„å®Œæ•´åå­—-------------------<br>com<span class="hljs-selector-class">.my</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.reflection</span><span class="hljs-selector-class">.Son</span><br>è·å¾—ç±»çš„publicç±»å‹çš„å±æ€§-------------------<br>sonId<br>fatherId<br>è·å¾—ç±»çš„æ‰€æœ‰å±æ€§ã€‚åŒ…æ‹¬privateçš„---------------<br>sonId<br>name<br>age<br>è·å¾—ç±»çš„publicç±»å‹çš„æ–¹æ³•,åŒ…æ‹¬Objectçš„-------------------<br>getSonHobbies<br>getFatherHobbies<br>wait<br>wait<br>wait<br>equals<br>toString<br>hashCode<br>getClass<br>notify<br>notifyAll<br>è·å¾—ç±»çš„æ‰€æœ‰æ–¹æ³•ã€‚-------------------<br>getSonWork<br>getSonHobbies<br>getFatherHobbies<br>è·å¾—æŒ‡å®šçš„publicå±æ€§ã€‚-------------------<br>public java<span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.String</span> com<span class="hljs-selector-class">.my</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.reflection</span><span class="hljs-selector-class">.Son</span><span class="hljs-selector-class">.sonId</span><br>è·å¾—æŒ‡å®šçš„privateå±æ€§ã€‚-------------------<br>private java<span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.Integer</span> com<span class="hljs-selector-class">.my</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.reflection</span><span class="hljs-selector-class">.Son</span><span class="hljs-selector-class">.age</span><br>åˆ›å»ºè¿™ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡-------------------<br>com<span class="hljs-selector-class">.my</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.reflection</span>.Son@<span class="hljs-number">1</span>cd072a9<br>å°†sonå¯¹è±¡çš„ageå±æ€§èµ‹å€¼ä¸º<span class="hljs-number">19</span>------------<br><span class="hljs-number">19</span><br>è·å–æ„é€ æ–¹æ³•-------------<br>public com<span class="hljs-selector-class">.my</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.reflection</span><span class="hljs-selector-class">.Son</span>()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javaåŸºç¡€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>isAssignableFrom()</title>
    <link href="/isAssignableFrom-%E5%92%8Cinstanceof/"/>
    <url>/isAssignableFrom-%E5%92%8Cinstanceof/</url>
    
    <content type="html"><![CDATA[<h1 id="isAssignableFrom"><a href="#isAssignableFrom" class="headerlink" title="isAssignableFrom()"></a>isAssignableFrom()</h1><p>A.isAssignableFrom(B)æ–¹æ³•å¯ç”¨æ¥åˆ¤æ–­Bæ˜¯å¦å¯ä»¥ç”±Aè½¬æ¢ï¼ˆèµ‹å€¼å¾—æ¥ï¼‰ï¼Œå³</p><p>1.å½“Aæ˜¯ç±»æ—¶ï¼Œè¡¨ç¤ºï¼šç±»Aæ˜¯å¦ä¸ºBç±»çš„çˆ¶ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.my.test.isAggsignableFrom;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Parent</span></span>&#123;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Son1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Parent</span></span>&#123;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Brother</span> </span>&#123;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test01</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    System.out.println(Parent.class.isAssignableFrom(Son1.class));   =&gt; <span class="hljs-keyword">true</span><br>    System.out.println(Parent.class.isAssignableFrom(Brother.class));  =&gt; <span class="hljs-keyword">false</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2.å½“Aæ˜¯æ¥å£æ—¶ï¼Œè¡¨ç¤ºï¼šæ¥å£Aæ˜¯å¦è¢«ç±»Bå®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.my.test.isAggsignableFrom;<br><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">A</span></span>&#123;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">A</span></span>&#123;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B1</span></span>&#123;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test02</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    System.out.println(A.class.isAssignableFrom(A1.class));  =&gt; <span class="hljs-keyword">true</span><br>    System.out.println(A.class.isAssignableFrom(B1.class));  =&gt; <span class="hljs-keyword">false</span><br>  &#125; <br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javaåŸºç¡€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaè·å–classçš„äº”ç§æ–¹å¼</title>
    <link href="/Java%E8%8E%B7%E5%8F%96class%E7%9A%84%E5%9B%9B%E7%A7%8D%E6%96%B9%E5%BC%8F/"/>
    <url>/Java%E8%8E%B7%E5%8F%96class%E7%9A%84%E5%9B%9B%E7%A7%8D%E6%96%B9%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="è·å–Class-ç±»å®ä¾‹çš„äº”ç§æ–¹å¼"><a href="#è·å–Class-ç±»å®ä¾‹çš„äº”ç§æ–¹å¼" class="headerlink" title="è·å–Class ç±»å®ä¾‹çš„äº”ç§æ–¹å¼"></a>è·å–Class ç±»å®ä¾‹çš„äº”ç§æ–¹å¼</h1><h2 id="1-å·²çŸ¥å…·ä½“çš„ç±»ï¼Œç›´æ¥å–è¯¥ç±»çš„classå±æ€§-æœ€å®‰å…¨ï¼Œæœ€å¯é "><a href="#1-å·²çŸ¥å…·ä½“çš„ç±»ï¼Œç›´æ¥å–è¯¥ç±»çš„classå±æ€§-æœ€å®‰å…¨ï¼Œæœ€å¯é " class="headerlink" title="1.å·²çŸ¥å…·ä½“çš„ç±»ï¼Œç›´æ¥å–è¯¥ç±»çš„classå±æ€§(æœ€å®‰å…¨ï¼Œæœ€å¯é )"></a>1.å·²çŸ¥å…·ä½“çš„ç±»ï¼Œç›´æ¥å–è¯¥ç±»çš„classå±æ€§(æœ€å®‰å…¨ï¼Œæœ€å¯é )</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Class clazz01 = Person.class;<br></code></pre></td></tr></table></figure><h2 id="2-å·²çŸ¥æŸä¸ªç±»çš„ç¤ºä¾‹ï¼Œè°ƒç”¨è¯¥ç¤ºä¾‹çš„getClass"><a href="#2-å·²çŸ¥æŸä¸ªç±»çš„ç¤ºä¾‹ï¼Œè°ƒç”¨è¯¥ç¤ºä¾‹çš„getClass" class="headerlink" title="2.å·²çŸ¥æŸä¸ªç±»çš„ç¤ºä¾‹ï¼Œè°ƒç”¨è¯¥ç¤ºä¾‹çš„getClass()"></a>2.å·²çŸ¥æŸä¸ªç±»çš„ç¤ºä¾‹ï¼Œè°ƒç”¨è¯¥ç¤ºä¾‹çš„getClass()</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Class clazz02 = <span class="hljs-keyword">new</span> Person().getClass();<br></code></pre></td></tr></table></figure><h2 id="3-å·²çŸ¥è¯¥ç±»çš„å…¨è·¯å¾„ï¼Œé€šè¿‡Class-forName-è·å¾—"><a href="#3-å·²çŸ¥è¯¥ç±»çš„å…¨è·¯å¾„ï¼Œé€šè¿‡Class-forName-è·å¾—" class="headerlink" title="3.å·²çŸ¥è¯¥ç±»çš„å…¨è·¯å¾„ï¼Œé€šè¿‡Class.forName() è·å¾—"></a>3.å·²çŸ¥è¯¥ç±»çš„å…¨è·¯å¾„ï¼Œé€šè¿‡Class.forName() è·å¾—</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Class class03 = Class.forName(<span class="hljs-string">&quot;com.getClass.pojo.Person&quot;</span>);<br></code></pre></td></tr></table></figure><p>è¯¥æ–¹å¼å¯èƒ½ä¼šæŠ›å‡ºï¼šClassNotFoundException</p><h2 id="4-å·²çŸ¥è¯¥ç±»çš„å…¨è·¯å¾„ï¼Œé€šè¿‡ClassLoader-loadClass-è·å¾—"><a href="#4-å·²çŸ¥è¯¥ç±»çš„å…¨è·¯å¾„ï¼Œé€šè¿‡ClassLoader-loadClass-è·å¾—" class="headerlink" title="4.å·²çŸ¥è¯¥ç±»çš„å…¨è·¯å¾„ï¼Œé€šè¿‡ClassLoader.loadClass() è·å¾—"></a>4.å·²çŸ¥è¯¥ç±»çš„å…¨è·¯å¾„ï¼Œé€šè¿‡ClassLoader.loadClass() è·å¾—</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">ClassLoader classLoader = MySpringApplicationContext.class.getClassLoader();<br><span class="hljs-keyword">final</span> Class clazz05 = classLoader.loadClass(<span class="hljs-string">&quot;com.getClass.pojo.Person&quot;</span>);<br></code></pre></td></tr></table></figure><p>è¯¥æ–¹å¼å¯èƒ½ä¼šæŠ›å‡ºï¼šClassNotFoundException</p><h2 id="5-åŸºæœ¬äº†ç±»å‹çš„åŒ…è£…ç±»ï¼Œç›´æ¥è°ƒç”¨-type"><a href="#5-åŸºæœ¬äº†ç±»å‹çš„åŒ…è£…ç±»ï¼Œç›´æ¥è°ƒç”¨-type" class="headerlink" title="5. åŸºæœ¬äº†ç±»å‹çš„åŒ…è£…ç±»ï¼Œç›´æ¥è°ƒç”¨.type"></a>5. åŸºæœ¬äº†ç±»å‹çš„åŒ…è£…ç±»ï¼Œç›´æ¥è°ƒç”¨.type</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Class clazz04 = Integer.TYPE;<br></code></pre></td></tr></table></figure><p>â€‹</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javaåŸºç¡€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springäº‹åŠ¡å¤±æ•ˆ</title>
    <link href="/spring%E4%BA%8B%E5%8A%A1%E5%A4%B1%E6%95%88/"/>
    <url>/spring%E4%BA%8B%E5%8A%A1%E5%A4%B1%E6%95%88/</url>
    
    <content type="html"><![CDATA[<p>~&#x2F;IdeaProjects&#x2F;hexo_blog&#x2F;source&#x2F;_posts&#x2F;springäº‹åŠ¡å¤±æ•ˆ.md</p><p>![image-20220626230019084](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220626230019084.png)</p><p>![image-20220626230308183](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220626230308183.png)</p><p>![image-20220626231230229](&#x2F;Users&#x2F;panyurou&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220626231230229.png)</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>javaå‘½ä»¤--jstackçš„ä½¿ç”¨</title>
    <link href="/java%E5%91%BD%E4%BB%A4-jstack-%E5%B7%A5%E5%85%B7/"/>
    <url>/java%E5%91%BD%E4%BB%A4-jstack-%E5%B7%A5%E5%85%B7/</url>
    
    <content type="html"><![CDATA[<p>jstackç”¨äºç”Ÿæˆjavaè™šæ‹Ÿæœºå½“å‰æ—¶åˆ»çš„çº¿ç¨‹å¿«ç…§ã€‚å¯ä»¥ç”¨æ¥åˆ†æçº¿ç¨‹é—®é¢˜ï¼ˆå¦‚æ­»é”ï¼‰ï¼ŒCPUçªç„¶é£™å‡é—®é¢˜</p><h1 id="1-æ¡ˆä¾‹ä¸€-æ‰¾å‡ºæ­»é”"><a href="#1-æ¡ˆä¾‹ä¸€-æ‰¾å‡ºæ­»é”" class="headerlink" title="1. æ¡ˆä¾‹ä¸€ æ‰¾å‡ºæ­»é”"></a>1. æ¡ˆä¾‹ä¸€ æ‰¾å‡ºæ­»é”</h1><h2 id="1-1-é—®é¢˜ä»£ç "><a href="#1-1-é—®é¢˜ä»£ç " class="headerlink" title="1.1 é—®é¢˜ä»£ç "></a>1.1 é—®é¢˜ä»£ç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeadLockTest</span> </span>&#123;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Object lock1 = <span class="hljs-keyword">new</span> Object();<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Object lock2 = <span class="hljs-keyword">new</span> Object();<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>      <span class="hljs-keyword">new</span> Thread(() -&gt; &#123;<br>         <span class="hljs-keyword">synchronized</span> (lock1) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>               System.out.println(<span class="hljs-string">&quot;thread1 begin&quot;</span>);<br>               Thread.sleep(<span class="hljs-number">5000</span>);<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            &#125;<br>            <span class="hljs-keyword">synchronized</span> (lock2) &#123;<br>               System.out.println(<span class="hljs-string">&quot;thread1 end&quot;</span>);<br>            &#125;<br>         &#125;<br>      &#125;).start();<br><br>      <span class="hljs-keyword">new</span> Thread(() -&gt; &#123;<br>         <span class="hljs-keyword">synchronized</span> (lock2) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>               System.out.println(<span class="hljs-string">&quot;thread2 begin&quot;</span>);<br>               Thread.sleep(<span class="hljs-number">5000</span>);<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            &#125;<br>            <span class="hljs-keyword">synchronized</span> (lock1) &#123;<br>               System.out.println(<span class="hljs-string">&quot;thread2 end&quot;</span>);<br>            &#125;<br>         &#125;<br>      &#125;).start();<br><br>      System.out.println(<span class="hljs-string">&quot;main thread end&quot;</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="1-2-é—®é¢˜å®šä½"><a href="#1-2-é—®é¢˜å®šä½" class="headerlink" title="1.2 é—®é¢˜å®šä½"></a>1.2 é—®é¢˜å®šä½</h2><h3 id="1-2-1-æ–¹å¼ä¸€-jps-jstack"><a href="#1-2-1-æ–¹å¼ä¸€-jps-jstack" class="headerlink" title="1.2.1 æ–¹å¼ä¸€ jps+jstack"></a>1.2.1 æ–¹å¼ä¸€ jps+jstack</h3><ol><li>è¿è¡Œ<code>jps</code>ï¼ŒæŸ¥çœ‹å½“å‰æ‰€æœ‰javaè¿›ç¨‹çš„pid</li><li><code>jstack pid</code> æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„å †æ ˆçŠ¶æ€ï¼Œå¦‚æœæœ‰æ­»é”ä¼šæ‰“å°å‡ºæ¥found 1 deadLock</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231139474.png" alt="image-20230228231139474"></p><p>â€‹       å¯ä»¥å®šä½å‡ºæ˜¯17è¡Œå‡ºäº†æ­»é”é—®é¢˜ã€‚</p><h3 id="1-2-2-æ–¹å¼äºŒ-jvisualvmè‡ªåŠ¨æ£€æµ‹æ­»é”"><a href="#1-2-2-æ–¹å¼äºŒ-jvisualvmè‡ªåŠ¨æ£€æµ‹æ­»é”" class="headerlink" title="1.2.2 æ–¹å¼äºŒ jvisualvmè‡ªåŠ¨æ£€æµ‹æ­»é”"></a>1.2.2 æ–¹å¼äºŒ jvisualvmè‡ªåŠ¨æ£€æµ‹æ­»é”</h3><p>ä»£ç è¿è¡Œèµ·æ¥åï¼Œå¯åŠ¨jvisualvmï¼Œåœ¨çº¿ç¨‹é¡µé¢ä¼šç›´æ¥æœ‰ä¸€ä¸ªçº¢è‰²çš„æ˜¾ç¤ºï¼šç›‘æµ‹åˆ°æ­»é”</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231151238.png" alt="image-20230228231151238"></p><h1 id="2-æ¡ˆä¾‹äºŒ-æ‰¾å‡ºå ç”¨cpuæœ€é«˜çš„çº¿ç¨‹å †æ ˆä¿¡æ¯"><a href="#2-æ¡ˆä¾‹äºŒ-æ‰¾å‡ºå ç”¨cpuæœ€é«˜çš„çº¿ç¨‹å †æ ˆä¿¡æ¯" class="headerlink" title="2 æ¡ˆä¾‹äºŒ æ‰¾å‡ºå ç”¨cpuæœ€é«˜çš„çº¿ç¨‹å †æ ˆä¿¡æ¯"></a>2 æ¡ˆä¾‹äºŒ æ‰¾å‡ºå ç”¨cpuæœ€é«˜çš„çº¿ç¨‹å †æ ˆä¿¡æ¯</h1><h2 id="2-1-é—®é¢˜ä»£ç "><a href="#2-1-é—®é¢˜ä»£ç " class="headerlink" title="2.1 é—®é¢˜ä»£ç "></a>2.1 é—®é¢˜ä»£ç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Math</span> </span>&#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> initData = <span class="hljs-number">666</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> User user = <span class="hljs-keyword">new</span> User();<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compute</span><span class="hljs-params">()</span> </span>&#123;  <span class="hljs-comment">//ä¸€ä¸ªæ–¹æ³•å¯¹åº”ä¸€å—æ ˆå¸§å†…å­˜åŒºåŸŸ</span><br>    <span class="hljs-keyword">int</span> a = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">int</span> b = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">int</span> c = (a + b) * <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">return</span> c;<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>   Math math = <span class="hljs-keyword">new</span> Math();<br>    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>      math.compute();<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-2-é—®é¢˜å®šä½"><a href="#2-2-é—®é¢˜å®šä½" class="headerlink" title="2.2 é—®é¢˜å®šä½"></a>2.2 é—®é¢˜å®šä½</h2><h3 id="2-2-1-å‘½ä»¤top-p-ï¼Œæ˜¾ç¤ºä½ çš„javaè¿›ç¨‹çš„å†…å­˜æƒ…å†µï¼Œæ‰¾åˆ°å½“å‰è¿›ç¨‹çš„PID"><a href="#2-2-1-å‘½ä»¤top-p-ï¼Œæ˜¾ç¤ºä½ çš„javaè¿›ç¨‹çš„å†…å­˜æƒ…å†µï¼Œæ‰¾åˆ°å½“å‰è¿›ç¨‹çš„PID" class="headerlink" title="2.2.1 å‘½ä»¤top -p  ï¼Œæ˜¾ç¤ºä½ çš„javaè¿›ç¨‹çš„å†…å­˜æƒ…å†µï¼Œæ‰¾åˆ°å½“å‰è¿›ç¨‹çš„PID"></a>2.2.1 å‘½ä»¤top -p <pid> ï¼Œæ˜¾ç¤ºä½ çš„javaè¿›ç¨‹çš„å†…å­˜æƒ…å†µï¼Œæ‰¾åˆ°å½“å‰è¿›ç¨‹çš„PID</h3><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231203454.png" alt="image-20230228231203454"></p><h3 id="2-2-2-æŒ‰Hï¼Œè·å–æ¯ä¸ªçº¿ç¨‹çš„å†…å­˜æƒ…å†µ"><a href="#2-2-2-æŒ‰Hï¼Œè·å–æ¯ä¸ªçº¿ç¨‹çš„å†…å­˜æƒ…å†µ" class="headerlink" title="2.2.2 æŒ‰Hï¼Œè·å–æ¯ä¸ªçº¿ç¨‹çš„å†…å­˜æƒ…å†µ"></a>2.2.2 æŒ‰Hï¼Œè·å–æ¯ä¸ªçº¿ç¨‹çš„å†…å­˜æƒ…å†µ</h3><h3 id="2-2-3-æ‰¾åˆ°å†…å­˜å’Œcpuå ç”¨æœ€é«˜çš„çº¿ç¨‹tid"><a href="#2-2-3-æ‰¾åˆ°å†…å­˜å’Œcpuå ç”¨æœ€é«˜çš„çº¿ç¨‹tid" class="headerlink" title="2.2.3 æ‰¾åˆ°å†…å­˜å’Œcpuå ç”¨æœ€é«˜çš„çº¿ç¨‹tid"></a>2.2.3 æ‰¾åˆ°å†…å­˜å’Œcpuå ç”¨æœ€é«˜çš„çº¿ç¨‹tid</h3><h3 id="2-2-4-æ‰§è¡Œ-jstack-PID-grep-A-10-4cd0"><a href="#2-2-4-æ‰§è¡Œ-jstack-PID-grep-A-10-4cd0" class="headerlink" title="2.2.4 æ‰§è¡Œ jstack PID|grep -A 10 4cd0"></a>2.2.4 æ‰§è¡Œ <code>jstack PID|grep -A 10 4cd0</code></h3><p>æ¯”å¦‚tidä¸º19664 ï¼Œè½¬ä¸ºåå…­è¿›åˆ¶å¾—åˆ° 0x4cd0ï¼Œæ‰§è¡Œ jstack 19663|grep -A 10 4cd0ï¼Œå¾—åˆ°çº¿ç¨‹å †æ ˆä¿¡æ¯ä¸­ 4cd0 è¿™ä¸ªçº¿ç¨‹æ‰€åœ¨è¡Œçš„åé¢10è¡Œï¼Œä»å †æ ˆä¸­å¯ä»¥å‘ç°å¯¼è‡´cpué£™é«˜çš„è°ƒç”¨æ–¹æ³• </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228231212070.png" alt="image-20230228231212070"></p><p>6ï¼ŒæŸ¥çœ‹å¯¹åº”çš„å †æ ˆä¿¡æ¯æ‰¾å‡ºå¯èƒ½å­˜åœ¨é—®é¢˜çš„ä»£ç </p>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javaå‘½ä»¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¯¹è±¡å†…å­˜å›æ”¶</title>
    <link href="/%E5%AF%B9%E8%B1%A1%E5%86%85%E5%AD%98%E5%9B%9E%E6%94%B6/"/>
    <url>/%E5%AF%B9%E8%B1%A1%E5%86%85%E5%AD%98%E5%9B%9E%E6%94%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="åƒåœ¾å›æ”¶"><a href="#åƒåœ¾å›æ”¶" class="headerlink" title="åƒåœ¾å›æ”¶"></a>åƒåœ¾å›æ”¶</h1><p>åƒåœ¾æ”¶é›†ä¸»è¦æ˜¯é’ˆå¯¹<strong>å †å’Œæ–¹æ³•åŒº</strong>è¿›è¡Œã€‚ç¨‹åºè®¡æ•°å™¨ã€è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆè¿™ä¸‰ä¸ªåŒºåŸŸå±äºçº¿ç¨‹ç§æœ‰çš„ï¼Œåªå­˜åœ¨äºçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œçº¿ç¨‹ç»“æŸä¹‹åå°±ä¼šæ¶ˆå¤±ï¼Œå› æ­¤ä¸éœ€è¦å¯¹è¿™ä¸‰ä¸ªåŒºåŸŸè¿›è¡Œåƒåœ¾å›æ”¶ã€‚</p><h2 id="åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯è¢«å›æ”¶"><a href="#åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯è¢«å›æ”¶" class="headerlink" title="åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯è¢«å›æ”¶"></a>åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯è¢«å›æ”¶</h2><p>è¦å¯¹åƒåœ¾è¿›è¡Œå›æ”¶ï¼Œé¦–å…ˆå¾—åˆ¤æ–­è¿™ä¸ªå¯¹è±¡æ˜¯å¦å¯ä»¥è¢«å›æ”¶ï¼Œæœ‰ä¸¤ç§æ–¹æ³•æ¥åˆ¤æ–­ï¼š </p><h3 id="å¼•ç”¨è®¡æ•°æ³•"><a href="#å¼•ç”¨è®¡æ•°æ³•" class="headerlink" title="å¼•ç”¨è®¡æ•°æ³•"></a><strong>å¼•ç”¨è®¡æ•°æ³•</strong></h3><p>ç»™å¯¹è±¡æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œå½“å¯¹è±¡å¢åŠ ä¸€ä¸ªå¼•ç”¨æ—¶è®¡æ•°å™¨åŠ  1ï¼Œå¼•ç”¨å¤±æ•ˆæ—¶è®¡æ•°å™¨å‡ 1ã€‚å¼•ç”¨è®¡æ•°ä¸º 0 çš„å¯¹è±¡å¯è¢«å›æ”¶ã€‚<br>åœ¨ä¸¤ä¸ªå¯¹è±¡å‡ºç°<strong>å¾ªç¯å¼•ç”¨</strong>çš„æƒ…å†µä¸‹ï¼Œæ­¤æ—¶å¼•ç”¨è®¡æ•°å™¨æ°¸è¿œä¸ä¸º 0ï¼Œå¯¼è‡´æ— æ³•å¯¹å®ƒä»¬è¿›è¡Œå›æ”¶ã€‚æ­£æ˜¯å› ä¸ºå¾ªç¯å¼•ç”¨çš„å­˜åœ¨ï¼Œå› æ­¤ Java è™šæ‹Ÿæœºä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•ã€‚</p><h3 id="å¯è¾¾æ€§åˆ†æç®—æ³•"><a href="#å¯è¾¾æ€§åˆ†æç®—æ³•" class="headerlink" title="å¯è¾¾æ€§åˆ†æç®—æ³•"></a>å¯è¾¾æ€§åˆ†æç®—æ³•</h3><p>ä»¥ GC Roots ä¸ºèµ·å§‹ç‚¹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ° GC Roots æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼Œè¯æ˜æ­¤å¯¹è±¡æ˜¯ä¸å¯çš„ã€‚</p><p><strong>GC Roots</strong>æ ¹èŠ‚ç‚¹ï¼šçº¿ç¨‹æ ˆçš„æœ¬åœ°å˜é‡ã€é™æ€å˜é‡ã€æœ¬åœ°æ–¹æ³•æ ˆçš„å˜é‡ç­‰ç­‰ </p><h1 id="å¸¸è§å¼•ç”¨ç±»å‹"><a href="#å¸¸è§å¼•ç”¨ç±»å‹" class="headerlink" title="å¸¸è§å¼•ç”¨ç±»å‹"></a><strong>å¸¸è§å¼•ç”¨ç±»å‹</strong></h1><p>javaçš„å¼•ç”¨ç±»å‹ä¸€èˆ¬åˆ†ä¸ºå››ç§ï¼š<strong>å¼ºå¼•ç”¨</strong>ã€<strong>è½¯å¼•ç”¨</strong>ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨ </p><ul><li><strong>å¼ºå¼•ç”¨</strong>ï¼šæ™®é€šçš„å˜é‡å¼•ç”¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> User user = <span class="hljs-keyword">new</span> User(); <br></code></pre></td></tr></table></figure><ul><li><strong>è½¯å¼•ç”¨</strong>ï¼šå°†å¯¹è±¡ç”¨SoftReferenceè½¯å¼•ç”¨ç±»å‹çš„å¯¹è±¡åŒ…è£¹ï¼Œæ­£å¸¸æƒ…å†µä¸ä¼šè¢«å›æ”¶ï¼Œä½†æ˜¯GCåšå®Œåå‘ç°é‡Šæ”¾ä¸å‡ºç©ºé—´å­˜æ”¾æ–°çš„å¯¹è±¡ï¼Œåˆ™ä¼šæŠŠè¿™äº›è½¯å¼•ç”¨çš„å¯¹è±¡å›æ”¶æ‰ã€‚<strong>è½¯å¼•ç”¨å¯ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜ã€‚</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SoftReference&lt;User&gt; user = <span class="hljs-keyword">new</span> SoftReference&lt;User&gt;(<span class="hljs-keyword">new</span> User()); <br></code></pre></td></tr></table></figure><ul><li>è½¯å¼•ç”¨åœ¨å®é™…ä¸­æœ‰é‡è¦çš„åº”ç”¨ï¼Œä¾‹å¦‚æµè§ˆå™¨çš„åé€€æŒ‰é’®ã€‚æŒ‰åé€€æ—¶ï¼Œè¿™ä¸ªåé€€æ—¶æ˜¾ç¤ºçš„ç½‘é¡µå†…å®¹å°±å¯ä»¥ä½¿ç”¨è½¯å¼•ç”¨å­˜å‚¨ã€‚</li></ul><p>â€‹ï¼ˆ1ï¼‰å¦‚æœä¸€ä¸ªç½‘é¡µåœ¨æµè§ˆç»“æŸæ—¶å°±è¿›è¡Œå†…å®¹çš„å›æ”¶ï¼Œåˆ™æŒ‰åé€€æŸ¥çœ‹å‰é¢æµè§ˆè¿‡çš„é¡µé¢æ—¶ï¼Œéœ€è¦é‡æ–°æ„å»º </p><p>â€‹ï¼ˆ2ï¼‰å¦‚æœå°†æµè§ˆè¿‡çš„ç½‘é¡µå­˜å‚¨åˆ°å†…å­˜ä¸­ä¼šé€ æˆå†…å­˜çš„å¤§é‡æµªè´¹ï¼Œç”šè‡³ä¼šé€ æˆå†…å­˜æº¢å‡º </p><ul><li><p><strong>å¼±å¼•ç”¨</strong>ï¼šå°†å¯¹è±¡ç”¨WeakReferenceè½¯å¼•ç”¨ç±»å‹çš„å¯¹è±¡åŒ…è£¹ï¼Œå¼±å¼•ç”¨è·Ÿæ²¡å¼•ç”¨å·®ä¸å¤šï¼Œ<strong>GCä¼šç›´æ¥å›æ”¶æ‰</strong>ï¼Œå¾ˆå°‘ç”¨ </p>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> WeakReference&lt;User&gt; user = <span class="hljs-keyword">new</span> WeakReference&lt;User&gt;(<span class="hljs-keyword">new</span> User()); <br></code></pre></td></tr></table></figure></li><li><p><strong>è™šå¼•ç”¨ï¼š</strong>è™šå¼•ç”¨ä¹Ÿç§°ä¸ºå¹½çµå¼•ç”¨æˆ–è€…å¹»å½±å¼•ç”¨ï¼Œå®ƒæ˜¯æœ€å¼±çš„ä¸€ç§å¼•ç”¨å…³ç³»ï¼Œå‡ ä¹ä¸ç”¨</p></li></ul><h1 id="finalize-æ–¹æ³•"><a href="#finalize-æ–¹æ³•" class="headerlink" title="finalize()æ–¹æ³•"></a><strong>finalize()æ–¹æ³•</strong></h1><p><strong>ä»Java9å¼€å§‹ï¼Œfinalizeæ–¹æ³•å·²è¢«æ ‡æ³¨ä¸º@Deprecatedï¼Œä¹Ÿå°±æ˜¯è¿‡æœŸäº†</strong></p><p>å³ä½¿åœ¨å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­ä¸å¯è¾¾çš„å¯¹è±¡ï¼Œä¹Ÿå¹¶éæ˜¯â€œéæ­»ä¸å¯â€çš„ï¼Œè¿™æ—¶å€™å®ƒä»¬æš‚æ—¶å¤„äºâ€œç¼“åˆ‘â€é˜¶æ®µï¼Œè¦çœŸæ­£å®£å‘Šä¸€ä¸ªå¯¹è±¡æ­»äº¡ï¼Œè‡³å°‘è¦ç»å†å†æ¬¡æ ‡è®°è¿‡ç¨‹ã€‚ </p><p><strong>æ ‡è®°çš„å‰ææ˜¯å¯¹è±¡åœ¨è¿›è¡Œå¯è¾¾æ€§åˆ†æåå‘ç°æ²¡æœ‰ä¸GC Rootsç›¸è¿æ¥çš„å¼•ç”¨é“¾ã€‚</strong> </p><p><strong>1. ç¬¬ä¸€æ¬¡æ ‡è®°å¹¶è¿›è¡Œä¸€æ¬¡ç­›é€‰ã€‚</strong> </p><p>ç­›é€‰çš„æ¡ä»¶æ˜¯æ­¤å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ã€‚ </p><p>å½“å¯¹è±¡æ²¡æœ‰è¦†ç›–finalizeæ–¹æ³•ï¼Œå¯¹è±¡å°†ç›´æ¥è¢«å›æ”¶ã€‚ </p><p><strong>2. ç¬¬äºŒæ¬¡æ ‡è®°</strong> </p><p>å¦‚æœè¿™ä¸ªå¯¹è±¡è¦†ç›–äº†finalizeæ–¹æ³•ï¼Œfinalizeæ–¹æ³•æ˜¯å¯¹è±¡è„±é€ƒæ­»äº¡å‘½è¿çš„æœ€åä¸€æ¬¡æœºä¼šï¼Œå¦‚æœå¯¹è±¡è¦åœ¨finalize()ä¸­æˆåŠŸæ‹¯æ•‘è‡ªå·±ï¼Œåªè¦é‡æ–°ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•çš„ä¸€ä¸ªå¯¹è±¡å»ºç«‹å…³è”å³å¯ï¼Œè­¬å¦‚æŠŠè‡ªå·±èµ‹å€¼ç»™æŸä¸ªç±»å˜é‡æˆ–å¯¹è±¡çš„æˆå‘˜å˜é‡ï¼Œé‚£åœ¨ç¬¬äºŒæ¬¡æ ‡è®°æ—¶å®ƒå°†ç§»é™¤å‡ºâ€œå³å°†å›æ”¶â€çš„é›†åˆã€‚å¦‚æœå¯¹è±¡è¿™æ—¶å€™è¿˜æ²¡é€ƒè„±ï¼Œé‚£åŸºæœ¬ä¸Šå®ƒå°±çœŸçš„è¢«å›æ”¶äº†ã€‚ </p><p>æ³¨æ„ï¼šä¸€ä¸ªå¯¹è±¡çš„finalize()æ–¹æ³•åªä¼šè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´é€šè¿‡è°ƒç”¨finalizeæ–¹æ³•è‡ªæˆ‘æ•‘å‘½çš„æœºä¼šå°±ä¸€æ¬¡ã€‚ </p><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> id;<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span> </span>&#123;<br>    <span class="hljs-keyword">this</span>.id=id;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">finalize</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;id&quot;</span>+id);<br>    <span class="hljs-keyword">super</span>.finalize();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OOMTest</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    List&lt;Object&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>      list.add(<span class="hljs-keyword">new</span> User(i++));<br>      <span class="hljs-keyword">new</span> User(j--);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228234402806.png" alt="image-20230228234402806"></p><p>å¯ä»¥çœ‹å‡ºï¼Œidä¸ºè´Ÿæ•°çš„userå®ä¾‹ï¼Œä¹Ÿå°±æ˜¯éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œæ˜¯ä¼šè°ƒç”¨finalize()æ–¹æ³•çš„ï¼</p><h1 id="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»"><a href="#å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»" class="headerlink" title="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»"></a><strong>å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»</strong></h1><p>æ–¹æ³•åŒºä¸»è¦å›æ”¶çš„æ˜¯æ— ç”¨çš„ç±»ï¼Œé‚£ä¹ˆå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»çš„å‘¢ï¼Ÿ ç±»éœ€è¦åŒæ—¶æ»¡è¶³ä¸‹é¢3ä¸ªæ¡ä»¶æ‰èƒ½ç®—æ˜¯ <strong>â€œæ— ç”¨çš„ç±»â€</strong> ï¼š </p><ul><li><p>è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯ Java å †ä¸­ä¸å­˜åœ¨è¯¥ç±»çš„ä»»ä½•å®ä¾‹ã€‚ </p></li><li><p>åŠ è½½è¯¥ç±»çš„ ClassLoader å·²ç»è¢«å›æ”¶ã€‚ è¿™ç‚¹å°±ä½¿å¾—å¤§éƒ¨åˆ†çš„ç±»éƒ½æ²¡åŠæ³•å›æ”¶ï¼Œå› ä¸ºç±»åŠ è½½å™¨å¾ˆéš¾è¢«å›æ”¶ï¼Œè‡ªå®šä¹‰ç±»åŠ è½½å™¨ä¼šæœ‰å¯èƒ½ã€‚</p></li><li><p>è¯¥ç±»å¯¹åº”çš„ java.lang.Class å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•ã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½è°ƒä¼˜</tag>
      
      <tag>åƒåœ¾å›æ”¶</tag>
      
      <tag>å¸¸è§å¼•ç”¨ç±»å‹</tag>
      
      <tag>å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»</tag>
      
      <tag>finalize()æ–¹æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javaå‘½ä»¤--jinfo&amp;jstat</title>
    <link href="/java%E5%91%BD%E4%BB%A4-jinfo&amp;jstat%E5%B7%A5%E5%85%B7/"/>
    <url>/java%E5%91%BD%E4%BB%A4-jinfo&amp;jstat%E5%B7%A5%E5%85%B7/</url>
    
    <content type="html"><![CDATA[<h1 id="Jstat"><a href="#Jstat" class="headerlink" title="Jstat"></a><strong>Jstat</strong></h1><p>jstatå‘½ä»¤å¯ä»¥æŸ¥çœ‹å †å†…å­˜å„éƒ¨åˆ†çš„ä½¿ç”¨é‡ï¼Œä»¥åŠåŠ è½½ç±»çš„æ•°é‡ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230728148.png" alt="image-20230228230728148"></p><h2 id="åƒåœ¾å›æ”¶ç»Ÿè®¡"><a href="#åƒåœ¾å›æ”¶ç»Ÿè®¡" class="headerlink" title="åƒåœ¾å›æ”¶ç»Ÿè®¡"></a>åƒåœ¾å›æ”¶ç»Ÿè®¡</h2><p><strong>jstat -gc pid æœ€å¸¸ç”¨</strong>ï¼Œå¯ä»¥è¯„ä¼°ç¨‹åºå†…å­˜ä½¿ç”¨åŠGCå‹åŠ›æ•´ä½“æƒ…å†µ </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230735468.png" alt="image-20230228230735468"></p><ul><li><p>S0Cï¼šç¬¬ä¸€ä¸ªå¹¸å­˜åŒºçš„å¤§å°ï¼Œå•ä½KB</p></li><li><p>S1Cï¼šç¬¬äºŒä¸ªå¹¸å­˜åŒºçš„å¤§å°</p></li><li><p>S0Uï¼šç¬¬ä¸€ä¸ªå¹¸å­˜åŒºçš„ä½¿ç”¨å¤§å°</p></li><li><p>S1Uï¼šç¬¬äºŒä¸ªå¹¸å­˜åŒºçš„ä½¿ç”¨å¤§å°</p></li><li><p>ECï¼šä¼Šç”¸å›­åŒºçš„å¤§å°</p></li><li><p>EUï¼šä¼Šç”¸å›­åŒºçš„ä½¿ç”¨å¤§å°</p></li><li><p>OCï¼šè€å¹´ä»£å¤§å°</p></li><li><p>OUï¼šè€å¹´ä»£ä½¿ç”¨å¤§å°</p></li><li><p>MCï¼šæ–¹æ³•åŒºå¤§å°(å…ƒç©ºé—´)</p></li><li><p>MUï¼šæ–¹æ³•åŒºä½¿ç”¨å¤§å°</p></li><li><p>CCSC:å‹ç¼©ç±»ç©ºé—´å¤§å°</p></li><li><p>CCSU:å‹ç¼©ç±»ç©ºé—´ä½¿ç”¨å¤§å°</p></li><li><p>YGCï¼šå¹´è½»ä»£åƒåœ¾å›æ”¶æ¬¡æ•°ï¼ŒæŒ‡çš„æ˜¯ç¨‹åºä»è¿è¡Œèµ·æ¥åˆ°ç°åœ¨çš„æ¬¡æ•°</p></li><li><p>YGCTï¼šå¹´è½»ä»£åƒåœ¾å›æ”¶æ¶ˆè€—æ—¶é—´ï¼Œå•ä½s</p></li><li><p>FGCï¼šè€å¹´ä»£åƒåœ¾å›æ”¶æ¬¡æ•° </p></li><li><p>FGCTï¼šè€å¹´ä»£åƒåœ¾å›æ”¶æ¶ˆè€—æ—¶é—´ï¼Œå•ä½s</p></li><li><p>GCTï¼šåƒåœ¾å›æ”¶æ¶ˆè€—æ€»æ—¶é—´ï¼Œå•ä½s</p></li></ul><p> <strong>jstat -gc pid 1000 10 (æ¯éš”1ç§’æ‰§è¡Œ1æ¬¡å‘½ä»¤ï¼Œå…±æ‰§è¡Œ10æ¬¡)</strong></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230742585.png" alt="image-20230228230742585"></p><h2 id="å †å†…å­˜ç»Ÿè®¡"><a href="#å †å†…å­˜ç»Ÿè®¡" class="headerlink" title="å †å†…å­˜ç»Ÿè®¡"></a>å †å†…å­˜ç»Ÿè®¡</h2><p>å‘½ä»¤ï¼š<code>jstat -gccapacity 3548</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230751160.png"></p><ul><li>NGCMNï¼šæ–°ç”Ÿä»£æœ€å°å®¹é‡</li><li>NGCMXï¼šæ–°ç”Ÿä»£æœ€å¤§å®¹é‡</li><li>NGCï¼šå½“å‰æ–°ç”Ÿä»£å®¹é‡</li><li>S0Cï¼šç¬¬ä¸€ä¸ªå¹¸å­˜åŒºå¤§å°</li><li>S1Cï¼šç¬¬äºŒä¸ªå¹¸å­˜åŒºçš„å¤§å°</li><li>ECï¼šä¼Šç”¸å›­åŒºçš„å¤§å°</li><li>OGCMNï¼šè€å¹´ä»£æœ€å°å®¹é‡</li><li>OGCMXï¼šè€å¹´ä»£æœ€å¤§å®¹é‡</li><li>OGCï¼šå½“å‰è€å¹´ä»£å¤§å°</li><li>OC:å½“å‰è€å¹´ä»£å¤§å°</li><li>MCMN:æœ€å°å…ƒæ•°æ®å®¹é‡</li><li>MCMXï¼šæœ€å¤§å…ƒæ•°æ®å®¹é‡</li><li>MCï¼šå½“å‰å…ƒæ•°æ®ç©ºé—´å¤§å°</li><li>CCSMNï¼šæœ€å°å‹ç¼©ç±»ç©ºé—´å¤§å°</li><li>CCSMXï¼šæœ€å¤§å‹ç¼©ç±»ç©ºé—´å¤§å°</li><li>CCSCï¼šå½“å‰å‹ç¼©ç±»ç©ºé—´å¤§å°</li><li>YGCï¼šå¹´è½»ä»£gcæ¬¡æ•°</li><li>FGCï¼šè€å¹´ä»£GCæ¬¡æ•°</li></ul><h2 id="æ–°ç”Ÿä»£åƒåœ¾å›æ”¶ç»Ÿè®¡"><a href="#æ–°ç”Ÿä»£åƒåœ¾å›æ”¶ç»Ÿè®¡" class="headerlink" title="æ–°ç”Ÿä»£åƒåœ¾å›æ”¶ç»Ÿè®¡"></a>æ–°ç”Ÿä»£åƒåœ¾å›æ”¶ç»Ÿè®¡</h2><p> å‘½ä»¤ï¼š<code>jstat -gcnew 3548</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230803600.png" alt="image-20230228230803600"></p><ul><li>S0Cï¼šç¬¬ä¸€ä¸ªå¹¸å­˜åŒºçš„å¤§å°</li><li>S1Cï¼šç¬¬äºŒä¸ªå¹¸å­˜åŒºçš„å¤§å°</li><li>S0Uï¼šç¬¬ä¸€ä¸ªå¹¸å­˜åŒºçš„ä½¿ç”¨å¤§å°</li><li>S1Uï¼šç¬¬äºŒä¸ªå¹¸å­˜åŒºçš„ä½¿ç”¨å¤§å°</li><li>TT:å¯¹è±¡åœ¨æ–°ç”Ÿä»£å­˜æ´»çš„æ¬¡æ•°</li><li>MTT:å¯¹è±¡åœ¨æ–°ç”Ÿä»£å­˜æ´»çš„æœ€å¤§æ¬¡æ•°</li><li>DSS:æœŸæœ›çš„å¹¸å­˜åŒºå¤§å°</li><li>ECï¼šä¼Šç”¸å›­åŒºçš„å¤§å°</li><li>EUï¼šä¼Šç”¸å›­åŒºçš„ä½¿ç”¨å¤§å°</li><li>YGCï¼šå¹´è½»ä»£åƒåœ¾å›æ”¶æ¬¡æ•°</li><li>YGCTï¼šå¹´è½»ä»£åƒåœ¾å›æ”¶æ¶ˆè€—æ—¶é—´</li></ul><h2 id="æ–°ç”Ÿä»£å†…å­˜ç»Ÿè®¡"><a href="#æ–°ç”Ÿä»£å†…å­˜ç»Ÿè®¡" class="headerlink" title="æ–°ç”Ÿä»£å†…å­˜ç»Ÿè®¡"></a>æ–°ç”Ÿä»£å†…å­˜ç»Ÿè®¡</h2><p><code>jstat -gcnewcapacity 3548</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230814113.png"></p><ul><li>NGCMNï¼šæ–°ç”Ÿä»£æœ€å°å®¹é‡</li><li>NGCMXï¼šæ–°ç”Ÿä»£æœ€å¤§å®¹é‡</li><li>NGCï¼šå½“å‰æ–°ç”Ÿä»£å®¹é‡</li><li>S0CMXï¼šæœ€å¤§å¹¸å­˜1åŒºå¤§å°</li><li>S0Cï¼šå½“å‰å¹¸å­˜1åŒºå¤§å°</li><li>S1CMXï¼šæœ€å¤§å¹¸å­˜2åŒºå¤§å°</li><li>S1Cï¼šå½“å‰å¹¸å­˜2åŒºå¤§å°</li><li>ECMXï¼šæœ€å¤§ä¼Šç”¸å›­åŒºå¤§å°</li><li>ECï¼šå½“å‰ä¼Šç”¸å›­åŒºå¤§å°</li><li>YGCï¼šå¹´è½»ä»£åƒåœ¾å›æ”¶æ¬¡æ•°</li><li>FGCï¼šè€å¹´ä»£å›æ”¶æ¬¡æ•°</li></ul><h2 id="JVMè¿è¡Œæƒ…å†µé¢„ä¼°"><a href="#JVMè¿è¡Œæƒ…å†µé¢„ä¼°" class="headerlink" title="JVMè¿è¡Œæƒ…å†µé¢„ä¼°"></a><strong>JVMè¿è¡Œæƒ…å†µé¢„ä¼°</strong></h2><p>ç”¨ jstat gc -pid å‘½ä»¤å¯ä»¥è®¡ç®—å‡ºå¦‚ä¸‹ä¸€äº›å…³é”®æ•°æ®ï¼Œæœ‰äº†è¿™äº›æ•°æ®å°±å¯ä»¥é‡‡ç”¨ä¹‹å‰ä»‹ç»è¿‡çš„ä¼˜åŒ–æ€è·¯ï¼Œå…ˆç»™è‡ªå·±çš„ç³»ç»Ÿè®¾ç½®ä¸€äº›åˆå§‹æ€§çš„JVMå‚æ•°ï¼Œæ¯”å¦‚å †å†…å­˜å¤§å°ï¼Œå¹´è½»ä»£å¤§å°ï¼ŒEdenå’ŒSurvivorçš„æ¯”ä¾‹ï¼Œè€å¹´ä»£çš„å¤§å°ï¼Œå¤§å¯¹è±¡çš„é˜ˆå€¼ï¼Œå¤§é¾„å¯¹è±¡è¿›å…¥è€å¹´ä»£çš„é˜ˆå€¼ç­‰ã€‚</p><p><strong>å¹´è½»ä»£å¯¹è±¡å¢é•¿çš„é€Ÿç‡</strong></p><p>å¯ä»¥æ‰§è¡Œå‘½ä»¤ jstat -gc pid 1000 10 (æ¯éš”1ç§’æ‰§è¡Œ1æ¬¡å‘½ä»¤ï¼Œå…±æ‰§è¡Œ10æ¬¡)ï¼Œé€šè¿‡è§‚å¯ŸEU(edenåŒºçš„ä½¿ç”¨)æ¥ä¼°ç®—æ¯ç§’edenå¤§æ¦‚æ–°å¢å¤šå°‘å¯¹è±¡ï¼Œå¦‚æœç³»ç»Ÿè´Ÿè½½ä¸é«˜ï¼Œå¯ä»¥æŠŠé¢‘ç‡1ç§’æ¢æˆ1åˆ†é’Ÿï¼Œç”šè‡³10åˆ†é’Ÿæ¥è§‚å¯Ÿæ•´ä½“æƒ…å†µã€‚æ³¨æ„ï¼Œä¸€èˆ¬ç³»ç»Ÿå¯èƒ½æœ‰é«˜å³°æœŸå’Œæ—¥å¸¸æœŸï¼Œæ‰€ä»¥éœ€è¦åœ¨ä¸åŒçš„æ—¶é—´åˆ†åˆ«ä¼°ç®—ä¸åŒæƒ…å†µä¸‹å¯¹è±¡å¢é•¿é€Ÿç‡ã€‚</p><p><strong>Young GCçš„è§¦å‘é¢‘ç‡å’Œæ¯æ¬¡è€—æ—¶</strong></p><p>çŸ¥é“å¹´è½»ä»£å¯¹è±¡å¢é•¿é€Ÿç‡æˆ‘ä»¬å°±èƒ½æ¨æ ¹æ®edenåŒºçš„å¤§å°æ¨ç®—å‡ºYoung GCå¤§æ¦‚å¤šä¹…è§¦å‘ä¸€æ¬¡ï¼ŒYoung GCçš„å¹³å‡è€—æ—¶å¯ä»¥é€šè¿‡ YGCT&#x2F;YGC å…¬å¼ç®—å‡ºï¼Œæ ¹æ®ç»“æœæˆ‘ä»¬å¤§æ¦‚å°±èƒ½çŸ¥é“<strong>ç³»ç»Ÿå¤§æ¦‚å¤šä¹…ä¼šå› ä¸ºYoung GCçš„æ‰§è¡Œè€Œå¡é¡¿å¤šä¹…ã€‚</strong></p><p><strong>æ¯æ¬¡Young GCåæœ‰å¤šå°‘å¯¹è±¡å­˜æ´»å’Œè¿›å…¥è€å¹´ä»£</strong></p><p>è¿™ä¸ªå› ä¸ºä¹‹å‰å·²ç»å¤§æ¦‚çŸ¥é“Young GCçš„é¢‘ç‡ï¼Œå‡è®¾æ˜¯æ¯5åˆ†é’Ÿä¸€æ¬¡ï¼Œé‚£ä¹ˆå¯ä»¥æ‰§è¡Œå‘½ä»¤ jstat -gc pid 300000 10 ï¼Œè§‚å¯Ÿæ¯æ¬¡ç»“æœedenï¼Œsurvivorå’Œè€å¹´ä»£ä½¿ç”¨çš„å˜åŒ–æƒ…å†µï¼Œåœ¨æ¯æ¬¡gcåedenåŒºä½¿ç”¨ä¸€èˆ¬ä¼šå¤§å¹…å‡å°‘ï¼Œsurvivorå’Œè€å¹´ä»£éƒ½æœ‰å¯èƒ½å¢é•¿ï¼Œè¿™äº›å¢é•¿çš„å¯¹è±¡å°±æ˜¯æ¯æ¬¡Young GCåå­˜æ´»çš„å¯¹è±¡ï¼ŒåŒæ—¶è¿˜å¯ä»¥çœ‹å‡ºæ¯æ¬¡Young GCåè¿›å»è€å¹´ä»£å¤§æ¦‚å¤šå°‘å¯¹è±¡ï¼Œä»è€Œå¯ä»¥æ¨ç®—å‡º<strong>è€å¹´ä»£å¯¹è±¡å¢é•¿é€Ÿç‡ã€‚</strong></p><p><strong>Full GCçš„è§¦å‘é¢‘ç‡å’Œæ¯æ¬¡è€—æ—¶</strong></p><p>çŸ¥é“äº†è€å¹´ä»£å¯¹è±¡çš„å¢é•¿é€Ÿç‡å°±å¯ä»¥æ¨ç®—å‡ºFull GCçš„è§¦å‘é¢‘ç‡äº†ï¼ŒFull GCçš„æ¯æ¬¡è€—æ—¶å¯ä»¥ç”¨å…¬å¼ FGCT&#x2F;FGC è®¡ç®—å¾—å‡ºã€‚</p><p><strong>ä¼˜åŒ–æ€è·¯</strong>å…¶å®ç®€å•æ¥è¯´å°±æ˜¯å°½é‡è®©æ¯æ¬¡Young GCåçš„å­˜æ´»å¯¹è±¡å°äºSurvivoråŒºåŸŸçš„50%ï¼Œéƒ½ç•™å­˜åœ¨å¹´è½»ä»£é‡Œã€‚å°½é‡åˆ«è®©å¯¹è±¡è¿›å…¥è€å¹´ä»£ã€‚å°½é‡å‡å°‘Full GCçš„é¢‘ç‡ï¼Œé¿å…é¢‘ç¹Full GCå¯¹JVMæ€§èƒ½çš„å½±å“ã€‚</p><h1 id="Jinfo"><a href="#Jinfo" class="headerlink" title="Jinfo"></a><strong>Jinfo</strong></h1><p>æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„Javaåº”ç”¨ç¨‹åºçš„æ‰©å±•å‚æ•° ä»¥åŠjvmçš„å‚æ•° </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230825681.png" alt="image-20230228230825681"></p><h2 id="flags"><a href="#flags" class="headerlink" title="-flags"></a>-flags</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230833623.png" alt="image-20230228230833623"></p>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javaå‘½ä»¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mysqläº‹åŠ¡éš”ç¦»çº§åˆ«</title>
    <link href="/mysql%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/"/>
    <url>/mysql%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/</url>
    
    <content type="html"><![CDATA[<h1 id="mysql-äº‹åŠ¡"><a href="#mysql-äº‹åŠ¡" class="headerlink" title="mysql äº‹åŠ¡"></a>mysql äº‹åŠ¡</h1><h2 id="1-äº‹åŠ¡å®šä¹‰"><a href="#1-äº‹åŠ¡å®šä¹‰" class="headerlink" title="1.äº‹åŠ¡å®šä¹‰"></a>1.äº‹åŠ¡å®šä¹‰</h2><p>äº‹åŠ¡æ˜¯ä¸€ä¸ªæ“ä½œé›†åˆï¼Œè¿™äº›æ“ä½œè¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œï¼Œä»–æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚</p><h2 id="2-äº‹åŠ¡çš„å››å¤§ç‰¹æ€§"><a href="#2-äº‹åŠ¡çš„å››å¤§ç‰¹æ€§" class="headerlink" title="2.äº‹åŠ¡çš„å››å¤§ç‰¹æ€§"></a>2.äº‹åŠ¡çš„å››å¤§ç‰¹æ€§</h2><ul><li>åŸå­æ€§ï¼šäº‹åŠ¡æ˜¯ä¸€ä¸ªåŸå­æ“ä½œå•å…ƒï¼Œå®ƒå¯¹æ•°æ®çš„ä¿®æ”¹ï¼Œè¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚</li><li>ä¸€è‡´æ€§ï¼šä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå‰å’Œæ‰§è¡Œåï¼Œæ•°æ®å¿…é¡»ä¿æŒä¸€è‡´ï¼Œå¦‚ï¼šè½¬è´¦å‰ç”¨æˆ·ABçš„é’±åŠ åœ¨ä¸€èµ·æ—¶500ï¼Œè½¬è´¦åä¹Ÿåº”è¯¥æ˜¯500</li><li>éš”ç¦»å‹ï¼šäº‹åŠ¡å¤–çš„å®ä½“ä¸å¯ä»¥çŸ¥é“äº‹åŠ¡è¿‡ç¨‹ä¸­çš„ä¸­é—´çŠ¶æ€</li><li>æŒä¹…æ€§ï¼šå¯¹æ•°æ®åº“çš„æ“ä½œæ˜¯æ°¸ä¹…æ€§çš„ï¼Œå³ä½¿ç³»ç»Ÿæ•…éšœä¹Ÿèƒ½ä¿æŒ</li></ul><h2 id="3-ä¸è€ƒè™‘äº‹åŠ¡çš„éš”ç¦»æ€§ä¼šäº§ç”Ÿå¹¶å‘é—®é¢˜"><a href="#3-ä¸è€ƒè™‘äº‹åŠ¡çš„éš”ç¦»æ€§ä¼šäº§ç”Ÿå¹¶å‘é—®é¢˜" class="headerlink" title="3.ä¸è€ƒè™‘äº‹åŠ¡çš„éš”ç¦»æ€§ä¼šäº§ç”Ÿå¹¶å‘é—®é¢˜"></a>3.ä¸è€ƒè™‘äº‹åŠ¡çš„éš”ç¦»æ€§ä¼šäº§ç”Ÿå¹¶å‘é—®é¢˜</h2><ul><li>æ›´æ–°ä¸¢å¤±ï¼šå½“ä¸¤ä¸ªæˆ–è€…å¤šä¸ªäº‹åŠ¡åŒæ—¶å¯¹ä¸€è¡Œæ•°æ®è¿›è¡Œæ›´æ–°ï¼Œä¼šå‘ç”Ÿæ•°æ®çš„è¦†ç›–ï¼Œæœ€åçš„æ›´æ–°è¦†ç›–äº†å…¶ä»–äº‹åŠ¡çš„æ›´æ–°ã€‚</li><li>è„è¯»ï¼šè¯»åˆ°äº†æ²¡æœ‰æäº¤çš„æ•°æ®ï¼Œä¸€ä¸ªäº‹åŠ¡æ­£åœ¨å†™æ“ä½œï¼Œå¦ä¸€ä¸ªäº‹åŠ¡è¿›è¡Œäº†è¯»æ“ä½œï¼Œè¯»åˆ°äº†è„æ•°æ®ã€‚å¦‚æœæ­¤æ—¶äº‹åŠ¡å›æ»šï¼Œè¯»å–åˆ°çš„æ•°æ®å°±æ˜¯æ— æ•ˆçš„ã€‚</li><li>ä¸å¯é‡å¤è¯»ï¼šè¯»åˆ°äº†å·²ç»æäº¤çš„æ•°æ®ï¼Œäº‹åŠ¡Aå¤šæ¬¡è¯»å–åŒä¸€æ•°æ®ï¼Œä½†åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œäº‹åŠ¡Bå¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹å¹¶æäº¤ï¼Œä¼šå¯¼è‡´äº‹åŠ¡Aå¤šæ¬¡è¯»å–æ•°æ®ç»“æœä¸ä¸€è‡´ã€‚</li><li>å¹»è¯»ï¼šäº‹åŠ¡Aè¯»å–åˆ°äº†äº‹åŠ¡Bæäº¤çš„æ–°å¢æ•°æ®ã€‚æŸ¥è¯¢æŸè®°å½•æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨ï¼Œå‡†å¤‡æ’å…¥æ­¤è®°å½•ï¼Œä½†æ‰§è¡Œ insert æ—¶å‘ç°æ­¤è®°å½•å·²å­˜åœ¨ï¼Œæ— æ³•æ’å…¥ï¼Œæ­¤æ—¶å°±å‘ç”Ÿäº†å¹»è¯»ã€‚</li></ul><h1 id="mysql-äº‹åŠ¡éš”ç¦»çº§åˆ«"><a href="#mysql-äº‹åŠ¡éš”ç¦»çº§åˆ«" class="headerlink" title="mysql äº‹åŠ¡éš”ç¦»çº§åˆ«"></a>mysql äº‹åŠ¡éš”ç¦»çº§åˆ«</h1><ul><li><p>è„è¯»â€ã€â€œä¸å¯é‡å¤è¯»â€å’Œâ€œå¹»è¯»â€,å…¶å®éƒ½æ˜¯æ•°æ®åº“è¯»ä¸€è‡´æ€§é—®é¢˜,å¿…é¡»ç”±æ•°æ®åº“æä¾›ä¸€å®šçš„äº‹åŠ¡éš”ç¦»æœºåˆ¶æ¥è§£å†³ã€‚</p></li><li><p>mysqléš”ç¦»çº§åˆ«è¶Šé«˜ï¼Œæ€§èƒ½è¶Šå·®ã€‚å› ä¸ºäº‹åŠ¡çš„æœ¬è´¨å°±æ˜¯ä¸²è¡ŒåŒ–ï¼Œè¿™æ˜¾ç„¶ä¸å¹¶å‘æ˜¯çŸ›ç›¾çš„ã€‚</p></li><li><p><code>RR</code> çº§åˆ«ä½œä¸º <code>mysql</code> äº‹åŠ¡é»˜è®¤éš”ç¦»çº§åˆ«ï¼Œæ˜¯äº‹åŠ¡å®‰å…¨ä¸æ€§èƒ½çš„æŠ˜ä¸­ã€‚</p></li><li><p>æŸ¥çœ‹å½“å‰äº‹åŠ¡çš„éš”ç¦»çº§åˆ« <code>select @@transaction_isolation;</code></p></li><li><p>è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«</p><ul><li>å½“å‰ä¼šè¯ï¼š <code>SET SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;</code></li><li>å…¨å±€ï¼š<code>SET SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;</code></li></ul></li></ul><table><thead><tr><th>éš”ç¦»çº§åˆ«</th><th>è„è¯»</th><th>ä¸å¯é‡å¤è¯»</th><th align="center">å¹»è¯»</th></tr></thead><tbody><tr><td>è¯»æœªæäº¤</td><td>å¯èƒ½</td><td>å¯èƒ½</td><td align="center">å¯èƒ½</td></tr><tr><td>è¯»å·²æäº¤</td><td>ä¸å¯èƒ½</td><td>å¯èƒ½</td><td align="center">å¯èƒ½</td></tr><tr><td>å¯é‡å¤è¯»</td><td>ä¸å¯èƒ½</td><td>ä¸å¯èƒ½</td><td align="center">å¯èƒ½</td></tr><tr><td>ä¸²è¡ŒåŒ–</td><td>ä¸å¯èƒ½</td><td>ä¸å¯èƒ½</td><td align="center">ä¸å¯èƒ½</td></tr></tbody></table><h2 id="1-è¯»æœªæäº¤"><a href="#1-è¯»æœªæäº¤" class="headerlink" title="1.è¯»æœªæäº¤"></a>1.è¯»æœªæäº¤</h2><ul><li><p>æ‰“å¼€ä¸¤ä¸ªå®¢æˆ·ç«¯ï¼šå®¢æˆ·ç«¯Aè®¾ç½®å½“å‰äº‹åŠ¡æ¨¡å¼ä¸ºread uncommittedï¼ŒæŸ¥è¯¢employees è¡¨çš„åˆå§‹å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> @<span class="hljs-variable">@transaction</span>_isolation;<br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br><span class="hljs-operator">|</span> @<span class="hljs-variable">@transaction</span>_isolation <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br><span class="hljs-operator">|</span> READ<span class="hljs-operator">-</span>UNCOMMITTED        <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br><br>mysql<span class="hljs-operator">&gt;</span>  <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employees;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span> age <span class="hljs-operator">|</span> position <span class="hljs-operator">|</span> hire_time           <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> LiLei     <span class="hljs-operator">|</span>  <span class="hljs-number">22</span> <span class="hljs-operator">|</span> mana ger <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">5</span> <span class="hljs-operator">|</span> HanMeimei <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">6</span> <span class="hljs-operator">|</span> Lucy      <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-number">3</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure></li><li><p>å®¢æˆ·ç«¯Bå¼€å¯äº‹åŠ¡ï¼Œå¹¶æ‰§è¡Œæ›´æ–°æ“ä½œ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">begin</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br><br>mysql<span class="hljs-operator">&gt;</span>  update employees <span class="hljs-keyword">set</span> name <span class="hljs-operator">=</span> &quot;newLiLei&quot; <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">4</span>;<br>Query OK, <span class="hljs-number">1</span> <span class="hljs-type">row</span> affected (<span class="hljs-number">0.00</span> sec)<br><span class="hljs-keyword">Rows</span> matched: <span class="hljs-number">1</span>  Changed: <span class="hljs-number">1</span>  Warnings: <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure></li><li><p>è¿™æ—¶ï¼Œè™½ç„¶å®¢æˆ·ç«¯Bçš„äº‹åŠ¡è¿˜æ²¡æäº¤ï¼Œä½†æ˜¯å®¢æˆ·ç«¯Aå°±å¯ä»¥æŸ¥è¯¢åˆ°Bå·²ç»æ›´æ–°çš„æ•°æ®ï¼Œä¸€æ—¦å®¢æˆ·ç«¯Bçš„äº‹åŠ¡å› ä¸ºæŸç§åŸå› å›æ»šï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½å°†ä¼šè¢«æ’¤é”€ï¼Œé‚£å®¢æˆ·ç«¯AæŸ¥è¯¢åˆ°çš„æ•°æ®å…¶å®å°±æ˜¯<strong>è„æ•°æ®</strong>ï¼š </p></li><li><pre><code class="sql">mysql&gt;  select * from employees;+----+-----------+-----+----------+---------------------+| id | name      | age | position | hire_time           |+----+-----------+-----+----------+---------------------+|  4 | newLiLei  |  22 | mana ger | 2021-12-06 21:36:50 ||  5 | HanMeimei |  23 | dev      | 2021-12-06 21:36:50 ||  6 | Lucy      |  23 | dev      | 2021-12-06 21:36:50 |+----+-----------+-----+----------+---------------------+3 rows in set (0.00 sec)<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><br>## è¯»å·²æäº¤<br><br><span class="hljs-bullet">- </span>æ‰“å¼€ä¸¤ä¸ªå®¢æˆ·ç«¯ï¼šå®¢æˆ·ç«¯Aè®¾ç½®å½“å‰äº‹åŠ¡æ¨¡å¼ä¸ºread committedï¼ŒæŸ¥è¯¢employees è¡¨çš„åˆå§‹å€¼<br><br><span class="hljs-code">```sql</span><br><span class="hljs-code">mysql&gt; select @@transaction_isolation;</span><br><span class="hljs-code">+-------------------------+</span><br><span class="hljs-code">| @@transaction_isolation |</span><br><span class="hljs-code">+-------------------------+</span><br><span class="hljs-code">| READ-COMMITTED          |</span><br><span class="hljs-code">+-------------------------+</span><br><span class="hljs-code">1 row in set (0.00 sec)</span><br><span class="hljs-code"></span><br><span class="hljs-code"></span>mysql&gt; begin;<br>Query OK, 0 rows affected (0.00 sec)<br><br><span class="hljs-section">mysql&gt; select * from employees;</span><br><span class="hljs-section">+----+-----------+-----+----------+---------------------+</span><br><span class="hljs-section">| id | name      | age | position | hire_time           |</span><br><span class="hljs-section">+----+-----------+-----+----------+---------------------+</span><br>|  4 | LiLei     |  22 | mana ger | 2021-12-06 21:36:50 |<br>|  5 | HanMeimei |  23 | dev      | 2021-12-06 21:36:50 |<br><span class="hljs-section">|  6 | Lucy      |  23 | dev      | 2021-12-06 21:36:50 |</span><br><span class="hljs-section">+----+-----------+-----+----------+---------------------+</span><br>3 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure></code></pre></li><li><p>å®¢æˆ·ç«¯Bå¼€å¯äº‹åŠ¡ï¼Œå¹¶æ‰§è¡Œæ›´æ–°æ“ä½œ</p></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">begin</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br><br>mysql<span class="hljs-operator">&gt;</span>  update employees <span class="hljs-keyword">set</span> name <span class="hljs-operator">=</span> &quot;newLiLei&quot; <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">4</span>;<br>Query OK, <span class="hljs-number">1</span> <span class="hljs-type">row</span> affected (<span class="hljs-number">0.00</span> sec)<br><span class="hljs-keyword">Rows</span> matched: <span class="hljs-number">1</span>  Changed: <span class="hljs-number">1</span>  Warnings: <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><ul><li>è¿™æ—¶ï¼Œå®¢æˆ·ç«¯Bçš„äº‹åŠ¡è¿˜æ²¡æäº¤ï¼Œå®¢æˆ·ç«¯Aä¸èƒ½æŸ¥è¯¢åˆ°Bå·²ç»æ›´æ–°çš„æ•°æ®ï¼Œè§£å†³äº†è„è¯»é—®é¢˜ï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employees;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span> age <span class="hljs-operator">|</span> position <span class="hljs-operator">|</span> hire_time           <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> LiLei     <span class="hljs-operator">|</span>  <span class="hljs-number">22</span> <span class="hljs-operator">|</span> mana ger <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">5</span> <span class="hljs-operator">|</span> HanMeimei <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">6</span> <span class="hljs-operator">|</span> Lucy      <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-number">3</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><ul><li>å®¢æˆ·ç«¯Bçš„äº‹åŠ¡æäº¤</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">commit</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.01</span> sec)<br></code></pre></td></tr></table></figure><ul><li>å®¢æˆ·ç«¯Aå†æ¬¡æŸ¥è¯¢ï¼Œç»“æœ ä¸ä¸Šä¸€æ­¥ä¸ä¸€è‡´ï¼Œå³äº§ç”Ÿäº†ä¸å¯é‡å¤è¯»çš„é—®é¢˜</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employees;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span> age <span class="hljs-operator">|</span> position <span class="hljs-operator">|</span> hire_time           <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> newLiLei  <span class="hljs-operator">|</span>  <span class="hljs-number">22</span> <span class="hljs-operator">|</span> mana ger <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">5</span> <span class="hljs-operator">|</span> HanMeimei <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">6</span> <span class="hljs-operator">|</span> Lucy      <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br></code></pre></td></tr></table></figure><h2 id="å¯é‡å¤è¯»"><a href="#å¯é‡å¤è¯»" class="headerlink" title="å¯é‡å¤è¯»"></a>å¯é‡å¤è¯»</h2><ul><li>æ‰“å¼€ä¸¤ä¸ªå®¢æˆ·ç«¯ï¼šå®¢æˆ·ç«¯Aè®¾ç½®å½“å‰äº‹åŠ¡æ¨¡å¼ä¸ºREPEATABLE-READï¼ŒæŸ¥è¯¢employees è¡¨çš„åˆå§‹å€¼</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> @<span class="hljs-variable">@transaction</span>_isolation;<br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br><span class="hljs-operator">|</span> @<span class="hljs-variable">@transaction</span>_isolation <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br><span class="hljs-operator">|</span> REPEATABLE<span class="hljs-operator">-</span>READ         <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">begin</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employees;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span> age <span class="hljs-operator">|</span> position <span class="hljs-operator">|</span> hire_time           <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> LiLei     <span class="hljs-operator">|</span>  <span class="hljs-number">22</span> <span class="hljs-operator">|</span> mana ger <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">5</span> <span class="hljs-operator">|</span> HanMeimei <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">6</span> <span class="hljs-operator">|</span> Lucy      <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-number">3</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><ul><li>å®¢æˆ·ç«¯Bå¼€å¯äº‹åŠ¡ï¼Œå¹¶æ‰§è¡Œæ›´æ–°æ“ä½œ, å¹¶æäº¤ã€‚</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">begin</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br><br>mysql<span class="hljs-operator">&gt;</span>  update employees <span class="hljs-keyword">set</span> name <span class="hljs-operator">=</span> &quot;newLiLei&quot; <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">4</span>;<br>Query OK, <span class="hljs-number">1</span> <span class="hljs-type">row</span> affected (<span class="hljs-number">0.00</span> sec)<br><span class="hljs-keyword">Rows</span> matched: <span class="hljs-number">1</span>  Changed: <span class="hljs-number">1</span>  Warnings: <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><ul><li>åœ¨å®¢æˆ·ç«¯AæŸ¥è¯¢è¡¨accountçš„æ‰€æœ‰è®°å½•ï¼Œä¸ä¸Šä¸€æ¬¡æŸ¥è¯¢ç»“æœä¸€è‡´ï¼Œæ²¡å‡ºç°æœ‰å‡ºç°ä¸å¯é‡å¤è¯»çš„é—®é¢˜</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employees;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span> age <span class="hljs-operator">|</span> position <span class="hljs-operator">|</span> hire_time           <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> LiLei     <span class="hljs-operator">|</span>  <span class="hljs-number">22</span> <span class="hljs-operator">|</span> mana ger <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">5</span> <span class="hljs-operator">|</span> HanMeimei <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">6</span> <span class="hljs-operator">|</span> Lucy      <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-number">3</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)<br></code></pre></td></tr></table></figure><blockquote><p>Mysqlé»˜è®¤çº§åˆ«æ˜¯repeatable-readï¼Œæœ‰åŠæ³•è§£å†³å¹»è¯»é—®é¢˜å—ï¼Ÿ </p><p><strong>é—´éš™é”åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥è§£å†³å¹»è¯»é—®é¢˜</strong> </p><p>è¦é¿å…å¹»è¯»å¯ä»¥ç”¨é—´éš™é”åœ¨Session_1ä¸‹é¢æ‰§è¡Œupdate account set name &#x3D; â€˜zhugeâ€™ where id &gt; 10 and id &lt;&#x3D;20;ï¼Œåˆ™å…¶ä»–Sessionæ²¡æ³•åœ¨è¿™ä¸ªèŒƒå›´æ‰€åŒ…å«çš„é—´éš™é‡Œæ’å…¥æˆ–ä¿®æ”¹ä»»ä½•æ•°æ®</p></blockquote><h2 id="ä¸²è¡ŒåŒ–"><a href="#ä¸²è¡ŒåŒ–" class="headerlink" title="ä¸²è¡ŒåŒ–"></a>ä¸²è¡ŒåŒ–</h2><ul><li>æ‰“å¼€ä¸¤ä¸ªå®¢æˆ·ç«¯ï¼šå®¢æˆ·ç«¯Aè®¾ç½®å½“å‰äº‹åŠ¡æ¨¡å¼ä¸ºSERIALIZABLEï¼ŒæŸ¥è¯¢employees è¡¨çš„åˆå§‹å€¼</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> @<span class="hljs-variable">@transaction</span>_isolation;<br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br><span class="hljs-operator">|</span> @<span class="hljs-variable">@transaction</span>_isolation <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br><span class="hljs-operator">|</span> SERIALIZABLE            <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec) <br><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employees;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span> age <span class="hljs-operator">|</span> position <span class="hljs-operator">|</span> hire_time           <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> newLiLei  <span class="hljs-operator">|</span>  <span class="hljs-number">22</span> <span class="hljs-operator">|</span> mana ger <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">5</span> <span class="hljs-operator">|</span> HanMeimei <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">6</span> <span class="hljs-operator">|</span> Lucy123   <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span> dev      <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">50</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">7</span> <span class="hljs-operator">|</span> wangwu123 <span class="hljs-operator">|</span>  <span class="hljs-number">18</span> <span class="hljs-operator">|</span> super    <span class="hljs-operator">|</span> <span class="hljs-number">2021</span><span class="hljs-number">-12</span><span class="hljs-number">-06</span> <span class="hljs-number">21</span>:<span class="hljs-number">36</span>:<span class="hljs-number">53</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----+----------+---------------------+</span><br></code></pre></td></tr></table></figure><ul><li>æ‰“å¼€ä¸€ä¸ªå®¢æˆ·ç«¯Bï¼Œå¹¶è®¾ç½®å½“å‰äº‹åŠ¡æ¨¡å¼ä¸ºserializableï¼Œæ’å…¥ä¸€æ¡è®°å½•æŠ¥é”™ï¼Œè¡¨è¢«é”äº†æ’å…¥å¤±è´¥ï¼Œmysqlä¸­äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸ºserializableæ—¶ä¼šé”è¡¨ï¼Œå› æ­¤ä¸ä¼šå‡ºç°å¹»è¯»çš„æƒ…å†µï¼Œè¿™ç§éš”ç¦»çº§åˆ«å¹¶å‘æ€§æä½ï¼Œå¼€å‘ä¸­å¾ˆå°‘ä¼šç”¨åˆ°ã€‚</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">begin</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> employees <span class="hljs-keyword">values</span>(<span class="hljs-number">12</span>,&quot;lili2&quot;,<span class="hljs-number">11</span>,&quot;manager&quot;,&quot;2021-12-06 21:36:55&quot;);<br>ERROR <span class="hljs-number">1205</span> (HY000): Lock wait timeout exceeded; try restarting transaction<br></code></pre></td></tr></table></figure><h1 id="InnoDBä¸MYISAMçš„æœ€å¤§ä¸åŒæœ‰ä¸¤ç‚¹ï¼š"><a href="#InnoDBä¸MYISAMçš„æœ€å¤§ä¸åŒæœ‰ä¸¤ç‚¹ï¼š" class="headerlink" title="InnoDBä¸MYISAMçš„æœ€å¤§ä¸åŒæœ‰ä¸¤ç‚¹ï¼š"></a>InnoDBä¸MYISAMçš„æœ€å¤§ä¸åŒæœ‰ä¸¤ç‚¹ï¼š</h1><ol><li>æ”¯æŒäº‹åŠ¡</li><li>æ”¯æŒè¡Œé”</li></ol><h1 id="æ€§èƒ½ä¼˜åŒ–å»ºè®®"><a href="#æ€§èƒ½ä¼˜åŒ–å»ºè®®" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–å»ºè®®"></a>æ€§èƒ½ä¼˜åŒ–å»ºè®®</h1><ul><li><p>å°½å¯èƒ½ä½çº§åˆ«äº‹åŠ¡éš”ç¦»</p></li><li><p>å°½å¯èƒ½å‡å°‘æ£€ç´¢æ¡ä»¶èŒƒå›´ï¼Œé¿å…é—´éš™é” </p></li><li><p>å°½é‡æ§åˆ¶äº‹åŠ¡å¤§å°ï¼Œå‡å°‘é”å®šèµ„æºé‡å’Œæ—¶é—´é•¿åº¦ï¼Œæ¶‰åŠäº‹åŠ¡åŠ é”çš„sqlå°½é‡æ”¾åœ¨äº‹åŠ¡æœ€åæ‰§è¡Œ </p></li><li><p>å°½å¯èƒ½è®©æ‰€æœ‰æ•°æ®æ£€ç´¢éƒ½é€šè¿‡ç´¢å¼•æ¥å®Œæˆï¼Œé¿å…æ— ç´¢å¼•è¡Œé”å‡çº§ä¸ºè¡¨é” </p><blockquote><p>æ— ç´¢å¼•è¡Œé”ä¼šå‡çº§ä¸ºè¡¨é”ï¼šé”ä¸»è¦æ˜¯åŠ åœ¨ç´¢å¼•ä¸Šï¼Œå¦‚æœå¯¹éç´¢å¼•å­—æ®µæ›´æ–°, è¡Œé”å¯èƒ½ä¼šå˜è¡¨é”</p></blockquote></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysqläº‹åŠ¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mysqläº‹åŠ¡éš”ç¦»æ€§çš„å®ç°</title>
    <link href="/mvcc%E4%BB%8B%E7%BB%8D/"/>
    <url>/mvcc%E4%BB%8B%E7%BB%8D/</url>
    
    <content type="html"><![CDATA[<h1 id="mysqläº‹åŠ¡éš”ç¦»æ€§çš„å®ç°"><a href="#mysqläº‹åŠ¡éš”ç¦»æ€§çš„å®ç°" class="headerlink" title="mysqläº‹åŠ¡éš”ç¦»æ€§çš„å®ç°"></a>mysqläº‹åŠ¡éš”ç¦»æ€§çš„å®ç°</h1><h2 id="MVCCæœºåˆ¶ï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰"><a href="#MVCCæœºåˆ¶ï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰" class="headerlink" title="MVCCæœºåˆ¶ï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰"></a>MVCCæœºåˆ¶ï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰</h2><ul><li>Mysqlåœ¨è¯»å·²æäº¤å’Œå¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹éƒ½å®ç°äº†MVCCæœºåˆ¶ã€‚ </li><li>ä¸»è¦æ˜¯ä¿å­˜æ•°æ®åœ¨æŸä¸ªæ—¶é—´ç‚¹çš„å¿«ç…§å®ç°çš„ã€‚</li><li>mysqlåœ¨æ¯è¡Œè®°å½•åé¢ï¼Œä¿å­˜äº†ä¸¤ä¸ªéšè—åˆ—ï¼Œåˆ†åˆ«ä¸ºï¼šåˆ›å»ºäº‹åŠ¡idå’Œåˆ é™¤äº‹åŠ¡id</li><li>MVCCæœºåˆ¶çš„å®ç°å°±æ˜¯é€šè¿‡read-viewæœºåˆ¶ä¸undoç‰ˆæœ¬é“¾æ¯”å¯¹æœºåˆ¶ï¼Œä½¿å¾—ä¸åŒçš„äº‹åŠ¡ä¼šæ ¹æ®æ•°æ®ç‰ˆæœ¬é“¾å¯¹æ¯”è§„åˆ™è¯»å–åŒä¸€æ¡æ•°æ®åœ¨ç‰ˆæœ¬é“¾ä¸Šçš„ä¸åŒç‰ˆæœ¬æ•°æ®ã€‚</li></ul><ul><li><p>å½“æ‰§è¡Œselectæ“ä½œçš„æ—¶å€™ï¼Œmysqlåº•å±‚ä¼šå¸¦ä¸Šè¿‡æ»¤æ¡ä»¶ï¼š</p><ul><li><p>åˆ›å»ºäº‹åŠ¡id &lt;&#x3D; max(å½“å‰äº‹åŠ¡id, å·²æäº¤çš„æœ€å¤§äº‹åŠ¡id)ï¼Œä¿è¯è¯¥äº‹åŠ¡è¯»åˆ°çš„æ•°æ®ï¼Œè¦ä¹ˆæ˜¯å¼€å§‹å‰å°±å·²ç»å­˜åœ¨çš„ï¼Œè¦ä¹ˆæ˜¯è‡ªèº«æ’å…¥æˆ–ä¿®æ”¹åçš„ã€‚</p></li><li><p>åˆ é™¤äº‹åŠ¡id  &gt;  max (å½“å‰äº‹åŠ¡id, å·²æäº¤çš„æœ€å¤§äº‹åŠ¡id) æˆ–  åˆ é™¤äº‹åŠ¡idæœªå®šä¹‰ã€‚ä¿è¯äº‹åŠ¡è¯»åˆ°çš„è¡Œï¼Œåœ¨äº‹åŠ¡å¼€å§‹å‰æ²¡æœ‰è¢«åˆ é™¤</p></li></ul></li></ul><h2 id="undoæ—¥å¿—ç‰ˆæœ¬é“¾"><a href="#undoæ—¥å¿—ç‰ˆæœ¬é“¾" class="headerlink" title="undoæ—¥å¿—ç‰ˆæœ¬é“¾"></a><strong>undoæ—¥å¿—ç‰ˆæœ¬é“¾</strong></h2><p>undoæ—¥å¿—ç‰ˆæœ¬é“¾æ˜¯æŒ‡ä¸€è¡Œæ•°æ®è¢«å¤šä¸ªäº‹åŠ¡ä¾æ¬¡ä¿®æ”¹è¿‡åï¼Œåœ¨æ¯ä¸ªäº‹åŠ¡ä¿®æ”¹å®Œåï¼ŒMysqlä¼šä¿ç•™ä¿®æ”¹å‰çš„æ•°æ®undoå›æ»šæ—¥å¿—ï¼Œå¹¶ä¸”ç”¨ä¸¤ä¸ªéšè—å­—æ®µtrx_idå’Œroll_pointeræŠŠè¿™äº›undoæ—¥å¿—ä¸²è”èµ·æ¥å½¢æˆä¸€ä¸ªå†å²è®°å½•ç‰ˆæœ¬é“¾ã€‚</p><ul><li>roll_pointerï¼š å¯ä»¥æ ¹æ®roll_pointeræ‰¾åˆ°ä¹‹å‰çš„è€æ•°æ®ï¼Œå¦‚æœäº‹åŠ¡å¤±è´¥ï¼Œå°±å¯ä»¥æ‰¾åˆ°ä¹‹å‰çš„è€æ•°æ®</li><li>æ¯æ¬¡ä¿®æ”¹ï¼Œå°±æ˜¯å†™è¿›æ–°çš„äº‹åŠ¡id,ä»¥åŠæŠŠå›æ»šæŒ‡é’ˆæŒ‡å‘ä¸Šä¸€æ¡æ•°æ®çš„ä½ç½®</li></ul><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h385eu22j0j218m0u042n.jpg"></p><h2 id="read-viewæœºåˆ¶è¯¦è§£"><a href="#read-viewæœºåˆ¶è¯¦è§£" class="headerlink" title="read viewæœºåˆ¶è¯¦è§£"></a><strong>read viewæœºåˆ¶è¯¦è§£</strong></h2><ul><li><p>åœ¨<strong>å¯é‡å¤è¯»éš”ç¦»çº§åˆ«</strong>ï¼Œå½“äº‹åŠ¡å¼€å¯ï¼Œæ‰§è¡Œä»»ä½•æŸ¥è¯¢sqlæ—¶ä¼šç”Ÿæˆå½“å‰äº‹åŠ¡çš„<strong>ä¸€è‡´æ€§è§†å›¾read-viewï¼Œ</strong>è¯¥è§†å›¾åœ¨äº‹åŠ¡ç»“æŸ ä¹‹å‰éƒ½ä¸ä¼šå˜åŒ–(<strong>å¦‚æœæ˜¯è¯»å·²æäº¤éš”ç¦»çº§åˆ«åœ¨æ¯æ¬¡æ‰§è¡ŒæŸ¥è¯¢sqlæ—¶éƒ½ä¼šé‡æ–°ç”Ÿæˆ</strong>)ã€‚</p></li><li><p>è¿™ä¸ªè§†å›¾ç”±æ‰§è¡ŒæŸ¥è¯¢æ—¶æ‰€æœ‰æœªæäº¤äº‹åŠ¡id<strong>æ•°ç»„</strong>ï¼ˆæ•°ç»„é‡Œæœ€å°çš„idä¸ºmin_idï¼‰å’Œå·²åˆ›å»ºçš„æœ€å¤§äº‹åŠ¡idï¼ˆmax_idï¼‰ç»„æˆï¼Œäº‹åŠ¡é‡Œçš„ä»»ä½•sqlæŸ¥è¯¢ç»“æœéœ€è¦ä»å¯¹åº”ç‰ˆæœ¬é“¾é‡Œçš„æœ€æ–°æ•°æ®å¼€å§‹é€æ¡è·Ÿread-viewåšæ¯”å¯¹ä»è€Œå¾—åˆ°æœ€ç»ˆçš„å¿«ç…§ç»“æœã€‚</p></li></ul><h2 id=""><a href="#" class="headerlink" title=""></a><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h385hvu2m4j210w0c2myc.jpg" style="zoom:50%;" /></h2><p>Eg:</p><p>å‡è®¾å½“å‰æ–°å¼€å¯äº†ä¸€ä¸ªäº‹åŠ¡Aï¼Œäº‹åŠ¡idä¸º300ï¼Œåœ¨è¯¥äº‹åŠ¡ä¹‹å‰æœ‰ä¸¤ä¸ªäº‹åŠ¡Bå’ŒCï¼Œå‡idåˆ†åˆ«ä¸º100å’Œ200ã€‚</p><p>å½“äº‹åŠ¡Aæ‰§è¡Œç¬¬ä¸€ä¸ªselectçš„æ—¶å€™ï¼Œäº‹åŠ¡Bå·²ç»æäº¤äº†ï¼Œè€Œäº‹åŠ¡Cè¿˜æ²¡æœ‰æäº¤ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„read-viewä¸ºã€200ã€‘ï¼Œ300</p><p><strong>ç‰ˆæœ¬é“¾æ¯”å¯¹è§„åˆ™ï¼š</strong> </p><ol><li><p>å¦‚æœ row çš„ trx_id è½åœ¨ç»¿è‰²éƒ¨åˆ†( trx_id&lt;min_id )ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯å·²æäº¤çš„äº‹åŠ¡ç”Ÿæˆçš„ï¼Œè¿™ä¸ªæ•°æ®æ˜¯å¯è§çš„ï¼› </p></li><li><p>å¦‚æœ row çš„ trx_id è½åœ¨çº¢è‰²éƒ¨åˆ†( trx_id&gt;max_id )ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯ç”±å°†æ¥å¯åŠ¨çš„äº‹åŠ¡ç”Ÿæˆçš„ï¼Œæ˜¯ä¸å¯è§çš„(è‹¥</p></li></ol><p>row çš„ trx_id å°±æ˜¯å½“å‰è‡ªå·±çš„äº‹åŠ¡æ˜¯å¯è§çš„ï¼‰ï¼›</p><ol start="3"><li>å¦‚æœ row çš„ trx_id è½åœ¨é»„è‰²éƒ¨åˆ†(min_id &lt;&#x3D;trx_id&lt;&#x3D; max_id)ï¼Œé‚£å°±åŒ…æ‹¬ä¸¤ç§æƒ…å†µ</li></ol><p>â€‹a. è‹¥ row çš„ trx_id åœ¨è§†å›¾æ•°ç»„ä¸­ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯ç”±è¿˜æ²¡æäº¤çš„äº‹åŠ¡ç”Ÿæˆçš„ï¼Œä¸å¯è§(è‹¥ row çš„ trx_id å°±æ˜¯å½“å‰è‡ªå·±çš„äº‹åŠ¡æ˜¯å¯è§çš„)ï¼› </p><p>â€‹b. è‹¥ row çš„ trx_id ä¸åœ¨è§†å›¾æ•°ç»„ä¸­ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯å·²ç»æäº¤äº†çš„äº‹åŠ¡ç”Ÿæˆçš„ï¼Œå¯è§ã€‚</p><p><strong>åˆ é™¤çš„æƒ…å†µ</strong>ï¼š</p><p>å¯¹äºåˆ é™¤çš„æƒ…å†µå¯ä»¥è®¤ä¸ºæ˜¯updateçš„ç‰¹æ®Šæƒ…å†µï¼Œä¼šå°†ç‰ˆæœ¬é“¾ä¸Šæœ€æ–°çš„æ•°æ®å¤åˆ¶ä¸€ä»½ï¼Œç„¶åå°†trx_idä¿®æ”¹æˆåˆ é™¤æ“ä½œçš„ trx_idï¼ŒåŒæ—¶åœ¨è¯¥æ¡è®°å½•çš„å¤´ä¿¡æ¯ï¼ˆrecord headerï¼‰é‡Œçš„ï¼ˆdeleted_flagï¼‰æ ‡è®°ä½å†™ä¸Štrueï¼Œæ¥è¡¨ç¤ºå½“å‰è®°å½•å·²ç»è¢«åˆ é™¤ï¼Œåœ¨æŸ¥è¯¢æ—¶æŒ‰ç…§ä¸Šé¢çš„è§„åˆ™æŸ¥åˆ°å¯¹åº”çš„è®°å½•å¦‚æœdelete_flagæ ‡è®°ä½ä¸ºtrueï¼Œæ„å‘³ç€è®°å½•å·²è¢«åˆ é™¤ï¼Œåˆ™ä¸è¿”å›æ•°æ®ã€‚</p><p><strong>æ³¨æ„ï¼š</strong></p><p>begin&#x2F;start transaction å‘½ä»¤å¹¶ä¸æ˜¯ä¸€ä¸ªäº‹åŠ¡çš„èµ·ç‚¹ï¼Œåœ¨æ‰§è¡Œåˆ°å®ƒä»¬ä¹‹åçš„ç¬¬ä¸€ä¸ªä¿®æ”¹æ“ä½œInnoDBè¡¨çš„è¯­å¥ï¼Œ </p><p>äº‹åŠ¡æ‰çœŸæ­£å¯åŠ¨ï¼Œæ‰ä¼šå‘mysqlç”³è¯·äº‹åŠ¡idï¼Œmysqlå†…éƒ¨æ˜¯ä¸¥æ ¼æŒ‰ç…§äº‹åŠ¡çš„å¯åŠ¨é¡ºåºæ¥åˆ†é…äº‹åŠ¡idçš„ã€‚ </p><h2 id="åŠ é”"><a href="#åŠ é”" class="headerlink" title="åŠ é”"></a>åŠ é”</h2><p>ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«ä¸ºäº†ä¿è¯è¾ƒé«˜çš„éš”ç¦»æ€§æ˜¯é€šè¿‡å°†æ‰€æœ‰æ“ ä½œåŠ é”äº’æ–¥æ¥å®ç°çš„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysqläº‹åŠ¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>postgresqlç´¢å¼•åŸºç¡€</title>
    <link href="/postgresql%E5%9F%BA%E7%A1%80/"/>
    <url>/postgresql%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h1 id="PostgreSQLç´¢å¼•ç±»å‹"><a href="#PostgreSQLç´¢å¼•ç±»å‹" class="headerlink" title="PostgreSQLç´¢å¼•ç±»å‹"></a>PostgreSQLç´¢å¼•ç±»å‹</h1><ul><li>PostgreSQLæä¾›äº†å¤šç§ç´¢å¼•ç±»å‹ï¼š B-treeã€Hashã€GiSTã€SP-GiST ã€GIN å’Œ BRINã€‚</li><li>æ¯ä¸€ç§ç´¢å¼•ç±»å‹ä½¿ç”¨äº† ä¸€ç§ä¸åŒçš„ç®—æ³•æ¥é€‚åº”ä¸åŒç±»å‹çš„æŸ¥è¯¢ã€‚</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒCREATE INDEXå‘½ä»¤åˆ›å»ºé€‚åˆäºå¤§éƒ¨åˆ†æƒ…å†µçš„B-tree ç´¢å¼•ã€‚</li></ul><h1 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h1>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>flex å¸ƒå±€</title>
    <link href="/flex-%E5%B8%83%E5%B1%80/"/>
    <url>/flex-%E5%B8%83%E5%B1%80/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å¼€å¯flex-å¸ƒå±€"><a href="#1-å¼€å¯flex-å¸ƒå±€" class="headerlink" title="1 å¼€å¯flex å¸ƒå±€"></a>1 å¼€å¯flex å¸ƒå±€</h1><ul><li>å¼€å¯flexå¸ƒå±€ï¼Œåªéœ€è¦åœ¨æœ€å¤–å±‚å®¹å™¨è®¾ç½®<code> display: flex</code>å³å¯</li><li>é‡‡ç”¨ Flex å¸ƒå±€çš„å…ƒç´ ï¼Œç§°ä¸º Flex å®¹å™¨ï¼ˆflex containerï¼‰ï¼Œç®€ç§°â€å®¹å™¨â€ã€‚å®ƒçš„æ‰€æœ‰å­å…ƒç´ è‡ªåŠ¨æˆä¸ºå®¹å™¨æˆå‘˜ï¼Œç§°ä¸º Flex é¡¹ç›®ï¼ˆflex itemï¼‰ï¼Œç®€ç§°â€é¡¹ç›®â€ã€‚</li><li>å®¹å™¨é»˜è®¤å­˜åœ¨ä¸¤æ ¹è½´ï¼šæ°´å¹³çš„ä¸»è½´ï¼ˆmain axisï¼‰å’Œå‚ç›´çš„äº¤å‰è½´ï¼ˆcross axisï¼‰ã€‚<ul><li>ä¸»è½´çš„å¼€å§‹ä½ç½®ï¼ˆä¸è¾¹æ¡†çš„äº¤å‰ç‚¹ï¼‰å«åš<code>main start</code>ï¼Œç»“æŸä½ç½®å«åš<code>main end</code>ï¼›</li><li>äº¤å‰è½´çš„å¼€å§‹ä½ç½®å«åš<code>cross start</code>ï¼Œç»“æŸä½ç½®å«åš<code>cross end</code></li></ul></li><li>é¡¹ç›®é»˜è®¤æ²¿ä¸»è½´æ’åˆ—ã€‚å•ä¸ªé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´å«åš<code>main size</code>ï¼Œå æ®çš„äº¤å‰è½´ç©ºé—´å«åš<code>cross size</code>ã€‚</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529192600.png"></p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><p>å¼€å¯flexå¸ƒå±€ï¼Œé»˜è®¤æ²¿ä¸»è½´æ’åˆ—</p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529194352.png" style="zoom:33%;" /><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"></span><br><span class="css">  <span class="hljs-selector-class">.container</span> &#123;</span><br><span class="css">    <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;</span><br><span class="css">    <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;</span><br><span class="css">    <span class="hljs-attribute">background-color</span>: bisque;</span><br><span class="css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="css">  &#125;</span><br><span class="css">  <span class="hljs-selector-class">.box</span> &#123;</span><br><span class="css">    <span class="hljs-attribute">background-color</span>: pink;</span><br><span class="css">    <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;</span><br><span class="css">    <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;</span><br><span class="css">    <span class="hljs-attribute">border</span>: solid <span class="hljs-number">1px</span>;</span><br><span class="css">  &#125;</span><br><span class="css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><h1 id="2-å®¹å™¨çš„å±æ€§"><a href="#2-å®¹å™¨çš„å±æ€§" class="headerlink" title="2 å®¹å™¨çš„å±æ€§"></a>2 å®¹å™¨çš„å±æ€§</h1><p>ä»¥ä¸‹6ä¸ªå±æ€§è®¾ç½®åœ¨å®¹å™¨ä¸Šã€‚</p><h2 id="2-1-flex-direction"><a href="#2-1-flex-direction" class="headerlink" title="2.1 flex-direction"></a>2.1 flex-direction</h2><p>ä¸»è½´çš„æ–¹å‘,ï¼ˆå³é¡¹ç›®çš„æ’åˆ—æ–¹å‘ï¼‰ã€‚</p><blockquote><ul><li><code>row</code>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯ã€‚</li></ul></blockquote><blockquote><ul><li><code>row-reverse</code>ï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å³ç«¯ã€‚</li></ul></blockquote><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529194849.png" style="zoom:33%;" /><blockquote><ul><li><code>column</code>ï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿ã€‚</li></ul></blockquote><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529194940.png" style="zoom:33%;" /><blockquote><ul><li><code>column-reverse</code>ï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿ã€‚</li></ul></blockquote><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529195014.png" style="zoom:33%;" /><h2 id="2-2-flex-wrap"><a href="#2-2-flex-wrap" class="headerlink" title="2.2 flex-wrap"></a>2.2 flex-wrap</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé¡¹ç›®éƒ½æ’åœ¨ä¸€æ¡çº¿ï¼ˆåˆç§°â€è½´çº¿â€ï¼‰ä¸Šã€‚<code>flex-wrap</code>å±æ€§å®šä¹‰ï¼Œå¦‚æœä¸€æ¡è½´çº¿æ’ä¸ä¸‹ï¼Œå¦‚ä½•æ¢è¡Œã€‚</p><blockquote><ul><li><code>nowrap</code>ï¼ˆé»˜è®¤ï¼‰ï¼šä¸æ¢è¡Œã€‚</li><li><code>wrap</code>ï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸Šæ–¹ã€‚</li><li><code>wrap-reverse</code>ï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸‹æ–¹ã€‚</li></ul></blockquote><h2 id="2-3-flex-flow"><a href="#2-3-flex-flow" class="headerlink" title="2.3 flex-flow"></a>2.3 flex-flow</h2><p><code>flex-flow</code>å±æ€§æ˜¯<code>flex-direction</code>å±æ€§å’Œ<code>flex-wrap</code>å±æ€§çš„ç®€å†™å½¢å¼ï¼Œé»˜è®¤å€¼ä¸º<code>row nowrap</code>ã€‚</p><h2 id="2-4-justify-content"><a href="#2-4-justify-content" class="headerlink" title="2.4 justify-content"></a>2.4 justify-content</h2><p>å®šä¹‰äº†é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼ã€‚</p><p>å®ƒå¯èƒ½å–5ä¸ªå€¼ï¼Œå…·ä½“å¯¹é½æ–¹å¼ä¸è½´çš„æ–¹å‘æœ‰å…³ã€‚ä¸‹é¢å‡è®¾ä¸»è½´ä¸ºä»å·¦åˆ°å³ã€‚</p><blockquote><ul><li><code>flex-start</code>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå·¦å¯¹é½</li></ul></blockquote><blockquote><ul><li><code>flex-end</code>ï¼šå³å¯¹é½</li></ul></blockquote><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529195131.png" style="zoom:33%;" /><blockquote><ul><li><code>center</code>ï¼š å±…ä¸­</li></ul></blockquote><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529195153.png" style="zoom:33%;" /><blockquote><ul><li><code>space-between</code>ï¼šä¸¤ç«¯å¯¹é½ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”éƒ½ç›¸ç­‰ã€‚</li></ul></blockquote><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529195227.png" style="zoom:33%;" /><blockquote><ul><li><code>space-around</code>ï¼šæ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€</li></ul></blockquote><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529195340.png" style="zoom:33%;" /><h2 id="2-5-align-items"><a href="#2-5-align-items" class="headerlink" title="2.5 align-items"></a>2.5 align-items</h2><p>å®šä¹‰é¡¹ç›®åœ¨äº¤å‰è½´ä¸Šå¦‚ä½•å¯¹é½</p><blockquote><ul><li><code>flex-start</code>ï¼šäº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚</li></ul></blockquote><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529195559.png" style="zoom:33%;" /><blockquote><ul><li><code>flex-end</code>ï¼šäº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚</li></ul></blockquote><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529195624.png" style="zoom:33%;" /><blockquote><ul><li><code>center</code>ï¼šäº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚</li></ul></blockquote><img src="/Users/yuroupan/Library/Application Support/typora-user-images/image-20220529195658432.png" alt="image-20220529195658432" style="zoom:33%;" /><p><strong>å½“æŠŠ<code>justify-content</code>å’Œ<code>align-items</code> éƒ½è®¾ç½®ä¸º<code>center</code>, é¡¹ç›®å°†ä¼šæ°´å¹³å‚ç›´å±…ä¸­</strong></p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529200655.png" style="zoom:33%;" /><blockquote><ul><li><code>baseline</code>: é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½ã€‚</li><li><code>stretch</code>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå¦‚æœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸ºautoï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦ã€‚</li></ul></blockquote><h2 id="2-6-align-content"><a href="#2-6-align-content" class="headerlink" title="2.6 align-content"></a>2.6 align-content</h2><p>å®šä¹‰äº†å¤šæ ¹è½´çº¿çš„å¯¹é½æ–¹å¼ã€‚å¦‚æœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿ï¼Œè¯¥å±æ€§ä¸èµ·ä½œç”¨ã€‚</p><p>è¯¥å±æ€§å¯èƒ½å–6ä¸ªå€¼ã€‚</p><blockquote><ul><li><code>flex-start</code>ï¼šä¸äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚</li><li><code>flex-end</code>ï¼šä¸äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚</li><li><code>center</code>ï¼šä¸äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚</li><li><code>space-between</code>ï¼šä¸äº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒã€‚</li><li><code>space-around</code>ï¼šæ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚</li><li><code>stretch</code>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼šè½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´ã€‚</li></ul></blockquote><h1 id="3-é¡¹ç›®çš„å±æ€§"><a href="#3-é¡¹ç›®çš„å±æ€§" class="headerlink" title="3 é¡¹ç›®çš„å±æ€§"></a>3 é¡¹ç›®çš„å±æ€§</h1><h2 id="3-1-order"><a href="#3-1-order" class="headerlink" title="3.1 order"></a>3.1 order</h2><ul><li><code>order</code>å±æ€§å®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåºã€‚æ•°å€¼è¶Šå°ï¼Œæ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤ä¸º0ã€‚</li></ul><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/20220529201004.png" style="zoom:33%;" /><ul><li><p><code>flex-grow</code>å±æ€§å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º<code>0</code>ï¼Œå³å¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§ã€‚</p><blockquote><p>å¦‚æœæ‰€æœ‰é¡¹ç›®çš„<code>flex-grow</code>å±æ€§éƒ½ä¸º1ï¼Œåˆ™å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„<code>flex-grow</code>å±æ€§ä¸º2ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™å‰è€…å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å…¶ä»–é¡¹å¤šä¸€å€ã€‚</p></blockquote></li><li><p><code>flex-shrink</code>å±æ€§å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°ã€‚</p><blockquote><p>å¦‚æœæ‰€æœ‰é¡¹ç›®çš„<code>flex-shrink</code>å±æ€§éƒ½ä¸º1ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œéƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„<code>flex-shrink</code>å±æ€§ä¸º0ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™ç©ºé—´ä¸è¶³æ—¶ï¼Œå‰è€…ä¸ç¼©å°ã€‚</p></blockquote></li></ul><p>å½“æŠŠwidthæ”¹æˆäº†100ï¼Œé»˜è®¤é¡¹ç›®éƒ½ä¼šç­‰æ¯”ä¾‹ç¼©å°ï¼š</p><ul><li><p><code>align-self</code>å±æ€§å…è®¸å•ä¸ªé¡¹ç›®æœ‰ä¸å…¶ä»–é¡¹ç›®ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›–<code>align-items</code>å±æ€§ã€‚é»˜è®¤å€¼ä¸º<code>auto</code>ï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„<code>align-items</code>å±æ€§ï¼Œå¦‚æœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäº<code>stretch</code>ã€‚</p><blockquote><p>è¯¥å±æ€§å¯èƒ½å–6ä¸ªå€¼ï¼Œé™¤äº†autoï¼Œå…¶ä»–éƒ½ä¸align-itemså±æ€§å®Œå…¨ä¸€è‡´ã€‚</p></blockquote></li></ul>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>css flex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®åº“ä¸‰å¤§èŒƒå¼</title>
    <link href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F/"/>
    <url>/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="ç¬¬ä¸€èŒƒå¼-ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§"><a href="#ç¬¬ä¸€èŒƒå¼-ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§" class="headerlink" title="ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)"></a>ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§)</h2><p>æ•°æ®åº“è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ã€‚</p><ul><li>æ¯”å¦‚æŸäº›æ•°æ®åº“ç³»ç»Ÿä¸­éœ€è¦ç”¨åˆ°â€œåœ°å€â€è¿™ä¸ªå±æ€§ï¼Œæœ¬æ¥ç›´æ¥å°†â€œåœ°å€â€å±æ€§è®¾è®¡æˆä¸€ä¸ªæ•°æ®åº“è¡¨çš„å­—æ®µå°±è¡Œã€‚</li><li>ä½†æ˜¯å¦‚æœç³»ç»Ÿç»å¸¸ä¼šè®¿é—®â€œåœ°å€â€å±æ€§ä¸­çš„â€œåŸå¸‚â€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±éè¦å°†â€œåœ°å€â€è¿™ä¸ªå±æ€§é‡æ–°æ‹†åˆ†ä¸ºçœä»½ã€åŸå¸‚ã€è¯¦ç»†åœ°å€ç­‰å¤šä¸ªéƒ¨åˆ†è¿›è¡Œå­˜å‚¨ï¼Œè¿™æ ·åœ¨å¯¹åœ°å€ä¸­æŸä¸€éƒ¨åˆ†æ“ä½œçš„æ—¶å€™å°†éå¸¸æ–¹ä¾¿ã€‚</li></ul><h2 id="ç¬¬äºŒèŒƒå¼-ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³"><a href="#ç¬¬äºŒèŒƒå¼-ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³" class="headerlink" title="ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)"></a>ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³)</h2><p>ç¬¬äºŒèŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®åº“è¡¨ä¸­çš„æ¯ä¸€åˆ—éƒ½å’Œä¸»é”®ç›¸å…³ï¼Œè€Œä¸èƒ½åªä¸ä¸»é”®çš„æŸä¸€éƒ¨åˆ†ç›¸å…³ï¼ˆä¸»è¦é’ˆå¯¹è”åˆä¸»é”®è€Œè¨€ï¼‰ã€‚æ¯”å¦‚ï¼š</p><ul><li>è®¢å•ä¿¡æ¯è¡¨ï¼šè®¢å•ç¼–å·ï¼Œå•†å“ç¼–å·ï¼Œå•†å“åç§°ï¼Œå•†å“æ•°é‡ï¼Œå•†å“å•ä½ï¼Œå•†å“ä»·æ ¼ã€‚è”åˆä¸»é”®ä¸ºï¼ˆè®¢å•ç¼–å·ï¼Œå•†å“ç¼–å·ï¼‰</li><li>å­˜åœ¨é—®é¢˜ï¼š<br>åœ¨è¯¥è¡¨ä¸­ï¼Œå•†å“åç§°ã€å•ä½ã€å•†å“ä»·æ ¼ç­‰ä¿¡æ¯ä¸ä¸è¯¥è¡¨çš„ä¸»é”®ç›¸å…³ï¼Œè€Œä»…ä»…æ˜¯ä¸å•†å“ç¼–å·ç›¸å…³ã€‚å°±éœ€è¦å•ç‹¬å­˜åœ¨å¦ä¸€å¼ è¡¨é‡Œã€‚è€Œä¸åº”è¯¥åœ¨è®¢å•ä¿¡æ¯è¡¨é‡Œã€‚</li><li>ä¿®æ­£ï¼š<br>è®¢å•ï¼šè®¢å•ç¼–å·ï¼Œå•†å“ç¼–å·<br>å•†å“ï¼šå•†å“åç§°ï¼Œå•†å“æ•°é‡ï¼Œå•†å“å•ä½ï¼Œå•†å“ä»·æ ¼</li></ul><h2 id="ç¬¬ä¸‰èŒƒå¼-ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³-è€Œä¸æ˜¯é—´æ¥ç›¸å…³"><a href="#ç¬¬ä¸‰èŒƒå¼-ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³-è€Œä¸æ˜¯é—´æ¥ç›¸å…³" class="headerlink" title="ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)"></a>ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³)</h2><p>ç¬¬ä¸‰èŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®è¡¨ä¸­çš„æ¯ä¸€åˆ—æ•°æ®éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³ã€‚æ¯”å¦‚ï¼š</p><ul><li>å­¦ç”Ÿä¿¡æ¯è¡¨ï¼šå­¦å·ï¼Œå§“åï¼Œå¹´é¾„ï¼Œæ‰€åœ¨å­¦é™¢ï¼Œå­¦é™¢è”ç³»æ–¹å¼ï¼Œå­¦é™¢åœ°ç‚¹ã€‚ä¸»é”®ï¼šå­¦å·</li><li>å­˜åœ¨é—®é¢˜ï¼š<br>å­˜åœ¨ä¾èµ–ä¼ é€’ï¼šå­¦å· â†’ å­¦é™¢ â†’ (å­¦é™¢åœ°ç‚¹ï¼Œå­¦é™¢è”ç³»æ–¹å¼)</li><li>ä¿®æ­£ï¼š<br>å­¦ç”Ÿä¿¡æ¯è¡¨ï¼šå­¦å·ï¼Œå§“åï¼Œå¹´é¾„ï¼Œæ‰€åœ¨å­¦é™¢<br>å­¦é™¢ä¿¡æ¯è¡¨ï¼šå­¦é™¢ï¼Œå­¦é™¢è”ç³»æ–¹å¼ï¼Œå­¦é™¢åœ°ç‚¹<br><img src="/assets/16542362929459.jpg"></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®åº“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hooksçš„ä½¿ç”¨</title>
    <link href="/hooks%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/hooks%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h1><p>æ¡ˆä¾‹æ•ˆæœï¼š</p><ul><li>ç‚¹å‡»æŒ‰é’®ï¼Œæ–‡æœ¬titleä¿®æ”¹</li><li>ç‚¹å‡»æŒ‰é’®ï¼Œinputèšç„¦<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> React, &#123; useRef, PureComponent &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestChild</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> (<br>      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>UseRefDemo<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    )<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UseRefDemo</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> titleRef = useRef()<br>  <span class="hljs-keyword">const</span> inputRef = useRef()<br>  <span class="hljs-keyword">const</span> testChild = useRef()<br>  <span class="hljs-keyword">return</span> (<br>    <span class="xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>UseRefDemo<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>= <span class="hljs-string">&#123;titleRef&#125;</span>&gt;</span>title<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span> = <span class="hljs-string">&#123;inputRef&#125;</span> <span class="hljs-attr">type</span> = <span class="hljs-string">&quot;text&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">input</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;e</span> =&gt;</span> changeDom()&#125;&gt;æŒ‰é’®<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">TestChild</span> <span class="hljs-attr">ref</span> = <span class="hljs-string">&#123;testChild&#125;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">TestChild</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;/&gt;</span></span><br>  )<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeDom</span>(<span class="hljs-params"></span>)</span>&#123;<br>    titleRef.current.innerHTML = <span class="hljs-string">&quot;æ”¹å˜åçš„title&quot;</span><br>    inputRef.current.focus()<br>    <span class="hljs-built_in">console</span>.log(testChild)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h261x90pltj20kc0cqmxn.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gitä¿®æ”¹æŒ‡å®šçš„æäº¤</title>
    <link href="/git%E4%BF%AE%E6%94%B9%E6%8C%87%E5%AE%9A%E7%9A%84%E6%8F%90%E4%BA%A4/"/>
    <url>/git%E4%BF%AE%E6%94%B9%E6%8C%87%E5%AE%9A%E7%9A%84%E6%8F%90%E4%BA%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="1-gitä¿®æ”¹æŒ‡å®šçš„æäº¤"><a href="#1-gitä¿®æ”¹æŒ‡å®šçš„æäº¤" class="headerlink" title="1.  gitä¿®æ”¹æŒ‡å®šçš„æäº¤"></a>1.  gitä¿®æ”¹æŒ‡å®šçš„æäº¤</h1><ul><li><code>git rebase --interactive &#39;cffa46f19811496d9165cf2c32250943f94f0099^&#39;</code></li><li>ä¿®æ”¹</li><li><code>git add .</code></li><li><code>git commit --amend</code></li><li><code>git rebase --continue</code></li></ul><h1 id="2-æ›´æ–°gitignoreæ–‡ä»¶åï¼Œgitåˆ é™¤ä»“åº“ä¸­çš„ç¼“å­˜"><a href="#2-æ›´æ–°gitignoreæ–‡ä»¶åï¼Œgitåˆ é™¤ä»“åº“ä¸­çš„ç¼“å­˜" class="headerlink" title="2. æ›´æ–°gitignoreæ–‡ä»¶åï¼Œgitåˆ é™¤ä»“åº“ä¸­çš„ç¼“å­˜"></a>2. æ›´æ–°gitignoreæ–‡ä»¶åï¼Œgitåˆ é™¤ä»“åº“ä¸­çš„ç¼“å­˜</h1><p><code>git rm -r --cached target/ </code></p>]]></content>
    
    
    <categories>
      
      <category>Git</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>reactåˆä½“éªŒ</title>
    <link href="/react%E5%88%9D%E4%BD%93%E9%AA%8C/"/>
    <url>/react%E5%88%9D%E4%BD%93%E9%AA%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="Reactæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Reactæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Reactæ˜¯ä»€ä¹ˆï¼Ÿ"></a>Reactæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>React æ˜¯ä¸€ä¸ªå£°æ˜å¼ï¼Œé«˜æ•ˆä¸”çµæ´»çš„ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ã€‚</p><blockquote><p>ä½¿ç”¨æœ€åŸç”Ÿçš„HTMLã€CSSã€JavaScriptå¯ä»¥æ„å»ºå®Œæ•´çš„ç”¨æˆ·ç•Œé¢å—ï¼Ÿå½“ç„¶å¯ä»¥ï¼Œä½†æ˜¯ä¼šå­˜åœ¨å¾ˆå¤šé—®é¢˜</p><ul><li>æ“ä½œDOMå…¼å®¹æ€§çš„é—®é¢˜ï¼›</li><li>è¿‡å¤šå…¼å®¹æ€§ä»£ç çš„å†—ä½™é—®é¢˜ï¼›</li><li>ä»£ç ç»„ç»‡å’Œè§„èŒƒçš„é—®é¢˜ï¼›</li></ul></blockquote><h1 id="Reactçš„ç‰¹ç‚¹"><a href="#Reactçš„ç‰¹ç‚¹" class="headerlink" title="Reactçš„ç‰¹ç‚¹"></a>Reactçš„ç‰¹ç‚¹</h1><h2 id="å£°æ˜å¼ç¼–ç¨‹"><a href="#å£°æ˜å¼ç¼–ç¨‹" class="headerlink" title="å£°æ˜å¼ç¼–ç¨‹"></a>å£°æ˜å¼ç¼–ç¨‹</h2><ul><li>å£°æ˜å¼ç¼–ç¨‹æ˜¯ç›®å‰æ•´ä¸ªå¤§å‰ç«¯å¼€å‘çš„æ¨¡å¼ï¼šVueã€Reactã€Flutterã€SwiftUI</li><li>å®ƒå…è®¸æˆ‘ä»¬åªéœ€è¦ç»´æŠ¤è‡ªå·±çš„çŠ¶æ€ï¼Œå½“çŠ¶æ€æ”¹å˜æ—¶ï¼ŒReactå¯ä»¥æ ¹æ®æœ€æ–°çš„çŠ¶æ€å»æ¸²æŸ“æˆ‘ä»¬çš„UIç•Œé¢ï¼›</li></ul><h2 id="ç»„ä»¶åŒ–å¼€å‘"><a href="#ç»„ä»¶åŒ–å¼€å‘" class="headerlink" title="ç»„ä»¶åŒ–å¼€å‘"></a>ç»„ä»¶åŒ–å¼€å‘</h2><ul><li>ç»„ä»¶åŒ–å¼€å‘é¡µé¢ç›®å‰å‰ç«¯çš„æµè¡Œè¶‹åŠ¿</li></ul><h2 id="å¤šå¹³å°é€‚é…"><a href="#å¤šå¹³å°é€‚é…" class="headerlink" title="å¤šå¹³å°é€‚é…"></a>å¤šå¹³å°é€‚é…</h2><ul><li>2013å¹´ï¼ŒReactå‘å¸ƒä¹‹åˆä¸»è¦æ˜¯å¼€å‘Webé¡µé¢</li><li>2015å¹´ï¼ŒFacebookæ¨å‡ºäº†ReactNativeï¼Œç”¨äºå¼€å‘ç§»åŠ¨ç«¯è·¨å¹³å°ï¼ˆè™½ç„¶ç›®å‰Flutteréå¸¸ç«çˆ†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šå…¬å¸åœ¨ä½¿ç”¨ReactNativeï¼‰</li><li>2017å¹´ï¼ŒFacebookæ¨å‡ºReactVRï¼Œç”¨äºå¼€å‘è™šæ‹Ÿç°å®Webåº”ç”¨ç¨‹åº</li></ul><h2 id="react-å¼€å‘ä¾èµ–"><a href="#react-å¼€å‘ä¾èµ–" class="headerlink" title="react å¼€å‘ä¾èµ–"></a>react å¼€å‘ä¾èµ–</h2><h3 id="å¼€å‘Reactå¿…é¡»ä¾èµ–ä¸‰ä¸ªåº“ï¼š"><a href="#å¼€å‘Reactå¿…é¡»ä¾èµ–ä¸‰ä¸ªåº“ï¼š" class="headerlink" title="å¼€å‘Reactå¿…é¡»ä¾èµ–ä¸‰ä¸ªåº“ï¼š"></a>å¼€å‘Reactå¿…é¡»ä¾èµ–ä¸‰ä¸ªåº“ï¼š</h3><ul><li>reactï¼šåŒ…å«reactæ‰€å¿…é¡»çš„æ ¸å¿ƒä»£ç </li><li>react-domï¼šreactæ¸²æŸ“åœ¨ä¸åŒå¹³å°æ‰€éœ€è¦çš„æ ¸å¿ƒä»£ç </li><li>babelï¼šå°†jsxè½¬æ¢æˆReactä»£ç çš„å·¥å…·</li></ul><h2 id="å¦‚ä½•å¼•å…¥"><a href="#å¦‚ä½•å¼•å…¥" class="headerlink" title="å¦‚ä½•å¼•å…¥"></a>å¦‚ä½•å¼•å…¥</h2><ul><li>cdnå¼•å…¥</li><li>ä¸‹è½½åï¼Œæ·»åŠ æœ¬åœ°ä¾èµ–</li><li>npmä¾èµ–ï¼ˆè„šæ‰‹æ¶ä½¿ç”¨ï¼‰</li></ul><h2 id="è®¤è¯†Babel"><a href="#è®¤è¯†Babel" class="headerlink" title="è®¤è¯†Babel"></a>è®¤è¯†Babel</h2><ul><li>babelæ˜¯ç›®å‰å‰ç«¯ä½¿ç”¨éå¸¸å¹¿æ³›çš„ç¼–è¾‘å™¨ã€è½¬ç§»å™¨ã€‚</li><li>æ¯”å¦‚å½“ä¸‹å¾ˆå¤šæµè§ˆå™¨å¹¶ä¸æ”¯æŒES6çš„è¯­æ³•ï¼Œä½†æ˜¯ç¡®å®ES6çš„è¯­æ³•éå¸¸çš„ç®€æ´å’Œæ–¹ä¾¿ï¼Œæˆ‘ä»¬å¼€å‘æ—¶å¸Œæœ›ä½¿ç”¨å®ƒã€‚</li><li>é‚£ä¹ˆç¼–å†™æºç æ—¶æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ES6æ¥ç¼–å†™ï¼Œä¹‹åé€šè¿‡Babelå·¥å…·ï¼Œå°†ES6è½¬æˆå¤§å¤šæ•°æµè§ˆå™¨éƒ½æ”¯æŒçš„ES5çš„è¯­æ³•ã€‚</li></ul><blockquote><p>Reactå’ŒBabelçš„å…³ç³»ï¼š</p><ul><li>é»˜è®¤æƒ…å†µä¸‹å¼€å‘Reactå…¶å®å¯ä»¥ä¸ä½¿ç”¨babelã€‚</li><li>ä½†æ˜¯å‰ææ˜¯æˆ‘ä»¬è‡ªå·±ä½¿ç”¨React.createElementæ¥ç¼–å†™æºä»£ç ï¼Œå®ƒç¼–å†™çš„ä»£ç éå¸¸çš„ç¹çå’Œå¯è¯»æ€§å·®ã€‚</li><li>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ç¼–å†™jsxï¼ˆJavaScriptXMLï¼‰çš„è¯­æ³•ï¼Œå¹¶ä¸”è®©babelå¸®åŠ©æˆ‘ä»¬è½¬æ¢æˆReact.createElementã€‚</li></ul></blockquote><h1 id="Hello-worldæ¡ˆä¾‹"><a href="#Hello-worldæ¡ˆä¾‹" class="headerlink" title="Hello worldæ¡ˆä¾‹"></a>Hello worldæ¡ˆä¾‹</h1><ul><li>è¿™é‡Œæˆ‘ä»¬ç¼–å†™Reactçš„scriptä»£ç ä¸­ï¼Œå¿…é¡»æ·»åŠ type&#x3D;â€text&#x2F;babelâ€ï¼Œä½œç”¨æ˜¯å¯ä»¥è®©babelè§£æjsxçš„è¯­æ³•</li><li>ReactDOM.renderå‡½æ•°ï¼š<ul><li>å‚æ•°ä¸€ï¼šä¼ é€’è¦æ¸²æŸ“çš„å†…å®¹ï¼Œè¿™ä¸ªå†…å®¹å¯ä»¥æ˜¯HTMLå…ƒç´ ï¼Œä¹Ÿå¯ä»¥æ˜¯Reactçš„ç»„ä»¶</li><li>å‚æ•°äºŒï¼šå°†æ¸²æŸ“çš„å†…å®¹ï¼ŒæŒ‚è½½åˆ°å“ªä¸€ä¸ªHTMLå…ƒç´ ä¸Š</li></ul></li><li>é€šè¿‡{}è¯­æ³•æ¥å¼•å…¥å¤–éƒ¨çš„å˜é‡æˆ–è€…è¡¨è¾¾å¼</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;body&gt;<br>  &lt;!--æ·»åŠ react ä¾èµ–--&gt;<br>  &lt;!-- <span class="hljs-comment">// crossorigin å°†è¿œç¨‹jsçš„ä¸€äº›é”™è¯¯ï¼Œæ˜¾ç¤ºåˆ°æœ¬åœ° --&gt;</span><br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://unpkg.com/react@17/umd/react.development.js&quot;</span> <span class="hljs-attr">crossorigin</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://unpkg.com/react-dom@17/umd/react-dom.development.js&quot;</span> <span class="hljs-attr">crossorigin</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://unpkg.com/babel-standalone@6/babel.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span>ã€å†…å®¹ä¼šè¢«è¦†ç›–ã€‘<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/babel&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml">  <span class="hljs-comment">// renderï¼ˆæ¸²æŸ“çš„å†…å®¹ï¼ŒæŒ‚è½½çš„ä½ç½®ï¼‰</span></span></span><br><span class="javascript"><span class="xml">  <span class="hljs-comment">// ReactDOM.render(&lt;h2&gt;hello World&lt;/h2&gt;,document.getElementById(&quot;app&quot;))</span></span></span><br><span class="javascript"><span class="xml"></span></span><br><span class="javascript"><span class="xml">  <span class="hljs-keyword">let</span> message = <span class="hljs-string">&quot;hello world&quot;</span></span></span><br><span class="javascript"><span class="xml">  ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>&#123;message&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span>,<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;app&quot;</span>))</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br>&lt;/body&gt;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228233834887.png" alt="image-20230228233834887"></p><h1 id="HelloReactâ€“-ç»„ä»¶åŒ–å¼€å‘"><a href="#HelloReactâ€“-ç»„ä»¶åŒ–å¼€å‘" class="headerlink" title="HelloReactâ€“ ç»„ä»¶åŒ–å¼€å‘"></a>HelloReactâ€“ ç»„ä»¶åŒ–å¼€å‘</h1><ul><li>è¿™é‡Œæˆ‘ä»¬æš‚æ—¶ä½¿ç”¨ç±»çš„æ–¹å¼å°è£…ç»„ä»¶ï¼š<ul><li>1.å®šä¹‰ä¸€ä¸ªç±»ï¼ˆç±»åå¤§å†™ï¼Œç»„ä»¶çš„åç§°æ˜¯å¿…é¡»å¤§å†™çš„ï¼Œå°å†™ä¼šè¢«è®¤ä¸ºæ˜¯HTMLå…ƒç´ ï¼‰ï¼Œç»§æ‰¿è‡ªReact.Component</li><li>2.å®ç°å½“å‰ç»„ä»¶çš„renderå‡½æ•°ã€‚renderå½“ä¸­è¿”å›çš„jsxå†…å®¹ï¼Œå°±æ˜¯ä¹‹åReactä¼šå¸®åŠ©æˆ‘ä»¬æ¸²æŸ“çš„å†…å®¹</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script type=<span class="hljs-string">&quot;text/babel&quot;</span>&gt;<br> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>&#123;<br>     <span class="hljs-keyword">return</span> (<br>        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>hello world<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br>     )<br>   &#125;<br> &#125;<br> ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span>/&gt;</span></span>, <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;app&quot;</span>))<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><h2 id="ç»„ä»¶åŒ–-æ•°æ®ä¾èµ–"><a href="#ç»„ä»¶åŒ–-æ•°æ®ä¾èµ–" class="headerlink" title="ç»„ä»¶åŒ– - æ•°æ®ä¾èµ–"></a>ç»„ä»¶åŒ– - æ•°æ®ä¾èµ–</h2><ul><li>ç»„ä»¶ä¸­çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æˆä¸¤ç±»ï¼š<ul><li>å‚ä¸ç•Œé¢æ›´æ–°çš„æ•°æ®ï¼šå½“æ•°æ®å˜é‡æ—¶ï¼Œéœ€è¦æ›´æ–°ç»„ä»¶æ¸²æŸ“çš„å†…å®¹</li><li>ä¸å‚ä¸ç•Œé¢æ›´æ–°çš„æ•°æ®ï¼šå½“æ•°æ®å˜é‡æ—¶ï¼Œä¸éœ€è¦æ›´æ–°å°†ç»„å»ºæ¸²æŸ“çš„å†…å®¹</li></ul></li><li>å‚ä¸ç•Œé¢æ›´æ–°çš„æ•°æ®æˆ‘ä»¬ä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºæ˜¯å‚ä¸æ•°æ®æµï¼Œè¿™ä¸ªæ•°æ®æ˜¯å®šä¹‰åœ¨å½“å‰å¯¹è±¡çš„stateä¸­<ul><li>æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ„é€ å‡½æ•°ä¸­this.state&#x3D;{å®šä¹‰çš„æ•°æ®}</li><li>å½“æˆ‘ä»¬çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨this.setStateæ¥æ›´æ–°æ•°æ®ï¼Œå¹¶ä¸”é€šçŸ¥Reactè¿›è¡Œupdateæ“ä½œã€‚</li><li>åœ¨è¿›è¡Œupdateæ“ä½œæ—¶ï¼Œå°±ä¼šé‡æ–°è°ƒç”¨renderå‡½æ•°ï¼Œå¹¶ä¸”ä½¿ç”¨æœ€æ–°çš„æ•°æ®ï¼Œæ¥æ¸²æŸ“ç•Œé¢</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs react">class App extends React.Component &#123;<br>  constructor()&#123;<br>    super()<br>    this.state = &#123;<br>     message: &quot;hello world&quot;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç»„ä»¶åŒ–-â€“-äº‹ä»¶ç»‘å®š"><a href="#ç»„ä»¶åŒ–-â€“-äº‹ä»¶ç»‘å®š" class="headerlink" title="ç»„ä»¶åŒ– â€“ äº‹ä»¶ç»‘å®š"></a>ç»„ä»¶åŒ– â€“ äº‹ä»¶ç»‘å®š</h2><ul><li><p>åœ¨ç±»ä¸­ç›´æ¥å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”å°†è¿™ä¸ªå‡½æ•°ç»‘å®šåˆ°htmlåŸç”Ÿçš„onClickäº‹ä»¶ä¸Šï¼Œå½“å‰è¿™ä¸ªå‡½æ•°çš„thisæŒ‡å‘é»˜è®¤æƒ…å†µä¸‹æ˜¯undefined</p><ul><li>å› ä¸ºåœ¨æ­£å¸¸çš„DOMæ“ä½œä¸­ï¼Œç›‘å¬ç‚¹å‡»ï¼Œç›‘å¬å‡½æ•°ä¸­çš„thiså…¶å®æ˜¯èŠ‚ç‚¹å¯¹è±¡ï¼ˆæ¯”å¦‚è¯´æ˜¯buttonå¯¹è±¡ï¼‰ï¼›</li><li>Reactå¹¶ä¸æ˜¯ç›´æ¥æ¸²æŸ“æˆçœŸå®çš„DOMï¼Œæˆ‘ä»¬æ‰€ç¼–å†™çš„buttonåªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå®ƒçš„æœ¬è´¨Reactçš„Elementå¯¹è±¡ï¼›</li></ul></li><li><p>æˆ‘ä»¬åœ¨ç»‘å®šçš„å‡½æ•°ä¸­ï¼Œå¯èƒ½æƒ³è¦ä½¿ç”¨å½“å‰å¯¹è±¡ï¼Œæ¯”å¦‚æ‰§è¡Œthis.setStateå‡½æ•°ï¼Œå°±å¿…é¡»æ‹¿åˆ°å½“å‰å¯¹è±¡çš„this</p><ul><li><p>æˆ‘ä»¬å°±éœ€è¦åœ¨ä¼ å…¥å‡½æ•°æ—¶ï¼Œç»™è¿™ä¸ªå‡½æ•°ç›´æ¥ç»‘å®šthis</p></li><li><p>ç±»ä¼¼äºä¸‹é¢çš„å†™æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs react">&lt;button onClick=&#123;this.btnClick.bind(this)&#125;&gt;æ”¹å˜æ–‡æœ¬&lt;/button&gt;<br></code></pre></td></tr></table></figure></li></ul></li></ul><h1 id="ç”µå½±åˆ—è¡¨æ¡ˆä¾‹"><a href="#ç”µå½±åˆ—è¡¨æ¡ˆä¾‹" class="headerlink" title="ç”µå½±åˆ—è¡¨æ¡ˆä¾‹"></a>ç”µå½±åˆ—è¡¨æ¡ˆä¾‹</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script type=<span class="hljs-string">&quot;text/babel&quot;</span>&gt;<br> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span>&#123;<br>     <span class="hljs-built_in">super</span>()<br>     <span class="hljs-built_in">this</span>.state = &#123;<br>      <span class="hljs-attr">movies</span>: [<span class="hljs-string">&quot;å¤§è¯è¥¿æ¸¸&quot;</span>, <span class="hljs-string">&quot;å¼€å¿ƒå†œåœº&quot;</span>]<br>     &#125;<br>   &#125;<br>   <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>&#123;<br>     <span class="hljs-keyword">return</span> (<br>       <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>ç”µå½±åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="xml">          &#123;</span><br><span class="xml">            this.state.movies.map((item, index)=&gt;&#123;</span><br><span class="xml">            return (<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;item&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>)</span><br><span class="xml">            &#125;)</span><br><span class="xml">          &#125;</span><br><span class="xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br><span class="xml">       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>     )<br>   &#125;<br> &#125;<br> ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span>/&gt;</span></span>, <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;app&quot;</span>))<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228233846219.png" alt="image-20230228233846219"></p><h1 id="è®¡æ•°å™¨æ¡ˆä¾‹"><a href="#è®¡æ•°å™¨æ¡ˆä¾‹" class="headerlink" title="è®¡æ•°å™¨æ¡ˆä¾‹"></a>è®¡æ•°å™¨æ¡ˆä¾‹</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script type=<span class="hljs-string">&quot;text/babel&quot;</span>&gt;<br> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span>&#123;<br>     <span class="hljs-built_in">super</span>()<br>     <span class="hljs-built_in">this</span>.state = &#123;<br>      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span><br>     &#125;<br>   &#125;<br>   <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>&#123;<br>     <span class="hljs-keyword">return</span> (<br>       <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>å½“å‰è®¡æ•°:&#123;this.state.count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span> = <span class="hljs-string">&#123;this.incr.bind(this)&#125;</span>&gt;</span>+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span> = <span class="hljs-string">&#123;this.decr.bind(this)&#125;</span>&gt;</span>-1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>     )<br>   &#125;<br><br>   <span class="hljs-function"><span class="hljs-title">incr</span>(<span class="hljs-params"></span>)</span>&#123;<br>     <span class="hljs-built_in">this</span>.setState(&#123;<br>       <span class="hljs-attr">count</span>: <span class="hljs-built_in">this</span>.state.count + <span class="hljs-number">1</span><br>     &#125;)<br>   &#125;<br><br>   <span class="hljs-function"><span class="hljs-title">decr</span>(<span class="hljs-params"></span>)</span>&#123;<br>     <span class="hljs-built_in">this</span>.setState(&#123;<br>       <span class="hljs-attr">count</span>: <span class="hljs-built_in">this</span>.state.count - <span class="hljs-number">1</span><br>     &#125;)<br>   &#125;<br><br> &#125;<br> ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span>/&gt;</span></span>, <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;app&quot;</span>))<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228233857215.png" alt="image-20230228233857215"></p><p>2ED3-DF39</p>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¦‚å¿µ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é‡æ„-æ”¹å–„ä»£ç å·²æœ‰çš„è®¾è®¡</title>
    <link href="/%E9%87%8D%E6%9E%84-%E6%94%B9%E5%96%84%E4%BB%A3%E7%A0%81%E5%B7%B2%E6%9C%89%E7%9A%84%E8%AE%BE%E8%AE%A1/"/>
    <url>/%E9%87%8D%E6%9E%84-%E6%94%B9%E5%96%84%E4%BB%A3%E7%A0%81%E5%B7%B2%E6%9C%89%E7%9A%84%E8%AE%BE%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¦‚æœæ²¡æœ‰å•å…ƒæµ‹è¯•å’Œé‡æ„ï¼Œæˆ‘æ²¡åŠæ³•å†™ä»£ç </p></blockquote><h1 id="1-é‡æ„çš„æ„ä¹‰"><a href="#1-é‡æ„çš„æ„ä¹‰" class="headerlink" title="1 é‡æ„çš„æ„ä¹‰"></a>1 é‡æ„çš„æ„ä¹‰</h1><ul><li>ä¿æŒä»£ç æ˜“è¯»ã€æ˜“ä¿®æ”¹</li><li>é¿å…ä»£ç å¤ªå¤æ‚ï¼Œæ— æ³•ç†è§£ï¼Œæ— æ³•è°ƒè¯•ã€‚ï¼ˆæˆ–è®¸ä¸€ä¸ªä¿®æ”¹åªéœ€è¦10åˆ†é’Ÿï¼Œä½†æ˜¯ä½ å¾—èŠ±è´¹1ä¸ªå°æ—¶å»ç†è§£è¿™æ®µä»£ç </li><li>å¦‚æœæ²¡æœ‰è‰¯å¥½è®¾è®¡ï¼Œæˆ–è®¸æŸä¸€æ®µæ—¶é—´å†…ä½ çš„è¿›å±•è¿…é€Ÿï¼Œä½†æ¶åŠ£çš„è®¾è®¡å¾ˆå¿«å°±è®©ä½ çš„é€Ÿåº¦æ…¢ä¸‹æ¥ã€‚ä½ ä¼šæŠŠæ—¶é—´èŠ±åœ¨ è°ƒè¯•ä¸Šé¢ï¼Œæ— æ³•æ·»åŠ æ–°åŠŸèƒ½ã€‚ä¿®æ”¹æ—¶é—´è¶Šæ¥è¶Šé•¿ï¼Œå› ä¸ºä½ å¿…é¡»èŠ±è¶Šæ¥è¶Šå¤šçš„æ—¶é—´å»ç†è§£ç³»ç»Ÿã€‚</li></ul><h1 id="2-é‡æ„çš„å®šä¹‰"><a href="#2-é‡æ„çš„å®šä¹‰" class="headerlink" title="2 é‡æ„çš„å®šä¹‰"></a>2 é‡æ„çš„å®šä¹‰</h1><p>åœ¨ä¸æ”¹å˜ä»£ç å¤–åœ¨è¡Œä¸ºçš„å‰æä¸‹ï¼Œå¯¹ä»£ç åšå‡ºä¿®æ”¹ï¼Œä»¥æ”¹è¿›ç¨‹åºçš„å†…éƒ¨ç»“æ„ã€‚</p><h1 id="3-é‡æ„çš„å‰æ"><a href="#3-é‡æ„çš„å‰æ" class="headerlink" title="3 é‡æ„çš„å‰æ"></a>3 é‡æ„çš„å‰æ</h1><p><strong>ä¸ºå³å°†ä¿®æ”¹çš„ä»£ç å»ºç«‹ä¸€ç»„å¯é çš„æµ‹è¯•ç¯å¢ƒã€‚</strong></p><ul><li>å› ä¸ºå°½ç®¡éµå¾ªé‡æ„æ‰‹æ³•å¯ä»¥ä½¿æˆ‘é¿å…ç»å¤§å¤šæ•°å¼•å…¥bugçš„æƒ…å½¢ï¼Œä½†æˆ‘æ¯•ç«Ÿæ˜¯äººï¼Œæ¯•ç«Ÿæœ‰å¯èƒ½çŠ¯é”™ã€‚æ‰€ä»¥æˆ‘éœ€è¦å¯é çš„æµ‹è¯•ã€‚</li></ul><blockquote><p>å¥½çš„æµ‹è¯•æ˜¯é‡æ„çš„æ ¹æœ¬ã€‚</p></blockquote><h1 id="4-ä½•æ—¶é‡æ„"><a href="#4-ä½•æ—¶é‡æ„" class="headerlink" title="4 ä½•æ—¶é‡æ„"></a>4 ä½•æ—¶é‡æ„</h1><h2 id="4-1-æ·»åŠ æ–°åŠŸèƒ½æ—¶é‡æ„"><a href="#4-1-æ·»åŠ æ–°åŠŸèƒ½æ—¶é‡æ„" class="headerlink" title="4.1 æ·»åŠ æ–°åŠŸèƒ½æ—¶é‡æ„"></a>4.1 æ·»åŠ æ–°åŠŸèƒ½æ—¶é‡æ„</h2><ul><li><p>æ­¤æ—¶ï¼Œé‡æ„çš„ç›´æ¥åŸå› å¾€å¾€æ˜¯ä¸ºäº†å¸®åŠ©æˆ‘ç†è§£ éœ€è¦ä¿®æ”¹çš„ä»£ç â€”â€”è¿™äº›ä»£ç å¯èƒ½æ˜¯åˆ«äººå†™çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯æˆ‘è‡ªå·±å†™çš„ã€‚</p></li><li><p>æ— è®ºä½•æ—¶ï¼Œåªè¦æˆ‘æƒ³ç†è§£ä»£ç æ‰€åšçš„äº‹ï¼Œæˆ‘å°±ä¼šé—®è‡ªå·±ï¼šæ˜¯å¦èƒ½å¯¹è¿™æ®µä»£ç è¿›è¡Œé‡æ„ï¼Œä½¿æˆ‘èƒ½æ›´å¿«åœ°ç†è§£å®ƒã€‚ç„¶åæˆ‘å°±ä¼šé‡æ„ã€‚</p></li><li><p>ä¹‹æ‰€ä»¥è¿™ä¹ˆåšï¼Œéƒ¨åˆ†åŸå› æ˜¯ä¸ºäº†è®©æˆ‘ä¸‹æ¬¡å†çœ‹è¿™æ®µä»£ç æ—¶å®¹æ˜“ç†è§£ï¼Œä½†æœ€ä¸»è¦çš„åŸå› æ˜¯ï¼šå¦‚æœåœ¨å‰è¿›è¿‡ç¨‹ä¸­æŠŠä»£ç ç»“æ„ç†æ¸…ï¼Œæˆ‘å°±å¯ä»¥ä»ä¸­ç†è§£æ›´å¤šä¸œè¥¿</p></li></ul><h2 id="4-2-å¤å®¡ä»£ç æ—¶é‡æ„"><a href="#4-2-å¤å®¡ä»£ç æ—¶é‡æ„" class="headerlink" title="4.2 å¤å®¡ä»£ç æ—¶é‡æ„"></a>4.2 å¤å®¡ä»£ç æ—¶é‡æ„</h2><p>è¿™ç§æ´»åŠ¨æœ‰åŠ©äºåœ¨å¼€å‘å›¢é˜Ÿä¸­ä¼  æ’­çŸ¥è¯†ï¼Œä¹Ÿæœ‰åŠ©äºè®©è¾ƒæœ‰ç»éªŒçš„å¼€å‘è€…æŠŠçŸ¥è¯†ä¼ é€’ç»™æ¯”è¾ƒæ¬ ç¼ºç»éªŒçš„äººï¼Œå¹¶å¸®åŠ©æ›´å¤šäººç†è§£å¤§å‹è½¯ä»¶ç³»ç»Ÿä¸­çš„æ›´å¤šéƒ¨åˆ†ã€‚</p><h2 id="4-3-ä¿®è¡¥é”™è¯¯æ—¶é‡æ„"><a href="#4-3-ä¿®è¡¥é”™è¯¯æ—¶é‡æ„" class="headerlink" title="4.3 ä¿®è¡¥é”™è¯¯æ—¶é‡æ„"></a>4.3 ä¿®è¡¥é”™è¯¯æ—¶é‡æ„</h2><p>ä»£ç è¿˜å¤Ÿæ¸…æ™°â€”â€”æ²¡æœ‰æ¸…æ™°åˆ°è®©ä½ èƒ½ä¸€çœ¼çœ‹å‡ºbugã€‚</p><h1 id="5-ä»£ç åå‘³é“"><a href="#5-ä»£ç åå‘³é“" class="headerlink" title="5 ä»£ç åå‘³é“"></a>5 ä»£ç åå‘³é“</h1><h2 id="5-1-å‘½åè§„èŒƒ"><a href="#5-1-å‘½åè§„èŒƒ" class="headerlink" title="5.1 å‘½åè§„èŒƒ"></a>5.1 å‘½åè§„èŒƒ</h2><h3 id="é”™è¯¯æ–¹å¼"><a href="#é”™è¯¯æ–¹å¼" class="headerlink" title="é”™è¯¯æ–¹å¼"></a>é”™è¯¯æ–¹å¼</h3><ul><li><p>å•è¯æ‹¼å†™é”™è¯¯</p></li><li><p>è‡ªå·±åˆ›é€ ç¼©å†™   </p></li><li><p>ä½¿ç”¨æŠ€æœ¯æœ¯è¯­å‘½å</p><ul><li><p>å¦‚ï¼šuserList , idList</p></li><li><p>ç¼–ç¨‹çš„ä¸€ä¸ªé‡è¦åŸåˆ™æ˜¯é¢å‘æ¥å£ç¼–ç¨‹ã€‚å³æ¥å£æ˜¯ç¨³å®šçš„ï¼Œå®ç°æ˜¯æ˜“å˜çš„ã€‚</p></li><li><p>å‡è®¾è¿™é‡Œæˆ‘ç°åœ¨éœ€è¦çš„æ˜¯ä¸€ä¸ªä¸é‡å¤çš„ä½œå“é›†åˆï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œéœ€è¦æŠŠListæ”¹æˆSetï¼Œå˜é‡ç±»å‹ä¸€å®šä¼šæ”¹ï¼Œä½†æ˜¯ä½ ä¸ä¸€å®šä¼šè®°å¾—æ”¹å˜é‡åï¼Œä¸€æ—¦é—å¿˜ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªbookListå˜é‡ï¼Œå®ƒçš„ç±»å‹æ˜¯set,å°±ä¼šäº§ç”Ÿæ··æ·†ã€‚</p></li></ul></li><li><p>å‘½åä¸­çš„ä¸ä¸€è‡´ã€‚</p></li></ul><h3 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ul><li>å‘½åè¦æœ‰ä¸šåŠ¡å«ä¹‰</li><li>å»ºç«‹å›¢é˜Ÿçš„è¯æ±‡è¡¨ï¼Œè®©å›¢é˜Ÿæˆå‘˜æœ‰ä¿¡æ¯å¯ä»¥å‚è€ƒã€‚</li><li>åˆ¶å®šä»£ç è§„èŒƒï¼Œæ¯”å¦‚ï¼Œç±»åè¦ç”¨åè¯ï¼Œå‡½æ•°åè¦ç”¨åŠ¨è¯æˆ–åŠ¨å®¾çŸ­è¯­ï¼›</li><li>ç¬¦åˆè‹±è¯­è¯­æ³•è§„åˆ™</li><li>ç±»ä¼¼å«ä¹‰çš„ä»£ç åº”è¯¥æœ‰ä¸€è‡´çš„åå­—ï¼Œä¸€æ—¦å‡ºç°äº†ä¸ä¸€è‡´çš„åå­—ï¼Œé€šå¸¸éƒ½è¡¨ç¤ºä¸åŒçš„å«ä¹‰</li></ul><h2 id="5-2-Duplicated-Codeï¼ˆé‡å¤ä»£ç ï¼‰"><a href="#5-2-Duplicated-Codeï¼ˆé‡å¤ä»£ç ï¼‰" class="headerlink" title="5.2 Duplicated Codeï¼ˆé‡å¤ä»£ç ï¼‰"></a>5.2 Duplicated Codeï¼ˆé‡å¤ä»£ç ï¼‰</h2><ul><li>å¤åˆ¶ç²˜è´´çš„ä»£ç </li><li>éƒ¨åˆ†é‡å¤</li><li>if å’Œ else ä»£ç å—ä¸­çš„è¯­å¥é«˜åº¦ç±»ä¼¼ã€‚</li></ul><h3 id="ä¼˜åŒ–-1"><a href="#ä¼˜åŒ–-1" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ul><li><p>æŠ½æ–¹æ³•</p></li><li><p>Template Methodï¼ˆæ¨¡ç‰ˆæ–¹æ³•ï¼‰ï¼š åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å®šä¹‰ä¸€ä¸ªç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">createOrder</span><span class="hljs-params">()</span> </span>&#123;<br>    check();<br>    calculate();<br>    pay();<br>    log();<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>è®© if è¯­å¥åšçœŸæ­£çš„é€‰æ‹©</li></ul><h2 id="5-3-Long-Methodï¼ˆè¿‡é•¿å‡½æ•°ï¼‰"><a href="#5-3-Long-Methodï¼ˆè¿‡é•¿å‡½æ•°ï¼‰" class="headerlink" title="5.3 Long Methodï¼ˆè¿‡é•¿å‡½æ•°ï¼‰"></a>5.3 <strong>Long Method</strong>ï¼ˆè¿‡é•¿å‡½æ•°ï¼‰</h2><h3 id="äº§ç”ŸåŸå› "><a href="#äº§ç”ŸåŸå› " class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h3><ul><li><p>æŠŠä»£ç å¹³é“ºç›´å™åœ°æ‘Šåœ¨é‚£é‡Œ</p></li><li><p>ä¸€æ¬¡åŠ ä¸€ç‚¹</p></li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li><p>ç¨‹åºæ„ˆé•¿æ„ˆéš¾ç†è§£</p></li><li><p>æŠŠå¤šä¸ªä¸šåŠ¡å¤„ç†æµç¨‹æ”¾åœ¨ä¸€ä¸ªå‡½æ•°é‡Œå®ç°ï¼›</p></li><li><p>æŠŠä¸åŒå±‚é¢çš„ç»†èŠ‚æ”¾åˆ°ä¸€ä¸ªå‡½æ•°é‡Œå®ç°ã€‚</p></li></ul><h3 id="ä¼˜åŒ–-2"><a href="#ä¼˜åŒ–-2" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ul><li>å¦‚æœä»£ç å‰æ–¹æœ‰ä¸€è¡Œæ³¨é‡Šï¼Œå°±æ˜¯åœ¨æé†’ä½ ï¼šå¯ä»¥å°†è¿™æ®µä»£ç æ›¿æ¢æˆä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸”å¯ä»¥åœ¨æ³¨é‡Šçš„åŸºç¡€ä¸Šç»™è¿™ä¸ªå‡½æ•°å‘½åã€‚å°±ç®—åªæœ‰ä¸€è¡Œä»£ç ï¼Œå¦‚æœå®ƒéœ€è¦ä»¥æ³¨é‡Šæ¥è¯´æ˜ï¼Œé‚£ä¹Ÿå€¼å¾—å°†å®ƒæç‚¼åˆ°ç‹¬ç«‹å‡½æ•°å»ã€‚</li><li>å¾ªç¯å¸¸å¸¸ä¹Ÿæ˜¯æç‚¼çš„ä¿¡å·ã€‚ä½ åº”è¯¥å°†å¾ªç¯å’Œå…¶å†…çš„ä»£ç æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ä¸­ã€‚</li><li>å»ºè®®30 è¡Œï¼Œideaå±å¯ä»¥çœ‹å¾—å®Œ</li></ul><h2 id="5-4-Large-Classï¼ˆè¿‡å¤§çš„ç±»ï¼‰"><a href="#5-4-Large-Classï¼ˆè¿‡å¤§çš„ç±»ï¼‰" class="headerlink" title="5.4 Large Classï¼ˆè¿‡å¤§çš„ç±»ï¼‰"></a>5.4 Large Classï¼ˆè¿‡å¤§çš„ç±»ï¼‰</h2><h3 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>ç±»å†…å¦‚æœæœ‰å¤ªå¤šä»£ç ï¼Œä¹Ÿæ˜¯ä»£ç é‡å¤ã€æ··ä¹±å¹¶æœ€ç»ˆèµ°å‘æ­»äº¡çš„æºå¤´</p><h3 id="ä¼˜åŒ–-3"><a href="#ä¼˜åŒ–-3" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ul><li>ç±»çš„èŒè´£ä¿è¯å•ä¸€</li><li>å­—æ®µæœªåˆ†ç»„ã€‚æ¯”å¦‚ï¼ŒuserIdã€nameã€nickname å‡ é¡¹ï¼Œç®—æ˜¯ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œè€Œ emailã€phoneNumber è¿™äº›åˆ™å±äºç”¨æˆ·çš„è”ç³»æ–¹å¼</li></ul><h2 id="5-5-Long-Parameter-Listï¼ˆè¿‡é•¿å‚æ•°åˆ—ï¼‰"><a href="#5-5-Long-Parameter-Listï¼ˆè¿‡é•¿å‚æ•°åˆ—ï¼‰" class="headerlink" title="5.5 Long Parameter Listï¼ˆè¿‡é•¿å‚æ•°åˆ—ï¼‰"></a>5.5 Long Parameter Listï¼ˆè¿‡é•¿å‚æ•°åˆ—ï¼‰</h2><h3 id="ç¼ºç‚¹-2"><a href="#ç¼ºç‚¹-2" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>å¤ªé•¿çš„å‚æ•°åˆ—éš¾ä»¥ç†è§£ï¼Œå¤ªå¤šå‚æ•°ä¼šé€ æˆå‰åä¸ä¸€è‡´ã€ä¸æ˜“ä½¿ç”¨</li><li>å¦‚æœæœ‰å¤šä¸ªé‡è½½æ–¹æ³•ï¼Œå‚æ•°å¾ˆå¤šçš„è¯ï¼Œæœ‰æ—¶å€™ä½ éƒ½ä¸çŸ¥é“è°ƒå“ªä¸ª</li></ul><h3 id="ä¼˜åŒ–-4"><a href="#ä¼˜åŒ–-4" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ul><li>å°†å‚æ•°å°è£…æˆç»“æ„æˆ–è€…ç±»</li></ul><h2 id="5-6-Shotgun-Surgeryï¼ˆéœ°å¼¹å¼ä¿®æ”¹ï¼‰"><a href="#5-6-Shotgun-Surgeryï¼ˆéœ°å¼¹å¼ä¿®æ”¹ï¼‰" class="headerlink" title="5.6 Shotgun Surgeryï¼ˆéœ°å¼¹å¼ä¿®æ”¹ï¼‰"></a>5.6 Shotgun Surgeryï¼ˆéœ°å¼¹å¼ä¿®æ”¹ï¼‰</h2><h3 id="ç¼ºç‚¹-3"><a href="#ç¼ºç‚¹-3" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>æ¯é‡åˆ°æŸç§å˜åŒ–ï¼Œä½ éƒ½å¿…é¡»åœ¨è®¸å¤šä¸åŒçš„ç±»å†…åšå‡ºè®¸å¤šå°ä¿®æ”¹ï¼Œä½ ä¸ä½†å¾ˆéš¾æ‰¾åˆ°å®ƒä»¬ï¼Œä¹Ÿå¾ˆå®¹æ˜“å¿˜è®°æŸä¸ªé‡è¦çš„ä¿®æ”¹ã€‚</li></ul><h3 id="ä¼˜åŒ–-5"><a href="#ä¼˜åŒ–-5" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ul><li>æŠŠæ‰€æœ‰éœ€è¦ä¿®æ”¹çš„ä»£ç æ”¾è¿›åŒä¸€ä¸ªç±»</li></ul><h3 id="5-7-Data-Clumpsï¼ˆæ•°æ®æ³¥å›¢ï¼‰"><a href="#5-7-Data-Clumpsï¼ˆæ•°æ®æ³¥å›¢ï¼‰" class="headerlink" title="5.7 Data Clumpsï¼ˆæ•°æ®æ³¥å›¢ï¼‰"></a>5.7 Data Clumpsï¼ˆæ•°æ®æ³¥å›¢ï¼‰</h3><p>æ•°æ®æ³¥å›¢æŒ‡çš„æ˜¯ç»å¸¸ä¸€èµ·å‡ºç°çš„æ•°æ®ï¼Œ æ¯”å¦‚ï¼š</p><ul><li>ä¸¤ä¸ªç±»ä¸­ç›¸åŒçš„å­—æ®µ</li><li>å¤šä¸ªå‡½æ•°ç­¾åä¸­ç›¸åŒçš„å‚æ•°</li></ul><h3 id="ä¼˜åŒ–-6"><a href="#ä¼˜åŒ–-6" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ul><li>æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹å¯¹è±¡</li></ul><h2 id="5-8-Switch-Statementsï¼ˆswitchæƒŠæ‚šç°èº«ï¼‰"><a href="#5-8-Switch-Statementsï¼ˆswitchæƒŠæ‚šç°èº«ï¼‰" class="headerlink" title="5.8  Switch Statementsï¼ˆswitchæƒŠæ‚šç°èº«ï¼‰"></a>5.8  Switch Statementsï¼ˆswitchæƒŠæ‚šç°èº«ï¼‰</h2><ul><li>å°‘ç”¨switchï¼ˆæˆ–caseï¼‰è¯­å¥</li></ul><h3 id="ç¼ºç‚¹-4"><a href="#ç¼ºç‚¹-4" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>switchè¯­å¥çš„é—®é¢˜åœ¨äºé‡å¤ã€‚ä½ å¸¸ä¼šå‘ç°åŒæ ·çš„switchè¯­å¥æ•£å¸ƒäºä¸åŒåœ°ç‚¹ã€‚</li><li>å¦‚æœè¦ä¸ºå®ƒæ·»åŠ ä¸€ä¸ªæ–°çš„caseå­å¥ï¼Œå°±å¿…é¡»æ‰¾åˆ°æ‰€æœ‰switchè¯­å¥å¹¶ä¿®æ”¹å®ƒä»¬</li></ul><h3 id="ä¼˜åŒ–-7"><a href="#ä¼˜åŒ–-7" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ul><li><p>æ„å»ºmap</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">function <span class="hljs-title">getDeliverResult</span><span class="hljs-params">(status)</span> </span>&#123;<br>  <span class="hljs-keyword">switch</span> (status) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;å¾…å‘è´§&#x27;</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;å·²å‘è´§&#x27;</span>;<br>    <span class="hljs-keyword">default</span>:<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">const</span> orderStatus = <span class="hljs-keyword">new</span> Map()<br>    .set(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;å¾…å‘è´§&#x27;</span>)<br>    .set(<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;å·²å‘è´§&#x27;</span>)<br>    .set(<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;å·²å®Œæˆ&#x27;</span>);<br> <br><span class="hljs-function">function <span class="hljs-title">getOrderStatus</span><span class="hljs-params">(statusCode)</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> orderStatus.get(statusCode) || [];<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å¤šæ€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">double</span> result = <span class="hljs-number">0</span>;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ChargeFor</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-keyword">switch</span>(PriceCode)&#123;<br><span class="hljs-keyword">case</span> Movie.REGULAR:<br>result = (<span class="hljs-keyword">new</span> RegularPrice()).ChargeFor(daysRented)<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> Movie.REGULAR:<br>result += daysRented * <span class="hljs-number">3</span>;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> Movie.CHILDRENS:<br>result += <span class="hljs-number">1.5</span>;<br><span class="hljs-keyword">if</span> (daysRented &gt; <span class="hljs-number">3</span>)<br>result += (daysRented - <span class="hljs-number">3</span>) * <span class="hljs-number">1.5</span>;<br><span class="hljs-keyword">break</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MovieBase</span> </span>&#123;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ChargeFor</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RegularMovie</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MovieBase</span></span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ChargeFor</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RegularPrice()).ChargeFor(daysRented);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h2 id="5-9-è¿‡æ·±çš„if-elseåµŒå¥—"><a href="#5-9-è¿‡æ·±çš„if-elseåµŒå¥—" class="headerlink" title="5.9 è¿‡æ·±çš„if elseåµŒå¥—"></a>5.9 è¿‡æ·±çš„if elseåµŒå¥—</h2><p>åœˆå¤æ‚åº¦ä¸èƒ½è¶…è¿‡6ï¼Œ3ä¸ªif else</p><h3 id="ç¼ºç‚¹-5"><a href="#ç¼ºç‚¹-5" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>çœ‹èµ·æ¥å¾ˆå¤æ‚</li></ul><h3 id="ä¼˜åŒ–-8"><a href="#ä¼˜åŒ–-8" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ul><li>æŠ½æ–¹æ³•</li><li>ä½¿ç”¨å¤šæ€</li></ul><h2 id="5-10-è¿‡å¤šçš„æ³¨é‡Š"><a href="#5-10-è¿‡å¤šçš„æ³¨é‡Š" class="headerlink" title="5.10 è¿‡å¤šçš„æ³¨é‡Š"></a>5.10 è¿‡å¤šçš„æ³¨é‡Š</h2><h3 id="ç¼ºç‚¹-6"><a href="#ç¼ºç‚¹-6" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>å¾ˆå¤šæ³¨é‡Šçš„å­˜åœ¨æ˜¯å› ä¸ºä»£ç å¾ˆç³Ÿç³•</p><h3 id="ä¼˜åŒ–-9"><a href="#ä¼˜åŒ–-9" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ul><li><p>æ–¹æ³•å‡½æ•°ã€å˜é‡çš„<strong>å‘½åè¦è§„èŒƒã€æµ…æ˜¾æ˜“æ‡‚</strong>ã€é¿å…ç”¨æ³¨é‡Šè§£é‡Šä»£ç ã€‚</p></li><li><p><strong>å…³é”®ã€å¤æ‚çš„ä¸šåŠ¡</strong>ï¼Œä½¿ç”¨<strong>æ¸…æ™°ã€ç®€æ˜</strong>çš„æ³¨é‡Š</p></li></ul><h2 id="5-11-magicå˜é‡"><a href="#5-11-magicå˜é‡" class="headerlink" title="5.11 magicå˜é‡"></a>5.11 magicå˜é‡</h2><h3 id="ç¼ºç‚¹-7"><a href="#ç¼ºç‚¹-7" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>çœ‹äº†ä»¤äººè¿·æƒ‘</li></ul><p>å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;3&quot;</span>.equals(emndVo.getStatus())) &#123;&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (allId.size() &lt;= <span class="hljs-number">500</span>) <br></code></pre></td></tr></table></figure><h3 id="ä¼˜åŒ–-10"><a href="#ä¼˜åŒ–-10" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ul><li><strong>æ–°å»ºä¸ªå¸¸é‡</strong></li><li><strong>å»ºä¸€ä¸ªæšä¸¾ç±»</strong>ï¼ŒæŠŠç›¸å…³çš„é­”æ³•æ•°å­—æ”¾åˆ°ä¸€èµ·ç®¡ç†ã€‚</li></ul><h2 id="5-12"><a href="#5-12" class="headerlink" title="5.12"></a>5.12</h2><h1 id="6-å…¶ä»–æå‡ä»£ç å¯è¯»æ€§çš„æ–¹å¼"><a href="#6-å…¶ä»–æå‡ä»£ç å¯è¯»æ€§çš„æ–¹å¼" class="headerlink" title="6 å…¶ä»–æå‡ä»£ç å¯è¯»æ€§çš„æ–¹å¼"></a>6 å…¶ä»–æå‡ä»£ç å¯è¯»æ€§çš„æ–¹å¼</h1><h3 id="6-1-Introduce-Explaining-Variableï¼ˆå¼•å…¥è§£é‡Šæ€§å˜é‡ï¼‰"><a href="#6-1-Introduce-Explaining-Variableï¼ˆå¼•å…¥è§£é‡Šæ€§å˜é‡ï¼‰" class="headerlink" title="6.1 Introduce Explaining Variableï¼ˆå¼•å…¥è§£é‡Šæ€§å˜é‡ï¼‰"></a>6.1 Introduce Explaining Variableï¼ˆå¼•å…¥è§£é‡Šæ€§å˜é‡ï¼‰</h3><ul><li>å°†è¯¥å¤æ‚è¡¨è¾¾å¼ï¼ˆæˆ–å…¶ä¸­ä¸€éƒ¨åˆ†ï¼‰çš„ç»“æœæ”¾è¿›ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œä»¥æ­¤å˜é‡åç§°æ¥è§£é‡Šè¡¨è¾¾å¼ç”¨é€”ã€‚</li><li>è¡¨è¾¾å¼æœ‰å¯èƒ½éå¸¸å¤æ‚è€Œéš¾ä»¥é˜…è¯»ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä¸´æ—¶å˜é‡å¯ä»¥å¸®åŠ©ä½ å°†è¡¨è¾¾å¼åˆ†è§£ä¸ºæ¯”è¾ƒå®¹æ˜“ç®¡ç†çš„å½¢å¼ã€‚</li></ul><h3 id="6-2-ä½¿ç”¨pair"><a href="#6-2-ä½¿ç”¨pair" class="headerlink" title="6.2 ä½¿ç”¨pair"></a>6.2 ä½¿ç”¨pair</h3><h1 id="7-æ„å»ºå•å…ƒæµ‹è¯•"><a href="#7-æ„å»ºå•å…ƒæµ‹è¯•" class="headerlink" title="7 æ„å»ºå•å…ƒæµ‹è¯•"></a>7 æ„å»ºå•å…ƒæµ‹è¯•</h1>]]></content>
    
    
    <categories>
      
      <category>ä»£ç ä¹‹ä¸‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é‡æ„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>reactåŸºç¡€</title>
    <link href="/react%E5%9F%BA%E7%A1%80/"/>
    <url>/react%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h1 id="reactç»„ä»¶åŸºç¡€"><a href="#reactç»„ä»¶åŸºç¡€" class="headerlink" title="reactç»„ä»¶åŸºç¡€"></a>reactç»„ä»¶åŸºç¡€</h1><h2 id="ç»„ä»¶æ¦‚å¿µ"><a href="#ç»„ä»¶æ¦‚å¿µ" class="headerlink" title="ç»„ä»¶æ¦‚å¿µ"></a>ç»„ä»¶æ¦‚å¿µ</h2><ul><li>ä½¿ç”¨ React å¯ä»¥å°†ä¸€äº›ç®€çŸ­ã€ç‹¬ç«‹çš„ä»£ç ç‰‡æ®µç»„åˆæˆå¤æ‚çš„ UI ç•Œé¢ï¼Œè¿™äº›ä»£ç ç‰‡æ®µè¢«ç§°ä½œâ€œç»„ä»¶â€ã€‚</li><li>æ‰€è°“ç»„ä»¶ï¼Œå³å°è£…èµ·æ¥çš„å…·æœ‰ç‹¬ç«‹åŠŸèƒ½çš„UIéƒ¨ä»¶ã€‚ç»„ä»¶å°±æ˜¯é¡µé¢ä¸Šçš„ä¸€éƒ¨åˆ†ï¼Œå¤§å¤§å°å°çš„å„ç§ç»„ä»¶æ‹¼åœ¨ä¸€èµ·å°±å˜æˆäº†ä¸€ä¸ªå®Œæ•´çš„é¡µé¢ï¼Œå°±åƒæˆ‘ä»¬ç©çš„æ‹¼å›¾ï¼Œéœ€è¦ä¸€å—ä¸€å—çš„æ‹¼æ¥åœ¨ä¸€èµ·æ‰èƒ½å˜æˆä¸€å‰¯å®Œæ•´çš„æ‹¼å›¾ã€‚</li></ul><h2 id="å‡½æ•°ç»„ä»¶"><a href="#å‡½æ•°ç»„ä»¶" class="headerlink" title="å‡½æ•°ç»„ä»¶"></a>å‡½æ•°ç»„ä»¶</h2><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><p>ä½¿ç”¨ JS çš„å‡½æ•°ï¼ˆæˆ–ç®­å¤´å‡½æ•°ï¼‰åˆ›å»ºçš„ç»„ä»¶ï¼Œå°±å«åš<code>å‡½æ•°ç»„ä»¶</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs react">function HelloComponent()&#123;<br>  return (<br>    &lt;div&gt;hello Componnet&lt;/div&gt;<br>  )<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>ç»„ä»¶çš„åç§°<strong>å¿…é¡»é¦–å­—æ¯å¤§å†™</strong>ï¼Œreactå†…éƒ¨ä¼šæ ¹æ®è¿™ä¸ªæ¥åˆ¤æ–­æ˜¯ç»„ä»¶è¿˜æ˜¯æ™®é€šçš„HTMLæ ‡ç­¾</p></li><li><p>å‡½æ•°ç»„ä»¶<strong>å¿…é¡»æœ‰è¿”å›å€¼</strong>ï¼Œè¡¨ç¤ºè¯¥ç»„ä»¶çš„ UI ç»“æ„ï¼›å¦‚æœä¸éœ€è¦æ¸²æŸ“ä»»ä½•å†…å®¹ï¼Œåˆ™è¿”å› null</p></li><li><p>ç»„ä»¶å°±åƒ HTML æ ‡ç­¾ä¸€æ ·å¯ä»¥è¢«æ¸²æŸ“åˆ°é¡µé¢ä¸­ã€‚ç»„ä»¶è¡¨ç¤ºçš„æ˜¯ä¸€æ®µç»“æ„å†…å®¹ï¼Œå¯¹äºå‡½æ•°ç»„ä»¶æ¥è¯´ï¼Œæ¸²æŸ“çš„å†…å®¹æ˜¯å‡½æ•°çš„<strong>è¿”å›å€¼</strong>å°±æ˜¯å¯¹åº”çš„å†…å®¹</p></li><li><p>ä½¿ç”¨å‡½æ•°åç§°ä½œä¸ºç»„ä»¶æ ‡ç­¾åç§°ï¼Œå¯ä»¥æˆå¯¹å‡ºç°ä¹Ÿå¯ä»¥è‡ªé—­åˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs react">function App() &#123;<br>  return (<br>    &lt;div&gt;<br>    &lt;HelloComponent/&gt;<br>    &lt;HelloComponent&gt;&lt;/HelloComponent&gt;<br>    &lt;/div&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h2 id="ç±»ç»„ä»¶"><a href="#ç±»ç»„ä»¶" class="headerlink" title="ç±»ç»„ä»¶"></a>ç±»ç»„ä»¶</h2><p>ä½¿ç”¨ ES6 çš„ class åˆ›å»ºçš„ç»„ä»¶ï¼Œå«åšç±»ï¼ˆclassï¼‰ç»„ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs react">class HelloComponent2 extends React.Component&#123;<br>  //å¿…é¡»æœ‰ä¸€ä¸ªrenderæ–¹æ³•<br>  //åœ¨è¿™ä¸ªæ–¹æ³•é‡Œæœ‰return UI ç»“æ„<br>  render()&#123;<br>    return (<br>      &lt;div&gt;hello Componnet2&lt;/div&gt;<br>    )<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong>ç±»åç§°ä¹Ÿå¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´</strong></li><li>ç±»ç»„ä»¶åº”è¯¥ç»§æ‰¿ React.Component çˆ¶ç±»ï¼Œä»è€Œä½¿ç”¨çˆ¶ç±»ä¸­æä¾›çš„æ–¹æ³•æˆ–å±æ€§</li><li>ç±»ç»„ä»¶å¿…é¡»æä¾› render æ–¹æ³•<strong>render æ–¹æ³•å¿…é¡»æœ‰è¿”å›å€¼ï¼Œè¡¨ç¤ºè¯¥ç»„ä»¶çš„ UI ç»“æ„</strong></li></ul><h2 id="äº‹ä»¶ç»‘å®š"><a href="#äº‹ä»¶ç»‘å®š" class="headerlink" title="äº‹ä»¶ç»‘å®š"></a>äº‹ä»¶ç»‘å®š</h2><p>reactäº‹ä»¶é‡‡ç”¨é©¼å³°å‘½åæ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs react">// äº‹ä»¶è§¦å‘å‡½æ•°ç»„ä»¶<br>function EventDemoClass1()&#123;<br>  function handle()&#123;<br>    console.log(&quot;äº‹ä»¶è§¦å‘äº†EventDemoClass1&quot;)<br>  &#125;<br>  return (<br>    &lt;button onClick=&#123;handle&#125;&gt;äº‹ä»¶è§¦å‘å‡½æ•°ç»„ä»¶&lt;/button&gt;<br>  )<br>&#125;<br><br><br>//äº‹ä»¶è§¦å‘ç±»ç»„ä»¶<br>class EventDemoClass2 extends React.Component&#123;<br>  clickHandler = () =&gt; &#123;<br>    console.log(&quot;äº‹ä»¶è§¦å‘äº†EventDemoClass2&quot;)<br>  &#125;<br>  render()&#123;<br>    return (<br>      &lt;div&gt;<br>        &lt;button onClick=&#123;this.clickHandler&#125;&gt;äº‹ä»¶è§¦å‘ç±»ç»„ä»¶&lt;/button&gt;<br>      &lt;/div&gt;<br>    )<br>  &#125;<br>&#125;<br><br>// æ ¹ç»„ä»¶<br>function App() &#123;<br>  return (<br>    &lt;div&gt;<br>      &lt;EventDemoClass1&gt;&lt;/EventDemoClass1&gt;<br>     &lt;EventDemoClass2&gt;&lt;/EventDemoClass2&gt;<br>    &lt;/div&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç»„ä»¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¾èµ–æ··ä¹±</title>
    <link href="/%E4%BE%9D%E8%B5%96%E6%B7%B7%E4%B9%B1/"/>
    <url>/%E4%BE%9D%E8%B5%96%E6%B7%B7%E4%B9%B1/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¾èµ–æ··ä¹±"><a href="#ä¾èµ–æ··ä¹±" class="headerlink" title="ä¾èµ–æ··ä¹±"></a>ä¾èµ–æ··ä¹±</h1>]]></content>
    
    
    <categories>
      
      <category>ä»£ç ä¹‹ä¸‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä»£ç åå‘³é“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å˜é‡çš„åˆå§‹åŒ–</title>
    <link href="/%E5%8F%98%E9%87%8F%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96/"/>
    <url>/%E5%8F%98%E9%87%8F%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="å˜é‡åˆå§‹åŒ–"><a href="#å˜é‡åˆå§‹åŒ–" class="headerlink" title="å˜é‡åˆå§‹åŒ–"></a>å˜é‡åˆå§‹åŒ–</h1><blockquote><ul><li><p><strong>é‡æ„æ‰‹æ³•</strong></p><ul><li><p>å˜é‡åˆå§‹åŒ–æœ€å¥½ä¸€æ¬¡å®Œæˆ</p></li><li><blockquote><p>èƒ½ç”¨finalçš„åœ°æ–¹å»ºè®®éƒ½ç”¨finalï¼ŒåŒ…æ‹¬å˜é‡å£°æ˜ï¼Œå‚æ•°å£°æ˜ï¼Œç±»å£°æ˜ï¼Œæ–¹æ³•å£°æ˜</p></blockquote></li></ul></li></ul></blockquote><h3 id="æ¡ˆä¾‹1"><a href="#æ¡ˆä¾‹1" class="headerlink" title="æ¡ˆä¾‹1"></a>æ¡ˆä¾‹1</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">EpubStatus status = <span class="hljs-keyword">null</span>;<br>CreateEpubResponse response = createEpub(request);<br><span class="hljs-keyword">if</span> (response.getCode() == <span class="hljs-number">201</span>) &#123;<br>  status = EpubStatus.CREATED;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  status = EpubStatus.TO_CREATE;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>é—®é¢˜ï¼šç¬¬ä¸€è¡Œçš„åˆå§‹åŒ–æ²¡æœ‰æ„ä¹‰ï¼Œä»–çœŸæ­£æœ‰å€¼æ˜¯åœ¨ç¬¬4è¡Œæˆ–è€…ç¬¬6è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´å£°æ˜å˜é‡åå¾ˆä¹…æ‰èµ‹å€¼ã€‚å˜é‡åˆå§‹åŒ–å’Œä¸šåŠ¡æ··åœ¨äº†ä¸€èµ·ï¼Œæˆ‘ä»¬åªæœ‰åœ¨ä¸€å¤§å †é€»è¾‘ä¸­æŠ½ä¸å‰¥èŒ§ï¼Œæ‰å¯ä»¥çŸ¥é“å˜é‡æ˜¯å¦‚ä½•åˆå§‹åŒ–çš„ã€‚</li><li>ä¿®æ­£ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">final</span> CreateEpubResponse response = createEpub(request);<br><span class="hljs-keyword">final</span> EpubStatus status = toEpubStatus(response);<br><br><span class="hljs-function"><span class="hljs-keyword">private</span> EpubStatus <span class="hljs-title">toEpubStatus</span><span class="hljs-params">(<span class="hljs-keyword">final</span> CreateEpubResponse response)</span> </span>&#123;<br>  <span class="hljs-keyword">if</span> (response.getCode() == <span class="hljs-number">201</span>) &#123;<br>    <span class="hljs-keyword">return</span> EpubStatus.CREATED;<br>  &#125;<br>  <span class="hljs-keyword">return</span> EpubStatus.TO_CREATE;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ¡ˆä¾‹2ï¼ˆå¼‚å¸¸å¤„ç†ï¼‰"><a href="#æ¡ˆä¾‹2ï¼ˆå¼‚å¸¸å¤„ç†ï¼‰" class="headerlink" title="æ¡ˆä¾‹2ï¼ˆå¼‚å¸¸å¤„ç†ï¼‰"></a>æ¡ˆä¾‹2ï¼ˆå¼‚å¸¸å¤„ç†ï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">InputStream is = <span class="hljs-keyword">null</span>;<br><br><span class="hljs-keyword">try</span> &#123;<br>  is = <span class="hljs-keyword">new</span> FileInputStream(...);<br>  ...<br>&#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>  ...<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>  <span class="hljs-keyword">if</span> (is != <span class="hljs-keyword">null</span>) &#123;<br>    is.close(); <br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡ŒæŠŠiså•ç‹¬å£°æ˜ï¼Œæ˜¯ä¸ºäº†åœ¨finallyé‡Œé¢å¯ä»¥è®¿é—®åˆ°ï¼Œåœ¨æ—©æœŸçš„ç‰ˆæœ¬åªèƒ½å†™æˆè¿™æ ·ï¼Œjava7ä¹‹åçš„ç‰ˆæœ¬ï¼Œå¯ä»¥é‡‡ç”¨<code>try-with-resource</code></p><p>çš„å†™æ³•ï¼Œä»£ç æ›´åŠ ç®€æ´ã€‚</p><p>ä¿®æ­£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span> (InputStream is = <span class="hljs-keyword">new</span> FileInputStream(...)) &#123;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ¡ˆä¾‹3-é›†åˆåˆå§‹åŒ–"><a href="#æ¡ˆä¾‹3-é›†åˆåˆå§‹åŒ–" class="headerlink" title="æ¡ˆä¾‹3 é›†åˆåˆå§‹åŒ–"></a>æ¡ˆä¾‹3 é›†åˆåˆå§‹åŒ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;Locale, String&gt; CODE_MAPPING = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>...<br><br><br><span class="hljs-keyword">static</span> &#123;<br>  CODE_MAPPING.put(LOCALE.ENGLISH, <span class="hljs-string">&quot;EN&quot;</span>);<br>  CODE_MAPPING.put(LOCALE.CHINESE, <span class="hljs-string">&quot;CH&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>é—®é¢˜ï¼š éš”äº†å¾ˆä¹…åæ‰å‘è¿™ä¸ªé›†åˆä¸­æ·»åŠ å…ƒç´ ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€æ¬¡æ€§å£°æ˜çš„æ–¹å¼ï¼Œè¿™ä¸ªstaticå—æ˜¯ä¸éœ€è¦çš„</p><p>ä¿®æ­£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;Locale, String&gt; CODE_MAPPING = ImmutableMap.of(<br>  LOCALE.ENGLISH, <span class="hljs-string">&quot;EN&quot;</span>,<br>  LOCALE.CHINESE, <span class="hljs-string">&quot;CH&quot;</span><br>);<br></code></pre></td></tr></table></figure><blockquote><p>å‰è€…æ˜¯å‘½ä»¤å¼çš„ä»£ç ï¼Œå‘Šè¯‰ä½ â€œæ€ä¹ˆåšâ€ï¼Œæ¯”å¦‚å…ˆåˆ›å»ºä¸€ä¸ªé›†åˆï¼Œé›†åˆä¸­æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå†æ·»åŠ ä¸€ä¸ªå…ƒç´ ã€‚</p><p>åè€…æ˜¯å£°æ˜å¼ä»£ç ï¼Œå‘Šè¯‰ä½ â€œåšä»€ä¹ˆâ€ï¼Œæ¯”å¦‚æˆ‘è¦ä¸€ä¸ªåŒ…å«äº†è¿™ä¸¤ä¸ªå…ƒç´ çš„é›†åˆã€‚</p></blockquote><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0xl4gnkf5j20u011vn0m.jpg" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>ä»£ç ä¹‹ä¸‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä»£ç åå‘³é“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¼«å¤©é£çš„setter</title>
    <link href="/%E6%BC%AB%E5%A4%A9%E9%A3%9E%E7%9A%84setter/"/>
    <url>/%E6%BC%AB%E5%A4%A9%E9%A3%9E%E7%9A%84setter/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¼«å¤©é£çš„setter"><a href="#æ¼«å¤©é£çš„setter" class="headerlink" title="æ¼«å¤©é£çš„setter"></a>æ¼«å¤©é£çš„setter</h1><blockquote><ul><li><strong>é‡æ„æ‰‹æ³•</strong>ï¼š<ul><li>æ–¹æ³•å°è£…åœ¨å¯¹åº”çš„æ¨¡å‹ä¸­  </li><li>ä½¿ç”¨æ„é€ å‡½æ•°ï¼Œç§»é™¤è®¾å€¼å‡½æ•°ã€‚</li><li>ç¼–å†™ä¸å˜ç±»</li></ul></li></ul></blockquote><h3 id="æ¡ˆä¾‹1"><a href="#æ¡ˆä¾‹1" class="headerlink" title="æ¡ˆä¾‹1"></a>æ¡ˆä¾‹1</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">approve</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> bookId)</span> </span>&#123;<br>  ...<br>  book.setReviewStatus(ReviewStatus.APPROVED);<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>é—®é¢˜ï¼šä½¿ç”¨åˆ°äº†setter, setterå¾€å¾€æ˜¯ç¼ºä¹å°è£…çš„ä¸€ç§åšæ³•ã€‚ä½ ä¸çŸ¥é“æ•°æ®ä¼šåœ¨ä½•æ—¶è¢«å“ªé‡Œä¿®æ”¹ï¼Œé€ æˆç»“æœæ˜¯åˆ«äººçš„æ”¹åŠ¨å¯èƒ½ä¼šä½¿ä½ çš„ä»£ç å´©æºƒï¼ŒåŒæ—¶ä¼šæœ‰å¹¶å‘é—®é¢˜</li><li>ä¿®æ­£ï¼šä½¿ç”¨å‡½æ•°å°è£…äº†setteræ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">approve</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> bookId)</span> </span>&#123;<br>  ...<br>  book.approve();<br>  ...<br>&#125; <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">approve</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">this</span>.reviewStatus = ReviewStatus.APPROVED;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>è¿›ä¸€æ­¥é‡æ„</strong></p><blockquote><p>é‡æ„æ‰‹æ³•ï¼šç¼–å†™ä¸å˜ç±»</p></blockquote><p>æ”¹é€ ä¹‹å‰çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> Book <span class="hljs-title">approve</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Book(..., ReviewStatus.APPROVED, ...);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ¡ˆä¾‹2"><a href="#æ¡ˆä¾‹2" class="headerlink" title="æ¡ˆä¾‹2"></a>æ¡ˆä¾‹2</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">Book book = <span class="hljs-keyword">new</span> Book();<br>book.setBookId(bookId);<br>book.setTitle(title);<br>book.setIntroduction(introduction);<br></code></pre></td></tr></table></figure><ul><li><p>é—®é¢˜ï¼šè¿™ç§åˆå§‹åŒ–çš„ä»£ç ï¼Œå‹æ ¹æ²¡å¿…è¦ä»¥setterçš„æ–¹å¼å­˜åœ¨</p></li><li><p>ä¿®æ­£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Book book = <span class="hljs-keyword">new</span> Book(bookId, title, introduction);<br></code></pre></td></tr></table></figure></li></ul><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0um32zjp7j20u01560x5.jpg" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>ä»£ç ä¹‹ä¸‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä»£ç åå‘³é“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¿‡é•¿çš„æ¶ˆæ¯é“¾å’ŒåŸºæœ¬ç±»å‹çš„åæ‰§</title>
    <link href="/%E8%BF%87%E9%95%BF%E7%9A%84%E6%B6%88%E6%81%AF%E9%93%BE%E5%92%8C%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%81%8F%E6%89%A7/"/>
    <url>/%E8%BF%87%E9%95%BF%E7%9A%84%E6%B6%88%E6%81%AF%E9%93%BE%E5%92%8C%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%81%8F%E6%89%A7/</url>
    
    <content type="html"><![CDATA[<h1 id="è¿‡é•¿çš„æ¶ˆæ¯é“¾"><a href="#è¿‡é•¿çš„æ¶ˆæ¯é“¾" class="headerlink" title="è¿‡é•¿çš„æ¶ˆæ¯é“¾"></a>è¿‡é•¿çš„æ¶ˆæ¯é“¾</h1><blockquote><p>æƒ³è¦æ‘†è„±åˆçº§ç¨‹åºå‘˜çš„æ°´å¹³ï¼Œé¦–å…ˆéœ€è¦å‡å°‘æš´éœ²ç»†èŠ‚</p></blockquote><blockquote><p>è¿ªç±³ç‰¹æ³•åˆ™</p><ul><li>æ¯ä¸ªå•å…ƒåªèƒ½å¯¹ä¸ä»–æœ‰ç´§å¯†å…³ç³»çš„å•å…ƒï¼Œæ‹¥æœ‰æœ‰é™çš„çŸ¥è¯†</li><li>æ¯ä¸ªå•å…ƒåªèƒ½å’Œæœ‹å‹äº¤è°ˆï¼Œä¸ä¸é™Œç”Ÿäººäº¤è°ˆ</li><li>æ¯ä¸ªå•å…ƒåªèƒ½å’Œè‡ªå·±æœ€ç›´æ¥çš„æœ‹å‹äº¤è°ˆ</li></ul></blockquote><h2 id="æ¡ˆä¾‹1"><a href="#æ¡ˆä¾‹1" class="headerlink" title="æ¡ˆä¾‹1"></a>æ¡ˆä¾‹1</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">String name = book.getAuthor().getName();<br></code></pre></td></tr></table></figure><p>ä¿®æ­£æ–¹å¼ï¼šéšè—å§”æ‰˜å…³ç³»ï¼Œå³æŠŠè°ƒç”¨å°è£…èµ·æ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> </span>&#123;<br>  ...<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getAuthorName</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.author.getName();<br>  &#125;<br>  ...<br>&#125;<br><br><br>String name = book.getAuthorName();<br></code></pre></td></tr></table></figure><h1 id="åŸºæœ¬ç±»å‹åæ‰§"><a href="#åŸºæœ¬ç±»å‹åæ‰§" class="headerlink" title="åŸºæœ¬ç±»å‹åæ‰§"></a>åŸºæœ¬ç±»å‹åæ‰§</h1><blockquote><p> <strong>é‡æ„æ‰‹æ³•ï¼šä»¥å¯¹è±¡å–ä»£åŸºæœ¬ç±»å‹</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getEpubPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> highQuality, <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> chapterSequence)</span> </span>&#123;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><p>é—®é¢˜ï¼šè™½ç„¶ä»·æ ¼æ˜¯ç”¨æµ®ç‚¹æ•°åœ¨å­˜å‚¨ï¼Œä½†æ˜¯ä»·æ ¼å’Œæµ®ç‚¹æ•°æœ¬èº«å¹¶ä¸æ˜¯åŒä¸€ä¸ªæ¦‚å¿µã€‚</p><p><strong>éœ€æ±‚1</strong>: </p><p>ä»·æ ¼å¤§äº0ï¼Œå¦‚æœä½¿ç”¨äº†doubleæ¥å­˜å‚¨ï¼Œä½ ä¼šæ€ä¹ˆé™åˆ¶å‘¢ï¼Ÿé€šå¸¸ä¼šè¿™æ ·</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (price &lt;= <span class="hljs-number">0</span>) &#123;<br>  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Price should be positive&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ç§æ ¡éªŒä¼šæ˜¯å¾ˆå¤šåœºæ™¯éƒ½éœ€è¦çš„ï¼Œå› æ­¤ç±»ä¼¼çš„é€»è¾‘éœ€è¦å¤§é‡å»é‡å¤çš„å†™ã€‚</p><p>å‡è®¾è¿™é‡Œå¼•å…¥äº†priceæ¨¡å‹ä¼šæ˜¯æ€æ ·å‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Price</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> price;<br>  <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Price</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> price)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (price &lt;= <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Price should be positive&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">this</span>.price = price;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ ·æ ¡éªŒå°±å¯ä»¥æ”¾åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¿›è¡Œäº†ã€‚</p><blockquote><p>è¿™ç§æ‰‹æ³•å«åšå¯¹è±¡å–ä»£åŸºæœ¬æ¨¡å‹ã€‚</p></blockquote><p><strong>éœ€æ±‚2:</strong></p><p>å‡è®¾æˆ‘ä»¬å¸Œæœ›ä»·æ ¼å¯¹å¤–åªå‘ˆç°2ä½ã€‚</p><p>æ²¡æœ‰priceè¿™ä¸ªæ¨¡å‹çš„è¯ ï¼Œä¾æ—§ä¼šæ˜¯æ•£å¸ƒåœ¨ä»£ç çš„å„ä¸ªåœ°æ–¹ï¼Œä¸€æ—¦æœ‰äº†è¿™ä¸ªæ¨¡å‹ï¼Œä»£ç å°±ç®€å•å¤šäº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getDisplayPrice</span><span class="hljs-params">()</span> </span>&#123;<br>  BigDecimal decimal = <span class="hljs-keyword">new</span> BigDecimal(<span class="hljs-keyword">this</span>.price)ï¼›<br>  <span class="hljs-keyword">return</span> decimal.setScale(<span class="hljs-number">2</span>, BigDecimal.ROUND_HALF_UP).doubleValue();<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0ulmqnc59j20u014cq73.jpg" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>ä»£ç ä¹‹ä¸‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä»£ç åå‘³é“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ»¥ç”¨æ§åˆ¶è¯­å¥</title>
    <link href="/%E6%BB%A5%E7%94%A8%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5/"/>
    <url>/%E6%BB%A5%E7%94%A8%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="é¿å…æ»¥ç”¨æ§åˆ¶è¯­å¥"><a href="#é¿å…æ»¥ç”¨æ§åˆ¶è¯­å¥" class="headerlink" title="é¿å…æ»¥ç”¨æ§åˆ¶è¯­å¥"></a>é¿å…æ»¥ç”¨æ§åˆ¶è¯­å¥</h1><blockquote><p><strong>å‡½æ•°è‡³å¤šæœ‰ä¸€è¡Œé”è¿›</strong></p></blockquote><blockquote><p>ä¸è¦ç”¨elseå…³é”®å­—</p></blockquote><h2 id="ä»£ç å¤šå±‚åµŒå¥—"><a href="#ä»£ç å¤šå±‚åµŒå¥—" class="headerlink" title="ä»£ç å¤šå±‚åµŒå¥—"></a>ä»£ç å¤šå±‚åµŒå¥—</h2><h3 id="ifå’Œelse"><a href="#ifå’Œelse" class="headerlink" title="ifå’Œelse"></a>ifå’Œelse</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getEpubPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> highQuality, <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> chapterSequence)</span> </span>&#123;<br>  <span class="hljs-keyword">double</span> price = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> (highQuality &amp;&amp; chapterSequence &gt; START_CHARGING_SEQUENCE) &#123;<br>    price = <span class="hljs-number">4.99</span>;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sequenceNumber &gt; START_CHARGING_SEQUENCE<br>        &amp;&amp; sequenceNumber &lt;= FURTHER_CHARGING_SEQUENCE) &#123;<br>    price = <span class="hljs-number">1.99</span>;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sequenceNumber &gt; FURTHER_CHARGING_SEQUENCE) &#123;<br>    price = <span class="hljs-number">2.99</span>;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    price = <span class="hljs-number">0.99</span>;<br>  &#125;<br>  <br>  <span class="hljs-keyword">return</span> price;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¿®æ­£ï¼šæ¶ˆé™¤elseï¼Œä¸€ä¸ªç®€å•çš„åšæ³•å°±æ˜¯è®©é€»è¾‘æå‰è¿”å›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getEpubPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> highQuality, <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> chapterSequence)</span> </span>&#123;<br>  <span class="hljs-keyword">if</span> (highQuality &amp;&amp; chapterSequence &gt; START_CHARGING_SEQUENCE) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">4.99</span>;<br>  &#125; <br>  <br>  <span class="hljs-keyword">if</span> (sequenceNumber &gt; START_CHARGING_SEQUENCE<br>        &amp;&amp; sequenceNumber &lt;= FURTHER_CHARGING_SEQUENCE) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1.99</span>;<br>  &#125; <br><br><br>  <span class="hljs-keyword">if</span> (sequenceNumber &gt; FURTHER_CHARGING_SEQUENCE) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">2.99</span>;<br>  &#125; <br><br><br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0.99</span>;<br></code></pre></td></tr></table></figure><h2 id="é‡å¤çš„switch"><a href="#é‡å¤çš„switch" class="headerlink" title="é‡å¤çš„switch"></a>é‡å¤çš„switch</h2><p>ä¹‹æ‰€ä»¥å‡ºç°é‡å¤çš„switchï¼Œé€šå¸¸æ˜¯ç¼ºå°‘äº†æ¨¡å‹ï¼Œé‡æ„çš„æ–¹å¼æ˜¯ï¼š<strong>ä»¥å¤šæ€å–ä»£è¡¨è¾¾å¼</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getBookPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> User user, <span class="hljs-keyword">final</span> Book book)</span> </span>&#123;<br>  <span class="hljs-keyword">double</span> price = book.getPrice();<br>  <span class="hljs-keyword">switch</span> (user.getLevel()) &#123;<br>    <span class="hljs-keyword">case</span> UserLevel.SILVER:<br>      <span class="hljs-keyword">return</span> price * <span class="hljs-number">0.9</span>;<br>    <span class="hljs-keyword">case</span> UserLevel.GOLD: <br>      <span class="hljs-keyword">return</span> price * <span class="hljs-number">0.8</span>;<br>    <span class="hljs-keyword">case</span> UserLevel.PLATINUM:<br>      <span class="hljs-keyword">return</span> price * <span class="hljs-number">0.75</span>;<br>    <span class="hljs-keyword">default</span>:<br>      <span class="hljs-keyword">return</span> price;<br>  &#125;<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getEpubPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> User user, <span class="hljs-keyword">final</span> Epub epub)</span> </span>&#123;<br>  <span class="hljs-keyword">double</span> price = epub.getPrice();<br>  <span class="hljs-keyword">switch</span> (user.getLevel()) &#123;<br>    <span class="hljs-keyword">case</span> UserLevel.SILVER:<br>      <span class="hljs-keyword">return</span> price * <span class="hljs-number">0.95</span>;<br>    <span class="hljs-keyword">case</span> UserLevel.GOLD: <br>      <span class="hljs-keyword">return</span> price * <span class="hljs-number">0.85</span>;<br>    <span class="hljs-keyword">case</span> UserLevel.PLATINUM:<br>      <span class="hljs-keyword">return</span> price * <span class="hljs-number">0.8</span>;<br>    <span class="hljs-keyword">default</span>:<br>      <span class="hljs-keyword">return</span> price;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¿®æ­£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserLevel</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">getBookPrice</span><span class="hljs-params">(Book book)</span></span>;<br>  <span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">getEpubPrice</span><span class="hljs-params">(Epub epub)</span></span>;<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RegularUserLevel</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserLevel</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getBookPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Book book)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> book.getPrice();<br>  &#125;<br>  <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getEpubPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Epub epub)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> epub.getPrice();<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GoldUserLevel</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserLevel</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getBookPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Book book)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> book.getPrice() * <span class="hljs-number">0.8</span>;<br>  &#125;<br>  <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getEpubPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Epub epub)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> epub.getPrice() * <span class="hljs-number">0.85</span>;<br>  &#125;<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SilverUserLevel</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserLevel</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getBookPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Book book)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> book.getPrice() * <span class="hljs-number">0.9</span>;<br>  &#125;<br>  <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getEpubPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Epub epub)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> epub.getPrice() * <span class="hljs-number">0.85</span>;<br>  &#125;<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PlatinumUserLevel</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserLevel</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getBookPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Book book)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> book.getPrice() * <span class="hljs-number">0.75</span>;<br>  &#125;<br>  <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getEpubPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Epub epub)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> epub.getPrice() * <span class="hljs-number">0.8</span>; <br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getBookPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> User user, <span class="hljs-keyword">final</span> Book book)</span> </span>&#123;<br>  UserLevel level = user.getUserLevel()<br>  <span class="hljs-keyword">return</span> level.getBookPrice(book);<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getEpubPrice</span><span class="hljs-params">(<span class="hljs-keyword">final</span> User user, <span class="hljs-keyword">final</span> Epub epub)</span> </span>&#123;<br>  UserLevel level = user.getUserLevel()<br>  <span class="hljs-keyword">return</span> level.getEpubPrice(epub);<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0tg6oeum7j20u012242l.jpg" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>ä»£ç ä¹‹ä¸‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä»£ç åå‘³é“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é•¿å‚æ•°åˆ—è¡¨</title>
    <link href="/%E9%95%BF%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8/"/>
    <url>/%E9%95%BF%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¶ˆé™¤é•¿å‚æ•°åˆ—è¡¨"><a href="#æ¶ˆé™¤é•¿å‚æ•°åˆ—è¡¨" class="headerlink" title="æ¶ˆé™¤é•¿å‚æ•°åˆ—è¡¨"></a>æ¶ˆé™¤é•¿å‚æ•°åˆ—è¡¨</h1><ul><li><blockquote><p><strong>æˆ‘ä»¬åº”è¯¥ç¼–å†™â€œçŸ­å°â€çš„ä»£ç </strong></p></blockquote></li><li><blockquote><p> <strong>å‚æ•°åˆ—è¡¨è¶Šå°‘ï¼Œè¶Šå¥½</strong></p></blockquote></li><li><blockquote><p>**ä¸€ä¸ªæ–¹æ³•çš„ç¬¬ä¸€é€‰æ‹©æ˜¯æ²¡æœ‰å‚æ•°ï¼Œç¬¬äºŒä¸ªé€‰æ‹©æ˜¯åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œç¨æ¬¡æ˜¯ä¸¤ä¸ªå‚æ•°ã€‚ä¸‰ä¸ªä»¥ä¸Šçš„å‚æ•°ç®€ç›´æ— æ³•å¿å—ã€‚ **â€“ ä»£ç æ•´æ´ä¹‹é“</p></blockquote></li></ul><h2 id="å°†å‚æ•°åˆ—è¡¨å°è£…æˆå¯¹è±¡"><a href="#å°†å‚æ•°åˆ—è¡¨å°è£…æˆå¯¹è±¡" class="headerlink" title="å°†å‚æ•°åˆ—è¡¨å°è£…æˆå¯¹è±¡"></a>å°†å‚æ•°åˆ—è¡¨å°è£…æˆå¯¹è±¡</h2><h3 id="æ¡ˆä¾‹1"><a href="#æ¡ˆä¾‹1" class="headerlink" title="æ¡ˆä¾‹1"></a>æ¡ˆä¾‹1</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">createBook</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String title, </span></span><br><span class="hljs-params"><span class="hljs-function">                       <span class="hljs-keyword">final</span> String introduction,</span></span><br><span class="hljs-params"><span class="hljs-function">                       <span class="hljs-keyword">final</span> URL coverUrl,</span></span><br><span class="hljs-params"><span class="hljs-function">                       <span class="hljs-keyword">final</span> BookType type,</span></span><br><span class="hljs-params"><span class="hljs-function">                       <span class="hljs-keyword">final</span> BookChannel channel,</span></span><br><span class="hljs-params"><span class="hljs-function">                       <span class="hljs-keyword">final</span> String protagonists,</span></span><br><span class="hljs-params"><span class="hljs-function">                       <span class="hljs-keyword">final</span> String tags,</span></span><br><span class="hljs-params"><span class="hljs-function">                       <span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> completed)</span> </span>&#123;<br>  ...<br>  Book book = Book.builder<br>    .title(title) <br>    .introduction(introduction)<br>    .coverUrl(coverUrl)<br>    .type(type)<br>    .channel(channel)<br>    .protagonists(protagonists)<br>    .tags(tags)<br>    .completed(completed)<br>    .build();<br>    <br>  <span class="hljs-keyword">this</span>.repository.save(book);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¿®æ­£ï¼š</p><ul><li>å¢åŠ ä¸€ä¸ªå°è£…ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NewBookParamters</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> String title;<br>  <span class="hljs-keyword">private</span> String introduction;<br>  <span class="hljs-keyword">private</span> URL coverUrl;<br>  <span class="hljs-keyword">private</span> BookType type;<br>  <span class="hljs-keyword">private</span> BookChannel channel;<br>  <span class="hljs-keyword">private</span> String protagonists;<br>  <span class="hljs-keyword">private</span> String tags;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> completed;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">createBook</span><span class="hljs-params">(<span class="hljs-keyword">final</span> NewBookParamters parameters)</span> </span>&#123;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç§»é™¤æ ‡è®°å‚æ•°"><a href="#ç§»é™¤æ ‡è®°å‚æ•°" class="headerlink" title="ç§»é™¤æ ‡è®°å‚æ•°"></a>ç§»é™¤æ ‡è®°å‚æ•°</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">editChapter</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> chapterId, </span></span><br><span class="hljs-params"><span class="hljs-function">                        <span class="hljs-keyword">final</span> String title, </span></span><br><span class="hljs-params"><span class="hljs-function">                        <span class="hljs-keyword">final</span> String content, </span></span><br><span class="hljs-params"><span class="hljs-function">                        <span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> apporved)</span> </span>&#123;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><p>é—®é¢˜ï¼šå‰å‡ ä¸ªå‚æ•°éƒ½æ˜¯ç« èŠ‚çš„å¿…è¦ä¿¡æ¯ï¼Œåé¢apporvedæ˜¯æ ‡è®°æ˜¯å¦å®¡æ ¸é€šè¿‡ï¼Œè¿™ä¸ªå‚æ•°å…¶å®æ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œæ ‡è®°åé¢çš„æµç¨‹å¯èƒ½ä¸åŒã€‚</p><p>ä¿®æ­£ï¼šè¿™é‡Œæˆ‘ä»¬å¯ä»¥å°†å‚æ•°åˆ—è¡¨ä»£è¡¨çš„ä¸åŒè·¯å¾„æ‹†åˆ†å‡ºæ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">// æ™®é€šçš„ç¼–è¾‘ï¼Œéœ€è¦å®¡æ ¸</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">editChapter</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> chapterId, </span></span><br><span class="hljs-params"><span class="hljs-function">                        <span class="hljs-keyword">final</span> String title, </span></span><br><span class="hljs-params"><span class="hljs-function">                        <span class="hljs-keyword">final</span> String content)</span> </span>&#123;<br>  ...<br>&#125;<br><br><br><span class="hljs-comment">// ç›´æ¥å®¡æ ¸é€šè¿‡çš„ç¼–è¾‘</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">editChapterWithApproval</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> chapterId,</span></span><br><span class="hljs-params"><span class="hljs-function">                                    <span class="hljs-keyword">final</span> String title,</span></span><br><span class="hljs-params"><span class="hljs-function">                                    <span class="hljs-keyword">final</span> String content)</span> </span>&#123;<br> ...<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0tf9jp9lvj20u014kq7o.jpg" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>ä»£ç ä¹‹ä¸‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä»£ç åå‘³é“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¿å…å†™å‡ºéš¾ä»¥ç†è§£çš„å¤§ç±»</title>
    <link href="/%E9%81%BF%E5%85%8D%E5%86%99%E5%87%BA%E9%9A%BE%E4%BB%A5%E7%90%86%E8%A7%A3%E7%9A%84%E5%A4%A7%E7%B1%BB%20/"/>
    <url>/%E9%81%BF%E5%85%8D%E5%86%99%E5%87%BA%E9%9A%BE%E4%BB%A5%E7%90%86%E8%A7%A3%E7%9A%84%E5%A4%A7%E7%B1%BB%20/</url>
    
    <content type="html"><![CDATA[<h2 id="é¿å…å†™å‡ºéš¾ä»¥ç†è§£çš„å¤§ç±»"><a href="#é¿å…å†™å‡ºéš¾ä»¥ç†è§£çš„å¤§ç±»" class="headerlink" title="é¿å…å†™å‡ºéš¾ä»¥ç†è§£çš„å¤§ç±»"></a>é¿å…å†™å‡ºéš¾ä»¥ç†è§£çš„å¤§ç±»</h2><ul><li>åŸå› ï¼šä¸€ä¸ªäººç†è§£çš„ä¸œè¥¿æ˜¯æœ‰é™çš„ï¼Œæ²¡äººèƒ½é¢å¯¹æ‰€æœ‰çš„ç»†èŠ‚</li><li>å¤§ç±»çš„äº§ç”Ÿï¼š<ul><li>èŒè´£ä¸å•ä¸€ </li><li>å­—æ®µæœªåˆ†ç»„</li></ul></li><li>æ“ä½œè¦ç‚¹ï¼š<strong>æŠŠç±»å†™å°ï¼Œè¶Šå°è¶Šå¥½</strong></li></ul><h3 id="æ¡ˆä¾‹1"><a href="#æ¡ˆä¾‹1" class="headerlink" title="æ¡ˆä¾‹1:"></a>æ¡ˆä¾‹1:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> userId;<br>  <span class="hljs-keyword">private</span> String name;<br>  <span class="hljs-keyword">private</span> String nickname;<br>  <span class="hljs-keyword">private</span> String email;<br>  <span class="hljs-keyword">private</span> String phoneNumber;<br>  <span class="hljs-keyword">private</span> AuthorType authorType;<br>  <span class="hljs-keyword">private</span> ReviewStatus authorReviewStatus;<br>  <span class="hljs-keyword">private</span> EditorType editorType;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><p>é—®é¢˜ï¼šuserId,nameè¿™äº›æ˜¯å’Œç”¨æˆ·å…³è”çš„ï¼Œåé¢çš„AuthorTypeï¼ŒReviewStatusï¼ŒEditorTypeå’Œç”¨æˆ·ä¿¡æ¯æ— å…³</p><p>ä¿®æ­£ï¼šAuthorTypeï¼ŒReviewStatusï¼ŒEditorTypeå’Œç”¨æˆ·ä¿¡æ¯æ— å…³ æ‹†æˆå•ç‹¬çš„ç±»ï¼Œé€šè¿‡userIdå»å…³è”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Author</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> userId;<br>  <span class="hljs-keyword">private</span> AuthorType authorType;<br>  <span class="hljs-keyword">private</span> ReviewStatus authorReviewStatus;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Editor</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> userId;<br>  <span class="hljs-keyword">private</span> EditorType editorType;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ¡ˆä¾‹2"><a href="#æ¡ˆä¾‹2" class="headerlink" title="æ¡ˆä¾‹2"></a>æ¡ˆä¾‹2</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> userId;<br>  <span class="hljs-keyword">private</span> String name;<br>  <span class="hljs-keyword">private</span> String nickname;<br>  <span class="hljs-keyword">private</span> String email;<br>  <span class="hljs-keyword">private</span> String phoneNumber;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><p>é—®é¢˜ï¼šè¿™ä¸ªç±»ä¸­userIdï¼Œnameï¼Œnicknameæ˜¯å±äºç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œè€Œemailï¼ŒphoneNumberå…¶å®æ˜¯å±äºç”¨æˆ·çš„è”ç³»æ–¹å¼</p><p>ä¿®æ­£ï¼šå¯¹å­—æ®µè¿›è¡Œåˆ†ç»„ï¼ŒæŠŠemailï¼ŒphoneNumberæ”¾åœ¨å•ç‹¬çš„contactç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> userId;<br>  <span class="hljs-keyword">private</span> String name;<br>  <span class="hljs-keyword">private</span> String nickname;<br>  <span class="hljs-keyword">private</span> Contact contact;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Contact</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> String email;<br>  <span class="hljs-keyword">private</span> String phoneNumber;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0tekaz2v6j20u0144gow.jpg" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>ä»£ç ä¹‹ä¸‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä»£ç åå‘³é“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚ä½•ç²¾å‡†å‘½å</title>
    <link href="/%E4%BB%A3%E7%A0%81%E4%B9%8B%E4%B8%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/%E4%BB%A3%E7%A0%81%E4%B9%8B%E4%B8%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="å¦‚ä½•ç²¾å‡†å‘½å"><a href="#å¦‚ä½•ç²¾å‡†å‘½å" class="headerlink" title="å¦‚ä½•ç²¾å‡†å‘½å"></a>å¦‚ä½•ç²¾å‡†å‘½å</h1><h2 id="é¿å…å‘½åè¿‡äºå®½æ³›"><a href="#é¿å…å‘½åè¿‡äºå®½æ³›" class="headerlink" title="é¿å…å‘½åè¿‡äºå®½æ³›"></a>é¿å…å‘½åè¿‡äºå®½æ³›</h2><h3 id="æ¡ˆä¾‹1"><a href="#æ¡ˆä¾‹1" class="headerlink" title="æ¡ˆä¾‹1"></a>æ¡ˆä¾‹1</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processChapter</span><span class="hljs-params">(<span class="hljs-keyword">long</span> chapterId)</span> </span>&#123;<br>  Chapter chapter = <span class="hljs-keyword">this</span>.repository.findByChapterId(chapterId);<br>  <span class="hljs-keyword">if</span> (chapter == <span class="hljs-keyword">null</span>) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Unknown chapter [&quot;</span> + chapterId + <span class="hljs-string">&quot;]&quot;</span>);  <br>  &#125;<br>  <br>  chapter.setTranslationState(TranslationState.TRANSLATING);<br>  <span class="hljs-keyword">this</span>.repository.save(chapter);<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>é—®é¢˜ï¼šå‘½åè¿‡äºå®½æ³›ï¼Œä¸èƒ½ç²¾å‡†æè¿°ï¼Œåªæœ‰é˜…è¯»è¿™æ®µä»£ç ï¼Œæ‰å¯ä»¥çŸ¥é“è¿™æ®µä»£ç åšäº†ä»€ä¹ˆã€‚</p></li><li><p>ä¿®æ­£ï¼šå…·ä½“åˆ°è¿™é‡Œçš„ä¸šåŠ¡ï¼Œå…¶å®æ˜¯æŠŠç¿»è¯‘çŠ¶æ€æ”¹ä¸ºäº†ç¿»è¯‘ä¸­ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨è¿™é‡Œå¼€å¯äº†ä¸€ä¸ªç¿»è¯‘è¿‡ç¨‹ï¼Œæ‰€ä»¥è¿™æ®µä»£ç åº”è¯¥å‘½åä¸ºsatrtTranslation</p></li></ul><blockquote><p> ç±»ä¼¼çš„ï¼šdata,info,handle,build,maintain,modifyç­‰ç­‰ï¼Œéƒ½æ˜¯è¿‡äºå®½æ³›çš„åè¯</p></blockquote><blockquote><p>ä¸€ä¸ªå¥½çš„åå­—ï¼Œåº”è¯¥æè¿°æ„å›¾ï¼Œè€Œä¸æ˜¯ç»†èŠ‚ã€‚</p></blockquote><h2 id="é¿å…ä½¿ç”¨æŠ€æœ¯æœ¯è¯­å‘½å"><a href="#é¿å…ä½¿ç”¨æŠ€æœ¯æœ¯è¯­å‘½å" class="headerlink" title="é¿å…ä½¿ç”¨æŠ€æœ¯æœ¯è¯­å‘½å"></a>é¿å…ä½¿ç”¨æŠ€æœ¯æœ¯è¯­å‘½å</h2><h3 id="æ¡ˆä¾‹1-1"><a href="#æ¡ˆä¾‹1-1" class="headerlink" title="æ¡ˆä¾‹1"></a>æ¡ˆä¾‹1</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;Book&gt; bookList = service.getBooks();<br></code></pre></td></tr></table></figure><ul><li>é—®é¢˜ï¼šè¿™æ˜¯ä¸€ç§åŸºäºå®ç°çš„å‘½åï¼Œç¼–ç¨‹çš„ä¸€ä¸ªé‡è¦åŸåˆ™æ˜¯é¢å‘æ¥å£ç¼–ç¨‹ã€‚å³æ¥å£æ˜¯ç¨³å®šçš„ï¼Œå®ç°æ˜¯æ˜“å˜çš„ã€‚å‡è®¾è¿™é‡Œæˆ‘ç°åœ¨éœ€è¦çš„æ˜¯ä¸€ä¸ªä¸é‡å¤çš„ä½œå“é›†åˆï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œéœ€è¦æŠŠListæ”¹æˆSetï¼Œå˜é‡ç±»å‹ä¸€å®šä¼šæ”¹ï¼Œä½†æ˜¯ä½ ä¸ä¸€å®šä¼šè®°å¾—æ”¹å˜é‡åï¼Œä¸€æ—¦é—å¿˜ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªbookListå˜é‡ï¼Œå®ƒçš„ç±»å‹æ˜¯set,å°±ä¼šäº§ç”Ÿæ··æ·†ã€‚</li><li>ä¿®æ­£ï¼šè¿™é‡Œè¦è¡¨è¾¾çš„æ˜¯æ‹¿åˆ°ä¸€å †ä¹¦ï¼Œæ‰€ä»¥è¿™ä¸ªå‘½åæ”¹ä¸ºbooksã€‚</li></ul><h3 id="æ¡ˆä¾‹2"><a href="#æ¡ˆä¾‹2" class="headerlink" title="æ¡ˆä¾‹2"></a>æ¡ˆä¾‹2</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> Book <span class="hljs-title">getByIsbn</span><span class="hljs-params">(String isbn)</span> </span>&#123;<br>  Book cachedBook = redisBookStore.get(isbn);<br>  <span class="hljs-keyword">if</span> (cachedBook != <span class="hljs-keyword">null</span>) &#123;<br>    <span class="hljs-keyword">return</span> cachedBook;<br>  &#125;<br>  <br>  Book book = doGetByIsbn(isbn);<br>  redisBookStore.put(isbn, book);<br>  <span class="hljs-keyword">return</span> book;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>é—®é¢˜ï¼šè¿™æ®µä»£ç é‡Œç›´æ¥å‡ºç°äº†redisï¼Œé€šå¸¸æ¥è¯´è¿™é‡ŒçœŸæ­£éœ€è¦çš„åªæ˜¯ä¸€ä¸ªç¼“å­˜ï¼Œredi såªæ˜¯ä¸€ç§å®ç°</li></ul><blockquote><p>ç¼“å­˜åªæ˜¯ä¸€ç§æŠ€æœ¯æœ¯è¯­ï¼Œä¸åº”è¯¥å‡ºç°åœ¨ä¸šåŠ¡ä»£ç ä¸­</p></blockquote><blockquote><p>ç¨‹åºçŒ¿ä¹‹æ‰€ä»¥å–œæ¬¢ç”¨æŠ€æœ¯è¯­è¨€å»å‘½åï¼Œæ˜¯å› ä¸ºç¨‹åºå‘˜å†™ä»£ç å¾ˆå¤§ç¨‹åº¦ä¸Šä¼šå‚è€ƒåˆ«äººå†™çš„ä»£ç ï¼Œè€Œè¡Œä¸šé‡Œæ¯”è¾ƒä¼˜ç§€çš„ä¸€äº›ä»£ç ï¼Œå¾€å¾€æ˜¯ä¸€äº›å¼€æºçš„æŠ€æœ¯é¡¹ç›®ã€‚</p></blockquote><blockquote><p>åœ¨ä¸€ä¸ªæŠ€æœ¯ç±»é¡¹ç›®é‡Œï¼Œè¿™äº›æŠ€æœ¯æœ¯è¯­å…¶å®å°±æ˜¯ä»–ä»¬çš„ä¸šåŠ¡è¯­è¨€ï¼Œä½†æ˜¯åœ¨ä¸šåŠ¡é¡¹ç›®é‡Œï¼Œè¿™ä¸ªè¯´æ³•å°±è¦å¦å½“åˆ«è®ºäº†ã€‚</p></blockquote><h2 id="é¿å…è¿åè¯­æ³•è§„åˆ™çš„å‘½å"><a href="#é¿å…è¿åè¯­æ³•è§„åˆ™çš„å‘½å" class="headerlink" title="é¿å…è¿åè¯­æ³•è§„åˆ™çš„å‘½å"></a>é¿å…è¿åè¯­æ³•è§„åˆ™çš„å‘½å</h2><h3 id="æ¡ˆä¾‹1-2"><a href="#æ¡ˆä¾‹1-2" class="headerlink" title="æ¡ˆä¾‹1"></a>æ¡ˆä¾‹1</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">completedTranslate</span><span class="hljs-params">(<span class="hljs-keyword">final</span> List&lt;ChapterId&gt; chapterIds)</span> </span>&#123;<br>  List&lt;Chapter&gt; chapters = repository.findByChapterIdIn(chapterIds);<br>  chapters.forEach(Chapter::completedTranslate);<br>  repository.saveAll(chapters); <br>&#125;<br></code></pre></td></tr></table></figure><p>é—®é¢˜ï¼šcompletedTranslateä¸æ˜¯ä¸€ä¸ªæ­£å¸¸çš„è‹±è¯­å‡½æ•°å</p><p>ä¿®æ­£: completeTranslation</p><blockquote><p>å¸¸è§çš„å‘½åè§„åˆ™æ˜¯ï¼šç±»æ˜¯ä¸€ä¸ªåè¯ï¼Œè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡ã€‚æ–¹æ³•åæ˜¯ä¸€ä¸ªåŠ¨è¯æˆ–è€…æ˜¯åŠ¨å®¾çŸ­è¯­ï¼Œè¡¨ç¤ºä¸€ä¸ªåŠ¨ä½œã€‚</p></blockquote><p>å¦å¤–è¿˜æœ‰ä¸¤ä¸ªå¸¸è§çš„åå‘³é“è¿™é‡Œå°±ä¸ä¸¾ä¾‹äº†ã€‚</p><ul><li>ä¸å‡†ç¡®çš„è‹±è¯­è¯æ±‡ï¼ˆå¯¹äºä¸šåŠ¡ä¸Šä¼šç”¨åˆ°çš„ä¸€äº›åè¯ï¼Œå¯ä»¥æ•´ä¸ªå›¢é˜Ÿä¸€èµ·ï¼Œå»ºç«‹ä¸€ä¸ªä¸šåŠ¡è¯æ±‡è¡¨ï¼Œç”¨é›†ä½“çš„æ™ºæ…§ï¼‰</li><li>å•è¯æ‹¼å†™é”™è¯¯</li></ul><h2 id="ç”¨ä¸šåŠ¡è¯­è¨€å†™ä»£ç "><a href="#ç”¨ä¸šåŠ¡è¯­è¨€å†™ä»£ç " class="headerlink" title="ç”¨ä¸šåŠ¡è¯­è¨€å†™ä»£ç "></a>ç”¨ä¸šåŠ¡è¯­è¨€å†™ä»£ç </h2><h3 id="æ¡ˆä¾‹1-3"><a href="#æ¡ˆä¾‹1-3" class="headerlink" title="æ¡ˆä¾‹1"></a>æ¡ˆä¾‹1</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">approveChapter</span><span class="hljs-params">(<span class="hljs-keyword">long</span> chapterId, <span class="hljs-keyword">long</span> userId)</span> </span>&#123;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><p>é—®é¢˜ï¼šè¿™ä¸ªå‡½æ•°çš„æ„å›¾æ˜¯ç¡®è®¤ç« èŠ‚é€šè¿‡ï¼ŒchapterIdæ˜¯ç« èŠ‚idï¼Œä½†æ˜¯userIdæ˜¯ä»€ä¹ˆï¼Ÿäº†è§£äº†èƒŒæ™¯æ‰çŸ¥é“è¿™é‡Œæ˜¯éœ€è¦è®°å½•ä¸‹å®¡æ ¸äººçš„ä¿¡æ¯ï¼Œè¿™ä¸ªuserIdå°±æ˜¯å®¡æ ¸äººçš„userIdï¼Œ</p><p>ä¿®æ­£ï¼šå› ä¸ºç”¨æˆ·åœ¨è¿™ä¸ªåœºæ™¯ä¸‹çš„èº«ä»½æ˜¯å®¡æ ¸äººï¼Œæ‰€ä»¥ä¿®æ”¹userIdä¸ºreviewerUserId</p><blockquote><p>å¥½çš„å‘½åï¼Œæ˜¯ä½“ç°ä¸šåŠ¡å«ä¹‰çš„å‘½åã€‚</p></blockquote><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0oruapf6nj20u012ggpo.jpg" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>ä»£ç ä¹‹ä¸‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä»£ç åå‘³é“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>excelè¯»å–æ“ä½œ</title>
    <link href="/excel%E8%AF%BB%E5%8F%96%E6%93%8D%E4%BD%9C/"/>
    <url>/excel%E8%AF%BB%E5%8F%96%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h1 id="excel-è¯»å–"><a href="#excel-è¯»å–" class="headerlink" title="excel è¯»å–"></a>excel è¯»å–</h1><h2 id="HSSF-03"><a href="#HSSF-03" class="headerlink" title="HSSF(03)"></a>HSSF(03)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testRead03</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>  InputStream inputStream = <span class="hljs-keyword">new</span> FileInputStream(PATH+<span class="hljs-string">&quot;/excelå†™å…¥.xls&quot;</span>);<br>  <span class="hljs-keyword">final</span> HSSFWorkbook workbook = <span class="hljs-keyword">new</span> HSSFWorkbook(inputStream);<br>  <span class="hljs-keyword">final</span> HSSFSheet sheet = workbook.getSheetAt(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">final</span> HSSFRow row = sheet.getRow(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">final</span> HSSFCell cell = row.getCell(<span class="hljs-number">0</span>);<br>  <span class="hljs-comment">// è¯»å–å€¼çš„æ—¶å€™ï¼Œä¸€å®šè¦æ³¨æ„ç±»å‹ï¼ï¼</span><br>  <span class="hljs-keyword">final</span> String cellValue = cell.getStringCellValue();<br>  System.out.println(cellValue);<br>  inputStream.close();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="XSSF-07"><a href="#XSSF-07" class="headerlink" title="XSSF(07)"></a>XSSF(07)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testRead07</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>  InputStream inputStream = <span class="hljs-keyword">new</span> FileInputStream(PATH+<span class="hljs-string">&quot;/excelå†™å…¥.xlsx&quot;</span>);<br>  <span class="hljs-keyword">final</span> XSSFWorkbook workbook = <span class="hljs-keyword">new</span> XSSFWorkbook(inputStream);<br>  <span class="hljs-keyword">final</span> XSSFSheet sheet = workbook.getSheetAt(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">final</span> XSSFRow row = sheet.getRow(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">final</span> XSSFCell cell = row.getCell(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">final</span> String cellValue = cell.getStringCellValue();<br>  System.out.println(cellValue);<br>  inputStream.close();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="è¯»å–ä¸åŒç±»å‹çš„æ•°æ®"><a href="#è¯»å–ä¸åŒç±»å‹çš„æ•°æ®" class="headerlink" title="è¯»å–ä¸åŒç±»å‹çš„æ•°æ®"></a>è¯»å–ä¸åŒç±»å‹çš„æ•°æ®</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testCellType</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>    InputStream inputStream = <span class="hljs-keyword">new</span> FileInputStream(<span class="hljs-string">&quot;/Users/panyurou/IdeaProjects/exceldemo/src/test/resources/æ˜ç»†è¡¨.xlsx&quot;</span>);<br>    <span class="hljs-keyword">final</span> XSSFWorkbook workbook = <span class="hljs-keyword">new</span> XSSFWorkbook(inputStream);<br>    <span class="hljs-comment">// è¯»å–æ ‡é¢˜è¡Œ</span><br>    <span class="hljs-keyword">final</span> XSSFSheet sheet = workbook.getSheetAt(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">final</span> XSSFRow headerRow = sheet.getRow(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> colCount = headerRow.getPhysicalNumberOfCells();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; colCount; i++) &#123;<br>      <span class="hljs-keyword">final</span> XSSFCell cell = headerRow.getCell(i);<br>      <span class="hljs-keyword">if</span>(cell != <span class="hljs-keyword">null</span>)&#123;<br>        <span class="hljs-keyword">final</span> String cellValue = cell.getStringCellValue();<br>        System.out.print(cellValue + <span class="hljs-string">&quot;|&quot;</span>);<br>      &#125;<br>    &#125;<br>    System.out.println();<br>    <span class="hljs-comment">// è¯»å–å†…å®¹</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> rowsCount = sheet.getPhysicalNumberOfRows();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; rowsCount; i++) &#123;<br>      <span class="hljs-keyword">final</span> XSSFRow row = sheet.getRow(i);<br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; colCount; j++) &#123;<br>        <span class="hljs-keyword">final</span> XSSFCell cell = row.getCell(j);<br>        <span class="hljs-keyword">if</span>(cell != <span class="hljs-keyword">null</span>)&#123;<br>          <span class="hljs-keyword">final</span> CellType cellType = cell.getCellType();<br>          String cellValue = getCellValue(cell, cellType);<br>          System.out.print(cellValue + <span class="hljs-string">&quot;|&quot;</span>);<br>        &#125;<br>      &#125;<br>      System.out.println();<br>    &#125;<br>    inputStream.close();<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getCellValue</span><span class="hljs-params">(XSSFCell cell, CellType cellType)</span> </span>&#123;<br>    String cellValue = <span class="hljs-string">&quot;&quot;</span>;<br>     <span class="hljs-keyword">switch</span> (cellType)&#123;<br>      <span class="hljs-keyword">case</span> STRING:<br>        cellValue = cell.getStringCellValue();<br>         <span class="hljs-keyword">break</span>;<br>       <span class="hljs-keyword">case</span> NUMERIC:<br>         <span class="hljs-keyword">if</span>(DateUtil.isCellDateFormatted(cell))&#123;<br>           <span class="hljs-keyword">final</span> Date date = cell.getDateCellValue();<br>           cellValue = <span class="hljs-keyword">new</span> DateTime(date).toString(<span class="hljs-string">&quot;yyyy-MM-dd&quot;</span>);<br>         &#125;<span class="hljs-keyword">else</span>&#123;<br>           cellValue = String.valueOf(cell.getNumericCellValue());<br>         &#125;<br>         <span class="hljs-keyword">break</span>;<br>       <span class="hljs-keyword">case</span> FORMULA:<br>        cellValue = cell.getCellFormula();<br>         <span class="hljs-keyword">break</span>;<br>       <span class="hljs-keyword">case</span> BOOLEAN:<br>        cellValue = String.valueOf(cell.getBooleanCellValue());<br>         <span class="hljs-keyword">break</span>;<br>       <span class="hljs-keyword">case</span> ERROR:<br>         System.out.println(<span class="hljs-string">&quot;ç±»å‹é”™è¯¯&quot;</span>);<br>         <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> cellValue;<br>  &#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>excel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>excelå¤§æ•°æ®é‡çš„å†™å…¥</title>
    <link href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E7%9A%84%E5%86%99%E5%85%A5/"/>
    <url>/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E7%9A%84%E5%86%99%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="å¤§æ•°æ®é‡çš„å†™å…¥"><a href="#å¤§æ•°æ®é‡çš„å†™å…¥" class="headerlink" title="å¤§æ•°æ®é‡çš„å†™å…¥"></a>å¤§æ•°æ®é‡çš„å†™å…¥</h1><h2 id="HSSF-03ç‰ˆ"><a href="#HSSF-03ç‰ˆ" class="headerlink" title="HSSF(03ç‰ˆ)"></a>HSSF(03ç‰ˆ)</h2><ul><li><p>ä¼˜ç‚¹ï¼šè¿‡ç¨‹ä¸­æ•°æ®å…¨éƒ¨å†™å…¥ç¼“å­˜ï¼Œä¸æ“ä½œç£ç›˜ï¼Œæœ€åä¸€æ¬¡å†™å…¥ç¼“å­˜ï¼Œé€Ÿåº¦å¿«</p></li><li><p>ç¼ºç‚¹ï¼šæœ€å¤šåªèƒ½å¤„ç†65536è¡Œï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">Invalid row <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">65536</span>)</span> outside allowable <span class="hljs-title">range</span> <span class="hljs-params">(<span class="hljs-number">0.</span><span class="hljs-number">.65535</span>)</span></span><br><span class="hljs-function">java.lang.IllegalArgumentException: Invalid row <span class="hljs-title">number</span> <span class="hljs-params">(<span class="hljs-number">65536</span>)</span> outside allowable <span class="hljs-title">range</span> <span class="hljs-params">(<span class="hljs-number">0.</span><span class="hljs-number">.65535</span>)</span></span><br></code></pre></td></tr></table></figure></li></ul><h4 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h4><p><strong>æŠ›å‡ºå¼‚å¸¸æµ‹è¯•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExcelBigData</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String PATH = <span class="hljs-string">&quot;/Users/panyurou/IdeaProjects/exceldemo&quot;</span>;<br><br>  <span class="hljs-meta">@Test</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">excelWrite03</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>    Workbook workbook = <span class="hljs-keyword">new</span> HSSFWorkbook();<br>    <span class="hljs-keyword">final</span> Sheet sheet = workbook.createSheet(<span class="hljs-string">&quot;æµ‹è¯•å¤§æ•°æ®é‡&quot;</span>);<br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> begin = System.currentTimeMillis();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">65537</span>; i++) &#123;<br>      <span class="hljs-keyword">final</span> Row row = sheet.createRow(i);<br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">10</span>; j++) &#123;<br>        <span class="hljs-keyword">final</span> Cell cell = row.createCell(j);<br>        cell.setCellValue(<span class="hljs-string">&quot;$&#123;i,j&#125;&quot;</span>);<br>      &#125;<br>    &#125;<br>    System.out.println(<span class="hljs-string">&quot;over!&quot;</span>);<br>    FileOutputStream outputStream = <span class="hljs-keyword">new</span> FileOutputStream(PATH + <span class="hljs-string">&quot;/excelå¤§æ•°æ®å†™å…¥01.xls&quot;</span>);<br>    workbook.write(outputStream);<br>    outputStream.close();<br>    System.out.println(<span class="hljs-string">&quot;excel å†™å…¥å®Œæ¯•ï¼&quot;</span>);<br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> end = System.currentTimeMillis();<br>    System.out.println(<span class="hljs-string">&quot;å†™å…¥æ—¶é—´ï¼š&quot;</span>+(<span class="hljs-keyword">double</span>) ((end - begin) / <span class="hljs-number">1000</span>));<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232505454.png" alt="image-20230228232505454"></p><p>å°†ä¸Šé¢çš„65537æ”¹æˆ65536ï¼Œè¾“å‡ºå†™å…¥æ—¶é•¿ï¼Œå¯çœ‹å‡ºèŠ±è´¹äº†1ç§’</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232512748.png" alt="image-20230228232512748"></p><h2 id="SXSSFWorkbook"><a href="#SXSSFWorkbook" class="headerlink" title="SXSSFWorkbook"></a>SXSSFWorkbook</h2><ul><li>ä¼˜ç‚¹ï¼šå¯ä»¥å†™éå¸¸å¤§çš„æ•°æ®é‡ï¼Œå†™é€Ÿåº¦æ›´å¿«ï¼Œå ç”¨æ›´å°‘çš„å†…å­˜</li><li>æ³¨æ„ï¼š<ul><li>è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿä¸´æ—¶æ–‡ä»¶ï¼Œéœ€è¦æ¸…ç†ä¸´æ—¶æ–‡ä»¶</li><li>é»˜è®¤100æ¡æ•°æ®ä¼šè¢«ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœè¶…è¿‡è¿™æ•°é‡ï¼Œåˆ™æ•°æ®ä¼šè¢«å†™å…¥ä¸´æ—¶æ–‡ä»¶<ul><li>å¦‚æœæƒ³è‡ªå®šä¹‰å†…å­˜ä¸­çš„æ•°é‡ï¼Œå¯ä»¥ä½¿ç”¨<code>new SXSSFWorkbook(æ•°é‡);</code></li></ul></li></ul></li></ul><h4 id="å®æˆ˜-1"><a href="#å®æˆ˜-1" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">excelWriteSXSSF</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>    SXSSFWorkbook workbook = <span class="hljs-keyword">new</span> SXSSFWorkbook();<br>    <span class="hljs-keyword">final</span> Sheet sheet = workbook.createSheet(<span class="hljs-string">&quot;æµ‹è¯•å¤§æ•°æ®é‡&quot;</span>);<br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> begin = System.currentTimeMillis();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">65537</span>; i++) &#123;<br>      <span class="hljs-keyword">final</span> Row row = sheet.createRow(i);<br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">120</span>; j++) &#123;<br>        <span class="hljs-keyword">final</span> Cell cell = row.createCell(j);<br>        cell.setCellValue(<span class="hljs-string">&quot;$&#123;i,j&#125;&quot;</span>);<br>      &#125;<br>    &#125;<br>    System.out.println(<span class="hljs-string">&quot;over!&quot;</span>);<br>    FileOutputStream outputStream = <span class="hljs-keyword">new</span> FileOutputStream(PATH + <span class="hljs-string">&quot;/excelå¤§æ•°æ®å†™å…¥09s.xlsx&quot;</span>);<br>    workbook.write(outputStream);<br>    outputStream.close();<br>    <span class="hljs-comment">// æ¸…é™¤ä¸´æ—¶æ–‡ä»¶ï¼ï¼ï¼</span><br>    workbook.dispose();<br>    System.out.println(<span class="hljs-string">&quot;excel å†™å…¥å®Œæ¯•ï¼&quot;</span>);<br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> end = System.currentTimeMillis();<br>    System.out.println(<span class="hljs-string">&quot;å†™å…¥æ—¶é—´ï¼š&quot;</span>+(<span class="hljs-keyword">double</span>) ((end - begin) / <span class="hljs-number">1000</span>));<br>  &#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºå³ä½¿ç°åœ¨æœ‰120åˆ—ï¼Œä¹Ÿåªéœ€è¦10ç§’ï¼Œé€Ÿåº¦å¾ˆå¿«ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228232535340.png" alt="image-20230228232535340"></p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>excel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ExcelåŸºæœ¬å†™æ“ä½œ</title>
    <link href="/excel%E6%93%8D%E4%BD%9C/"/>
    <url>/excel%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h1 id="ExcelåŸºæœ¬å†™æ“ä½œ"><a href="#ExcelåŸºæœ¬å†™æ“ä½œ" class="headerlink" title="ExcelåŸºæœ¬å†™æ“ä½œ"></a>ExcelåŸºæœ¬å†™æ“ä½œ</h1><ul><li>å¼•å…¥ä¾èµ–</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">implementation <span class="hljs-string">&#x27;org.apache.poi:poi:5.2.0&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExcelWrite</span> </span>&#123;<br>  <span class="hljs-comment">// é¡¹ç›®ç›®å½•</span><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String PATH = <span class="hljs-string">&quot;/Users/panyurou/IdeaProjects/exceldemo&quot;</span>;<br><br>  <span class="hljs-meta">@Test</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">excelWrite</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>    <span class="hljs-comment">//1.åˆ›å»ºä¸€ä¸ªå·¥ä½œç°¿</span><br>    Workbook workbook = <span class="hljs-keyword">new</span> HSSFWorkbook();<br>    <span class="hljs-comment">//2.åˆ›å»ºä¸€ä¸ªå·¥ä½œè¡¨</span><br>    Sheet sheet = workbook.createSheet(<span class="hljs-string">&quot;æµ‹è¯•excelå†™å…¥&quot;</span>);<br>    <span class="hljs-comment">//3.åˆ›å»ºä¸€è¡Œ,ç¬¬0è¡Œ</span><br>    Row row1 = sheet.createRow(<span class="hljs-number">0</span>);<br>    <span class="hljs-comment">//4.åˆ›å»ºä¸€ä¸ªå•å…ƒæ ¼</span><br>    Cell cell11 = row1.createCell(<span class="hljs-number">0</span>);<br>    <span class="hljs-comment">//5.ç»™å•å…ƒæ ¼å†™å…¥å€¼</span><br>    cell11.setCellValue(<span class="hljs-string">&quot;æˆ‘æ˜¯å•å…ƒæ ¼ï¼ˆ1ï¼Œ1ï¼‰&quot;</span>);<br><br>    <span class="hljs-comment">//6.åˆ›å»ºæ–°çš„ä¸€è¡Œ,ç¬¬1è¡Œ</span><br>    Row row2 = sheet.createRow(<span class="hljs-number">1</span>);<br>    <span class="hljs-comment">//7.åˆ›å»ºä¸€ä¸ªå•å…ƒæ ¼</span><br>    Cell cell21 = row2.createCell(<span class="hljs-number">0</span>);<br>    <span class="hljs-comment">//8.ç»™å•å…ƒæ ¼å†™å…¥å€¼</span><br>    String time = <span class="hljs-keyword">new</span> DateTime().toString(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);<br>    cell21.setCellValue(time);<br><br>    <span class="hljs-comment">//9.å°†åˆ›å»ºå¥½çš„å·¥ä½œç°¿å†™å‡º</span><br>    FileOutputStream outputStream = <span class="hljs-keyword">new</span> FileOutputStream(PATH + <span class="hljs-string">&quot;/excelå†™å…¥.xlsx&quot;</span>);<br>    workbook.write(outputStream);<br>    outputStream.close();<br>    System.out.println(<span class="hljs-string">&quot;excel å†™å…¥å®Œæ¯•ï¼&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h0gpje9k7lj20os0r6jt6.jpg" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>excel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ElasticSearchä¹è§‚å¹¶å‘æ§åˆ¶</title>
    <link href="/ElasticSearch%E4%B9%90%E8%A7%82%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/"/>
    <url>/ElasticSearch%E4%B9%90%E8%A7%82%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="Elasticsearchä¹è§‚å¹¶å‘æ§åˆ¶"><a href="#Elasticsearchä¹è§‚å¹¶å‘æ§åˆ¶" class="headerlink" title="Elasticsearchä¹è§‚å¹¶å‘æ§åˆ¶"></a>Elasticsearchä¹è§‚å¹¶å‘æ§åˆ¶</h1><p>Elasticsearch ä¸­ä½¿ç”¨çš„è¿™ç§ä¹è§‚çš„æ–¹å¼å‡å®šå†²çªæ˜¯ä¸å¯èƒ½å‘ç”Ÿçš„ï¼Œå¹¶ä¸”ä¸ä¼šé˜»å¡æ­£åœ¨ å°è¯•çš„æ“ä½œã€‚ ç„¶è€Œï¼Œå¦‚æœæºæ•°æ®åœ¨è¯»å†™å½“ä¸­è¢«ä¿®æ”¹ï¼Œæ›´æ–°å°†ä¼šå¤±è´¥ã€‚åº”ç”¨ç¨‹åºæ¥ä¸‹æ¥å°†å†³å®šè¯¥å¦‚ä½•è§£å†³å†²çªã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥é‡è¯•æ›´æ–°ã€ä½¿ç”¨æ–°çš„æ•°æ®ã€æˆ–è€…å°†ç›¸å…³æƒ…å†µæŠ¥å‘Šç»™ç”¨æˆ·ã€‚ </p><blockquote><p>åœ¨æ•°æ®åº“é¢†åŸŸä¸­ï¼Œæœ‰ä¸¤ç§æ–¹æ³•æ¥ç¡®ä¿å¹¶å‘æ›´æ–°ï¼Œä¸ä¼šä¸¢å¤±æ•°æ®ï¼š åˆ†åˆ«ä¸ºä¹è§‚å’Œæ‚²è§‚</p></blockquote><h2 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h2><p>ä»¥åˆ›å»ºä¸€ä¸ªæ–‡æ¡£ä¸ºä¾‹ </p><p>step1: åˆ›å»ºæ–‡æ¡£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /test1/_doc/<span class="hljs-number">1</span><br>&#123;<br>  <span class="hljs-string">&quot;Id&quot;</span>: <span class="hljs-number">1</span>,<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;å¼ ä¸‰ä¸°&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>  <span class="hljs-string">&quot;_index&quot;</span> : <span class="hljs-string">&quot;test1&quot;</span>,<br>  <span class="hljs-string">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>  <span class="hljs-string">&quot;_version&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-string">&quot;result&quot;</span> : <span class="hljs-string">&quot;created&quot;</span>,<br>  <span class="hljs-string">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-string">&quot;total&quot;</span> : <span class="hljs-number">2</span>,<br>    <span class="hljs-string">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-string">&quot;_seq_no&quot;</span> : <span class="hljs-number">0</span>,<br>  <span class="hljs-string">&quot;_primary_term&quot;</span> : <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ä½¿ç”¨if_seq_no&#x3D;ç‰ˆæœ¬å€¼ &amp;if_primary_term&#x3D;æ–‡æ¡£ä½ç½®è¿›è¡Œå¹¶å‘ç‰ˆæœ¬æ§åˆ¶</strong></p><ul><li><p>_seq_noï¼šæ–‡æ¡£ç‰ˆæœ¬å·ï¼Œ<strong>versionå±äºå½“ä¸ªæ–‡æ¡£ï¼Œè€Œseq_noå±äºæ•´ä¸ªindex</strong></p></li><li><p>_primary_termï¼š_primary_termä¹Ÿå’Œ_seq_noä¸€æ ·éƒ½æ˜¯æ•´æ•°ï¼Œæ¯å½“Primary Shardå‘ç”Ÿé‡æ–°åˆ†é…æ—¶ï¼Œæ¯”å¦‚é‡å¯ï¼ŒPrimaryé€‰ä¸¾ç­‰ï¼Œ_primary_termä¼šé€’å¢1</p></li></ul><p>step2: æ›´æ–°æ–‡æ¡£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /test1/_update/<span class="hljs-number">1</span>/?if_seq_no=<span class="hljs-number">0</span>&amp;if_primary_term=<span class="hljs-number">1</span><br>&#123;<br>  <span class="hljs-string">&quot;doc&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;å¼ ä¸‰ä¸°666&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>  <span class="hljs-string">&quot;_index&quot;</span> : <span class="hljs-string">&quot;test1&quot;</span>,<br>  <span class="hljs-string">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br>  <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>  <span class="hljs-string">&quot;_version&quot;</span> : <span class="hljs-number">2</span>,<br>  <span class="hljs-string">&quot;result&quot;</span> : <span class="hljs-string">&quot;updated&quot;</span>,<br>  <span class="hljs-string">&quot;_shards&quot;</span> : &#123;<br>    <span class="hljs-string">&quot;total&quot;</span> : <span class="hljs-number">2</span>,<br>    <span class="hljs-string">&quot;successful&quot;</span> : <span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;failed&quot;</span> : <span class="hljs-number">0</span><br>  &#125;,<br>  <span class="hljs-string">&quot;_seq_no&quot;</span> : <span class="hljs-number">1</span>,<br>  <span class="hljs-string">&quot;_primary_term&quot;</span> : <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ElasticSearchæ–‡æ¡£æ˜ å°„</title>
    <link href="/ElasticSearch%E6%96%87%E6%A1%A3%E6%98%A0%E5%B0%84/"/>
    <url>/ElasticSearch%E6%96%87%E6%A1%A3%E6%98%A0%E5%B0%84/</url>
    
    <content type="html"><![CDATA[<h1 id="æ–‡æ¡£æ˜ å°„"><a href="#æ–‡æ¡£æ˜ å°„" class="headerlink" title="æ–‡æ¡£æ˜ å°„"></a>æ–‡æ¡£æ˜ å°„</h1><h2 id="æ˜ å°„ç±»å‹"><a href="#æ˜ å°„ç±»å‹" class="headerlink" title="æ˜ å°„ç±»å‹"></a>æ˜ å°„ç±»å‹</h2><p>ESä¸­æ˜ å°„å¯ä»¥åˆ†ä¸ºåŠ¨æ€æ˜ å°„å’Œé™æ€æ˜ å°„ </p><h3 id="åŠ¨æ€æ˜ å°„ï¼š"><a href="#åŠ¨æ€æ˜ å°„ï¼š" class="headerlink" title="åŠ¨æ€æ˜ å°„ï¼š"></a>åŠ¨æ€æ˜ å°„ï¼š</h3><p>åœ¨å…³ç³»æ•°æ®åº“ä¸­ï¼Œéœ€è¦äº‹å…ˆåˆ›å»ºæ•°æ®åº“ï¼Œç„¶ååœ¨è¯¥æ•°æ®åº“ä¸‹åˆ›å»ºæ•°æ®è¡¨ï¼Œå¹¶åˆ›å»º è¡¨å­—æ®µã€ç±»å‹ã€é•¿åº¦ã€ä¸»é”®ç­‰ï¼Œæœ€åæ‰èƒ½åŸºäºè¡¨æ’å…¥æ•°æ®ã€‚è€ŒElasticsearchä¸­ä¸éœ€è¦å®šä¹‰Mappingæ˜ å°„ï¼ˆå³å…³ç³»å‹æ•°æ®åº“çš„è¡¨ã€å­—æ®µç­‰ï¼‰ï¼Œåœ¨æ–‡æ¡£å†™å…¥Elasticsearchæ—¶ï¼Œä¼šæ ¹æ®æ–‡æ¡£å­—æ®µè‡ªåŠ¨è¯†åˆ«ç±»å‹ï¼Œè¿™ç§æœºåˆ¶ç§°ä¹‹ä¸ºåŠ¨æ€æ˜ å°„ã€‚ </p><p>åŠ¨æ€æ˜ å°„è§„åˆ™å¦‚ä¸‹ï¼š </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228233355466.png" alt="image-20230228233355466"></p><p><strong>æ“ä½œç¤ºä¾‹</strong></p><ul><li>åˆ›å»ºæ–‡æ¡£(ESæ ¹æ®æ•°æ®ç±»å‹, ä¼šè‡ªåŠ¨åˆ›å»ºæ˜ å°„)</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /es_db1/_doc/<span class="hljs-number">32</span><br>&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;ç‹æ­¦&quot;</span>,<br>  <span class="hljs-string">&quot;sex&quot;</span>: <span class="hljs-number">1</span>,<br>  <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">28</span>,<br>  <span class="hljs-string">&quot;address&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;remark&quot;</span>: <span class="hljs-string">&quot;java developer&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li>è·å–æ–‡æ¡£æ˜ å°„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /es_db1/_mapping<br></code></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>  <span class="hljs-string">&quot;es_db1&quot;</span> : &#123;<br>    <span class="hljs-string">&quot;mappings&quot;</span> : &#123;<br>      <span class="hljs-string">&quot;properties&quot;</span> : &#123;<br>        <span class="hljs-string">&quot;address&quot;</span> : &#123;<br>          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span>,<br>          <span class="hljs-string">&quot;fields&quot;</span> : &#123;<br>            <span class="hljs-string">&quot;keyword&quot;</span> : &#123;<br>              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span>,<br>              <span class="hljs-string">&quot;ignore_above&quot;</span> : <span class="hljs-number">256</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;age&quot;</span> : &#123;<br>          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;long&quot;</span><br>        &#125;,<br>        <span class="hljs-string">&quot;name&quot;</span> : &#123;<br>          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span>,<br>          <span class="hljs-string">&quot;fields&quot;</span> : &#123;<br>            <span class="hljs-string">&quot;keyword&quot;</span> : &#123;<br>              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span>,<br>              <span class="hljs-string">&quot;ignore_above&quot;</span> : <span class="hljs-number">256</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;remark&quot;</span> : &#123;<br>          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span>,<br>          <span class="hljs-string">&quot;fields&quot;</span> : &#123;<br>            <span class="hljs-string">&quot;keyword&quot;</span> : &#123;<br>              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span>,<br>              <span class="hljs-string">&quot;ignore_above&quot;</span> : <span class="hljs-number">256</span><br>            &#125;<br>          &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;sex&quot;</span> : &#123;<br>          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;long&quot;</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é™æ€æ˜ å°„ï¼š"><a href="#é™æ€æ˜ å°„ï¼š" class="headerlink" title="é™æ€æ˜ å°„ï¼š"></a>é™æ€æ˜ å°„ï¼š</h3><p>é™æ€æ˜ å°„æ˜¯åœ¨Elasticsearchä¸­ä¹Ÿå¯ä»¥äº‹å…ˆå®šä¹‰å¥½æ˜ å°„ï¼ŒåŒ…å«æ–‡æ¡£çš„å„å­—æ®µç±»å‹ã€åˆ†è¯å™¨ç­‰ï¼Œè¿™ç§æ–¹å¼ç§°ä¹‹ä¸ºé™æ€æ˜ å°„ã€‚ </p><p><strong>æ“ä½œç¤ºä¾‹</strong></p><ul><li>åˆ›å»ºç´¢å¼•å’Œè®¾ç½®æ–‡æ¡£æ˜ å°„ <ul><li>index: æ˜¯å¦åˆ†è¯å­˜å‚¨</li><li>store: æ˜¯å¦å­˜å‚¨åœ¨åº“é‡Œ</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java">PUT /es_db4<br>&#123;<br>  <span class="hljs-string">&quot;mappings&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;properties&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;name&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;keyword&quot;</span>,<br>        <span class="hljs-string">&quot;index&quot;</span>: <span class="hljs-keyword">true</span>,<br>        <span class="hljs-string">&quot;store&quot;</span>: <span class="hljs-keyword">true</span><br>      &#125;,<br>      <span class="hljs-string">&quot;sex&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;integer&quot;</span>,<br>        <span class="hljs-string">&quot;index&quot;</span>: <span class="hljs-keyword">true</span>,<br>        <span class="hljs-string">&quot;store&quot;</span>: <span class="hljs-keyword">true</span><br>      &#125;,<br>      <span class="hljs-string">&quot;age&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;integer&quot;</span>,<br>        <span class="hljs-string">&quot;index&quot;</span>: <span class="hljs-keyword">true</span>,<br>        <span class="hljs-string">&quot;store&quot;</span>: <span class="hljs-keyword">true</span><br>      &#125;,<br>      <span class="hljs-string">&quot;book&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span>,<br>        <span class="hljs-string">&quot;index&quot;</span>: <span class="hljs-keyword">true</span>,<br>        <span class="hljs-string">&quot;store&quot;</span>: <span class="hljs-keyword">true</span><br>      &#125;,<br>      <span class="hljs-string">&quot;address&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span>,<br>        <span class="hljs-string">&quot;index&quot;</span>: <span class="hljs-keyword">true</span>,<br>        <span class="hljs-string">&quot;store&quot;</span>: <span class="hljs-keyword">true</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>  <span class="hljs-string">&quot;es_db4&quot;</span> : &#123;<br>    <span class="hljs-string">&quot;mappings&quot;</span> : &#123;<br>      <span class="hljs-string">&quot;properties&quot;</span> : &#123;<br>        <span class="hljs-string">&quot;address&quot;</span> : &#123;<br>          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span>,<br>          <span class="hljs-string">&quot;store&quot;</span> : <span class="hljs-keyword">true</span><br>        &#125;,<br>        <span class="hljs-string">&quot;age&quot;</span> : &#123;<br>          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;integer&quot;</span>,<br>          <span class="hljs-string">&quot;store&quot;</span> : <span class="hljs-keyword">true</span><br>        &#125;,<br>        <span class="hljs-string">&quot;book&quot;</span> : &#123;<br>          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;text&quot;</span>,<br>          <span class="hljs-string">&quot;store&quot;</span> : <span class="hljs-keyword">true</span><br>        &#125;,<br>        <span class="hljs-string">&quot;name&quot;</span> : &#123;<br>          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;keyword&quot;</span>,<br>          <span class="hljs-string">&quot;store&quot;</span> : <span class="hljs-keyword">true</span><br>        &#125;,<br>        <span class="hljs-string">&quot;sex&quot;</span> : &#123;<br>          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;integer&quot;</span>,<br>          <span class="hljs-string">&quot;store&quot;</span> : <span class="hljs-keyword">true</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æ ¹æ®é™æ€æ˜ å°„åˆ›å»ºæ–‡æ¡£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">PUT /es_db/_doc/<span class="hljs-number">4</span><br>&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Jack&quot;</span>,<br>  <span class="hljs-string">&quot;sex&quot;</span>: <span class="hljs-number">1</span>,<br>  <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">25</span>,<br>  <span class="hljs-string">&quot;book&quot;</span>: <span class="hljs-string">&quot;elasticSearchå…¥é—¨è‡³ç²¾é€š&quot;</span>,<br>  <span class="hljs-string">&quot;address&quot;</span>: <span class="hljs-string">&quot;å¹¿å·è½¦é™‚&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li>è·å–æ–‡æ¡£æ˜ å°„</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">GET <span class="hljs-regexp">/es_db4/</span>_mapping<br></code></pre></td></tr></table></figure><h2 id="æ–‡æ¡£æ ¸å¿ƒç±»å‹ï¼ˆCore-datatypeï¼‰"><a href="#æ–‡æ¡£æ ¸å¿ƒç±»å‹ï¼ˆCore-datatypeï¼‰" class="headerlink" title="æ–‡æ¡£æ ¸å¿ƒç±»å‹ï¼ˆCore datatypeï¼‰"></a>æ–‡æ¡£æ ¸å¿ƒç±»å‹ï¼ˆCore datatypeï¼‰</h2><h3 id="ç±»å‹åˆ†ç±»"><a href="#ç±»å‹åˆ†ç±»" class="headerlink" title="ç±»å‹åˆ†ç±»"></a>ç±»å‹åˆ†ç±»</h3><ul><li>å­—ç¬¦ä¸²ï¼šstringï¼Œstringç±»å‹åŒ…å« text å’Œ keywordã€‚ </li><li>textï¼šè¯¥ç±»å‹è¢«ç”¨æ¥ç´¢å¼•é•¿æ–‡æœ¬ï¼Œåœ¨åˆ›å»ºç´¢å¼•å‰ä¼šå°†è¿™äº›æ–‡æœ¬è¿›è¡Œåˆ†è¯ï¼Œè½¬åŒ–ä¸ºè¯çš„ç»„åˆï¼Œå»ºç«‹ç´¢å¼•ï¼›å…è®¸esæ¥æ£€ç´¢è¿™äº›è¯ï¼Œtextç±»å‹ä¸èƒ½ç”¨æ¥æ’åºå’Œèšåˆã€‚</li><li>keywordï¼šè¯¥ç±»å‹ä¸èƒ½åˆ†è¯ï¼Œå¯ä»¥è¢«ç”¨æ¥æ£€ç´¢è¿‡æ»¤ã€æ’åºå’Œèšåˆï¼Œkeywordç±»å‹ä¸å¯ç”¨textè¿›è¡Œåˆ†è¯æ¨¡ç³Šæ£€ç´¢ã€‚</li><li>æ•°å€¼å‹ï¼šlongã€integerã€shortã€byteã€doubleã€float </li><li>æ—¥æœŸå‹ï¼šdate </li><li>å¸ƒå°”å‹ï¼šboolean</li></ul><p><strong>é€šè¿‡term å’Œ matchæŸ¥è¯¢æ•°æ®æ—¶ç»†èŠ‚ç‚¹ä»¥åŠæ•°æ®ç±»å‹keywordä¸textåŒºåˆ«</strong></p><ul><li><strong>termæŸ¥è¯¢</strong><ul><li>termæŸ¥è¯¢keywordå­—æ®µ: termä¸ä¼šåˆ†è¯ã€‚è€Œkeywordå­—æ®µä¹Ÿä¸åˆ†è¯ã€‚éœ€è¦å®Œå…¨åŒ¹é…æ‰å¯</li><li>termæŸ¥è¯¢textå­—æ®µ: å› ä¸ºtextå­—æ®µä¼šåˆ†è¯ï¼Œè€Œtermä¸åˆ†è¯ï¼Œæ‰€ä»¥termæŸ¥è¯¢çš„æ¡ä»¶å¿…é¡»æ˜¯textå­—æ®µåˆ†è¯åçš„æŸä¸€ä¸ª</li></ul></li><li><strong>matchæŸ¥è¯¢</strong><ul><li>matchä¼šè¢«åˆ†è¯ï¼Œè€Œkeywordä¸ä¼šè¢«åˆ†è¯ï¼Œmatchçš„éœ€è¦è·Ÿkeywordçš„å®Œå…¨åŒ¹é…å¯ä»¥ã€‚</li><li>matchåˆ†è¯ï¼Œtextä¹Ÿåˆ†è¯ï¼Œåªè¦matchçš„åˆ†è¯ç»“æœå’Œtextçš„åˆ†è¯ç»“æœæœ‰ç›¸åŒçš„å°±åŒ¹é…</li></ul></li></ul><h2 id="å¯¹å·²å­˜åœ¨çš„mappingæ˜ å°„è¿›è¡Œä¿®æ”¹"><a href="#å¯¹å·²å­˜åœ¨çš„mappingæ˜ å°„è¿›è¡Œä¿®æ”¹" class="headerlink" title="å¯¹å·²å­˜åœ¨çš„mappingæ˜ å°„è¿›è¡Œä¿®æ”¹"></a>å¯¹å·²å­˜åœ¨çš„mappingæ˜ å°„è¿›è¡Œä¿®æ”¹</h2><ul><li>é‡æ–°å»ºç«‹ä¸€ä¸ªé™æ€ç´¢å¼• ,æŠŠä¹‹å‰ç´¢å¼•é‡Œçš„æ•°æ®å¯¼å…¥åˆ°æ–°çš„ç´¢å¼•é‡Œ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">POST _reindex<br>&#123;<br>  <span class="hljs-string">&quot;source&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;index&quot;</span>: <span class="hljs-string">&quot;es_db&quot;</span><br>  &#125;,<br>  <span class="hljs-string">&quot;dest&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;index&quot;</span>: <span class="hljs-string">&quot;es_db_2&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼š_reindex ä¼šåŒæ—¶æŠŠä¹‹å‰ç´¢å¼•é‡Œçš„æ•°æ®å¯¼å…¥åˆ°æ–°çš„ç´¢å¼•é‡Œ </p></blockquote><ul><li>åˆ é™¤åŸåˆ›å»ºçš„ç´¢å¼•</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs hava">DELETE /es_db<br></code></pre></td></tr></table></figure><ul><li>ä¸ºæ–°ç´¢å¼•èµ·ä¸ªåˆ«å, ä¸ºåŸç´¢å¼•å</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">PUT /es_db_2/_alias/es_db<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ElasticSearch-DSLè¯­è¨€é«˜çº§æŸ¥è¯¢</title>
    <link href="/ElasticSearch-DSL%E8%AF%AD%E8%A8%80%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/"/>
    <url>/ElasticSearch-DSL%E8%AF%AD%E8%A8%80%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="DSLè¯­è¨€é«˜çº§æŸ¥è¯¢"><a href="#DSLè¯­è¨€é«˜çº§æŸ¥è¯¢" class="headerlink" title="DSLè¯­è¨€é«˜çº§æŸ¥è¯¢"></a>DSLè¯­è¨€é«˜çº§æŸ¥è¯¢</h1><ul><li>Elasticsearchæä¾›äº†åŸºäºJSONçš„DSLæ¥å®šä¹‰æŸ¥è¯¢ã€‚ </li><li>DSLç”±å¶å­æŸ¥è¯¢å­å¥å’Œå¤åˆæŸ¥è¯¢å­å¥ä¸¤ç§å­å¥ç»„æˆ</li></ul><blockquote><p>DSL(Domain Specific Language)é¢†åŸŸä¸“ç”¨è¯­è¨€ </p></blockquote><h2 id="æ— æŸ¥è¯¢æ¡ä»¶"><a href="#æ— æŸ¥è¯¢æ¡ä»¶" class="headerlink" title="æ— æŸ¥è¯¢æ¡ä»¶"></a>æ— æŸ¥è¯¢æ¡ä»¶</h2><p>æ— æŸ¥è¯¢æ¡ä»¶æ˜¯æŸ¥è¯¢æ‰€æœ‰ï¼Œé»˜è®¤æ˜¯æŸ¥è¯¢æ‰€æœ‰çš„ï¼Œæˆ–è€…ä½¿ç”¨match_allè¡¨ç¤ºæ‰€æœ‰ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /es_db/_doc/_search<br>&#123;<br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;match_all&quot;</span>: &#123;&#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æœ‰æŸ¥è¯¢æ¡ä»¶"><a href="#æœ‰æŸ¥è¯¢æ¡ä»¶" class="headerlink" title="æœ‰æŸ¥è¯¢æ¡ä»¶"></a>æœ‰æŸ¥è¯¢æ¡ä»¶</h2><h3 id="æ¨¡ç³ŠåŒ¹é…"><a href="#æ¨¡ç³ŠåŒ¹é…" class="headerlink" title="æ¨¡ç³ŠåŒ¹é…"></a>æ¨¡ç³ŠåŒ¹é…</h3><ul><li><p>æ¨¡ç³ŠåŒ¹é…ä¸»è¦æ˜¯é’ˆå¯¹æ–‡æœ¬ç±»å‹çš„å­—æ®µ</p></li><li><p>æ–‡æœ¬ç±»å‹çš„å­—æ®µä¼šå¯¹å†…å®¹è¿›è¡Œåˆ†è¯ï¼Œå¯¹æŸ¥è¯¢æ—¶ï¼Œä¹Ÿä¼šå¯¹æœç´¢æ¡ä»¶è¿›è¡Œåˆ†è¯ï¼Œç„¶åé€šè¿‡å€’æ’ç´¢å¼•æŸ¥æ‰¾åˆ°åŒ¹é…çš„æ•°æ®</p></li><li><p>æ¨¡ç³ŠåŒ¹é…ä¸»è¦é€šè¿‡matchç­‰å‚æ•°æ¥å®ç° </p><ul><li>match : é€šè¿‡matchå…³é”®è¯æ¨¡ç³ŠåŒ¹é…æ¡ä»¶å†…å®¹,matchä¼šæ ¹æ®è¯¥å­—æ®µçš„åˆ†è¯å™¨ï¼Œè¿›è¡Œåˆ†è¯æŸ¥è¯¢</li><li>prefix : å‰ç¼€åŒ¹é…</li><li>regexp : é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æ•°æ®</li></ul></li></ul><p> <strong>ä¸¾ä¾‹:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /es_db/_doc/_search<br>&#123;<br>  <span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">2</span>,<br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;match&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;address&quot;</span>: <span class="hljs-string">&quot;å¹¿å·&quot;</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>SQL: select * from user where address like â€˜%å¹¿å·%â€™ limit 0, 2 </p></blockquote><ul><li>å¤šå­—æ®µæ¨¡ç³ŠåŒ¹é…æŸ¥è¯¢ multi_match</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /es_db/_doc/_search<br>&#123;<br>  <span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">2</span>,<br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;multi_match&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;query&quot;</span>: <span class="hljs-string">&quot;å¹¿å·å…¬å›­&quot;</span>,<br>      <span class="hljs-string">&quot;fields&quot;</span>: [<br>        <span class="hljs-string">&quot;address&quot;</span>,<br>        <span class="hljs-string">&quot;name&quot;</span><br>      ]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>SQL: select * from student where name like â€˜%å¹¿å·å…¬å›­%â€™ or address like â€˜%å¹¿å·å…¬å›­%â€™ </p></blockquote><ul><li>æœªæŒ‡å®šå­—æ®µæ¡ä»¶æŸ¥è¯¢ query_string , å« AND ä¸ OR æ¡ä»¶</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">POST <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span>_search<br>&#123;<br>  &quot;query&quot;: &#123;<br>    &quot;query_string&quot;: &#123;<br>      &quot;query&quot;: &quot;(å¹¿å·) OR é•¿æ²™&quot;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æŒ‡å®šå­—æ®µæ¡ä»¶æŸ¥è¯¢ query_string , å« AND ä¸ OR æ¡ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /es_db/_doc/_search<br>&#123;<br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;query_string&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;query&quot;</span>: <span class="hljs-string">&quot;(å¹¿å·) OR é•¿æ²™&quot;</span>,<br>      <span class="hljs-string">&quot;fields&quot;</span>:[<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;address&quot;</span>]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>èŒƒå›´æŸ¥è¯¢<ul><li>rangeï¼šèŒƒå›´å…³é”®å­— </li><li>gte å¤§äºç­‰äº</li><li>lte å°äºç­‰äº </li><li>gt å¤§äº </li><li>lt å°äº</li><li>now å½“å‰æ—¶é—´</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /es_db/_doc/_search<br>&#123;<br>  <span class="hljs-string">&quot;query&quot;</span>:&#123;<br>    <span class="hljs-string">&quot;range&quot;</span> : &#123;<br>      <span class="hljs-string">&quot;age&quot;</span> : &#123;<br>        <span class="hljs-string">&quot;gte&quot;</span>:<span class="hljs-number">25</span>,<br>        <span class="hljs-string">&quot;lte&quot;</span>:<span class="hljs-number">28</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>SQL: select * from user where age between 25 and 28 </p></blockquote><ul><li>åˆ†é¡µã€è¾“å‡ºå­—æ®µã€æ’åºç»¼åˆæŸ¥è¯¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /es_db/_doc/_search<br>&#123;<br>    <span class="hljs-string">&quot;query&quot;</span>:&#123;<br>    <span class="hljs-string">&quot;range&quot;</span> : &#123;<br>      <span class="hljs-string">&quot;age&quot;</span> : &#123;<br>        <span class="hljs-string">&quot;gte&quot;</span>:<span class="hljs-number">25</span>,<br>        <span class="hljs-string">&quot;lte&quot;</span>:<span class="hljs-number">28</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">2</span>,<br>  <span class="hljs-string">&quot;_source&quot;</span>: [<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;age&quot;</span>, <span class="hljs-string">&quot;book&quot;</span>],<br>  <span class="hljs-string">&quot;sort&quot;</span>: &#123;<span class="hljs-string">&quot;age&quot;</span>:<span class="hljs-string">&quot;desc&quot;</span>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Filterè¿‡æ»¤å™¨æ–¹å¼æŸ¥è¯¢"><a href="#Filterè¿‡æ»¤å™¨æ–¹å¼æŸ¥è¯¢" class="headerlink" title="Filterè¿‡æ»¤å™¨æ–¹å¼æŸ¥è¯¢"></a>Filterè¿‡æ»¤å™¨æ–¹å¼æŸ¥è¯¢</h2><p>å®ƒçš„æŸ¥è¯¢ä¸ä¼šè®¡ç®—ç›¸å…³æ€§åˆ†å€¼ï¼Œä¹Ÿä¸ä¼šå¯¹ç»“æœè¿›è¡Œæ’åº, å› æ­¤æ•ˆç‡ä¼šé«˜ä¸€ç‚¹ï¼ŒæŸ¥è¯¢çš„ç»“æœå¯ä»¥è¢«ç¼“å­˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">POST /es_db/_doc/_search<br>&#123;<br>  <span class="hljs-string">&quot;query&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;bool&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;filter&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;term&quot;</span>: &#123;<br>          <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">25</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li><p>match: æ¨¡ç³ŠåŒ¹é…ï¼Œéœ€è¦æŒ‡å®šå­—æ®µåï¼Œä½†æ˜¯è¾“å…¥ä¼šè¿›è¡Œåˆ†è¯ï¼Œæ¯”å¦‚â€hello worldâ€ä¼šè¿›è¡Œæ‹†åˆ†ä¸ºhelloå’Œworldï¼Œç„¶ååŒ¹é…ï¼Œå¦‚æœå­—æ®µä¸­åŒ…å«helloæˆ–è€… worldï¼Œæˆ–è€…éƒ½åŒ…å«çš„ç»“æœéƒ½ä¼šè¢«æŸ¥è¯¢å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯è¯´matchæ˜¯ä¸€ä¸ªéƒ¨åˆ†åŒ¹é…çš„æ¨¡ç³ŠæŸ¥è¯¢ã€‚æŸ¥è¯¢æ¡ä»¶ç›¸å¯¹æ¥è¯´æ¯”è¾ƒå®½æ¾ã€‚ </p></li><li><p>termï¼šè¿™ç§æŸ¥è¯¢å’Œmatchåœ¨æœ‰äº›æ—¶å€™æ˜¯ç­‰ä»·çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬æŸ¥è¯¢å•ä¸ªçš„è¯helloï¼Œé‚£ä¹ˆä¼šå’ŒmatchæŸ¥è¯¢ç»“æœä¸€æ ·ï¼Œä½†æ˜¯å¦‚æœæŸ¥è¯¢â€hello worldâ€ï¼Œç»“æœå°±ç›¸å·®å¾ˆå¤§ï¼Œå› ä¸ºè¿™ä¸ªè¾“å…¥ä¸ä¼šè¿›è¡Œåˆ†è¯ï¼Œå°±æ˜¯è¯´æŸ¥è¯¢çš„æ—¶å€™ï¼Œæ˜¯æŸ¥è¯¢å­—æ®µåˆ†è¯ç»“æœä¸­æ˜¯å¦æœ‰â€hello worldâ€çš„å­—æ ·ï¼Œè€Œä¸æ˜¯æŸ¥è¯¢å­—æ®µä¸­åŒ…å«â€hello worldâ€çš„å­—æ ·ã€‚å½“ä¿å­˜ </p><p>æ•°æ®â€hello worldâ€æ—¶ï¼Œelasticsearchä¼šå¯¹å­—æ®µå†…å®¹è¿›è¡Œåˆ†è¯ï¼Œâ€hello worldâ€ä¼šè¢«åˆ†æˆhelloå’Œworldï¼Œä¸å­˜åœ¨â€hello worldâ€ï¼Œå› æ­¤è¿™é‡Œçš„æŸ¥è¯¢ç»“æœä¼šä¸ºç©ºã€‚è¿™ä¹Ÿæ˜¯termæŸ¥è¯¢å’Œmatchçš„åŒºåˆ«ã€‚</p></li><li><p>query_stringï¼šå’Œmatchç±»ä¼¼ï¼Œä½†æ˜¯matchéœ€è¦æŒ‡å®šå­—æ®µåï¼Œquery_stringæ˜¯åœ¨æ‰€ </p><p>æœ‰å­—æ®µä¸­æœç´¢ï¼ŒèŒƒå›´æ›´å¹¿æ³›ã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ElasticSearchæ–‡æ¡£æ‰¹é‡æ“ä½œ</title>
    <link href="/ElasticSearch%E6%96%87%E6%A1%A3%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C/"/>
    <url>/ElasticSearch%E6%96%87%E6%A1%A3%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h1 id="æ–‡æ¡£æ‰¹é‡æ“ä½œ"><a href="#æ–‡æ¡£æ‰¹é‡æ“ä½œ" class="headerlink" title="æ–‡æ¡£æ‰¹é‡æ“ä½œ"></a><strong>æ–‡æ¡£æ‰¹é‡æ“ä½œ</strong></h1><h2 id="æ‰¹é‡è·å–æ–‡æ¡£æ•°æ®"><a href="#æ‰¹é‡è·å–æ–‡æ¡£æ•°æ®" class="headerlink" title="æ‰¹é‡è·å–æ–‡æ¡£æ•°æ®"></a>æ‰¹é‡è·å–æ–‡æ¡£æ•°æ®</h2><blockquote><p>æ‰¹é‡è·å–æ–‡æ¡£æ•°æ®æ˜¯é€šè¿‡_mgetçš„APIæ¥å®ç°çš„ </p></blockquote><h3 id="åœ¨URLä¸­ä¸æŒ‡å®šindexå’Œtype"><a href="#åœ¨URLä¸­ä¸æŒ‡å®šindexå’Œtype" class="headerlink" title="åœ¨URLä¸­ä¸æŒ‡å®šindexå’Œtype"></a>åœ¨URLä¸­ä¸æŒ‡å®šindexå’Œtype</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> _mget<br>&#123;<br>  &quot;docs&quot;: [<br>    &#123;<br>      &quot;_index&quot;: &quot;es_db&quot;,<br>      &quot;_type&quot;: &quot;_doc&quot;,<br>      &quot;_id&quot;: <span class="hljs-number">1</span><br>    &#125;,<br>    &#123;<br>      &quot;_index&quot;: &quot;es_db&quot;,<br>      &quot;_type&quot;: &quot;_doc&quot;,<br>      &quot;_id&quot;: <span class="hljs-number">2</span><br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åœ¨URLä¸­æŒ‡å®šindex"><a href="#åœ¨URLä¸­æŒ‡å®šindex" class="headerlink" title="åœ¨URLä¸­æŒ‡å®šindex"></a>åœ¨URLä¸­æŒ‡å®šindex</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_mget<br>&#123;<br>  &quot;docs&quot;: [<br>    &#123;<br>      &quot;_type&quot;: &quot;_doc&quot;,<br>      &quot;_id&quot;: <span class="hljs-number">1</span><br>    &#125;,<br>    &#123;<br>      &quot;_type&quot;: &quot;_doc&quot;,<br>      &quot;_id&quot;: <span class="hljs-number">2</span><br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åœ¨URLä¸­æŒ‡å®šindexå’Œtype"><a href="#åœ¨URLä¸­æŒ‡å®šindexå’Œtype" class="headerlink" title="åœ¨URLä¸­æŒ‡å®šindexå’Œtype"></a>åœ¨URLä¸­æŒ‡å®šindexå’Œtype</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span>_mget<br>&#123;<br>  &quot;docs&quot;: [<br>    &#123;<br>      &quot;_id&quot;: <span class="hljs-number">1</span><br>    &#125;,<br>    &#123;<br>      &quot;_id&quot;: <span class="hljs-number">2</span><br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ‰¹é‡æ“ä½œæ–‡æ¡£æ•°æ®"><a href="#æ‰¹é‡æ“ä½œæ–‡æ¡£æ•°æ®" class="headerlink" title="æ‰¹é‡æ“ä½œæ–‡æ¡£æ•°æ®"></a>æ‰¹é‡æ“ä½œæ–‡æ¡£æ•°æ®</h2><ul><li><p>æ‰¹é‡å¯¹æ–‡æ¡£è¿›è¡Œå†™æ“ä½œæ˜¯é€šè¿‡_bulkçš„APIæ¥å®ç°çš„ </p></li><li><p>é€šè¿‡_bulkæ“ä½œæ–‡æ¡£ï¼Œä¸€èˆ¬è‡³å°‘æœ‰ä¸¤è¡Œå‚æ•°(æˆ–å¶æ•°è¡Œå‚æ•°) </p><ul><li>ç¬¬ä¸€è¡Œå‚æ•°ä¸ºæŒ‡å®šæ“ä½œçš„ç±»å‹åŠæ“ä½œçš„å¯¹è±¡ (index,typeå’Œid) </li><li>ç¬¬äºŒè¡Œå‚æ•°æ‰æ˜¯æ“ä½œçš„æ•°æ®</li></ul><p>å‚æ•°ç±»ä¼¼äºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<span class="hljs-string">&quot;actionName&quot;</span>:&#123;<span class="hljs-string">&quot;_index&quot;</span>:<span class="hljs-string">&quot;indexName&quot;</span>, <span class="hljs-string">&quot;_type&quot;</span>:<span class="hljs-string">&quot;typeName&quot;</span>,<span class="hljs-string">&quot;_id&quot;</span>:<span class="hljs-string">&quot;id&quot;</span>&#125;&#125;<br>&#123;<span class="hljs-string">&quot;field1&quot;</span>:<span class="hljs-string">&quot;value1&quot;</span>, <span class="hljs-string">&quot;field2&quot;</span>:<span class="hljs-string">&quot;value2&quot;</span>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="æ‰¹é‡åˆ›å»ºæ–‡æ¡£create"><a href="#æ‰¹é‡åˆ›å»ºæ–‡æ¡£create" class="headerlink" title="æ‰¹é‡åˆ›å»ºæ–‡æ¡£create"></a>æ‰¹é‡åˆ›å»ºæ–‡æ¡£create</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs sql">POST _bulk<br>&#123;<br>  &quot;create&quot;: &#123;<br>    &quot;_index&quot;: &quot;article&quot;,<br>    &quot;_type&quot;: &quot;_doc&quot;,<br>    &quot;_id&quot;: <span class="hljs-number">3</span><br>  &#125;<br>&#125;<br>&#123;<br>  &quot;id&quot;: <span class="hljs-number">3</span>,<br>  &quot;title&quot;: &quot;æ–‡ç« 1&quot;,<br>  &quot;content&quot;: &quot;å†…å®¹1&quot;,<br>  &quot;tags&quot;: [<br>    &quot;tag1&quot;,<br>    &quot;tag2&quot;<br>  ],<br>  &quot;create_time&quot;: <span class="hljs-number">1554015482530</span><br>&#125;<br>&#123;<br>  &quot;create&quot;: &#123;<br>    &quot;_index&quot;: &quot;article&quot;,<br>    &quot;_type&quot;: &quot;_doc&quot;,<br>    &quot;_id&quot;: <span class="hljs-number">4</span><br>  &#125;<br>&#125;<br>&#123;<br>  &quot;id&quot;: <span class="hljs-number">4</span>,<br>  &quot;title&quot;: &quot;æ–‡ç« 2&quot;,<br>  &quot;content&quot;: &quot;å†…å®¹2&quot;,<br>  &quot;tags&quot;: [<br>    &quot;tag3&quot;,<br>    &quot;tag4&quot;<br>  ],<br>  &quot;create_time&quot;: <span class="hljs-number">1554015482530</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ™®é€šåˆ›å»ºæˆ–å…¨é‡æ›¿æ¢index"><a href="#æ™®é€šåˆ›å»ºæˆ–å…¨é‡æ›¿æ¢index" class="headerlink" title="æ™®é€šåˆ›å»ºæˆ–å…¨é‡æ›¿æ¢index"></a>æ™®é€šåˆ›å»ºæˆ–å…¨é‡æ›¿æ¢index</h3><ul><li>å¦‚æœåŸæ–‡æ¡£ä¸å­˜åœ¨ï¼Œåˆ™æ˜¯åˆ›å»º </li><li>å¦‚æœåŸæ–‡æ¡£å­˜åœ¨ï¼Œåˆ™æ˜¯æ›¿æ¢(å…¨é‡ä¿®æ”¹åŸæ–‡æ¡£)</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs sql">POST _bulk<br>&#123;<br>  &quot;index&quot;: &#123;<br>    &quot;_index&quot;: &quot;article&quot;,<br>    &quot;_type&quot;: &quot;_doc&quot;,<br>    &quot;_id&quot;: <span class="hljs-number">3</span><br>  &#125;<br>&#125;<br>&#123;<br>  &quot;id&quot;: <span class="hljs-number">3</span>,<br>  &quot;title&quot;: &quot;æ›´æ–°åçš„æ–‡ç« 1&quot;,<br>  &quot;content&quot;: &quot;æ›´æ–°åçš„å†…å®¹1&quot;,<br>  &quot;tags&quot;: [<br>    &quot;tag1&quot;,<br>    &quot;tag2&quot;<br>  ],<br>  &quot;create_time&quot;: <span class="hljs-number">1554015482530</span><br>&#125;<br>&#123;<br>  &quot;index&quot;: &#123;<br>    &quot;_index&quot;: &quot;article&quot;,<br>    &quot;_type&quot;: &quot;_doc&quot;,<br>    &quot;_id&quot;: <span class="hljs-number">5</span><br>  &#125;<br>&#125;<br>&#123;<br>  &quot;id&quot;: <span class="hljs-number">5</span>,<br>  &quot;title&quot;: &quot;æ–‡ç« 5&quot;,<br>  &quot;content&quot;: &quot;å†…å®¹5&quot;,<br>  &quot;tags&quot;: [<br>    &quot;tag5&quot;,<br>    &quot;tag14&quot;<br>  ],<br>  &quot;create_time&quot;: <span class="hljs-number">1554015482530</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ‰¹é‡ä¿®æ”¹update"><a href="#æ‰¹é‡ä¿®æ”¹update" class="headerlink" title="æ‰¹é‡ä¿®æ”¹update"></a>æ‰¹é‡ä¿®æ”¹update</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs sql">POST _bulk<br>&#123;<br>  &quot;update&quot;: &#123;<br>    &quot;_index&quot;: &quot;article&quot;,<br>    &quot;_type&quot;: &quot;_doc&quot;,<br>    &quot;_id&quot;: <span class="hljs-number">3</span><br>  &#125;<br>&#125;<br>&#123;<br>  &quot;doc&quot;: &#123;<br>    &quot;title&quot;: &quot;æ›´æ–°åçš„æ–‡ç« 11&quot;,<br>    &quot;content&quot;: &quot;æ›´æ–°åçš„å†…å®¹11&quot;<br>  &#125;<br>&#125;<br>&#123;<br>  &quot;update&quot;: &#123;<br>    &quot;_index&quot;: &quot;article&quot;,<br>    &quot;_type&quot;: &quot;_doc&quot;,<br>    &quot;_id&quot;: <span class="hljs-number">5</span><br>  &#125;<br>&#125;<br>&#123;<br>  &quot;doc&quot;: &#123;<br>    &quot;title&quot;: &quot;æ–‡ç« 51&quot;,<br>    &quot;content&quot;: &quot;å†…å®¹51&quot;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ‰¹é‡åˆ é™¤delete"><a href="#æ‰¹é‡åˆ é™¤delete" class="headerlink" title="æ‰¹é‡åˆ é™¤delete"></a>æ‰¹é‡åˆ é™¤delete</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql">POST _bulk<br>&#123;<br>  &quot;delete&quot;: &#123;<br>    &quot;_index&quot;: &quot;article&quot;,<br>    &quot;_type&quot;: &quot;_doc&quot;,<br>    &quot;_id&quot;: <span class="hljs-number">3</span><br>  &#125;<br>&#125;<br>&#123;<br>  &quot;delete&quot;: &#123;<br>    &quot;_index&quot;: &quot;article&quot;,<br>    &quot;_type&quot;: &quot;_doc&quot;,<br>    &quot;_id&quot;: <span class="hljs-number">4</span><br>  &#125;<br>&#125;s<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Elasticsearchæ•°æ®ç®¡ç†</title>
    <link href="/ES%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/"/>
    <url>/ES%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="ESæ•°æ®ç®¡ç†"><a href="#ESæ•°æ®ç®¡ç†" class="headerlink" title="ESæ•°æ®ç®¡ç†"></a>ESæ•°æ®ç®¡ç†</h1><h2 id="ESæ•°æ®ç®¡ç†æ¦‚è¿°"><a href="#ESæ•°æ®ç®¡ç†æ¦‚è¿°" class="headerlink" title="ESæ•°æ®ç®¡ç†æ¦‚è¿°"></a>ESæ•°æ®ç®¡ç†æ¦‚è¿°</h2><ul><li>ESæ˜¯é¢å‘æ–‡æ¡£(document oriented)çš„ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥å­˜å‚¨æ•´ä¸ªå¯¹è±¡æˆ–æ–‡æ¡£ (document)ã€‚</li><li>ç„¶è€Œå®ƒä¸ä»…ä»…æ˜¯å­˜å‚¨ï¼Œè¿˜ä¼šç´¢å¼•(index)æ¯ä¸ªæ–‡æ¡£çš„å†…å®¹ä½¿ä¹‹å¯ä»¥è¢«æœç´¢ã€‚</li><li>åœ¨ESä¸­ï¼Œä½ å¯ä»¥å¯¹æ–‡æ¡£ï¼ˆè€Œéæˆè¡Œæˆåˆ—çš„æ•°æ®ï¼‰è¿›è¡Œç´¢å¼•ã€æœç´¢ã€æ’åºã€è¿‡æ»¤ã€‚</li><li>ESä½¿ç”¨JSONä½œä¸ºæ–‡æ¡£åºåˆ—åŒ–æ ¼å¼ã€‚</li></ul><p><strong>ESå­˜å‚¨çš„ä¸€ä¸ªå‘˜å·¥æ–‡æ¡£çš„æ ¼å¼ç¤ºä¾‹ï¼š</strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">&#123; <br> &quot;email&quot;: &quot;584614151@qq.com&quot;,<br> &quot;name&quot;: &quot;å¼ ä¸‰&quot;, <br> &quot;age&quot;: <span class="hljs-number">30</span>,<br> &quot;interests&quot;: [ &quot;ç¯®çƒ&quot;, &quot;å¥èº«&quot; ]<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>JSONç°åœ¨å·²ç»è¢«å¤§å¤šè¯­è¨€æ‰€æ”¯æŒï¼Œè€Œä¸”å·²ç»æˆä¸ºNoSQLé¢†åŸŸçš„æ ‡å‡†æ ¼å¼ã€‚ </p></blockquote><h2 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h2><h3 id="åˆ›å»ºç´¢å¼•"><a href="#åˆ›å»ºç´¢å¼•" class="headerlink" title="åˆ›å»ºç´¢å¼•"></a>åˆ›å»ºç´¢å¼•</h3><p>æ ¼å¼: PUT &#x2F;ç´¢å¼•åç§°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">PUT <span class="hljs-operator">/</span>es_db<br></code></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢ç´¢å¼•"><a href="#æŸ¥è¯¢ç´¢å¼•" class="headerlink" title="æŸ¥è¯¢ç´¢å¼•"></a>æŸ¥è¯¢ç´¢å¼•</h3><p>æ ¼å¼: GET &#x2F;ç´¢å¼•åç§° </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<br></code></pre></td></tr></table></figure><h3 id="åˆ é™¤ç´¢å¼•"><a href="#åˆ é™¤ç´¢å¼•" class="headerlink" title="åˆ é™¤ç´¢å¼•"></a>åˆ é™¤ç´¢å¼•</h3><p>æ ¼å¼: DELETE &#x2F;ç´¢å¼•åç§°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-operator">/</span>es_db<br></code></pre></td></tr></table></figure><h3 id="æ·»åŠ æ–‡æ¡£"><a href="#æ·»åŠ æ–‡æ¡£" class="headerlink" title="æ·»åŠ æ–‡æ¡£"></a>æ·»åŠ æ–‡æ¡£</h3><ul><li>æ ¼å¼: POST &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;id(å¯é€‰ï¼Œä¸ä¼ ä¼šåˆ›å»ºé»˜è®¤çš„id)</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">POST <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<br>&#123;<br>  &quot;name&quot;: &quot;å¼ ä¸‰&quot;,<br>  &quot;sex&quot;: <span class="hljs-number">1</span>,<br>  &quot;age&quot;: <span class="hljs-number">25</span>,<br>  &quot;address&quot;: &quot;å¹¿å·å¤©æ²³å…¬å›­&quot;,<br>  &quot;remark&quot;: &quot;java developer&quot;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æ ¼å¼: PUT &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;id</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">PUT <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span><span class="hljs-number">1</span><br>&#123;<br>  &quot;name&quot;: &quot;å¼ ä¸‰&quot;,<br>  &quot;sex&quot;: <span class="hljs-number">1</span>,<br>  &quot;age&quot;: <span class="hljs-number">25</span>,<br>  &quot;address&quot;: &quot;å¹¿å·å¤©æ²³å…¬å›­&quot;,<br>  &quot;remark&quot;: &quot;java developer&quot;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä¿®æ”¹æ–‡æ¡£"><a href="#ä¿®æ”¹æ–‡æ¡£" class="headerlink" title="ä¿®æ”¹æ–‡æ¡£"></a>ä¿®æ”¹æ–‡æ¡£</h3><ul><li>æ ¼å¼: PUT &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;id</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">PUT <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span><span class="hljs-number">1</span><br>&#123;<br>  &quot;name&quot;: &quot;å¼ ä¸‰&quot;,<br>  &quot;sex&quot;: <span class="hljs-number">1</span>,<br>  &quot;age&quot;: <span class="hljs-number">25</span>,<br>  &quot;address&quot;: &quot;å¹¿å·å¤©æ²³å…¬å›­&quot;,<br>  &quot;remark&quot;: &quot;java developer&quot;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢æ–‡æ¡£"><a href="#æŸ¥è¯¢æ–‡æ¡£" class="headerlink" title="æŸ¥è¯¢æ–‡æ¡£"></a>æŸ¥è¯¢æ–‡æ¡£</h3><p>æ ¼å¼: GET &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;id </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h3 id="åˆ é™¤æ–‡æ¡£"><a href="#åˆ é™¤æ–‡æ¡£" class="headerlink" title="åˆ é™¤æ–‡æ¡£"></a>åˆ é™¤æ–‡æ¡£</h3><p>æ ¼å¼: DELETE &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;id </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢æ“ä½œ"><a href="#æŸ¥è¯¢æ“ä½œ" class="headerlink" title="æŸ¥è¯¢æ“ä½œ"></a>æŸ¥è¯¢æ“ä½œ</h3><h4 id="æŸ¥è¯¢å½“å‰ç±»å‹ä¸­çš„æ‰€æœ‰æ–‡æ¡£-search"><a href="#æŸ¥è¯¢å½“å‰ç±»å‹ä¸­çš„æ‰€æœ‰æ–‡æ¡£-search" class="headerlink" title="æŸ¥è¯¢å½“å‰ç±»å‹ä¸­çš„æ‰€æœ‰æ–‡æ¡£ _search"></a>æŸ¥è¯¢å½“å‰ç±»å‹ä¸­çš„æ‰€æœ‰æ–‡æ¡£ _search</h4><p> æ ¼å¼: GET &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;_search </p><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span>_search <br></code></pre></td></tr></table></figure><h4 id="æ¡ä»¶æŸ¥è¯¢"><a href="#æ¡ä»¶æŸ¥è¯¢" class="headerlink" title="æ¡ä»¶æŸ¥è¯¢"></a>æ¡ä»¶æŸ¥è¯¢</h4><ul><li><p>æ ¼å¼: GET &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;_search?q&#x3D;<em>:</em>** </p></li><li><p>SQL: select * from student where age &#x3D; 28</p></li></ul><p>ä¸¾ä¾‹ï¼šå¦‚è¦æŸ¥è¯¢ageç­‰äº28å²çš„ _search?q&#x3D;<em>:</em>** </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span>_search?q<span class="hljs-operator">=</span>age:<span class="hljs-number">28</span> <br></code></pre></td></tr></table></figure><h4 id="èŒƒå›´æŸ¥è¯¢"><a href="#èŒƒå›´æŸ¥è¯¢" class="headerlink" title="èŒƒå›´æŸ¥è¯¢"></a>èŒƒå›´æŸ¥è¯¢</h4><h5 id="in"><a href="#in" class="headerlink" title="in"></a>in</h5><ul><li>æ ¼å¼: GET &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;_search?q&#x3D;***[25 TO 26] </li><li>SQL: select * from student where age between 25 and 26</li></ul><p>ä¸¾ä¾‹ï¼šå¦‚è¦æŸ¥è¯¢ageåœ¨25è‡³26å²ä¹‹é—´çš„ </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span>_search?q<span class="hljs-operator">=</span>age[<span class="hljs-number">25</span> <span class="hljs-keyword">TO</span> <span class="hljs-number">26</span>] <br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„: TO å¿…é¡»ä¸ºå¤§å†™</strong> </p><h5 id="å¤§äº"><a href="#å¤§äº" class="headerlink" title="å¤§äº"></a>å¤§äº</h5><ul><li>æ ¼å¼:  GET &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;_search?q&#x3D;age:&gt;** </li><li>SQL: select * from student where age &gt; 28</li></ul><p>ä¸¾ä¾‹ï¼šæŸ¥è¯¢å¹´é¾„å¤§äº28çš„ </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span>_search?q<span class="hljs-operator">=</span>age:<span class="hljs-operator">&gt;</span><span class="hljs-number">28</span><br></code></pre></td></tr></table></figure><h5 id="å°äºç­‰äº"><a href="#å°äºç­‰äº" class="headerlink" title="å°äºç­‰äº"></a>å°äºç­‰äº</h5><ul><li>æ ¼å¼: GET &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;_search?q&#x3D;age:&lt;&#x3D;** </li><li>SQL: select * from student where age &lt;&#x3D; 28</li></ul><p>ä¸¾ä¾‹ï¼šæŸ¥è¯¢å¹´é¾„å°äºç­‰äº28å²çš„</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span>_search?q<span class="hljs-operator">=</span>age:<span class="hljs-operator">&lt;=</span><span class="hljs-number">28</span><br></code></pre></td></tr></table></figure><h4 id="æ‰¹é‡æŸ¥è¯¢"><a href="#æ‰¹é‡æŸ¥è¯¢" class="headerlink" title="æ‰¹é‡æŸ¥è¯¢"></a>æ‰¹é‡æŸ¥è¯¢</h4><ul><li>æ ¼å¼: GET &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;_mget </li><li>SQL: select * from student where id in (1,2)</li></ul><p>ä¸¾ä¾‹ï¼šæ ¹æ®å¤šä¸ªIDè¿›è¡Œæ‰¹é‡æŸ¥è¯¢</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span>_mget<br>&#123;<br>  &quot;ids&quot;:[&quot;3&quot;,&quot;2&quot;]<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="åˆ†é¡µæŸ¥è¯¢"><a href="#åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h4><ul><li><p>æ ¼å¼: GET &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;_search?q&#x3D;age[25 TO 26]&amp;from&#x3D;0&amp;size&#x3D;1 </p></li><li><p>SQL: select * from student where age between 25 and 26 limit 0, 1</p></li></ul><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span>_search?q<span class="hljs-operator">=</span>age[<span class="hljs-number">25</span> <span class="hljs-keyword">TO</span> <span class="hljs-number">26</span>]<span class="hljs-operator">&amp;</span><span class="hljs-keyword">from</span><span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-operator">&amp;</span>size<span class="hljs-operator">=</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h4 id="æŸ¥è¯¢ç»“æœåªè¾“å‡ºæŸäº›å­—æ®µ"><a href="#æŸ¥è¯¢ç»“æœåªè¾“å‡ºæŸäº›å­—æ®µ" class="headerlink" title="æŸ¥è¯¢ç»“æœåªè¾“å‡ºæŸäº›å­—æ®µ"></a>æŸ¥è¯¢ç»“æœåªè¾“å‡ºæŸäº›å­—æ®µ</h4><ul><li>æ ¼å¼: GET &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;_search?_source&#x3D;å­—æ®µ,å­—æ®µ</li><li>SQL: select name,age from student</li></ul><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span>_search?_source<span class="hljs-operator">=</span>name,age<br></code></pre></td></tr></table></figure><h4 id="æŸ¥è¯¢ç»“æœæ’åº"><a href="#æŸ¥è¯¢ç»“æœæ’åº" class="headerlink" title="æŸ¥è¯¢ç»“æœæ’åº"></a>æŸ¥è¯¢ç»“æœæ’åº</h4><ul><li>æ ¼å¼: GET &#x2F;ç´¢å¼•åç§°&#x2F;ç±»å‹&#x2F;_search?sort&#x3D;å­—æ®µ desc </li><li>SQL: select * from student order by age desc</li></ul><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>es_db<span class="hljs-operator">/</span>_doc<span class="hljs-operator">/</span>_search?sort<span class="hljs-operator">=</span>age:<span class="hljs-keyword">desc</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Elasticsearchå®‰è£…</title>
    <link href="/Elasticsearch%E5%AE%89%E8%A3%85/"/>
    <url>/Elasticsearch%E5%AE%89%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h1 id="Elasticsearchå®‰è£…"><a href="#Elasticsearchå®‰è£…" class="headerlink" title="Elasticsearchå®‰è£…"></a>Elasticsearchå®‰è£…</h1><p>1.ä¸‹è½½es.  Es ä¸‹è½½é“¾æ¥ï¼š <a href="https://www.elastic.co/cn/downloads/elasticsearch">Download Elasticsearch | Elastic</a></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230445183.png" alt="image-20230228230445183"></p><p>2.è§£å‹ååœ¨binè·¯å¾„ä¸‹ï¼Œè¿è¡Œ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">âœ  bin .<span class="hljs-operator">/</span>elasticsearch <span class="hljs-operator">-</span>d<br></code></pre></td></tr></table></figure><p>3.è®¿é—®<a href="http://localhost:9200/">localhost:9200</a>,çœ‹åˆ°ä¸‹é¢çš„é¡µé¢å³å¯åŠ¨æˆåŠŸ</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230454065.png" alt="image-20230228230454065"></p><h1 id="Kibanaå®‰è£…"><a href="#Kibanaå®‰è£…" class="headerlink" title="Kibanaå®‰è£…"></a>Kibanaå®‰è£…</h1><ol><li>Kibana ä¸‹è½½é“¾æ¥ï¼š<a href="https://www.elastic.co/cn/downloads/kibana">Download Kibana Free | Get Started Now | Elastic</a></li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230502701.png" alt="image-20230228230502701"></p><ol start="2"><li>ä¿®æ”¹ kibana.yml</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">server.port: <span class="hljs-number">5601</span><br>server.host: &quot;localhost&quot;<br>elasticsearch.hosts: [&quot;http://localhost:9200&quot;]<br></code></pre></td></tr></table></figure><p>3.è®¿é—®<a href="http://localhost:5601/app/kibana">http://localhost:5601/app/kibana</a>, çœ‹åˆ°ä¸‹é¢çš„é¡µé¢å³å¯åŠ¨æˆåŠŸ</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230512243.png" alt="image-20230228230512243"></p><h1 id="å®‰è£…IKåˆ†è¯å™¨"><a href="#å®‰è£…IKåˆ†è¯å™¨" class="headerlink" title="å®‰è£…IKåˆ†è¯å™¨"></a>å®‰è£…IKåˆ†è¯å™¨</h1><p>æˆ‘ä»¬åç»­ä¹Ÿéœ€è¦ä½¿ç”¨Elasticsearchæ¥è¿›è¡Œä¸­æ–‡åˆ†è¯ï¼Œæ‰€ä»¥éœ€è¦å•ç‹¬ç»™Elasticsearchå®‰è£…IKåˆ†è¯å™¨æ’ä»¶ã€‚ä»¥ä¸‹ä¸ºå…·ä½“å®‰è£…æ­¥éª¤ï¼š</p><ol><li><p>ä¸‹è½½ElasticsearchIKåˆ†è¯å™¨ <a href="https://github.com/medcl/elasticsearch-analysis-ik/releases">https://github.com/medcl/elasticsearch-analysis-ik/releases</a></p></li><li><p>åœ¨esçš„å®‰è£…ç›®å½•ä¸‹&#x2F;pluginsåˆ›å»ºikï¼Œå°†ä¸‹è½½çš„ikåˆ†è¯å™¨ä¸Šä¼ å¹¶è§£å‹åˆ°è¯¥ç›®å½•</p></li><li><p>é‡å¯Elasticsearch</p></li></ol>   <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">æŸ¥æ‰¾è¿›ç¨‹å‘½ä»¤ ps <span class="hljs-operator">-</span>ef <span class="hljs-operator">|</span> grep elastic<br>æ€æ‰è¿›ç¨‹ kill <span class="hljs-number">-9</span> <span class="hljs-number">2382</span>ï¼ˆè¿›ç¨‹å·ï¼‰<br></code></pre></td></tr></table></figure><ol start="4"><li>æµ‹è¯•åˆ†è¯æ•ˆæœï¼Œè®¿é—®<a href="http://localhost:5601/app/dev_tools#/console">Dev Tools - Elastic</a></li></ol>   <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">POST _analyze<br>&#123;<br>&quot;analyzer&quot;:&quot;standard&quot;,<br>&quot;text&quot;:&quot;æˆ‘çˆ±ä½ ä¸­å›½&quot;<br>&#125;<br></code></pre></td></tr></table></figure><p>   <img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230530722.png" alt="image-20230228230530722"></p><ul><li>ik_smart:ä¼šåšæœ€ç²—ç²’åº¦çš„æ‹†åˆ†</li></ul>   <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">POST _analyze<br>&#123;<br>&quot;analyzer&quot;:&quot;ik_smart&quot;,<br>&quot;text&quot;:&quot;æˆ‘çˆ±ä½ ä¸­å›½&quot;<br>&#125;<br></code></pre></td></tr></table></figure><p>   <img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230546771.png" alt="image-20230228230546771"></p><ul><li>k_max_word:ä¼šå°†æ–‡æœ¬åšæœ€ç»†ç²’åº¦çš„æ‹†åˆ†</li></ul>   <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">POST _analyze<br>&#123;<br>&quot;analyzer&quot;:&quot;ik_max_word&quot;,<br>&quot;text&quot;:&quot;æˆ‘çˆ±ä½ ä¸­å›½&quot;<br>&#125;<br></code></pre></td></tr></table></figure><p>   <img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230556755.png" alt="image-20230228230556755"></p><h1 id="æŒ‡å®šIKåˆ†è¯å™¨ä½œä¸ºé»˜è®¤åˆ†è¯å™¨"><a href="#æŒ‡å®šIKåˆ†è¯å™¨ä½œä¸ºé»˜è®¤åˆ†è¯å™¨" class="headerlink" title="æŒ‡å®šIKåˆ†è¯å™¨ä½œä¸ºé»˜è®¤åˆ†è¯å™¨"></a>æŒ‡å®šIKåˆ†è¯å™¨ä½œä¸ºé»˜è®¤åˆ†è¯å™¨</h1><p>â€‹        ESçš„é»˜è®¤åˆ†è¯è®¾ç½®æ˜¯standardï¼Œè¿™ä¸ªåœ¨ä¸­æ–‡åˆ†è¯æ—¶å°±æ¯”è¾ƒå°´å°¬äº†ï¼Œä¼šå•å­—æ‹†åˆ†ï¼Œæ¯”å¦‚æˆ‘æœç´¢å…³é”®è¯â€œæ¸…åå¤§å­¦â€ï¼Œè¿™æ—¶å€™ä¼šæŒ‰â€œæ¸…â€ï¼Œâ€œåâ€ï¼Œâ€œå¤§â€ï¼Œâ€œå­¦â€å»åˆ†è¯ï¼Œç„¶åæœå‡ºæ¥çš„éƒ½æ˜¯äº›â€œæ¸…æ¸…çš„æ²³æ°´â€ï¼Œâ€œä¸­åå„¿å¥³â€ï¼Œâ€œåœ°å¤§ç‰©åšâ€ï¼Œâ€œå­¦è€Œä¸æ€åˆ™ç½”â€ä¹‹ç±»çš„è«åå…¶å¦™çš„ç»“æœï¼Œ</p><p>â€‹        è¿™é‡Œæˆ‘ä»¬å°±æƒ³æŠŠè¿™ä¸ªåˆ†è¯æ–¹å¼ä¿®æ”¹ä¸€ä¸‹ï¼Œäºæ˜¯å‘¢ï¼Œå°±æƒ³åˆ°äº†ikåˆ†è¯å™¨ï¼Œæœ‰ä¸¤ç§ik_smartå’Œik_max_wordã€‚ik_smartä¼šå°†â€œæ¸…åå¤§å­¦â€æ•´ä¸ªåˆ†ä¸ºä¸€ä¸ªè¯ï¼Œè€Œik_max_wordä¼šå°†â€œæ¸…åå¤§å­¦â€åˆ†ä¸ºâ€œæ¸…åå¤§å­¦â€ï¼Œâ€œæ¸…åâ€å’Œâ€œå¤§å­¦â€ï¼ŒæŒ‰éœ€é€‰å…¶ä¸­ä¹‹ä¸€å°±å¯ä»¥äº†ã€‚ä¿®æ”¹é»˜è®¤åˆ†è¯æ–¹æ³•(è¿™é‡Œä¿®æ”¹school_indexç´¢å¼•çš„é»˜è®¤åˆ†è¯ä¸ºï¼šik_max_word)ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">PUT <span class="hljs-operator">/</span>school_index<br>&#123;<br>  &quot;settings&quot;:&#123;<br>    &quot;index&quot;:&#123;<br>      &quot;analysis.analyzer.default.type&quot;:&quot;ik_max_word&quot;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230604782.png" alt="image-20230228230604782"></p>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ElasticSearché›†ç¾¤æ­å»º</title>
    <link href="/ElasticSearch%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/"/>
    <url>/ElasticSearch%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="ElasticSearché›†ç¾¤æ­å»º"><a href="#ElasticSearché›†ç¾¤æ­å»º" class="headerlink" title="ElasticSearché›†ç¾¤æ­å»º"></a>ElasticSearché›†ç¾¤æ­å»º</h1><h2 id="ç›¸å…³æ¦‚å¿µ"><a href="#ç›¸å…³æ¦‚å¿µ" class="headerlink" title="ç›¸å…³æ¦‚å¿µ"></a>ç›¸å…³æ¦‚å¿µ</h2><h3 id="é›†ç¾¤cluster"><a href="#é›†ç¾¤cluster" class="headerlink" title="é›†ç¾¤cluster"></a>é›†ç¾¤cluster</h3><p>ä¸€ä¸ªé›†ç¾¤å°±æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹ç»„ç»‡åœ¨ä¸€èµ·ï¼Œå®ƒä»¬å…±åŒæŒæœ‰æ•´ä¸ªçš„æ•°æ®ï¼Œå¹¶ä¸€èµ·æä¾›ç´¢å¼•å’Œæœç´¢åŠŸèƒ½</p><h3 id="èŠ‚ç‚¹node"><a href="#èŠ‚ç‚¹node" class="headerlink" title="èŠ‚ç‚¹node"></a>èŠ‚ç‚¹node</h3><ul><li>ä¸€ä¸ªèŠ‚ç‚¹æ˜¯é›†ç¾¤ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä½œä¸ºé›†ç¾¤çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå­˜å‚¨æ•°æ®ã€‚å‚ä¸é›†ç¾¤çš„ç´¢å¼•å’Œæœç´¢åŠŸèƒ½ã€‚</li><li>ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥é€šè¿‡é…ç½®é›†ç¾¤åç§°çš„æ–¹å¼æ¥åŠ å…¥ä¸€ä¸ªæŒ‡å®šçš„é›†ç¾¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šè¢«å®‰æ’åŠ å…¥åˆ°ä¸€ä¸ªå«åšâ€œelasticsearchâ€çš„é›†ç¾¤ä¸­ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœåœ¨ç½‘ç»œä¸­å¯åŠ¨äº†è‹¥å¹²ä¸ªèŠ‚ç‚¹ï¼Œå¹¶å‡å®šå®ƒä»¬èƒ½å¤Ÿç›¸äº’å‘ç°å½¼æ­¤ï¼Œå®ƒä»¬å°†ä¼šè‡ªåŠ¨åœ°å½¢æˆå¹¶åŠ å…¥åˆ°ä¸€ä¸ªå«åšâ€œelasticsearchâ€çš„é›†ç¾¤ä¸­ã€‚</li><li>åœ¨ä¸€ä¸ªé›†ç¾¤é‡Œï¼Œå¯ä»¥æ‹¥æœ‰ä»»æ„å¤šä¸ªèŠ‚ç‚¹ã€‚è€Œä¸”ï¼Œå¦‚æœå½“å‰ç½‘ç»œä¸­æ²¡æœ‰è¿è¡Œä»»ä½•ElasticsearchèŠ‚ç‚¹ï¼Œè¿™æ—¶å¯åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¼šé»˜è®¤åˆ›å»ºå¹¶åŠ å…¥ä¸€ä¸ªå«åšâ€œelasticsearchâ€çš„é›†ç¾¤ã€‚</li></ul><h3 id="åˆ†ç‰‡å’Œå‰¯æœ¬shards-amp-replicas"><a href="#åˆ†ç‰‡å’Œå‰¯æœ¬shards-amp-replicas" class="headerlink" title="åˆ†ç‰‡å’Œå‰¯æœ¬shards&amp;replicas"></a>åˆ†ç‰‡å’Œå‰¯æœ¬shards&amp;replicas</h3>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>clickHouseçš„SQLæ“ä½œ</title>
    <link href="/clickHouse%E7%9A%84SQL%E6%93%8D%E4%BD%9C-1/"/>
    <url>/clickHouse%E7%9A%84SQL%E6%93%8D%E4%BD%9C-1/</url>
    
    <content type="html"><![CDATA[<h1 id="ClickHouseçš„SQLæ“ä½œ"><a href="#ClickHouseçš„SQLæ“ä½œ" class="headerlink" title="ClickHouseçš„SQLæ“ä½œ"></a>ClickHouseçš„SQLæ“ä½œ</h1><p>åŸºæœ¬ä¸Šæ¥è¯´ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ï¼ˆä»¥ MySQL ä¸ºä¾‹ï¼‰çš„ SQL è¯­å¥ï¼ŒClickHouse åŸºæœ¬éƒ½æ”¯æŒï¼Œè¿™é‡Œä¸ä¼šä»å¤´è®²è§£ SQL è¯­æ³•åªä»‹ç» ClickHouse ä¸æ ‡å‡† SQLï¼ˆMySQLï¼‰ä¸ä¸€è‡´çš„åœ°æ–¹</p><h2 id="Insert"><a href="#Insert" class="headerlink" title="Insert"></a>Insert</h2><p>åŸºæœ¬ä¸æ ‡å‡† SQLï¼ˆMySQLï¼‰åŸºæœ¬ä¸€è‡´</p><p>ï¼ˆ1ï¼‰æ ‡å‡†</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> [table_name] <span class="hljs-keyword">values</span>(â€¦),(â€¦.)<br></code></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰ä»è¡¨åˆ°è¡¨çš„æ’å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> [table_name] <span class="hljs-keyword">select</span> a,b,c <span class="hljs-keyword">from</span> [table_name_2]<br></code></pre></td></tr></table></figure><h2 id="Update-å’ŒDelete"><a href="#Update-å’ŒDelete" class="headerlink" title="Update å’ŒDelete"></a>Update å’ŒDelete</h2><ul><li><p>ClickHouse æä¾›äº† Delete å’Œ Update çš„èƒ½åŠ›ï¼Œè¿™ç±»æ“ä½œè¢«ç§°ä¸º Mutation æŸ¥è¯¢ï¼Œå®ƒå¯ä»¥çœ‹åš Alter çš„ä¸€ç§ã€‚</p></li><li><p>è™½ç„¶å¯ä»¥å®ç°ä¿®æ”¹å’Œåˆ é™¤ï¼Œä½†æ˜¯å’Œä¸€èˆ¬çš„ OLTP æ•°æ®åº“ä¸ä¸€æ ·ï¼Œ<strong>Mutation</strong> è¯­å¥æ˜¯ä¸€ç§å¾ˆé‡çš„æ“ä½œï¼Œè€Œä¸”ä¸æ”¯æŒäº‹åŠ¡ã€‚</p><blockquote><p>â€œé‡â€çš„åŸå› ä¸»è¦æ˜¯æ¯æ¬¡ä¿®æ”¹æˆ–è€…åˆ é™¤éƒ½ä¼šå¯¼è‡´æ”¾å¼ƒç›®æ ‡æ•°æ®çš„åŸæœ‰åˆ†åŒºï¼Œé‡å»ºæ–°åˆ†åŒºã€‚åˆå¹¶çš„æ—¶å€™æ‰ä¼šåˆ é™¤åŸæœ‰åˆ†åŒºï¼Œæ‰€ä»¥å°½é‡åšæ‰¹é‡çš„å˜æ›´ï¼Œä¸è¦è¿›è¡Œé¢‘ç¹å°æ•°æ®çš„æ“ä½œã€‚</p></blockquote></li></ul><h3 id="åˆ é™¤æ“ä½œ"><a href="#åˆ é™¤æ“ä½œ" class="headerlink" title="åˆ é™¤æ“ä½œ"></a>åˆ é™¤æ“ä½œ</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> t_order_smt <span class="hljs-keyword">delete</span> <span class="hljs-keyword">where</span> sku_id <span class="hljs-operator">=</span><span class="hljs-string">&#x27;sku_001&#x27;</span>;<br></code></pre></td></tr></table></figure><h3 id="ä¿®æ”¹æ“ä½œ"><a href="#ä¿®æ”¹æ“ä½œ" class="headerlink" title="ä¿®æ”¹æ“ä½œ"></a>ä¿®æ”¹æ“ä½œ</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> t_order_smt update total_amount<span class="hljs-operator">=</span>toDecimal32(<span class="hljs-number">2000.00</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span><span class="hljs-number">102</span>;<br></code></pre></td></tr></table></figure><h3 id="å¼€å‘å»ºè®®"><a href="#å¼€å‘å»ºè®®" class="headerlink" title="å¼€å‘å»ºè®®"></a>å¼€å‘å»ºè®®</h3><p>clickhouseè™½ç„¶æ”¯æŒ Delete å’Œ Update çš„èƒ½åŠ›ï¼Œä½†æ˜¯è¿™ç±»æ“ä½œå¾ˆé‡ï¼Œä¸€èˆ¬å»ºè®®ä¸è¦ä½¿ç”¨ï¼Œå¦‚æœè¦ä½¿ç”¨ï¼Œéƒ½å¯ä»¥é‡‡ç”¨å¢åŠ æ•°æ®çš„æ–¹å¼æ¥å®ç°ï¼Œå¦‚æ›´æ–°çš„è¯ï¼Œå¯ä»¥ç»™åˆ—æ–°åŠ ç‰ˆæœ¬å·ï¼›åˆ é™¤çš„è¯ï¼Œå¯ä»¥å¢åŠ ä¸€åˆ—åˆ é™¤æ ‡è®°ä¸ºï¼šdelete_atï¼Œä½†è¿™æ ·ä¼šé€ æˆæ•°æ®è†¨èƒ€ï¼Œå¯ä»¥å®šæœŸåˆ é™¤å¤±æ•ˆçš„æ•°æ®ã€‚</p><h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><p>ClickHouse åŸºæœ¬ä¸Šä¸æ ‡å‡† SQL å·®åˆ«ä¸å¤§</p><p>â¢ æ”¯æŒå­æŸ¥è¯¢</p><p>â¢ æ”¯æŒ CTE(Common Table Expression å…¬ç”¨è¡¨è¡¨è¾¾å¼ with å­å¥) </p><p>â¢ æ”¯æŒå„ç§ JOINï¼Œä½†æ˜¯ JOIN æ“ä½œæ— æ³•ä½¿ç”¨ç¼“å­˜ï¼Œæ‰€ä»¥å³ä½¿æ˜¯ä¸¤æ¬¡ç›¸åŒçš„ JOIN è¯­å¥ï¼ŒClickHouse ä¹Ÿä¼šè§†ä¸ºä¸¤æ¡æ–° SQL</p><p>â¢ çª—å£å‡½æ•°</p><p>â¢ ä¸æ”¯æŒè‡ªå®šä¹‰å‡½æ•°</p><p>â¢ GROUP BY æ“ä½œå¢åŠ äº† with rollup\with cube\with total ç”¨æ¥è®¡ç®—å°è®¡å’Œæ€»è®¡ã€‚</p><p><strong>æ¼”ç¤º</strong></p><p>ï¼ˆ1ï¼‰æ’å…¥æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql">bfdf602492c9 :)  <span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> t_order_mt <span class="hljs-keyword">delete</span> <span class="hljs-keyword">where</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>;<br>bfdf602492c9 :) <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_order_mt <span class="hljs-keyword">values</span><br>                (<span class="hljs-number">101</span>,<span class="hljs-string">&#x27;sku_001&#x27;</span>,<span class="hljs-number">1000.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>),<br>                (<span class="hljs-number">101</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>),<br>                (<span class="hljs-number">103</span>,<span class="hljs-string">&#x27;sku_004&#x27;</span>,<span class="hljs-number">2500.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>),<br>                (<span class="hljs-number">104</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>),<br>                (<span class="hljs-number">105</span>,<span class="hljs-string">&#x27;sku_003&#x27;</span>,<span class="hljs-number">600.00</span>,<span class="hljs-string">&#x27;2020-06-02 12:00:00&#x27;</span>),<br>                (<span class="hljs-number">106</span>,<span class="hljs-string">&#x27;sku_001&#x27;</span>,<span class="hljs-number">1000.00</span>,<span class="hljs-string">&#x27;2020-06-04 12:00:00&#x27;</span>),<br>                (<span class="hljs-number">107</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-04 12:00:00&#x27;</span>),<br>                (<span class="hljs-number">108</span>,<span class="hljs-string">&#x27;sku_004&#x27;</span>,<span class="hljs-number">2500.00</span>,<span class="hljs-string">&#x27;2020-06-04 12:00:00&#x27;</span>),<br>                (<span class="hljs-number">109</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-04 12:00:00&#x27;</span>),<br>                (<span class="hljs-number">110</span>,<span class="hljs-string">&#x27;sku_003&#x27;</span>,<span class="hljs-number">600.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>);<br></code></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰with rollupï¼šä»å³è‡³å·¦å»æ‰ç»´åº¦è¿›è¡Œå°è®¡</p><p>å¯ä»¥çœ‹å‡ºåˆ†åˆ«æ ¹æ®  ã€id,sku_idã€‘ã€idã€‘ã€(ç©º)ã€‘ è¿›è¡Œäº†åˆ†ç»„</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">bfdf602492c9 :) <span class="hljs-keyword">select</span> id , sku_id,<span class="hljs-built_in">sum</span>(total_amount) <span class="hljs-keyword">from</span> t_order_mt <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> id,sku_id <span class="hljs-keyword">with</span> <span class="hljs-keyword">rollup</span>;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222258542.png" alt="image-20230228222258542"></p><p>ï¼ˆ3ï¼‰with cube : ä»å³è‡³å·¦å»æ‰ç»´åº¦è¿›è¡Œå°è®¡ï¼Œå†ä»å·¦è‡³å³å»æ‰ç»´åº¦è¿›è¡Œå°è®¡</p><p>å¯ä»¥çœ‹å‡ºåˆ†åˆ«æ ¹æ®  ã€id,sku_idã€‘ã€idã€‘ã€sku_idã€‘ã€(ç©º)ã€‘ è¿›è¡Œäº†åˆ†ç»„</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222316833.png" alt="image-20230228222316833"></p><p>ï¼ˆ4ï¼‰with totals: åªè®¡ç®—åˆè®¡</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">bfdf602492c9 :)  <span class="hljs-keyword">select</span> id , sku_id,<span class="hljs-built_in">sum</span>(total_amount) <span class="hljs-keyword">from</span> t_order_mt <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span><br>                id,sku_id <span class="hljs-keyword">with</span> totals;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222331141.png" alt="image-20230228222331141"></p><h2 id="alteræ“ä½œ"><a href="#alteræ“ä½œ" class="headerlink" title="alteræ“ä½œ"></a>alteræ“ä½œ</h2><p>åŒ MySQL çš„ä¿®æ”¹å­—æ®µåŸºæœ¬ä¸€è‡´</p><p>1ï¼‰æ–°å¢å­—æ®µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> tableName <span class="hljs-keyword">add</span> <span class="hljs-keyword">column</span> newcolname String after col1; <br></code></pre></td></tr></table></figure><p>2ï¼‰ä¿®æ”¹å­—æ®µç±»å‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> tableName modify <span class="hljs-keyword">column</span> newcolname String; <br></code></pre></td></tr></table></figure><p>3ï¼‰åˆ é™¤å­—æ®µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> tableName <span class="hljs-keyword">drop</span> <span class="hljs-keyword">column</span> newcolname; <br></code></pre></td></tr></table></figure><blockquote><p>æ›´å¤šè¯­æ³•å‚è€ƒï¼š<a href="https://clickhouse.com/docs/en/sql-reference/">ClickHouse Documentation</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Clickhouse</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®åº“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>clickhouseè¡¨å¼•æ“</title>
    <link href="/clickhouse%E8%A1%A8%E5%BC%95%E6%93%8E/"/>
    <url>/clickhouse%E8%A1%A8%E5%BC%95%E6%93%8E/</url>
    
    <content type="html"><![CDATA[<h1 id="è¡¨å¼•æ“ä»‹ç»"><a href="#è¡¨å¼•æ“ä»‹ç»" class="headerlink" title="è¡¨å¼•æ“ä»‹ç»"></a>è¡¨å¼•æ“ä»‹ç»</h1><p>è¡¨å¼•æ“æ˜¯ ClickHouse çš„ä¸€å¤§ç‰¹è‰²ã€‚ä¸åŒçš„å¼•æ“æœ‰ä¸åŒçš„ä½œç”¨ï¼Œå¯ä»¥è¯´ï¼Œ è¡¨å¼•æ“å†³å®šäº†å¦‚ä½•å­˜å‚¨è¡¨çš„æ•°æ®ã€‚åŒ…æ‹¬ï¼š</p><p>â¢ æ•°æ®çš„å­˜å‚¨æ–¹å¼å’Œä½ç½®ï¼Œå†™åˆ°å“ªé‡Œä»¥åŠä»å“ªé‡Œè¯»å–æ•°æ®ã€‚ ï¼ˆä¸€èˆ¬çš„å¼•æ“éƒ½å­˜åœ¨ç£ç›˜ä¸­ï¼Œä½†æ˜¯å­˜åœ¨ä¸å…¶ä»–æ•°æ®åº“ç»§æ‰¿çš„åœºæ™¯ï¼Œæ¯”å¦‚å’Œmysqlé›†æˆï¼Œæ•°æ®æ”¾åœ¨mysqlæœåŠ¡ç«¯ã€‚ï¼‰</p><p>â¢ æ”¯æŒå“ªäº›æŸ¥è¯¢ä»¥åŠå¦‚ä½•æ”¯æŒã€‚ï¼ˆæœ‰äº›è¯­æ³•åªæœ‰åœ¨ç‰¹å®šçš„å¼•æ“æ‰å¯ä»¥ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸èƒ½åœ¨ MergeTree è¡¨ä¸­å­˜å‚¨å¤šç»´æ•°ç»„ï¼‰</p><p>â¢ å¹¶å‘æ•°æ®è®¿é—®ã€‚ï¼ˆå¯ä»¥å¤šçº¿ç¨‹æ‰§è¡ŒåŒä¸€æ¡sqlï¼‰</p><p>â¢ ç´¢å¼•çš„ä½¿ç”¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚</p><p>â¢ æ˜¯å¦å¯ä»¥æ‰§è¡Œå¤šçº¿ç¨‹è¯·æ±‚ã€‚</p><p>â¢ æ•°æ®å¤åˆ¶å‚æ•°ã€‚</p><blockquote><p>è¡¨å¼•æ“çš„ä½¿ç”¨æ–¹å¼å°±æ˜¯å¿…é¡»æ˜¾å¼åœ¨åˆ›å»ºè¡¨æ—¶å®šä¹‰è¯¥è¡¨ä½¿ç”¨çš„å¼•æ“ï¼Œä»¥åŠå¼•æ“ä½¿ç”¨çš„ç›¸å…³å‚æ•°ã€‚</p></blockquote><p><strong>ç‰¹åˆ«æ³¨æ„ï¼šå¼•æ“çš„åç§°å¤§å°å†™æ•æ„Ÿ</strong></p><h1 id="åˆå¹¶æ ‘å®¶æ—"><a href="#åˆå¹¶æ ‘å®¶æ—" class="headerlink" title="åˆå¹¶æ ‘å®¶æ—"></a>åˆå¹¶æ ‘å®¶æ—</h1><h2 id="MergeTree"><a href="#MergeTree" class="headerlink" title="MergeTree"></a><strong>MergeTree</strong></h2><ul><li>ClickHouse ä¸­æœ€å¼ºå¤§çš„è¡¨å¼•æ“å½“å± MergeTreeï¼ˆåˆå¹¶æ ‘ï¼‰å¼•æ“åŠè¯¥ç³»åˆ—ï¼ˆ*MergeTreeï¼‰</li></ul><p>ä¸­çš„å…¶ä»–å¼•æ“ï¼Œæ”¯æŒç´¢å¼•å’Œåˆ†åŒºï¼Œåœ°ä½å¯ä»¥ç›¸å½“äº innodb ä¹‹äº Mysqlã€‚è€Œä¸”åŸºäº MergeTreeï¼Œ</p><ul><li>è¿˜è¡ç”Ÿé™¤äº†å¾ˆå¤šå°å¼Ÿï¼Œä¹Ÿæ˜¯éå¸¸æœ‰ç‰¹è‰²çš„å¼•æ“ã€‚</li></ul><ol><li><p>å»ºè¡¨è¯­å¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_order_mt(<br>id UInt32,<br>sku_id String,<br>total_amount <span class="hljs-type">Decimal</span>(<span class="hljs-number">16</span>,<span class="hljs-number">2</span>),<br>create_time Datetime<br>) engine <span class="hljs-operator">=</span>MergeTree<br><span class="hljs-keyword">partition</span> <span class="hljs-keyword">by</span> toYYYYMMDD(create_time)<br><span class="hljs-keyword">primary</span> key (id)<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> (id,sku_id);<br></code></pre></td></tr></table></figure></li><li><p><strong>æ’å…¥æ•°æ®</strong></p></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_order_mt <span class="hljs-keyword">values</span><br>(<span class="hljs-number">101</span>,<span class="hljs-string">&#x27;sku_001&#x27;</span>,<span class="hljs-number">1000.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>) ,<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-01 11:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_004&#x27;</span>,<span class="hljs-number">2500.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">600.00</span>,<span class="hljs-string">&#x27;2020-06-02 12:00:00&#x27;</span>);<br></code></pre></td></tr></table></figure><h3 id="å‚æ•°ä»‹ç»"><a href="#å‚æ•°ä»‹ç»" class="headerlink" title="å‚æ•°ä»‹ç»"></a>å‚æ•°ä»‹ç»</h3><h4 id="partition-by-åˆ†åŒº"><a href="#partition-by-åˆ†åŒº" class="headerlink" title="partition by åˆ†åŒº"></a><strong>partition by</strong> åˆ†åŒº</h4><h5 id="1-ç›®çš„"><a href="#1-ç›®çš„" class="headerlink" title="1. ç›®çš„"></a>1. ç›®çš„</h5><p>åˆ†åŒºçš„ç›®çš„ä¸»è¦æ˜¯é™ä½æ‰«æçš„èŒƒå›´ï¼Œä¼˜åŒ–æŸ¥è¯¢é€Ÿåº¦</p><h5 id="2-å¯é€‰"><a href="#2-å¯é€‰" class="headerlink" title="2. å¯é€‰"></a>2. å¯é€‰</h5><p>å¯é€‰çš„ï¼Œå¦‚æœä¸å¡«ï¼Œåªä¼šä½¿ç”¨ä¸€ä¸ªåˆ†åŒºã€‚</p><h5 id="3-åˆ†åŒºç›®å½•"><a href="#3-åˆ†åŒºç›®å½•" class="headerlink" title="3.åˆ†åŒºç›®å½•"></a>3.<strong>åˆ†åŒºç›®å½•</strong></h5><p>MergeTree æ˜¯ä»¥åˆ—æ–‡ä»¶+ç´¢å¼•æ–‡ä»¶+è¡¨å®šä¹‰æ–‡ä»¶ç»„æˆçš„ï¼Œä½†æ˜¯å¦‚æœè®¾å®šäº†åˆ†åŒºé‚£ä¹ˆè¿™äº›æ–‡</p><p>ä»¶å°±ä¼šä¿å­˜åˆ°ä¸åŒçš„åˆ†åŒºç›®å½•ä¸­ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225811773.png" alt="image-20230228225811773"></p><h5 id="4-å¹¶è¡Œ"><a href="#4-å¹¶è¡Œ" class="headerlink" title="4.å¹¶è¡Œ"></a>4.<strong>å¹¶è¡Œ</strong></h5><p>åˆ†åŒºåï¼Œé¢å¯¹æ¶‰åŠè·¨åˆ†åŒºçš„æŸ¥è¯¢ç»Ÿè®¡ï¼ŒClickHouse ä¼šä»¥åˆ†åŒºä¸ºå•ä½å¹¶è¡Œå¤„ç†ã€‚</p><h5 id="5-æ•°æ®å†™å…¥ä¸åˆ†åŒºåˆå¹¶"><a href="#5-æ•°æ®å†™å…¥ä¸åˆ†åŒºåˆå¹¶" class="headerlink" title="5.æ•°æ®å†™å…¥ä¸åˆ†åŒºåˆå¹¶"></a>5.<strong>æ•°æ®å†™å…¥ä¸åˆ†åŒºåˆå¹¶</strong></h5><ul><li><p>ä»»ä½•ä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®å†™å…¥éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªä¸´æ—¶åˆ†åŒºï¼Œä¸ä¼šçº³å…¥ä»»ä½•ä¸€ä¸ªå·²æœ‰çš„åˆ†åŒºã€‚</p></li><li><p>å†™å…¥åçš„æŸä¸ªæ—¶åˆ»ï¼ˆå¤§æ¦‚ 10-15 åˆ†é’Ÿåï¼‰ï¼ŒClickHouse ä¼šè‡ªåŠ¨æ‰§è¡Œåˆå¹¶æ“ä½œã€‚</p></li><li><p>ä¹Ÿå¯ä»¥æ‰‹åŠ¨é€šè¿‡ optimize æ‰§è¡Œï¼ŒæŠŠä¸´æ—¶åˆ†åŒºçš„æ•°æ®ï¼Œåˆå¹¶åˆ°å·²æœ‰åˆ†åŒºä¸­ã€‚è¯­æ³•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">optimize <span class="hljs-keyword">table</span> xxxx <span class="hljs-keyword">final</span>;<br></code></pre></td></tr></table></figure><p>å¦‚ï¼š</p><ul><li>å†æ¬¡æ‰§è¡Œä¸Šé¢çš„æ’å…¥æ“ä½œ</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_order_mt <span class="hljs-keyword">values</span><br>(<span class="hljs-number">101</span>,<span class="hljs-string">&#x27;sku_001&#x27;</span>,<span class="hljs-number">1000.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>) ,<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-01 11:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_004&#x27;</span>,<span class="hljs-number">2500.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">600.00</span>,<span class="hljs-string">&#x27;2020-06-02 12:00:00&#x27;</span>);<br></code></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹æ•°æ®å¹¶æ²¡æœ‰çº³å…¥ä»»ä½•åˆ†åŒº</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225822725.png" alt="image-20230228225822725"></p></li><li><p>æ‰‹åŠ¨ optimize ä¹‹åï¼Œå†æ¬¡æŸ¥è¯¢</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225836780.png" alt="image-20230228225836780"></p></li></ul><h4 id="primary-key-ä¸»é”®"><a href="#primary-key-ä¸»é”®" class="headerlink" title="primary key ä¸»é”®"></a><strong>primary key</strong> <strong>ä¸»é”®</strong></h4><ul><li>ClickHouse ä¸­çš„ä¸»é”®ï¼Œå’Œå…¶ä»–æ•°æ®åº“ä¸å¤ªä¸€æ ·ï¼Œ<strong>å®ƒåªæä¾›äº†æ•°æ®çš„ä¸€çº§ç´¢å¼•ï¼Œä½†æ˜¯å´ä¸</strong></li></ul><p><strong>æ˜¯å”¯ä¸€çº¦æŸã€‚</strong>è¿™å°±æ„å‘³ç€æ˜¯å¯ä»¥å­˜åœ¨ç›¸åŒ primary key çš„æ•°æ®çš„ã€‚</p><ul><li><p>ä¸»é”®çš„è®¾å®šä¸»è¦ä¾æ®æ˜¯æŸ¥è¯¢è¯­å¥ä¸­çš„ where æ¡ä»¶ã€‚</p></li><li><p>æ ¹æ®æ¡ä»¶é€šè¿‡å¯¹ä¸»é”®è¿›è¡ŒæŸç§å½¢å¼çš„äºŒåˆ†æŸ¥æ‰¾ï¼Œèƒ½å¤Ÿå®šä½åˆ°å¯¹åº”çš„ index granularityï¼ˆç²’åº¦ï¼‰,é¿å…äº†å…¨è¡¨æ‰«æã€‚</p><blockquote><p>index granularityï¼š ç›´æ¥ç¿»è¯‘çš„è¯å°±æ˜¯ç´¢å¼•ç²’åº¦ï¼ŒæŒ‡åœ¨ç¨€ç–ç´¢å¼•ä¸­ä¸¤ä¸ªç›¸é‚»ç´¢å¼•å¯¹åº”æ•°æ®çš„é—´éš”ã€‚ClickHouse ä¸­çš„ MergeTree é»˜è®¤æ˜¯ 8192ã€‚å®˜æ–¹ä¸å»ºè®®ä¿®æ”¹è¿™ä¸ªå€¼ï¼Œé™¤éè¯¥åˆ—å­˜åœ¨å¤§é‡é‡å¤å€¼ï¼Œæ¯”å¦‚åœ¨ä¸€ä¸ªåˆ†åŒºä¸­å‡ ä¸‡è¡Œæ‰æœ‰ä¸€ä¸ªä¸åŒæ•°æ®ã€‚</p></blockquote><p><strong>ç¨€ç–ç´¢å¼•ï¼š</strong></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225859455.png" alt="image-20230228225859455"></p><p>ç¨€ç–ç´¢å¼•çš„å¥½å¤„å°±æ˜¯å¯ä»¥ç”¨å¾ˆå°‘çš„ç´¢å¼•æ•°æ®ï¼Œå®šä½æ›´å¤šçš„æ•°æ®ï¼Œä»£ä»·å°±æ˜¯åªèƒ½å®šä½åˆ°ç´¢å¼•ç²’åº¦çš„ç¬¬ä¸€è¡Œï¼Œç„¶åå†è¿›è¡Œè¿›è¡Œä¸€ç‚¹æ‰«æã€‚</p><blockquote><p>æ¯”å¦‚è¦æŸ¥æ‰¾idä¸º15151çš„æ•°æ®ï¼Œå¯ä»¥åˆ¤æ–­å‡ºä»–å¤§äº10101 å°äº32343 ï¼Œå› æ­¤ä¼šåœ¨è¿™ä¸ªåŒºåŸŸå†…è¿›è¡ŒæŸ¥æ‰¾ï¼Œç±»ä¼¼çš„æ ¹æ®äºŒåˆ†æŸ¥æ‰¾å®šä½åˆ°å…·ä½“çš„å€¼ã€‚</p></blockquote></li></ul><h4 id="order-by"><a href="#order-by" class="headerlink" title="order by"></a><strong>order by</strong></h4><ul><li><p>order by è®¾å®šäº†åˆ†åŒºå†…çš„æ•°æ®æŒ‰ç…§å“ªäº›å­—æ®µé¡ºåºè¿›è¡Œæœ‰åºä¿å­˜ã€‚</p></li><li><p>order by æ˜¯ MergeTree ä¸­å”¯ä¸€ä¸€ä¸ªå¿…å¡«é¡¹ï¼Œç”šè‡³æ¯” primary key è¿˜é‡è¦ï¼Œå› ä¸ºå½“ç”¨æˆ·ä¸</p><p>è®¾ç½®ä¸»é”®çš„æƒ…å†µï¼Œå¾ˆå¤šå¤„ç†ä¼šä¾ç…§ order by çš„å­—æ®µè¿›è¡Œå¤„ç†ï¼ˆæ¯”å¦‚åé¢ä¼šè®²çš„å»é‡å’Œæ±‡æ€»ï¼‰ã€‚</p></li><li><p><strong>è¦æ±‚ï¼šä¸»é”®å¿…é¡»æ˜¯ order by å­—æ®µçš„å‰ç¼€å­—æ®µ</strong>ã€‚æ¯”å¦‚ order by å­—æ®µæ˜¯ (id,sku_id) é‚£ä¹ˆä¸»é”®å¿…é¡»æ˜¯ id æˆ–è€…(id,sku_id)</p></li></ul><h3 id="è·³æ•°ç´¢å¼•"><a href="#è·³æ•°ç´¢å¼•" class="headerlink" title="è·³æ•°ç´¢å¼•"></a>è·³æ•°ç´¢å¼•</h3><ul><li><p>MergeTreeæ”¯æŒäºŒçº§ç´¢å¼•ï¼Œåˆç§°ä¹‹ä¸ºè·³æ•°ç´¢å¼•ï¼Œæ˜¯ç”±æ•°æ®çš„èšåˆä¿¡æ¯æ„å»ºè€Œæˆã€‚è·³æ•°ç´¢å¼•çš„ç›®å½•ä¹Ÿæ˜¯å¸®åŠ©æŸ¥è¯¢ï¼Œå‡å°‘æ•°æ®æ‰«æçš„èŒƒå›´ã€‚</p></li><li><p>æ­¤ç´¢å¼•åœ¨ <code>CREATE</code> è¯­å¥çš„åˆ—éƒ¨åˆ†é‡Œå®šä¹‰ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">INDEX index_name expr TYPE type(...) GRANULARITY granularity_value<br></code></pre></td></tr></table></figure><ul><li><p><code>*MergeTree</code> ç³»åˆ—çš„è¡¨å¯ä»¥æŒ‡å®šè·³æ•°ç´¢å¼•ã€‚</p></li><li><p>è·³æ•°ç´¢å¼•æ˜¯æŒ‡æ•°æ®ç‰‡æ®µæŒ‰ç…§ç²’åº¦(å»ºè¡¨æ—¶æŒ‡å®šçš„<code>index_granularity</code>)åˆ†å‰²æˆå°å—åï¼Œå°†ä¸Šè¿°SQLçš„granularity_valueæ•°é‡çš„å°å—ç»„åˆæˆä¸€ä¸ªå¤§çš„å—ï¼Œå¯¹è¿™äº›å¤§å—å†™å…¥ç´¢å¼•ä¿¡æ¯ã€‚</p></li><li><p>è¿™æ ·æœ‰åŠ©äºä½¿ç”¨<code>where</code>ç­›é€‰æ—¶è·³è¿‡å¤§é‡ä¸å¿…è¦çš„æ•°æ®ï¼Œå‡å°‘<code>SELECT</code>éœ€è¦è¯»å–çš„æ•°æ®é‡ã€‚</p></li><li><p>å¦‚ï¼šåˆ›å»ºæµ‹è¯•è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_order_mt2(<br>id UInt32,<br>sku_id String,<br>total_amount <span class="hljs-type">Decimal</span>(<span class="hljs-number">16</span>,<span class="hljs-number">2</span>),<br>create_time Datetime,<br>INDEX a total_amount TYPE minmax GRANULARITY <span class="hljs-number">5</span><br>) engine <span class="hljs-operator">=</span>MergeTree<br><span class="hljs-keyword">partition</span> <span class="hljs-keyword">by</span> toYYYYMMDD(create_time)<br><span class="hljs-keyword">primary</span> key (id)<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> (id, sku_id);<br></code></pre></td></tr></table></figure><blockquote><p>å…¶ä¸­ GRANULARITY N æ˜¯è®¾å®šäºŒçº§ç´¢å¼•å¯¹äºä¸€çº§ç´¢å¼•ç²’åº¦çš„ç²’åº¦ã€‚</p><p>å³ä¸€çº§ç´¢å¼•ä¸º[1,3],[3,6],[6,9] ï¼Œå¯¹åº”çš„äºŒçº§ç´¢å¼•èŒƒå›´ä¸º[1,9]ï¼Œå°†3ä¸ªä¸€çº§ç´¢å¼•è¿›è¡Œäº†åˆå¹¶ï¼Œè¿™æ ·æŸ¥æ‰¾æ—¶å°±ä¸éœ€è¦æ ¹æ®ä¸€çº§ç´¢å¼•å»è¿›è¡Œæ¯”è¾ƒï¼Œç›´æ¥æ ¹æ®äºŒçº§ç´¢å¼•å°±å¯ä»¥ã€‚</p></blockquote></li></ul></li></ul><blockquote><p> ç›®å‰åœ¨ ClickHouse çš„å®˜ç½‘ä¸ŠäºŒçº§ç´¢å¼•çš„åŠŸèƒ½åœ¨ v20.1.2.4 ä¹‹å‰æ˜¯è¢«æ ‡æ³¨ä¸ºå®éªŒæ€§çš„ï¼Œåœ¨è¿™ä¸ªç‰ˆæœ¬ä¹‹åé»˜è®¤æ˜¯å¼€å¯çš„ã€‚ </p></blockquote><h3 id="æ•°æ®-TTL"><a href="#æ•°æ®-TTL" class="headerlink" title="æ•°æ® TTL"></a><strong>æ•°æ®</strong> <strong>TTL</strong></h3><ul><li><p>TTL å³ Time To Liveï¼ŒTTLç”¨äºè®¾ç½®å€¼çš„ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒæ—¢å¯ä»¥ä¸ºæ•´å¼ è¡¨è®¾ç½®ï¼Œä¹Ÿå¯ä»¥ä¸ºæ¯ä¸ªåˆ—å­—æ®µå•ç‹¬è®¾ç½®ã€‚è¡¨çº§åˆ«çš„ TTL è¿˜ä¼šæŒ‡å®šæ•°æ®åœ¨ç£ç›˜å’Œå·ä¸Šè‡ªåŠ¨è½¬ç§»çš„é€»è¾‘ï¼ˆä¹Ÿå°±æ˜¯æ•°æ®è¿‡æœŸåå¯ä»¥ç§»åŠ¨åˆ°æŒ‡å®šç£ç›˜ä¸Šï¼‰ã€‚</p></li><li><p>TTL è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœå¿…é¡»æ˜¯ <a href="https://clickhouse.com/docs/zh/engines/table-engines/mergetree-family/mergetree/">æ—¥æœŸ</a> æˆ– <a href="https://clickhouse.com/docs/zh/engines/table-engines/mergetree-family/mergetree/">æ—¥æœŸæ—¶é—´</a> ç±»å‹çš„å­—æ®µã€‚</p></li><li><p><code>TTL</code>å­å¥ä¸èƒ½è¢«ç”¨äºä¸»é”®å­—æ®µã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">TTL time_column<br>TTL time_column <span class="hljs-operator">+</span> <span class="hljs-type">interval</span><br></code></pre></td></tr></table></figure></li></ul><h4 id="1-åˆ—çº§åˆ«-TTL"><a href="#1-åˆ—çº§åˆ«-TTL" class="headerlink" title="1.åˆ—çº§åˆ« TTL"></a>1.<strong>åˆ—çº§åˆ«</strong> <strong>TTL</strong></h4><p>å½“åˆ—ä¸­çš„å€¼è¿‡æœŸæ—¶, ClickHouseä¼šå°†å®ƒä»¬æ›¿æ¢æˆè¯¥åˆ—æ•°æ®ç±»å‹çš„é»˜è®¤å€¼ã€‚å¦‚æœæ•°æ®ç‰‡æ®µä¸­åˆ—çš„æ‰€æœ‰å€¼å‡å·²è¿‡æœŸï¼Œåˆ™ClickHouse ä¼šä»æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ•°æ®ç‰‡æ®µä¸­åˆ é™¤æ­¤åˆ—ã€‚</p><h5 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h5><p>åˆ›å»ºè¡¨æ—¶æŒ‡å®š <code>TTL</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> example_table<br>(<br>    d DateTime,<br>    a <span class="hljs-type">Int</span> TTL d <span class="hljs-operator">+</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-number">1</span> <span class="hljs-keyword">MONTH</span>,<br>    b <span class="hljs-type">Int</span> TTL d <span class="hljs-operator">+</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-number">1</span> <span class="hljs-keyword">MONTH</span>,<br>    c String<br>)<br>ENGINE <span class="hljs-operator">=</span> MergeTree<br><span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> toYYYYMM(d)<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> d;<br></code></pre></td></tr></table></figure><p>ä¸ºè¡¨ä¸­å·²å­˜åœ¨çš„åˆ—å­—æ®µæ·»åŠ  <code>TTL</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> example_table<br>    MODIFY <span class="hljs-keyword">COLUMN</span><br>    c String TTL d <span class="hljs-operator">+</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-number">1</span> <span class="hljs-keyword">DAY</span>;<br></code></pre></td></tr></table></figure><p><strong>æ¡ˆä¾‹æ¼”ç¤º</strong></p><ul><li><p>åˆ›å»ºæµ‹è¯•è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_order_mt7(<br>id UInt32,<br>sku_id String,<br>total_amount <span class="hljs-type">Decimal</span>(<span class="hljs-number">16</span>,<span class="hljs-number">2</span>) TTL create_time<span class="hljs-operator">+</span><span class="hljs-type">interval</span> <span class="hljs-number">10</span> <span class="hljs-keyword">SECOND</span>,<br>create_time Datetime <br>) engine <span class="hljs-operator">=</span>MergeTree<br><span class="hljs-keyword">partition</span> <span class="hljs-keyword">by</span> toYYYYMMDD(create_time)<br><span class="hljs-keyword">primary</span> key (id)<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> (id, sku_id);<br></code></pre></td></tr></table></figure></li><li><p>æ’å…¥æ•°æ®ï¼ˆæ³¨æ„ï¼šæ ¹æ®å®é™…æ—¶é—´æ”¹å˜ï¼‰</p></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_order_mt7 <span class="hljs-keyword">values</span><br>(<span class="hljs-number">106</span>,<span class="hljs-string">&#x27;sku_001&#x27;</span>,<span class="hljs-number">1000.00</span>,<span class="hljs-string">&#x27;2022-02-03 10:44:32&#x27;</span>),<br>(<span class="hljs-number">107</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2022-02-03 10:44:32&#x27;</span>),<br>(<span class="hljs-number">110</span>,<span class="hljs-string">&#x27;sku_003&#x27;</span>,<span class="hljs-number">600.00</span>,<span class="hljs-string">&#x27;2022-02-04 19:20:30&#x27;</span>);<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225917132.png" alt="image-20230228225917132"></p><ul><li><p>æ‰‹åŠ¨åˆå¹¶ï¼ŒæŸ¥çœ‹æ•ˆæœ åˆ°æœŸåï¼ŒæŒ‡å®šçš„å­—æ®µæ•°æ®å½’ 0</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">optimize <span class="hljs-keyword">table</span> t_order_mt7 <span class="hljs-keyword">final</span>;<br></code></pre></td></tr></table></figure></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225930135.png" alt="image-20230228225930135"></p><h4 id="2-è¡¨-TTL"><a href="#2-è¡¨-TTL" class="headerlink" title="2.è¡¨ TTL"></a>2.è¡¨ TTL</h4><ul><li><p>è¡¨å¯ä»¥è®¾ç½®ä¸€ä¸ªç”¨äºç§»é™¤è¿‡æœŸè¡Œçš„è¡¨è¾¾å¼ï¼Œä»¥åŠå¤šä¸ªç”¨äºåœ¨ç£ç›˜æˆ–å·ä¸Šè‡ªåŠ¨è½¬ç§»æ•°æ®ç‰‡æ®µçš„è¡¨è¾¾å¼ã€‚å½“è¡¨ä¸­çš„è¡Œè¿‡æœŸæ—¶ï¼ŒClickHouse ä¼šåˆ é™¤æ‰€æœ‰å¯¹åº”çš„è¡Œã€‚å¯¹äºæ•°æ®ç‰‡æ®µçš„è½¬ç§»ç‰¹æ€§ï¼Œå¿…é¡»æ‰€æœ‰çš„è¡Œéƒ½æ»¡è¶³è½¬ç§»æ¡ä»¶ã€‚</p></li><li><p>ä¸‹é¢çš„è¿™æ¡è¯­å¥æ˜¯æ•°æ®ä¼šåœ¨ create_time ä¹‹å 10 ç§’ä¸¢å¤±</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> t_order_mt3 MODIFY TTL create_time <span class="hljs-operator">+</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-number">10</span> <span class="hljs-keyword">SECOND</span>;<br></code></pre></td></tr></table></figure></li></ul><h5 id="æ¡ˆä¾‹æ¼”ç¤º"><a href="#æ¡ˆä¾‹æ¼”ç¤º" class="headerlink" title="æ¡ˆä¾‹æ¼”ç¤º"></a>æ¡ˆä¾‹æ¼”ç¤º</h5><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225939573.png" alt="image-20230228225939573"></p><h2 id="ReplacingMergeTree"><a href="#ReplacingMergeTree" class="headerlink" title="ReplacingMergeTree"></a>ReplacingMergeTree</h2><ul><li><p>ReplacingMergeTree æ˜¯ MergeTree çš„ä¸€ä¸ªå˜ç§ï¼Œå®ƒå­˜å‚¨ç‰¹æ€§å®Œå…¨ç»§æ‰¿ MergeTreeï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªå»é‡çš„åŠŸèƒ½ã€‚ </p></li><li><p>å°½ç®¡ MergeTree å¯ä»¥è®¾ç½®ä¸»é”®ï¼Œä½†æ˜¯ primary key å…¶å®æ²¡æœ‰å”¯ä¸€çº¦æŸçš„åŠŸèƒ½ã€‚å¦‚æœä½ æƒ³å¤„ç†æ‰é‡å¤çš„æ•°æ®ï¼Œå¯ä»¥å€ŸåŠ©è¿™ä¸ª ReplacingMergeTreeã€‚</p></li></ul><h3 id="å»é‡æ—¶æœº"><a href="#å»é‡æ—¶æœº" class="headerlink" title="å»é‡æ—¶æœº"></a><strong>å»é‡æ—¶æœº</strong></h3><p>æ•°æ®çš„å»é‡åªä¼šåœ¨åŒä¸€æ‰¹æ’å…¥ï¼ˆæ–°ç‰ˆæœ¬ï¼‰æˆ–åˆå¹¶çš„è¿‡ç¨‹ä¸­å‡ºç°ã€‚åˆå¹¶ä¼šåœ¨æœªçŸ¥çš„æ—¶é—´åœ¨åå°è¿›è¡Œï¼Œæ‰€ä»¥ä½ æ— æ³•é¢„</p><p>å…ˆä½œå‡ºè®¡åˆ’ã€‚æœ‰ä¸€äº›æ•°æ®å¯èƒ½ä»æœªè¢«å¤„ç†ã€‚</p><h3 id="å»é‡èŒƒå›´"><a href="#å»é‡èŒƒå›´" class="headerlink" title="å»é‡èŒƒå›´"></a><strong>å»é‡èŒƒå›´</strong></h3><ul><li><p>å¦‚æœè¡¨ç»è¿‡äº†åˆ†åŒºï¼Œå»é‡åªä¼šåœ¨åˆ†åŒºå†…éƒ¨è¿›è¡Œå»é‡ï¼Œä¸èƒ½æ‰§è¡Œè·¨åˆ†åŒºçš„å»é‡ã€‚</p></li><li><p>æ‰€ä»¥ ReplacingMergeTree èƒ½åŠ›æœ‰é™ï¼Œ ReplacingMergeTree é€‚ç”¨äºåœ¨åå°æ¸…é™¤é‡å¤çš„æ•°æ®ä»¥èŠ‚çœç©ºé—´ï¼Œä½†æ˜¯å®ƒä¸ä¿è¯æ²¡æœ‰é‡å¤çš„æ•°æ®å‡ºç°ã€‚</p></li></ul><h3 id="æ¡ˆä¾‹æ¼”ç¤º-1"><a href="#æ¡ˆä¾‹æ¼”ç¤º-1" class="headerlink" title="æ¡ˆä¾‹æ¼”ç¤º"></a><strong>æ¡ˆä¾‹æ¼”ç¤º</strong></h3><p>ï¼ˆ1ï¼‰åˆ›å»ºè¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_order_rmt(<br>id UInt32,<br>sku_id String,<br>total_amount <span class="hljs-type">Decimal</span>(<span class="hljs-number">16</span>,<span class="hljs-number">2</span>) ,<br>create_time Datetime <br>) engine <span class="hljs-operator">=</span>ReplacingMergeTree(create_time)<br><span class="hljs-keyword">partition</span> <span class="hljs-keyword">by</span> toYYYYMMDD(create_time)<br><span class="hljs-keyword">primary</span> key (id)<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> (id, sku_id);<br></code></pre></td></tr></table></figure><ul><li><p>ReplacingMergeTree() å¡«å…¥çš„å‚æ•°ä¸ºç‰ˆæœ¬å­—æ®µï¼Œé‡å¤æ•°æ®ä¿ç•™ç‰ˆæœ¬å­—æ®µå€¼æœ€å¤§çš„ã€‚</p></li><li><p>å¦‚æœä¸å¡«ç‰ˆæœ¬å­—æ®µï¼Œé»˜è®¤æŒ‰ç…§æ’å…¥é¡ºåºä¿ç•™æœ€åä¸€æ¡ã€‚</p></li></ul><p>ï¼ˆ2ï¼‰å‘è¡¨ä¸­æ’å…¥æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_order_rmt <span class="hljs-keyword">values</span><br>(<span class="hljs-number">101</span>,<span class="hljs-string">&#x27;sku_001&#x27;</span>,<span class="hljs-number">1000.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>) ,<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-01 11:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_004&#x27;</span>,<span class="hljs-number">2500.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-01 13:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">12000.00</span>,<span class="hljs-string">&#x27;2020-06-01 13:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">600.00</span>,<span class="hljs-string">&#x27;2020-06-02 12:00:00&#x27;</span>);<br></code></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰æ‰§è¡Œç¬¬ä¸€æ¬¡æŸ¥è¯¢</p><p>å¯ä»¥çœ‹åˆ°æ’å…¥çš„æ•°æ®æ˜¯æ ¹æ®idå’Œsku_id å»é‡è¿‡çš„ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t_order_rmt;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225956910.png"></p><p>ï¼ˆ4ï¼‰å†æ¬¡æ’å…¥æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_order_rmt <span class="hljs-keyword">values</span><br>(<span class="hljs-number">101</span>,<span class="hljs-string">&#x27;sku_001&#x27;</span>,<span class="hljs-number">1000.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>) ,<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-01 11:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_004&#x27;</span>,<span class="hljs-number">2500.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-01 13:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">12000.00</span>,<span class="hljs-string">&#x27;2020-06-01 13:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">600.00</span>,<span class="hljs-string">&#x27;2020-06-02 12:00:00&#x27;</span>);<br></code></pre></td></tr></table></figure><p>(5) å†æ¬¡æŸ¥è¯¢ï¼Œå¯ä»¥çœ‹åˆ°è¿™æ¬¡ä¾æ—§åªæ’å…¥äº†4æ¡æ•°æ®ï¼Œä½†æ˜¯å’Œç¬¬ä¸€æ¬¡æ’å…¥çš„æ•°æ®æ²¡æœ‰è¿›è¡Œå»é‡ï¼Œä¾æ—§å­˜åœ¨é‡å¤æ•°æ®ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230010636.png" alt="image-20230228230010636"></p><p>ï¼ˆ6ï¼‰æ‰‹åŠ¨åˆå¹¶</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">OPTIMIZE <span class="hljs-keyword">TABLE</span> t_order_rmt <span class="hljs-keyword">FINAL</span>;<br></code></pre></td></tr></table></figure><p>  (7) å†æ‰§è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼Œæ­¤æ—¶æ•°æ®å·²ç»æ ¹æ®åˆ†åŒºè¿›è¡Œäº†æœ€ç»ˆå»é‡ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230022485.png" alt="image-20230228230022485"></p><h3 id="æ¡ˆä¾‹ç»“è®º"><a href="#æ¡ˆä¾‹ç»“è®º" class="headerlink" title="æ¡ˆä¾‹ç»“è®º"></a>æ¡ˆä¾‹ç»“è®º</h3><p>â¢ å®é™…ä¸Šæ˜¯ä½¿ç”¨ order by å­—æ®µä½œä¸ºå”¯ä¸€é”®</p><p>â¢ å»é‡ä¸èƒ½è·¨åˆ†åŒº</p><p>â¢ åªæœ‰åŒä¸€æ‰¹æ’å…¥ï¼ˆæ–°ç‰ˆæœ¬ï¼‰æˆ–åˆå¹¶åˆ†åŒºæ—¶æ‰ä¼šè¿›è¡Œå»é‡</p><p>â¢ è®¤å®šé‡å¤çš„æ•°æ®ä¿ç•™ï¼Œç‰ˆæœ¬å­—æ®µå€¼æœ€å¤§çš„</p><p>â¢ å¦‚æœç‰ˆæœ¬å­—æ®µç›¸åŒåˆ™æŒ‰æ’å…¥é¡ºåºä¿ç•™æœ€åä¸€ç¬”</p><h2 id="SummingMergeTree"><a href="#SummingMergeTree" class="headerlink" title="SummingMergeTree"></a><strong>SummingMergeTree</strong></h2><ul><li><p>å¯¹äºä¸æŸ¥è¯¢æ˜ç»†ï¼Œåªå…³å¿ƒä»¥ç»´åº¦è¿›è¡Œæ±‡æ€»èšåˆç»“æœçš„åœºæ™¯ã€‚å¦‚æœåªä½¿ç”¨æ™®é€šçš„MergeTreeçš„è¯ï¼Œæ— è®ºæ˜¯å­˜å‚¨ç©ºé—´çš„å¼€é”€ï¼Œè¿˜æ˜¯æŸ¥è¯¢æ—¶ä¸´æ—¶èšåˆçš„å¼€é”€éƒ½æ¯”è¾ƒå¤§ã€‚</p></li><li><p>ClickHouse ä¸ºäº†è¿™ç§åœºæ™¯ï¼Œæä¾›äº†ä¸€ç§èƒ½å¤Ÿâ€œé¢„èšåˆâ€çš„å¼•æ“ SummingMergeTree</p></li><li><p>ä¸æ”¯æŒå¹‚ç­‰æ€§ï¼Œå½“å†™å…¥100æ¡ï¼Œå†™äº†50æ¡åæŒ‚äº†ï¼Œåé¢å†æ¬¡åŒæ­¥100æ¡æ•°æ®æ—¶ï¼Œä¼šæŠŠå‰50æ¡çš„æ•°æ®èšåˆä¸¤æ¬¡ã€‚</p></li></ul><h3 id="æ¡ˆä¾‹æ¼”ç¤º-2"><a href="#æ¡ˆä¾‹æ¼”ç¤º-2" class="headerlink" title="æ¡ˆä¾‹æ¼”ç¤º"></a><strong>æ¡ˆä¾‹æ¼”ç¤º</strong></h3><p>ï¼ˆ1ï¼‰åˆ›å»ºè¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_order_smt(<br>id UInt32,<br>sku_id String,<br>total_amount <span class="hljs-type">Decimal</span>(<span class="hljs-number">16</span>,<span class="hljs-number">2</span>) ,<br>create_time Datetime <br>) engine <span class="hljs-operator">=</span>SummingMergeTree(total_amount)<br><span class="hljs-keyword">partition</span> <span class="hljs-keyword">by</span> toYYYYMMDD(create_time)<br><span class="hljs-keyword">primary</span> key (id)<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> (id,sku_id );<br></code></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰æ’å…¥æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_order_smt <span class="hljs-keyword">values</span><br>(<span class="hljs-number">101</span>,<span class="hljs-string">&#x27;sku_001&#x27;</span>,<span class="hljs-number">1000.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-01 11:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_004&#x27;</span>,<span class="hljs-number">2500.00</span>,<span class="hljs-string">&#x27;2020-06-01 12:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-01 13:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">12000.00</span>,<span class="hljs-string">&#x27;2020-06-01 13:00:00&#x27;</span>),<br>(<span class="hljs-number">102</span>,<span class="hljs-string">&#x27;sku_002&#x27;</span>,<span class="hljs-number">600.00</span>,<span class="hljs-string">&#x27;2020-06-02 12:00:00&#x27;</span>);<br></code></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰æ‰§è¡Œç¬¬ä¸€æ¬¡æŸ¥è¯¢ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»åšäº†ä¸€æ¬¡èšåˆ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t_order_smt;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230039985.png" alt="image-20230228230039985"></p><p>ï¼ˆ4ï¼‰å†æ¬¡æ’å…¥ä¸€æ¡é‡å¤æ•°æ®ï¼Œå¹¶æŸ¥è¯¢ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_order_smt <span class="hljs-keyword">values</span><br>(<span class="hljs-number">101</span>,<span class="hljs-string">&#x27;sku_001&#x27;</span>,<span class="hljs-number">2000.00</span>,<span class="hljs-string">&#x27;2020-06-01 13:00:00&#x27;</span>)<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230047812.png" alt="image-20230228230047812"></p><p>ï¼ˆ5ï¼‰æ‰‹åŠ¨åˆå¹¶,å¹¶å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®å·²ç»å…¨éƒ¨èšåˆ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">OPTIMIZE <span class="hljs-keyword">TABLE</span> t_order_smt <span class="hljs-keyword">FINAL</span>;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230057295.png" alt="image-20230228230057295"></p><h3 id="æ¡ˆä¾‹ç»“è®º-1"><a href="#æ¡ˆä¾‹ç»“è®º-1" class="headerlink" title="æ¡ˆä¾‹ç»“è®º"></a>æ¡ˆä¾‹ç»“è®º</h3><p>â¢ ä»¥ SummingMergeTreeï¼ˆï¼‰ä¸­æŒ‡å®šçš„åˆ—ä½œä¸ºæ±‡æ€»æ•°æ®åˆ— </p><p>â¢ ä»¥ order by çš„åˆ—ä¸ºå‡†ï¼Œä½œä¸ºç»´åº¦åˆ—</p><p>â¢ å¯ä»¥å¡«å†™å¤šåˆ—å¿…é¡»æ•°å­—åˆ—ï¼Œå¦‚æœä¸å¡«ï¼Œä»¥æ‰€æœ‰éç»´åº¦åˆ—ä¸”ä¸ºæ•°å­—åˆ—çš„å­—æ®µä¸ºæ±‡æ€»æ•°æ®åˆ—</p><p>â¢ å…¶ä»–çš„åˆ—æŒ‰æ’å…¥é¡ºåºä¿ç•™ç¬¬ä¸€è¡Œ</p><p>â¢ ä¸åœ¨ä¸€ä¸ªåˆ†åŒºçš„æ•°æ®ä¸ä¼šè¢«èšåˆ</p><p>â¢ åªæœ‰åœ¨åŒä¸€æ‰¹æ¬¡æ’å…¥(æ–°ç‰ˆæœ¬)æˆ–åˆ†ç‰‡åˆå¹¶æ—¶æ‰ä¼šè¿›è¡Œèšåˆ</p><h3 id="èƒ½ä¸èƒ½ç›´æ¥æ‰§è¡ŒæŸ¥è¯¢-SQL-å¾—åˆ°æ±‡æ€»å€¼ï¼Ÿ"><a href="#èƒ½ä¸èƒ½ç›´æ¥æ‰§è¡ŒæŸ¥è¯¢-SQL-å¾—åˆ°æ±‡æ€»å€¼ï¼Ÿ" class="headerlink" title="èƒ½ä¸èƒ½ç›´æ¥æ‰§è¡ŒæŸ¥è¯¢ SQL å¾—åˆ°æ±‡æ€»å€¼ï¼Ÿ"></a>èƒ½ä¸èƒ½ç›´æ¥æ‰§è¡ŒæŸ¥è¯¢ SQL å¾—åˆ°æ±‡æ€»å€¼ï¼Ÿ</h3><p>ä¸è¡Œï¼Œå¯èƒ½ä¼šåŒ…å«ä¸€äº›è¿˜æ²¡æ¥å¾—åŠèšåˆçš„ä¸´æ—¶æ˜ç»†å¦‚æœè¦æ˜¯è·å–æ±‡æ€»å€¼ï¼Œè¿˜æ˜¯éœ€è¦ä½¿ç”¨ sum è¿›è¡Œèšåˆï¼Œè¿™æ ·æ•ˆç‡ä¼šæœ‰ä¸€å®šçš„æé«˜ï¼Œä½†æœ¬èº« ClickHouse æ˜¯åˆ—å¼å­˜å‚¨çš„ï¼Œæ•ˆç‡æå‡æœ‰é™ï¼Œä¸ä¼šç‰¹åˆ«æ˜æ˜¾ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> total_amount <span class="hljs-keyword">from</span> XXX <span class="hljs-keyword">where</span> province_name<span class="hljs-operator">=</span>â€™â€™ <span class="hljs-keyword">and</span> create_date<span class="hljs-operator">=</span>â€™xxxâ€™<br></code></pre></td></tr></table></figure><p>æ”¹å†™ä¸ºï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">sum</span>(total_amount) <span class="hljs-keyword">from</span> province_name<span class="hljs-operator">=</span>â€™â€™ <span class="hljs-keyword">and</span> create_date<span class="hljs-operator">=</span>â€˜xxxâ€™<br></code></pre></td></tr></table></figure><h1 id="é›†æˆ"><a href="#é›†æˆ" class="headerlink" title="é›†æˆ"></a>é›†æˆ</h1><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><p>MySQL å¼•æ“å¯ä»¥å¯¹å­˜å‚¨åœ¨è¿œç¨‹ MySQL æœåŠ¡å™¨ä¸Šçš„æ•°æ®æ‰§è¡Œ <code>SELECT</code> æŸ¥è¯¢å’Œ<code>insert</code>æ’å…¥ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> [IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span>] [db.]table_name [<span class="hljs-keyword">ON</span> CLUSTER cluster]<br>(<br>    name1 [type1] [<span class="hljs-keyword">DEFAULT</span><span class="hljs-operator">|</span>MATERIALIZED<span class="hljs-operator">|</span>ALIAS expr1] [TTL expr1],<br>    name2 [type2] [<span class="hljs-keyword">DEFAULT</span><span class="hljs-operator">|</span>MATERIALIZED<span class="hljs-operator">|</span>ALIAS expr2] [TTL expr2],<br>    ...<br>) ENGINE <span class="hljs-operator">=</span> MySQL(<span class="hljs-string">&#x27;host:port&#x27;</span>, <span class="hljs-string">&#x27;database&#x27;</span>, <span class="hljs-string">&#x27;table&#x27;</span>, <span class="hljs-string">&#x27;user&#x27;</span>, <span class="hljs-string">&#x27;password&#x27;</span>[, replace_query, <span class="hljs-string">&#x27;on_duplicate_clause&#x27;</span>])<br>SETTINGS<br>    [connection_pool_size<span class="hljs-operator">=</span><span class="hljs-number">16</span>, ]<br>    [connection_max_tries<span class="hljs-operator">=</span><span class="hljs-number">3</span>, ]<br>    [connection_wait_timeout<span class="hljs-operator">=</span><span class="hljs-number">5</span>, ] <span class="hljs-comment">/* 0 -- do not wait */</span><br>    [connection_auto_close<span class="hljs-operator">=</span><span class="hljs-literal">true</span> ]<br>;<br></code></pre></td></tr></table></figure><p>æ›´å¤šè§ï¼š<a href="https://clickhouse.com/docs/en/engines/table-engines/integrations/mysql/">MySQL | ClickHouse Documentation</a></p><h1 id="æ—¥å¿—ç³»åˆ—"><a href="#æ—¥å¿—ç³»åˆ—" class="headerlink" title="æ—¥å¿—ç³»åˆ—"></a>æ—¥å¿—ç³»åˆ—</h1><ul><li>è¿™äº›å¼•æ“æ˜¯ä¸ºäº†éœ€è¦å†™å…¥è®¸å¤šå°æ•°æ®é‡ï¼ˆå°‘äºä¸€ç™¾ä¸‡è¡Œï¼‰çš„è¡¨çš„åœºæ™¯è€Œå¼€å‘çš„ã€‚</li><li>è¿™ç³»åˆ—çš„å¼•æ“æœ‰ï¼š<ul><li><a href="https://clickhouse.com/docs/zh/engines/table-engines/log-family/stripelog/">StripeLog</a></li><li><a href="https://clickhouse.com/docs/zh/engines/table-engines/log-family/log/">æ—¥å¿—</a></li><li><a href="https://clickhouse.com/docs/zh/engines/table-engines/log-family/tinylog/">TinyLog</a></li></ul></li></ul><h2 id="TinyLog"><a href="#TinyLog" class="headerlink" title="TinyLog"></a>TinyLog</h2><p>ä»¥åˆ—æ–‡ä»¶çš„å½¢å¼ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œä¸æ”¯æŒç´¢å¼•ï¼Œæ²¡æœ‰å¹¶å‘æ§åˆ¶ã€‚ä¸€èˆ¬ä¿å­˜å°‘é‡æ•°æ®çš„å°è¡¨ï¼Œ</p><p>ç”Ÿäº§ç¯å¢ƒä¸Šä½œç”¨æœ‰é™ã€‚å¯ä»¥ç”¨äºå¹³æ—¶ç»ƒä¹ æµ‹è¯•ç”¨ã€‚</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
    
    
    <categories>
      
      <category>Clickhouse</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®åº“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>clickhouseåŸºæœ¬æ•°æ®ç±»å‹</title>
    <link href="/clickhouse%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
    <url>/clickhouse%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="clickhouseåŸºæœ¬æ•°æ®ç±»å‹"><a href="#clickhouseåŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="clickhouseåŸºæœ¬æ•°æ®ç±»å‹"></a>clickhouseåŸºæœ¬æ•°æ®ç±»å‹</h1><h2 id="æ•´å‹"><a href="#æ•´å‹" class="headerlink" title="æ•´å‹"></a><strong>æ•´å‹</strong></h2><p>å›ºå®šé•¿åº¦çš„æ•´å‹ï¼ŒåŒ…æ‹¬æœ‰ç¬¦å·æ•´å‹æˆ–æ— ç¬¦å·æ•´å‹ã€‚</p><p>æ•´å‹èŒƒå›´ï¼ˆ-2n-1~2n-1-1ï¼‰ï¼š</p><p>Int8 - [-128 : 127]</p><p>Int16 - [-32768 : 32767]</p><p>Int32 - [-2147483648 : 2147483647]</p><p>Int64 - [-9223372036854775808 : 9223372036854775807]</p><p>æ— ç¬¦å·æ•´å‹èŒƒå›´ï¼ˆ0~2n-1ï¼‰ï¼š</p><p>UInt8 - [0 : 255]</p><p>UInt16 - [0 : 65535]</p><p>UInt32 - [0 : 4294967295]</p><p>UInt64 - [0 : 18446744073709551615]</p><blockquote><p>ä½¿ç”¨åœºæ™¯ï¼š ä¸ªæ•°ã€æ•°é‡ã€ä¹Ÿå¯ä»¥å­˜å‚¨å‹id</p></blockquote><h2 id="æµ®ç‚¹å‹"><a href="#æµ®ç‚¹å‹" class="headerlink" title="æµ®ç‚¹å‹"></a><strong>æµ®ç‚¹å‹</strong></h2><p>Float32 - float</p><p>Float64 â€“ double</p><p>å»ºè®®å°½å¯èƒ½ä»¥æ•´æ•°å½¢å¼å­˜å‚¨æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå°†å›ºå®šç²¾åº¦çš„æ•°å­—è½¬æ¢ä¸ºæ•´æ•°å€¼ï¼Œå¦‚æ—¶é—´ç”¨æ¯«ç§’ä¸ºå•ä½è¡¨ç¤ºï¼Œå› ä¸ºæµ®ç‚¹å‹è¿›è¡Œè®¡ç®—æ—¶å¯èƒ½å¼•èµ·å››èˆäº”å…¥çš„è¯¯å·®ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">46</span>bb792f7762 :) <span class="hljs-keyword">select</span> <span class="hljs-number">1.0</span><span class="hljs-number">-0.9</span>;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-number">1.</span> <span class="hljs-operator">-</span> <span class="hljs-number">0.9</span><br><br>Query id: <span class="hljs-number">82</span>a9fb29<span class="hljs-number">-9</span>ac3<span class="hljs-number">-41</span>a1<span class="hljs-number">-918</span>d<span class="hljs-operator">-</span>a37ec7bff333<br><br>â”Œâ”€â”€â”€â”€â”€â”€minus(<span class="hljs-number">1.</span>, <span class="hljs-number">0.9</span>)â”€â”<br>â”‚ <span class="hljs-number">0.09999999999999998</span> â”‚<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br><br><span class="hljs-number">1</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> set. Elapsed: <span class="hljs-number">0.010</span> sec.<br></code></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨åœºæ™¯ï¼šä¸€èˆ¬æ•°æ®å€¼æ¯”è¾ƒå°ï¼Œä¸æ¶‰åŠå¤§é‡çš„ç»Ÿè®¡è®¡ç®—ï¼Œç²¾åº¦è¦æ±‚ä¸é«˜çš„æ—¶å€™ã€‚æ¯”å¦‚ä¿å­˜å•†å“çš„é‡é‡ã€‚</p></blockquote><h2 id="å¸ƒå°”å‹"><a href="#å¸ƒå°”å‹" class="headerlink" title="å¸ƒå°”å‹"></a>å¸ƒå°”å‹</h2><p>æ²¡æœ‰å•ç‹¬çš„ç±»å‹æ¥å­˜å‚¨å¸ƒå°”å€¼ã€‚å¯ä»¥ä½¿ç”¨ UInt8 ç±»å‹ï¼Œå–å€¼é™åˆ¶ä¸º 0 æˆ– 1ã€‚</p><h2 id="Decimal-å‹"><a href="#Decimal-å‹" class="headerlink" title="Decimal å‹"></a><strong>Decimal</strong> <strong>å‹</strong></h2><p>æœ‰ç¬¦å·çš„æµ®ç‚¹æ•°ï¼Œå¯åœ¨åŠ ã€å‡å’Œä¹˜æ³•è¿ç®—è¿‡ç¨‹ä¸­ä¿æŒç²¾åº¦ã€‚å¯¹äºé™¤æ³•ï¼Œæœ€ä½æœ‰æ•ˆæ•°å­—ä¼š</p><p>è¢«ä¸¢å¼ƒï¼ˆä¸èˆå…¥ï¼‰ã€‚</p><p>æœ‰ä¸‰ç§å£°æ˜ï¼š</p><p>â¢ Decimal32(s)ï¼Œç›¸å½“äº Decimal(9-s,s)ï¼Œæœ‰æ•ˆä½æ•°ä¸º 1~9</p><p>â¢ Decimal64(s)ï¼Œç›¸å½“äº Decimal(18-s,s)ï¼Œæœ‰æ•ˆä½æ•°ä¸º 1~18</p><p>â¢ Decimal128(s)ï¼Œç›¸å½“äº Decimal(38-s,s)ï¼Œæœ‰æ•ˆä½æ•°ä¸º 1~38</p><p><strong>s æ ‡è¯†å°æ•°ä½</strong></p><blockquote><p>ä½¿ç”¨åœºæ™¯ï¼š ä¸€èˆ¬é‡‘é¢å­—æ®µã€æ±‡ç‡ã€åˆ©ç‡ç­‰å­—æ®µä¸ºäº†ä¿è¯å°æ•°ç‚¹ç²¾åº¦ï¼Œéƒ½ä½¿ç”¨ Decimal</p><p>è¿›è¡Œå­˜å‚¨ã€‚</p></blockquote><h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a><strong>å­—ç¬¦ä¸²</strong></h2><ul><li>String</li></ul><p>å­—ç¬¦ä¸²å¯ä»¥ä»»æ„é•¿åº¦çš„ã€‚å®ƒå¯ä»¥åŒ…å«ä»»æ„çš„å­—èŠ‚é›†ï¼ŒåŒ…å«ç©ºå­—èŠ‚ã€‚</p><ul><li>FixedString(N)</li></ul><p>å›ºå®šé•¿åº¦ N çš„å­—ç¬¦ä¸²ï¼ŒN å¿…é¡»æ˜¯ä¸¥æ ¼çš„æ­£è‡ªç„¶æ•°ã€‚å½“æœåŠ¡ç«¯è¯»å–é•¿åº¦å°äº N çš„å­—ç¬¦</p><p>ä¸²æ—¶å€™ï¼Œé€šè¿‡åœ¨å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ ç©ºå­—èŠ‚æ¥è¾¾åˆ° N å­—èŠ‚é•¿åº¦ã€‚ å½“æœåŠ¡ç«¯è¯»å–é•¿åº¦å¤§äº N çš„</p><p>å­—ç¬¦ä¸²æ—¶å€™ï¼Œå°†è¿”å›é”™è¯¯æ¶ˆæ¯ã€‚</p><p>ä¸ String ç›¸æ¯”ï¼Œæå°‘ä¼šä½¿ç”¨ FixedStringï¼Œå› ä¸ºä½¿ç”¨èµ·æ¥ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚</p><blockquote><p>ä½¿ç”¨åœºæ™¯ï¼šåç§°ã€æ–‡å­—æè¿°ã€å­—ç¬¦å‹ç¼–ç ã€‚ å›ºå®šé•¿åº¦çš„å¯ä»¥ä¿å­˜ä¸€äº›å®šé•¿çš„å†…å®¹ï¼Œæ¯”</p><p>å¦‚ä¸€äº›ç¼–ç ï¼Œæ€§åˆ«ç­‰ä½†æ˜¯è€ƒè™‘åˆ°ä¸€å®šçš„å˜åŒ–é£é™©ï¼Œå¸¦æ¥æ”¶ç›Šä¸å¤Ÿæ˜æ˜¾ï¼Œæ‰€ä»¥å®šé•¿å­—ç¬¦ä¸²ä½¿ç”¨æ„ä¹‰æœ‰é™ã€‚</p></blockquote><h2 id="æšä¸¾ç±»å‹"><a href="#æšä¸¾ç±»å‹" class="headerlink" title="æšä¸¾ç±»å‹"></a><strong>æšä¸¾ç±»å‹</strong></h2><p>åŒ…æ‹¬ Enum8 å’Œ Enum16 ç±»å‹ã€‚Enum ä¿å­˜ â€˜stringâ€™&#x3D; integer çš„å¯¹åº”å…³ç³»ã€‚</p><ul><li><p>Enum8 ç”¨ â€˜Stringâ€™&#x3D; Int8 å¯¹æè¿°ã€‚</p></li><li><p>Enum16 ç”¨ â€˜Stringâ€™&#x3D; Int16 å¯¹æè¿°ã€‚</p></li></ul><h3 id="ç”¨æ³•ç¤ºä¾‹"><a href="#ç”¨æ³•ç¤ºä¾‹" class="headerlink" title="ç”¨æ³•ç¤ºä¾‹"></a>ç”¨æ³•ç¤ºä¾‹</h3><ul><li><p>åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ä¸€ä¸ªæšä¸¾ Enum8(â€˜helloâ€™ &#x3D; 1, â€˜worldâ€™ &#x3D; 2) ç±»å‹çš„åˆ—</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">46</span>bb792f7762 :) <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_enum<br>                (<br>                x Enum8(<span class="hljs-string">&#x27;hello&#x27;</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;world&#x27;</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>)<br>                )<br>                ENGINE <span class="hljs-operator">=</span> TinyLog;<br></code></pre></td></tr></table></figure></li><li><p><strong>è¿™ä¸ª</strong> <strong>x</strong> åˆ—åªèƒ½å­˜å‚¨ç±»å‹å®šä¹‰ä¸­åˆ—å‡ºçš„å€¼ï¼šhelloæˆ–world</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">46</span>bb792f7762 :) <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_enum <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;hello&#x27;</span>), (<span class="hljs-string">&#x27;world&#x27;</span>), (<span class="hljs-string">&#x27;hello&#x27;</span>);<br></code></pre></td></tr></table></figure></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225239055.png" alt="image-20230228225239055"></p><ul><li><strong>å¦‚æœéœ€è¦çœ‹åˆ°å¯¹åº”è¡Œçš„æ•°å€¼ï¼Œåˆ™å¿…é¡»å°†</strong> <strong>Enum</strong> <strong>å€¼è½¬æ¢ä¸ºæ•´æ•°ç±»å‹</strong></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">46</span>bb792f7762 :)  <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CAST</span>(x, <span class="hljs-string">&#x27;Int8&#x27;</span>) <span class="hljs-keyword">FROM</span> t_enum;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225247973.png" alt="image-20230228225247973"></p><blockquote><p>ä½¿ç”¨åœºæ™¯ï¼šå¯¹ä¸€äº›çŠ¶æ€ã€ç±»å‹çš„å­—æ®µç®—æ˜¯ä¸€ç§ç©ºé—´ä¼˜åŒ–ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§æ•°æ®çº¦æŸã€‚ä½†æ˜¯å®</p><p>é™…ä½¿ç”¨ä¸­å¾€å¾€å› ä¸ºä¸€äº›æ•°æ®å†…å®¹çš„å˜åŒ–å¢åŠ ä¸€å®šçš„ç»´æŠ¤æˆæœ¬ï¼Œç”šè‡³æ˜¯æ•°æ®ä¸¢å¤±é—®é¢˜ã€‚æ‰€ä»¥è°¨æ…ä½¿ç”¨ã€‚</p></blockquote><h2 id="æ—¶é—´ç±»å‹"><a href="#æ—¶é—´ç±»å‹" class="headerlink" title="æ—¶é—´ç±»å‹"></a><strong>æ—¶é—´ç±»å‹</strong></h2><p>ç›®å‰ ClickHouse æœ‰ä¸‰ç§æ—¶é—´ç±»å‹</p><p>â¢ Date æ¥å—<code>å¹´-æœˆ-æ—¥</code>çš„å­—ç¬¦ä¸²æ¯”å¦‚ â€˜2019-12-16â€™ </p><p>â¢ Datetime æ¥å—<code>å¹´-æœˆ-æ—¥ æ—¶:åˆ†:ç§’</code>çš„å­—ç¬¦ä¸²æ¯”å¦‚ â€˜2019-12-16 20:50:10â€™ </p><p>â¢ Datetime64 æ¥å—<code>å¹´-æœˆ-æ—¥ æ—¶:åˆ†:ç§’.äºšç§’</code>çš„å­—ç¬¦ä¸²æ¯”å¦‚â€˜2019-12-16 20:50:10.66â€™</p><h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a><strong>æ•°ç»„</strong></h2><p>Array(T)ï¼šç”± T ç±»å‹å…ƒç´ ç»„æˆçš„æ•°ç»„ã€‚</p><p>T å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼ŒåŒ…å«æ•°ç»„ç±»å‹ã€‚ ä½†ä¸æ¨èä½¿ç”¨å¤šç»´æ•°ç»„ï¼ŒClickHouse å¯¹å¤šç»´æ•°ç»„</p><p>çš„æ”¯æŒæœ‰é™ã€‚ä¾‹å¦‚ï¼Œä¸èƒ½åœ¨ MergeTree è¡¨ä¸­å­˜å‚¨å¤šç»´æ•°ç»„ã€‚</p><ul><li>åˆ›å»ºæ•°ç»„æ–¹å¼ 1ï¼Œä½¿ç”¨ array å‡½æ•°</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> x, toTypeName(x) ;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225259859.png" alt="image-20230228225259859"></p><ul><li>åˆ›å»ºæ•°ç»„æ–¹å¼ 2ï¼šä½¿ç”¨æ–¹æ‹¬å·</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>] <span class="hljs-keyword">AS</span> x, toTypeName(x);<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225307055.png" alt="image-20230228225307055"></p><p>è¿˜æœ‰å¾ˆå¤šæ•°æ®ç»“æ„ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://clickhouse.com/docs/zh/sql-reference/data-types/">ç®€ä»‹ | ClickHouseæ–‡æ¡£</a></p>]]></content>
    
    
    <categories>
      
      <category>Clickhouse</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dockerå®‰è£…clickhouse</title>
    <link href="/docker-%E5%AE%89%E8%A3%85clickhouse/"/>
    <url>/docker-%E5%AE%89%E8%A3%85clickhouse/</url>
    
    <content type="html"><![CDATA[<p>1.å¯åŠ¨å®¹å™¨æœåŠ¡ï¼ŒåŠ è½½é•œåƒ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">âœ  <span class="hljs-operator">~</span> docker run <span class="hljs-operator">-</span>d <span class="hljs-comment">--name ch-server --ulimit nofile=262144:262144 -p 8123:8123 -p 9000:9000 -p 9009:9009 yandex/clickhouse-server</span><br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225548754.png" alt="image-20230228225548754"></p><p>2.æŸ¥çœ‹æœåŠ¡</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">âœ  <span class="hljs-operator">~</span> docker ps<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225555839.png" alt="image-20230228225555839"></p><p>3.è¿›å…¥dockerå®¹å™¨å†…ï¼Œä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç è¿æ¥æ•°æ®åº“ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">âœ  <span class="hljs-operator">~</span> docker <span class="hljs-keyword">exec</span> <span class="hljs-operator">-</span>it <span class="hljs-number">46</span>bb792f7762 <span class="hljs-operator">/</span>bin<span class="hljs-operator">/</span>bash<br>root<span class="hljs-variable">@46bb792f7762</span>:<span class="hljs-operator">/</span># clickhouse<span class="hljs-operator">-</span>client<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225603858.png" alt="image-20230228225603858"></p><blockquote><p>å¦‚æœæœ‰å¯†ç ï¼Œè¾“å…¥ä¸‹é¢å‘½ä»¤ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">&gt;</span>root<span class="hljs-variable">@46bb792f7762</span>:<span class="hljs-operator">/</span># clickhouse<span class="hljs-operator">-</span>client <span class="hljs-operator">-</span>u <span class="hljs-keyword">default</span> <span class="hljs-comment">--password test</span><br></code></pre></td></tr></table></figure></blockquote><p>4.æŸ¥çœ‹æ•°æ®åº“</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">46</span>bb792f7762 :) <span class="hljs-keyword">show</span> databases;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225615339.png" alt="image-20230228225615339"></p><p>5.dbeaver æŸ¥çœ‹</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225624031.png" alt="image-20230228225624031"></p>]]></content>
    
    
    <categories>
      
      <category>Clickhouse</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>clickhouseå…¥é—¨</title>
    <link href="/clickhouse%E5%85%A5%E9%97%A8/"/>
    <url>/clickhouse%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="ClickHouse-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ClickHouse-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ClickHouse æ˜¯ä»€ä¹ˆï¼Ÿ"></a><strong>ClickHouse</strong> æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>ClickHouse æ˜¯ä¿„ç½—æ–¯çš„ Yandex äº 2016 å¹´å¼€æºçš„åˆ—å¼å­˜å‚¨æ•°æ®åº“ï¼ˆDBMSï¼‰ï¼Œä½¿ç”¨ C++</p><p>è¯­è¨€ç¼–å†™ï¼Œä¸»è¦ç”¨äºåœ¨çº¿åˆ†æå¤„ç†æŸ¥è¯¢ï¼ˆOLAPï¼‰ï¼Œèƒ½å¤Ÿä½¿ç”¨ SQL æŸ¥è¯¢å®æ—¶ç”Ÿæˆåˆ†ææ•°æ®æŠ¥</p><p>å‘Šã€‚</p><blockquote><ul><li>OLTP:   è”æœºäº‹åŠ¡å¤„ç†ï¼ˆOnline Transaction Processing)ã€‚æ˜¯mysqlï¼Œoracleè¿™ç§ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“çš„ä¸»è¦åº”ç”¨ï¼Œé€‚åˆåšåŸºæœ¬çš„æ—¥å¸¸çš„äº‹åŠ¡å¤„ç†ï¼Œå¢åˆ æ”¹æŸ¥ç­‰æ“ä½œã€‚</li><li>OLAPï¼šè”æœºåˆ†æå¤„ç†ï¼ˆOnline Analytical Processing)ï¼Œæ”¯æŒå¤æ‚çš„åˆ†ææ“ä½œï¼Œä¾§é‡å†³ç­–æ”¯æŒï¼Œå¹¶ä¸”æä¾›ç›´è§‚æ˜“æ‡‚çš„æŸ¥è¯¢ç»“æœã€‚é€‚åˆåšä¸€æ¬¡æ’å…¥å¤šæ¬¡æŸ¥è¯¢ï¼Œé€‚åˆåˆ†æï¼Œèšåˆçš„åœºæ™¯ï¼Œä½†æ˜¯å¯¹æ›´æ–°ï¼Œåˆ é™¤ä¸æ“…é•¿ã€‚</li></ul></blockquote><h1 id="ClickHouse-çš„ç‰¹ç‚¹"><a href="#ClickHouse-çš„ç‰¹ç‚¹" class="headerlink" title="ClickHouse çš„ç‰¹ç‚¹"></a>ClickHouse <strong>çš„ç‰¹ç‚¹</strong></h1><h2 id="1-åˆ—å¼å­˜å‚¨"><a href="#1-åˆ—å¼å­˜å‚¨" class="headerlink" title="1.åˆ—å¼å­˜å‚¨"></a>1.<strong>åˆ—å¼å­˜å‚¨</strong></h2><h3 id="è¡Œå¼å­˜å‚¨å’Œåˆ—å¼å­˜å‚¨çš„å¯¹æ¯”"><a href="#è¡Œå¼å­˜å‚¨å’Œåˆ—å¼å­˜å‚¨çš„å¯¹æ¯”" class="headerlink" title="è¡Œå¼å­˜å‚¨å’Œåˆ—å¼å­˜å‚¨çš„å¯¹æ¯”"></a>è¡Œå¼å­˜å‚¨å’Œåˆ—å¼å­˜å‚¨çš„å¯¹æ¯”</h3><ul><li><p>è¡Œå¼å­˜å‚¨çš„å¥½å¤„æ˜¯æƒ³æŸ¥æŸä¸ªäººæ‰€æœ‰çš„å±æ€§æ—¶ï¼Œå¯ä»¥é€šè¿‡ä¸€æ¬¡ç£ç›˜æŸ¥æ‰¾åŠ é¡ºåºè¯»å–å°±å¯ä»¥ã€‚ä½†æ˜¯å½“æƒ³æŸ¥æ‰€æœ‰äººçš„å¹´é¾„æ—¶ï¼Œéœ€è¦ä¸åœçš„æŸ¥æ‰¾ï¼Œæˆ–è€…å…¨è¡¨æ‰«ææ‰è¡Œï¼Œéå†çš„å¾ˆå¤šæ•°æ®éƒ½æ˜¯ä¸éœ€è¦çš„ã€‚</p></li><li><p>åˆ—å¼å­˜å‚¨ï¼Œæƒ³æŸ¥æ‰€æœ‰äººçš„å¹´é¾„åªéœ€æŠŠå¹´é¾„é‚£ä¸€åˆ—æ‹¿å‡ºæ¥å°±å¯ä»¥äº†</p></li></ul><p>ä»¥ä¸‹é¢çš„è¡¨ä¸ºä¾‹ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230156414.png" alt="image-20230228230156414"></p><ul><li><p>é‡‡ç”¨è¡Œå¼å­˜å‚¨æ—¶ï¼Œæ•°æ®åœ¨ç£ç›˜ä¸Šçš„ç»„ç»‡ç»“æ„ä¸ºï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230204375.png"></p></li><li><p>é‡‡ç”¨åˆ—å¼å­˜å‚¨æ—¶ï¼Œæ•°æ®åœ¨ç£ç›˜ä¸Šçš„ç»„ç»‡ç»“æ„ä¸ºï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230212410.png"></p></li></ul><h3 id="åˆ—å¼å‚¨å­˜çš„å¥½å¤„ï¼š"><a href="#åˆ—å¼å‚¨å­˜çš„å¥½å¤„ï¼š" class="headerlink" title="åˆ—å¼å‚¨å­˜çš„å¥½å¤„ï¼š"></a><strong>åˆ—å¼å‚¨å­˜çš„å¥½å¤„ï¼š</strong></h3><ul><li><p>å¯¹äºåˆ—çš„èšåˆï¼Œè®¡æ•°ï¼Œæ±‚å’Œç­‰ç»Ÿè®¡æ“ä½œåŸå› ä¼˜äºè¡Œå¼å­˜å‚¨ã€‚</p></li><li><p>ç”±äºæŸä¸€åˆ—çš„æ•°æ®ç±»å‹éƒ½æ˜¯ç›¸åŒçš„ï¼Œé’ˆå¯¹äºæ•°æ®å­˜å‚¨æ›´å®¹æ˜“è¿›è¡Œæ•°æ®å‹ç¼©ï¼Œæ¯ä¸€åˆ—</p><p>é€‰æ‹©æ›´ä¼˜çš„æ•°æ®å‹ç¼©ç®—æ³•ï¼Œå¤§å¤§æé«˜äº†æ•°æ®çš„å‹ç¼©æ¯”é‡ã€‚</p></li><li><p>ç”±äºæ•°æ®å‹ç¼©æ¯”æ›´å¥½ï¼Œä¸€æ–¹é¢èŠ‚çœäº†ç£ç›˜ç©ºé—´ï¼Œå¦ä¸€æ–¹é¢å¯¹äº cache ä¹Ÿæœ‰äº†æ›´å¤§çš„</p></li></ul><p>å‘æŒ¥ç©ºé—´</p><h2 id="DBMS-çš„åŠŸèƒ½"><a href="#DBMS-çš„åŠŸèƒ½" class="headerlink" title="DBMS çš„åŠŸèƒ½"></a><strong>DBMS</strong> <strong>çš„åŠŸèƒ½</strong></h2><p>å‡ ä¹è¦†ç›–äº†æ ‡å‡† SQL çš„å¤§éƒ¨åˆ†è¯­æ³•ï¼ŒåŒ…æ‹¬ DDL å’Œ DMLï¼Œä»¥åŠé…å¥—çš„å„ç§å‡½æ•°ï¼Œç”¨æˆ·ç®¡</p><p>ç†åŠæƒé™ç®¡ç†ï¼Œæ•°æ®çš„å¤‡ä»½ä¸æ¢å¤ã€‚ </p><blockquote><p>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆè‹±è¯­ï¼šdatabase management systemï¼Œç¼©å†™ï¼šDBMSï¼‰å³æ•°æ®åº“ç®¡ç†è½¯ä»¶ï¼Œæ˜¯ä¸€ç§é’ˆå¯¹å¯¹è±¡æ•°æ®åº“ï¼Œä¸ºç®¡ç†æ•°æ®åº“è€Œè®¾è®¡çš„å¤§å‹è®¡ç®—æœºè½¯ä»¶ç®¡ç†ç³»ç»Ÿã€‚</p><p>å…·æœ‰ä»£è¡¨æ€§çš„æ•°æ®ç®¡ç†ç³»ç»Ÿæœ‰ï¼šOracleã€Microsoft SQL Serverã€Accessã€MySQLåŠPostgreSQLç­‰ã€‚é€šå¸¸æ•°æ®åº“ç®¡ç†å¸ˆä¼šä½¿ç”¨æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ¥åˆ›å»ºæ•°æ®åº“ç³»ç»Ÿã€‚</p></blockquote><h2 id="å¤šæ ·åŒ–å¼•æ“"><a href="#å¤šæ ·åŒ–å¼•æ“" class="headerlink" title="å¤šæ ·åŒ–å¼•æ“"></a><strong>å¤šæ ·åŒ–å¼•æ“</strong></h2><p>ClickHouse å’Œ MySQL ç±»ä¼¼ï¼ŒæŠŠè¡¨çº§çš„å­˜å‚¨å¼•æ“æ’ä»¶åŒ–ï¼Œæ ¹æ®è¡¨çš„ä¸åŒéœ€æ±‚å¯ä»¥è®¾å®šä¸åŒ</p><p>çš„å­˜å‚¨å¼•æ“ã€‚ç›®å‰åŒ…æ‹¬åˆå¹¶æ ‘ã€æ—¥å¿—ã€æ¥å£å’Œå…¶ä»–å››å¤§ç±» 20 å¤šç§å¼•æ“ã€‚</p><h2 id="é«˜ååå†™å…¥èƒ½åŠ›"><a href="#é«˜ååå†™å…¥èƒ½åŠ›" class="headerlink" title="é«˜ååå†™å…¥èƒ½åŠ›"></a>é«˜ååå†™å…¥èƒ½åŠ›</h2><ul><li><p>ClickHouse é‡‡ç”¨ç±» LSM Treeçš„ç»“æ„ï¼Œæ•°æ®å†™å…¥åå®šæœŸåœ¨åå° Compactionã€‚é€šè¿‡ç±» LSM treeçš„ç»“æ„ï¼ŒClickHouse åœ¨æ•°æ®å¯¼å…¥æ—¶å…¨éƒ¨æ˜¯é¡ºåº append å†™ï¼Œå†™å…¥åæ•°æ®æ®µä¸å¯æ›´æ”¹ï¼Œåœ¨åå°compaction æ—¶ä¹Ÿæ˜¯å¤šä¸ªæ®µ merge sort åé¡ºåºå†™å›ç£ç›˜ã€‚é¡ºåºå†™çš„ç‰¹æ€§ï¼Œå……åˆ†åˆ©ç”¨äº†ç£ç›˜çš„ååèƒ½åŠ›ï¼Œå³ä¾¿åœ¨ HDD ä¸Šä¹Ÿæœ‰ç€ä¼˜å¼‚çš„å†™å…¥æ€§èƒ½ã€‚</p></li><li><p>å®˜æ–¹å…¬å¼€ benchmark æµ‹è¯•æ˜¾ç¤ºèƒ½å¤Ÿè¾¾åˆ° 50MB-200MB&#x2F;s çš„å†™å…¥ååèƒ½åŠ›ï¼ŒæŒ‰ç…§æ¯è¡Œ</p></li></ul><p>100Byte ä¼°ç®—ï¼Œå¤§çº¦ç›¸å½“äº 50W-200W æ¡&#x2F;s çš„å†™å…¥é€Ÿåº¦ã€‚</p><p><a href="https://zhuanlan.zhihu.com/p/415799237">æ·±å…¥æµ…å‡ºåˆ†æLSMæ ‘ï¼ˆæ—¥å¿—ç»“æ„åˆå¹¶æ ‘ï¼‰ - çŸ¥ä¹ (zhihu.com)</a></p><blockquote><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230231533.png"></p></blockquote><h3 id="æ•°æ®åˆ†åŒºä¸çº¿ç¨‹çº§å¹¶è¡Œ"><a href="#æ•°æ®åˆ†åŒºä¸çº¿ç¨‹çº§å¹¶è¡Œ" class="headerlink" title="æ•°æ®åˆ†åŒºä¸çº¿ç¨‹çº§å¹¶è¡Œ"></a><strong>æ•°æ®åˆ†åŒºä¸çº¿ç¨‹çº§å¹¶è¡Œ</strong></h3><ul><li>ClickHouse å°†æ•°æ®åˆ’åˆ†ä¸ºå¤šä¸ª partitionï¼Œæ¯ä¸ª partition å†è¿›ä¸€æ­¥åˆ’åˆ†ä¸ºå¤šä¸ª index</li></ul><p>granularity(ç´¢å¼•ç²’åº¦)ï¼Œç„¶åé€šè¿‡å¤šä¸ª CPUæ ¸å¿ƒåˆ†åˆ«å¤„ç†å…¶ä¸­çš„ä¸€éƒ¨åˆ†æ¥å®ç°å¹¶è¡Œæ•°æ®å¤„ç†ã€‚</p><p>åœ¨è¿™ç§è®¾è®¡ä¸‹ï¼Œ<strong>å•æ¡ Query å°±èƒ½åˆ©ç”¨æ•´æœºæ‰€æœ‰ CPU</strong>ã€‚æè‡´çš„å¹¶è¡Œå¤„ç†èƒ½åŠ›ï¼Œæå¤§çš„é™ä½äº†æŸ¥</p><p>è¯¢å»¶æ—¶ã€‚</p><ul><li>æ‰€ä»¥ï¼ŒClickHouse å³ä½¿å¯¹äºå¤§é‡æ•°æ®çš„æŸ¥è¯¢ä¹Ÿèƒ½å¤ŸåŒ–æ•´ä¸ºé›¶å¹³è¡Œå¤„ç†ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªå¼Šç«¯</li></ul><p>å°±æ˜¯å¯¹äºå•æ¡æŸ¥è¯¢ä½¿ç”¨å¤š cpuï¼Œå°±ä¸åˆ©äºåŒæ—¶å¹¶å‘å¤šæ¡æŸ¥è¯¢ã€‚æ‰€ä»¥å¯¹äºé«˜ qps çš„æŸ¥è¯¢ä¸šåŠ¡ï¼Œ</p><p>ClickHouse å¹¶ä¸æ˜¯å¼ºé¡¹ã€‚</p><blockquote><p>QPSï¼ˆ<strong>Query Per Second</strong>ï¼‰ï¼šæ¯ç§’è¯·æ±‚æ•°ï¼Œå°±æ˜¯è¯´æœåŠ¡å™¨åœ¨ä¸€ç§’çš„æ—¶é—´å†…å¤„ç†äº†å¤šå°‘ä¸ªè¯·æ±‚ã€‚</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Clickhouse</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/zookeeper%E5%85%A5%E9%97%A8/"/>
    <url>/zookeeper%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<hr><p>title: zookeeperç‰¹æ€§ä¸èŠ‚ç‚¹ä»‹ç»<br>date: 2021-09-22 22:43:51<br>tags:  åˆ†å¸ƒå¼æ¡†æ¶</p><p>categories:  zookeeper</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="1-äº§ç”ŸèƒŒæ™¯"><a href="#1-äº§ç”ŸèƒŒæ™¯" class="headerlink" title="1 äº§ç”ŸèƒŒæ™¯"></a>1 äº§ç”ŸèƒŒæ™¯</h2><ol><li><p>å•ä½“å‘åˆ†å¸ƒå¼æœåŠ¡è½¬å˜ï¼Œä¼šäº§ç”Ÿå¤šä¸ªèŠ‚ç‚¹é—´ååŒé—®é¢˜ï¼Œå¦‚ï¼š</p><blockquote><ul><li><p>å‡è®¾æœ‰3ä¸ªèŠ‚ç‚¹ï¼Œ1ä¸ªjobï¼Œè¯¥jobè¯¥ç”±å“ªä¸ªèŠ‚ç‚¹æ‰§è¡Œï¼Ÿ</p></li><li><p>è‹¥è¯¥jobç”±èŠ‚ç‚¹1æ‰§è¡Œï¼Œè¦æ˜¯1æŒ‚äº†ï¼Œç°åœ¨è¯¥2è¿˜æ˜¯3æ‰§è¡Œï¼Ÿ</p></li></ul></blockquote></li><li><p>ä¸Šæ¸¸å’Œä¸‹æ¸¸æœåŠ¡çš„å‘ç°ï¼Œå¦‚ï¼š</p><blockquote><ul><li>ä¸Šæ¸¸æŒ‚äº†ï¼Œä¸‹æ¸¸æ€ä¹ˆçŸ¥é“ï¼Ÿ</li><li>ä¸‹æ¸¸æœåŠ¡æ–°å¢ï¼Œä¸Šæ¸¸æ€ä¹ˆçŸ¥é“ï¼Ÿ</li></ul></blockquote></li><li><p>å¤šèŠ‚ç‚¹çš„åè°ƒé—®é¢˜ï¼Œå¦‚ï¼šå¹¶å‘äº§ç”Ÿäº†è¯·æ±‚ï¼Œè¯¥æ€ä¹ˆä¿è¯è¯·æ±‚çš„å¹‚ç­‰æ€§ï¼Ÿ</p></li></ol><blockquote><p><strong>ç”±äºèŠ‚ç‚¹è‡ªèº«åè°ƒä¸å¯é ï¼Œæ€§èƒ½ä¸é«˜ï¼Œæ•…éœ€è¦ä¸€ä¸ªç‹¬ç«‹æœåŠ¡æ¥åšåè°ƒï¼Œä»–å¿…é¡»å¯é ä¸”ä¿è¯æ€§èƒ½ã€‚</strong></p></blockquote><h2 id="2-æ¦‚è¦"><a href="#2-æ¦‚è¦" class="headerlink" title="2 æ¦‚è¦"></a>2 æ¦‚è¦</h2><ol><li>zookeeperæ˜¯ç”¨äºåˆ†å¸ƒå¼æœåŠ¡çš„åè°ƒæœåŠ¡ã€‚</li><li>å®ƒå¯¹å¤–å…¬å¸ƒäº†ä¸€ç»„ç®€å•çš„APIï¼Œåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºå¯ä»¥åŸºäºè¿™äº›APIï¼Œç”¨äºåŒæ­¥èŠ‚ç‚¹çŠ¶æ€ï¼ŒèŠ‚ç‚¹é…ç½®ï¼ŒæœåŠ¡æ³¨å†Œç­‰ä¿¡æ¯</li><li>å®ƒæ”¯æŒjavaå’Œcä¸¤ç§è¯­è¨€ã€‚</li></ol><h2 id="3-å·¥ä½œæœºåˆ¶"><a href="#3-å·¥ä½œæœºåˆ¶" class="headerlink" title="3 å·¥ä½œæœºåˆ¶"></a>3 å·¥ä½œæœºåˆ¶</h2><p>ä»è®¾è®¡æ¨¡å¼çš„è§’åº¦ç†è§£ï¼ŒzookeeperåŸºäºè§‚å¯Ÿè€…æ¨¡å¼ã€‚ä»–è´Ÿè´£å­˜å‚¨å’Œç®¡è·¯å¤§å®¶éƒ½å…³å¿ƒçš„æ•°æ®ï¼Œç„¶åæ¥å—è§‚å¯Ÿï¼Œä¸€æ—¦æ•°æ®çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œzookeeperå°±é€šçŸ¥æ³¨å†Œè€…ã€‚</p><h2 id="4-ç‰¹ç‚¹"><a href="#4-ç‰¹ç‚¹" class="headerlink" title="4 ç‰¹ç‚¹"></a>4 ç‰¹ç‚¹</h2><ol><li>zookeeperæ˜¯ç”±ä¸€ä¸ªleaderå’Œå¤šä¸ªfollowerç»„æˆçš„é›†ç¾¤</li><li>åŠæ•°ä»¥ä¸ŠèŠ‚ç‚¹å­˜æ´»ï¼Œzookeeper å³å¯ä»¥æ­£å¸¸æœåŠ¡</li><li>æ¯ä¸ªserverçš„æ•°æ®ä¸€è‡´</li><li>æ¥è‡ªåŒä¸€ä¸ªclientçš„è¯·æ±‚ä¾æ¬¡æ‰§è¡Œ</li><li>åŸå­æ€§ï¼Œæ•°æ®æ›´æ–°è¦ä¹ˆæˆåŠŸï¼Œè¦ä¹ˆå¤±è´¥</li><li>zookeeperæ•°æ®é‡å°‘ï¼Œæ•…åŒæ­¥å¿«ï¼Œä¸€å®šæ—¶é—´å†…ï¼Œclientå¯ä»¥è¯»åˆ°æœ€æ–°æ•°æ®</li></ol><h2 id="5-zookeeper-å¯åŠ¨"><a href="#5-zookeeper-å¯åŠ¨" class="headerlink" title="5 zookeeper å¯åŠ¨"></a>5 zookeeper å¯åŠ¨</h2><ul><li>å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ <a href="https://www.apache.org/dyn/closer.lua/zookeeper/zookeeper-3.7.0/apache-zookeeper-3.7.0-bin.tar.gz">Apache Downloads</a>ï¼Œå¹¶è§£å‹</li><li>è¿›å…¥confç›®å½•ï¼Œæ‹·è´é»˜è®¤é…ç½®  <code>cp zoo_sample.cfg   zoo.cfg</code></li><li>è¿›å…¥binç›®å½•ï¼Œå¯åŠ¨æœåŠ¡ç«¯<code>./zkServer.sh start</code></li><li>è¿›å…¥binç›®å½•ï¼Œè¿›å…¥å®¢æˆ·ç«¯<code>./zkCli.sh</code></li></ul><h2 id="6-å¸¸è§„é…ç½®æ–‡ä»¶è¯´æ˜"><a href="#6-å¸¸è§„é…ç½®æ–‡ä»¶è¯´æ˜" class="headerlink" title="6 å¸¸è§„é…ç½®æ–‡ä»¶è¯´æ˜"></a>6 å¸¸è§„é…ç½®æ–‡ä»¶è¯´æ˜</h2><blockquote><p>tickTime&#x3D;2000   #zookeeperæ—¶é—´é…ç½®ä¸­çš„åŸºæœ¬å•ä½ (æ¯«ç§’) </p></blockquote><blockquote><p>initLimit&#x3D;10     #å…è®¸followeråˆå§‹åŒ–è¿æ¥åˆ°leaderæœ€å¤§æ—¶é•¿ï¼Œå®ƒè¡¨ç¤ºtickTimeæ—¶é—´å€æ•° å³:initLimit*tickTime</p></blockquote><blockquote><p>syncLimit&#x3D;5 #å…è®¸followerä¸leaderæ•°æ®åŒæ­¥æœ€å¤§æ—¶é•¿,å®ƒè¡¨ç¤ºtickTimeæ—¶é—´å€æ•°</p></blockquote><blockquote><p>dataDir&#x3D;&#x2F;tmp&#x2F;zookeeper  #zookeper æ•°æ®å­˜å‚¨ç›®å½•</p></blockquote><blockquote><p>clientPort&#x3D;2181  #å¯¹å®¢æˆ·ç«¯æä¾›çš„ç«¯å£å·</p></blockquote><blockquote><p>maxClientCnxns&#x3D;60  #å•ä¸ªå®¢æˆ·ç«¯ä¸zookeeperæœ€å¤§å¹¶å‘è¿æ¥æ•°</p></blockquote><blockquote><p>autopurge.snapRetainCount&#x3D;3. #ä¿å­˜çš„æ•°æ®å¿«ç…§æ•°é‡ï¼Œä¹‹å¤–çš„å°†ä¼šè¢«æ¸…é™¤</p></blockquote><blockquote><p>autopurge.purgeInterval&#x3D;1  #è‡ªåŠ¨è§¦å‘æ¸…é™¤ä»»åŠ¡æ—¶é—´é—´éš”ï¼Œå°æ—¶ä¸ºå•ä½ã€‚é»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºä¸è‡ªåŠ¨æ¸…é™¤ã€‚</p></blockquote><h2 id="7-å®¢æˆ·ç«¯å‘½ä»¤"><a href="#7-å®¢æˆ·ç«¯å‘½ä»¤" class="headerlink" title="7 å®¢æˆ·ç«¯å‘½ä»¤"></a>7 å®¢æˆ·ç«¯å‘½ä»¤</h2><ul><li><p>close     å…³é—­å½“å‰ä¼šè¯</p></li><li><p>connect host:port        é‡æ–°è¿æ¥æŒ‡å®šZookeeperæœåŠ¡</p></li><li><p>create [-s] [-e] [-c] [-t ttl] path [data] [acl]          åˆ›å»ºèŠ‚ç‚¹</p></li><li><p>delete [-v version] path             åˆ é™¤èŠ‚ç‚¹ï¼Œ(ä¸èƒ½å­˜åœ¨å­èŠ‚ç‚¹ï¼‰ </p></li><li><p>deleteall path [-b batch size]      åˆ é™¤è·¯å¾„åŠæ‰€æœ‰å­èŠ‚ç‚¹</p></li><li><p>get [-s] [-w] path.        æŸ¥çœ‹èŠ‚ç‚¹æ•°æ® -s åŒ…å«èŠ‚ç‚¹çŠ¶æ€ -w æ·»åŠ ç›‘å¬ </p></li><li><p>getAcl [-s] path.      åˆ—å‡ºå­èŠ‚ç‚¹ -sçŠ¶æ€ -R é€’å½’æŸ¥çœ‹æ‰€æœ‰å­èŠ‚ç‚¹ -w æ·»åŠ ç›‘å¬</p></li><li><p>history     æŸ¥çœ‹æ‰§è¡Œçš„å†å²è®°å½•</p></li><li><p>redo cmdno  é‡å¤ æ‰§è¡Œå‘½ä»¤ï¼Œhistory ä¸­å‘½ä»¤ç¼–å·ç¡®å®š</p></li><li><p>quit  é€€å‡ºå®¢æˆ·ç«¯</p></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs sql">[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">1</span>] ls <span class="hljs-operator">/</span><br>[zookeeper]<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">2</span>] <span class="hljs-keyword">create</span> <span class="hljs-operator">/</span>node1<br>Created <span class="hljs-operator">/</span>node1<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">3</span>] <span class="hljs-keyword">get</span> <span class="hljs-operator">/</span>node1<br><span class="hljs-keyword">null</span><br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">4</span>] <span class="hljs-keyword">set</span> <span class="hljs-operator">/</span>node1 &quot;node1 value&quot;<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">5</span>] <span class="hljs-keyword">get</span> <span class="hljs-operator">/</span>node1<br>node1 <span class="hljs-keyword">value</span><br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">6</span>] <span class="hljs-keyword">create</span> <span class="hljs-operator">/</span>node1<span class="hljs-operator">/</span>child1<br>Created <span class="hljs-operator">/</span>node1<span class="hljs-operator">/</span>child1<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">7</span>] <span class="hljs-keyword">set</span>  <span class="hljs-operator">/</span>node1<span class="hljs-operator">/</span>child1 &quot;child1&quot;<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">8</span>] <span class="hljs-keyword">get</span> <span class="hljs-operator">/</span>node1<span class="hljs-operator">/</span>child1 &quot;child1&quot;<br><span class="hljs-string">&#x27;get path [watch]&#x27;</span> has been deprecated. Please use <span class="hljs-string">&#x27;get [-s] [-w] path&#x27;</span> instead.<br>child1<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">9</span>] <span class="hljs-keyword">get</span> <span class="hljs-operator">/</span>node1<span class="hljs-operator">/</span>child1<br>child1<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">10</span>] <span class="hljs-keyword">delete</span> <span class="hljs-operator">/</span>node1<br>Node <span class="hljs-keyword">not</span> <span class="hljs-keyword">empty</span>: <span class="hljs-operator">/</span>node1<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">11</span>] deleteall <span class="hljs-operator">/</span>node1<br>WATCHER::<br>WatchedEvent state:SyncConnected type:NodeDeleted path:<span class="hljs-operator">/</span>node1<span class="hljs-operator">/</span>child1<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">12</span>] ls <span class="hljs-operator">/</span><br>[zookeeper]<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">13</span>] history<br><span class="hljs-number">3</span> <span class="hljs-operator">-</span> <span class="hljs-keyword">get</span> <span class="hljs-operator">/</span>node1<br><span class="hljs-number">4</span> <span class="hljs-operator">-</span> <span class="hljs-keyword">set</span> <span class="hljs-operator">/</span>node1 &quot;node1 value&quot;<br><span class="hljs-number">5</span> <span class="hljs-operator">-</span> <span class="hljs-keyword">get</span> <span class="hljs-operator">/</span>node1<br><span class="hljs-number">6</span> <span class="hljs-operator">-</span> <span class="hljs-keyword">create</span> <span class="hljs-operator">/</span>node1<span class="hljs-operator">/</span>child1<br><span class="hljs-number">7</span> <span class="hljs-operator">-</span> <span class="hljs-keyword">set</span>  <span class="hljs-operator">/</span>node1<span class="hljs-operator">/</span>child1 &quot;child1&quot;<br><span class="hljs-number">8</span> <span class="hljs-operator">-</span> <span class="hljs-keyword">get</span> <span class="hljs-operator">/</span>node1<span class="hljs-operator">/</span>child1 &quot;child1&quot;<br><span class="hljs-number">9</span> <span class="hljs-operator">-</span> <span class="hljs-keyword">get</span> <span class="hljs-operator">/</span>node1<span class="hljs-operator">/</span>child1<br><span class="hljs-number">10</span> <span class="hljs-operator">-</span> <span class="hljs-keyword">delete</span> <span class="hljs-operator">/</span>node1<br><span class="hljs-number">11</span> <span class="hljs-operator">-</span> deleteall <span class="hljs-operator">/</span>node1<br><span class="hljs-number">12</span> <span class="hljs-operator">-</span> ls <span class="hljs-operator">/</span><br><span class="hljs-number">13</span> <span class="hljs-operator">-</span> history<br><br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">16</span>] redo <span class="hljs-number">2</span><br>Created <span class="hljs-operator">/</span>node1<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">17</span>] ls <span class="hljs-operator">/</span><br>[node1, zookeeper]<br>[zk: localhost:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">18</span>] <span class="hljs-keyword">get</span> <span class="hljs-operator">-</span>s <span class="hljs-operator">/</span>node1<br><span class="hljs-keyword">null</span><br>cZxid <span class="hljs-operator">=</span> <span class="hljs-number">0x8</span><br>ctime <span class="hljs-operator">=</span> Thu Jan <span class="hljs-number">13</span> <span class="hljs-number">22</span>:<span class="hljs-number">49</span>:<span class="hljs-number">37</span> CST <span class="hljs-number">2022</span><br>mZxid <span class="hljs-operator">=</span> <span class="hljs-number">0x8</span><br>mtime <span class="hljs-operator">=</span> Thu Jan <span class="hljs-number">13</span> <span class="hljs-number">22</span>:<span class="hljs-number">49</span>:<span class="hljs-number">37</span> CST <span class="hljs-number">2022</span><br>pZxid <span class="hljs-operator">=</span> <span class="hljs-number">0x8</span><br>cversion <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br>dataVersion <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br>aclVersion <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br>ephemeralOwner <span class="hljs-operator">=</span> <span class="hljs-number">0x0</span><br>dataLength <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br>numChildren <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”</title>
    <link href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/"/>
    <url>/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”"><a href="#1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”" class="headerlink" title="1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”"></a>1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”</h1><ul><li>åœ¨å•ä½“çš„åº”ç”¨å¼€å‘åœºæ™¯ä¸­æ¶‰åŠå¹¶å‘åŒæ­¥çš„æ—¶å€™ï¼Œå¤§å®¶å¾€å¾€é‡‡ç”¨Synchronizedï¼ˆåŒæ­¥ï¼‰æˆ–è€…å…¶ä»–åŒä¸€ä¸ªJVMå†…Lockæœºåˆ¶æ¥è§£å†³å¤šçº¿ç¨‹é—´çš„åŒæ­¥é—®é¢˜ã€‚</li><li>åœ¨åˆ†å¸ƒå¼é›†ç¾¤å·¥ä½œçš„å¼€å‘åœºæ™¯ä¸­ï¼Œå°±éœ€è¦ä¸€ç§æ›´åŠ é«˜çº§çš„é”æœºåˆ¶æ¥å¤„ç†è·¨æœºå™¨çš„è¿›ç¨‹ä¹‹é—´çš„æ•°æ®åŒæ­¥é—®é¢˜ï¼Œè¿™ç§è·¨æœºå™¨çš„é”å°±æ˜¯åˆ†å¸ƒå¼é”</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222616394.png" alt="image-20230228222616394"></p><h1 id="2-åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”"><a href="#2-åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”" class="headerlink" title="2 åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”"></a>2 åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”</h1><p>åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”ä¸»è¦æ˜¯åˆ©ç”¨æ•°æ®åº“çš„å”¯ä¸€ç´¢å¼•æ¥å®ç°ï¼Œå”¯ä¸€ç´¢å¼•å¤©ç„¶å…·æœ‰æ’ä»–æ€§ï¼Œè¿™åˆšå¥½ç¬¦åˆæˆ‘ä»¬å¯¹é”çš„è¦æ±‚</p><h2 id="2-1-è®¾è®¡åŸç†"><a href="#2-1-è®¾è®¡åŸç†" class="headerlink" title="2.1 è®¾è®¡åŸç†"></a>2.1 è®¾è®¡åŸç†</h2><ul><li>åŒä¸€æ—¶åˆ»åªèƒ½å…è®¸ä¸€ä¸ªç«äº‰è€…è·å–é”ã€‚åŠ é”æ—¶æˆ‘ä»¬åœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•ï¼Œåˆ©ç”¨å”¯ä¸€é”®è¿›è¡Œé˜²é‡ã€‚</li><li>å½“ç«äº‰è€…AåŠ é”æˆåŠŸåï¼Œç¬¬ç«äº‰è€…Bå†æ¥åŠ é”å°±ä¼šæŠ›å‡ºå”¯ä¸€ç´¢å¼•å†²çªï¼Œå¦‚æœæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼Œæˆ‘ä»¬å°±åˆ¤å®šç«äº‰è€…BåŠ é”å¤±è´¥</li><li>ç«äº‰è€…BåŠ é”å¤±è´¥åï¼Œä¼šé˜»å¡ç­‰å¾…ï¼Œä¸€ç›´åˆ°ç«äº‰è€…Aé‡Šæ”¾é”ï¼ˆä¹Ÿå°±æ˜¯åˆ é™¤è®°å½•åï¼‰ï¼Œå†å»è·å–é”</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228222626149.png" alt="image-20230228222626149"></p><h2 id="2-2-å®ç°æ³¨æ„äº‹é¡¹"><a href="#2-2-å®ç°æ³¨æ„äº‹é¡¹" class="headerlink" title="2.2 å®ç°æ³¨æ„äº‹é¡¹"></a>2.2 å®ç°æ³¨æ„äº‹é¡¹</h2><ul><li>æ²¡æœ‰é”è¶…æ—¶æœºåˆ¶ã€‚å¦‚æœç¨‹åºå‘ç”Ÿäº†å¼‚å¸¸ï¼Œå°†æ— æ³•åˆ é™¤æ•°æ®ï¼Œä¹Ÿå°±æ˜¯é”æ— æ³•è¢«é‡Šæ”¾æ‰ï¼Œéœ€è¦è‡ªå·±å†™ä¸€å¥—é”è¶…æ—¶æœºåˆ¶ï¼Œæ¯”å¦‚ï¼šåœ¨è¡¨ä¸­æ–°å¢ä¸€åˆ—ï¼Œç”¨äºè®°å½•å¤±æ•ˆæ—¶é—´ï¼Œå¹¶ä¸”éœ€è¦æœ‰å®šæ—¶ä»»åŠ¡æ¸…é™¤è¿™äº›å¤±æ•ˆçš„æ•°æ®ï¼›</li><li>åŸºäºæ•°æ®åº“å®ç°çš„ï¼Œæ•°æ®åº“çš„å¯ç”¨æ€§å’Œæ€§èƒ½å°†ç›´æ¥å½±å“åˆ†å¸ƒå¼é”çš„å¯ç”¨æ€§åŠæ€§èƒ½ï¼Œå¯ä»¥è€ƒè™‘å®ç°æ•°æ®åº“çš„é«˜å¯ç”¨æ–¹æ¡ˆ</li><li>è‡ªæ—‹å®ç°é˜»å¡æ•ˆæœã€‚å½“è·å–é”å¤±è´¥æ—¶è‡ªæ—‹è½¬</li><li>å¦‚æœä½¿ç”¨æ•°æ®åº“è‡ªå¢ id ,<strong>è§„å¾‹å¤ªæ˜æ˜¾</strong></li><li><strong>å—å•è¡¨æ•°æ®é‡çš„é™åˆ¶</strong> åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ MySQL çš„å•å¼ è¡¨æ ¹æœ¬ä¸å¯èƒ½å®¹çº³å¤§é‡æ•°æ®ï¼ˆæ€§èƒ½ç­‰åŸå› çš„é™åˆ¶ï¼‰ï¼›å¦‚æœæ˜¯å°†å•è¡¨æ‹†æˆå¤šè¡¨ï¼Œè¿˜æ˜¯ç”¨æ•°æ®åº“è‡ªå¢ id çš„è¯ï¼Œå°±å­˜åœ¨äº† id é‡å¤çš„æƒ…å†µäº†ï¼Œå¾ˆæ˜¾ç„¶è¿™æ˜¯ä¸šåŠ¡ä¸å…è®¸çš„ã€‚</li></ul><blockquote><p>dbæ“ä½œæ€§èƒ½è¾ƒå·®ï¼Œå¹¶ä¸”æœ‰é”è¡¨çš„é£é™©ï¼Œä¸€èˆ¬ä¸è€ƒè™‘ã€‚</p></blockquote><h2 id="2-3-ä»£ç ç¤ºä¾‹"><a href="#2-3-ä»£ç ç¤ºä¾‹" class="headerlink" title="2.3 ä»£ç ç¤ºä¾‹"></a>2.3 ä»£ç ç¤ºä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"> */<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Lock</span></span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åŠ é”ï¼Œå¢åŠ é‡è¯•é€»è¾‘</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//å°è¯•è·å–é”</span><br>        <span class="hljs-keyword">if</span>(tryLock())&#123;<br>            System.out.println(<span class="hljs-string">&quot;---------è·å–é”---------&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">//ç­‰å¾…é” é˜»å¡</span><br>            waitLock();<br>            <span class="hljs-comment">//é‡è¯•</span><br>            lock();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MysqlDistributedLock</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractLock</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> MethodlockMapper baseMapper;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryLock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//æ’å…¥ä¸€æ¡æ•°æ®   insert into</span><br>            baseMapper.insert(<span class="hljs-keyword">new</span> Methodlock(<span class="hljs-string">&quot;lock&quot;</span>));<br>        &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>            <span class="hljs-comment">//æ’å…¥å¤±è´¥</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">waitLock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">10</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">unlock</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//åˆ é™¤æ•°æ®   delete</span><br>        baseMapper.deleteByMethodlock(<span class="hljs-string">&quot;lock&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;-------é‡Šæ”¾é”------&quot;</span>);<br>    &#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Zookeeper</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
      <tag>zookeeper</tag>
      
      <tag>redis</tag>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redisç¼“å­˜é—®é¢˜</title>
    <link href="/Redis%E7%BC%93%E5%AD%98%E9%97%AE%E9%A2%98/"/>
    <url>/Redis%E7%BC%93%E5%AD%98%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ç¼“å­˜ç©¿é€"><a href="#1-ç¼“å­˜ç©¿é€" class="headerlink" title="1 ç¼“å­˜ç©¿é€"></a>1 <strong>ç¼“å­˜ç©¿é€</strong></h1><h2 id="1-1-å®šä¹‰"><a href="#1-1-å®šä¹‰" class="headerlink" title="1.1 å®šä¹‰"></a>1.1 å®šä¹‰</h2><p>ç¼“å­˜ç©¿é€æ˜¯æŒ‡æŸ¥è¯¢ä¸€ä¸ªæ ¹æœ¬ä¸å­˜åœ¨çš„æ•°æ®ï¼Œ ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚éƒ½ä¸ä¼šå‘½ä¸­ï¼Œ å¯¼è‡´ä¸å­˜åœ¨çš„æ•°æ®æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ°å­˜å‚¨å±‚å»æŸ¥è¯¢ï¼Œ å¤±å»äº†ç¼“å­˜ä¿æŠ¤åç«¯å­˜å‚¨çš„æ„ä¹‰ã€‚ </p><h2 id="1-2-äº§ç”ŸåŸå› "><a href="#1-2-äº§ç”ŸåŸå› " class="headerlink" title="1.2 äº§ç”ŸåŸå› "></a>1.2 äº§ç”ŸåŸå› </h2><ul><li>è‡ªèº«ä¸šåŠ¡ä»£ç æˆ–è€…æ•°æ®å‡ºç°é—®é¢˜ã€‚ </li><li>ä¸€äº›æ¶æ„æ”»å‡»ã€ çˆ¬è™«ç­‰é€ æˆå¤§é‡ç©ºå‘½ä¸­ã€‚</li></ul><h2 id="1-3-è§£å†³æ–¹æ¡ˆ"><a href="#1-3-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="1.3 è§£å†³æ–¹æ¡ˆ"></a>1.3 è§£å†³æ–¹æ¡ˆ</h2><h3 id="1-3-1-ç¼“å­˜ç©ºå¯¹è±¡"><a href="#1-3-1-ç¼“å­˜ç©ºå¯¹è±¡" class="headerlink" title="1.3.1 ç¼“å­˜ç©ºå¯¹è±¡"></a>1.3.1 ç¼“å­˜ç©ºå¯¹è±¡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">String <span class="hljs-title">get</span><span class="hljs-params">(String key)</span> </span>&#123;<br>    <span class="hljs-comment">// ä»ç¼“å­˜ä¸­è·å–æ•°æ®</span><br>    String cacheValue = cache.get(key);<br>    <span class="hljs-comment">// ç¼“å­˜ä¸ºç©º</span><br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(cacheValue)) &#123;<br>        <span class="hljs-comment">// ä»å­˜å‚¨ä¸­è·å–</span><br>        String storageValue = storage.get(key);<br>        cache.set(key, storageValue);<br>        <span class="hljs-comment">// å¦‚æœå­˜å‚¨æ•°æ®ä¸ºç©ºï¼Œ éœ€è¦è®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´(300ç§’)</span><br>        <span class="hljs-keyword">if</span> (storageValue == <span class="hljs-keyword">null</span>) &#123;<br>            cache.expire(key, <span class="hljs-number">60</span> * <span class="hljs-number">5</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> storageValue;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// ç¼“å­˜éç©º</span><br>        <span class="hljs-keyword">return</span> cacheValue;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-3-2-å¸ƒéš†è¿‡æ»¤å™¨"><a href="#1-3-2-å¸ƒéš†è¿‡æ»¤å™¨" class="headerlink" title="1.3.2 å¸ƒéš†è¿‡æ»¤å™¨"></a>1.3.2 å¸ƒéš†è¿‡æ»¤å™¨</h3><p>åœ¨è®¿é—®ç¼“å­˜å‰ï¼Œå…ˆç”¨å¸ƒéš†è¿‡æ»¤å™¨å…ˆåšä¸€æ¬¡è¿‡æ»¤ã€‚å¯¹äºä¸å­˜åœ¨çš„æ•°æ®å¸ƒéš†è¿‡æ»¤å™¨ä¸€èˆ¬éƒ½èƒ½å¤Ÿè¿‡æ»¤æ‰ï¼Œä¸è®©è¯·æ±‚å†å¾€åç«¯å‘é€ã€‚</p><p>å¸ƒéš†è¿‡æ»¤å™¨åº•å±‚å°±æ˜¯å®ç°äº†ä¸€ä¸ªå¤§å‹çš„äºŒè¿›åˆ¶æ•°ç»„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä½¿ç”¨å‰å°†æ‰€æœ‰çš„æ•°æ®æ”¾å…¥å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå¹¶ä¸”åœ¨å¢åŠ æ•°æ®æ—¶ä¹Ÿè¦å¾€å¸ƒéš†è¿‡æ»¤å™¨é‡Œæ”¾ï¼Œå¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥æ ¹æ®å¤šä¸ªhashç®—æ³•å¯¹keyè¿›è¡Œhash+æ•°ç»„é•¿åº¦å–æ¨¡çš„æ–¹å¼ï¼Œç»™æ¯ä¸€æ¡æ•°æ®è®¡ç®—å‡ºå¤šä¸ªä½ç½®ã€‚</p><p>æ‰€ä»¥åœ¨è®¿é—®æ•°æ®æ˜¯å¦å­˜åœ¨æ—¶ï¼Œä»–ä¹Ÿä¼šæŠŠè¿™å‡ ä¸ªä½ç½®ç®—å‡ºæ¥ï¼Œå¦‚æœè¿™å‡ ä¸ªä½ç½®æœ‰ä¸€ä¸ªä¸º0ï¼Œé‚£ä¹ˆå°±è¯´æ˜è¿™ä¸ªæ•°æ®ä¸€å®šä¸å­˜åœ¨ã€‚å› ä¸ºå­˜åœ¨hashç¢°æ’ï¼Œæ‰€ä»¥å¦‚æœæ‰€æœ‰ä½éƒ½ä¸º1ï¼Œä¸èƒ½è¯´æ˜è¿™ä¸ªkeyä¸€å®šå­˜åœ¨ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225351935.png" alt="image-20230228225351935"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.redisson;<br><br><span class="hljs-keyword">import</span> org.redisson.Redisson;<br><span class="hljs-keyword">import</span> org.redisson.api.RBloomFilter;<br><span class="hljs-keyword">import</span> org.redisson.api.RedissonClient;<br><span class="hljs-keyword">import</span> org.redisson.config.Config;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedissonBloomFilter</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Config config = <span class="hljs-keyword">new</span> Config();<br>        config.useSingleServer().setAddress(<span class="hljs-string">&quot;redis://localhost:6379&quot;</span>);<br>        <span class="hljs-comment">//æ„é€ Redisson</span><br>        RedissonClient redisson = Redisson.create(config);<br><br>        RBloomFilter&lt;String&gt; bloomFilter = redisson.getBloomFilter(<span class="hljs-string">&quot;nameList&quot;</span>);<br>        <span class="hljs-comment">//åˆå§‹åŒ–å¸ƒéš†è¿‡æ»¤å™¨ï¼šé¢„è®¡å…ƒç´ ä¸º100000000L,è¯¯å·®ç‡ä¸º3%,æ ¹æ®è¿™ä¸¤ä¸ªå‚æ•°ä¼šè®¡ç®—å‡ºåº•å±‚çš„bitæ•°ç»„å¤§å°</span><br>        bloomFilter.tryInit(<span class="hljs-number">100000000L</span>,<span class="hljs-number">0.03</span>);<br>      <br>        <span class="hljs-comment">//æŠŠæ‰€æœ‰æ•°æ®å­˜å…¥å¸ƒéš†è¿‡æ»¤å™¨</span><br>        <span class="hljs-function"><span class="hljs-keyword">void</span>Â <span class="hljs-title">init</span><span class="hljs-params">()</span></span>&#123;<br>            <span class="hljs-keyword">for</span>Â (StringÂ key:Â keys)Â &#123;<br>                bloomFilter.put(key);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-function">StringÂ <span class="hljs-title">get</span><span class="hljs-params">(StringÂ key)</span>Â </span>&#123;<br>            <span class="hljs-comment">//Â ä»å¸ƒéš†è¿‡æ»¤å™¨è¿™ä¸€çº§ç¼“å­˜åˆ¤æ–­ä¸‹keyæ˜¯å¦å­˜åœ¨</span><br>            BooleanÂ existÂ =Â bloomFilter.contains(key);<br>            <span class="hljs-keyword">if</span>(!exist)&#123;<br>                <span class="hljs-keyword">return</span>Â <span class="hljs-string">&quot;&quot;</span>;<br>            &#125;<br>            <span class="hljs-comment">//Â ä»ç¼“å­˜ä¸­è·å–æ•°æ®</span><br>            StringÂ cacheValueÂ =Â cache.get(key);<br>            <span class="hljs-comment">//Â ç¼“å­˜ä¸ºç©º</span><br>            <span class="hljs-keyword">if</span>Â (StringUtils.isBlank(cacheValue))Â &#123;<br>                <span class="hljs-comment">//Â ä»å­˜å‚¨ä¸­è·å–</span><br>                StringÂ storageValueÂ =Â storage.get(key);<br>                cache.set(key,Â storageValue);<br>                <span class="hljs-comment">//Â å¦‚æœå­˜å‚¨æ•°æ®ä¸ºç©ºï¼ŒÂ éœ€è¦è®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´(300ç§’)</span><br>                <span class="hljs-keyword">if</span>Â (storageValueÂ ==Â <span class="hljs-keyword">null</span>)Â &#123;<br>                    cache.expire(key,Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">5</span>);<br>                &#125;<br>                <span class="hljs-keyword">return</span>Â storageValue;<br>            &#125;Â <span class="hljs-keyword">else</span>Â &#123;<br>                <span class="hljs-comment">//Â ç¼“å­˜éç©º</span><br>                <span class="hljs-keyword">return</span>Â cacheValue;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="2-ç¼“å­˜å¤±æ•ˆ-å‡»ç©¿"><a href="#2-ç¼“å­˜å¤±æ•ˆ-å‡»ç©¿" class="headerlink" title="2 ç¼“å­˜å¤±æ•ˆ(å‡»ç©¿)"></a>2 <strong>ç¼“å­˜å¤±æ•ˆ(å‡»ç©¿)</strong></h1><h2 id="2-1-å®šä¹‰"><a href="#2-1-å®šä¹‰" class="headerlink" title="2.1 å®šä¹‰"></a>2.1 å®šä¹‰</h2><p>ç”±äºå¤§æ‰¹é‡ç¼“å­˜åœ¨åŒä¸€æ—¶é—´å¤±æ•ˆå¯èƒ½å¯¼è‡´å¤§é‡è¯·æ±‚åŒæ—¶ç©¿é€ç¼“å­˜ç›´è¾¾æ•°æ®åº“ï¼Œå¯èƒ½ä¼šé€ æˆæ•°æ®åº“ç¬é—´å‹åŠ›è¿‡å¤§ ç”šè‡³æŒ‚æ‰ã€‚</p><h2 id="2-2-äº§ç”ŸåŸå› "><a href="#2-2-äº§ç”ŸåŸå› " class="headerlink" title="2.2 äº§ç”ŸåŸå› "></a>2.2 äº§ç”ŸåŸå› </h2><p>å¤§æ‰¹é‡ç¼“å­˜åœ¨åŒä¸€æ—¶é—´å¤±æ•ˆ</p><h2 id="2-3-è§£å†³æ–¹æ¡ˆ"><a href="#2-3-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="2.3 è§£å†³æ–¹æ¡ˆ"></a>2.3 è§£å†³æ–¹æ¡ˆ</h2><h3 id="2-3-1-å°†è¿™ä¸€æ‰¹æ•°æ®çš„ç¼“å­˜è¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºä¸€ä¸ªæ—¶é—´æ®µå†…çš„ä¸åŒæ—¶é—´ã€‚"><a href="#2-3-1-å°†è¿™ä¸€æ‰¹æ•°æ®çš„ç¼“å­˜è¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºä¸€ä¸ªæ—¶é—´æ®µå†…çš„ä¸åŒæ—¶é—´ã€‚" class="headerlink" title="2.3.1 å°†è¿™ä¸€æ‰¹æ•°æ®çš„ç¼“å­˜è¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºä¸€ä¸ªæ—¶é—´æ®µå†…çš„ä¸åŒæ—¶é—´ã€‚"></a>2.3.1 å°†è¿™ä¸€æ‰¹æ•°æ®çš„ç¼“å­˜è¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºä¸€ä¸ªæ—¶é—´æ®µå†…çš„ä¸åŒæ—¶é—´ã€‚</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">String <span class="hljs-title">get</span><span class="hljs-params">(String key)</span> </span>&#123;<br>    <span class="hljs-comment">// ä»ç¼“å­˜ä¸­è·å–æ•°æ®</span><br>    String cacheValue = cache.get(key);<br>    <span class="hljs-comment">// ç¼“å­˜ä¸ºç©º</span><br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(cacheValue)) &#123;<br>        <span class="hljs-comment">// ä»å­˜å‚¨ä¸­è·å–</span><br>        String storageValue = storage.get(key);<br>        cache.set(key, storageValue);<br>        <span class="hljs-comment">//è®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´(300åˆ°600ä¹‹é—´çš„ä¸€ä¸ªéšæœºæ•°)</span><br>        <span class="hljs-keyword">int</span> expireTime = <span class="hljs-keyword">new</span> Random().nextInt(<span class="hljs-number">300</span>)  + <span class="hljs-number">300</span>;<br>        <span class="hljs-keyword">if</span> (storageValue == <span class="hljs-keyword">null</span>) &#123;<br>            cache.expire(key, expireTime);<br>        &#125;<br>        <span class="hljs-keyword">return</span> storageValue;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// ç¼“å­˜éç©º</span><br>        <span class="hljs-keyword">return</span> cacheValue;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="3-ç¼“å­˜é›ªå´©"><a href="#3-ç¼“å­˜é›ªå´©" class="headerlink" title="3 ç¼“å­˜é›ªå´©"></a>3 <strong>ç¼“å­˜é›ªå´©</strong></h1><h2 id="3-1-å®šä¹‰"><a href="#3-1-å®šä¹‰" class="headerlink" title="3.1 å®šä¹‰"></a>3.1 å®šä¹‰</h2><p>ç¼“å­˜é›ªå´©æŒ‡çš„æ˜¯ç¼“å­˜å±‚æ”¯æ’‘ä¸ä½æˆ–å®•æ‰åï¼Œ æµé‡æ‰“å‘åç«¯å­˜å‚¨å±‚ ï¼Œå­˜å‚¨å±‚çš„è°ƒç”¨é‡ä¼šæš´å¢ï¼Œ é€ æˆå­˜å‚¨å±‚ä¹Ÿä¼šçº§è”å®•æœºçš„æƒ…å†µã€‚</p><h2 id="3-2-äº§ç”ŸåŸå› "><a href="#3-2-äº§ç”ŸåŸå› " class="headerlink" title="3.2 äº§ç”ŸåŸå› "></a>3.2 äº§ç”ŸåŸå› </h2><ul><li>redisé›†ç¾¤æŒ‚äº†</li><li>è¯·æ±‚æ•°é‡å¤§äºrediså¯æ‰¿å—çš„æœ€å¤§æ•°é‡</li></ul><h2 id="3-3-è§£å†³æ–¹æ¡ˆ"><a href="#3-3-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="3.3 è§£å†³æ–¹æ¡ˆ"></a>3.3 è§£å†³æ–¹æ¡ˆ</h2><h3 id="3-3-1-ä¿è¯ç¼“å­˜å±‚æœåŠ¡é«˜å¯ç”¨æ€§"><a href="#3-3-1-ä¿è¯ç¼“å­˜å±‚æœåŠ¡é«˜å¯ç”¨æ€§" class="headerlink" title="3.3.1 ä¿è¯ç¼“å­˜å±‚æœåŠ¡é«˜å¯ç”¨æ€§"></a>3.3.1 ä¿è¯ç¼“å­˜å±‚æœåŠ¡é«˜å¯ç”¨æ€§</h3><p>æ¯”å¦‚ä½¿ç”¨Redis Sentinelæˆ–Redis Clusterã€‚ </p><h3 id="3-3-2-åç«¯é™æµç†”æ–­å¹¶é™çº§ã€‚"><a href="#3-3-2-åç«¯é™æµç†”æ–­å¹¶é™çº§ã€‚" class="headerlink" title="3.3.2 åç«¯é™æµç†”æ–­å¹¶é™çº§ã€‚"></a>3.3.2 åç«¯é™æµç†”æ–­å¹¶é™çº§ã€‚</h3><p>æ¯”å¦‚ä½¿ç”¨Sentinelæˆ–Hystrixé™æµé™çº§ç»„ä»¶ã€‚ </p><ul><li>æ¯”å¦‚æœåŠ¡é™çº§ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹ä¸åŒçš„æ•°æ®é‡‡å–ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚<ul><li>å½“ä¸šåŠ¡åº”ç”¨è®¿é—®çš„æ˜¯éæ ¸å¿ƒæ•°æ®ï¼ˆä¾‹å¦‚ç”µå•†å•† å“å±æ€§ï¼Œç”¨æˆ·ä¿¡æ¯ç­‰ï¼‰æ—¶ï¼Œæš‚æ—¶åœæ­¢ä»ç¼“å­˜ä¸­æŸ¥è¯¢è¿™äº›æ•°æ®ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›é¢„å®šä¹‰çš„é»˜è®¤é™çº§ä¿¡æ¯ã€ç©ºå€¼æˆ–æ˜¯é”™è¯¯æç¤ºä¿¡æ¯ï¼›</li><li>å½“ä¸šåŠ¡åº”ç”¨è®¿é—®çš„æ˜¯æ ¸å¿ƒæ•°æ®ï¼ˆä¾‹å¦‚ç”µå•†å•†å“åº“å­˜ï¼‰æ—¶ï¼Œä»ç„¶å…è®¸æŸ¥è¯¢ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜ç¼ºå¤±ï¼Œ ä¹Ÿå¯ä»¥ç»§ç»­é€šè¿‡æ•°æ®åº“è¯»å–ã€‚</li></ul></li></ul><h1 id="4-Redisçƒ­keyé—®é¢˜"><a href="#4-Redisçƒ­keyé—®é¢˜" class="headerlink" title="4 Redisçƒ­keyé—®é¢˜"></a>4 Redisçƒ­keyé—®é¢˜</h1><h2 id="4-1å®šä¹‰"><a href="#4-1å®šä¹‰" class="headerlink" title="4.1å®šä¹‰"></a>4.1å®šä¹‰</h2><p>åœ¨Redisä¸­ï¼Œæˆ‘ä»¬æŠŠè®¿é—®é¢‘ç‡é«˜çš„Keyï¼Œç§°ä¸ºçƒ­Keyï¼ˆä¾‹å¦‚ä¸€ä¸ªçƒ­é—¨çš„å¨±ä¹æ–°é—»ï¼‰ï¼‰ã€‚çƒ­keyé—®é¢˜å°±æ˜¯ï¼Œçªç„¶æœ‰å‡ åä¸‡çš„è¯·æ±‚å»è®¿é—®redisä¸Šçš„æŸä¸ªç‰¹å®škeyã€‚é‚£ä¹ˆè¿™æ ·ä¼šé€ æˆredisæœåŠ¡å™¨çŸ­æ—¶é—´æµé‡è¿‡äºé›†ä¸­ï¼Œå¾ˆå¯èƒ½å¯¼è‡´redisçš„æœåŠ¡å™¨å®•æœºã€‚é‚£ä¹ˆæ¥ä¸‹æ¥å¯¹è¿™ä¸ªKeyçš„è¯·æ±‚ï¼Œéƒ½ä¼šç›´æ¥è¯·æ±‚åˆ°æˆ‘ä»¬çš„åç«¯æ•°æ®åº“ä¸­ï¼Œæ•°æ®åº“æ€§èƒ½æœ¬æ¥å°±ä¸é«˜ï¼Œè¿™æ ·å°±å¯èƒ½ç›´æ¥å‹å®æ•°æ®åº“ï¼Œè¿›è€Œå¯¼è‡´åç«¯æœåŠ¡ä¸å¯ç”¨ã€‚</p><h2 id="4-2-äº§ç”ŸåŸå› "><a href="#4-2-äº§ç”ŸåŸå› " class="headerlink" title="4.2 äº§ç”ŸåŸå› "></a>4.2 äº§ç”ŸåŸå› </h2><p>ç”¨æˆ·æ¶ˆè´¹çš„æ•°æ®è¿œå¤§äºç”Ÿäº§çš„æ•°æ®ï¼Œå¦‚å•†å“ç§’æ€ã€çƒ­ç‚¹æ–°é—»ã€çƒ­ç‚¹è¯„è®ºç­‰è¯»å¤šå†™å°‘çš„åœºæ™¯</p><p>åŒåä¸€ç§’æ€å•†å“ï¼ŒçŸ­æ—¶é—´å†…æŸä¸ªçˆ†æ¬¾å•†å“å¯èƒ½è¢«ç‚¹å‡»&#x2F;è´­ä¹°ä¸Šç™¾ä¸‡æ¬¡ï¼Œæˆ–è€…æŸæ¡çˆ†ç‚¸æ€§æ–°é—»ç­‰è¢«å¤§é‡æµè§ˆï¼Œæ­¤æ—¶ä¼šé€ æˆä¸€ä¸ªè¾ƒå¤§çš„è¯·æ±‚Redisé‡ï¼Œè¿™ç§æƒ…å†µä¸‹å°±ä¼šé€ æˆçƒ­ç‚¹Keyé—®é¢˜ã€‚</p><h2 id="4-3-æ€ä¹ˆå‘ç°çƒ­key"><a href="#4-3-æ€ä¹ˆå‘ç°çƒ­key" class="headerlink" title="4.3 æ€ä¹ˆå‘ç°çƒ­key"></a>4.3 æ€ä¹ˆå‘ç°çƒ­key</h2><ol><li><p>å‡­å€Ÿä¸šåŠ¡ç»éªŒï¼Œè¿›è¡Œé¢„ä¼°å“ªäº›æ˜¯çƒ­key<br>å…¶å®è¿™ä¸ªæ–¹æ³•è¿˜æ˜¯æŒºæœ‰å¯è¡Œæ€§çš„ã€‚æ¯”å¦‚æŸå•†å“åœ¨åšç§’æ€ï¼Œé‚£è¿™ä¸ªå•†å“çš„keyå°±å¯ä»¥åˆ¤æ–­å‡ºæ˜¯çƒ­keyã€‚ç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼Œå¹¶éæ‰€æœ‰ä¸šåŠ¡éƒ½èƒ½é¢„ä¼°å‡ºå“ªäº›keyæ˜¯çƒ­keyã€‚</p></li><li><p><em>åœ¨å®¢æˆ·ç«¯è¿›è¡Œæ”¶é›†</em>ã€‚</p><p>æ“ä½œredisä¹‹å‰ï¼ŒåŠ å…¥ä¸€è¡Œä»£ç è¿›è¡Œæ•°æ®ç»Ÿè®¡ã€‚é‚£ä¹ˆè¿™ä¸ªæ•°æ®ç»Ÿè®¡çš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»™å¤–éƒ¨çš„é€šè®¯ç³»ç»Ÿå‘é€ä¸€ä¸ªé€šçŸ¥ä¿¡æ¯ã€‚ç¼ºç‚¹å°±æ˜¯å¯¹å®¢æˆ·ç«¯ä»£ç é€ æˆå…¥ä¾µã€‚</p></li><li><p>ç”¨redisè‡ªå¸¦å‘½ä»¤</p><p>(1). monitorå‘½ä»¤ï¼Œè¯¥å‘½ä»¤å¯ä»¥å®æ—¶æŠ“å–å‡ºredisæœåŠ¡å™¨æ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œç„¶åå†™ä»£ç ç»Ÿè®¡å‡ºçƒ­keyæ˜¯å•¥ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰ç°æˆçš„åˆ†æå·¥å…·å¯ä»¥ç»™ä½ ä½¿ç”¨ï¼Œæ¯”å¦‚<code>redis-faina</code>ã€‚ä½†æ˜¯è¯¥å‘½ä»¤åœ¨é«˜å¹¶å‘çš„æ¡ä»¶ä¸‹ï¼Œæœ‰å†…å­˜å¢æš´å¢çš„éšæ‚£ï¼Œè¿˜ä¼šé™ä½redisçš„æ€§èƒ½ã€‚<br>(2). hotkeyså‚æ•°ï¼Œredis 4.0.3æä¾›äº†redis-cliçš„çƒ­ç‚¹keyå‘ç°åŠŸèƒ½ï¼Œæ‰§è¡Œredis-cliæ—¶åŠ ä¸Šâ€“hotkeysé€‰é¡¹å³å¯ã€‚ä½†æ˜¯è¯¥å‚æ•°åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œå¦‚æœkeyæ¯”è¾ƒå¤šï¼Œæ‰§è¡Œèµ·æ¥æ¯”è¾ƒæ…¢ã€‚</p></li><li><p><em>è‡ªå·±æŠ“åŒ…è¯„ä¼°</em></p><p>è‡ªå·±å†™ç¨‹åºç›‘å¬ç«¯å£ï¼ŒæŒ‰ç…§RESPåè®®è§„åˆ™è§£ææ•°æ®ï¼Œè¿›è¡Œåˆ†æã€‚ç¼ºç‚¹å°±æ˜¯å¼€å‘æˆæœ¬é«˜ï¼Œç»´æŠ¤å›°éš¾ï¼Œæœ‰ä¸¢åŒ…å¯èƒ½æ€§ã€‚</p></li></ol><h2 id="4-4-å¦‚ä½•è§£å†³"><a href="#4-4-å¦‚ä½•è§£å†³" class="headerlink" title="4.4 å¦‚ä½•è§£å†³"></a>4.4 å¦‚ä½•è§£å†³</h2><ol><li>Redisé›†ç¾¤æ‰©å®¹ï¼šå¢åŠ åˆ†ç‰‡å‰¯æœ¬ï¼Œåˆ†æ‘Šå®¢æˆ·ç«¯å‘è¿‡æ¥çš„è¯»è¯·æ±‚ï¼›**</li><li>ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œå³JVMæœ¬åœ°ç¼“å­˜ï¼Œå‡å°‘Redisçš„è¯»è¯·æ±‚ã€‚æ¯”å¦‚åˆ©ç”¨<code>HashMap</code>ã€‚åœ¨ä½ å‘ç°çƒ­keyä»¥åï¼ŒæŠŠçƒ­keyåŠ è½½åˆ°ç³»ç»Ÿçš„JVMä¸­ã€‚é’ˆå¯¹è¿™ç§çƒ­keyè¯·æ±‚ï¼Œä¼šç›´æ¥ä»jvmä¸­å–ï¼Œè€Œä¸ä¼šèµ°åˆ°rediså±‚ã€‚</li></ol><h3 id="4-3-1-äº’æ–¥é”"><a href="#4-3-1-äº’æ–¥é”" class="headerlink" title="4.3.1 äº’æ–¥é”"></a>4.3.1 äº’æ–¥é”</h3><p>åˆ©ç”¨äº’æ–¥é”æ¥è§£å†³ï¼Œæ­¤æ–¹æ³•åªå…è®¸ä¸€ä¸ªçº¿ç¨‹é‡å»ºç¼“å­˜ï¼Œ å…¶ä»–çº¿ç¨‹ç­‰å¾…é‡å»ºç¼“å­˜çš„çº¿ç¨‹æ‰§è¡Œå®Œï¼Œ é‡æ–°ä»ç¼“å­˜è·å–æ•°æ®å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">String <span class="hljs-title">get</span><span class="hljs-params">(String key)</span> </span>&#123;<br>    <span class="hljs-comment">// ä»Redisä¸­è·å–æ•°æ®</span><br>    String value = redis.get(key);<br>    <span class="hljs-comment">// å¦‚æœvalueä¸ºç©ºï¼Œ åˆ™å¼€å§‹é‡æ„ç¼“å­˜</span><br>    <span class="hljs-keyword">if</span> (value == <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-comment">// åªå…è®¸ä¸€ä¸ªçº¿ç¨‹é‡å»ºç¼“å­˜ï¼Œ ä½¿ç”¨nxï¼Œ å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ex</span><br>        String mutexKey = <span class="hljs-string">&quot;mutext:key:&quot;</span> + key;<br>        <span class="hljs-keyword">if</span> (redis.set(mutexKey, <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;ex 180&quot;</span>, <span class="hljs-string">&quot;nx&quot;</span>)) &#123;<br>             <span class="hljs-comment">// ä»æ•°æ®æºè·å–æ•°æ®</span><br>            value = db.get(key);<br>            <span class="hljs-comment">// å›å†™Redisï¼Œ å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´</span><br>            redis.setex(key, timeout, value);<br>            <span class="hljs-comment">// åˆ é™¤key_mutex</span><br>            redis.delete(mutexKey);<br>        &#125;<span class="hljs-comment">// å…¶ä»–çº¿ç¨‹ä¼‘æ¯50æ¯«ç§’åé‡è¯•</span><br>        <span class="hljs-keyword">else</span> &#123;<br>            Thread.sleep(<span class="hljs-number">50</span>);<br>            get(key);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> value;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="5-ç¼“å­˜ä¸æ•°æ®åº“ä¸ä¸€è‡´"><a href="#5-ç¼“å­˜ä¸æ•°æ®åº“ä¸ä¸€è‡´" class="headerlink" title="5 ç¼“å­˜ä¸æ•°æ®åº“ä¸ä¸€è‡´"></a>5 <strong>ç¼“å­˜ä¸æ•°æ®åº“ä¸ä¸€è‡´</strong></h1><h2 id="5-1-å®šä¹‰"><a href="#5-1-å®šä¹‰" class="headerlink" title="5.1 å®šä¹‰"></a>5.1 å®šä¹‰</h2><p>åœ¨å¤§å¹¶å‘ä¸‹ï¼ŒåŒæ—¶æ“ä½œæ•°æ®åº“ä¸ç¼“å­˜ä¼šå­˜åœ¨æ•°æ®ä¸ä¸€è‡´æ€§é—®é¢˜</p><h2 id="5-2-ç¼“å­˜ä¸€è‡´æ€§çš„è§£å†³æ–¹æ¡ˆ"><a href="#5-2-ç¼“å­˜ä¸€è‡´æ€§çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="5.2 ç¼“å­˜ä¸€è‡´æ€§çš„è§£å†³æ–¹æ¡ˆ"></a>5.2 ç¼“å­˜ä¸€è‡´æ€§çš„è§£å†³æ–¹æ¡ˆ</h2><table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¸€è‡´æ€§ç±»å‹</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>åˆç†è®¾ç½®ç¼“å­˜æ—¶é—´</td><td></td><td></td><td></td></tr><tr><td>æ¶ˆæ¯é˜Ÿåˆ—</td><td>æœ€ç»ˆä¸€è‡´æ€§</td><td>å®ç°ç®€å•ï¼Œé€‚åˆå¼‚æ­¥åœºæ™¯</td><td>å­˜åœ¨çŸ­æš‚ä¸ä¸€è‡´çŠ¶æ€</td></tr><tr><td>åœ¨æ•°æ®åº“ä¸­å¢åŠ æ—¶é—´æˆ³&#x2F;ç‰ˆæœ¬å·</td><td>æœ€ç»ˆä¸€è‡´æ€§</td><td>ç®€å•æ˜“å®ç°</td><td>éœ€è¦é¢å¤–å­—æ®µ</td></tr><tr><td>åŒå†™ + å»¶è¿ŸåŒåˆ </td><td>æœ€ç»ˆä¸€è‡´æ€§</td><td>å®ç°ç®€å•</td><td>å­˜åœ¨çŸ­æš‚ä¸ä¸€è‡´çŠ¶æ€</td></tr><tr><td>Binlog åŒæ­¥</td><td>æœ€ç»ˆä¸€è‡´æ€§</td><td>è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜</td><td>éœ€è¦é¢å¤–çš„å·¥å…·æ”¯æŒ</td></tr><tr><td>åˆ†å¸ƒå¼é”</td><td>æœ€ç»ˆä¸€è‡´æ€§</td><td></td><td></td></tr></tbody></table><h3 id="5-2-1-åˆç†è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´"><a href="#5-2-1-åˆç†è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´" class="headerlink" title="5.2.1 åˆç†è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´"></a>5.2.1 åˆç†è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´</h3><p>å¯¹äºå¹¶å‘å‡ ç‡å¾ˆå°çš„æ•°æ®(å¦‚ä¸ªäººç»´åº¦çš„è®¢å•æ•°æ®ã€ç”¨æˆ·æ•°æ®ç­‰)ï¼Œè¿™ç§å‡ ä¹ä¸ç”¨è€ƒè™‘è¿™ä¸ªé—®é¢˜ï¼Œå¾ˆå°‘ä¼šå‘ç”Ÿç¼“å­˜ä¸ä¸€è‡´ï¼Œå¯ä»¥ç»™ç¼“å­˜æ•°æ®åŠ ä¸Šè¿‡æœŸæ—¶é—´ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´è§¦å‘è¯»çš„ä¸»åŠ¨æ›´æ–°å³å¯ã€‚</p><h3 id="5-2-2-å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—"><a href="#5-2-2-å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="5.2.2 å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—"></a>5.2.2 <strong>å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—</strong></h3><ol><li>æ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå¹¶å°†æ›´æ–°äº‹ä»¶å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ã€‚</li><li>æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆè´¹è€…æ¥æ”¶åˆ°äº‹ä»¶åï¼Œæ›´æ–° Redis ä¸­çš„æ•°æ®ã€‚</li><li>å¦‚æœ Redis æ›´æ–°å¤±è´¥ï¼Œå¯ä»¥é€šè¿‡é‡è¯•æœºåˆ¶æˆ–äººå·¥å¹²é¢„è§£å†³é—®é¢˜ã€‚</li></ol><h5 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a><strong>ä¼˜ç‚¹</strong></h5><ul><li>å®ç°ç®€å•ï¼Œé€‚åˆå¼‚æ­¥åœºæ™¯ã€‚</li><li>å‡å°‘äº†æ•°æ®åº“çš„å‹åŠ›ã€‚</li></ul><h5 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a><strong>ç¼ºç‚¹</strong></h5><ul><li>å­˜åœ¨çŸ­æš‚çš„ä¸ä¸€è‡´çŠ¶æ€ã€‚</li><li>éœ€è¦é¢å¤–çš„æ¶ˆæ¯é˜Ÿåˆ—ç»„ä»¶ã€‚</li><li>éœ€è¦ä¿è¯æ¶ˆæ¯çš„<a href="https://pyr9.github.io/kafka%E7%9A%84%E6%B6%88%E6%81%AF%E9%9B%B6%E4%B8%A2%E5%A4%B1%E6%96%B9%E6%A1%88/">å¯é æ€§</a>ã€<a href="https://pyr9.github.io/kafka%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/#%E6%B6%88%E8%B4%B9%E9%A1%BA%E5%BA%8F%E6%80%8E%E4%B9%88%E4%BF%9D%E8%AF%81%EF%BC%9F">é¡ºåºæ€§</a>ã€<a href="https://pyr9.github.io/kafka%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/#kafka-%E5%A6%82%E4%BD%95%E4%B8%8D%E6%B6%88%E8%B4%B9%E9%87%8D%E5%A4%8D%E6%95%B0%E6%8D%AE%EF%BC%9F">å¹‚ç­‰æ€§</a></li></ul><h3 id="5-2-2åŸºäºæ—¶é—´æˆ³æˆ–ç‰ˆæœ¬å·çš„å†²çªæ£€æµ‹"><a href="#5-2-2åŸºäºæ—¶é—´æˆ³æˆ–ç‰ˆæœ¬å·çš„å†²çªæ£€æµ‹" class="headerlink" title="5.2.2åŸºäºæ—¶é—´æˆ³æˆ–ç‰ˆæœ¬å·çš„å†²çªæ£€æµ‹"></a>5.2.2<strong>åŸºäºæ—¶é—´æˆ³æˆ–ç‰ˆæœ¬å·çš„å†²çªæ£€æµ‹</strong></h3><p>é€šè¿‡åœ¨æ•°æ®åº“å’Œ Redis ä¸­è®°å½•æ—¶é—´æˆ³æˆ–ç‰ˆæœ¬å·ï¼Œå¯ä»¥æ£€æµ‹å’Œè§£å†³æ•°æ®å†²çªã€‚</p><h5 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a><strong>æµç¨‹</strong></h5><ol><li>åœ¨æ•°æ®åº“ä¸­å¢åŠ ä¸€ä¸ª <code>version</code> æˆ– <code>timestamp</code> å­—æ®µã€‚</li><li>æ›´æ–°æ•°æ®åº“æ—¶ï¼ŒåŒæ—¶æ›´æ–°è¯¥å­—æ®µã€‚</li><li>æ›´æ–° Redis æ—¶ï¼Œæ£€æŸ¥å…¶ç‰ˆæœ¬å·æˆ–æ—¶é—´æˆ³æ˜¯å¦ä¸æ•°æ®åº“ä¸€è‡´ã€‚</li><li>å¦‚æœä¸ä¸€è‡´ï¼Œåˆ™ä»¥æ•°æ®åº“ä¸ºå‡†è¿›è¡Œä¿®æ­£ã€‚</li></ol><h5 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a><strong>ä¼˜ç‚¹</strong></h5><ul><li>ç®€å•æ˜“å®ç°ï¼Œé€‚åˆä¸­å°å‹ç³»ç»Ÿã€‚</li><li>ä¸éœ€è¦é¢å¤–çš„ç»„ä»¶ã€‚</li></ul><h3 id="5-2-2-åŒå†™ç­–ç•¥-å»¶è¿ŸåŒåˆ "><a href="#5-2-2-åŒå†™ç­–ç•¥-å»¶è¿ŸåŒåˆ " class="headerlink" title="5.2.2 åŒå†™ç­–ç•¥+ å»¶è¿ŸåŒåˆ "></a>5.2.2 <strong>åŒå†™ç­–ç•¥</strong>+ å»¶è¿ŸåŒåˆ </h3><p>è¿™æ˜¯ä¸€ç§å¸¸è§çš„ç¼“å­˜æ›´æ–°ç­–ç•¥ï¼Œé€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚</p><h5 id="æµç¨‹-1"><a href="#æµç¨‹-1" class="headerlink" title="æµç¨‹"></a><strong>æµç¨‹</strong></h5><ol><li>å†™æ“ä½œ<ul><li>å…ˆæ›´æ–°æ•°æ®åº“ã€‚</li><li>å†æ›´æ–° Redisã€‚</li></ul></li><li>åˆ é™¤æ“ä½œ<ul><li>å…ˆåˆ é™¤ Redis ä¸­çš„æ•°æ®ã€‚</li><li>å»¶è¿Ÿä¸€æ®µæ—¶é—´åå†åˆ é™¤æ•°æ®åº“ä¸­çš„æ•°æ®ï¼ˆé˜²æ­¢ Redis åˆ é™¤åæœªåŠæ—¶åŒæ­¥ï¼‰ã€‚</li></ul></li></ol><h5 id="ä¼˜ç‚¹-2"><a href="#ä¼˜ç‚¹-2" class="headerlink" title="ä¼˜ç‚¹"></a><strong>ä¼˜ç‚¹</strong></h5><ul><li>å®ç°ç®€å•ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯ã€‚</li><li>ä¸éœ€è¦é¢å¤–çš„ç»„ä»¶ã€‚</li></ul><h5 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a><strong>ç¼ºç‚¹</strong></h5><ul><li>å­˜åœ¨çŸ­æš‚çš„ä¸ä¸€è‡´çŠ¶æ€ã€‚</li><li>åˆ é™¤æ“ä½œéœ€è¦å»¶è¿Ÿå¤„ç†ã€‚</li></ul><h3 id="5-2-1-ä½¿ç”¨åˆ†å¸ƒå¼é”"><a href="#5-2-1-ä½¿ç”¨åˆ†å¸ƒå¼é”" class="headerlink" title="5.2.1 ä½¿ç”¨åˆ†å¸ƒå¼é”"></a>5.2.1 <strong>ä½¿ç”¨åˆ†å¸ƒå¼é”</strong></h3><p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œä½¿ç”¨åˆ†å¸ƒå¼é”ï¼ˆå¦‚Redisï¼Œzookeeperåˆ†å¸ƒå¼é”ï¼‰æ¥æ§åˆ¶ç¼“å­˜çš„æ›´æ–°æ“ä½œï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><h3 id="5-5-4-åŸºäºæ•°æ®åº“-Binlog-çš„è‡ªåŠ¨åŒæ­¥"><a href="#5-5-4-åŸºäºæ•°æ®åº“-Binlog-çš„è‡ªåŠ¨åŒæ­¥" class="headerlink" title="5.5.4 åŸºäºæ•°æ®åº“ Binlog çš„è‡ªåŠ¨åŒæ­¥"></a>5.5.4 <strong>åŸºäºæ•°æ®åº“ Binlog çš„è‡ªåŠ¨åŒæ­¥</strong></h3><p>é€šè¿‡è®¢é˜…æ•°æ®åº“çš„ Binlogï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰ï¼Œå¯ä»¥å®æ—¶å°†æ•°æ®åŒæ­¥åˆ° Redisã€‚</p><h5 id="æµç¨‹-2"><a href="#æµç¨‹-2" class="headerlink" title="æµç¨‹"></a><strong>æµç¨‹</strong></h5><ol><li>æ•°æ®åº“å†™å…¥æ•°æ®æ—¶ï¼Œç”Ÿæˆ Binlogã€‚</li><li>ä½¿ç”¨å·¥å…·ï¼ˆå¦‚ Canalã€Debeziumï¼‰è®¢é˜… Binlogï¼Œæ•è·æ•°æ®å˜æ›´ã€‚</li><li>æ ¹æ®æ•è·çš„å˜æ›´äº‹ä»¶ï¼Œè‡ªåŠ¨æ›´æ–° Redisã€‚</li></ol><h5 id="ä¼˜ç‚¹-3"><a href="#ä¼˜ç‚¹-3" class="headerlink" title="ä¼˜ç‚¹"></a><strong>ä¼˜ç‚¹</strong></h5><ul><li>è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜ï¼Œæ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç ã€‚</li><li>å®æ—¶æ€§å¼ºï¼Œé€‚åˆå¯¹ä¸€è‡´æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ã€‚</li></ul><h5 id="ç¼ºç‚¹-2"><a href="#ç¼ºç‚¹-2" class="headerlink" title="ç¼ºç‚¹"></a><strong>ç¼ºç‚¹</strong></h5><ul><li>å¯¹æ•°æ®åº“æ€§èƒ½æœ‰ä¸€å®šå½±å“ã€‚</li><li>éœ€è¦é¢å¤–çš„å·¥å…·æ”¯æŒã€‚</li></ul><p><strong>é€‰æ‹©å“ªç§æ–¹æ¡ˆå–å†³äºå…·ä½“éœ€æ±‚ï¼š</strong></p><ul><li><p>å¦‚æœå¯ä»¥å®¹å¿çŸ­æš‚çš„ä¸ä¸€è‡´ï¼Œå¯ä»¥é€‰æ‹© <strong>æ¶ˆæ¯é˜Ÿåˆ—</strong> æˆ– <strong>åŒå†™ + å»¶è¿ŸåŒåˆ </strong>ã€‚</p></li><li><p>å¦‚æœéœ€è¦å¼ºä¸€è‡´æ€§ï¼Œå¯ä»¥é€‰æ‹© <strong>Binlog åŒæ­¥</strong>æˆ–<strong>åˆ†å¸ƒå¼é”</strong>ã€‚</p></li></ul><p>æ³¨ï¼š<strong>æ”¾å…¥ç¼“å­˜çš„æ•°æ®åº”è¯¥æ˜¯å¯¹å®æ—¶æ€§ã€ä¸€è‡´æ€§è¦æ±‚ä¸æ˜¯å¾ˆé«˜çš„æ•°æ®ã€‚</strong>å¦‚æœ<strong>å†™å¤šè¯»å¤š</strong>çš„æƒ…å†µåˆä¸èƒ½å®¹å¿ç¼“å­˜æ•°æ®ä¸ä¸€è‡´ï¼Œé‚£å°±æ²¡å¿…è¦åŠ ç¼“å­˜äº†ï¼Œå¯ä»¥ç›´æ¥æ“ä½œæ•°æ®åº“ã€‚å¦‚æœæ•°æ®åº“æŠ—ä¸ä½å‹åŠ›ï¼Œè¿˜å¯ä»¥æŠŠç¼“å­˜ä½œä¸ºæ•°æ®è¯»å†™çš„ä¸»å­˜å‚¨ï¼Œå¼‚æ­¥å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®åº“ï¼Œæ•°æ®åº“åªæ˜¯ä½œä¸ºæ•°æ®çš„å¤‡ä»½ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¼“å­˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redisé›†ç¾¤ä¸‰ç§æ–¹å¼</title>
    <link href="/Redis%E9%9B%86%E7%BE%A4%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/"/>
    <url>/Redis%E9%9B%86%E7%BE%A4%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸ºä»€ä¹ˆè¦æœ‰é›†ç¾¤"><a href="#ä¸ºä»€ä¹ˆè¦æœ‰é›†ç¾¤" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æœ‰é›†ç¾¤"></a>ä¸ºä»€ä¹ˆè¦æœ‰é›†ç¾¤</h1><ul><li>å•ä¸ªRediså­˜åœ¨ä¸ç¨³å®šæ€§ï¼Œå½“RedisæœåŠ¡å®•æœºæˆ–ç¡¬ç›˜æ•…éšœï¼Œç³»ç»Ÿå´©æºƒä¹‹åï¼Œå°±æ²¡æœ‰å¯ç”¨çš„æœåŠ¡äº†ï¼Œè¿˜ä¼šé€ æˆæ•°æ®çš„ä¸¢å¤±</li><li>å•ä¸ªRedisçš„è¯»å†™èƒ½åŠ›ä¹Ÿæ˜¯æœ‰é™çš„</li><li>è¿˜ç”±äºäº’è”ç½‘çš„ä¸‰é«˜<a href="https://so.csdn.net/so/search?q=%E6%9E%B6%E6%9E%84&spm=1001.2101.3001.7020">æ¶æ„</a>ï¼Œé«˜å¹¶å‘ï¼Œé«˜æ€§èƒ½ï¼Œé«˜å¯ç”¨</li></ul><blockquote><p>é€šè¿‡æ·»åŠ æœåŠ¡å™¨çš„æ•°é‡ï¼Œæä¾›ç›¸åŒçš„æœåŠ¡ï¼Œä»è€Œè®©æœåŠ¡å™¨è¾¾åˆ°ä¸€ä¸ªç¨³å®šï¼Œé«˜æ•ˆçš„çŠ¶æ€</p></blockquote><h1 id="Redisé›†ç¾¤çš„ä¸‰ç§æ¨¡å¼"><a href="#Redisé›†ç¾¤çš„ä¸‰ç§æ¨¡å¼" class="headerlink" title="Redisé›†ç¾¤çš„ä¸‰ç§æ¨¡å¼"></a>Redisé›†ç¾¤çš„ä¸‰ç§æ¨¡å¼</h1><h2 id="1-ä¸»ä»æ¨¡å¼"><a href="#1-ä¸»ä»æ¨¡å¼" class="headerlink" title="1. ä¸»ä»æ¨¡å¼"></a>1. ä¸»ä»æ¨¡å¼</h2><h3 id="äº§ç”Ÿçš„åŸå› "><a href="#äº§ç”Ÿçš„åŸå› " class="headerlink" title="äº§ç”Ÿçš„åŸå› "></a>äº§ç”Ÿçš„åŸå› </h3><ul><li>é¿å…å•ç‚¹RedisæœåŠ¡å™¨æ•…éšœã€‚æ•°æ®ä¸¢å¤±ï¼Œå¯èƒ½å¯¹ä¸šåŠ¡é€ æˆç¾éš¾æ€§æ‰“å‡»</li><li>å®¹é‡ç“¶é¢ˆã€‚å†…å­˜ä¸è¶³ï¼Œä¸€å°rediså†…å­˜æ˜¯æœ‰é™çš„</li></ul><h3 id="ç‰¹å¾"><a href="#ç‰¹å¾" class="headerlink" title="ç‰¹å¾"></a>ç‰¹å¾</h3><ul><li><p>ä¸€ä¸ªmasterå¯ä»¥æ‹¥æœ‰å¤šä¸ªslaveï¼Œä¸€ä¸ªslaveåªå¯¹åº”ä¸€ä¸ªmaster</p></li><li><p><strong>ä¸€ä¸»å¤šä»ï¼Œä¸»è´Ÿè´£å†™ï¼Œå¹¶ä¸”å°†æ•°æ®å¤åˆ¶åˆ°å…¶å®ƒçš„ slave èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹è´Ÿè´£è¯»</strong>ã€‚</p></li><li><p>æ‰€æœ‰çš„è¯»è¯·æ±‚å…¨éƒ¨èµ°ä»èŠ‚ç‚¹ã€‚è¿™æ ·ä¹Ÿå¯ä»¥å¾ˆè½»æ¾å®ç°æ°´å¹³æ‰©å®¹ï¼Œæ”¯æ’‘<strong>è¯»é«˜å¹¶å‘</strong>ã€‚</p></li><li><p>slaveæŒ‚äº†ä¸å½±å“å…¶ä»–slaveçš„è¯»å’Œmasterçš„è¯»å’Œå†™ï¼Œé‡æ–°å¯åŠ¨åä¼šå°†æ•°æ®ä»masteråŒæ­¥è¿‡æ¥ã€‚å¯ä»¥ä½¿ç”¨å…¨é‡å¤åˆ¶å’Œéƒ¨åˆ†å¤åˆ¶</p></li><li><p>masteræŒ‚äº†ä»¥åï¼Œä¸å½±å“slaveçš„è¯»ï¼Œä½†redisä¸å†æä¾›å†™æœåŠ¡ï¼Œmasteré‡å¯årediså°†é‡æ–°å¯¹å¤–æä¾›å†™æœåŠ¡</p></li><li><p>masteræŒ‚äº†ä»¥åï¼Œä¸ä¼šåœ¨slaveèŠ‚ç‚¹ä¸­é‡æ–°é€‰ä¸€ä¸ªmasterï¼Œåªèƒ½æ‰‹åŠ¨çš„ä¸€ä¸ªä¸€ä¸ªæ”¹ï¼Œä¸åˆé€‚ï¼Œå°±æœ‰äº†ä¹‹åçš„å“¨å…µ</p></li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224935732.png" alt="image-20230228224935732"></p><h3 id="Redisä¸»ä»å¤åˆ¶å·¥ä½œåŸç†"><a href="#Redisä¸»ä»å¤åˆ¶å·¥ä½œåŸç†" class="headerlink" title="Redisä¸»ä»å¤åˆ¶å·¥ä½œåŸç†"></a><strong>Redisä¸»ä»å¤åˆ¶å·¥ä½œåŸç†</strong></h3><h4 id="1-å…¨é‡å¤åˆ¶æµç¨‹ï¼š"><a href="#1-å…¨é‡å¤åˆ¶æµç¨‹ï¼š" class="headerlink" title="1. å…¨é‡å¤åˆ¶æµç¨‹ï¼š"></a>1. å…¨é‡å¤åˆ¶æµç¨‹ï¼š</h4><p>Rediså…¨é‡å¤åˆ¶ä¸€èˆ¬å‘ç”Ÿåœ¨Slaveåˆå§‹åŒ–é˜¶æ®µï¼Œè¿™æ—¶Slaveéœ€è¦å°†Masterä¸Šçš„æ‰€æœ‰æ•°æ®éƒ½å¤åˆ¶ä¸€ä»½ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224944541.png" alt="image-20230228224944541"></p><ol><li>å¦‚æœä½ ä¸ºmasteré…ç½®äº†ä¸€ä¸ªslaveï¼Œä¸ç®¡è¿™ä¸ªslaveæ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡è¿æ¥ä¸ŠMasterï¼Œå®ƒéƒ½ä¼šå‘é€ä¸€ä¸ª<strong>SYNC</strong>å‘½ä»¤(redis2.8ç‰ˆæœ¬ä¹‹å‰çš„å‘½ä»¤)masterè¯·æ±‚å¤åˆ¶æ•°æ®ã€‚</li><li>masteræ”¶åˆ°SYNCå‘½ä»¤åï¼Œä¼šåœ¨åå°è¿›è¡Œæ•°æ®æŒä¹…åŒ–é€šè¿‡bgsaveç”Ÿæˆæœ€æ–°çš„rdbå¿«ç…§æ–‡ä»¶ã€‚</li><li>masterå°†ç”Ÿæˆçš„rdbæ•°æ®å‘ç»™slaveã€‚</li><li>Masterç”±äºä»æ‰§è¡Œbgsaveåˆ°ç”Ÿæˆrdbæ•°æ®å­˜åœ¨æ—¶é—´ï¼Œåœ¨æ­¤æ—¶é—´é—´éš”å†…ï¼Œå¯èƒ½æœ‰æ–°çš„å®¢æˆ·ç«¯è¯·æ±‚ï¼Œmasterä¼šæŠŠè¿™äº›æœ€è¿‘çš„è¯·æ±‚ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚ï¼ˆä¹Ÿå°±æ˜¯ä¸€ä¸ªæœ€è¿‘æ•°æ®çš„ç¼“å†²åŒºï¼Œé»˜è®¤å¤§å°ä¸º1Mï¼‰</li><li>å½“ç¬¬3æ­¥çš„rdbæ•°æ®å‘å®Œåï¼Œä»–ä¼šæŠŠè¿™äº›ç¼“å­˜çš„æ•°æ®ä¹Ÿå‘ç»™slave</li><li>å½“slaveæœ‰è€çš„rdbæ•°æ®ï¼Œå°±ä¼šå…ˆæŠŠè€çš„æ•°æ®æ¸…æ‰ã€‚é‡æ–°ç”ŸæˆåŒ…å«ç¼“å­˜çš„rd bæ•°æ®ï¼Œå¹¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</li><li>ä¹‹åï¼Œmasterå’Œslaveé€šè¿‡socketé•¿è¿æ¥ï¼ŒæŒç»­è¿›è¡Œå‘½ä»¤åŒæ­¥ï¼Œä»è€Œä¿è¯ä¸»ä»æ•°æ®ä¸€è‡´ã€‚</li></ol><blockquote><p>å½“masterä¸slaveä¹‹é—´çš„è¿æ¥ç”±äºæŸäº›åŸå› è€Œæ–­å¼€æ—¶ï¼Œslaveèƒ½å¤Ÿè‡ªåŠ¨é‡è¿Masterã€‚</p></blockquote><blockquote><p>å¦‚æœmasteræ”¶åˆ°äº†å¤šä¸ªslaveå¹¶å‘è¿æ¥è¯·æ±‚ï¼Œå®ƒåªä¼šè¿›è¡Œä¸€æ¬¡æŒä¹…åŒ–ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªè¿æ¥ä¸€æ¬¡ï¼Œç„¶åå†æŠŠè¿™ä¸€ä»½æŒä¹…åŒ–çš„æ•°æ®å‘é€ç»™å¤šä¸ªå¹¶å‘è¿æ¥çš„slaveã€‚  </p></blockquote><p><strong>å½“masterå’Œslaveæ–­å¼€é‡è¿åï¼Œä¸€èˆ¬éƒ½ä¼šå¯¹æ•´ä»½æ•°æ®è¿›è¡Œå¤åˆ¶ã€‚ä½†ä»redis2.8ç‰ˆæœ¬å¼€å§‹ï¼Œmasterå’Œslaveæ–­å¼€é‡è¿åæ”¯æŒéƒ¨åˆ†å¤åˆ¶</strong>ã€‚</p><h4 id="2-éƒ¨åˆ†å¤åˆ¶æµç¨‹"><a href="#2-éƒ¨åˆ†å¤åˆ¶æµç¨‹" class="headerlink" title="2. éƒ¨åˆ†å¤åˆ¶æµç¨‹"></a>2. éƒ¨åˆ†å¤åˆ¶æµç¨‹</h4><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224955344.png" alt="image-20230228224955344"></p><ol><li>ä»2.8ç‰ˆæœ¬å¼€å§‹ï¼Œslaveä¸masterèƒ½å¤Ÿåœ¨ç½‘ç»œè¿æ¥æ–­å¼€<strong>é‡è¿ååªè¿›è¡Œéƒ¨åˆ†æ•°æ®å¤åˆ¶ã€‚</strong> </li><li>masterä¼šåœ¨å…¶å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªå¤åˆ¶æ•°æ®ç”¨çš„ç¼“å­˜é˜Ÿåˆ—ï¼Œç¼“å­˜æœ€è¿‘ä¸€æ®µæ—¶é—´çš„æ•°æ®ã€‚masterå’Œå®ƒæ‰€æœ‰çš„slaveéƒ½ç»´æŠ¤äº†å¤åˆ¶çš„æ•°æ®ä¸‹æ ‡offsetå’Œmasterçš„è¿›ç¨‹idã€‚</li><li>å½“ç½‘ç»œè¿æ¥æ–­å¼€åï¼Œslaveä¼šè¯·æ±‚masterç»§ç»­è¿›è¡Œæœªå®Œæˆçš„å¤åˆ¶ã€‚<ul><li>ä»èŠ‚ç‚¹æ•°æ®ä¸‹æ ‡ offsetè¿˜åœ¨ç¼“å­˜é˜Ÿåˆ—é‡Œï¼Œé‚£ä¹ˆå°†ä¼šä»slaveè®°å½•çš„æ•°æ®ä¸‹æ ‡å¼€å§‹ä»ç¼“å­˜åŒºå¤åˆ¶ã€‚</li><li>å¦‚æœmasterè¿›ç¨‹idå˜åŒ–äº†ï¼Œæˆ–è€…ä»èŠ‚ç‚¹æ•°æ®ä¸‹æ ‡ offsetå¤ªæ—§ï¼Œå·²ç»ä¸åœ¨masterçš„ç¼“å­˜é˜Ÿåˆ—é‡Œäº†ï¼Œé‚£ä¹ˆå°†ä¼šè¿›è¡Œä¸€æ¬¡å…¨é‡æ•°æ®çš„å¤åˆ¶</li></ul></li></ol><h4 id="3-å¢é‡å¤åˆ¶"><a href="#3-å¢é‡å¤åˆ¶" class="headerlink" title="3 å¢é‡å¤åˆ¶"></a>3 å¢é‡å¤åˆ¶</h4><ul><li><p>æ˜¯æŒ‡åœ¨åˆå§‹åŒ–çš„å…¨é‡å¤åˆ¶å¹¶å¼€å§‹æ­£å¸¸å·¥ä½œä¹‹åï¼ŒmasteræœåŠ¡å™¨å°†å‘ç”Ÿçš„å†™æ“ä½œåŒæ­¥åˆ°slaveæœåŠ¡å™¨çš„è¿‡ç¨‹</p></li><li><p>å¢é‡å¤åˆ¶çš„è¿‡ç¨‹ä¸»è¦æ˜¯masteræœåŠ¡å™¨æ¯æ‰§è¡Œä¸€ä¸ªå†™å‘½ä»¤å°±ä¼šå‘slaveæœåŠ¡å™¨å‘é€ç›¸åŒçš„å†™å‘½ä»¤ï¼ŒslaveæœåŠ¡å™¨æ¥æ”¶å¹¶æ‰§è¡Œæ”¶åˆ°çš„å†™å‘½ä»¤ã€‚</p></li></ul><h2 id="2-å“¨å…µæ¨¡å¼"><a href="#2-å“¨å…µæ¨¡å¼" class="headerlink" title="2. å“¨å…µæ¨¡å¼"></a>2. å“¨å…µæ¨¡å¼</h2><h3 id="äº§ç”Ÿçš„åŸå› -1"><a href="#äº§ç”Ÿçš„åŸå› -1" class="headerlink" title="äº§ç”Ÿçš„åŸå› "></a>äº§ç”Ÿçš„åŸå› </h3><p>ä¸»ä»æ¨¡å¼ä¸‹ï¼Œä¸»æœºå®•æœºï¼Œéœ€è¦äººä¸ºå»è®¾ç½®masterï¼Œå“¨å…µæ¨¡å¼å°±æ˜¯è§£å†³ï¼šä¸ç”¨äººä¸ºè¿›è¡Œå¹²é¢„ï¼Œé«˜å¯ç”¨çš„æ¢å¤æ­£å¸¸ã€‚</p><blockquote><p>å“¨å…µï¼ˆsentinelï¼‰æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç”¨äºå¯¹ä¸»ä»ç»“æ„ä¸­çš„æ¯å°æœåŠ¡å™¨è¿›è¡Œç›‘æ§ï¼Œå½“å‡ºç°æ•…éšœæ—¶é€šè¿‡æŠ•ç¥¨æœºåˆ¶é€‰æ‹©æ–°çš„masterå¹¶å°†æ‰€æœ‰slaveè¿æ¥åˆ°æ–°çš„master</p></blockquote><h3 id="ç‰¹å¾-1"><a href="#ç‰¹å¾-1" class="headerlink" title="ç‰¹å¾"></a>ç‰¹å¾</h3><ul><li>ç›‘æ§ï¼šsentinelå“¨å…µæ˜¯ç‰¹æ®Šçš„redisæœåŠ¡ï¼Œä¸æä¾›è¯»å†™æœåŠ¡ï¼Œä¸»è¦ç”¨æ¥ä¸æ–­åœ°æ£€æŸ¥masterå’Œslaveæ˜¯å¦æ­£å¸¸è¿è¡Œã€‚ </li><li>è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼šå½“masterå‡ºç°é—®é¢˜æ—¶ï¼Œé€‰å–ä¸€ä¸ªslaveä½œä¸ºmasterï¼Œå°†å…¶ä»–slaveè¿æ¥åˆ°æ–°åœ°masterï¼Œå¹¶å‘ŠçŸ¥å®¢æˆ·ç«¯æ–°åœ°æœåŠ¡å™¨åœ°å€</li><li>é€šçŸ¥ï¼šå½“redisçš„ä¸»èŠ‚ç‚¹å‘ç”Ÿå˜åŒ–ï¼Œå“¨å…µä¼šç¬¬ä¸€æ—¶é—´æ„ŸçŸ¥åˆ°ï¼Œå¹¶ä¸”å°†æ–°çš„redisä¸»èŠ‚ç‚¹é€šçŸ¥ç»™clientç«¯(è¿™é‡Œé¢redisçš„clientç«¯ä¸€èˆ¬éƒ½å®ç°äº†è®¢é˜…åŠŸèƒ½ï¼Œè®¢é˜…sentinelå‘å¸ƒçš„èŠ‚ç‚¹å˜åŠ¨æ¶ˆæ¯)</li></ul><p><strong>æ³¨âš ï¸ï¼š</strong></p><ul><li>å“¨å…µæ¶æ„ä¸‹clientç«¯ç¬¬ä¸€æ¬¡ä»å“¨å…µæ‰¾å‡ºredisçš„ä¸»èŠ‚ç‚¹ï¼Œåç»­å°±ç›´æ¥è®¿é—®redisçš„ä¸»èŠ‚ç‚¹ï¼Œä¸ä¼šæ¯æ¬¡éƒ½é€šè¿‡sentinelä»£ç†è®¿é—®redisçš„ä¸»èŠ‚ç‚¹ã€‚</li><li>å“¨å…µä¹Ÿæ˜¯ä¸€å°redisæœåŠ¡å™¨ï¼Œåªæ˜¯ä¸æä¾›æ•°æ®æœåŠ¡</li><li>ä¸ºäº†é«˜å¯ç”¨ä¸€èˆ¬éƒ½æ¨èè‡³å°‘éƒ¨ç½²ä¸‰ä¸ªå“¨å…µèŠ‚ç‚¹</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225006830.png" alt="image-20230228225006830"></p><h3 id="å“¨å…µleaderé€‰ä¸¾æµç¨‹"><a href="#å“¨å…µleaderé€‰ä¸¾æµç¨‹" class="headerlink" title="å“¨å…µleaderé€‰ä¸¾æµç¨‹"></a><strong>å“¨å…µleaderé€‰ä¸¾æµç¨‹</strong></h3><p>å½“ä¸€ä¸ªmasteræœåŠ¡å™¨è¢«æŸsentinelè§†ä¸ºä¸‹çº¿çŠ¶æ€åï¼Œè¯¥sentinelä¼šä¸å…¶ä»–sentinelåå•†é€‰å‡ºsentinelçš„leaderè¿›è¡Œæ•…éšœè½¬ç§»å·¥ä½œã€‚</p><ol><li>æ¯ä¸ªå‘ç°masteræœåŠ¡å™¨è¿›å…¥ä¸‹çº¿çš„sentineléƒ½å¯ä»¥è¦æ±‚å…¶ä»–sentinelé€‰è‡ªå·±ä¸ºsentinelçš„ leaderï¼Œé€‰ä¸¾æ˜¯å…ˆåˆ°å…ˆå¾—ã€‚</li><li>è¶…è¿‡ä¸€åŠçš„sentinelé€‰ä¸¾æŸsentinelä½œä¸ºleaderã€‚ä¹‹åè¯¥sentinelè¿›è¡Œæ•…éšœè½¬ç§»æ“ä½œï¼Œä»å­˜æ´»çš„slaveä¸­é€‰ä¸¾å‡ºæ–°çš„master</li></ol><h2 id="3-Clusteræ¨¡å¼"><a href="#3-Clusteræ¨¡å¼" class="headerlink" title="3. Clusteræ¨¡å¼"></a>3. Clusteræ¨¡å¼</h2><h3 id="äº§ç”Ÿçš„åŸå› -2"><a href="#äº§ç”Ÿçš„åŸå› -2" class="headerlink" title="äº§ç”Ÿçš„åŸå› "></a>äº§ç”Ÿçš„åŸå› </h3><ul><li>å“¨å…µæ¨¡å¼ï¼Œå¦‚æœmasterèŠ‚ç‚¹å¼‚å¸¸ï¼Œåœ¨ä¸»ä»åˆ‡æ¢çš„ç¬é—´ï¼Œå­˜åœ¨ä¸å¯ç”¨çš„æƒ…å†µã€‚</li><li>å“¨å…µæ¨¡å¼åªæœ‰å•ä¸ªä¸»èŠ‚ç‚¹å¯ä»¥ç”¨æ¥å†™ï¼Œæ²¡æ³•æ”¯æŒå¾ˆé«˜çš„å¹¶å‘ã€‚</li><li>å“¨å…µæ¨¡å¼å•ä¸ªèŠ‚ç‚¹çš„å†…å­˜ä¹Ÿä¸å®œè®¾çš„å¤ªå¤§ï¼Œä¼šå¯¼è‡´æŒä¹…åŒ–æ–‡ä»¶è¿‡å¤§ï¼Œå½±å“æ•°æ®æ¢å¤ä¸»ä»æ•ˆç‡ã€‚</li></ul><h3 id="ç‰¹å¾-2"><a href="#ç‰¹å¾-2" class="headerlink" title="ç‰¹å¾"></a>ç‰¹å¾</h3><ul><li>Redis-Clusteré‡‡ç”¨æ— ä¸­å¿ƒç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¿å­˜æ•°æ®å’Œæ•´ä¸ªé›†ç¾¤çŠ¶æ€ã€‚</li><li>æä¾›å¤šä¸ªmasterèŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œæ¯ä¸ªmasterèŠ‚ç‚¹ä¸­å­˜å‚¨çš„æ•°æ®éƒ½ä¸ä¸€æ ·ï¼Œè¿™äº›æ•°æ®é€šè¿‡æ•°æ®åˆ†ç‰‡çš„æ–¹å¼è¢«è‡ªåŠ¨åˆ†å‰²åˆ°ä¸åŒçš„masterèŠ‚ç‚¹ä¸Šã€‚</li><li>æ¯ä¸ªmasterèŠ‚ç‚¹ä¸‹é¢è¿˜éœ€è¦æ·»åŠ è‡³å°‘1ä¸ªslaveèŠ‚ç‚¹ï¼Œè¿™æ ·å½“æŸä¸ªmasterèŠ‚ç‚¹å‘ç”Ÿæ•…éšœåï¼Œå¯ä»¥ä»å®ƒçš„slaveèŠ‚ç‚¹ä¸­é€‰ä¸¾ä¸€ä¸ªä½œä¸ºæ–°çš„masterèŠ‚ç‚¹ç»§ç»­æä¾›æœåŠ¡</li><li>Redis Cluster å°†æ‰€æœ‰æ•°æ®åˆ’åˆ†ä¸º 16384 ä¸ª slots(æ§½ä½)ï¼Œæ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£å…¶ä¸­ä¸€éƒ¨åˆ†æ§½ä½ã€‚æ§½ä½çš„ä¿¡æ¯å­˜å‚¨äºæ¯ ä¸ªèŠ‚ç‚¹ä¸­ã€‚å½“ Redis Cluster çš„å®¢æˆ·ç«¯æ¥è¿æ¥é›†ç¾¤æ—¶ï¼Œå®ƒä¹Ÿä¼šå¾—åˆ°ä¸€ä»½é›†ç¾¤çš„æ§½ä½é…ç½®ä¿¡æ¯å¹¶å°†å…¶ç¼“å­˜åœ¨å®¢æˆ·ç«¯æœ¬åœ°ã€‚è¿™æ ·å½“å®¢æˆ·ç«¯è¦æŸ¥æ‰¾æŸä¸ª key æ—¶ï¼Œå¯ä»¥ç›´æ¥å®šä½åˆ°ç›®æ ‡èŠ‚ç‚¹ã€‚</li></ul><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228225016550.png" alt="image-20230228225016550"></p><h3 id="æ§½ä½å®šä½ç®—æ³•"><a href="#æ§½ä½å®šä½ç®—æ³•" class="headerlink" title="æ§½ä½å®šä½ç®—æ³•"></a><strong>æ§½ä½å®šä½ç®—æ³•</strong></h3><p>Cluster é»˜è®¤ä¼šå¯¹ key å€¼ä½¿ç”¨ crc16 ç®—æ³•è¿›è¡Œ hash å¾—åˆ°ä¸€ä¸ªæ•´æ•°å€¼ï¼Œç„¶åç”¨è¿™ä¸ªæ•´æ•°å€¼å¯¹ 16384 è¿›è¡Œå–æ¨¡ æ¥å¾—åˆ°å…·ä½“æ§½ä½ã€‚ </p><p><code>HASH_SLOT = CRC16(key) mod 16384</code> </p><h3 id="ç½‘ç»œæŠ–åŠ¨"><a href="#ç½‘ç»œæŠ–åŠ¨" class="headerlink" title="ç½‘ç»œæŠ–åŠ¨"></a><strong>ç½‘ç»œæŠ–åŠ¨</strong></h3><ul><li><p>Redis Cluster æä¾›äº†ä¸€ç§é€‰é¡¹<code>cluster-Â­node-Â­timeout</code>ï¼Œè¡¨ç¤ºå½“æŸä¸ªèŠ‚ç‚¹æŒç»­ timeout çš„æ—¶é—´å¤±è”æ—¶ï¼Œæ‰å¯ä»¥è®¤å®šè¯¥èŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œéœ€è¦è¿›è¡Œä¸»ä»åˆ‡æ¢ã€‚</p></li><li><p>å¦‚æœæ²¡æœ‰è¿™ä¸ªé€‰é¡¹ï¼Œç½‘ç»œæŠ–åŠ¨ä¼šå¯¼è‡´ä¸»ä»é¢‘ ç¹åˆ‡æ¢ (æ•°æ®çš„é‡æ–°å¤åˆ¶)ã€‚</p></li></ul><h3 id="Redisé›†ç¾¤é€‰ä¸¾åŸç†åˆ†æ"><a href="#Redisé›†ç¾¤é€‰ä¸¾åŸç†åˆ†æ" class="headerlink" title="Redisé›†ç¾¤é€‰ä¸¾åŸç†åˆ†æ"></a><strong>Redisé›†ç¾¤é€‰ä¸¾åŸç†åˆ†æ</strong></h3><p>å½“slaveå‘ç°è‡ªå·±çš„masterå˜ä¸ºFAILçŠ¶æ€æ—¶ï¼Œä¾¿å°è¯•è¿›è¡ŒFailoverï¼Œä»¥æœŸæˆä¸ºæ–°çš„masterã€‚ç”±äºæŒ‚æ‰çš„masterå¯èƒ½ä¼šæœ‰å¤šä¸ªslaveï¼Œä»è€Œå­˜åœ¨å¤šä¸ªslaveç«äº‰æˆä¸ºmasterèŠ‚ç‚¹çš„è¿‡ç¨‹ï¼Œ å…¶è¿‡ç¨‹å¦‚ä¸‹ï¼š </p><ol><li><p>slaveå‘ç°è‡ªå·±çš„masterå˜ä¸ºFAIL </p></li><li><p>å°†è‡ªå·±è®°å½•çš„é›†ç¾¤currentEpochåŠ 1ï¼Œå¹¶å¹¿æ’­FAILOVER_AUTH_REQUEST ä¿¡æ¯</p></li><li><p>å…¶ä»–èŠ‚ç‚¹æ”¶åˆ°è¯¥ä¿¡æ¯ï¼Œåªæœ‰masterå“åº”ï¼Œåˆ¤æ–­è¯·æ±‚è€…çš„åˆæ³•æ€§ï¼Œå¹¶å‘é€FAILOVER_AUTH_ACKï¼Œå¯¹æ¯ä¸€ä¸ª slaveråªå‘é€ä¸€æ¬¡ack </p></li><li><p>slaveæ”¶åˆ°è¶…è¿‡åŠæ•°masterçš„ackåå˜æˆæ–°Master</p></li><li><p>.slaveå¹¿æ’­Pongæ¶ˆæ¯é€šçŸ¥å…¶ä»–é›†ç¾¤èŠ‚ç‚¹ã€‚</p></li></ol><p>æ³¨æ„âš ï¸ï¼š</p><ul><li>ä»èŠ‚ç‚¹å¹¶ä¸æ˜¯åœ¨ä¸»èŠ‚ç‚¹ä¸€è¿›å…¥ FAIL çŠ¶æ€å°±é©¬ä¸Šå°è¯•å‘èµ·é€‰ä¸¾ï¼Œè€Œæ˜¯æœ‰ä¸€å®šå»¶è¿Ÿã€‚ä¸€å®šçš„å»¶è¿Ÿç¡®ä¿æˆ‘ä»¬ç­‰å¾… FAILçŠ¶æ€åœ¨é›†ç¾¤ä¸­ä¼ æ’­ï¼Œslaveå¦‚æœç«‹å³å°è¯•é€‰ä¸¾ï¼Œå…¶å®ƒmastersæˆ–è®¸å°šæœªæ„è¯†åˆ°FAILçŠ¶æ€ï¼Œå¯èƒ½ä¼šæ‹’ç»æŠ•ç¥¨</li><li>å»¶è¿Ÿè®¡ç®—å…¬å¼ï¼š DELAY &#x3D; 500ms + random(0 ~ 500ms) + SLAVE_RANK * 1000ms</li></ul><p>â€‹       SLAVE_RANKè¡¨ç¤ºæ­¤slaveå·²ç»ä»masterå¤åˆ¶æ•°æ®çš„æ€»é‡çš„rankã€‚Rankè¶Šå°ä»£è¡¨å·²å¤åˆ¶çš„æ•°æ®è¶Šæ–°ã€‚è¿™ç§æ–¹å¼ä¸‹ï¼ŒæŒæœ‰æœ€æ–°æ•°æ®çš„slaveå°†ä¼šé¦–å…ˆå‘èµ·é€‰ä¸¾ï¼ˆç†è®ºä¸Šï¼‰ã€‚</p><h3 id="é›†ç¾¤è„‘è£‚æ•°æ®ä¸¢å¤±é—®é¢˜"><a href="#é›†ç¾¤è„‘è£‚æ•°æ®ä¸¢å¤±é—®é¢˜" class="headerlink" title="é›†ç¾¤è„‘è£‚æ•°æ®ä¸¢å¤±é—®é¢˜"></a><strong>é›†ç¾¤è„‘è£‚æ•°æ®ä¸¢å¤±é—®é¢˜</strong></h3><p>ç½‘ç»œåˆ†åŒºå¯¼è‡´è„‘è£‚åå¤šä¸ªä¸»èŠ‚ç‚¹å¯¹å¤–æä¾›å†™æœåŠ¡ï¼Œä¸€æ—¦ç½‘ç»œåˆ†åŒºæ¢å¤ï¼Œ ä¼šå°†å…¶ä¸­ä¸€ä¸ªä¸»èŠ‚ç‚¹å˜ä¸ºä»èŠ‚ç‚¹ï¼Œè¿™æ—¶ä¼šæœ‰å¤§é‡æ•°æ®ä¸¢å¤±ã€‚</p><p>è§„é¿æ–¹æ³•å¯ä»¥åœ¨redisé…ç½®é‡ŒåŠ ä¸Šå‚æ•°(è¿™ç§æ–¹æ³•ä¸å¯èƒ½ç™¾åˆ†ç™¾é¿å…æ•°æ®ä¸¢å¤±ï¼Œå‚è€ƒé›†ç¾¤leaderé€‰ä¸¾æœºåˆ¶ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">minâ€replicasâ€toâ€write <span class="hljs-number">1</span> <span class="hljs-comment">//å†™æ•°æ®æˆåŠŸæœ€å°‘åŒæ­¥çš„slaveæ•°é‡ï¼Œè¿™ä¸ªæ•°é‡å¯ä»¥æ¨¡ä»¿å¤§äºåŠæ•°æœºåˆ¶é…ç½®ï¼Œæ¯”å¦‚ é›†ç¾¤æ€»å…±ä¸‰ä¸ªèŠ‚ç‚¹å¯ä»¥é…ç½®1ï¼ŒåŠ ä¸Šleaderå°±æ˜¯2ï¼Œè¶…è¿‡äº†åŠæ•°</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé…ç½®åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¼šå½±å“é›†ç¾¤çš„å¯ç”¨æ€§ï¼Œæ¯”å¦‚slaveè¦æ˜¯å°‘äº1ä¸ªï¼Œè¿™ä¸ªé›†ç¾¤å°±ç®—leaderæ­£å¸¸ä¹Ÿä¸èƒ½æä¾›æœåŠ¡äº†ï¼Œéœ€è¦å…·ä½“åœºæ™¯æƒè¡¡é€‰æ‹©ã€‚ </p><h3 id="Redisé›†ç¾¤ä¸ºä»€ä¹ˆè‡³å°‘éœ€è¦ä¸‰ä¸ªmasterèŠ‚ç‚¹ï¼Œå¹¶ä¸”æ¨èèŠ‚ç‚¹æ•°ä¸ºå¥‡æ•°"><a href="#Redisé›†ç¾¤ä¸ºä»€ä¹ˆè‡³å°‘éœ€è¦ä¸‰ä¸ªmasterèŠ‚ç‚¹ï¼Œå¹¶ä¸”æ¨èèŠ‚ç‚¹æ•°ä¸ºå¥‡æ•°" class="headerlink" title="Redisé›†ç¾¤ä¸ºä»€ä¹ˆè‡³å°‘éœ€è¦ä¸‰ä¸ªmasterèŠ‚ç‚¹ï¼Œå¹¶ä¸”æ¨èèŠ‚ç‚¹æ•°ä¸ºå¥‡æ•°"></a><strong>Redisé›†ç¾¤ä¸ºä»€ä¹ˆè‡³å°‘éœ€è¦ä¸‰ä¸ªmasterèŠ‚ç‚¹ï¼Œå¹¶ä¸”æ¨èèŠ‚ç‚¹æ•°ä¸ºå¥‡æ•°</strong></h3><ul><li>å› ä¸ºæ–°masterçš„é€‰ä¸¾éœ€è¦å¤§äºåŠæ•°çš„é›†ç¾¤masterèŠ‚ç‚¹åŒæ„æ‰èƒ½é€‰ä¸¾æˆåŠŸ</li><li>å¥‡æ•°ä¸ªmasterèŠ‚ç‚¹å¯ä»¥åœ¨æ»¡è¶³é€‰ä¸¾è¯¥æ¡ä»¶çš„åŸºç¡€ä¸ŠèŠ‚çœä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¯”å¦‚ä¸‰ä¸ªmasterèŠ‚ç‚¹å’Œå››ä¸ªmasterèŠ‚ç‚¹çš„é›†ç¾¤ç›¸æ¯”ï¼Œéƒ½åªå…è®¸æŒ‚ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦åˆ™é›†ç¾¤ä¸å¯ç”¨ã€‚æ‰€ä»¥å¥‡æ•°çš„masterèŠ‚ç‚¹æ›´å¤šçš„æ˜¯<strong>ä»èŠ‚çœæœºå™¨èµ„æºè§’åº¦å‡ºå‘</strong>è¯´çš„ã€‚</li></ul><h3 id="Redisé›†ç¾¤å¯¹æ‰¹é‡æ“ä½œå‘½ä»¤çš„æ”¯æŒ"><a href="#Redisé›†ç¾¤å¯¹æ‰¹é‡æ“ä½œå‘½ä»¤çš„æ”¯æŒ" class="headerlink" title="Redisé›†ç¾¤å¯¹æ‰¹é‡æ“ä½œå‘½ä»¤çš„æ”¯æŒ"></a><strong>Redisé›†ç¾¤å¯¹æ‰¹é‡æ“ä½œå‘½ä»¤çš„æ”¯æŒ</strong></h3><p>å¯¹äºç±»ä¼¼msetï¼Œmgetè¿™æ ·çš„å¤šä¸ªkeyçš„åŸç”Ÿæ‰¹é‡æ“ä½œå‘½ä»¤ï¼Œredisé›†ç¾¤åªæ”¯æŒæ‰€æœ‰keyè½åœ¨åŒä¸€slotçš„æƒ…å†µï¼Œå¦‚ æœæœ‰å¤šä¸ªkeyä¸€å®šè¦ç”¨msetå‘½ä»¤åœ¨redisé›†ç¾¤ä¸Šæ“ä½œï¼Œåˆ™å¯ä»¥åœ¨keyçš„å‰é¢åŠ ä¸Š{XX}ï¼Œè¿™æ ·å‚æ•°æ•°æ®åˆ†ç‰‡hashè®¡ç®—çš„åªä¼šæ˜¯å¤§æ‹¬å·é‡Œçš„å€¼ï¼Œè¿™æ ·èƒ½ç¡®ä¿ä¸åŒçš„keyèƒ½è½åˆ°åŒä¸€sloté‡Œå»ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">mset &#123;user1&#125;:<span class="hljs-number">1</span>:name zhuge &#123;user1&#125;:<span class="hljs-number">1</span>:age <span class="hljs-number">18</span><br></code></pre></td></tr></table></figure><p>å‡è®¾nameå’Œageè®¡ç®—çš„hash slotå€¼ä¸ä¸€æ ·ï¼Œä½†æ˜¯è¿™æ¡å‘½ä»¤åœ¨é›†ç¾¤ä¸‹æ‰§è¡Œï¼Œredisåªä¼šç”¨å¤§æ‹¬å·é‡Œçš„ user1 åš hash slotè®¡ç®—ï¼Œæ‰€ä»¥ç®—å‡ºæ¥çš„slotå€¼è‚¯å®šç›¸åŒï¼Œæœ€åéƒ½èƒ½è½åœ¨åŒä¸€slot</p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>redisä¸»ä»æ¶æ„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>redisæŒä¹…åŒ–</title>
    <link href="/redis%E6%8C%81%E4%B9%85%E5%8C%96/"/>
    <url>/redis%E6%8C%81%E4%B9%85%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<blockquote><p>redis æŒä¹…åŒ–ä¸»è¦æœ‰2ç§æ–¹å¼ï¼šRDB å’ŒAOF</p></blockquote><h1 id="RDBå¿«ç…§"><a href="#RDBå¿«ç…§" class="headerlink" title="RDBå¿«ç…§"></a>RDBå¿«ç…§</h1><h2 id="ä»€ä¹ˆæ˜¯RDBå¿«ç…§"><a href="#ä»€ä¹ˆæ˜¯RDBå¿«ç…§" class="headerlink" title="ä»€ä¹ˆæ˜¯RDBå¿«ç…§"></a>ä»€ä¹ˆæ˜¯RDBå¿«ç…§</h2><ul><li>rdbå°±æ˜¯å¿«ç…§ï¼Œæ˜¯redisé»˜è®¤çš„æŒä¹…åŒ–æ–¹å¼ï¼Œå°±æ˜¯æŠŠæ‰€æœ‰çš„æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œéš”ä¸€æ®µæ—¶é—´æŒä¹…åŒ–ä¸€æ¬¡åˆ° dump.rdb çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œåœ¨æœåŠ¡å™¨é‡å¯ååªéœ€è¦æŠŠæ–‡ä»¶ä¸­çš„æ•°æ®æ¢å¤å³å¯ã€‚ </li><li>ä½ å¯ä»¥å¯¹ Redis è¿›è¡Œè®¾ç½®ï¼Œ è®©å®ƒåœ¨â€œ N ç§’å†…æ•°æ®é›†è‡³å°‘æœ‰ M ä¸ªæ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶è¢«æ»¡è¶³æ—¶ï¼Œ è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®é›†ã€‚ æ¯”å¦‚è¯´ï¼Œ <code>save 60 1000</code>ä¼šè®© Redis åœ¨æ»¡è¶³â€œ 60 ç§’å†…æœ‰è‡³å°‘æœ‰ 1000 ä¸ªé”®è¢«æ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶æ—¶ï¼Œ è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®é›†</li></ul><h2 id="RDB-æ–‡ä»¶çš„åˆ›å»º"><a href="#RDB-æ–‡ä»¶çš„åˆ›å»º" class="headerlink" title="RDB æ–‡ä»¶çš„åˆ›å»º"></a>RDB æ–‡ä»¶çš„åˆ›å»º</h2><blockquote><p>æœ‰ä¸¤ç§æ–¹å¼ï¼šæ‰‹åŠ¨è§¦å‘å’Œè‡ªåŠ¨è§¦å‘</p></blockquote><h3 id="æ‰‹åŠ¨è§¦å‘"><a href="#æ‰‹åŠ¨è§¦å‘" class="headerlink" title="æ‰‹åŠ¨è§¦å‘"></a>æ‰‹åŠ¨è§¦å‘</h3><ul><li>saveå‘½ä»¤ä¼šé˜»å¡å½“å‰RedisæœåŠ¡å™¨ï¼Œç›´åˆ°RDBè¿‡ç¨‹å®Œæˆä¸ºæ­¢ã€‚åœ¨æœåŠ¡å™¨è¿›ç¨‹é˜»å¡æœŸé—´ï¼ŒæœåŠ¡å™¨ä¸èƒ½å¤„ç†ä»»ä½•å‘½ä»¤è¯·æ±‚ã€‚å› æ­¤ï¼Œå½“saveå‘½ä»¤æ­£åœ¨æ‰§è¡Œæ—¶ï¼Œå®¢æˆ·ç«¯å‘é€çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«æ‹’ç»ï¼ŒçŸ¥é“saveå‘½ä»¤æ‰§è¡Œå®Œæ¯•ã€‚ï¼ˆä¸å»ºè®®ä½¿ç”¨ï¼‰</li><li>bgsave å‘½ä»¤ä¼šforkå‡ºä¸€ä¸ªå­è¿›ç¨‹(è€Œä¸æ˜¯çº¿ç¨‹)ï¼Œç”±å­è¿›ç¨‹è¿›è¡ŒRDBæ–‡ä»¶åˆ›å»ºï¼Œè€Œçˆ¶è¿›ç¨‹ç»§ç»­å¤„ç†å‘½ä»¤ã€‚</li></ul><blockquote><p>è¿›å…¥rediså®¢æˆ·ç«¯æ‰§è¡Œå‘½ä»¤<strong>save</strong>æˆ–<strong>bgsave</strong>å¯ä»¥ç”Ÿæˆdump.rdbæ–‡ä»¶ï¼Œ æ¯æ¬¡å‘½ä»¤æ‰§è¡Œéƒ½ä¼šå°†æ‰€æœ‰rediså†…å­˜å¿«ç…§åˆ°ä¸€ä¸ªæ–°çš„rdbæ–‡ä»¶é‡Œï¼Œå¹¶è¦†ç›–åŸæœ‰rdbå¿«ç…§æ–‡ä»¶ã€‚ </p></blockquote><h3 id="è‡ªåŠ¨è§¦å‘"><a href="#è‡ªåŠ¨è§¦å‘" class="headerlink" title="è‡ªåŠ¨è§¦å‘"></a>è‡ªåŠ¨è§¦å‘</h3><p>redisé€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ï¼Œrediså¯ä»¥é€šè¿‡è®¾ç½®æœåŠ¡å™¨é…ç½®çš„saveé€‰é¡¹ï¼ŒæœåŠ¡å™¨æ¯éš”ä¸€æ®µæ—¶é—´è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡bgsaveå‘½ä»¤ã€‚</p><h3 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>é€‚åˆå¤§è§„æ¨¡çš„æ•°æ®æ¢å¤ï¼Œæ¢å¤é€Ÿåº¦å¿«ï¼</li><li>ä½“ç§¯å°ï¼Œç›¸è¾ƒäºaofä»–åªæ˜¯ä¿å­˜äº†ç»“æœï¼Œä¸éœ€è¦ä¿å­˜æ¯ä¸€æ¬¡å‘½ä»¤æ“ä½œã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>æ•°æ®éœ€è¦ä¸€å®šçš„æ—¶é—´é—´éš”è¿›ç¨‹æ“ä½œï¼ å¦‚æœ Redis å› ä¸ºæŸäº›åŸå› è€Œé€ æˆæ•…éšœåœæœºï¼Œ é‚£ä¹ˆæœåŠ¡å™¨å°†ä¸¢å¤±æœ€è¿‘å†™å…¥ã€ä¸”ä»æœªä¿å­˜åˆ°å¿«ç…§ä¸­çš„é‚£äº›æ•°æ®å°±æ²¡æœ‰äº†ã€‚</li></ul><h1 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h1><ul><li>ä»¥ç‹¬ç«‹æ—¥å¿—çš„æ–¹å¼è®°å½•æ¯æ¬¡å†™å‘½ä»¤ï¼Œæ¯å½“ Redis æ‰§è¡Œä¸€ä¸ªæ”¹å˜æ•°æ®é›†çš„å‘½ä»¤æ—¶ï¼ˆæ¯”å¦‚ SETï¼‰ï¼Œ è¿™ä¸ªå‘½ä»¤å°±ä¼šè¢«è¿½åŠ åˆ° appendonly.aofæ–‡ ä»¶çš„æœ«å°¾ï¼Œå¹¶åœ¨ Redis é‡å¯æ—¶åœ¨é‡æ–°æ‰§è¡Œ AOF æ–‡ä»¶ä¸­çš„å‘½ä»¤ä»¥è¾¾åˆ°æ¢å¤æ•°æ®çš„ç›®çš„ã€‚</li><li>AOF çš„ä¸»è¦ä½œç”¨æ˜¯è§£å†³æ•°æ®æŒä¹…åŒ–çš„å®æ—¶æ€§ã€‚</li><li>ä½ å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥æ‰“å¼€ AOF åŠŸèƒ½ï¼š  <code>appendonly yes </code></li><li>ä½ å¯ä»¥é…ç½® Redis å¤šä¹…æ‰å°†æ•°æ® fsync åˆ°ç£ç›˜ä¸€æ¬¡ã€‚ <ul><li><strong>appendfsync always</strong>ï¼šæ¯æ¬¡æœ‰æ–°å‘½ä»¤è¿½åŠ åˆ° AOF æ–‡ä»¶æ—¶å°±æ‰§è¡Œä¸€æ¬¡ fsync ï¼Œéå¸¸æ…¢ï¼Œä¹Ÿéå¸¸å®‰å…¨ã€‚</li><li><strong>appendfsync everysec</strong>ï¼šæ¯ç§’ fsync ä¸€æ¬¡ï¼Œè¶³å¤Ÿå¿«ï¼ˆå’Œä½¿ç”¨ RDB æŒä¹…åŒ–å·®ä¸å¤šï¼‰ï¼Œå¹¶ä¸”åœ¨ æ•…éšœæ—¶åªä¼šä¸¢å¤± 1 ç§’é’Ÿçš„æ•°æ®ã€‚</li><li><strong>appendfsync no</strong>ï¼šï¼šä»ä¸ fsync ï¼Œå°†æ•°æ®äº¤ç»™æ“ä½œç³»ç»Ÿæ¥å¤„ç†ã€‚æ›´å¿«ï¼Œä¹Ÿæ›´ä¸å®‰å…¨çš„é€‰æ‹©ã€‚å› ä¸ºä½ ä¸æ¸…æ¥šä¸åŒçš„æ“ä½œç³»ç»Ÿåº•å±‚æ˜¯æ€ä¹ˆå»åˆ·ç£ç›˜çš„ã€‚</li></ul></li></ul><h2 id="AOF-é‡å†™"><a href="#AOF-é‡å†™" class="headerlink" title="AOF é‡å†™"></a>AOF é‡å†™</h2><ul><li><p>AOFæ–‡ä»¶é‡Œå¯èƒ½æœ‰å¤ªå¤šæ²¡ç”¨æŒ‡ä»¤ï¼Œæ¯”å¦‚3æ¬¡é€’å¢readcount, é‡å†™åç›´æ¥ä¼šå˜æˆreadcount:3ï¼ŒAOFä¼šå®šæœŸæ ¹æ®<strong>å†…å­˜çš„æœ€æ–°æ•°æ®</strong>ç”Ÿæˆaofæ–‡ä»¶</p></li><li><p>è¿›å…¥rediså®¢æˆ·ç«¯æ‰§è¡Œå‘½ä»¤<strong>bgrewriteaof</strong>é‡å†™AOF </p></li><li><p>AOFé‡å†™redisä¼šforkå‡ºä¸€ä¸ªå­è¿›ç¨‹å»åšï¼Œä¸ä¼šå¯¹redisæ­£å¸¸å‘½ä»¤å¤„ç†æœ‰å¤ªå¤šå½±å“</p></li><li><p>å¦‚ä¸‹ä¸¤ä¸ªé…ç½®å¯ä»¥æ§åˆ¶AOFè‡ªåŠ¨é‡å†™é¢‘ç‡ </p><ul><li>auto-aof-rewrite-min-size 64mb &#x2F;&#x2F;aofæ–‡ä»¶è‡³å°‘è¦è¾¾åˆ°64Mæ‰ä¼šè‡ªåŠ¨é‡å†™ï¼Œæ–‡ä»¶å¤ªå°æ¢å¤é€Ÿåº¦æœ¬æ¥å°±å¾ˆå¿«ï¼Œé‡å†™çš„æ„ä¹‰ä¸å¤§</li><li>auto-aof-rewrite-percentage 100 &#x2F;&#x2F;aofæ–‡ä»¶è‡ªä¸Šä¸€æ¬¡é‡å†™åæ–‡ä»¶å¤§å°å¢é•¿äº†100%åˆ™å†æ¬¡è§¦å‘é‡å†™</li></ul></li></ul><h3 id="ä¼˜ç¼ºç‚¹-1"><a href="#ä¼˜ç¼ºç‚¹-1" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>æ¯ä¸€æ¬¡ä¿®æ”¹éƒ½åŒæ­¥ï¼Œæ–‡ä»¶çš„å®Œæ•´æ€§ä¼šæ›´åŠ å¥½ï¼</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>ç›¸å¯¹äºæ•°æ®æ–‡ä»¶æ¥è¯´ï¼Œaofè¿œè¿œå¤§äº rdbï¼Œä¿®å¤çš„é€Ÿåº¦ä¹Ÿæ¯” rdbæ…¢ï¼</li></ul><h1 id="Redis-4-0-æ··åˆæŒä¹…åŒ–"><a href="#Redis-4-0-æ··åˆæŒä¹…åŒ–" class="headerlink" title="Redis 4.0 æ··åˆæŒä¹…åŒ–"></a><strong>Redis 4.0 æ··åˆæŒä¹…åŒ–</strong></h1><blockquote><p>é‡å¯ Redis æ—¶ï¼Œæˆ‘ä»¬å¾ˆå°‘ä½¿ç”¨ RDBæ¥æ¢å¤å†…å­˜çŠ¶æ€ï¼Œå› ä¸ºä¼šä¸¢å¤±å¤§é‡æ•°æ®ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ AOF æ—¥å¿—å­˜æ”¾ï¼Œä½†æ˜¯å­˜æ”¾ AOF æ—¥å¿—æ€§èƒ½ç›¸å¯¹ RDBæ¥è¯´è¦æ…¢å¾ˆå¤šï¼Œè¿™æ ·åœ¨ Redis å®ä¾‹å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œå¯åŠ¨éœ€è¦èŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ã€‚</p><p>Redis 4.0 ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¸¦æ¥äº†ä¸€ä¸ªæ–°çš„æŒä¹…åŒ–é€‰é¡¹â€”â€”æ··åˆæŒä¹…åŒ–ã€‚ é€šè¿‡é…ç½® <code> aof-use-rdb-preamble yes</code>å¯ä»¥å¼€å¯æ··åˆæŒä¹…åŒ–ã€‚   </p></blockquote><h2 id="æ··åˆæŒä¹…åŒ–æµç¨‹"><a href="#æ··åˆæŒä¹…åŒ–æµç¨‹" class="headerlink" title="æ··åˆæŒä¹…åŒ–æµç¨‹"></a>æ··åˆæŒä¹…åŒ–æµç¨‹</h2><ul><li>å¦‚æœå¼€å¯äº†æ··åˆæŒä¹…åŒ–ã€‚<strong>AOFåœ¨é‡å†™æ—¶</strong>ï¼Œä¸å†æ˜¯å•çº¯å°†å†…å­˜æ•°æ®è½¬æ¢ä¸ºå‘½ä»¤å†™å…¥AOFæ–‡ä»¶ï¼Œè€Œæ˜¯æ ¹æ®aofå‘½ä»¤é‡å†™<strong>è¿™ä¸€åˆ»ä¹‹å‰</strong>çš„å†…å­˜åšRDBå¿«ç…§å¤„ç†ï¼Œå¹¶ä¸”å°†RDBå¿«ç…§å†…å®¹å’Œ<strong>å¢é‡çš„</strong>AOFä¿®æ”¹å†…å­˜æ•°æ®çš„å‘½ä»¤å­˜åœ¨ä¸€èµ·ï¼Œéƒ½å†™å…¥æ–°çš„AOFæ–‡ä»¶ã€‚</li><li>æ–°çš„æ–‡ä»¶ä¸€å¼€å§‹ä¸å«appendonly.aofï¼Œç­‰åˆ°é‡å†™å®Œæ–°çš„AOFæ–‡ä»¶æ‰ä¼šè¿›è¡Œæ”¹åï¼ŒåŸå­çš„è¦†ç›–åŸæœ‰çš„AOFæ–‡ä»¶ï¼Œå®Œæˆæ–°æ—§ä¸¤ä¸ªAOFæ–‡ä»¶çš„æ›¿æ¢ã€‚</li><li>äºæ˜¯åœ¨ Redis é‡å¯çš„æ—¶å€™ï¼Œå¯ä»¥å…ˆåŠ è½½ RDB çš„å†…å®¹ï¼Œç„¶åå†åŠ è½½å¢é‡ AOF æ—¥å¿—å°±å¯ä»¥å®Œå…¨æ›¿ä»£ä¹‹å‰çš„ AOF å…¨é‡æ–‡ä»¶çš„åŠ è½½ï¼Œå› æ­¤é‡å¯æ•ˆç‡å¤§å¹…å¾—åˆ°æå‡ã€‚</li></ul><h2 id="æ··åˆæŒä¹…åŒ–AOFæ–‡ä»¶ç»“æ„"><a href="#æ··åˆæŒä¹…åŒ–AOFæ–‡ä»¶ç»“æ„" class="headerlink" title="æ··åˆæŒä¹…åŒ–AOFæ–‡ä»¶ç»“æ„"></a>æ··åˆæŒä¹…åŒ–AOFæ–‡ä»¶ç»“æ„</h2><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gxtx3e8tbhj30r40i23zd.jpg" style="zoom:50%;" /><img src="https://tva1.sinaimg.cn/large/008i3skNly1gxtx4ka5e8j31ey0q6myv.jpg" style="zoom: 33%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>redisæŒä¹…åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>rediså¸¸è§é¢è¯•é¢˜</title>
    <link href="/redis/"/>
    <url>/redis/</url>
    
    <content type="html"><![CDATA[<blockquote><p>redisæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„key-value æ•°æ®åº“ï¼Œå®ƒå¯ä»¥ç”¨æ¥å­˜å‚¨å­—ç¬¦ä¸²ï¼Œå“ˆå¸Œï¼Œåˆ—è¡¨ï¼Œé›†åˆï¼Œæœ‰åºé›†åˆã€‚</p></blockquote><h1 id="1-rediså¸¸è§æ•°æ®ç»“æ„"><a href="#1-rediså¸¸è§æ•°æ®ç»“æ„" class="headerlink" title="1. rediså¸¸è§æ•°æ®ç»“æ„"></a>1. rediså¸¸è§æ•°æ®ç»“æ„</h1><h2 id="1-String"><a href="#1-String" class="headerlink" title="1 String"></a>1 String</h2><p>String æ˜¯redisä¸­æœ€åŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œä¸»è¦ç”¨åœ¨å¸¸è§„è®¡æ•°ï¼Œå¦‚ï¼šç»Ÿè®¡ç½‘ç«™è®¿é—®æ•°æ®é‡ï¼Œå½“å‰åœ¨çº¿äººæ•°ç­‰</p><h3 id="1-åº”ç”¨åœºæ™¯"><a href="#1-åº”ç”¨åœºæ™¯" class="headerlink" title="1.åº”ç”¨åœºæ™¯"></a>1.<strong>åº”ç”¨åœºæ™¯</strong></h3><h4 id="1-å•å€¼ç¼“å­˜"><a href="#1-å•å€¼ç¼“å­˜" class="headerlink" title="1 å•å€¼ç¼“å­˜"></a>1 å•å€¼ç¼“å­˜</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> key1 &quot;zhangsan&quot;<br></code></pre></td></tr></table></figure><h4 id="2-è®¡æ•°å™¨"><a href="#2-è®¡æ•°å™¨" class="headerlink" title="2 è®¡æ•°å™¨"></a>2 è®¡æ•°å™¨</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> article:readcount:mysql<span class="hljs-operator">-</span>tutorial <span class="hljs-number">12</span><br></code></pre></td></tr></table></figure><h4 id="3-åˆ†å¸ƒå¼ç³»ç»Ÿå…¨å±€åºåˆ—å·"><a href="#3-åˆ†å¸ƒå¼ç³»ç»Ÿå…¨å±€åºåˆ—å·" class="headerlink" title="3. åˆ†å¸ƒå¼ç³»ç»Ÿå…¨å±€åºåˆ—å·"></a>3. åˆ†å¸ƒå¼ç³»ç»Ÿå…¨å±€åºåˆ—å·</h4><p>INCRBY  orderId  1000&#x2F;&#x2F;redisæ‰¹é‡ç”Ÿæˆåºåˆ—å·æå‡æ€§èƒ½</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> incrby orderId  <span class="hljs-number">1000</span><br></code></pre></td></tr></table></figure><h4 id="4-åˆ†å¸ƒå¼é”-redisson"><a href="#4-åˆ†å¸ƒå¼é”-redisson" class="headerlink" title="4. åˆ†å¸ƒå¼é”(redisson)"></a>4. åˆ†å¸ƒå¼é”(redisson)</h4><ul><li>SETNX  product:10001   </li><li>æ‰§è¡Œä¸šåŠ¡æ“ä½œã€‚ã€‚ã€‚</li><li>DEL  product:10001ã€‚                                     &#x2F;&#x2F;æ‰§è¡Œå®Œä¸šåŠ¡é‡Šæ”¾é”</li><li>SET product:10001 true  ex  10  nx          &#x2F;&#x2F;é˜²æ­¢ç¨‹åºæ„å¤–ç»ˆæ­¢å¯¼è‡´æ­»</li></ul><blockquote><p>SETNXï¼ˆ <strong>SET</strong> if <strong>N</strong>ot e<strong>X</strong>ists ï¼‰</p><ul><li><p>åœ¨æŒ‡å®šçš„ key ä¸å­˜åœ¨æ—¶ï¼Œä¸º key è®¾ç½®æŒ‡å®šçš„å€¼ï¼Œè¿™ç§æƒ…å†µä¸‹ç­‰åŒ <a href="https://www.redis.com.cn/commands/set.html">SET</a> å‘½ä»¤ã€‚å½“ <code>key</code>å­˜åœ¨æ—¶ï¼Œä»€ä¹ˆä¹Ÿä¸åšã€‚</p></li><li><p>è¿”å›å€¼</p><ul><li><code>1</code> å¦‚æœkeyè¢«è®¾ç½®äº†</li><li><code>0</code> å¦‚æœkeyæ²¡æœ‰è¢«è®¾ç½®</li></ul></li></ul></blockquote><h2 id="2-hash"><a href="#2-hash" class="headerlink" title="2. hash"></a>2. hash</h2><p>Hashæ˜¯ä¸€ä¸ªfield å’Œvalue çš„æ˜ å°„è¡¨ï¼Œç‰¹åˆ«é€‚åˆå­˜å‚¨å¯¹è±¡ï¼Œæ¯”å¦‚å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œå•†å“ä¿¡æ¯ç­‰ã€‚</p><h3 id="1-ä¼˜ç¼ºç‚¹ï¼š"><a href="#1-ä¼˜ç¼ºç‚¹ï¼š" class="headerlink" title="1. ä¼˜ç¼ºç‚¹ï¼š"></a>1. ä¼˜ç¼ºç‚¹ï¼š</h3><ul><li>ä¼˜ç‚¹<ul><li>åŒç±»æ•°æ®å½’ç±»æ•´åˆå‚¨å­˜ï¼Œæ–¹ä¾¿æ•°æ®ç®¡ç†</li><li>ç›¸æ¯”stringæ“ä½œæ¶ˆè€—å†…å­˜ä¸cpuæ›´å°</li><li>ç›¸æ¯”stringå‚¨å­˜æ›´èŠ‚çœç©ºé—´</li></ul></li><li>ç¼ºç‚¹<ul><li>è¿‡æœŸåŠŸèƒ½ä¸èƒ½ä½¿ç”¨åœ¨fieldä¸Šï¼Œåªèƒ½ç”¨åœ¨keyä¸Š</li></ul></li></ul><h3 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2. åº”ç”¨åœºæ™¯"></a>2. <strong>åº”ç”¨åœºæ™¯</strong></h3><h4 id="1-å¯¹è±¡ç¼“å­˜"><a href="#1-å¯¹è±¡ç¼“å­˜" class="headerlink" title="1 å¯¹è±¡ç¼“å­˜"></a>1 å¯¹è±¡ç¼“å­˜</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> HMSET  <span class="hljs-keyword">user</span>  <span class="hljs-number">1</span>:name  zhuge <span class="hljs-number">1</span>:balance  <span class="hljs-number">1888</span><br></code></pre></td></tr></table></figure><h4 id="2-ç”µå•†è´­ç‰©è½¦"><a href="#2-ç”µå•†è´­ç‰©è½¦" class="headerlink" title="2 ç”µå•†è´­ç‰©è½¦"></a>2 ç”µå•†è´­ç‰©è½¦</h4><ul><li>ä»¥ç”¨æˆ·idä¸ºkeyï¼›     å•†å“idä¸ºfieldï¼›    å•†å“æ•°é‡ä¸ºvalueï¼›</li><li>è´­ç‰©è½¦æ“ä½œ<ul><li>æ·»åŠ å•†å“ <code> hset cart:user2 &quot;apple&quot; 1</code></li><li>å¢åŠ æ•°é‡  <code> hincrby cart:user2 &quot;apple&quot; 3</code></li><li>å•†å“æ€»æ•° <code>hlen cart:user2</code></li><li>åˆ é™¤å•†å“ <code>hdel cart:user2 &quot;apple&quot;</code></li><li>è·å–è´­ç‰©è½¦æ‰€æœ‰å•†å“ <code>hgetall cart:user2</code></li></ul></li></ul><h2 id="3-list"><a href="#3-list" class="headerlink" title="3. list"></a>3. list</h2><p>listæ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„ï¼Œä¸»è¦åŠŸèƒ½æ˜¯pushå’Œpopï¼ˆæ·»åŠ å’Œå¼¹å‡ºé›†åˆå…ƒç´ ï¼‰ï¼Œè·å–ä¸€ä¸ªèŒƒå›´çš„å€¼ç­‰ã€‚å¸¸ç”¨äºï¼šç²‰ä¸åˆ—è¡¨ï¼Œæœ€æ–°æ¶ˆæ¯æ’è¡Œã€‚</p><h3 id="1-åº”ç”¨åœºæ™¯-1"><a href="#1-åº”ç”¨åœºæ™¯-1" class="headerlink" title="1. åº”ç”¨åœºæ™¯"></a>1. <strong>åº”ç”¨åœºæ™¯</strong></h3><h4 id="1-å¾®åšæ¶ˆæ¯å’Œå¾®ä¿¡å…¬å·æ¶ˆæ¯"><a href="#1-å¾®åšæ¶ˆæ¯å’Œå¾®ä¿¡å…¬å·æ¶ˆæ¯" class="headerlink" title="1. å¾®åšæ¶ˆæ¯å’Œå¾®ä¿¡å…¬å·æ¶ˆæ¯"></a>1. å¾®åšæ¶ˆæ¯å’Œå¾®ä¿¡å…¬å·æ¶ˆæ¯</h4><p>å¼ ä¸‰å…³æ³¨äº†2 ä¸ªè®¢é˜…å·ï¼Œç¾é£Ÿä¸“æ å’Œå¨±ä¹å‘¨è¾¹</p><ul><li><p>ç¾é£Ÿä¸“æ å‘æ¨é€</p><p> <code>lpush msg:zhangSan &quot;apple is yammy!&quot;</code></p></li><li><p>å¨±ä¹å‘¨è¾¹å‘æ¨é€.</p><p><code>lpush msg:zhangSan &quot;YangMi is beautiful!&quot;</code></p></li><li><p>æŸ¥çœ‹å¼ ä¸‰å…³æ³¨çš„æœ€æ–°è®¢é˜…å·æ¶ˆæ¯.</p><p> <code>lrange msg:zhangSan 0 5</code></p></li></ul><h2 id="4-set"><a href="#4-set" class="headerlink" title="4 set"></a>4 set</h2><p>Redis ä¸­çš„seté›†åˆæ˜¯æ— åºä¸”ä¸å¯é‡å¤çš„ï¼Œå®ƒæœ€å¤§çš„ä¼˜åŠ¿å¯ä»¥è¿›è¡Œäº¤é›†ï¼Œä¸™çº§ï¼Œå·®é›†ç­‰ï¼Œå¸¸ç”¨æ¥æ±‚å…±åŒå¥½å‹ç­‰ã€‚</p><h3 id="1-åº”ç”¨åœºæ™¯-2"><a href="#1-åº”ç”¨åœºæ™¯-2" class="headerlink" title="1. åº”ç”¨åœºæ™¯"></a>1. <strong>åº”ç”¨åœºæ™¯</strong></h3><h4 id="1-å¾®ä¿¡æŠ½å¥–å°ç¨‹åº"><a href="#1-å¾®ä¿¡æŠ½å¥–å°ç¨‹åº" class="headerlink" title="1  å¾®ä¿¡æŠ½å¥–å°ç¨‹åº"></a>1  å¾®ä¿¡æŠ½å¥–å°ç¨‹åº</h4><ul><li>ç‚¹å‡»å‚ä¸æŠ½å¥–åŠ å…¥é›†åˆ</li></ul><p>â€‹      <code>sadd iphone13 zhangsan</code></p><ul><li>æŸ¥çœ‹å‚ä¸æŠ½å¥–æ‰€æœ‰ç”¨æˆ·</li></ul><p>â€‹      <code>smembers iphone13</code>  </p><ul><li><p>æŠ½å–countåä¸­å¥–è€…  </p><ul><li><p>è¿”å›é›†åˆä¸­2ä¸ªéšæœºæ•°.</p><p><code>srandmember iphone13 2</code></p></li><li><p>ç§»é™¤å¹¶è¿”å›é›†åˆä¸­çš„2ä¸ªéšæœºå…ƒç´  </p><p> <code>spop iphone13 2</code></p></li></ul></li></ul><h4 id="2-å¾®ä¿¡å¾®åšç‚¹èµï¼Œæ”¶è—ï¼Œæ ‡ç­¾"><a href="#2-å¾®ä¿¡å¾®åšç‚¹èµï¼Œæ”¶è—ï¼Œæ ‡ç­¾" class="headerlink" title="2. å¾®ä¿¡å¾®åšç‚¹èµï¼Œæ”¶è—ï¼Œæ ‡ç­¾"></a>2. å¾®ä¿¡å¾®åšç‚¹èµï¼Œæ”¶è—ï¼Œæ ‡ç­¾</h4><ul><li>ç‚¹èµ<br>SADD  like:{æ¶ˆæ¯ID}  {ç”¨æˆ·ID}</li><li>å–æ¶ˆç‚¹èµ<br>SREM like:{æ¶ˆæ¯ID}  {ç”¨æˆ·ID}</li><li>æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç‚¹è¿‡èµ<br>SISMEMBER  like:{æ¶ˆæ¯ID}  {ç”¨æˆ·ID}</li><li>è·å–ç‚¹èµçš„ç”¨æˆ·åˆ—è¡¨<br>SMEMBERS like:{æ¶ˆæ¯ID}</li><li>è·å–ç‚¹èµç”¨æˆ·æ•°<br>SCARD like:{æ¶ˆæ¯ID}</li></ul><h3 id="2-é›†åˆæ“ä½œ"><a href="#2-é›†åˆæ“ä½œ" class="headerlink" title="2.é›†åˆæ“ä½œ"></a>2.é›†åˆæ“ä½œ</h3><ul><li>äº¤é›†ï¼šSINTER set1 set2 set3 </li><li>å¹¶é›†ï¼šSUNION set1 set2 set3</li><li>å·®é›†ï¼šSDIFF set1 set2 set3</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> sadd set1 <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span><br>(<span class="hljs-type">integer</span>) <span class="hljs-number">4</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> sadd set2 <span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span><br>(<span class="hljs-type">integer</span>) <span class="hljs-number">4</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> sinter set1 set2<br><span class="hljs-number">1</span>) &quot;1&quot;<br><span class="hljs-number">2</span>) &quot;3&quot;<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> sunion set1 set2<br><span class="hljs-number">1</span>) &quot;1&quot;<br><span class="hljs-number">2</span>) &quot;2&quot;<br><span class="hljs-number">3</span>) &quot;3&quot;<br><span class="hljs-number">4</span>) &quot;4&quot;<br><span class="hljs-number">5</span>) &quot;5&quot;<br><span class="hljs-number">6</span>) &quot;6&quot;<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> sdiff set1 set2<br><span class="hljs-number">1</span>) &quot;2&quot;<br><span class="hljs-number">2</span>) &quot;4&quot;<br></code></pre></td></tr></table></figure><h2 id="5-zset"><a href="#5-zset" class="headerlink" title="5 zset"></a>5 zset</h2><p>åœ¨setçš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€ä¸ªæƒé‡ç³»æ•°scoreï¼Œä½¿é›†åˆä¸­çš„å…ƒç´ å¯ä»¥æŒ‰ç…§scoreè¿›è¡Œæœ‰åºæ’åˆ—ï¼Œå¸¸ç”¨äºå®ç°æ’è¡Œæ¦œã€‚</p><h3 id="1-åº”ç”¨åœºæ™¯-3"><a href="#1-åº”ç”¨åœºæ™¯-3" class="headerlink" title="1. åº”ç”¨åœºæ™¯"></a>1. <strong>åº”ç”¨åœºæ™¯</strong></h3><h4 id="1-Zseté›†åˆæ“ä½œå®ç°æ’è¡Œæ¦œ"><a href="#1-Zseté›†åˆæ“ä½œå®ç°æ’è¡Œæ¦œ" class="headerlink" title="1. Zseté›†åˆæ“ä½œå®ç°æ’è¡Œæ¦œ"></a>1. Zseté›†åˆæ“ä½œå®ç°æ’è¡Œæ¦œ</h4><ul><li><p>ç‚¹å‡»æ–°é—»   </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ZINCRBY</span>  hotNews:<span class="hljs-number">20190819</span>  <span class="hljs-number">1</span>  å®ˆæŠ¤é¦™æ¸¯<br></code></pre></td></tr></table></figure></li><li><p>å±•ç¤ºå½“æ—¥æ’è¡Œå‰å </p> <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ZREVRANGE</span>  hotNews:<span class="hljs-number">20190819</span>  <span class="hljs-number">0</span>  <span class="hljs-number">10</span>  WITHSCORES <br></code></pre></td></tr></table></figure></li><li><p>ä¸ƒæ—¥æœç´¢æ¦œå•è®¡ç®—</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ZUNIONSTORE</span>  hotNews:<span class="hljs-number">20190813</span>-<span class="hljs-number">20190819</span>  <span class="hljs-number">7</span> <br><span class="hljs-attribute">hotNews</span>:<span class="hljs-number">20190813</span>  hotNews:<span class="hljs-number">20190814</span>... hotNews:<span class="hljs-number">20190819</span><br></code></pre></td></tr></table></figure><blockquote><p>[ZUNIONSTORE destination numkeys key <a href="https://www.runoob.com/redis/sorted-sets-zunionstore.html">key â€¦]</a><br>è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†çš„å¹¶é›†ï¼Œå¹¶å­˜å‚¨åœ¨æ–°çš„ key ä¸­</p></blockquote></li><li><p>å±•ç¤ºä¸ƒæ—¥æ’è¡Œå‰å</p><p><code>ZREVRANGE hotNews:20190813-20190819  0  10  WITHSCORES</code></p><blockquote><p>[ ZREVRANGE key start stop <a href="https://www.runoob.com/redis/sorted-sets-zrevrange.html">WITHSCORES]</a> è¿”å›æœ‰åºé›†ä¸­æŒ‡å®šåŒºé—´å†…çš„æˆå‘˜ï¼Œé€šè¿‡ç´¢å¼•ï¼Œåˆ†æ•°ä»é«˜åˆ°ä½</p></blockquote></li></ul><h1 id="2-redis-ä¸ºä»€ä¹ˆå¿«"><a href="#2-redis-ä¸ºä»€ä¹ˆå¿«" class="headerlink" title="2. redis ä¸ºä»€ä¹ˆå¿«"></a>2. redis ä¸ºä»€ä¹ˆå¿«</h1><p>Redis æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„é”®å€¼å­˜å‚¨æ•°æ®åº“ï¼Œä»¥å…¶å¿«é€Ÿçš„è¯»å†™é€Ÿåº¦è€Œè‘—ç§°ã€‚å…¶é€Ÿåº¦ä¸»è¦å¾—ç›Šäºä»¥ä¸‹å‡ ä¸ªå…³é”®å› ç´ ï¼š</p><h3 id="1-å†…å­˜å­˜å‚¨"><a href="#1-å†…å­˜å­˜å‚¨" class="headerlink" title="1. å†…å­˜å­˜å‚¨"></a>1. å†…å­˜å­˜å‚¨</h3><p>Redis å°†æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼ˆRAMï¼‰ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿæ•°æ®åº“é‚£æ ·å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚å†…å­˜çš„è¯»å†™é€Ÿåº¦è¿œè¿œå¿«äºç£ç›˜ï¼Œå› æ­¤ Redis çš„æ“ä½œé€Ÿåº¦éå¸¸å¿«ã€‚</p><h3 id="2-ç®€å•çš„æ•°æ®ç»“æ„"><a href="#2-ç®€å•çš„æ•°æ®ç»“æ„" class="headerlink" title="2. ç®€å•çš„æ•°æ®ç»“æ„"></a>2. ç®€å•çš„æ•°æ®ç»“æ„</h3><p>Redis æä¾›äº†ä¸€äº›ç®€å•ä¸”é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€å“ˆå¸Œã€åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆã€ä½å›¾ã€HyperLogLogã€åœ°ç†ç©ºé—´ç´¢å¼•å’Œæµã€‚æ¯ç§æ•°æ®ç»“æ„éƒ½ç»è¿‡ä¼˜åŒ–ï¼Œå¯ä»¥å¿«é€Ÿåœ°æ‰§è¡Œå¸¸è§æ“ä½œã€‚</p><h3 id="3-å•çº¿ç¨‹æ¶æ„"><a href="#3-å•çº¿ç¨‹æ¶æ„" class="headerlink" title="3. å•çº¿ç¨‹æ¶æ„"></a>3. å•çº¿ç¨‹æ¶æ„</h3><p>Redis ä½¿ç”¨å•çº¿ç¨‹æ¨¡å‹å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ã€‚è¿™ç§è®¾è®¡é¿å…äº†å¤šçº¿ç¨‹ç¯å¢ƒä¸­çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«æ€æ¡ä»¶ï¼Œä»è€Œå‡å°‘äº†å¤æ‚æ€§å’Œå¼€é”€ã€‚å°½ç®¡å•çº¿ç¨‹å¯èƒ½çœ‹èµ·æ¥æ˜¯ä¸ªç“¶é¢ˆï¼Œä½†ç”±äº Redis çš„æ ¸å¿ƒæ“ä½œéå¸¸å¿«ä¸”å¤§éƒ¨åˆ†æ˜¯åœ¨å†…å­˜ä¸­å®Œæˆçš„ï¼Œå› æ­¤å•çº¿ç¨‹æ¨¡å‹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ€§èƒ½éå¸¸é«˜ã€‚</p><h3 id="4-éé˜»å¡-I-x2F-O"><a href="#4-éé˜»å¡-I-x2F-O" class="headerlink" title="4. éé˜»å¡ I&#x2F;O"></a>4. éé˜»å¡ I&#x2F;O</h3><p>Redis ä½¿ç”¨äº†åŸºäºäº‹ä»¶é©±åŠ¨çš„ I&#x2F;O å¤šè·¯å¤ç”¨æœºåˆ¶ï¼ˆå¦‚ epoll å’Œ kqueueï¼‰ï¼Œä½¿å¾—å®ƒèƒ½å¤ŸåŒæ—¶å¤„ç†å¤§é‡å®¢æˆ·ç«¯è¿æ¥è€Œä¸ä¼šå‡ºç°é˜»å¡ã€‚è¿™ç§éé˜»å¡ I&#x2F;O æ¨¡å‹ä½¿å¾— Redis èƒ½å¤Ÿæœ‰æ•ˆåœ°å¤„ç†å¹¶å‘è¯·æ±‚ã€‚</p><h3 id="5-ç´§å‡‘çš„å†…å­˜ç®¡ç†"><a href="#5-ç´§å‡‘çš„å†…å­˜ç®¡ç†" class="headerlink" title="5. ç´§å‡‘çš„å†…å­˜ç®¡ç†"></a>5. ç´§å‡‘çš„å†…å­˜ç®¡ç†</h3><p>Redis å¯¹å†…å­˜ä½¿ç”¨è¿›è¡Œäº†é«˜åº¦ä¼˜åŒ–ã€‚ä¾‹å¦‚ï¼Œå®ƒä½¿ç”¨äº†ä¸€ç§é«˜æ•ˆçš„å†…å­˜åˆ†é…æœºåˆ¶æ¥æœ€å°åŒ–å†…å­˜ç¢ç‰‡ï¼Œå¹¶æä¾›äº†ä¸€äº›æ•°æ®å‹ç¼©é€‰é¡¹ï¼ˆå¦‚ ziplist å’Œ quicklistï¼‰æ¥èŠ‚çœå†…å­˜ç©ºé—´ã€‚</p><h3 id="6-é«˜æ•ˆçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a href="#6-é«˜æ•ˆçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–" class="headerlink" title="6. é«˜æ•ˆçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–"></a>6. é«˜æ•ˆçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h3><p>Redis çš„ RDB å’Œ AOF ä¸¤ç§æŒä¹…åŒ–æœºåˆ¶éƒ½ç»è¿‡ä¼˜åŒ–ï¼Œå¯ä»¥å¿«é€Ÿåœ°å°†æ•°æ®ä»å†…å­˜ä¿å­˜åˆ°ç£ç›˜å¹¶æ¢å¤ã€‚è¿™ç§é«˜æ•ˆçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹å‡å°‘äº†æŒä¹…åŒ–æ“ä½œå¯¹æ€§èƒ½çš„å½±å“ã€‚</p><h3 id="7-é«˜æ•ˆçš„ç½‘ç»œåè®®"><a href="#7-é«˜æ•ˆçš„ç½‘ç»œåè®®" class="headerlink" title="7. é«˜æ•ˆçš„ç½‘ç»œåè®®"></a>7. é«˜æ•ˆçš„ç½‘ç»œåè®®</h3><p>Redis ä½¿ç”¨äº†ä¸€ä¸ªç®€å•ã€é«˜æ•ˆçš„äºŒè¿›åˆ¶åè®® RESPï¼ˆRedis Serialization Protocolï¼‰ï¼Œæ¥è¿›è¡Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢ã€‚è¿™ä¸ªåè®®è®¾è®¡ç®€å•ï¼Œè§£æé€Ÿåº¦éå¸¸å¿«ï¼Œè¿›ä¸€æ­¥æé«˜äº† Redis çš„æ€§èƒ½ã€‚</p><h3 id="8-æœ¬åœ°åŒ–çš„æ•°æ®å¤„ç†"><a href="#8-æœ¬åœ°åŒ–çš„æ•°æ®å¤„ç†" class="headerlink" title="8. æœ¬åœ°åŒ–çš„æ•°æ®å¤„ç†"></a>8. æœ¬åœ°åŒ–çš„æ•°æ®å¤„ç†</h3><p>Redis æä¾›äº†ä¸°å¯Œçš„åŸå­æ“ä½œï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨ç«¯å®Œæˆå¤æ‚çš„æ•°æ®å¤„ç†ä»»åŠ¡ï¼Œå‡å°‘äº†ç½‘ç»œå¾€è¿”æ¬¡æ•°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨ Redis å†…éƒ¨æ‰§è¡Œå¤æ‚çš„é›†åˆæ“ä½œï¼Œè€Œä¸éœ€è¦å°†æ•°æ®ä¼ è¾“åˆ°å®¢æˆ·ç«¯è¿›è¡Œå¤„ç†ã€‚</p><h3 id="9-æ•°æ®åˆ†ç‰‡ï¼ˆShardingï¼‰"><a href="#9-æ•°æ®åˆ†ç‰‡ï¼ˆShardingï¼‰" class="headerlink" title="9. æ•°æ®åˆ†ç‰‡ï¼ˆShardingï¼‰"></a>9. æ•°æ®åˆ†ç‰‡ï¼ˆShardingï¼‰</h3><p>è™½ç„¶ Redis æœ¬èº«æ˜¯å•çº¿ç¨‹çš„ï¼Œä½†å®ƒæ”¯æŒæ•°æ®åˆ†ç‰‡ï¼ˆshardingï¼‰ï¼Œå³å°†æ•°æ®åˆ†å¸ƒåœ¨å¤šä¸ª Redis å®ä¾‹ä¸Šã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒRedis èƒ½å¤Ÿæ°´å¹³æ‰©å±•ï¼Œå¤„ç†æ›´å¤§çš„æ•°æ®é‡å’Œæ›´é«˜çš„å¹¶å‘è¯·æ±‚ã€‚</p><h1 id="3-Redis-å†…å­˜æ·˜æ±°ç­–ç•¥"><a href="#3-Redis-å†…å­˜æ·˜æ±°ç­–ç•¥" class="headerlink" title="3. Redis å†…å­˜æ·˜æ±°ç­–ç•¥"></a>3. Redis å†…å­˜æ·˜æ±°ç­–ç•¥</h1><p>åœ¨ Redis ä¸­ï¼Œæ·˜æ±°ç­–ç•¥ï¼ˆä¹Ÿç§°ä¸ºå†…å­˜å›æ”¶ç­–ç•¥ï¼‰å†³å®šäº†åœ¨ Redis å®ä¾‹è¾¾åˆ°å†…å­˜é™åˆ¶æ—¶ï¼Œåº”è¯¥å¦‚ä½•å¤„ç†æ–°å†™å…¥çš„æ•°æ®ã€‚ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li><p><strong>noeviction</strong>ï¼šå¯¹äºå†™è¯·æ±‚ä¸å†æä¾›æœåŠ¡ï¼Œä¼šç›´æ¥è¿”å›é”™è¯¯ã€‚è¿™æ˜¯<strong>é»˜è®¤ç­–ç•¥</strong>ã€‚</p></li><li><p><strong>allkeys-random</strong>ï¼šä»<strong>æ‰€æœ‰key</strong>ä¸­<strong>éšæœº</strong>ç§»é™¤æŸä¸ªé”®ã€‚</p></li><li><p><strong>volatile-random</strong>ï¼šä»<strong>è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®</strong>ä¸­<strong>éšæœº</strong>ç§»é™¤æŸä¸ªé”®ã€‚</p></li><li><p><strong>volatile-ttl</strong>ï¼šä»<strong>è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®</strong>ä¸­ç§»é™¤<strong>å‰©ä½™å¯¿å‘½æœ€çŸ­çš„é”®</strong>ï¼ˆå³å°†è¿‡æœŸçš„é”®ï¼‰ã€‚</p></li><li><p><strong>allkeys-lru</strong>ï¼šä½¿ç”¨LRUï¼ˆLeast Recently Usedï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç®—æ³•ï¼Œä»<strong>æ‰€æœ‰key</strong>ä¸­é€‰å–<strong>ä½¿ç”¨æœ€å°‘</strong>çš„è¿›è¡Œæ·˜æ±°ã€‚</p></li><li><p><strong>volatile-lru</strong>ï¼šä½¿ç”¨LRUï¼ˆLeast Recently Usedï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç®—æ³•ï¼Œä»è®¾<strong>ç½®äº†è¿‡æœŸæ—¶é—´çš„key</strong>ä¸­ç§»é™¤<strong>æœ€è¿‘æœ€å°‘ä½¿ç”¨</strong>çš„é”®ã€‚</p></li><li><p><strong>allkeys-lfu:</strong> ä½¿ç”¨LFUï¼ˆLeast Frequently Usedï¼Œæœ€ä¸ç»å¸¸ä½¿ç”¨ï¼‰ï¼Œä»<strong>æ‰€æœ‰keyä¸­</strong>é€‰æ‹©<strong>æŸæ®µæ—¶é—´ä¹‹å†…ä½¿ç”¨é¢‘æ¬¡æœ€å°‘</strong>çš„é”®å€¼å¯¹æ¸…é™¤</p></li><li><p><strong>volatile-lfu</strong>: ä½¿ç”¨LFUï¼ˆLeast Frequently Usedï¼Œæœ€ä¸ç»å¸¸ä½¿ç”¨ï¼‰ï¼Œä»<strong>è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„key</strong>ä¸­é€‰æ‹©<strong>æŸæ®µæ—¶é—´ä¹‹å†…ä½¿ç”¨é¢‘æ¬¡æœ€å°</strong>çš„é”®å€¼å¯¹æ¸…é™¤æ‰</p></li></ul><blockquote><p>Redis çš„æ·˜æ±°ç®—æ³•æœ‰å¤šç§:</p><ul><li>éšæœº</li><li>TTL: ä»è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ Keys ä¸­è·å–æœ€æ—©è¿‡æœŸçš„ ä¸€æ‰¹ Keys</li><li>LRU (Least Recently Used) ç®—æ³•: æ‰€æœ‰çš„ Keys éƒ½æ ¹æ®æœ€åè¢«è®¿é—®çš„æ—¶é—´æ¥è¿›è¡Œæ’åºçš„ï¼Œæ‰€ä»¥åœ¨æ·˜æ±°æ—¶åªéœ€è¦æŒ‰ç…§æ‰€æœ‰ Keys çš„æœ€åè¢«è®¿é—®æ—¶é—´ï¼Œç”±å°åˆ°å¤§æ¥è¿›è¡Œå³å¯</li><li>LFUï¼ˆLeast Frequently Usedï¼‰ç®—æ³•: ç…§è¢«è®¿é—®æ¬¡æ•°é™åºæ’åˆ—ï¼Œè®¿é—®æ¬¡æ•°ç›¸åŒçš„æŒ‰æœ€è¿‘è®¿é—®æ—¶é—´é™åºæ’åˆ—ï¼Œé“¾è¡¨æ»¡çš„æ—¶å€™ä»é“¾è¡¨å°¾éƒ¨ç§»å‡ºæ•°æ®ã€‚</li></ul></blockquote><h1 id="4-Redis-å¸¸è§ä½¿ç”¨åœºæ™¯"><a href="#4-Redis-å¸¸è§ä½¿ç”¨åœºæ™¯" class="headerlink" title="4. Redis å¸¸è§ä½¿ç”¨åœºæ™¯"></a>4. Redis å¸¸è§ä½¿ç”¨åœºæ™¯</h1><ol><li>ç¼“å­˜: DBç¼“å­˜ï¼Œå‡è½»DBæœåŠ¡å™¨å‹åŠ›, æé«˜ç³»ç»Ÿå“åº”ã€‚éœ€ä¿è¯ç¼“å­˜å†…å®¹ä¸æ•°æ®åº“çš„ä¸€è‡´æ€§</li><li>åˆ†å¸ƒå¼é”ï¼šåˆ©ç”¨Redisçš„<code>SETNX key value</code>è¿™ä¸ªå‘½ä»¤è·å–é”ï¼Œå¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚éœ€å¤„ç†ï¼ša.å¢åŠ IDçš„å¤æ‚æ€§ï¼Œæ»¡è¶³å®‰å…¨æ€§ b.åˆç†è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´, ä¸è¦å¤ªé•¿æˆ–å¤ªçŸ­ï¼Œè¿˜éœ€è€ƒè™‘é”ç»­å‘½ã€‚æ¨èä½¿ç”¨ç¬¬ä¸‰æ–¹åº“<code>redisson</code></li><li>åˆ†å¸ƒå¼IDï¼šåˆ©ç”¨Redisçš„åŸå­æ€§é€’å¢æ“ä½œï¼Œç”Ÿæˆåˆ†å¸ƒå¼å”¯ä¸€IDã€‚ä¼˜ç‚¹é€Ÿåº¦å¿«ï¼Œç¼ºç‚¹éœ€ä¿è¯redisçš„é«˜å¯ç”¨å’ŒæŒä¹…åŒ–</li><li>è®¡æ•°å™¨ï¼šåˆ©ç”¨incræ–¹æ³•ï¼Œå®ç°æ–‡ç« çš„é˜…è¯»é‡ï¼Œå¾®åšç‚¹èµæ•°ï¼ŒIPé™æµç­‰</li><li>æ’è¡Œæ¦œï¼šåˆ©ç”¨zset, è®°å½•æ¡ç›®çš„åŒæ—¶ï¼Œè®°å½•æˆç»©</li><li>å®ç°æ¶ˆæ¯é˜Ÿåˆ—ï¼šåˆ©ç”¨list&#x2F;set</li></ol>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>redis æ ¸å¿ƒæ•°æ®ç»“æ„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬ä¸€ä¸ªSpringBooté¡¹ç›®</title>
    <link href="/%E7%AC%AC%E4%B8%80%E4%B8%AAspringboot%E9%A1%B9%E7%9B%AE/"/>
    <url>/%E7%AC%AC%E4%B8%80%E4%B8%AAspringboot%E9%A1%B9%E7%9B%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h1><ul><li>è¿›å…¥å®˜ç½‘ <a href="https://start.spring.io/">Spring Initializr</a> åˆå§‹åŒ–é¡¹ç›®</li><li>ç¼–å†™æ§åˆ¶HelloController</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">helloController</span> </span>&#123;<br><br>  <span class="hljs-meta">@RequestMapping(&quot;/hello&quot;)</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">hello</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello World!&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ç¼–å†™æµ‹è¯•ç”¨ä¾‹"><a href="#ç¼–å†™æµ‹è¯•ç”¨ä¾‹" class="headerlink" title="ç¼–å†™æµ‹è¯•ç”¨ä¾‹"></a>ç¼–å†™æµ‹è¯•ç”¨ä¾‹</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.pyr.spring.cloud.weather.controller;<br><br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.springframework.http.MediaType;<br><span class="hljs-keyword">import</span> org.springframework.test.web.servlet.MockMvc;<br><span class="hljs-keyword">import</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders;<br><br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.hamcrest.Matchers.equalTo;<br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;<br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;<br><br><span class="hljs-meta">@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)</span><br><span class="hljs-meta">@AutoConfigureMockMvc</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">helloControllerTest</span> </span>&#123;<br><br>  <span class="hljs-meta">@Autowired</span><br>  <span class="hljs-keyword">private</span> MockMvc mockMvc;<br><br>  <span class="hljs-meta">@Test</span><br>  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">hello</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>    mockMvc.perform(MockMvcRequestBuilders.get(<span class="hljs-string">&quot;/hello&quot;</span>).accept(MediaType.APPLICATION_JSON))<br>      .andExpect(status().isOk())<br>      .andExpect(content().string(equalTo(<span class="hljs-string">&quot;hello World!&quot;</span>)));<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="å¯åŠ¨é¡¹ç›®"><a href="#å¯åŠ¨é¡¹ç›®" class="headerlink" title="å¯åŠ¨é¡¹ç›®"></a>å¯åŠ¨é¡¹ç›®</h1><ul><li>idea é‡Œé¢å³å‡»é¡¹ç›®</li><li>build&#x2F;libsä¸‹è¿è¡Œ <code>Java -jar xxx</code></li><li>é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œï¼š<code>gradle bootRun</code></li></ul><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gxr8m9n86ij30sq08ujrx.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>Springboot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springboot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mysqlé”</title>
    <link href="/mysql%E9%94%81%E4%B8%8E%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/"/>
    <url>/mysql%E9%94%81%E4%B8%8E%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/</url>
    
    <content type="html"><![CDATA[<h1 id="é”æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#é”æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="é”æ˜¯ä»€ä¹ˆï¼Ÿ"></a>é”æ˜¯ä»€ä¹ˆï¼Ÿ</h1><ul><li>é”æ˜¯è®¡ç®—æœºåè°ƒå¤šä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹å¹¶å‘è®¿é—®åŒä¸€èµ„æºçš„æœºåˆ¶ã€‚</li><li>åœ¨æ•°æ®åº“ä¸­ï¼Œæ•°æ®æ˜¯ä¸€ç§å…±äº«çš„èµ„æºï¼Œå› æ­¤ä¹Ÿéœ€è¦ä¿è¯æ•°æ®å¹¶å‘è®¿é—®çš„ä¸€è‡´æ€§å’Œæœ‰æ•ˆæ€§ã€‚</li></ul><h1 id="é”çš„åˆ†ç±»"><a href="#é”çš„åˆ†ç±»" class="headerlink" title="é”çš„åˆ†ç±»"></a>é”çš„åˆ†ç±»</h1><ul><li><p>ä»æ€§èƒ½ä¸Šæ¥åˆ†ä¸ºï¼š<code>ä¹è§‚é”</code>å’Œ<code>æ‚²è§‚é”</code></p><ul><li><p>ä¹è§‚é”ï¼šæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æäº¤æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ã€‚</p><blockquote><p>ä¹è§‚é”ä¸€èˆ¬é€šè¿‡ç‰ˆæœ¬æ¯”å¯¹çš„æ–¹å¼æ¥å®ç°çš„ï¼š</p><ul><li><p>å½“è¯»å–æ•°æ®æ—¶ï¼Œå°†versionå­—æ®µçš„å€¼ä¸€åŒè¯»å‡ºï¼Œæ•°æ®æ¯æ›´æ–°ä¸€æ¬¡ï¼Œå¯¹æ­¤versionå€¼åŠ 1ã€‚</p></li><li><p>å½“æˆ‘ä»¬æäº¤æ›´æ–°çš„æ—¶å€™ï¼Œåˆ¤æ–­æ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬ä¿¡æ¯ä¸æˆ‘ä»¬ç¬¬ä¸€æ¬¡å–å‡ºçš„versionå€¼è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæ•°æ®åº“è¡¨å½“å‰ç‰ˆæœ¬å·ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„versionå€¼ç›¸ç­‰ï¼Œåˆ™äºˆä»¥æ›´æ–°ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®ã€‚é‚£ä¹ˆæ›´æ–°æ“ä½œå°±ä¼šå¤±è´¥ã€‚</p></li></ul></blockquote></li><li><p>æ‚²è§‚é”ï¼šæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šblockç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚</p></li></ul></li><li><p>ä»æ“ä½œç±»å‹æ¥åˆ†ä¸ºï¼š<code>è¯»é”</code>å’Œ<code>å†™é”</code></p><ul><li>è¯»é”ï¼šä¹Ÿç§°ä¸ºå…±äº«é”ï¼Œå¤šä¸ªè¯»æ“ä½œå¯ä»¥åŒæ—¶è¿›è¡Œï¼Œä¸”äº’ä¸å½±å“ã€‚</li><li>å†™é”ï¼šä¹Ÿç§°ä¸ºæ‹ä»–é”ï¼Œä»–å¯ä»¥é˜»æ–­å…¶ä»–è¯»æ“ä½œæˆ–è€…å†™æ“ä½œã€‚</li></ul></li><li><p>ä»å¯æ“ä½œçš„ç²’åº¦æ¥åˆ†ä¸ºï¼š<code>è¡¨é”</code>å’Œ<code>è¡Œé”</code></p><ul><li><p>è¡¨é”ï¼šæ¯æ¬¡æ“ä½œé”ä½æ•´å¼ è¡¨ã€‚å¼€é”€å°ï¼ŒåŠ é”å¿«ï¼›ä¸ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦å¤§ï¼Œå‘ç”Ÿé”å†² </p><p>çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ï¼›</p></li><li><p>è¡Œé”ï¼šæ¯æ¬¡æ“ä½œé”ä½ä¸€è¡Œæ•°æ®ã€‚å¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦æœ€å°ï¼Œå‘ç”Ÿé” </p><p>å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œå¹¶å‘åº¦æœ€é«˜ã€‚</p></li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysqlé”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸è§sqlä¼˜åŒ–(äºŒ)</title>
    <link href="/%E5%B8%B8%E8%A7%81sql%E4%BC%98%E5%8C%96-%E4%BA%8C/"/>
    <url>/%E5%B8%B8%E8%A7%81sql%E4%BC%98%E5%8C%96-%E4%BA%8C/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€-åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–"><a href="#ä¸€-åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="ä¸€  åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–"></a>ä¸€  <strong>åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–</strong></h2><h3 id="1-æ ¹æ®è‡ªå¢ä¸”è¿ç»­çš„ä¸»é”®æ’åºçš„åˆ†é¡µæŸ¥è¯¢"><a href="#1-æ ¹æ®è‡ªå¢ä¸”è¿ç»­çš„ä¸»é”®æ’åºçš„åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="1. æ ¹æ®è‡ªå¢ä¸”è¿ç»­çš„ä¸»é”®æ’åºçš„åˆ†é¡µæŸ¥è¯¢"></a>1. æ ¹æ®è‡ªå¢ä¸”è¿ç»­çš„ä¸»é”®æ’åºçš„åˆ†é¡µæŸ¥è¯¢</h3><blockquote><p>åŸåˆ™ï¼šæŒ‰ç…§ä¸»é”®å»æŸ¥è¯¢</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employees limit <span class="hljs-number">90000</span>,<span class="hljs-number">5</span>;<br></code></pre></td></tr></table></figure><p>è¡¨ç¤ºä»è¡¨ employees ä¸­å–å‡ºä» 10001 è¡Œå¼€å§‹çš„ 10 è¡Œè®°å½•ã€‚çœ‹ä¼¼åªæŸ¥è¯¢äº† 10 æ¡è®°å½•ï¼Œå®é™…è¿™æ¡ SQL æ˜¯å…ˆè¯»å– 10010 æ¡è®°å½•ï¼Œç„¶åæŠ›å¼ƒå‰ 10000 æ¡è®°å½•ï¼Œç„¶åè¯»åˆ°åé¢ 10 æ¡æƒ³è¦çš„æ•°æ®ã€‚å› æ­¤è¦æŸ¥è¯¢ä¸€å¼ å¤§è¡¨æ¯”è¾ƒé åçš„æ•°æ®ï¼Œæ‰§è¡Œæ•ˆç‡æ˜¯éå¸¸ä½çš„ã€‚å› ä¸ºä¸»é”®æ˜¯è‡ªå¢å¹¶ä¸”è¿ç»­çš„ï¼Œæ‰€ä»¥å¯ä»¥æ”¹å†™æˆæŒ‰ç…§ä¸»é”®å»æŸ¥è¯¢ä»ç¬¬ 90001å¼€å§‹çš„äº”è¡Œæ•°æ®ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employees <span class="hljs-keyword">where</span> id <span class="hljs-operator">&gt;</span> <span class="hljs-number">90000</span> limit <span class="hljs-number">5</span>;<br></code></pre></td></tr></table></figure><p>æ˜¾ç„¶æ”¹å†™åçš„ SQL èµ°äº†ç´¢å¼•ï¼Œè€Œä¸”æ‰«æçš„è¡Œæ•°å¤§å¤§å‡å°‘ï¼Œæ‰§è¡Œæ•ˆç‡æ›´é«˜ã€‚ </p><p>ä½†æ˜¯ï¼Œè¿™æ¡æ”¹å†™çš„SQL åœ¨å¾ˆå¤šåœºæ™¯å¹¶ä¸å®ç”¨ï¼Œå› ä¸ºè¡¨ä¸­å¯èƒ½æŸäº›è®°å½•è¢«åˆ åï¼Œä¸»é”®ç©ºç¼ºï¼Œå¯¼è‡´ç»“æœä¸ä¸€è‡´ï¼Œå¦‚ï¼šå…ˆåˆ é™¤ä¸€æ¡å‰é¢çš„è®°å½•ï¼Œç„¶åå†æµ‹è¯•åŸ SQL å’Œä¼˜åŒ–åçš„ SQL</p><h3 id="2-æ ¹æ®éä¸»é”®å­—æ®µæ’åºçš„åˆ†é¡µæŸ¥è¯¢"><a href="#2-æ ¹æ®éä¸»é”®å­—æ®µæ’åºçš„åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="2.æ ¹æ®éä¸»é”®å­—æ®µæ’åºçš„åˆ†é¡µæŸ¥è¯¢"></a>2.æ ¹æ®éä¸»é”®å­—æ®µæ’åºçš„åˆ†é¡µæŸ¥è¯¢</h3><blockquote><p>åŸåˆ™ï¼š è®©æ’åºå’Œåˆ†é¡µæ“ä½œå…ˆæŸ¥å‡ºä¸»é”®ï¼Œç„¶åæ ¹æ®ä¸»é”®æŸ¥åˆ°å¯¹åº”çš„è®°å½•ï¼Œè¿™æ ·æ’åºæ—¶è¿”å›çš„å­—æ®µä¼šå°‘å¾ˆå¤šï¼Œä»è€Œä¼šæ‰§è¡Œç´¢å¼•æ’åºã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employees <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> name limit <span class="hljs-number">90000</span>,<span class="hljs-number">5</span>;<br></code></pre></td></tr></table></figure><p>è¡¨ç¤ºæ ¹æ®éä¸»é”®å­—æ®µnameæ’åºçš„åˆ†é¡µæŸ¥è¯¢ï¼Œå‘ç°å¹¶æ²¡æœ‰ä½¿ç”¨ name å­—æ®µçš„ç´¢å¼•ï¼ˆkey å­—æ®µå¯¹åº”çš„å€¼ä¸º nullï¼‰ï¼Œå…·ä½“åŸå› ä¸ºï¼šæ‰«ææ•´ä¸ªç´¢å¼•å¹¶æŸ¥æ‰¾åˆ°æ²¡ç´¢å¼•çš„è¡Œ(å¯èƒ½è¦éå†å¤šä¸ªç´¢å¼•æ ‘)çš„æˆæœ¬æ¯”æ‰«æå…¨è¡¨çš„æˆæœ¬æ›´é«˜ï¼Œæ‰€ä»¥ä¼˜åŒ–å™¨æ”¾å¼ƒä½¿ç”¨ç´¢å¼•ã€‚</p><p>æ”¹å†™åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employees e <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> (<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> employees <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> name limit <span class="hljs-number">90000</span>,<span class="hljs-number">5</span>) ed <span class="hljs-keyword">on</span> e.id <span class="hljs-operator">=</span> ed.id;<br></code></pre></td></tr></table></figure><h2 id="äºŒ-Joinå…³è”æŸ¥è¯¢ä¼˜åŒ–"><a href="#äºŒ-Joinå…³è”æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="äºŒ   Joinå…³è”æŸ¥è¯¢ä¼˜åŒ–"></a>äºŒ   <strong>Joinå…³è”æŸ¥è¯¢ä¼˜åŒ–</strong></h2><h3 id="mysqlçš„è¡¨å…³è”å¸¸è§æœ‰ä¸¤ç§ç®—æ³•"><a href="#mysqlçš„è¡¨å…³è”å¸¸è§æœ‰ä¸¤ç§ç®—æ³•" class="headerlink" title="mysqlçš„è¡¨å…³è”å¸¸è§æœ‰ä¸¤ç§ç®—æ³•"></a>mysqlçš„è¡¨å…³è”å¸¸è§æœ‰ä¸¤ç§ç®—æ³•</h3><h4 id="1-åµŒå¥—å¾ªç¯è¿æ¥ï¼ˆNested-Loop-Joinï¼‰-ç®—æ³•"><a href="#1-åµŒå¥—å¾ªç¯è¿æ¥ï¼ˆNested-Loop-Joinï¼‰-ç®—æ³•" class="headerlink" title="1.åµŒå¥—å¾ªç¯è¿æ¥ï¼ˆNested-Loop Joinï¼‰ ç®—æ³•"></a>1.åµŒå¥—å¾ªç¯è¿æ¥ï¼ˆNested-Loop Joinï¼‰ ç®—æ³•</h4><ul><li><p>ä¸€æ¬¡ä¸€è¡Œå¾ªç¯åœ°ä»ç¬¬ä¸€å¼ è¡¨ï¼ˆç§°ä¸º<strong>é©±åŠ¨è¡¨</strong>ï¼‰ä¸­è¯»å–è¡Œï¼Œåœ¨è¿™è¡Œæ•°æ®ä¸­å–åˆ°å…³è”å­—æ®µï¼Œæ ¹æ®å…³è”å­—æ®µåœ¨å¦ä¸€å¼ è¡¨ï¼ˆ<strong>è¢«é©±åŠ¨</strong>è¡¨ï¼‰é‡Œå–å‡ºæ»¡è¶³æ¡ä»¶çš„è¡Œï¼Œç„¶åå–å‡ºä¸¤å¼ è¡¨çš„ç»“æœåˆé›†ã€‚</p></li><li><p>å¤§è‡´æµç¨‹æ˜¯ï¼š</p><ol><li><p>ç¬¬ä¸€æ­¥ï¼šä»è¡¨ t2 ä¸­è¯»å–ä¸€è¡Œæ•°æ®ï¼Œæ ¹æ®å…³è”å­—æ®µ åˆ°è¡¨ t1 ä¸­æŸ¥æ‰¾</p></li><li><p>ç¬¬äºŒæ­¥ï¼šå–å‡ºè¡¨ t1 ä¸­æ»¡è¶³æ¡ä»¶çš„è¡Œï¼Œè·Ÿ t2 ä¸­è·å–åˆ°çš„ç»“æœåˆå¹¶ï¼Œä½œä¸ºç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼› </p></li><li><p>ç¬¬ä¸‰éƒ¨ï¼šé‡å¤ç¬¬äºŒæ­¥</p></li></ol><blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> EXPLAIN <span class="hljs-keyword">select</span><span class="hljs-operator">*</span><span class="hljs-keyword">from</span> t1 <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> t2 <span class="hljs-keyword">on</span> t1.a<span class="hljs-operator">=</span> t2.a;<br></code></pre></td></tr></table></figure><p>å‡è®¾t2æœ‰100æ¡æ•°æ®ï¼Œt1æœ‰10000æ¡ã€‚æ•´ä¸ªè¿‡ç¨‹ä¼šè¯»å– t2 è¡¨çš„æ‰€æœ‰æ•°æ®(æ‰«æ100è¡Œ)ï¼Œç„¶åéå†è¿™æ¯è¡Œæ•°æ®ä¸­å­—æ®µ a çš„å€¼ï¼Œæ ¹æ® t2 è¡¨ä¸­ a çš„å€¼ç´¢å¼•æ‰«æ t1 è¡¨ ä¸­çš„å¯¹åº”è¡Œ(<strong>æ‰«æ100æ¬¡ t1 è¡¨çš„ç´¢å¼•ï¼Œ1æ¬¡æ‰«æå¯ä»¥è®¤ä¸ºæœ€ç»ˆåªæ‰«æ t1 è¡¨ä¸€è¡Œå®Œæ•´æ•°æ®ï¼ˆæ‰«æç´¢å¼•å¾ˆå¿«ï¼Œå¯ä»¥å¿½ç•¥ï¼‰ï¼Œä¹Ÿå°±æ˜¯æ€»å…± t1 è¡¨ä¹Ÿæ‰«æäº†100</strong> è¡Œ**)ã€‚å› æ­¤æ•´ä¸ªè¿‡ç¨‹æ‰«æäº† **200 è¡Œã€‚</p></blockquote></li><li><p>ä¼˜åŒ–å™¨ä¸€èˆ¬ä¼šä¼˜å…ˆé€‰æ‹©å°è¡¨åšé©±åŠ¨è¡¨ã€‚<strong>æ‰€ä»¥ä½¿ç”¨ inner join æ—¶ï¼Œæ’åœ¨å‰é¢çš„è¡¨å¹¶ä¸ä¸€å®šå°±æ˜¯é©±åŠ¨è¡¨ã€‚</strong></p></li></ul><h4 id="2-åŸºäºå—çš„åµŒå¥—å¾ªç¯è¿æ¥ï¼ˆBlock-Nested-Loop-Joinï¼‰-ç®—æ³•"><a href="#2-åŸºäºå—çš„åµŒå¥—å¾ªç¯è¿æ¥ï¼ˆBlock-Nested-Loop-Joinï¼‰-ç®—æ³•" class="headerlink" title="2.åŸºäºå—çš„åµŒå¥—å¾ªç¯è¿æ¥ï¼ˆBlock Nested-Loop Joinï¼‰ ç®—æ³•"></a>2.åŸºäºå—çš„åµŒå¥—å¾ªç¯è¿æ¥ï¼ˆBlock Nested-Loop Joinï¼‰ ç®—æ³•</h4><ul><li><p>æŠŠ<strong>é©±åŠ¨è¡¨</strong>çš„æ•°æ®è¯»å…¥åˆ° join_buffer ä¸­ï¼Œç„¶åæ‰«æ<strong>è¢«é©±åŠ¨è¡¨</strong>ï¼ŒæŠŠ<strong>è¢«é©±åŠ¨è¡¨</strong>æ¯ä¸€è¡Œå–å‡ºæ¥è·Ÿ join_buffer ä¸­çš„æ•°æ®åšå¯¹æ¯”ã€‚ </p></li><li><p>å¤§è‡´æµç¨‹æ˜¯ï¼š</p><ol><li><p>ç¬¬ä¸€æ­¥ï¼šæŠŠt2ä¸­çš„æ‰€æœ‰æ•°æ®æ”¾åœ¨join_bufferä¸­</p></li><li><p>ç¬¬äºŒæ­¥ï¼šä¾æ¬¡å–å‡ºt1ä¸­çš„æ¯ä¸€è¡Œï¼Œè·Ÿjoin_bufferä¸­çš„æ•°æ®åšå¯¹æ¯”</p></li><li><p>ç¬¬ä¸‰éƒ¨ï¼šè¿”å›æ»¡è¶³æ¡ä»¶çš„æ•°æ®</p></li></ol><blockquote><p>æ•´ä¸ªè¿‡ç¨‹å¯¹è¡¨ t1 å’Œ t2 éƒ½åšäº†ä¸€æ¬¡å…¨è¡¨æ‰«æï¼Œå› æ­¤æ‰«æçš„æ€»è¡Œæ•°ä¸º10000(è¡¨ t1 çš„æ•°æ®æ€»é‡) + 100(è¡¨ t2 çš„æ•°æ®æ€»é‡) &#x3D; <strong>10100</strong>ã€‚å¹¶ä¸” join_buffer é‡Œçš„æ•°æ®æ˜¯æ— åºçš„ï¼Œå› æ­¤å¯¹è¡¨ t1 ä¸­çš„æ¯ä¸€è¡Œï¼Œéƒ½è¦åš 100 æ¬¡åˆ¤æ–­ï¼Œæ‰€ä»¥å†…å­˜ä¸­çš„åˆ¤æ–­æ¬¡æ•°æ˜¯ 100 * 10000&#x3D; <strong>100 ä¸‡æ¬¡</strong>ã€‚</p></blockquote></li></ul><h3 id="å¯¹äºå…³è”sqlçš„ä¼˜åŒ–"><a href="#å¯¹äºå…³è”sqlçš„ä¼˜åŒ–" class="headerlink" title="å¯¹äºå…³è”sqlçš„ä¼˜åŒ–"></a>å¯¹äºå…³è”sqlçš„ä¼˜åŒ–</h3><ul><li><p>å…³è”å­—æ®µåŠ ç´¢å¼•ï¼Œè®©mysqlåšjoinæ“ä½œæ—¶ï¼Œå°½é‡é€‰æ‹©åµŒå¥—å¾ªç¯ç®—æ³•ã€‚</p><blockquote><p>ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥å¯¹æ¯”çœ‹å‡ºï¼ŒåµŒå¥—å¾ªç¯ç®—æ³•å› ä¸ºæœ‰ç´¢å¼•ï¼Œæ¯æ¬¡è¿›è¡ŒæŸ¥æ‰¾æ—¶ï¼Œåªéœ€æ ¹æ®ç´¢å¼•ï¼ŒæŸ¥æ‰¾ä¸€æ¡åŒ¹é…çš„æ•°æ®ï¼Œå³æ‰«æä¸€æ¬¡ã€‚ä½†åŸºäºå—çš„åµŒå¥—å¾ªç¯è¿æ¥å´å› ä¸ºæ²¡æœ‰ç´¢å¼•ï¼Œæ¯æ¬¡éƒ½éœ€è¦è¿›è¡Œä¸€æ¬¡å…¨è¡¨æ‰«æã€‚</p></blockquote></li><li><p>å°è¡¨é©±åŠ¨å¤§è¡¨ã€‚å†™å¤šè¡¨è¿æ¥sqlæ—¶å¦‚æœ<strong>æ˜ç¡®çŸ¥é“</strong>å“ªå¼ è¡¨æ˜¯å°è¡¨å¯ä»¥ç”¨straight_joinå†™æ³•å›ºå®šè¿æ¥é©±åŠ¨æ–¹å¼ï¼Œçœå»mysqlä¼˜åŒ–å™¨è‡ªå·±åˆ¤æ–­çš„æ—¶é—´ã€‚</p><blockquote><p>straight_joinåŒinner joinç±»ä¼¼ï¼Œä½†æ˜¯å¯ä»¥æŒ‡å®šå·¦è¾¹çš„è¡¨æ¥é©±åŠ¨å³è¾¹çš„è¡¨ã€‚ä½†æ˜¯ä½¿ç”¨å®ƒä¸€å®šè¦æ…é‡ï¼Œå› ä¸ºå¤§éƒ¨åˆ†æƒ…å†µä¼˜åŒ–å™¨æ˜¯æ¯”äººèªæ˜çš„ï¼Œäººä¸ºæŒ‡å®šçš„é¡ºåºä¸ä¸€å®šæ¯”æœç´¢å¼•æ“é è°±ã€‚</p></blockquote></li></ul><h2 id="ä¸‰-inå’Œexsitsä¼˜åŒ–"><a href="#ä¸‰-inå’Œexsitsä¼˜åŒ–" class="headerlink" title="ä¸‰  inå’Œexsitsä¼˜åŒ–"></a>ä¸‰  <strong>inå’Œexsitsä¼˜åŒ–</strong></h2><blockquote><p> åŸåˆ™ï¼š<strong>å°è¡¨é©±åŠ¨å¤§è¡¨</strong>ï¼Œå³å°çš„æ•°æ®é›†é©±åŠ¨å¤§çš„æ•°æ®é›† </p></blockquote><ul><li><p>å½“Bè¡¨çš„æ•°æ®é›† &lt; Aè¡¨çš„æ•°æ®é›†æ—¶ï¼Œinä¼˜äºexists</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> A <span class="hljs-keyword">where</span> id <span class="hljs-keyword">in</span> (<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> B) <br>#ç­‰ä»·äºï¼š  <br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> B)&#123; <br>    <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> A <span class="hljs-keyword">where</span> A.id <span class="hljs-operator">=</span> B.id<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å½“Bè¡¨çš„æ•°æ®é›† &gt; Bè¡¨çš„æ•°æ®é›†æ—¶ï¼Œexistsä¼˜äºin</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> A <span class="hljs-keyword">where</span> <span class="hljs-keyword">exists</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> B <span class="hljs-keyword">where</span> b.id <span class="hljs-operator">=</span> A.id) <br>#ç­‰ä»·äºï¼š  <br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> A)&#123;<br>     <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> B <span class="hljs-keyword">where</span> B.id <span class="hljs-operator">=</span> A.id<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>EXISTS (subquery)åªè¿”å›TRUEæˆ–FALSE,å› æ­¤å­æŸ¥è¯¢ä¸­çš„SELECT * ä¹Ÿå¯ä»¥ç”¨SELECT 1æ›¿æ¢,å®˜æ–¹è¯´æ³•æ˜¯å®é™…æ‰§è¡Œæ—¶ä¼šå¿½ç•¥SELECTæ¸…å•,å› æ­¤æ²¡æœ‰åŒºåˆ«</p></blockquote></li></ul><h2 id="å››-count-æŸ¥è¯¢ä¼˜åŒ–"><a href="#å››-count-æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="å››  count(*)æŸ¥è¯¢ä¼˜åŒ–"></a>å››  <strong>count(*)æŸ¥è¯¢ä¼˜åŒ–</strong></h2><h3 id="æŸ¥è¯¢mysqlè‡ªå·±ç»´æŠ¤çš„æ€»è¡Œæ•°"><a href="#æŸ¥è¯¢mysqlè‡ªå·±ç»´æŠ¤çš„æ€»è¡Œæ•°" class="headerlink" title="æŸ¥è¯¢mysqlè‡ªå·±ç»´æŠ¤çš„æ€»è¡Œæ•°"></a>æŸ¥è¯¢mysqlè‡ªå·±ç»´æŠ¤çš„æ€»è¡Œæ•°</h3><ul><li>å¯¹äº<strong>myisamå­˜å‚¨å¼•æ“</strong>çš„è¡¨åšä¸å¸¦whereæ¡ä»¶çš„countæŸ¥è¯¢æ€§èƒ½æ˜¯å¾ˆé«˜çš„ï¼Œå› ä¸ºmyisamå­˜å‚¨å¼•æ“çš„è¡¨çš„æ€»è¡Œæ•°ä¼šè¢« mysqlå­˜å‚¨åœ¨ç£ç›˜ä¸ŠæŸ¥è¯¢ä¸éœ€è¦è®¡ç®— ã€‚</li><li>å¯¹äº<strong>innodbå­˜å‚¨å¼•æ“</strong>çš„è¡¨mysqlä¸ä¼šå­˜å‚¨è¡¨çš„æ€»è®°å½•è¡Œæ•°ï¼ŒæŸ¥è¯¢countéœ€è¦å®æ—¶è®¡ç®—</li></ul><h3 id="show-table-status"><a href="#show-table-status" class="headerlink" title="show table status"></a><strong>show table status</strong></h3><ul><li><p>å¦‚æœåªéœ€è¦çŸ¥é“è¡¨æ€»è¡Œæ•°çš„ä¼°è®¡å€¼å¯ä»¥ç”¨å¦‚ä¸‹sqlæŸ¥è¯¢ï¼Œæ€§èƒ½å¾ˆé«˜ .</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gxdq94vfa1j31rk088q4o.jpg"></p></li></ul><h3 id="count-ä¼˜åŒ–æ–¹å¼"><a href="#count-ä¼˜åŒ–æ–¹å¼" class="headerlink" title="count(*)ä¼˜åŒ–æ–¹å¼"></a>count(*)ä¼˜åŒ–æ–¹å¼</h3><ul><li><p><strong>å°†æ€»æ•°ç»´æŠ¤åˆ°Redisé‡Œ</strong> </p><p>æ’å…¥æˆ–åˆ é™¤è¡¨æ•°æ®è¡Œçš„æ—¶å€™åŒæ—¶ç»´æŠ¤redisé‡Œçš„è¡¨æ€»è¡Œæ•°keyçš„è®¡æ•°å€¼(ç”¨incræˆ–decrå‘½ä»¤)ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å¯èƒ½ä¸å‡†ï¼ˆå¦‚mysqlæ‰§è¡ŒæˆåŠŸäº†ï¼Œredisæ²¡æœ‰æ›´æ–°æˆåŠŸï¼‰ï¼Œå¾ˆéš¾ä¿è¯è¡¨æ“ä½œå’Œredisæ“ä½œçš„äº‹åŠ¡ä¸€è‡´æ€§ ï¼Œå¯èƒ½å¾—è€ƒè™‘åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œé€‚ç”¨äºå‡†ç¡®åº¦è¦æ±‚ä¸é«˜çš„åœºæ™¯ã€‚</p></li><li><p><strong>å¢åŠ è®¡æ•°è¡¨</strong></p><p>æ’å…¥æˆ–åˆ é™¤è¡¨æ•°æ®è¡Œçš„æ—¶å€™åŒæ—¶ç»´æŠ¤è®¡æ•°è¡¨ï¼ˆå¦‚æ–°å»ºä¸€ä¸ªè¡¨ï¼Œè¯¥è¡¨å¢åŠ ä¸€ä¸ªå­—æ®µuser_countï¼Œinsert user çš„åŒæ—¶æ›´æ–°è¯¥å­—æ®µï¼‰ï¼Œè®©ä»–ä»¬åœ¨åŒä¸€ä¸ªäº‹åŠ¡é‡Œæ“ä½œï¼Œè®©mysqlçš„äº‹åŠ¡æ¥ä¿è¯ä¸€è‡´æ€§ã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysqlç´¢å¼•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sqlä¼˜åŒ–æ–¹å¼</title>
    <link href="/%E5%B8%B8%E8%A7%81sql%E4%BC%98%E5%8C%96/"/>
    <url>/%E5%B8%B8%E8%A7%81sql%E4%BC%98%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="1-sqlä¼˜åŒ–æ–¹å¼"><a href="#1-sqlä¼˜åŒ–æ–¹å¼" class="headerlink" title="1. sqlä¼˜åŒ–æ–¹å¼"></a>1. sqlä¼˜åŒ–æ–¹å¼</h1><h3 id="1-åˆ›å»ºå’Œä½¿ç”¨ç´¢å¼•"><a href="#1-åˆ›å»ºå’Œä½¿ç”¨ç´¢å¼•" class="headerlink" title="1. åˆ›å»ºå’Œä½¿ç”¨ç´¢å¼•"></a>1. <strong>åˆ›å»ºå’Œä½¿ç”¨ç´¢å¼•</strong></h3><ul><li><strong>ç´¢å¼•å¸¸ç”¨æŸ¥è¯¢å­—æ®µ</strong>ï¼šå¯¹ç»å¸¸å‡ºç°åœ¨<code>WHERE</code>ã€<code>JOIN</code>ã€<code>ORDER BY</code>ã€<code>GROUP BY</code>ä¸­çš„å­—æ®µå»ºç«‹ç´¢å¼•ã€‚</li><li><strong>ç»„åˆç´¢å¼•</strong>ï¼šåˆ›å»ºåŒ…å«å¤šä¸ªåˆ—çš„ç»„åˆç´¢å¼•ï¼Œä»¥æ»¡è¶³å¤šä¸ªæ¡ä»¶æŸ¥è¯¢çš„éœ€æ±‚ã€‚</li><li><strong>è¦†ç›–ç´¢å¼•</strong>ï¼šé€‰æ‹©æ€§åœ°åˆ›å»ºè¦†ç›–ç´¢å¼•ï¼Œä½¿æŸ¥è¯¢å¯ä»¥ç›´æ¥ä»ç´¢å¼•ä¸­è·å–æ•°æ®è€Œæ— éœ€è®¿é—®è¡¨æ•°æ®ã€‚</li><li><strong>é¿å…è¿‡å¤šç´¢å¼•</strong>ï¼šè¿‡å¤šçš„ç´¢å¼•ä¼šå½±å“å†™æ“ä½œçš„æ€§èƒ½ï¼Œåº”åœ¨æŸ¥è¯¢å’Œå†™æ“ä½œä¹‹é—´æ‰¾åˆ°å¹³è¡¡ã€‚</li><li><strong>éµå®ˆæœ€å·¦å‰ç¼€æ³•åˆ™</strong>ï¼šå¦‚æœç´¢å¼•äº†å¤šåˆ—ï¼Œè¦éµå®ˆæœ€å·¦å‰ç¼€æ³•åˆ™ã€‚æŒ‡çš„æ˜¯æŸ¥è¯¢ä»ç´¢å¼•çš„æœ€å·¦å‰åˆ—å¼€å§‹å¹¶ä¸”ä¸è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—ã€‚</li></ul><h3 id="2-ä¼˜åŒ–æŸ¥è¯¢è¯­å¥"><a href="#2-ä¼˜åŒ–æŸ¥è¯¢è¯­å¥" class="headerlink" title="2. ä¼˜åŒ–æŸ¥è¯¢è¯­å¥"></a>2. <strong>ä¼˜åŒ–æŸ¥è¯¢è¯­å¥</strong></h3><ul><li>**é¿å…SELECT ***ï¼šåªæŸ¥è¯¢éœ€è¦çš„å­—æ®µï¼Œé¿å…ä½¿ç”¨<code>SELECT *</code>ã€‚</li><li><strong>å‡å°‘å­æŸ¥è¯¢</strong>ï¼šåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨<code>JOIN</code>ä»£æ›¿å­æŸ¥è¯¢ã€‚</li><li>**ä½¿ç”¨<code>EXISTS</code>æ›¿ä»£<code>IN</code>**ï¼šå¯¹äºå­æŸ¥è¯¢ï¼Œä½¿ç”¨<code>EXISTS</code>å¯èƒ½æ¯”<code>IN</code>æ›´é«˜æ•ˆã€‚</li><li><strong>é¿å…å‡½æ•°ç´¢å¼•</strong>ï¼šåœ¨<code>WHERE</code>å­å¥ä¸­é¿å…å¯¹åˆ—ä½¿ç”¨å‡½æ•°ï¼Œå°½é‡åœ¨åº”ç”¨å±‚å¤„ç†æ•°æ®ã€‚</li><li><strong>é¿å…ç´¢å¼•å¤±æ•ˆï¼Œå¯¼è‡´å…¨è¡¨æ‰«æ</strong>ï¼šå°½é‡ä¸ä½¿ç”¨ä¸ç­‰äºï¼ˆï¼&#x3D;æˆ–è€…&lt;&gt;ï¼‰likeï¼Œè¿™äº›æ— æ³•ä½¿ç”¨ç´¢å¼•ï¼Œä¼šå¯¼è‡´å…¨è¡¨æ‰«æ </li><li>ä¸åœ¨ç´¢å¼•åˆ—ä¸Šåšä»»ä½•æ“ä½œã€‚ï¼ˆè®¡ç®—ã€å‡½æ•°ã€ï¼ˆè‡ªåŠ¨oræ‰‹åŠ¨ï¼‰ç±»å‹è½¬æ¢ï¼‰ï¼Œä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆè€Œè½¬å‘å…¨è¡¨æ‰«æã€‚</li></ul><h3 id="4-è¡¨è®¾è®¡ä¼˜åŒ–"><a href="#4-è¡¨è®¾è®¡ä¼˜åŒ–" class="headerlink" title="4. è¡¨è®¾è®¡ä¼˜åŒ–"></a>4. <strong>è¡¨è®¾è®¡ä¼˜åŒ–</strong></h3><ul><li><strong>è§„èŒƒåŒ–</strong>ï¼šç¡®ä¿è¡¨è®¾è®¡ç¬¦åˆç¬¬ä¸‰èŒƒå¼ï¼Œå‡å°‘æ•°æ®å†—ä½™ã€‚</li><li><strong>é€‚å½“åè§„èŒƒåŒ–</strong>ï¼šåœ¨è¯»æ“ä½œé¢‘ç¹çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€‚å½“åè§„èŒƒåŒ–ï¼Œå‡å°‘<code>JOIN</code>æ“ä½œã€‚</li></ul><h3 id="5-ä¼˜åŒ–JOINæ“ä½œ"><a href="#5-ä¼˜åŒ–JOINæ“ä½œ" class="headerlink" title="5. ä¼˜åŒ–JOINæ“ä½œ"></a>5. <strong>ä¼˜åŒ–<code>JOIN</code>æ“ä½œ</strong></h3><ul><li><strong>é€‰æ‹©é€‚å½“çš„<code>JOIN</code>ç±»å‹</strong>ï¼šæ ¹æ®éœ€æ±‚é€‰æ‹©<code>INNER JOIN</code>ã€<code>LEFT JOIN</code>ç­‰ï¼Œé¿å…ä¸å¿…è¦çš„å…¨è¡¨æ‰«æã€‚</li><li><strong>ç¡®ä¿<code>JOIN</code>å­—æ®µç´¢å¼•</strong>ï¼šç¡®ä¿<code>JOIN</code>æ“ä½œä¸­ä½¿ç”¨çš„å­—æ®µä¸Šæœ‰ç´¢å¼•ã€‚</li><li><strong>å‡å°‘<code>JOIN</code>æ•°é‡</strong>ï¼šé¿å…å¤šä¸ªè¡¨çš„<code>JOIN</code>ï¼Œå‡å°‘å¤æ‚åº¦ã€‚</li></ul><h3 id="6-åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–"><a href="#6-åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="6. åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–"></a>6. <strong>åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–</strong></h3><ul><li><strong>é™åˆ¶è¿”å›æ•°æ®é‡</strong>ï¼šä½¿ç”¨<code>LIMIT</code>å’Œ<code>OFFSET</code>è¿›è¡Œåˆ†é¡µæŸ¥è¯¢ï¼Œé¿å…ä¸€æ¬¡æ€§è¿”å›å¤§é‡æ•°æ®ã€‚</li><li><strong>ä¼˜åŒ–åˆ†é¡µ</strong>ï¼šä½¿ç”¨é«˜æ•ˆçš„åˆ†é¡µæŸ¥è¯¢æ–¹å¼ï¼Œå¦‚åŸºäºç´¢å¼•çš„åˆ†é¡µæˆ–é€šè¿‡IDèŒƒå›´æŸ¥è¯¢ã€‚</li></ul><h3 id="7-æ‰¹é‡æ“ä½œ"><a href="#7-æ‰¹é‡æ“ä½œ" class="headerlink" title="7. æ‰¹é‡æ“ä½œ"></a>7. <strong>æ‰¹é‡æ“ä½œ</strong></h3><ul><li><strong>æ‰¹é‡æ’å…¥å’Œæ›´æ–°</strong>ï¼šä½¿ç”¨æ‰¹é‡æ’å…¥æˆ–æ›´æ–°æ“ä½œï¼Œå‡å°‘å•æ¬¡SQLæ“ä½œçš„å¼€é”€ã€‚</li><li><strong>é¿å…é€è¡Œå¤„ç†</strong>ï¼šå°½é‡ä½¿ç”¨æ‰¹é‡æ“ä½œä»£æ›¿é€è¡Œå¤„ç†ï¼Œæé«˜æ•ˆç‡ã€‚</li></ul><h3 id="8-åˆ†ææŸ¥è¯¢æ€§èƒ½"><a href="#8-åˆ†ææŸ¥è¯¢æ€§èƒ½" class="headerlink" title="8. åˆ†ææŸ¥è¯¢æ€§èƒ½"></a>8. <strong>åˆ†ææŸ¥è¯¢æ€§èƒ½</strong></h3><ul><li>**ä½¿ç”¨<code>EXPLAIN</code>**ï¼šä½¿ç”¨<code>EXPLAIN</code>å‘½ä»¤åˆ†ææŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ï¼Œè¯†åˆ«æ€§èƒ½ç“¶é¢ˆã€‚</li><li><strong>æŸ¥è¯¢æ—¥å¿—åˆ†æ</strong>ï¼šå¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œåˆ†ææ‰§è¡Œæ—¶é—´è¾ƒé•¿çš„æŸ¥è¯¢ï¼Œè¿›è¡Œé’ˆå¯¹æ€§ä¼˜åŒ–ã€‚</li></ul><h3 id="9-ä½¿ç”¨ç¼“å­˜"><a href="#9-ä½¿ç”¨ç¼“å­˜" class="headerlink" title="9. ä½¿ç”¨ç¼“å­˜"></a>9. <strong>ä½¿ç”¨ç¼“å­˜</strong></h3><ul><li><strong>åº”ç”¨å±‚ç¼“å­˜</strong>ï¼šä½¿ç”¨Redisæˆ–Memcachedç­‰ç¼“å­˜é¢‘ç¹æŸ¥è¯¢çš„æ•°æ®ã€‚</li><li><strong>æ•°æ®åº“å±‚ç¼“å­˜</strong>ï¼šåˆ©ç”¨æ•°æ®åº“çš„æŸ¥è¯¢ç¼“å­˜æœºåˆ¶ï¼ˆå¦‚MySQL Query Cacheï¼‰ã€‚</li></ul><h3 id="11-ä½¿ç”¨åˆé€‚çš„å­˜å‚¨å¼•æ“"><a href="#11-ä½¿ç”¨åˆé€‚çš„å­˜å‚¨å¼•æ“" class="headerlink" title="11. ä½¿ç”¨åˆé€‚çš„å­˜å‚¨å¼•æ“"></a>11. <strong>ä½¿ç”¨åˆé€‚çš„å­˜å‚¨å¼•æ“</strong></h3><ul><li><strong>é€‰æ‹©åˆé€‚çš„å­˜å‚¨å¼•æ“</strong>ï¼šæ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©é€‚åˆçš„å­˜å‚¨å¼•æ“ï¼ˆå¦‚InnoDBã€MyISAMï¼‰ã€‚</li></ul><h3 id="12-é¿å…æ­»é”"><a href="#12-é¿å…æ­»é”" class="headerlink" title="12. é¿å…æ­»é”"></a>12. <strong>é¿å…æ­»é”</strong></h3><ul><li><strong>åˆç†çš„äº‹åŠ¡ç®¡ç†</strong>ï¼šæ§åˆ¶äº‹åŠ¡çš„ç²’åº¦ï¼Œé¿å…é•¿æ—¶é—´æŒæœ‰é”ã€‚</li><li><strong>é¿å…èµ„æºç«äº‰</strong>ï¼šå°½é‡å‡å°‘å¹¶å‘æ“ä½œä¸­å¯¹ç›¸åŒèµ„æºçš„ç«äº‰ã€‚</li></ul><h3 id="13-é€‰æ‹©åˆé€‚çš„æ•°æ®åº“ä¸­é—´ä»¶"><a href="#13-é€‰æ‹©åˆé€‚çš„æ•°æ®åº“ä¸­é—´ä»¶" class="headerlink" title="13. é€‰æ‹©åˆé€‚çš„æ•°æ®åº“ä¸­é—´ä»¶"></a>13. é€‰æ‹©åˆé€‚çš„æ•°æ®åº“ä¸­é—´ä»¶</h3><ul><li><p>å¦‚æ•°æ®é‡å¤§æ—¶é‡‡ç”¨å½’æ¡£æˆ–è€…CHç­‰ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡</p><ul><li>åœ¨çº¿æŸ¥è¯¢ç³»ç»ŸOLTP</li><li>ç¦»çº¿åˆ†æç³»ç»ŸOLAPï¼šå¸¸è§æŠ¥è¡¨</li></ul></li><li><p>å’Œæ—¶é—´ç›¸å…³çš„æ•°æ®æ•°æ®é‡‡é›†è¿™ç§ï¼Œå¯ä»¥è€ƒè™‘influxDb</p></li><li><p>æœç´¢ç›¸å…³çš„ï¼Œelasticsearch</p></li></ul><p>1GBï¼Œæ•°æ®æ¡æ•°åœ¨1åƒä¸‡ä»¥å†…ï¼šå¸¸è§çš„æ•°æ®åº“éƒ½å¯ä»¥åº”å¯¹ï¼šmysql, postgresql</p><p>1GB~10Gb, äº¿çº§ -&gt; å•æœº</p><p>è¶…è¿‡äº†10GBä»¥åŠäº¿çº§ -ã€‹ æ•°æ®åˆ†ç‰‡ï¼Œ å¤šå°ç‰©ç†æœº</p><p>ï¼ˆåŒæ—¶ä¹Ÿè€ƒè™‘æŠ€æœ¯äººæ‰ï¼‰</p><h3 id="14-åˆ†åº“åˆ†è¡¨"><a href="#14-åˆ†åº“åˆ†è¡¨" class="headerlink" title="14. åˆ†åº“åˆ†è¡¨"></a>14. åˆ†åº“åˆ†è¡¨</h3><ul><li>ä½¿ç”¨ä¸€äº›åˆ†åº“åˆ†è¡¨ç»„ä»¶å¦‚ï¼šShardingSphereï¼Œmycatï¼Œ DBLE</li></ul><p>ä½†æ˜¯ä½¿ç”¨è¿™äº›ç»„ä»¶ä¼šä¸€å®šç¨‹åº¦é™åˆ¶SQLï¼Œéœ€è¦ä½ åœ¨ä½¿ç”¨å‰æ˜ç¡®åç»­å¯¹SQLçš„æ“ä½œ</p><p><a href="https://pyr9.github.io/mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/">åˆ†åº“åˆ†è¡¨è¦è§£å†³å“ªäº›é—®é¢˜</a></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysqlç´¢å¼•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Explainè¯¦è§£</title>
    <link href="/Explain%E8%AF%A6%E8%A7%A3/"/>
    <url>/Explain%E8%AF%A6%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="explainä½¿ç”¨ä»‹ç»"><a href="#explainä½¿ç”¨ä»‹ç»" class="headerlink" title="explainä½¿ç”¨ä»‹ç»"></a>explainä½¿ç”¨ä»‹ç»</h1><ul><li><p>ä½¿ç”¨EXPLAINå…³é”®å­—å¯ä»¥æ¨¡æ‹Ÿä¼˜åŒ–å™¨æ‰§è¡ŒSQLè¯­å¥ï¼Œåˆ†æä½ çš„æŸ¥è¯¢è¯­å¥æˆ–æ˜¯ç»“æ„çš„æ€§èƒ½ç“¶é¢ˆ </p></li><li><p>åœ¨ select è¯­å¥ä¹‹å‰å¢åŠ  explain å…³é”®å­—ï¼ŒMySQL ä¼šåœ¨æŸ¥è¯¢ä¸Šè®¾ç½®ä¸€ä¸ªæ ‡è®°ï¼Œæ‰§è¡ŒæŸ¥è¯¢ä¼šè¿”å›æ‰§è¡Œè®¡åˆ’çš„ä¿¡æ¯ï¼Œè€Œä¸æ˜¯æ‰§è¡Œè¿™æ¡SQL ï¼ˆå¦‚æœ from ä¸­åŒ…å«å­æŸ¥è¯¢ï¼Œä»ä¼šæ‰§è¡Œè¯¥å­æŸ¥è¯¢ï¼Œå°†ç»“æœæ”¾å…¥ä¸´æ—¶è¡¨ä¸­ï¼‰ã€‚</p></li><li><p>åœ¨æŸ¥è¯¢ä¸­çš„æ¯ä¸ªè¡¨ä¼šè¾“å‡ºä¸€è¡Œï¼Œå¦‚æœæœ‰ä¸¤ä¸ªè¡¨é€šè¿‡ join è¿æ¥æŸ¥è¯¢ï¼Œé‚£ä¹ˆä¼šè¾“å‡ºä¸¤è¡Œã€‚è¡¨çš„æ„ä¹‰ç›¸å½“å¹¿æ³›ï¼šå¯ä»¥æ˜¯å­æŸ¥è¯¢ã€ä¸€ä¸ª union ç»“æœç­‰ã€‚</p></li></ul><p><strong>ä¸‹é¢æ˜¯ä½¿ç”¨explainçš„ä¾‹å­ï¼š</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> actor;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223313016.png" alt="image-20230228223313016"></p><h2 id="explainä¸­çš„åˆ—"><a href="#explainä¸­çš„åˆ—" class="headerlink" title="explainä¸­çš„åˆ—"></a>explainä¸­çš„åˆ—</h2><h3 id="idåˆ—"><a href="#idåˆ—" class="headerlink" title="idåˆ—"></a>idåˆ—</h3><ul><li><p>idåˆ—çš„ç¼–å·å°±æ˜¯selectçš„åºåˆ—å·ï¼Œæœ‰å‡ ä¸ªselectå°±æœ‰å‡ ä¸ªid</p></li><li><p>idçš„é¡ºåºæ˜¯æŒ‰select å‡ºç°çš„é¡ºåºå¢é•¿çš„</p></li><li><p>Idåˆ—è¶Šå¤§æ‰§è¡Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œidç›¸åŒåˆ™ä»ä¸Šå¾€ä¸‹æ‰§è¡Œï¼Œidä¸ºNULLæœ€åæ‰§è¡Œ</p></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> actor limit <span class="hljs-number">1</span>) <span class="hljs-keyword">from</span> film;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223320796.png" alt="image-20230228223320796"></p><h3 id="select-typeåˆ—"><a href="#select-typeåˆ—" class="headerlink" title="select_typeåˆ—"></a>select_typeåˆ—</h3><ul><li>simple: ç®€å•æŸ¥è¯¢ã€‚æŸ¥è¯¢ä¸­ä¸å«å­æŸ¥è¯¢å’Œè”åˆæŸ¥è¯¢ã€‚</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> film <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223331408.png" alt="image-20230228223331408"></p><ul><li>primary : å¤æ‚æŸ¥è¯¢ä¸­æœ€å¤–å±‚çš„selectã€‚</li></ul> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> actor limit <span class="hljs-number">1</span>) <span class="hljs-keyword">from</span> film;<br></code></pre></td></tr></table></figure><p>ä¸­çš„ï¼š<code>select *** from film </code> </p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223341496.png" alt="image-20230228223341496"></p><ul><li>subsquery: å¤æ‚æŸ¥è¯¢ä¸­çš„å­æŸ¥è¯¢ï¼ˆä¸åœ¨fromå­å¥ä¸­ï¼‰ã€‚</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> actor limit <span class="hljs-number">1</span>) <span class="hljs-keyword">from</span> film;<br></code></pre></td></tr></table></figure><p>ä¸­çš„ï¼š<code>select 1 from actor limit 1</code></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223405616.png"></p><ul><li>derived([dÉªËˆraÉªv]) : åŒ…å«åœ¨fromå­å¥ä¸­çš„å­æŸ¥è¯¢ã€‚Mysqlå°†æŠŠç»“æœå­˜æ”¾åœ¨ä¸€ä¸ªä¸´æ—¶è¡¨ä¸­ï¼Œä¹Ÿç§°ä¸ºæ´¾ç”Ÿè¡¨ã€‚</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span>  <span class="hljs-keyword">set</span> session optimizer_switch<span class="hljs-operator">=</span><span class="hljs-string">&#x27;derived_merge=off&#x27;</span>;<br>mysql<span class="hljs-operator">&gt;</span>  explain <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> actor <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> film <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>) der;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223416134.png"></p><ul><li>union ï¼šåœ¨unionåçš„selectã€‚</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> id,name <span class="hljs-keyword">from</span> actor <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">select</span> id, name <span class="hljs-keyword">from</span> film;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223426632.png" alt="image-20230228223426632"></p><blockquote><ul><li>union ç”¨äºæŠŠæ¥è‡ªå¤šä¸ªselect  è¯­å¥çš„ç»“æœç»„åˆåˆ°ä¸€ä¸ªç»“æœé›†åˆä¸­ã€‚è¯­æ³•ä¸ºï¼š</li></ul>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"> <span class="hljs-keyword">select</span>  <span class="hljs-keyword">column</span>,......<span class="hljs-keyword">from</span> table1<br><span class="hljs-keyword">union</span> [<span class="hljs-keyword">all</span>]<br> <span class="hljs-keyword">select</span>  <span class="hljs-keyword">column</span>,...... <span class="hljs-keyword">from</span> table2<br></code></pre></td></tr></table></figure></blockquote><h3 id="tableåˆ—"><a href="#tableåˆ—" class="headerlink" title="tableåˆ—"></a>tableåˆ—</h3><ul><li>è¿™ä¸€åˆ—è¡¨ç¤ºexplainçš„è¿™ä¸€è¡Œåœ¨æ‰§è¡Œå“ªä¸ªè¡¨</li><li>å½“formåæœ‰å­æŸ¥è¯¢æ—¶ï¼Œtableåˆ—ä¸º<code>&lt;derivedN&gt;</code>æ ¼å¼ï¼Œè¡¨ç¤ºå½“å‰æŸ¥è¯¢ä¾èµ–id &#x3D; Nçš„æŸ¥è¯¢ï¼Œäºæ˜¯å…ˆæ‰§è¡Œid&#x3D; Nçš„æŸ¥è¯¢ã€‚</li></ul><h3 id="type-åˆ—"><a href="#type-åˆ—" class="headerlink" title="type åˆ—"></a>type åˆ—</h3><ul><li><p>è¿™ä¸€åˆ—è¡¨ç¤ºè®¿é—®ç±»å‹ï¼Œå³mysqlå†³å®šå¦‚ä½•æŸ¥æ‰¾è¡¨ä¸­çš„è¡Œã€‚</p></li><li><p>æ€§èƒ½æ’åºä»å¥½åˆ°åä¾æ¬¡ä¸ºï¼š<code>system &gt;const&gt; eq_ref&gt; ref&gt; range &gt; index &gt; all</code>ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¾—ä¿è¯æŸ¥è¯¢è‡³å°‘åˆ°rangeçº§åˆ«ï¼Œæœ€å¥½åˆ°refã€‚</p></li><li><p>å…·ä½“çš„ç±»å‹ä»‹ç»ã€‚</p><blockquote><ul><li><p>NULLï¼šmysqlåœ¨çª’æ¯æ„Ÿé˜¶æ®µç”¨ä¸ç€è®¿é—®è¡¨æˆ–è€…ç´¢å¼•ã€‚ä¾‹å¦‚ç´¢å¼•åˆ—ä¸­å–æœ€å°å€¼ï¼Œå¯ä»¥å•ç‹¬æŸ¥æ‰¾ç´¢å¼•æ¥å®Œæˆï¼Œä¸éœ€è¦æ‰§è¡Œæ—¶è®¿é—®è¡¨ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> <span class="hljs-built_in">min</span>(id) <span class="hljs-keyword">from</span> film;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223438382.png" alt="image-20230228223438382"></p></li></ul></blockquote><blockquote><ul><li><p>constï¼šç›´æ¥æŒ‰ primary key æˆ– unique keyè¯»å–ï¼Œå°†è¯¥åˆ—ä¸å¸¸æ•°æ¯”è¾ƒï¼Œæ‰€ä»¥è¡¨æœ€å¤šæœ‰ä¸€ä¸ªåŒ¹é…è¡Œï¼Œè¯»å–1æ¬¡ï¼Œé€Ÿåº¦æ¯”è¾ƒå¿«</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> id, name <span class="hljs-keyword">from</span> film <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223446506.png" alt="image-20230228223446506"></p></li></ul></blockquote><blockquote><ul><li><p>eq_refï¼šprimary key æˆ– unique key ç´¢å¼•çš„æ‰€æœ‰éƒ¨åˆ†è¢«è¿æ¥ä½¿ç”¨ ï¼Œæœ€å¤šåªä¼šè¿”å›ä¸€æ¡ç¬¦åˆ æ¡ä»¶çš„è®°å½•ã€‚è¿™å¯èƒ½æ˜¯åœ¨ const ä¹‹å¤–æœ€å¥½çš„è”æ¥ç±»å‹äº†ï¼Œç®€å•çš„ select æŸ¥è¯¢ä¸ä¼šå‡ºç°è¿™ç§ typeã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span>  explain <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> film_actor <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> film <span class="hljs-keyword">on</span> film_actor.film_id <span class="hljs-operator">=</span> film.id;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223459495.png" alt="image-20230228223459495"></p></li></ul></blockquote><blockquote><ul><li>refï¼šç›¸æ¯” eq_refï¼Œä¸ä½¿ç”¨å”¯ä¸€ç´¢å¼•ï¼Œè€Œæ˜¯ä½¿ç”¨æ™®é€šç´¢å¼•æˆ–è€…è”åˆç´¢å¼•çš„éƒ¨åˆ†å‰ç¼€ï¼Œç´¢å¼•è¦ å’ŒæŸä¸ªå€¼ç›¸æ¯”è¾ƒï¼Œå¯èƒ½ä¼šæ‰¾åˆ°å¤šä¸ªç¬¦åˆæ¡ä»¶çš„è¡Œã€‚</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> film <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;film1&#x27;</span>;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223509760.png" alt="image-20230228223509760"></p></blockquote><blockquote><ul><li>rangeï¼šèŒƒå›´æ‰«æé€šå¸¸å‡ºç°åœ¨ in(), between ,&gt; ,&lt;, &gt;&#x3D; ç­‰æ“ä½œä¸­ã€‚ä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥æ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œã€‚</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> actor <span class="hljs-keyword">where</span> id <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223520759.png" alt="image-20230228223520759"></p></blockquote><blockquote><ul><li>indexï¼šæ‰«æå…¨è¡¨ç´¢å¼•ï¼Œè¿™é€šå¸¸æ¯”ALLå¿«ä¸€äº›ã€‚å³æŸ¥è¯¢çš„å­—æ®µéƒ½æ˜¯ç´¢å¼•åˆ—ã€‚</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span>  explain <span class="hljs-keyword">select</span> id,name <span class="hljs-keyword">from</span> film;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223531307.png" alt="image-20230228223531307"></p></blockquote><p>â€‹</p><blockquote><ul><li>ALLï¼šå³å…¨è¡¨æ‰«æï¼Œæ„å‘³ç€mysqléœ€è¦ä»å¤´åˆ°å°¾å»æŸ¥æ‰¾æ‰€éœ€è¦çš„è¡Œã€‚é€šå¸¸æƒ…å†µä¸‹è¿™éœ€è¦å¢åŠ ç´¢å¼•æ¥è¿›è¡Œä¼˜åŒ–äº†ã€‚</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span>  explain <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> actor;<br></code></pre></td></tr></table></figure><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223546942.png" alt="image-20230228223546942"></p></blockquote></li></ul><h3 id="possible-keysåˆ—"><a href="#possible-keysåˆ—" class="headerlink" title="possible_keysåˆ—"></a><strong>possible_keysåˆ—</strong></h3><ul><li>è¿™ä¸€åˆ—æ˜¾ç¤ºæŸ¥è¯¢å¯èƒ½ä½¿ç”¨å“ªäº›ç´¢å¼•æ¥æŸ¥æ‰¾ã€‚ </li><li>explain æ—¶å¯èƒ½å‡ºç° possible_keys æœ‰åˆ—ï¼Œè€Œ key æ˜¾ç¤º NULL çš„æƒ…å†µï¼Œè¿™ç§æƒ…å†µæ˜¯å› ä¸ºè¡¨ä¸­ æ•°æ®ä¸å¤šï¼Œmysqlè®¤ä¸ºç´¢å¼•å¯¹æ­¤æŸ¥è¯¢å¸®åŠ©ä¸å¤§ï¼Œé€‰æ‹©äº†å…¨è¡¨æŸ¥è¯¢ã€‚ </li><li>å¦‚æœè¯¥åˆ—æ˜¯NULLï¼Œåˆ™æ²¡æœ‰ç›¸å…³çš„ç´¢å¼•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥ where å­å¥çœ‹æ˜¯å¦å¯ä»¥åˆ›é€ ä¸€ä¸ªé€‚å½“çš„ç´¢å¼•æ¥æé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œç„¶åç”¨ explain æŸ¥çœ‹æ•ˆæœã€‚</li></ul><h3 id="keyåˆ—"><a href="#keyåˆ—" class="headerlink" title="keyåˆ—"></a>keyåˆ—</h3><ul><li>è¿™ä¸€åˆ—æ˜¾ç¤ºmysqlå®é™…é‡‡ç”¨å“ªä¸ªç´¢å¼•æ¥ä¼˜åŒ–å¯¹è¯¥è¡¨çš„è®¿é—®ã€‚ </li><li>å¦‚æœæ²¡æœ‰ä½¿ç”¨ç´¢å¼•ï¼Œåˆ™è¯¥åˆ—æ˜¯ NULLã€‚å¦‚æœæƒ³å¼ºåˆ¶mysqlä½¿ç”¨æˆ–å¿½è§†possible_keysåˆ—ä¸­çš„ç´¢ å¼•ï¼Œåœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨ force indexã€ignore indexã€‚</li></ul><h3 id="key-lenåˆ—"><a href="#key-lenåˆ—" class="headerlink" title="key_lenåˆ—"></a>key_lenåˆ—</h3><ul><li>è¿™ä¸€åˆ—æ˜¾ç¤ºäº†mysqlåœ¨ç´¢å¼•é‡Œä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œé€šè¿‡è¿™ä¸ªå€¼å¯ä»¥ç®—å‡ºå…·ä½“ä½¿ç”¨äº†ç´¢å¼•ä¸­çš„å“ªäº›åˆ—ã€‚ </li><li>ä¸¾ä¾‹æ¥è¯´ï¼Œfilm_actorçš„è”åˆç´¢å¼• idx_film_actor_id ç”± film_id å’Œ actor_id ä¸¤ä¸ªintåˆ—ç»„æˆï¼Œ å¹¶ä¸”æ¯ä¸ªintæ˜¯4å­—èŠ‚ã€‚é€šè¿‡ç»“æœä¸­çš„key_len&#x3D;4å¯æ¨æ–­å‡ºæŸ¥è¯¢ä½¿ç”¨äº†ç¬¬ä¸€ä¸ªåˆ—ï¼šfilm_idåˆ—æ¥æ‰§è¡Œç´¢å¼•æŸ¥æ‰¾ã€‚</li></ul><blockquote><p>key_lenè®¡ç®—è§„åˆ™å¦‚ä¸‹ï¼š </p><ul><li><p>å­—ç¬¦ä¸² </p><ul><li><p>char(n)ï¼šnå­—èŠ‚é•¿åº¦</p></li><li><p>varchar(n)ï¼š2å­—èŠ‚å­˜å‚¨å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¦‚æœæ˜¯utf-8ï¼Œåˆ™é•¿åº¦ 3n </p><p>+ 2</p></li></ul></li><li><p>æ•°å€¼ç±»å‹</p><ul><li>tinyintï¼š1å­—èŠ‚ </li><li>smallintï¼š2å­—èŠ‚</li><li>intï¼š4å­—èŠ‚ </li><li>bigintï¼š8å­—èŠ‚</li></ul></li><li><p>æ—¶é—´ç±»å‹</p><ul><li>dateï¼š3å­—èŠ‚ </li><li>timestampï¼š4å­—èŠ‚ </li><li>datetimeï¼š8å­—èŠ‚</li></ul></li><li><p>å¦‚æœå­—æ®µå…è®¸ä¸º NULLï¼Œéœ€è¦1å­—èŠ‚è®°å½•æ˜¯å¦ä¸º NULL</p></li></ul></blockquote><h3 id="refåˆ—"><a href="#refåˆ—" class="headerlink" title="refåˆ—"></a><strong>refåˆ—</strong></h3><ul><li>è¿™ä¸€åˆ—æ˜¾ç¤ºäº†åœ¨keyåˆ—è®°å½•çš„ç´¢å¼•ä¸­ï¼Œè¡¨æŸ¥æ‰¾å€¼æ‰€ç”¨åˆ°çš„åˆ—æˆ–å¸¸é‡ï¼Œå¸¸è§çš„æœ‰ï¼šconstï¼ˆå¸¸é‡ï¼‰ï¼Œå­—æ®µåï¼ˆä¾‹ï¼šfilm.idï¼‰</li></ul><h3 id="rowsåˆ—"><a href="#rowsåˆ—" class="headerlink" title="rowsåˆ—"></a><strong>rowsåˆ—</strong></h3><ul><li>è¿™ä¸€åˆ—æ˜¯mysqlä¼°è®¡è¦è¯»å–å¹¶æ£€æµ‹çš„è¡Œæ•°ï¼Œæ³¨æ„è¿™ä¸ªä¸æ˜¯ç»“æœé›†é‡Œçš„è¡Œæ•°ã€‚</li></ul><h3 id="Extraåˆ—"><a href="#Extraåˆ—" class="headerlink" title="Extraåˆ—"></a><strong>Extraåˆ—</strong></h3><p>è¿™ä¸€åˆ—å±•ç¤ºçš„æ˜¯é¢å¤–ä¿¡æ¯ã€‚å¸¸è§çš„é‡è¦å€¼å¦‚ä¸‹ï¼š </p><ul><li><p>Using indexï¼šä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼ˆè¦†ç›–ç´¢å¼•æŒ‡ä¸€ä¸ªæŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œåªç”¨ä»ç´¢å¼•ä¸­å°±èƒ½å¤Ÿå–å¾—ï¼Œä¸å¿…ä»æ•°æ®è¡¨ä¸­è¯»å–ã€‚ ï¼‰</p></li><li><p>Using whereï¼šä½¿ç”¨ where è¯­å¥æ¥å¤„ç†ç»“æœï¼ŒæŸ¥è¯¢çš„åˆ—æœªè¢«ç´¢å¼•è¦†ç›–</p></li><li><p>Using index conditionï¼šä¼šå…ˆæ¡ä»¶è¿‡æ»¤ç´¢å¼•ï¼Œè¿‡æ»¤å®Œç´¢å¼•åæ‰¾åˆ°æ‰€æœ‰ç¬¦åˆç´¢å¼•æ¡ä»¶çš„æ•°æ®è¡Œï¼Œéšåç”¨ WHERE å­å¥ä¸­çš„å…¶ä»–æ¡ä»¶å»è¿‡æ»¤è¿™äº›æ•°æ®è¡Œï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> film_actor <span class="hljs-keyword">where</span> film_id <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure></li><li><p>Using temporaryï¼šmysqléœ€è¦åˆ›å»ºä¸€å¼ ä¸´æ—¶è¡¨æ¥å¤„ç†æŸ¥è¯¢ã€‚å‡ºç°è¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯è¦è¿›è¡Œä¼˜åŒ–çš„ï¼Œé¦–å…ˆæ˜¯æƒ³åˆ°ç”¨ç´¢å¼•æ¥ä¼˜åŒ–ã€‚ </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> <span class="hljs-keyword">distinct</span> name <span class="hljs-keyword">from</span> actor;<br></code></pre></td></tr></table></figure><ul><li>actor.nameæ²¡æœ‰ç´¢å¼•ï¼Œæ­¤æ—¶åˆ›å»ºäº†å¼ ä¸´æ—¶è¡¨æ¥distinct</li></ul></li><li><p>Using filesortï¼šå°†ç”¨å¤–éƒ¨æ’åºè€Œä¸æ˜¯ç´¢å¼•æ’åºï¼Œæ•°æ®è¾ƒå°æ—¶ä»å†…å­˜æ’åºï¼Œå¦åˆ™éœ€è¦åœ¨ç£ç›˜å®Œæˆæ’åºã€‚è¿™ç§æƒ…å†µä¸‹ä¸€èˆ¬ä¹Ÿæ˜¯è¦è€ƒè™‘ä½¿ç”¨ç´¢å¼•æ¥ä¼˜åŒ–çš„ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> actor <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> name;<br></code></pre></td></tr></table></figure><ul><li>actor.nameæœªåˆ›å»ºç´¢å¼•ï¼Œä¼šæµè§ˆactoræ•´ä¸ªè¡¨ï¼Œä¿å­˜æ’åºå…³é”®å­—nameå’Œå¯¹åº”çš„idï¼Œç„¶åæ’ åºnameå¹¶æ£€ç´¢è¡Œè®°å½•</li></ul></li><li><p>Select tables optimized awayï¼šä½¿ç”¨æŸäº›èšåˆå‡½æ•°ï¼ˆæ¯”å¦‚ maxã€minï¼‰æ¥è®¿é—®å­˜åœ¨ç´¢å¼•çš„æŸä¸ªå­—æ®µ.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> explain <span class="hljs-keyword">select</span> <span class="hljs-built_in">min</span>(id) <span class="hljs-keyword">from</span> film;<br></code></pre></td></tr></table></figure></li></ul><blockquote><p> Extra çš„ä»‹ç»ä¸æ˜¯ä¸€å®šçš„ï¼Œéœ€è¦ç»¼åˆå½“æ—¶çš„åœºæ™¯è€ƒè™‘ï¼Œä¸éœ€è¦è®°ä½å“ªä¸ªåœºæ™¯ä½¿ç”¨çš„æ˜¯å“ªä¸ªï¼Œåªæ˜¯éœ€è¦å½“å‡ºç°Using filesort, Using temporaryï¼šUsing whereï¼šæ—¶ï¼Œè€ƒè™‘éœ€è¦ä¼˜åŒ–ã€‚</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Explainè¯¦è§£</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mysqlç´¢å¼•ä»‹ç»</title>
    <link href="/mysql%E7%B4%A2%E5%BC%95%E4%BB%8B%E7%BB%8D/"/>
    <url>/mysql%E7%B4%A2%E5%BC%95%E4%BB%8B%E7%BB%8D/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ç´¢å¼•çš„æœ¬è´¨"><a href="#1-ç´¢å¼•çš„æœ¬è´¨" class="headerlink" title="1. ç´¢å¼•çš„æœ¬è´¨"></a>1. ç´¢å¼•çš„æœ¬è´¨</h1><blockquote><p>ç´¢å¼•æ˜¯å¸®åŠ©Mysqlé«˜æ•ˆè·å–æ•°æ®çš„æ’å¥½åºçš„æ•°æ®ç»“æ„</p></blockquote><h1 id="2-ç´¢å¼•çš„æ•°æ®ç»“æ„"><a href="#2-ç´¢å¼•çš„æ•°æ®ç»“æ„" class="headerlink" title="2. ç´¢å¼•çš„æ•°æ®ç»“æ„"></a>2. ç´¢å¼•çš„æ•°æ®ç»“æ„</h1><h4 id="äºŒå‰æ ‘ï¼šå•è¾¹å¢é•¿çš„åœºæ™¯ä¼šå¯¼è‡´å…¨è¡¨æ‰«æã€‚"><a href="#äºŒå‰æ ‘ï¼šå•è¾¹å¢é•¿çš„åœºæ™¯ä¼šå¯¼è‡´å…¨è¡¨æ‰«æã€‚" class="headerlink" title="äºŒå‰æ ‘ï¼šå•è¾¹å¢é•¿çš„åœºæ™¯ä¼šå¯¼è‡´å…¨è¡¨æ‰«æã€‚"></a>äºŒå‰æ ‘ï¼šå•è¾¹å¢é•¿çš„åœºæ™¯ä¼šå¯¼è‡´å…¨è¡¨æ‰«æã€‚</h4><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230316043.png" alt="image-20230228230316043"></p><span id="more"></span><h4 id="çº¢é»‘æ ‘ï¼šç›¸å¯¹å¹³è¡¡ï¼Œæ¯”äºŒå‰æ ‘æ€§èƒ½å¥½ï¼Œå¤§æ•°æ®ä¸‹ï¼Œçº¢é»‘æ ‘çš„é«˜åº¦è¿‡é«˜ï¼Œä¼šé€ æˆç£ç›˜IOé¢‘ç¹ã€‚"><a href="#çº¢é»‘æ ‘ï¼šç›¸å¯¹å¹³è¡¡ï¼Œæ¯”äºŒå‰æ ‘æ€§èƒ½å¥½ï¼Œå¤§æ•°æ®ä¸‹ï¼Œçº¢é»‘æ ‘çš„é«˜åº¦è¿‡é«˜ï¼Œä¼šé€ æˆç£ç›˜IOé¢‘ç¹ã€‚" class="headerlink" title="çº¢é»‘æ ‘ï¼šç›¸å¯¹å¹³è¡¡ï¼Œæ¯”äºŒå‰æ ‘æ€§èƒ½å¥½ï¼Œå¤§æ•°æ®ä¸‹ï¼Œçº¢é»‘æ ‘çš„é«˜åº¦è¿‡é«˜ï¼Œä¼šé€ æˆç£ç›˜IOé¢‘ç¹ã€‚"></a>çº¢é»‘æ ‘ï¼šç›¸å¯¹å¹³è¡¡ï¼Œæ¯”äºŒå‰æ ‘æ€§èƒ½å¥½ï¼Œå¤§æ•°æ®ä¸‹ï¼Œçº¢é»‘æ ‘çš„é«˜åº¦è¿‡é«˜ï¼Œä¼šé€ æˆç£ç›˜IOé¢‘ç¹ã€‚</h4><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230321402.png" alt="image-20230228230321402"></p><h4 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h4><p>ä¸€æ¬¡hashç®—æ³•å°±å¯ä»¥å®šä½åˆ°æ–‡ä»¶çš„ä½ç½®ï¼Œä½†å­˜åœ¨ç¼ºç‚¹ï¼š</p><ul><li>ä¸æ”¯æŒèŒƒå›´æŸ¥æ‰¾</li><li>ä¸æ”¯æŒæ’åº</li></ul><p>æ•°æ®åº“å¦‚æœæ¯”è¾ƒå¤§ï¼Œåªç”¨åˆ°ç²¾ç¡®æŸ¥æ‰¾å°±å¯ä»¥ç”¨hash</p><h4 id="B-treeï¼š"><a href="#B-treeï¼š" class="headerlink" title="B-treeï¼š"></a>B-treeï¼š</h4><ol><li><strong>ç‰¹ç‚¹ï¼š</strong></li></ol><blockquote><ul><li>å¶å­ç»“ç‚¹å…·æœ‰ç›¸åŒçš„æ·±åº¦ï¼Œå¶å­ç»“ç‚¹æŒ‡é’ˆä¸ºç©ºã€‚</li><li>æ‰€æœ‰ç´¢å¼•å…ƒç´ ä¸é‡å¤</li><li>èŠ‚ç‚¹ä¸­çš„æ•°æ®ç´¢å¼•ä»å·¦åˆ°å³é€’å¢</li></ul></blockquote><ol start="2"><li>å¦‚æœä½¿ç”¨äº†innoDbå­˜å‚¨å¼•æ“ï¼Œç»“ç‚¹çš„dataå…ƒç´ å°±å¯èƒ½å­˜å‚¨çš„æ˜¯é™¤äº†ç´¢å¼•å¤–çš„å…¶ä»–æ‰€æœ‰åˆ—ï¼Œä¼šå ç”¨æ¯”è¾ƒå¤§çš„å­˜å‚¨ç©ºé—´ï¼Œå¯¹äºä¸€ä¸ªå¤§ç»“ç‚¹è€Œè¨€ï¼Œå¯ä»¥å­˜æ”¾çš„ç»“ç‚¹æ•°é‡å°±ä¼šæ¯”è¾ƒå°</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230329788.png" alt="image-20230228230329788"></p><h4 id="B-tree-B-treeå˜ç§"><a href="#B-tree-B-treeå˜ç§" class="headerlink" title="B+tree(B-treeå˜ç§)"></a>B+tree(B-treeå˜ç§)</h4><ol><li><p>ç‰¹ç‚¹ï¼š</p><blockquote><ul><li>éå¶å­ç»“ç‚¹ä¸å­˜å‚¨data ,åªå­˜å‚¨ç´¢å¼•ï¼ˆå†—ä½™ï¼‰ï¼Œå¯ä»¥å­˜æ”¾æ›´å¤šçš„ç´¢å¼•ã€‚</li><li>å¶å­ç»“ç‚¹åŒ…å«æ‰€æœ‰çš„ç´¢å¼•å­—æ®µã€‚</li><li>å¶å­ç»“ç‚¹ç”¨æŒ‡é’ˆè¿æ¥ï¼Œæé«˜åŒºé—´è®¿é—®çš„æ€§èƒ½ã€‚</li></ul></blockquote><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228230339454.png" alt="image-20230228230339454"></p></li></ol><p><strong>ç´¢å¼•æ˜¯æ€ä¹ˆæ”¯æŒåƒä¸‡çº§è¡¨å¿«é€ŸæŸ¥æ‰¾ï¼Ÿ</strong></p><p>mysqlå»ºè®®ä¸€ä¸ªç»“ç‚¹å¤§å°ä¸º16kb,è¿™æ ·ä¸€æ¬¡iOé€Ÿåº¦æ¯”è¾ƒå¿«ï¼Œä¸€ä¸ªå¤§ç»“ç‚¹ä¸‹çš„ä¸€ä¸ªç´¢å¼•å…ƒç´ å¤§çº¦æ˜¯14bï¼Œæ‰€ä»¥ä¸€ä¸ªå¤§ç»“ç‚¹é‡Œé¢çº¦æœ‰1170ä¸ªç´¢å¼•å…ƒç´ ï¼Œå¯¹äºä¸€ä¸ªé«˜åº¦ä¸º3çš„b+æ ‘ï¼Œå¯ä»¥å­˜å‚¨<code>16* 1170* 1170 </code>&#x3D; 2000ä¸‡ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysqlç´¢å¼•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RabbitMQçš„7ç§å·¥ä½œæ¨¡å¼</title>
    <link href="/RabbitMQ%E7%9A%847%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/"/>
    <url>/RabbitMQ%E7%9A%847%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="RabbitMQçš„7ç§å·¥ä½œæ¨¡å¼"><a href="#RabbitMQçš„7ç§å·¥ä½œæ¨¡å¼" class="headerlink" title="RabbitMQçš„7ç§å·¥ä½œæ¨¡å¼"></a><strong>RabbitMQçš„7ç§å·¥ä½œæ¨¡å¼</strong></h1><h2 id="1-simpleæ¨¡å¼"><a href="#1-simpleæ¨¡å¼" class="headerlink" title="1. simpleæ¨¡å¼"></a>1. simpleæ¨¡å¼</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223058625.png" alt="image-20230228223058625"></p><ul><li><p>æœ€ç®€å•çš„æ”¶å‘æ¨¡å¼ã€‚ç”Ÿäº§è€…å‘é€ä¸€ä¸ªæ¶ˆæ¯åˆ°ä¸€ä¸ªæŒ‡å®šçš„queueï¼Œä¸­é—´ä¸éœ€è¦ä»»ä½•exchangeè§„åˆ™ã€‚æ¶ˆè´¹è€…ç«¯é€šè¿‡queueæ–¹å¼è¿›è¡Œæ¶ˆè´¹ã€‚</p></li><li><p>ä»£ç </p><ul><li><p>producer:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">channel.queueDeclare(QUEUE_NAME, <span class="hljs-keyword">true</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">null</span>);<br>String message = <span class="hljs-string">&quot;hello world&quot;</span>;<br>channel.basicPublish(<span class="hljs-string">&quot;&quot;</span>, QUEUE_NAME, <span class="hljs-keyword">null</span>, message.getBytes(StandardCharsets.UTF_8));<br></code></pre></td></tr></table></figure></li><li><p>consumer:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">channel.queueDeclare(QUEUE_NAME, <span class="hljs-keyword">true</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">null</span>);<br></code></pre></td></tr></table></figure></li></ul></li></ul><h2 id="2-workå·¥ä½œæ¨¡å¼-èµ„æºçš„ç«äº‰"><a href="#2-workå·¥ä½œæ¨¡å¼-èµ„æºçš„ç«äº‰" class="headerlink" title="2. workå·¥ä½œæ¨¡å¼(èµ„æºçš„ç«äº‰)"></a>2. workå·¥ä½œæ¨¡å¼(èµ„æºçš„ç«äº‰)</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223108418.png" alt="image-20230228223108418"></p><ul><li><p>ä¸€ä¸ªç”Ÿäº§è€…ï¼Œå¤šä¸ªæ¶ˆè´¹è€…ã€‚</p></li><li><p>consumer1, consumer2 åŒæ—¶ç›‘å¬åŒä¸€ ä¸ªé˜Ÿåˆ—,æ¶ˆæ¯è¢«æ¶ˆè´¹ã€‚æœåŠ¡å™¨æ ¹æ®è´Ÿè½½æ–¹æ¡ˆå†³å®šæŠŠæ¶ˆæ¯å‘ç»™ä¸€ä¸ªæŒ‡å®šçš„consumerå¤„ç†ã€‚workä¸»è¦æœ‰ä¸¤ç§æ¨¡å¼ï¼š</p><blockquote><ul><li><strong>è½®è¯¢åˆ†å‘</strong>ï¼šä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ä¸€æ¡ï¼Œ<strong>æŒ‰å‡åˆ†é…</strong>ï¼Œwoekæ¨¡å¼ä¸‹é»˜è®¤æ˜¯é‡‡ç”¨è½®è¯¢åˆ†å‘æ–¹å¼ã€‚æ¯”è¾ƒç®€å•ï¼Œæ¯”å¦‚ç”Ÿäº§è´¹è€…å‘é€äº†6æ¡æ¶ˆæ¯åˆ°é˜Ÿåˆ—ä¸­ï¼Œå¦‚æœæœ‰3ä¸ªæ¶ˆè´¹è€…åŒæ—¶ç›‘å¬ç€è¿™ä¸€ä¸ªé˜Ÿåˆ—ï¼Œé‚£ä¹ˆè¿™3ä¸ªæ¶ˆè´¹è€…æ¯äººå°±ä¼šåˆ†å¾—2æ¡æ¶ˆæ¯ã€‚</li><li>å…¬å¹³åˆ†å‘<strong>ï¼šæ ¹æ®æ¶ˆè´¹è€…çš„æ¶ˆè´¹èƒ½åŠ›è¿›è¡Œå…¬å¹³åˆ†å‘ï¼Œå¤„ç†å¾—å¿«çš„åˆ†å¾—å¤šï¼Œå¤„ç†çš„æ…¢çš„åˆ†å¾—å°‘ï¼Œ</strong>èƒ½è€…å¤šåŠ³ã€‚</li></ul></blockquote></li><li><p>éšæ‚£ï¼šé«˜å¹¶å‘æƒ…å†µä¸‹,é»˜è®¤ä¼šäº§ç”ŸæŸä¸€ä¸ªæ¶ˆæ¯è¢«å¤šä¸ªæ¶ˆè´¹è€…å…±åŒä½¿ç”¨,å¯ä»¥è®¾ç½®ä¸€ä¸ªå¼€å…³(syncronize) ä¿è¯ä¸€æ¡æ¶ˆæ¯åªèƒ½è¢«ä¸€ä¸ªæ¶ˆè´¹è€…ä½¿ç”¨ã€‚</p></li></ul><h2 id="3-publish-x2F-subscribeå‘å¸ƒè®¢é˜…-å…±äº«èµ„æº"><a href="#3-publish-x2F-subscribeå‘å¸ƒè®¢é˜…-å…±äº«èµ„æº" class="headerlink" title="3. publish&#x2F;subscribeå‘å¸ƒè®¢é˜…(å…±äº«èµ„æº)"></a>3. publish&#x2F;subscribeå‘å¸ƒè®¢é˜…(å…±äº«èµ„æº)</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223121109.png"></p><ul><li><p>typeä¸º**â€fanoutâ€** çš„exchange</p></li><li><p>æ¯ä¸ªæ¶ˆè´¹è€…ç›‘å¬è‡ªå·±çš„é˜Ÿåˆ—ï¼› ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘ç»™brokerï¼Œç”±äº¤æ¢æœºå°†æ¶ˆæ¯è½¬å‘åˆ°ç»‘å®šæ­¤äº¤æ¢æœºçš„æ¯ä¸ªé˜Ÿåˆ—ï¼Œæ¯ä¸ªç»‘å®šäº¤æ¢æœºçš„é˜Ÿåˆ—éƒ½å°†æ¥æ”¶åˆ°æ¶ˆæ¯ã€‚</p></li><li><p>ä»£ç </p><ul><li><p>producer:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.FANOUT);<br>channel.basicPublish(EXCHANGE_NAME, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-keyword">null</span>, message.getBytes(StandardCharsets.UTF_8));<br></code></pre></td></tr></table></figure></li><li><p>consumer:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">channel.exchangeDeclare(EXCHANGE_NAME, <span class="hljs-string">&quot;fanout&quot;</span>);<br>channel.queueDeclare(<span class="hljs-string">&quot;queue1&quot;</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">null</span>);<br>channel.queueBind(<span class="hljs-string">&quot;queue1&quot;</span>, EXCHANGE_NAME, <span class="hljs-string">&quot;&quot;</span>);<br></code></pre></td></tr></table></figure></li></ul></li></ul><h2 id="4-Routingè·¯ç”±æ¨¡å¼"><a href="#4-Routingè·¯ç”±æ¨¡å¼" class="headerlink" title="4. Routingè·¯ç”±æ¨¡å¼"></a><strong>4. Routingè·¯ç”±æ¨¡å¼</strong></h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223131996.png" alt="image-20230228223131996"></p><ul><li><p>typeä¸ºâ€<strong>direct</strong>â€ çš„exchange</p></li><li><p>æ ¹æ®routing_key è¿›è¡ŒåŒ¹é…ï¼Œç”Ÿäº§è€…ï¼Œå‘é€æ¶ˆæ¯çš„æ—¶å€™ä¼šåˆ¶å®šrouting_keyï¼Œäº¤æ¢æœºæ ¹æ®routing_keyï¼Œå»åŒ¹é…ç»‘å®šæ”¹routing_keyçš„é˜Ÿåˆ—,åªèƒ½åŒ¹é…ä¸Šè·¯ç”±keyå¯¹åº” çš„æ¶ˆæ¯é˜Ÿåˆ—,å¯¹åº”çš„æ¶ˆè´¹è€…æ‰èƒ½æ¶ˆè´¹æ¶ˆæ¯</p></li><li><p>ä»£ç </p><ul><li><p>producer:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">channel.exchangeDeclare(DIRECT_EXCHANGE_NAME, BuiltinExchangeType.DIRECT);<br>channel.basicPublish(DIRECT_EXCHANGE_NAME, ROUTING_KEY, <span class="hljs-keyword">null</span>,message.getBytes(StandardCharsets.UTF_8));<br></code></pre></td></tr></table></figure></li><li><p>consumer:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">channel.exchangeDeclare(DIRECT_EXCHANGE_NAME, BuiltinExchangeType.DIRECT);<br>channel.queueDeclare(DIRECT_QUEUE_NAME, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">null</span>);<br>channel.queueBind(DIRECT_QUEUE_NAME, DIRECT_EXCHANGE_NAME, ROUTING_KEY);<br></code></pre></td></tr></table></figure></li></ul></li></ul><h2 id="5-topic-ä¸»é¢˜æ¨¡å¼-è·¯ç”±æ¨¡å¼çš„ä¸€ç§"><a href="#5-topic-ä¸»é¢˜æ¨¡å¼-è·¯ç”±æ¨¡å¼çš„ä¸€ç§" class="headerlink" title="5.topic ä¸»é¢˜æ¨¡å¼(è·¯ç”±æ¨¡å¼çš„ä¸€ç§)"></a><strong>5.topic ä¸»é¢˜æ¨¡å¼(è·¯ç”±æ¨¡å¼çš„ä¸€ç§)</strong></h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223142678.png"></p><ul><li><p>typeä¸ºâ€<strong>topic</strong>â€œ çš„exchange</p></li><li><p>äº¤æ¢æœºæ ¹æ®keyçš„è§„åˆ™æ¨¡ç³ŠåŒ¹é…åˆ°å¯¹åº”çš„é˜Ÿåˆ—ï¼Œç”±é˜Ÿåˆ—çš„ç›‘å¬æ¶ˆè´¹è€…æ¥æ”¶æ¶ˆæ¯æ¶ˆè´¹ã€‚ç±»ä¼¼sqlçš„æ¨¡ç³ŠåŒ¹é…</p></li><li><p>* ä»£è¡¨ä¸€ä¸ªå…·ä½“çš„å•è¯ã€‚# ä»£è¡¨0ä¸ªæˆ–å¤šä¸ªå•è¯</p></li><li><p>ä»£ç </p><ul><li><p>producer:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">channel.exchangeDeclare(TOPIC_EXCHANGE, BuiltinExchangeType.TOPIC);<br>String message = <span class="hljs-string">&quot;hello world topic!&quot;</span>;<br>channel.basicPublish(TOPIC_EXCHANGE, <span class="hljs-string">&quot;hello.info&quot;</span>, <span class="hljs-keyword">null</span>, message.getBytes(StandardCharsets.UTF_8));<br></code></pre></td></tr></table></figure></li><li><p>consumer:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ROUTING_KEY = <span class="hljs-string">&quot;*.info&quot;</span>;<br>channel.exchangeDeclare(TOPIC_EXCHANGE, BuiltinExchangeType.TOPIC);<br>channel.queueDeclare(TOPIC_QUEUE_1, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">null</span>);<br>channel.queueBind(TOPIC_QUEUE_1, TOPIC_EXCHANGE, ROUTING_KEY);<br></code></pre></td></tr></table></figure></li></ul></li></ul><h2 id="6-RPCæ¨¡å¼-è·¯ç”±æ¨¡å¼çš„ä¸€ç§"><a href="#6-RPCæ¨¡å¼-è·¯ç”±æ¨¡å¼çš„ä¸€ç§" class="headerlink" title="6. RPCæ¨¡å¼(è·¯ç”±æ¨¡å¼çš„ä¸€ç§)"></a>6. RPCæ¨¡å¼(è·¯ç”±æ¨¡å¼çš„ä¸€ç§)</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223151956.png" alt="image-20230228223151956"></p><p>å®ç°ä¸åŒæœåŠ¡é—´çš„è¿œç¨‹è°ƒç”¨ã€‚ springCloud feign</p><h2 id="7-Publisher-Confirms-å‘é€è€…æ¶ˆæ¯ç¡®è®¤"><a href="#7-Publisher-Confirms-å‘é€è€…æ¶ˆæ¯ç¡®è®¤" class="headerlink" title="7. Publisher Confirms å‘é€è€…æ¶ˆæ¯ç¡®è®¤"></a>7. Publisher Confirms <strong>å‘é€è€…æ¶ˆæ¯ç¡®è®¤</strong></h2><ul><li><p>è¿™ä¸ªæ¨¡å—å°±æ˜¯é€šè¿‡ç»™å‘é€è€…æä¾›ä¸€äº›ç¡®è®¤æœºåˆ¶ï¼Œæ¥ä¿è¯è¿™ä¸ªæ¶ˆæ¯å‘é€çš„è¿‡ç¨‹æ˜¯æˆåŠŸçš„</p></li><li><p>å‘é€è€…ç¡®è®¤æ¨¡å¼é»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦å¼€å¯å‘é€è€…ç¡®è®¤æ¨¡å¼ï¼Œéœ€è¦æ‰‹åŠ¨åœ¨channelä¸­è¿›è¡Œå£°æ˜</p><p> <code>channel.confirmSelect() </code></p></li><li><p>åœ¨å®˜ç½‘çš„ç¤ºä¾‹ä¸­ï¼Œé‡ç‚¹è§£é‡Šäº†ä¸‰ç§ç­–ç•¥</p><ul><li><p><strong>1. å‘å¸ƒå•æ¡æ¶ˆæ¯</strong></p><p>channel.waitForConfirmsOrDie(5_000);è¿™ä¸ªæ–¹æ³•å°±ä¼šåœ¨channelç«¯ç­‰å¾…RabbitMQç»™å‡ºä¸€ä¸ªå“åº”ï¼Œç”¨æ¥è¡¨æ˜è¿™ä¸ªæ¶ˆæ¯å·²ç»æ­£ç¡®å‘é€åˆ°äº†RabbitMQæœåŠ¡ç«¯ã€‚ä½†æ˜¯è¦æ³¨æ„ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåŒæ­¥é˜»å¡channelï¼Œåœ¨ç­‰å¾…ç¡®è®¤æœŸé—´ï¼Œchannelå°†ä¸èƒ½å†ç»§ç»­å‘é€æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šæ˜æ˜¾é™ä½é›†ç¾¤çš„å‘é€é€Ÿåº¦å³ååé‡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">while</span> (thereAreMessagesToPublish()) &#123;<br>    <span class="hljs-keyword">byte</span>[] body = ...;<br>    BasicProperties properties = ...;<br>    channel.basicPublish(exchange, queue, properties, body);<br>    <span class="hljs-comment">// uses a 5 second timeout</span><br>    channel.waitForConfirmsOrDie(<span class="hljs-number">5_000</span>);<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><strong>2. å‘é€æ‰¹é‡æ¶ˆæ¯</strong></p><p>ä¹‹å‰å•æ¡ç¡®è®¤çš„æœºåˆ¶ä¼šå¯¹ç³»ç»Ÿçš„ååé‡é€ æˆå¾ˆå¤§çš„å½±å“ï¼Œæ‰€ä»¥ç¨å¾®ä¸­å’Œä¸€ç‚¹çš„æ–¹å¼å°±æ˜¯å‘é€ä¸€æ‰¹æ¶ˆæ¯åï¼Œå†ä¸€èµ·ç¡®è®¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">int</span> batchSize = <span class="hljs-number">100</span>;<br><span class="hljs-keyword">int</span> outstandingMessageCount = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span> (thereAreMessagesToPublish()) &#123;<br>    <span class="hljs-keyword">byte</span>[] body = ...;<br>    BasicProperties properties = ...;<br>    channel.basicPublish(exchange, queue, properties, body);<br>    outstandingMessageCount++;<br>    <span class="hljs-keyword">if</span> (outstandingMessageCount == batchSize) &#123;<br>        channel.waitForConfirmsOrDie(<span class="hljs-number">5_000</span>);<br>        outstandingMessageCount = <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span> (outstandingMessageCount &gt; <span class="hljs-number">0</span>) &#123;<br>    channel.waitForConfirmsOrDie(<span class="hljs-number">5_000</span>);<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><strong>3. å¼‚æ­¥ç¡®è®¤æ¶ˆæ¯</strong></p><p>Produceråœ¨channelä¸­æ³¨å†Œç›‘å¬å™¨æ¥å¯¹æ¶ˆæ¯è¿›è¡Œç¡®è®¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">channel.addConfirmListener(ConfirmCallback var1, ConfirmCallback var2); <br></code></pre></td></tr></table></figure><p>å‘é€è€…åœ¨å‘é€å®Œæ¶ˆæ¯åï¼Œå°±ä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªç›‘å¬å™¨callback1ï¼Œç„¶åç­‰æœåŠ¡ç«¯å‘è¿‡æ¥çš„åé¦ˆåï¼Œå†æ‰§è¡Œç¬¬äºŒä¸ªç›‘å¬å™¨callback2</p></li></ul></li></ul><h2 id="å¸¸ç”¨çš„å››ç§äº¤æ¢å™¨ï¼š"><a href="#å¸¸ç”¨çš„å››ç§äº¤æ¢å™¨ï¼š" class="headerlink" title="å¸¸ç”¨çš„å››ç§äº¤æ¢å™¨ï¼š"></a>å¸¸ç”¨çš„å››ç§äº¤æ¢å™¨ï¼š</h2><ul><li><p>fanoutï¼šå¦‚æœäº¤æ¢å™¨æ”¶åˆ°æ¶ˆæ¯ï¼Œå°†ä¼šå¹¿æ’­åˆ°æ‰€æœ‰ç»‘å®šçš„é˜Ÿåˆ—ä¸Š </p></li><li><p>directï¼šå¦‚æœè·¯ç”±é”®å®Œå…¨åŒ¹é…ï¼Œæ¶ˆæ¯å°±è¢«æŠ•é€’åˆ°ç›¸åº”çš„é˜Ÿåˆ— </p></li><li><p>topicï¼šå¯ä»¥ä½¿æ¥è‡ªä¸åŒæºå¤´çš„æ¶ˆæ¯èƒ½å¤Ÿåˆ°è¾¾åŒä¸€ä¸ªé˜Ÿåˆ—ã€‚ ä½¿ç”¨ topic äº¤æ¢å™¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œ * ä»£è¡¨ä¸€ä¸ªå…·ä½“çš„å•è¯ã€‚# ä»£è¡¨0ä¸ªæˆ–å¤šä¸ªå•è¯</p></li><li><p>header: ä¸å¤„ç†è·¯ç”±é”®ï¼Œæ ¹æ®å‘é€çš„æ¶ˆæ¯å†…å®¹ä¸­çš„headerså±æ€§è¿›è¡ŒåŒ¹é…</p></li></ul><h2 id="æ¶ˆæ¯çš„åˆ†å‘ç­–ç•¥"><a href="#æ¶ˆæ¯çš„åˆ†å‘ç­–ç•¥" class="headerlink" title="æ¶ˆæ¯çš„åˆ†å‘ç­–ç•¥"></a>æ¶ˆæ¯çš„åˆ†å‘ç­–ç•¥</h2><ul><li><p>æ¶ˆæ¯çš„åˆ†å‘ç­–ç•¥</p><p>  å‡è®¾é˜Ÿåˆ—é‡Œæœ‰100æ¡æ¶ˆæ¯ï¼Œæœ‰ A,B,C   3ä¸ªé˜Ÿåˆ—</p><ul><li>å‘å¸ƒè®¢é˜…ã€‚ä¸‰ä¸ªé˜Ÿåˆ—éƒ½æ”¶åˆ°100æ¡</li><li>è½®è®­åˆ†å‘ã€‚3ä¸ªé˜Ÿåˆ—éƒ½æ˜¯è‡³å°‘33æ¡ï¼Œå‰©ä¸‹ä¸€æ¡éšæœºï¼Œä¸è®ºä½ æ•°æ®åº“æ€§èƒ½æ€ä¹ˆæ ·ï¼Œå¤§å®¶æ¥å—çš„éƒ½æ˜¯å…¬å¹³çš„</li><li>å…¬å¹³åˆ†å‘ã€‚æ ¹æ®æœåŠ¡å™¨æ€§èƒ½ï¼Œå»åˆ†å‘ï¼Œå“ªä¸ªæ€§èƒ½é«˜ï¼Œå“ªä¸ªå¤„ç†çš„æ¶ˆæ¯å¯èƒ½å°±å¤šï¼Œèƒ½è€…å¤šåŠ³ï¼Œä¼šé€ æˆæ•°æ®å€¾æ–œ</li><li>é‡å‘ã€‚å‘é€æ¶ˆæ¯ä¸­å‡ºç°äº†å¼‚å¸¸åï¼Œæ¶ˆæ¯æ²¡æœ‰å¾—åˆ°åº”ç­”ï¼Œå°±ä¼šé‡å‘ï¼Œkafkaä¸æ”¯æŒ</li><li>æ¶ˆæ¯æ‹‰å–ã€‚å°±æ˜¯RPCå»æ‹‰å–æ•°æ®</li></ul><blockquote><p>Rabbitmqä»¥ä¸Šé›†ä¸­ç­–ç•¥éƒ½æ”¯æŒï¼Œä¸”æ˜¯å¼€æºçš„</p><p>kafkaé€Ÿåº¦æœ€å¿«</p></blockquote></li></ul><h2 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h2><ul><li>ä¸­é—´ä»¶<ul><li>æ˜¯ä¸€ç§åº”ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿçš„åŸºç¡€è½¯ä»¶ã€‚</li><li>å¸¸è§çš„ä¸­é—´ä»¶ï¼šmysqlï¼Œrabbit MQ</li></ul></li><li>æ€ä¹ˆé€‰æ‹©ä¸­é—´ä»¶<ul><li>å¯ä»¥é€šä¿¡ï¼Œè·¨å¹³å°ã€‚æ¯”æ–¹ä¸¤ä¸ªé¡¹ç›®ä¸€ä¸ªjavaï¼Œä¸€ä¸ªgoä¹‹é—´è¦é€šä¿¡ï¼Œå°±è¦éµå¾ªåŒä¸€ç§åè®®</li><li>é«˜å¯ç”¨<ul><li>æ˜¯å¦æ‹¥æœ‰æŒä¹…åŒ–ã€‚æ¯”æ–¹ä¸­é—´ä»¶æŒ‚äº†ï¼Œé‡å¯åæ˜¯å¦å¯ä»¥æŠŠæ¶ˆæ¯é‡æ–°å­˜å‚¨èµ·æ¥çš„èƒ½åŠ›</li><li>æ”¯æŒé›†ç¾¤ã€‚ç³»ç»Ÿcpuä¸å¤Ÿç”¨äº†ï¼Œå°±å¾—æ­é›†ç¾¤</li></ul></li><li>æœ‰åˆ†å‘èƒ½åŠ›ï¼Œå¤šä¸ªç³»ç»Ÿï¼Œå¾€é‚£ä¸ªç³»ç»Ÿå»å‘é€æ¶ˆæ¯</li></ul></li></ul><h2 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h2><ul><li><p>ç½‘ç»œåè®®ä¸‰è¦ç´ ï¼š</p><ul><li>è¯­æ³•ï¼šç”¨æˆ·æ•°æ®çš„ç»“æ„ä¸å½¢å¼ï¼Œå¦‚ï¼šhttpä¸­è§„å®šäº†è¯·æ±‚å’Œå“åº”æŠ¥æ–‡çš„æ ¼å¼</li><li>è¯­ä¹‰ï¼šè§„å®šäº†ä½•ç§ä¿¡æ¯éœ€è¦å¯¹åº”å‘å‡ºä½•ç§å“åº”ï¼Œå¦‚ï¼šè¯·æ±‚getè¦æŠŠå‚æ•°æ”¾åœ¨urlä¸­ï¼ŒpostæŠŠå‚æ•°æ”¾åœ¨bodyä¸­</li><li>æ—¶åºï¼šäº‹ä»¶çš„æ‰§è¡Œé¡ºåºï¼Œå¦‚ï¼šå…ˆæœ‰è¯·æ±‚åæœ‰å“åº”</li></ul></li><li><p>ä¸ºä»€ä¹ˆæ¶ˆæ¯ä¸­é—´ä»¶ä¸ç”¨httpï¼Ÿ</p><ul><li>httpçš„è¯·æ±‚å’Œå“åº”æŠ¥æ–‡æ¯”è¾ƒå¤æ‚ï¼Œæœ‰cookie, çŠ¶æ€ç ï¼Œå“åº”ç è¿™äº›ï¼Œä½†æ¶ˆæ¯ä¸­é—´ä»¶ï¼šåªéœ€è¦æ¥å—æ¶ˆæ¯ï¼Œå­˜å‚¨æ¶ˆæ¯ï¼Œåˆ†å‘æ¶ˆæ¯ï¼Œä¸éœ€è¦è¿™ä¹ˆå¤æ‚</li><li>httpå¤§éƒ¨åˆ†æ˜¯çŸ­é“¾æ¥ï¼Œä¸åˆ©äºå‡ºç°æ•…éšœæ—¶æ¶ˆæ¯æŒä¹…åŒ–</li></ul></li><li><p>AMQPï¼ˆadvanced message. Queuing protocolï¼‰ é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®</p><ul><li>é‡‡ç”¨Erlangï¼Œåº•å±‚æ˜¯Cï¼Œé€Ÿåº¦å¾ˆå¿«</li><li>ç‰¹æ€§<ul><li>æ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡</li><li>æ¶ˆæ¯æŒä¹…åŒ–</li><li>é«˜æ€§èƒ½é«˜å¯é çš„æ¶ˆæ¯å¤„ç†ä¼˜åŠ¿</li></ul></li></ul></li><li><p>kafka åè®®</p><ul><li>åŸºäºTCP&#x2F;IPçš„äºŒè¿›åˆ¶åè®®ï¼Œæ¶ˆæ¯å†…éƒ¨ç”±é•¿åº¦åˆ†å‰²ï¼Œç”±åŸºæœ¬æ•°æ®ç±»å‹æ„æˆ</li><li>ç‰¹æ€§<ul><li>ç»“æ„ç®€å•</li><li>è§£æé€Ÿåº¦å¿«</li><li>æ¶ˆæ¯æŒä¹…åŒ–</li><li>ä¸æ”¯æŒäº‹åŠ¡</li></ul></li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>RabbitMQ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¶ˆæ¯ä¸­é—´ä»¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç§’æ€æ¨¡å—å­¦ä¹ </title>
    <link href="/%E7%A7%92%E6%9D%80%E6%A8%A1%E5%9D%97%E9%9D%A2%E8%AF%95%E5%87%86%E5%A4%87/"/>
    <url>/%E7%A7%92%E6%9D%80%E6%A8%A1%E5%9D%97%E9%9D%A2%E8%AF%95%E5%87%86%E5%A4%87/</url>
    
    <content type="html"><![CDATA[<h1 id="ç§’æ€æ¨¡å—"><a href="#ç§’æ€æ¨¡å—" class="headerlink" title="ç§’æ€æ¨¡å—"></a>ç§’æ€æ¨¡å—</h1><h2 id="1-ç§’æ€æ¥å£ä¼˜åŒ–"><a href="#1-ç§’æ€æ¥å£ä¼˜åŒ–" class="headerlink" title="1. ç§’æ€æ¥å£ä¼˜åŒ–"></a>1. ç§’æ€æ¥å£ä¼˜åŒ–</h2><ul><li>ç”¨æˆ·æ˜¯å¦ç™»é™†</li><li>åˆ¤æ–­åº“å­˜ï¼ˆå¤‡ä»½åœ¨redisä¸­ä¸€ä»½ï¼‰<ul><li>åœ¨åˆå§‹åŒ–contolleræ¥å£çš„æ—¶å€™ï¼Œå°±æŠŠå•†å“idå’Œå¯¹åº”çš„åº“å­˜æ•°å­˜å…¥åˆ°redis</li></ul></li><li>åˆ¤æ–­æ˜¯å¦å·²ç»ç§’æ€åˆ°äº†</li><li>å‡ç¼“å­˜ï¼Œ ä¸‹è®¢å•ï¼ˆè®¢å•å’Œç§’æ€è®¢å•ï¼‰<ul><li>é˜Ÿåˆ—é‡Œé¢å­˜çš„æ¶ˆæ¯messageï¼Œæœ‰ä¸¤ä¸ªå˜é‡ç”¨æˆ·å’Œå•†å“id,</li><li>receiverç›‘å¬è¯¥é˜Ÿåˆ—ï¼Œå‡åº“å­˜ï¼Œå‡åº“å­˜æˆåŠŸäº†ï¼Œæ ¹æ®ç”¨æˆ·å’Œå•†å“id,ä¸‹è®¢å•</li><li>contolleréœ€è¦çš„å°±æ˜¯ç»™é˜Ÿåˆ—å‘æ¶ˆæ¯ï¼Œæœ€ç»ˆç»™å‰ç«¯è¿”å›ä¸€ä¸ªçŠ¶æ€å€¼ï¼ˆæ’é˜Ÿä¸­ï¼‰</li></ul></li></ul><span id="more"></span><img src="https://tva1.sinaimg.cn/large/008i3skNly1gwn32zi2y7j30o40n0wfo.jpg" style="zoom: 67%;" /><ul><li>å‰ç«¯è½®è¯¢ï¼šæ˜¯å¦ç”Ÿæˆäº†è®¢å•<ul><li>æŸ¥è¯¢è¯¥ç¬”è®¢å•æ˜¯å¦å­˜åœ¨<ul><li>å­˜åœ¨ï¼Œç”Ÿæˆè®¢å•</li><li>ä¸å­˜åœ¨ï¼ŒæŸ¥çœ‹å•†å“æ˜¯å¦å·²ç»ç§’æ€å®Œäº†ï¼š<ul><li>æ²¡ç§’æ€å®Œï¼Œå°±æ˜¯æ’é˜Ÿä¸­</li><li>å®Œäº†ï¼Œå°±è¿”å›è¯¥å•†å“å·²ç»å–å®Œäº†ï¼Œå¹¶ä¸”åœ¨ç¼“å­˜ä¸­è®°å½•ä¸‹è¯¥å•†å“å·²ç»å”®ç½„äº†ã€‚goods_over+goodsId, true</li></ul></li></ul></li></ul></li></ul><img src="https://tva1.sinaimg.cn/large/008i3skNly1gwn3541p3cj30qk0hkq4d.jpg" style="zoom:50%;" /><h2 id="2-ç§’æ€æ¥å£åœ°å€éšè—"><a href="#2-ç§’æ€æ¥å£åœ°å€éšè—" class="headerlink" title="2. ç§’æ€æ¥å£åœ°å€éšè—:"></a>2. ç§’æ€æ¥å£åœ°å€éšè—:</h2><p>é’ˆå¯¹ä¸åŒçš„ç”¨æˆ·ï¼Œç”Ÿæˆä¸åŒçš„ç§’æ€åœ°å€ï¼Œå³ç§’æ€åœ°å€ä¸Šå¸¦ä¸€ä¸ªå‚æ•°ï¼Œå‚æ•°æ ¹æ®å½“å‰ã€ç”¨æˆ·idï¼Œå•†å“idã€‘éšæœºç”Ÿæˆï¼Œå¹¶ä¿å­˜åœ¨redisä¸­ï¼Œåšç§’æ€çš„æ—¶å€™ï¼Œå…ˆæ£€æŸ¥è¯¥å‚æ•°æ˜¯å¦åŒ¹é…ï¼Œåªæœ‰åŒ¹é…äº†æ‰å¯ä»¥è¿›è¡Œç§’æ€ï¼Œä¸åŒ¹é…æ˜¯éæ³•è¯·æ±‚ã€‚</p><h2 id="3-éªŒè¯ç ç”Ÿæˆ"><a href="#3-éªŒè¯ç ç”Ÿæˆ" class="headerlink" title="3. éªŒè¯ç ç”Ÿæˆ"></a>3. éªŒè¯ç ç”Ÿæˆ</h2><p>ç‚¹å‡»ç§’æ€ä¹‹å‰ï¼Œå…ˆè®©ç”¨æˆ·è¾“å…¥éªŒè¯ç ã€‚æœ‰2ä¸ªç›®çš„ï¼š</p><ul><li>é˜²æ­¢æœºå™¨äºº</li><li>ç”¨æˆ·è¾“å…¥éªŒè¯ç ç»“æœæ—¶é—´ä¸åŒï¼Œå› æ­¤åˆ†æ•£ç”¨æˆ·çš„è¯·æ±‚ã€‚</li></ul><p>å®ç°ï¼š</p><ul><li>ç”Ÿæˆç§’æ€éªŒè¯ç ï¼Œæ”¾åœ¨redisä¸­</li><li>åœ¨ç§’æ€çš„æ—¶å€™ï¼Œå…ˆéªŒè¯éªŒè¯ç ï¼ŒéªŒè¯æˆåŠŸï¼Œåˆ é™¤ke y</li></ul><h2 id="4-æ¥å£é™æµé˜²åˆ·"><a href="#4-æ¥å£é™æµé˜²åˆ·" class="headerlink" title="4. æ¥å£é™æµé˜²åˆ·"></a>4. æ¥å£é™æµé˜²åˆ·</h2><p>æ€è·¯ï¼š</p><p>æŠŠæ¯ä¸ªç”¨æˆ·è®¿é—®æ¥å£çš„æ¬¡æ•°å†™å…¥åˆ°ç¼“å­˜ä¸­ï¼Œå¹¶è®¾ç½®å¤±æ•ˆæ—¶é•¿sï¼Œå› ä¸ºå¯èƒ½æ¯ä¸ªæ–¹æ³•è®¾ç½®çš„å‚æ•°å¯èƒ½ä¸åŒï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æ³¨è§£+æ‹¦æˆªå™¨å®ç°ã€‚</p><p>å®ç°åœ¨ <strong>Controller</strong> å¤„ç†è¯·æ±‚ä¹‹å‰ å…ˆåˆ¤æ–­æ˜¯å¦å·²ç»è¶…è¿‡äº†è®¾ç½®çš„æœ€å¤§è®¿é—®æ¬¡æ•°ã€‚</p><p>å…·ä½“å®ç°ï¼š</p><p>Step1: åœ¨éœ€è¦é˜²åˆ·çš„æ–¹æ³•ä¸ŠåŠ æ³¨è§£annotationï¼Œæ³¨è§£é‡Œè®¾ç½®ä¸¤ä¸ªå‚æ•°æ—¶é—´secondså’Œæœ€å¤§è®¿é—®æ¬¡æ•°maxCount</p><p>Step2: æ·»åŠ æ‹¦æˆªå™¨(Interceptor)ï¼Œåœ¨æ‹¦æˆªå™¨é‡Œå…ˆåˆ¤æ–­è¯¥æ–¹æ³•ä¸Šæ˜¯å¦åŠ äº†å¯¹åº”æ³¨è§£</p><p>Step3: é€šè¿‡requestä¸­å–å¾—çš„method uri, ç”¨æˆ·id å¯ä»¥å¾—åˆ°å½“å‰ç”¨æˆ·è®¿é—®çš„è¯¥æ–¹æ³•çš„æ¬¡æ•°</p><p>step4: å°†è¯¥æ¬¡æ•°å’Œæ³¨è§£é‡Œå­˜çš„æœ€å¤§è®¿é—®æ¬¡æ•°è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹æ˜¯å¦å·²ç»è¶…è¿‡äº†é™åˆ¶çš„æœ€å¤§æ¬¡æ•°</p><p>Step5: redisä¸­å­˜æ”¾çš„keyè®¾ç½®æœ€å¤§è¿‡æœŸæ—¶é—´ä¸ºæ³¨è§£çš„æ—¶é—´</p><p>Step5: æ³¨å†Œè¯¥æ‹¦æˆªå™¨</p><h2 id="5-åˆ†å¸ƒå¼session"><a href="#5-åˆ†å¸ƒå¼session" class="headerlink" title="5. åˆ†å¸ƒå¼session"></a>5. åˆ†å¸ƒå¼session</h2><p>ç”¨æˆ·ç™»é™†æˆåŠŸåï¼Œç»™ç”¨æˆ·ç”Ÿæˆä¸€ä¸ªsession_idæ ‡è¯†è¿™ä¸ªç”¨æˆ·ï¼Œå†™åœ¨å®¢æˆ·ç«¯cookieä¸­ï¼Œå®¢æˆ·ç«¯è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ä¼šå¸¦ä¸Šcookieï¼ŒæœåŠ¡ç«¯åœ¨å¤„ç†çš„æ—¶å€™ï¼Œä¼šä»cookieä¸­è§£ç å‡ºsession_idï¼Œä»è€Œå–åˆ°ç”¨æˆ·ä¿¡æ¯ã€‚</p><hr/><h2 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åˆ†å¸ƒå¼Session"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åˆ†å¸ƒå¼Session" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åˆ†å¸ƒå¼Session"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åˆ†å¸ƒå¼Session</h2><p>Webåº”ç”¨åœ¨å•æœºéƒ¨ç½²çš„æƒ…å†µä¸‹ï¼ŒSessionæ˜¯è¢«å•ä¸ªåº”ç”¨æœåŠ¡å™¨å­˜å‚¨ç®¡ç†çš„ï¼Œç”±äºåªæœ‰ä¸€ä¸ªåº”ç”¨æœåŠ¡å™¨ï¼Œç”¨æˆ·çš„æ‰€æœ‰è¯·æ±‚éƒ½æ˜¯é€šè¿‡å®ƒè¿›è¡Œå“åº”å¤„ç†çš„ï¼Œæ‰€ä»¥èƒ½å¤Ÿå¾ˆå®¹æ˜“å®ç°ä¼šè¯è·Ÿè¸ªå’Œä¿æŒã€‚éšç€ä¸šåŠ¡é‡çš„å¢é•¿ï¼Œç³»ç»Ÿæ¶æ„éœ€è¦åšå‡ºè°ƒæ•´ä»¥é€‚åº”å‘å±•çš„éœ€è¦ï¼Œå¯èƒ½ä¼šä½¿ç”¨åˆ†å¸ƒå¼æ¶æ„æˆ–å¾®æœåŠ¡æ¶æ„ï¼Œæ— è®ºä½¿ç”¨å“ªç§æ¶æ„æ–¹å¼ï¼Œåº”ç”¨ç³»ç»Ÿå•æœºéƒ¨ç½²çš„æ¨¡å¼å·²ç»ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œæ‰€ä»¥ä¼šå°†åº”ç”¨ç³»ç»Ÿéƒ¨ç½²åˆ°å¤šå°åº”ç”¨æœåŠ¡å™¨ä¸Šï¼Œç”¨æˆ·çš„è¯·æ±‚ä¹Ÿä¼šé€šè¿‡è´Ÿè½½å‡è¡¡è½¬å‘åˆ°æŸä¸ªå…·ä½“åº”ç”¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œå¯èƒ½ä¼šå‡ºç°åœ¨A1ç³»ç»Ÿç™»å½•ååˆ›å»ºå¹¶ä¿å­˜Sessionï¼Œå†æ¬¡å‘èµ·è¯·æ±‚ï¼Œè¯·æ±‚è¢«è½¬å‘åˆ°A2ç³»ç»Ÿä¸Šæ˜¾ç¤ºæœªç™»å½•çš„æƒ…å†µï¼Œæ­¤æ—¶å•æœºéƒ¨ç½²æ¨¡å¼ä¸‹çš„Sessionæœºåˆ¶å·²ä¸èƒ½æ»¡è¶³è¦æ±‚ã€‚æ‰€ä»¥ï¼Œåœ¨åˆ†å¸ƒå¼æ¶æ„æˆ–å¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œå¿…é¡»ä¿è¯ä¸€ä¸ªåº”ç”¨æœåŠ¡å™¨ä¸Šä¿å­˜Sessionåï¼Œå…¶å®ƒåº”ç”¨æœåŠ¡å™¨å¯ä»¥åŒæ­¥æˆ–å…±äº«è¿™ä¸ªSessionã€‚</p><h2 id="åˆ†å¸ƒå¼sessionç®¡ç†å®ç°æ–¹æ¡ˆ"><a href="#åˆ†å¸ƒå¼sessionç®¡ç†å®ç°æ–¹æ¡ˆ" class="headerlink" title="åˆ†å¸ƒå¼sessionç®¡ç†å®ç°æ–¹æ¡ˆ"></a>åˆ†å¸ƒå¼sessionç®¡ç†å®ç°æ–¹æ¡ˆ</h2><p>åˆ†å¸ƒå¼Sessionæœ‰å¦‚ä¸‹å‡ ç§å®ç°æ–¹å¼ã€‚</p><h2 id="1-Sessionå¤åˆ¶"><a href="#1-Sessionå¤åˆ¶" class="headerlink" title="1.Sessionå¤åˆ¶"></a>1.Sessionå¤åˆ¶</h2><p>åœ¨æ”¯æŒSessionå¤åˆ¶çš„WebæœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡ä¿®æ”¹WebæœåŠ¡å™¨çš„é…ç½®ï¼Œå¯ä»¥å®ç°å°†SessionåŒæ­¥åˆ°å…¶å®ƒWebæœåŠ¡å™¨ä¸Šï¼Œè¾¾åˆ°æ¯ä¸ªWebæœåŠ¡å™¨ä¸Šéƒ½ä¿å­˜ä¸€è‡´çš„Sessionã€‚<br>ä¼˜ç‚¹ï¼šä»£ç ä¸Šä¸éœ€è¦åšæ”¯æŒå’Œä¿®æ”¹ã€‚<br>ç¼ºç‚¹ï¼šéœ€è¦ä¾èµ–æ”¯æŒçš„WebæœåŠ¡å™¨ï¼Œä¸€æ—¦æ›´æ¢æˆä¸æ”¯æŒçš„WebæœåŠ¡å™¨å°±ä¸èƒ½ä½¿ç”¨äº†ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å†µä¸‹ä¸ä»…å ç”¨ç½‘ç»œèµ„æºï¼Œè€Œä¸”ä¼šå¯¼è‡´å»¶è¿Ÿã€‚<br>é€‚ç”¨åœºæ™¯ï¼šåªé€‚ç”¨äºWebæœåŠ¡å™¨æ¯”è¾ƒå°‘ä¸”Sessionæ•°æ®é‡å°‘çš„æƒ…å†µã€‚<br>å¯ç”¨æ–¹æ¡ˆï¼šå¼€æºæ–¹æ¡ˆtomcat-redis-session-managerï¼Œæš‚ä¸æ”¯æŒTomcat8ã€‚</p><h2 id="2-Sessionç²˜æ»"><a href="#2-Sessionç²˜æ»" class="headerlink" title="2.Sessionç²˜æ»"></a>2.Sessionç²˜æ»</h2><p>å°†ç”¨æˆ·çš„æ¯æ¬¡è¯·æ±‚éƒ½é€šè¿‡æŸç§æ–¹æ³•å¼ºåˆ¶åˆ†å‘åˆ°æŸä¸€ä¸ªWebæœåŠ¡å™¨ä¸Šï¼Œåªè¦è¿™ä¸ªWebæœåŠ¡å™¨ä¸Šå­˜å‚¨äº†å¯¹åº”Sessionæ•°æ®ï¼Œå°±å¯ä»¥å®ç°ä¼šè¯è·Ÿè¸ªã€‚<br>ä¼˜ç‚¹ï¼šä½¿ç”¨ç®€å•ï¼Œæ²¡æœ‰é¢å¤–å¼€é”€ã€‚<br>ç¼ºç‚¹ï¼šä¸€æ—¦æŸä¸ªWebæœåŠ¡å™¨é‡å¯æˆ–å®•æœºï¼Œç›¸å¯¹åº”çš„Sessionæ•°æ®å°†ä¼šä¸¢å¤±ï¼Œè€Œä¸”éœ€è¦ä¾èµ–è´Ÿè½½å‡è¡¡æœºåˆ¶ã€‚<br>é€‚ç”¨åœºæ™¯ï¼šå¯¹ç¨³å®šæ€§è¦æ±‚ä¸æ˜¯å¾ˆé«˜çš„ä¸šåŠ¡æƒ…æ™¯ã€‚</p><h2 id="3-Sessioné›†ä¸­ç®¡ç†"><a href="#3-Sessioné›†ä¸­ç®¡ç†" class="headerlink" title="3.Sessioné›†ä¸­ç®¡ç†"></a>3.Sessioné›†ä¸­ç®¡ç†</h2><p>åœ¨å•ç‹¬çš„æœåŠ¡å™¨æˆ–æœåŠ¡å™¨é›†ç¾¤ä¸Šä½¿ç”¨ç¼“å­˜æŠ€æœ¯ï¼Œå¦‚Rediså­˜å‚¨Sessionæ•°æ®ï¼Œé›†ä¸­ç®¡ç†æ‰€æœ‰çš„Sessionï¼Œæ‰€æœ‰çš„WebæœåŠ¡å™¨éƒ½ä»è¿™ä¸ªå­˜å‚¨ä»‹è´¨ä¸­å­˜å–å¯¹åº”çš„Sessionï¼Œå®ç°Sessionå…±äº«ã€‚<br>ä¼˜ç‚¹ï¼šå¯é æ€§é«˜ï¼Œå‡å°‘WebæœåŠ¡å™¨çš„èµ„æºå¼€é”€ã€‚<br>ç¼ºç‚¹ï¼šå®ç°ä¸Šæœ‰äº›å¤æ‚ï¼Œé…ç½®è¾ƒå¤šã€‚<br>é€‚ç”¨åœºæ™¯ï¼šWebæœåŠ¡å™¨è¾ƒå¤šã€è¦æ±‚é«˜å¯ç”¨æ€§çš„æƒ…å†µã€‚<br>å¯ç”¨æ–¹æ¡ˆï¼šå¼€æºæ–¹æ¡ˆSpring Sessionï¼Œä¹Ÿå¯ä»¥è‡ªå·±å®ç°ï¼Œä¸»è¦æ˜¯é‡å†™HttpServletRequestWrapperä¸­çš„getSessionæ–¹æ³•ï¼Œåšä¸»ä¹ŸåŠ¨æ‰‹å†™äº†ä¸€ä¸ªï¼Œgithubæœç´¢joincatç”¨æˆ·ï¼Œç„¶åè‡ªå–ã€‚</p><h2 id="4-åŸºäºCookieç®¡ç†"><a href="#4-åŸºäºCookieç®¡ç†" class="headerlink" title="4.åŸºäºCookieç®¡ç†"></a>4.åŸºäºCookieç®¡ç†</h2><p>è¿™ç§æ–¹å¼æ¯æ¬¡å‘èµ·è¯·æ±‚çš„æ—¶å€™éƒ½éœ€è¦å°†Sessionæ•°æ®æ”¾åˆ°Cookieä¸­ä¼ é€’ç»™æœåŠ¡ç«¯ã€‚<br>ä¼˜ç‚¹ï¼šä¸éœ€è¦ä¾èµ–é¢å¤–å¤–éƒ¨å­˜å‚¨ï¼Œä¸éœ€è¦é¢å¤–é…ç½®ã€‚<br>ç¼ºç‚¹ï¼šä¸å®‰å…¨ï¼Œæ˜“è¢«ç›—å–æˆ–ç¯¡æ”¹ï¼›Cookieæ•°é‡å’Œé•¿åº¦æœ‰é™åˆ¶ï¼Œéœ€è¦æ¶ˆè€—æ›´å¤šç½‘ç»œå¸¦å®½ã€‚<br>é€‚ç”¨åœºæ™¯ï¼šæ•°æ®ä¸é‡è¦ã€ä¸æ•æ„Ÿä¸”æ•°æ®é‡å°çš„æƒ…å†µã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™å››ç§æ–¹å¼ï¼Œç›¸å¯¹æ¥è¯´ï¼ŒSessioné›†sç®¡ç†æ›´åŠ å¯é ï¼Œä½¿ç”¨ä¹Ÿæ˜¯æœ€å¤šçš„ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨Spockæ¡†æ¶ç¼–å†™æµ‹è¯•ä»£ç </title>
    <link href="/%E4%BD%BF%E7%94%A8Spock%E6%A1%86%E6%9E%B6%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81/"/>
    <url>/%E4%BD%BF%E7%94%A8Spock%E6%A1%86%E6%9E%B6%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<h2 id="Spock-ä»‹ç»"><a href="#Spock-ä»‹ç»" class="headerlink" title="Spock ä»‹ç»"></a>Spock ä»‹ç»</h2><blockquote><ul><li><p>Spockæ˜¯ä¸€ä¸ªä¸ºgroovyå’Œjavaè¯­è¨€åº”ç”¨ç¨‹åºæ¥æµ‹è¯•å’Œè§„èŒƒçš„æ¡†æ¶ã€‚</p></li><li><p>è¿™ä¸ªæ¡†æ¶çš„çªå‡ºç‚¹åœ¨äºå®ƒç¾å¦™å’Œé«˜æ•ˆè¡¨è¾¾è§„èŒƒçš„è¯­è¨€ã€‚</p></li><li><p>å¾—ç›ŠäºJUnit runnerï¼ŒSpockèƒ½å¤Ÿåœ¨å¤§å¤šæ•°IDEã€ç¼–è¯‘å·¥å…·ã€æŒç»­é›†æˆæœåŠ¡ä¸‹å·¥ä½œã€‚</p></li><li><p>Spockçš„çµæ„ŸæºäºJUnit,jMock, RSpec, Groovy, Scala, Vulcansä»¥åŠå…¶ä»–ä¼˜ç§€çš„æ¡†æ¶å½¢æ€ã€‚</p></li></ul></blockquote><h2 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h2><ul><li>a simple assertion</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> <span class="hljs-string">&quot;should be a simple assertion&quot;</span>() &#123;<br>    <span class="hljs-symbol">expect:</span><br>    <span class="hljs-number">1</span> == <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure><span id="more"></span><ul><li>given when then ä½¿ç”¨</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> <span class="hljs-string">&quot;should demo given-when-then&quot;</span>()&#123;<br>     <span class="hljs-symbol">given:</span><br>     <span class="hljs-keyword">def</span> user = <span class="hljs-keyword">new</span> Polygon(<span class="hljs-number">10</span>)<br><br>     <span class="hljs-symbol">when:</span><br>     <span class="hljs-keyword">int</span> age = user.numberOfSides<br><br>     <span class="hljs-symbol">then:</span><br>     age == <span class="hljs-number">10</span><br> &#125;<br></code></pre></td></tr></table></figure><ul><li>expecting exceptions</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> <span class="hljs-string">&quot;should expect exceptions&quot;</span>()&#123;<br>     <span class="hljs-symbol">when:</span><br>     <span class="hljs-keyword">new</span> Polygon(<span class="hljs-number">0</span>)<br><br>     <span class="hljs-symbol">then:</span><br>     thrown(TooFewSidesException)<br> &#125;<br></code></pre></td></tr></table></figure><ul><li>data pipes.     whereè®¾ç½®æ‰€æœ‰æœŸæœ›å€¼</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> <span class="hljs-string">&quot;should expect an exception to be throw for a number of invalid inputs&quot;</span>()&#123;<br>       <span class="hljs-symbol">when:</span><br>       <span class="hljs-keyword">new</span> Polygon(sides)<br><br>       <span class="hljs-symbol">then:</span><br>       thrown(TooFewSidesException)<br><br>       <span class="hljs-comment">//The where block says &quot;run this test with each of the following values: a negative value, zero, one and two&quot;.</span><br>       <span class="hljs-comment">// whereè®¾ç½®æ‰€æœ‰æœŸæœ›å€¼</span><br>       <span class="hljs-symbol">where:</span><br>       sides &lt;&lt; [<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]<br>   &#125;<br></code></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> <span class="hljs-string">&quot;should be able to create polygon with valid inputs&quot;</span>()&#123;<br>      <span class="hljs-symbol">expect:</span><br>      <span class="hljs-keyword">new</span> Polygon(sides).numberOfSides == sides<br><br>      <span class="hljs-comment">//The where block says &quot;run this test with each of the following values: a negative value, zero, one and two&quot;.</span><br>      <span class="hljs-symbol">where:</span><br>      sides &lt;&lt; [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]<br>  &#125;<br></code></pre></td></tr></table></figure><ul><li>data tables</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> <span class="hljs-string">&quot;should use data tables for calculating max&quot;</span>()&#123;<br>      <span class="hljs-comment">// å¦‚æœæˆ‘ä»¬åªæœ‰ä¸€æ¡è¯­å¥è®¾ç½®äº†æµ‹è¯•å’Œæ–­è¨€ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨`expect`æ ‡ç­¾</span><br>      <span class="hljs-symbol">expect:</span><br>      Math.max(a,b) == max<br><br>      <span class="hljs-symbol">where:</span><br>      a | b | max<br>      <span class="hljs-number">1</span> | <span class="hljs-number">2</span> | <span class="hljs-number">2</span><br>      <span class="hljs-number">3</span> | <span class="hljs-number">4</span> | <span class="hljs-number">4</span><br>      <span class="hljs-number">5</span> | <span class="hljs-number">9</span> | <span class="hljs-number">9</span><br>  &#125;<br></code></pre></td></tr></table></figure><ul><li>mocks æ¨¡æ‹Ÿå‡ºç±»æˆ–APIæ¥å£°æ˜é¢„æœŸçš„è¡Œä¸º</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> <span class="hljs-string">&quot;should be able to mock a specific class&quot;</span>() &#123;<br>        <span class="hljs-symbol">given:</span><br>        Renderer renderer = Mock()<br><br>        <span class="hljs-comment">//@Subjectåªæ˜¯ä¸ºäº†æ ‡è®°æˆ‘ä»¬æ­£åœ¨æµ‹è¯•çš„å¯¹è±¡ï¼Œå¯¹ä»£ç æ²¡æœ‰ä»»ä½•å½±å“</span><br>        <span class="hljs-meta">@Subject</span><br>        <span class="hljs-keyword">def</span> ploygon = <span class="hljs-keyword">new</span> Polygon(<span class="hljs-number">4</span>, renderer)<br><br>        <span class="hljs-symbol">when:</span><br>        ploygon.draw()<br><br>        <span class="hljs-symbol">then:</span><br>        <span class="hljs-number">4</span> * renderer.drawLine()<br>    &#125;<br></code></pre></td></tr></table></figure><ul><li>stubs åœ¨æµ‹è¯•çš„ä»£ç é‡Œæä¾›æ•°æ®æˆ–è€…å€¼</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> <span class="hljs-string">&quot;should be able to create a stubs&quot;</span>() &#123;<br>       <span class="hljs-symbol">given:</span><br>       Palette palette = Stub()<br>       palette.getPrimaryColor() &gt;&gt; Color.red<br><br>       <span class="hljs-keyword">def</span> renderer =  <span class="hljs-keyword">new</span> Renderer(palette)<br><br>       <span class="hljs-symbol">expect:</span><br>       renderer.getForeGroundColor() == Color.red<br>   &#125;<br></code></pre></td></tr></table></figure><ul><li>help methods</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> <span class="hljs-string">&quot;should use a helper methods&quot;</span>() &#123;<br>    <span class="hljs-symbol">given:</span><br>    Renderer renderer = Mock()<br>    <span class="hljs-keyword">def</span> shapeFactory = <span class="hljs-keyword">new</span> ShapeFactory(renderer)<br><br>    <span class="hljs-symbol">when:</span><br>    <span class="hljs-keyword">def</span> polygon = shapeFactory.createDefaultPolygon()<br><br>    <span class="hljs-symbol">then:</span><br>    checkDefaultShape(polygon, renderer)<br>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-keyword">void</span> checkDefaultShape(Polygon polygon, Renderer renderer) &#123;<br>    <span class="hljs-keyword">assert</span> polygon.numberOfSides == <span class="hljs-number">4</span><br>    <span class="hljs-keyword">assert</span> renderer == renderer<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>with æµ‹è¯•ä½†ä¸ªå¯¹è±¡çš„å¤šä¸ªå±æ€§</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> <span class="hljs-string">&quot;should use #with()&quot;</span>() &#123;<br>        <span class="hljs-symbol">given:</span><br>        Renderer renderer = Mock()<br>        <span class="hljs-keyword">def</span> shapeFactory = <span class="hljs-keyword">new</span> ShapeFactory(renderer)<br><br>        <span class="hljs-symbol">when:</span><br>        <span class="hljs-keyword">def</span> polygon = shapeFactory.createDefaultPolygon()<br><br>        <span class="hljs-symbol">then:</span><br>        with(polygon)&#123;<br>            numberOfSides == <span class="hljs-number">4</span><br>            renderer == render<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><ul><li><p>verifyAll() ç¡®ä¿æ‰€æœ‰æ–­è¨€éƒ½åœ¨æ‰§è¡Œï¼Œè€Œä¸ç®¡å…¶ä¸­ä¹‹ä¸€æ˜¯å¦å¤±è´¥äº†ã€‚</p><p>å½“ä½¿ç”¨withæ—¶ï¼Œç¬¬ä¸€è¡Œæµ‹è¯•å¤±è´¥äº†ï¼Œç¬¬äºŒè¡Œæµ‹è¯•å°±ä¸ä¼šæ‰§è¡Œäº†ï¼Œè€ŒverifyAll ä¼šè¿è¡Œæ‰€æœ‰è¡Œæµ‹è¯•</p></li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-keyword">def</span> <span class="hljs-string">&quot;should use #verifyAll()&quot;</span>() &#123;<br>       <span class="hljs-symbol">given:</span><br>       Renderer renderer = Mock()<br>       <span class="hljs-keyword">def</span> shapeFactory = <span class="hljs-keyword">new</span> ShapeFactory(renderer)<br><br>       <span class="hljs-symbol">when:</span><br>       <span class="hljs-keyword">def</span> polygon = shapeFactory.createDefaultPolygon()<br><br>       <span class="hljs-symbol">then:</span><br>       verifyAll(polygon)&#123;<br>           numberOfSides == <span class="hljs-number">5</span><br>           renderer == <span class="hljs-literal">null</span><br>       &#125;<br>   &#125;<br></code></pre></td></tr></table></figure><ul><li><p>setup-and-teardown</p><ul><li>setupSpec():  åœ¨è§„èŒƒçš„å¼€å§‹è®¾ç½®çŠ¶æ€ä¸€æ¬¡ï¼Œè¿™æ˜¯ä¸ºäº†åœ¨å„ä¸ªæµ‹è¯•æ–¹æ³•ä¹‹é—´ä¸åº”è¯¥æ”¹å˜çš„ä¸œè¥¿</li><li>setup(): å°†åœ¨è¯¥ç±»ä¸­çš„æ¯ä¸ªå•ç‹¬æµ‹è¯•æ–¹æ³•ä¹‹å‰è¿è¡Œã€‚è¿™å¯ç”¨äºåœ¨æ¯æ¬¡æµ‹è¯•å¼€å§‹æ—¶è®¾ç½®å¹²å‡€çŠ¶æ€ã€‚</li><li>cleanup(): åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•ç»“æŸæ—¶æ¸…ç†æ•°æ®æˆ–çŠ¶æ€</li><li>cleanupSpec() :  å¯¹äºæœ€ç»ˆçš„åˆ†è§£ä»£ç ï¼Œè¯¥æ–¹æ³•å°†åœ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•çš„æœ€åè°ƒç”¨ä¸€æ¬¡ã€‚</li></ul></li><li><p>andå¯ä»¥å¢åŠ å¤šä¸ªä½¿ä»£ç æ ¹æ®å¯è¯»æ€§ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">given: <span class="hljs-string">&quot;test method&quot;</span><br><span class="hljs-regexp">//</span> code ....<br><br>and: <span class="hljs-string">&quot;test method with user1&quot;</span><br><span class="hljs-regexp">//</span> code ...<br><br>and: <span class="hljs-string">&quot;test method with user2&quot;</span><br><span class="hljs-regexp">//</span> code ...<br></code></pre></td></tr></table></figure></li></ul><p>â€‹</p>]]></content>
    
    
    <categories>
      
      <category>æµ‹è¯•æ¡†æ¶</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spock</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>kotlinåŸºç¡€</title>
    <link href="/kotlin%E5%AD%A6%E4%B9%A0/"/>
    <url>/kotlin%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h2 id="1-Kotlin-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-Kotlin-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.Kotlin æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.Kotlin æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>Kotlin æ˜¯ä¸€ç§åœ¨ Java è™šæ‹Ÿæœºä¸Šè¿è¡Œçš„é™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ï¼Œè¢«ç§°ä¹‹ä¸º Android ä¸–ç•Œçš„Swiftï¼Œç”± JetBrains è®¾è®¡å¼€å‘å¹¶å¼€æºã€‚</p><p>åœ¨Google I&#x2F;O 2017ä¸­ï¼ŒGoogle å®£å¸ƒ Kotlin æˆä¸º Android å®˜æ–¹å¼€å‘è¯­è¨€ã€‚</p><h2 id="2-ä¸ºä»€ä¹ˆé€‰æ‹©-Kotlinï¼Ÿ"><a href="#2-ä¸ºä»€ä¹ˆé€‰æ‹©-Kotlinï¼Ÿ" class="headerlink" title="2.ä¸ºä»€ä¹ˆé€‰æ‹© Kotlinï¼Ÿ"></a>2.ä¸ºä»€ä¹ˆé€‰æ‹© Kotlinï¼Ÿ</h2><ul><li>ç®€æ´: å¤§å¤§å‡å°‘æ ·æ¿ä»£ç çš„æ•°é‡ã€‚</li><li>å®‰å…¨: é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ç­‰æ•´ä¸ªç±»çš„é”™è¯¯ã€‚</li><li>äº’æ“ä½œæ€§: å……åˆ†åˆ©ç”¨ JVMã€Android å’Œæµè§ˆå™¨çš„ç°æœ‰åº“ã€‚</li><li>å·¥å…·å‹å¥½: å¯ç”¨ä»»ä½• Java IDE æˆ–è€…ä½¿ç”¨å‘½ä»¤è¡Œæ„å»ºã€‚</li></ul><span id="more"></span><h2 id="3-æˆ‘çš„ç¬¬ä¸€ä¸ª-Kotlin-ç¨‹åº"><a href="#3-æˆ‘çš„ç¬¬ä¸€ä¸ª-Kotlin-ç¨‹åº" class="headerlink" title="3.æˆ‘çš„ç¬¬ä¸€ä¸ª Kotlin ç¨‹åº"></a>3.æˆ‘çš„ç¬¬ä¸€ä¸ª Kotlin ç¨‹åº</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>    println(<span class="hljs-string">&quot;hello word!&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>Kotlin ç¨‹åºæ–‡ä»¶ä»¥ <strong>.kt</strong> ç»“å°¾ï¼Œå¦‚ï¼šhello.kt ã€app.ktã€‚</p></blockquote><h2 id="4-åŸºç¡€è¯­æ³•"><a href="#4-åŸºç¡€è¯­æ³•" class="headerlink" title="4.åŸºç¡€è¯­æ³•"></a>4.åŸºç¡€è¯­æ³•</h2><ul><li>å‡½æ•°å®šä¹‰</li></ul><p>æ ¼å¼ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> æ–¹æ³•å<span class="hljs-params">(å‚æ•°A : ç±»å‹<span class="hljs-type">A</span>, å‚æ•°B : ç±»å‹<span class="hljs-type">B</span>)</span></span>: è¿”å›å€¼ç±»å‹(å¯ä»¥ä¸ºç©º) &#123;<br>   å‡½æ•°ä½“<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sum</span><span class="hljs-params">(a: <span class="hljs-type">Int</span>, b: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> &#123;   <span class="hljs-comment">// Int å‚æ•°ï¼Œè¿”å›å€¼ Int</span><br>    <span class="hljs-keyword">return</span> a + b<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   <span class="hljs-keyword">var</span> result = add(<span class="hljs-number">3</span>,<span class="hljs-number">5</span>)<br>    println(result)<br>&#125;<br><br><span class="hljs-comment">//fun add(x: Int, y: Int): Int &#123;</span><br><span class="hljs-comment">//  return x+ y</span><br><span class="hljs-comment">//&#125;</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">add</span><span class="hljs-params">(x: <span class="hljs-type">Int</span>, y: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> = x+ y<br></code></pre></td></tr></table></figure><ul><li>å¯å˜é•¿å‚æ•°</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">vars</span><span class="hljs-params">(<span class="hljs-keyword">vararg</span> v:<span class="hljs-type">Int</span>)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(vt <span class="hljs-keyword">in</span> v)&#123;<br>        print(vt)<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>    vars(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>)  <span class="hljs-comment">// è¾“å‡º12345</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li>é»˜è®¤å‚æ•°å’Œå…·åå‚æ•°</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">calThePerimeterOfCircle</span><span class="hljs-params">(pi: <span class="hljs-type">Float</span> = Pi, r: <span class="hljs-type">Float</span>)</span></span>: <span class="hljs-built_in">Float</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>* pi * r<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    println(<span class="hljs-string">&quot;åœ†çš„å‘¨é•¿ä¸ºï¼š<span class="hljs-subst">$&#123;calThePerimeterOfCircle(r = <span class="hljs-number">2.0</span>f)&#125;</span>&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å‡½æ•°è¡¨è¾¾å¼</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   <span class="hljs-keyword">var</span> i = &#123;x: <span class="hljs-built_in">Int</span>, y: <span class="hljs-built_in">Int</span> -&gt; x+ y&#125;<br>    println(i(<span class="hljs-number">3</span>,<span class="hljs-number">5</span>))<br><br>    <span class="hljs-comment">// è¾“å…¥ç±»å‹æ˜¯ä¸¤ä¸ªint ï¼Œè¿”å›å€¼æ˜¯intï¼Œè¾“å…¥å‚æ•°ä¸ºx,y è¡¨è¾¾å¼ä¸ºx+y</span><br>    <span class="hljs-keyword">var</span> j:(<span class="hljs-built_in">Int</span>,<span class="hljs-built_in">Int</span>) -&gt; <span class="hljs-built_in">Int</span> = &#123;x,y -&gt; x+y&#125;<br>    println(i(<span class="hljs-number">4</span>,<span class="hljs-number">5</span>))<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æ¡ä»¶æ§åˆ¶ if</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">returnBigValue</span><span class="hljs-params">(a:<span class="hljs-type">Int</span>,b:<span class="hljs-type">Int</span>)</span></span>:<span class="hljs-built_in">Int</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (a&gt;b) a <span class="hljs-keyword">else</span> b<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>    <span class="hljs-keyword">var</span> a= <span class="hljs-number">3</span><br>    <span class="hljs-keyword">var</span> b = <span class="hljs-number">5</span><br>    println(<span class="hljs-string">&quot;<span class="hljs-subst">$&#123;a&#125;</span>å’Œ<span class="hljs-subst">$&#123;b&#125;</span>ä¸­è¾ƒå¤§çš„æ•°æ˜¯<span class="hljs-subst">$&#123;returnBigValue(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)&#125;</span>&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>When è¡¨è¾¾å¼</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">gradeStudent</span><span class="hljs-params">(score:<span class="hljs-type">Int</span>)</span></span>&#123;<br>    <span class="hljs-keyword">when</span>(score)&#123;<br>        <span class="hljs-number">10</span> -&gt; println(<span class="hljs-string">&quot;ä¼˜ç§€ï¼&quot;</span>)<br>        <span class="hljs-number">1</span> -&gt; println(<span class="hljs-string">&quot;å·®åŠ²ï¼&quot;</span>)<br>        <span class="hljs-keyword">else</span> -&gt; println(<span class="hljs-string">&quot;åŠªåŠ›åŠªåŠ›ï¼&quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    println(gradeStudent(<span class="hljs-number">9</span>))<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>list</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">var</span> items = listOf&lt;String&gt;(<span class="hljs-string">&quot;è¯­æ–‡&quot;</span>,<span class="hljs-string">&quot;æ•°å­¦&quot;</span>,<span class="hljs-string">&quot;è‹±è¯­&quot;</span>);<br>    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> items)&#123;<br>        println(<span class="hljs-string">&quot;ç§‘ç›®æœ‰ï¼š<span class="hljs-subst">$&#123;i&#125;</span>&quot;</span>)<br>    &#125;<br>    <span class="hljs-keyword">for</span> ((i,index) <span class="hljs-keyword">in</span> items.withIndex())&#123;<br>        println(<span class="hljs-string">&quot;ç§‘ç›®ä¸ºï¼š<span class="hljs-subst">$&#123;i&#125;</span>ï¼Œåºå·ä¸º<span class="hljs-subst">$&#123;index&#125;</span>&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>map</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   <span class="hljs-keyword">var</span> map = TreeMap&lt;String,String&gt;()<br>    map[<span class="hljs-string">&quot;å¥½&quot;</span>] = <span class="hljs-string">&quot;good&quot;</span><br>    map[<span class="hljs-string">&quot;å&quot;</span>] = <span class="hljs-string">&quot;bad&quot;</span><br>    println(map[<span class="hljs-string">&quot;å¥½&quot;</span>])<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å­—ç¬¦ä¸²å’Œæ•°å­—çš„è½¬æ¢</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">var</span> a = <span class="hljs-string">&quot;string&quot;</span><br>    <span class="hljs-keyword">var</span> b = <span class="hljs-number">1</span><br>    println(<span class="hljs-string">&quot;å­—ç¬¦ä¸²è½¬æ•°å­—ï¼š<span class="hljs-subst">$&#123;a.toString()&#125;</span>&quot;</span>)<br>    println(<span class="hljs-string">&quot;æ•°å­—è½¬å­—ç¬¦ä¸²ï¼š<span class="hljs-subst">$&#123;b.toInt()&#125;</span>&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æ§åˆ¶å°è¾“å…¥å˜é‡</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    println(<span class="hljs-string">&quot;è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—ï¼š&quot;</span>)<br>    <span class="hljs-keyword">var</span> str1 = readLine()<br>    println(<span class="hljs-string">&quot;è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—ï¼š&quot;</span>)<br>    <span class="hljs-keyword">var</span> str2 = readLine()<br><br>    <span class="hljs-keyword">var</span> num1 = str1!!.toInt()<br>    <span class="hljs-keyword">var</span> num2 = str2!!.toInt()<br>    println(<span class="hljs-string">&quot;<span class="hljs-subst">$&#123;num1&#125;</span>+<span class="hljs-subst">$&#123;num2&#125;</span>=<span class="hljs-subst">$&#123;num1+num2&#125;</span>&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å¤„ç†å¼‚å¸¸-&gt; tryâ€¦catch()</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    println(<span class="hljs-string">&quot;è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—ï¼š&quot;</span>)<br>    <span class="hljs-keyword">var</span> str1 = readLine()<br>    println(<span class="hljs-string">&quot;è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—ï¼š&quot;</span>)<br>    <span class="hljs-keyword">var</span> str2 = readLine()<br>    <span class="hljs-keyword">try</span>&#123;<br>        <span class="hljs-keyword">var</span> num1 = str1!!.toInt()<br>        <span class="hljs-keyword">var</span> num2 = str2!!.toInt()<br>        println(<span class="hljs-string">&quot;<span class="hljs-subst">$&#123;num1&#125;</span>+<span class="hljs-subst">$&#123;num2&#125;</span>=<span class="hljs-subst">$&#123;num1+num2&#125;</span>&quot;</span>)<br>    &#125;<span class="hljs-keyword">catch</span> (e: Exception)&#123;<br>        println(<span class="hljs-string">&quot;è¾“å…¥çš„æ•°æ®æœ‰è¯¯ï¼&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>å­—ç¬¦ä¸²æ¨¡æ¿</p><p>$ è¡¨ç¤ºä¸€ä¸ªå˜é‡åæˆ–è€…å˜é‡å€¼</p><p>$varName è¡¨ç¤ºå˜é‡å€¼</p><p>${varName.fun()} è¡¨ç¤ºå˜é‡çš„æ–¹æ³•è¿”å›å€¼:</p></li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> &#123;<br>    <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span><br><br><span class="hljs-comment">// æ¨¡æ¿ä¸­çš„ç®€å•åç§°ï¼š</span><br>    <span class="hljs-keyword">val</span> s1 = <span class="hljs-string">&quot;a is <span class="hljs-variable">$a</span>&quot;</span><br><br>    a = <span class="hljs-number">2</span><br><span class="hljs-comment">// æ¨¡æ¿ä¸­çš„ä»»æ„è¡¨è¾¾å¼ï¼š</span><br>    <span class="hljs-keyword">val</span> s2 = <span class="hljs-string">&quot;<span class="hljs-subst">$&#123;s1.replace(<span class="hljs-string">&quot;is&quot;</span>, <span class="hljs-string">&quot;was&quot;</span>)&#125;</span>, but now is <span class="hljs-variable">$a</span>&quot;</span><br>    println(s2)<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>ç©ºå€¼å¤„ç†</p><p>Kotlinçš„ç©ºå®‰å…¨è®¾è®¡å¯¹äºå£°æ˜å¯ä¸ºç©ºçš„å‚æ•°ï¼Œåœ¨ä½¿ç”¨æ—¶è¦è¿›è¡Œç©ºåˆ¤æ–­å¤„ç†ï¼Œæœ‰ä¸¤ç§å¤„ç†æ–¹å¼ã€‚</p><ul><li><p>å­—æ®µååŠ !!åƒJavaä¸€æ ·æŠ›å‡ºç©ºå¼‚å¸¸</p></li><li><p>å­—æ®µååŠ ?å¯ä¸åšå¤„ç†è¿”å›å€¼ä¸º nullæˆ–é…åˆ?:åšç©ºåˆ¤æ–­å¤„ç†</p></li></ul></li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//ç±»å‹åé¢åŠ ?è¡¨ç¤ºå¯ä¸ºç©º</span><br><span class="hljs-keyword">var</span> age: String? = <span class="hljs-string">&quot;23&quot;</span> <br><span class="hljs-comment">//æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸</span><br><span class="hljs-keyword">val</span> ages = age!!.toInt()<br><span class="hljs-comment">//ä¸åšå¤„ç†è¿”å› null</span><br><span class="hljs-keyword">val</span> ages1 = age?.toInt()<br><span class="hljs-comment">//ageä¸ºç©ºè¿”å›-1</span><br><span class="hljs-keyword">val</span> ages2 = age?.toInt() ?: -<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h2 id="5-ç±»"><a href="#5-ç±»" class="headerlink" title="5.ç±»"></a>5.ç±»</h2><h3 id="5-1-ç±»çš„åˆ›å»º"><a href="#5-1-ç±»çš„åˆ›å»º" class="headerlink" title="5.1 ç±»çš„åˆ›å»º"></a>5.1 ç±»çš„åˆ›å»º</h3><p>Kotlin ä¸­æ²¡æœ‰ new å…³é”®å­—</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rectangular</span></span>&#123;<br>    <span class="hljs-keyword">var</span> width:<span class="hljs-built_in">Int</span> = <span class="hljs-number">10</span><br>    <span class="hljs-keyword">var</span> height:<span class="hljs-built_in">Int</span> = <span class="hljs-number">5</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">var</span> rectangular = Rectangular()<br>    println(rectangular.height)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5-2-æšä¸¾ç±»"><a href="#5-2-æšä¸¾ç±»" class="headerlink" title="5.2 æšä¸¾ç±»"></a>5.2 æšä¸¾ç±»</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">enum</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Color</span></span>&#123;<br>    RED,BLACK,BLUE,GREEN,WHITE<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6-Kotlin-ç»§æ‰¿"><a href="#6-Kotlin-ç»§æ‰¿" class="headerlink" title="6. Kotlin ç»§æ‰¿"></a>6. Kotlin ç»§æ‰¿</h3><p>Kotlin ä¸­æ‰€æœ‰ç±»éƒ½ç»§æ‰¿è¯¥ Any ç±»ï¼Œå®ƒæ˜¯æ‰€æœ‰ç±»çš„è¶…ç±»ï¼Œå¯¹äºæ²¡æœ‰è¶…ç±»å‹å£°æ˜çš„ç±»æ˜¯é»˜è®¤è¶…ç±»ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">class</span> <span class="hljs-symbol">Example</span> // ä» <span class="hljs-symbol">Any</span> éšå¼ç»§æ‰¿<br></code></pre></td></tr></table></figure><p>Any é»˜è®¤æä¾›äº†ä¸‰ä¸ªå‡½æ•°ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">equals</span><span class="hljs-params">()</span></span><br><br><span class="hljs-function"><span class="hljs-title">hashCode</span><span class="hljs-params">()</span></span><br><br><span class="hljs-function"><span class="hljs-title">toString</span><span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼šAny ä¸æ˜¯ java.lang.Objectã€‚</p><p>å¦‚æœä¸€ä¸ªç±»è¦è¢«ç»§æ‰¿ï¼Œå¯ä»¥ä½¿ç”¨ open å…³é”®å­—è¿›è¡Œä¿®é¥°ã€‚</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">open <span class="hljs-keyword">class</span> <span class="hljs-symbol">Base</span>(<span class="hljs-symbol">p: <span class="hljs-symbol">Int</span></span>)           // å®šä¹‰åŸºç±»<br><br><span class="hljs-symbol">class</span> <span class="hljs-symbol">Derived</span>(<span class="hljs-symbol">p: <span class="hljs-symbol">Int</span></span>) : <span class="hljs-symbol">Base</span>(<span class="hljs-symbol">p</span>)<br></code></pre></td></tr></table></figure><h1 id="7-Kotlin-æ¥å£"><a href="#7-Kotlin-æ¥å£" class="headerlink" title="7.Kotlin æ¥å£"></a>7.Kotlin æ¥å£</h1><p>Kotlin æ¥å£ä¸ Java 8 ç±»ä¼¼ï¼Œä½¿ç”¨ interface å…³é”®å­—å®šä¹‰æ¥å£ï¼Œå…è®¸æ–¹æ³•æœ‰é»˜è®¤å®ç°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">MyInterface</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">bar</span><span class="hljs-params">()</span></span>    <span class="hljs-comment">// æœªå®ç°</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span> &#123;  <span class="hljs-comment">//å·²å®ç°</span><br>      <span class="hljs-comment">// å¯é€‰çš„æ–¹æ³•ä½“</span><br>      println(<span class="hljs-string">&quot;foo&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Child</span> : <span class="hljs-type">MyInterface1</span>,<span class="hljs-type">MyInterface2 &#123;</span></span><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">bar1</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-comment">// æ–¹æ³•ä½“</span><br>    &#125;<br>   <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">bar2</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-comment">// æ–¹æ³•ä½“</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Kotlin</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>springbootæ•´åˆgraphql</title>
    <link href="/springboot%E6%95%B4%E5%90%88graphql/"/>
    <url>/springboot%E6%95%B4%E5%90%88graphql/</url>
    
    <content type="html"><![CDATA[<p>GraphQLæ˜¯æ¯”RESTæ›´é«˜æ•ˆã€å¼ºå¤§å’Œçµæ´»çš„<strong>æ–°ä¸€ä»£APIæ ‡å‡†</strong>ã€‚è¯¦ç»†çš„å¯ä»¥çœ‹å®˜ç½‘<a href="https://graphql.cn/">GraphQL</a>ã€‚</p><p>ä¸‹é¢ä»‹ç»ä¸€ä¸ªSpring bootæ•´åˆgraphqlç®€å•çš„ä¾‹å­ã€‚</p><span id="more"></span><ul><li><p>é¡¹ç›®å‡†å¤‡ï¼šç›¸å…³ä¾èµ–çš„å¼•å…¥ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">&lt;dependencies&gt;</span><br><span class="hljs-meta">&lt;!--web</span> <span class="hljs-string">--&gt;</span><br><span class="hljs-attr">&lt;dependency&gt;</span><br><span class="hljs-attr">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="hljs-attr">&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="hljs-attr">&lt;/dependency&gt;</span><br><span class="hljs-meta">&lt;!--lombok</span> <span class="hljs-string">--&gt;</span><br><span class="hljs-attr">&lt;dependency&gt;</span><br><span class="hljs-attr">&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="hljs-attr">&lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="hljs-attr">&lt;optional&gt;true&lt;/optional&gt;</span><br><span class="hljs-attr">&lt;/dependency&gt;</span><br><span class="hljs-meta">&lt;!--graphql</span> <span class="hljs-string">--&gt;</span><br><span class="hljs-attr">&lt;dependency&gt;</span><br><span class="hljs-attr">&lt;groupId&gt;com.graphql-java-kickstart&lt;/groupId&gt;</span><br><span class="hljs-attr">&lt;artifactId&gt;graphql-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="hljs-attr">&lt;version&gt;11.0.0&lt;/version&gt;</span><br><span class="hljs-attr">&lt;/dependency&gt;</span><br><span class="hljs-meta">&lt;!--playground</span> <span class="hljs-string">--&gt;</span><br><span class="hljs-attr">&lt;dependency&gt;</span><br><span class="hljs-attr">&lt;groupId&gt;com.graphql-java-kickstart&lt;/groupId&gt;</span><br><span class="hljs-attr">&lt;artifactId&gt;playground-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="hljs-attr">&lt;version&gt;11.0.0&lt;/version&gt;</span><br><span class="hljs-attr">&lt;/dependency&gt;</span><br><span class="hljs-attr">&lt;/dependencies&gt;</span><br></code></pre></td></tr></table></figure></li></ul><h4 id="Query"><a href="#Query" class="headerlink" title="Query"></a>Query</h4><ul><li><p>å®šä¹‰schemaï¼Œåˆ†åˆ«ä¸ºï¼š</p><p><code>query.graphqls</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">type Query&#123;<br>  billingAccount(id: ID): BillingAccount<br>&#125;<br></code></pre></td></tr></table></figure><p><code>billingAccount.graphqls</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">type BillingAccount &#123;<br>  id: ID!<br>  name: String!<br>  currency: Currency<br>&#125;<br></code></pre></td></tr></table></figure><p><code>currency.graphqls</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Currency</span></span>&#123;<br>    RMB,<br>    USD<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å®šä¹‰åŸºç¡€è¦æ“ä½œçš„æ¨¡å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Builder</span><br><span class="hljs-meta">@Value</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BillingAccount</span> </span>&#123;<br>    UUID id;<br>    String name;<br>    Currency currency;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Currency</span> </span>&#123;<br>    RMB, USD<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å®šä¹‰resolver</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BillingAccountResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">GraphQLQueryResolver</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> BillingAccount <span class="hljs-title">billingAccount</span><span class="hljs-params">(UUID id)</span></span>&#123;<br>        log.info(<span class="hljs-string">&quot;receive billingAccount id is: &quot;</span>+ id);<br>        <span class="hljs-keyword">return</span> BillingAccount.builder()<br>                .id(id)<br>                .currency(Currency.RMB)<br>                .name(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>)<br>                .build();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æ•ˆæœå›¾</p></li></ul><p><img src="/images/resolver.png" alt="img"></p><h4 id="mutation"><a href="#mutation" class="headerlink" title="mutation"></a>mutation</h4><ul><li>å®šä¹‰schema</li></ul><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elm"><span class="hljs-keyword">type</span> <span class="hljs-type">Mutation</span>&#123;<br>    createBillingAccount(input: <span class="hljs-type">CreateBillingAccountInput</span>): <span class="hljs-type">BillingAccount</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å®šä¹‰input</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">input</span> CreateBillingAccountInput&#123;<br>    name: String<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å®šä¹‰input å¯¹åº”çš„model</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreateBillingAccountInput</span> </span>&#123;<br>  String name;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å®šä¹‰mutationResolver</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BillingAccountMutation</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">GraphQLMutationResolver</span> </span>&#123;<br><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> BillingAccount <span class="hljs-title">createBillingAccount</span><span class="hljs-params">(CreateBillingAccountInput input)</span></span>&#123;<br><br>    <span class="hljs-keyword">return</span> BillingAccount.builder()<br>      .id(UUID.randomUUID())<br>      .currency(Currency.RMB)<br>      .name(input.getName())<br>      .build();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå›¾</p><p>!<img src="/images/mutation.png" alt="mutation"></p>]]></content>
    
    
    <categories>
      
      <category>Springboot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>graphql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å“åº”å¼ç¼–ç¨‹</title>
    <link href="/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
    <url>/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<p><strong>1.å“åº”å¼ç¼–ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><ul><li><p>å“åº”å¼ç¼–ç¨‹ï¼ˆ<strong>reactive programming</strong>ï¼‰æ˜¯ä¸€ç§åŸºäºæ•°æ®æµå’Œå˜åŒ–ä¼ é€’çš„å£°æ˜å¼çš„ç¼–ç¨‹èŒƒå¼</p><p>æœ¬æ¥æ•°æ®æ˜¯æˆ‘ä»¬è‡ªè¡Œå¤„ç†çš„ï¼Œåæ¥æˆ‘ä»¬æŠŠè¦å¤„ç†çš„æ•°æ®æŠ½è±¡å‡ºæ¥ï¼ˆå˜æˆäº†æ•°æ®æµï¼‰ï¼Œç„¶åé€šè¿‡<strong>API</strong>å»å¤„ç†æ•°æ®æµä¸­çš„æ•°æ®ï¼ˆæ˜¯å£°æ˜å¼çš„,å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">int</span> sum2 = IntStream.of(nums).parallel().sum();<br></code></pre></td></tr></table></figure></li></ul><p>â€‹      å°†æ•°ç»„ä¸­çš„æ•°æ®å˜æˆæ•°æ®æµï¼Œé€šè¿‡æ˜¾å¼å£°æ˜è°ƒç”¨**.sum()**æ¥å¤„ç†æ•°æ®æµä¸­çš„æ•°æ®ï¼Œå¾—åˆ°æœ€ç»ˆçš„ç»“æœã€‚</p><ul><li><p>å“åº”å¼ç¼–ç¨‹æ˜¯å…³äºéé˜»å¡åº”ç”¨ç¨‹åºçš„ï¼Œè¿™äº›åº”ç”¨ç¨‹åºæ˜¯å¼‚æ­¥çš„ã€äº‹ä»¶é©±åŠ¨çš„ï¼Œå¹¶ä¸”éœ€è¦å°‘é‡çš„çº¿ç¨‹æ¥å‚ç›´ä¼¸ç¼©(å³åœ¨ JVM ä¸­)ï¼Œè€Œä¸æ˜¯æ°´å¹³ä¼¸ç¼©(å³é€šè¿‡é›†ç¾¤)ã€‚</p><blockquote><p>å·¥ä½œå¤ªå¤šï¼Œåšä¸å®Œæ—¶ï¼Œæ°´å¹³ä¼¸ç¼©å°±ç›¸å½“äºåŠ äººï¼Œå‚ç›´ä¼¸ç¼©ç›¸å½“äºåŠ ç­ã€‚</p></blockquote></li></ul><h3 id="2-å“åº”å¼æµï¼ˆReactive-Streamsï¼‰-æ˜¯ä»€ä¹ˆ"><a href="#2-å“åº”å¼æµï¼ˆReactive-Streamsï¼‰-æ˜¯ä»€ä¹ˆ" class="headerlink" title="2.å“åº”å¼æµï¼ˆReactive Streamsï¼‰ æ˜¯ä»€ä¹ˆ?"></a>2.å“åº”å¼æµï¼ˆReactive Streamsï¼‰ æ˜¯ä»€ä¹ˆ?</h3><span id="more"></span><ul><li><p>å“åº”å¼æµæ˜¯JDK9å¼•å…¥çš„ï¼ŒåŸºäºå‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼çš„ä¸€å¥—æ•°æ®å¤„ç†çš„æœºåˆ¶ã€‚</p></li><li><p>å“åº”å¼æµä»2013å¹´å¼€å§‹ï¼Œä½œä¸ºæä¾›éé˜»å¡èƒŒå‹çš„å¼‚æ­¥æµå¤„ç†æ ‡å‡†çš„å€¡è®®ã€‚ å®ƒæ—¨åœ¨è§£å†³å¤„ç†å…ƒç´ æµçš„é—®é¢˜â€”â€”å¦‚ä½•å°†å…ƒç´ æµä»å‘å¸ƒè€…ä¼ é€’åˆ°è®¢é˜…è€…ï¼Œè€Œä¸éœ€è¦å‘å¸ƒè€…é˜»å¡ï¼Œæˆ–è®¢é˜…è€…æœ‰æ— é™åˆ¶çš„ç¼“å†²åŒºæˆ–ä¸¢å¼ƒã€‚</p></li></ul><blockquote><p>èƒŒå‹ï¼šè¯´ç™½äº†å°±æ˜¯ä¸€ç§åé¦ˆï¼Œå‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´çš„ä¸€ç§äº’åŠ¨</p></blockquote><blockquote><p>ä¹‹å‰çš„è€æ¨¡å¼ï¼Œè®¢é˜…è€…å¾ˆè¢«åŠ¨ï¼Œå‘å¸ƒè€…ç»™è®¢é˜…è€…å¤šå°‘ä»–å°±æ¶ˆè´¹å¤šå°‘ï¼Œä¸èƒ½å¤šä¹Ÿä¸èƒ½å¤šå°‘ã€‚</p><p>Reactive Streamså°±å¯ä»¥åšåˆ°å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´å¯ä»¥è¿›è¡Œäº¤æµï¼Œè®¢é˜…è€…å¯ä»¥å‘Šè¯‰å‘å¸ƒè€…æˆ‘éœ€è¦å¤šå°‘æ•°æ®ï¼Œè®¢é˜…è€…å¤„ç†å®Œäº†ï¼Œå¯ä»¥å†å‘å‘å¸ƒè€…è¦ï¼Œæ²¡å¤„ç†å®Œå°±ä¸è¦ç»™æˆ‘ã€‚</p><p>èµ·åˆ°äº†ä¸€ç§è°ƒèŠ‚æµé‡çš„ä½œç”¨ï¼Œä¸ä¼šå¯¼è‡´å‘å¸ƒè€…æ•°æ®å¤ªå¤šï¼Œè®¢é˜…è€…å¤„ç†ä¸å®Œæµªè´¹ï¼Œæˆ–è€…ç›´æ¥æŠŠè®¢é˜…è€…å‹å®çš„åœºæ™¯ã€‚</p></blockquote><h3 id="2-Spring-Webflux-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2-Spring-Webflux-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2. Spring Webflux æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2. Spring Webflux æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Spring WebFluxæ˜¯<a href="https://rumenz.com/java-topic/spring-mvc-tutorial/index.html">Spring MVC</a>å¹¶è¡Œç‰ˆæœ¬ï¼Œå¹¶æ”¯æŒå®Œå…¨æ— é˜»å¡çš„ååº”æµçš„webæ¡†æ¶ã€‚ å®ƒæ”¯æŒèƒŒå‹æ¦‚å¿µï¼Œå¯ä»¥å¤„ç†å¤§é‡çš„å¹¶å‘è¿æ¥ï¼Œå¹¶ä½¿ç”¨**<a href="https://netty.io/">Netty</a>**ä½œä¸ºå†…ç½®æœåŠ¡å™¨æ¥è¿è¡Œå“åº”å¼åº”ç”¨ç¨‹åºã€‚ </p><h3 id="3-Spring-Webflux-å’ŒSpring-mvc-çš„å…³ç³»"><a href="#3-Spring-Webflux-å’ŒSpring-mvc-çš„å…³ç³»" class="headerlink" title="3.Spring Webflux å’ŒSpring mvc çš„å…³ç³»"></a>3.Spring Webflux å’ŒSpring mvc çš„å…³ç³»</h3><img src="https://spring.io/images/diagram-reactive-1290533f3f01ec9c57baf2cc9ea9fa2f.svg" style="zoom: 25%;" /><p>Spring MVC</p><ul><li>æ„å»ºäº Servlet API ä¹‹ä¸Š</li><li>åŒæ­¥é˜»å¡ I&#x2F;O æ¨¡å‹, è®¤ä¸ºåº”ç”¨ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œæ‰€ä»¥ä¸€ä¸ª Request å¯¹åº”ä¸€ä¸ª Threadï¼Œéœ€è¦æœ‰ä¸€ä¸ªå«æœ‰å¤§é‡çº¿ç¨‹çš„çº¿ç¨‹æ± </li></ul><p>Spring WebFlux</p><ul><li>æ„å»ºäº Reactive Streams Adapters ä¹‹ä¸Š</li><li>å¼‚æ­¥éé˜»å¡ I&#x2F;O æ¨¡å‹ï¼Œè®¤ä¸ºåº”ç”¨ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œæ‰€ä»¥åªæ˜¯éœ€è¦ä¸€ä¸ªåŒ…å«å°‘æ•°å›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ±  (event loop workers) æ¥å¤„ç†è¯·æ±‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java8æ–°ç‰¹æ€§ä¹‹Streamæµ</title>
    <link href="/Java8%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8BStream%E6%B5%81/"/>
    <url>/Java8%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8BStream%E6%B5%81/</url>
    
    <content type="html"><![CDATA[<h3 id="Java8æ–°ç‰¹æ€§ä¹‹Streamæµ"><a href="#Java8æ–°ç‰¹æ€§ä¹‹Streamæµ" class="headerlink" title="Java8æ–°ç‰¹æ€§ä¹‹Streamæµ"></a>Java8æ–°ç‰¹æ€§ä¹‹Streamæµ</h3><h3 id="1-ä»€ä¹ˆæ˜¯Streamï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯Streamï¼Ÿ" class="headerlink" title="1.ä»€ä¹ˆæ˜¯Streamï¼Ÿ"></a>1.ä»€ä¹ˆæ˜¯Streamï¼Ÿ</h3><p>Java 8 APIæ·»åŠ äº†ä¸€ä¸ªæ–°çš„æŠ½è±¡ç§°ä¸ºæµStreamï¼Œå¯ä»¥è®©ä½ ä»¥ä¸€ç§å£°æ˜çš„æ–¹å¼å¤„ç†æ•°æ®ã€‚é€šè¿‡å£°æ˜æ€§æ–¹å¼ï¼Œèƒ½å¤Ÿå¯¹é›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œä¸€ç³»åˆ—å¹¶è¡Œæˆ–ä¸²è¡Œçš„æµæ°´çº¿æ“ä½œã€‚ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StreamDemo1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span>[] numbers = &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;;<br>        <span class="hljs-keyword">int</span> num2 = IntStream.of(numbers).sum();<br>        System.out.println(num2);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºæµçš„å‡ ç§æ–¹å¼"><a href="#2-åˆ›å»ºæµçš„å‡ ç§æ–¹å¼" class="headerlink" title="2.åˆ›å»ºæµçš„å‡ ç§æ–¹å¼"></a>2.åˆ›å»ºæµçš„å‡ ç§æ–¹å¼</h3><span id="more"></span><h4 id="2-1-ä½¿ç”¨é›†åˆ"><a href="#2-1-ä½¿ç”¨é›†åˆ" class="headerlink" title="2.1 ä½¿ç”¨é›†åˆ"></a>2.1 ä½¿ç”¨é›†åˆ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">ArrayList arrayList = <span class="hljs-keyword">new</span> ArrayList();<br>arrayList.stream();<br>arrayList.parallelStream();  <br></code></pre></td></tr></table></figure><h4 id="2-2-ä½¿ç”¨æ•°ç»„"><a href="#2-2-ä½¿ç”¨æ•°ç»„" class="headerlink" title="2.2 ä½¿ç”¨æ•°ç»„"></a>2.2 ä½¿ç”¨æ•°ç»„</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Arrays.stream(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;);<br></code></pre></td></tr></table></figure><h4 id="2-3-æ•°å­—Stream"><a href="#2-3-æ•°å­—Stream" class="headerlink" title="2.3 æ•°å­—Stream"></a>2.3 æ•°å­—Stream</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">IntStream.of(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>);<br>IntStream.rangeClosed(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>);<br></code></pre></td></tr></table></figure><h4 id="2-4-ä½¿ç”¨Stream-generate"><a href="#2-4-ä½¿ç”¨Stream-generate" class="headerlink" title="2.4 ä½¿ç”¨Stream.generate()"></a>2.4 ä½¿ç”¨Stream.generate()</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Stream.generate(()-&gt; <span class="hljs-string">&quot;stream&quot;</span>).limit(<span class="hljs-number">5</span>);<br></code></pre></td></tr></table></figure><h3 id="3-å¸¸ç”¨æ–¹æ³•"><a href="#3-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="3. å¸¸ç”¨æ–¹æ³•"></a>3. å¸¸ç”¨æ–¹æ³•</h3><p>æµæ¨¡å‹çš„æ“ä½œå¾ˆä¸°å¯Œï¼Œè¿™é‡Œä»‹ç»ä¸€äº›å¸¸ç”¨çš„APIã€‚è¿™äº›æ–¹æ³•å¯ä»¥è¢«åˆ†æˆä¸¤ç§ï¼š</p><blockquote><ul><li>å»¶è¿Ÿæ–¹æ³•ï¼šè¿”å›å€¼ä»»ç„¶æ˜¯Streamæ¥å£è‡ªèº«ç±»å‹çš„æ–¹æ³•ï¼Œå› æ­¤æ”¯æŒé“¾å¼è°ƒç”¨(é™¤äº†ç»ˆç»“æ–¹æ³•å¤–ï¼Œå…¶ä»–éƒ½æ˜¯æ–¹æ³•å‡ä¸ºå»¶è¿Ÿæ–¹æ³•)</li><li>ç»ˆç»“æ–¹æ³•ï¼šè¿”å›å€¼ç±»å‹ä¸å†æ˜¯Streamæ¥å£è‡ªèº«ç±»å‹çš„æ–¹æ³•ã€‚</li></ul></blockquote><h4 id="3-1-å»¶è¿Ÿæ–¹æ³•"><a href="#3-1-å»¶è¿Ÿæ–¹æ³•" class="headerlink" title="3.1 å»¶è¿Ÿæ–¹æ³•"></a>3.1 å»¶è¿Ÿæ–¹æ³•</h4><h5 id="1-filter"><a href="#1-filter" class="headerlink" title="1. filter"></a>1. filter</h5><p>å¯ä»¥é€šè¿‡<code>filter</code>æ–¹æ³•å°†ä¸€ä¸ªæµè½¬æ¢æˆå¦ä¸€ä¸ªå­é›†æµã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Stream.of(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>).filter(i -&gt; i&gt;<span class="hljs-number">2</span>).forEach(System.out::println);<br></code></pre></td></tr></table></figure><h5 id="2-peek"><a href="#2-peek" class="headerlink" title="2.peek"></a>2.peek</h5><p>ç”¨äºdebugï¼Œforeachæ˜¯æœ€ç»ˆæ“ä½œ</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Stream</span>.</span></span><span class="hljs-keyword">of</span>(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>,<span class="hljs-string">&quot;æå››&quot;</span>,<span class="hljs-string">&quot;ç‹éº»å­&quot;</span>).peek(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out::println).<span class="hljs-keyword">for</span><span class="hljs-constructor">Each(System.<span class="hljs-params">out</span>::<span class="hljs-params">println</span>)</span>;<br></code></pre></td></tr></table></figure><h5 id="3-map"><a href="#3-map" class="headerlink" title="3.map"></a>3.map</h5><p>å°†æµä¸­çš„å…ƒç´ æ˜ å°„åˆ°å¦ä¸€ä¸ªæµä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Stream.of(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>,<span class="hljs-string">&quot;æå››&quot;</span>,<span class="hljs-string">&quot;ç‹éº»å­&quot;</span>).map(String::length).forEach(System.out::println);<br></code></pre></td></tr></table></figure><h5 id="4-limit"><a href="#4-limit" class="headerlink" title="4.limit"></a>4.limit</h5><p>å¯¹æµè¿›è¡Œæˆªå–ï¼Œåªå–ç”¨å‰nä¸ª</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Stream.of(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>,<span class="hljs-string">&quot;æå››&quot;</span>,<span class="hljs-string">&quot;ç‹éº»å­&quot;</span>).limit(<span class="hljs-number">2</span>).forEach(System.out::println);<br></code></pre></td></tr></table></figure><h5 id="5-skip"><a href="#5-skip" class="headerlink" title="5.skip"></a>5.skip</h5><p>è·³è¿‡å‰å‡ ä¸ª</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Stream</span>.</span></span><span class="hljs-keyword">of</span>(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>,<span class="hljs-string">&quot;æå››&quot;</span>,<span class="hljs-string">&quot;ç‹éº»å­&quot;</span>).skip(<span class="hljs-number">2</span>).<span class="hljs-keyword">for</span><span class="hljs-constructor">Each(System.<span class="hljs-params">out</span>::<span class="hljs-params">println</span>)</span>;<br></code></pre></td></tr></table></figure><h4 id="3-2-ç»ˆæ­¢æ–¹æ³•"><a href="#3-2-ç»ˆæ­¢æ–¹æ³•" class="headerlink" title="3.2 ç»ˆæ­¢æ–¹æ³•"></a>3.2 ç»ˆæ­¢æ–¹æ³•</h4><h5 id="1-forEach"><a href="#1-forEach" class="headerlink" title="1.forEach"></a>1.forEach</h5><p>è¿­ä»£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Stream.of(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>).forEach(System.out::println);<br></code></pre></td></tr></table></figure><h5 id="2-count"><a href="#2-count" class="headerlink" title="2.count"></a>2.count</h5><p>è®¡ç®—ä¸ªæ•°</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out.println(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Stream</span>.</span></span><span class="hljs-keyword">of</span>(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>,<span class="hljs-string">&quot;æå››&quot;</span>,<span class="hljs-string">&quot;ç‹éº»å­&quot;</span>).count<span class="hljs-literal">()</span>);<br></code></pre></td></tr></table></figure><h5 id="3-collect"><a href="#3-collect" class="headerlink" title="3.collect"></a>3.collect</h5><p>æ”¶é›†åˆ°list</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;String&gt; list = Stream.of(str.split(<span class="hljs-string">&quot; &quot;</span>)).collect(Collectors.toList());<br>System.out.println(<span class="hljs-string">&quot;æ”¶é›†åˆ°list:&quot;</span>+list);<br></code></pre></td></tr></table></figure><h5 id="4-reduce"><a href="#4-reduce" class="headerlink" title="4.reduce"></a>4.reduce</h5><p>ä»Streamä¸­ç”Ÿæˆä¸€ä¸ªå€¼</p><ul><li>ä½¿ç”¨reduceæ‹¼æ¥å­—ç¬¦ä¸²</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Optional&lt;String&gt; newStr = Stream.of(str.split(<span class="hljs-string">&quot;&quot;</span>)).reduce((str1, str2) -&gt; str1 + <span class="hljs-string">&quot;-&quot;</span> + str2);<br>System.out.println(newStr.orElse(<span class="hljs-string">&quot;&quot;</span>));<br></code></pre></td></tr></table></figure><ul><li>ä½¿ç”¨reduceæ‹¼æ¥å­—ç¬¦ä¸²-+ å¸¦æœ‰åˆå§‹å€¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">String newStr2 = Stream.of(str.split(<span class="hljs-string">&quot;&quot;</span>)).reduce(<span class="hljs-string">&quot;&quot;</span>, (str1, str2) -&gt; str1 + <span class="hljs-string">&quot;-&quot;</span> + str2);<br>System.out.println(newStr2);<br></code></pre></td></tr></table></figure><ul><li>ä½¿ç”¨reduceè®¡ç®—æ‰€æœ‰å•è¯æ€»é•¿åº¦</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Optional&lt;Integer&gt; length = Stream.of(str.split(<span class="hljs-string">&quot; &quot;</span>)).map(s -&gt; s.length()).reduce((len1, len2) -&gt; len1 + len2);<br>System.out.println(<span class="hljs-string">&quot;length:&quot;</span> + length.get());<br></code></pre></td></tr></table></figure><h5 id="5-max"><a href="#5-max" class="headerlink" title="5.max"></a>5.max</h5><p>æ±‚æœ€å¤§å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Optional&lt;String&gt; maxValue = Stream.of(str.split(<span class="hljs-string">&quot; &quot;</span>)).max((str1, str2) -&gt; str1.length() - str2.length());<br>System.out.println(<span class="hljs-string">&quot;maxValue:&quot;</span> + maxValue.get());<br></code></pre></td></tr></table></figure><h5 id="6-findFirst"><a href="#6-findFirst" class="headerlink" title="6.findFirst"></a>6.findFirst</h5><p>æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Optional&lt;String&gt; firstValue = Stream.of(str.split(<span class="hljs-string">&quot; &quot;</span>)).findFirst();<br>System.out.println(<span class="hljs-string">&quot;firstValue:&quot;</span> + firstValue.get());<br></code></pre></td></tr></table></figure><h3 id="4-æƒ°æ€§æ±‚å€¼"><a href="#4-æƒ°æ€§æ±‚å€¼" class="headerlink" title="4. æƒ°æ€§æ±‚å€¼"></a>4. æƒ°æ€§æ±‚å€¼</h3><p>æƒ°æ€§æ±‚å€¼ï¼šç»ˆç»“æ²¡æœ‰è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œå»¶è¿Ÿæ–¹æ³•ä¸ä¼šæ‰§è¡Œã€‚ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.stream.IntStream;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StreamDemo1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span>[] numbers = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;;<br>        <span class="hljs-keyword">int</span> num2 = IntStream.of(numbers).map(StreamDemo1::doubleNum).sum();<br>        System.out.println(num2);<br>      <br>      <span class="hljs-comment">// è¿™é‡Œæ²¡æœ‰æ‰§è¡Œä¸­é—´æ“ä½œ</span><br>        IntStream.of(numbers).map(StreamDemo1::doubleNum);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">doubleNum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ‰§è¡Œäº†ä¹˜ä»¥2&quot;</span>);<br>        <span class="hljs-keyword">return</span> i * <span class="hljs-number">2</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta">&gt;</span> <span class="javascript">Task :StreamDemo1.main()</span><br>æ‰§è¡Œäº†ä¹˜ä»¥2<br>æ‰§è¡Œäº†ä¹˜ä»¥2<br>æ‰§è¡Œäº†ä¹˜ä»¥2<br>12<br></code></pre></td></tr></table></figure><p>ä¸­é—´æ“ä½œå°±æ˜¯ï¼šè¿”å›streamçš„æ“ä½œï¼Œå¦‚ï¼šmap</p><p>ç»ˆæ­¢æ“ä½œå°±æ˜¯ï¼šsum()</p><p>ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºdoubleNumæ‰§è¡Œäº†3æ¬¡</p><h3 id="5-å¹¶è¡Œæµ"><a href="#5-å¹¶è¡Œæµ" class="headerlink" title="5.å¹¶è¡Œæµ"></a>5.å¹¶è¡Œæµ</h3><h4 id="5-1-åˆ›å»ºä¸€ä¸ªå¹¶è¡Œæµ"><a href="#5-1-åˆ›å»ºä¸€ä¸ªå¹¶è¡Œæµ" class="headerlink" title="5.1 åˆ›å»ºä¸€ä¸ªå¹¶è¡Œæµ"></a>5.1 åˆ›å»ºä¸€ä¸ªå¹¶è¡Œæµ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParallelStream</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        IntStream.range(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>).parallel().peek(ParallelStream::debugger).count();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">debugger</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;debugger&quot;</span>+i);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta">&gt;</span> <span class="javascript">Task :ParallelStream.main()</span><br>debugger90<br>debugger81<br>debugger82<br>debugger83<br>debugger84<br>debugger85<br>debugger86<br>debugger65<br>debugger66<br>debugger67<br><span class="hljs-meta">...</span><br></code></pre></td></tr></table></figure><ul><li>å¤šæ¬¡è°ƒç”¨parallel &#x2F; sequentialï¼Œä»¥æœ€åä¸€ä¸ªä¸ºå‡†ï¼Œå¦‚ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParallelStream</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        IntStream.range(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)<br>                .parallel().peek(ParallelStream::debugger)<br>                .sequential().peek(ParallelStream::debugger2)<br>                .count();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">debugger2</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span> </span>&#123;<br>        System.err.println(<span class="hljs-string">&quot;debugger2: &quot;</span> + i);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">debugger</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;debugger1: &quot;</span> + i);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5-2-å¹¶è¡Œæµä½¿ç”¨è‡ªå·±å®šä¹‰çš„çº¿ç¨‹æ± "><a href="#5-2-å¹¶è¡Œæµä½¿ç”¨è‡ªå·±å®šä¹‰çš„çº¿ç¨‹æ± " class="headerlink" title="5.2 å¹¶è¡Œæµä½¿ç”¨è‡ªå·±å®šä¹‰çš„çº¿ç¨‹æ± "></a>5.2 å¹¶è¡Œæµä½¿ç”¨è‡ªå·±å®šä¹‰çš„çº¿ç¨‹æ± </h4><blockquote><p>åŸå› ï¼šé¿å…ä½¿ç”¨é»˜è®¤çº¿ç¨‹æ± ï¼Œé˜²æ­¢ä»»åŠ¡è¢«é˜»å¡</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.concurrent.ForkJoinPool;<br><span class="hljs-keyword">import</span> java.util.stream.IntStream;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParallelStream</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ForkJoinPool forkJoinPool = <span class="hljs-keyword">new</span> ForkJoinPool(<span class="hljs-number">20</span>);<br>        forkJoinPool.submit(() -&gt; IntStream.range(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)<br>                .parallel().peek(ParallelStream::debugger)<br>                .count());<br>        forkJoinPool.shutdown();<br><br>        <span class="hljs-keyword">synchronized</span> (forkJoinPool) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                forkJoinPool.wait();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">debugger</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span> </span>&#123;<br>        System.out.println(Thread.currentThread().getName() + <span class="hljs-string">&quot;debugger1: &quot;</span> + i);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6-Stream-æµçš„è¿è¡Œæœºåˆ¶"><a href="#6-Stream-æµçš„è¿è¡Œæœºåˆ¶" class="headerlink" title="6. Stream æµçš„è¿è¡Œæœºåˆ¶"></a>6. Stream æµçš„è¿è¡Œæœºåˆ¶</h3><p>æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯é“¾å¼è°ƒç”¨ï¼Œæ¯ä¸ªæ“ä½œåªä¼šå¯¹æ¯ä¸ªå…ƒç´ æ“ä½œä¸€æ¬¡ï¼›ï¼ˆæ˜¯é€šè¿‡ç»´æŠ¤ä¸€ä¸ªé“¾è¡¨å®ç°çš„ã€‚ï¼‰å…·ä½“å®ç°ï¼š</p><blockquote><ul><li>æ¯ä¸ªä¸­é—´æ“ä½œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„æµï¼Œæ¯ä¸ªæµé‡Œé¢éƒ½ä¼šæœ‰ä¸€ä¸ªSourceStageå±æ€§ï¼Œæ‰€æœ‰æµçš„SourceStageå±æ€§éƒ½æŒ‡å‘åŒä¸€ä¸ªåœ°æ–¹headã€å°±æ˜¯åŸå§‹æµçš„å¤´éƒ¨ã€‘ï¼›</li><li>å¦‚æœä¸€ä¸ªä¸­é—´æ“ä½œä¹‹åè¿˜æœ‰ä¸­é—´æ“ä½œï¼Œé‚£ä¹ˆè¿™ä¸ªä¸­é—´æ“ä½œå¯¹åº”çš„æµä¸­nextStageå±æ€§å°±ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´æ“ä½œå¯¹åº”çš„æµï¼Œå¦åˆ™å°±æ˜¯null</li></ul></blockquote><p>æ³¨ï¼šparallel &#x2F; sequentialä¹Ÿæ˜¯ä¸­é—´æ“ä½œï¼Œä½†æ˜¯ä»–ä»¬å‘¢ä¸åˆ›å»ºæµï¼Œåªæ˜¯ä¿®æ”¹head é‡Œçš„å¹¶è¡Œæ ‡å¿—ï¼šparallel</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>streamæµ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java8çš„æ–°ç‰¹æ€§ä¹‹lambdaè¡¨è¾¾å¼</title>
    <link href="/Java8%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8Blambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <url>/Java8%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8Blambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h3 id="1-å‡½æ•°æ¥å£"><a href="#1-å‡½æ•°æ¥å£" class="headerlink" title="1.å‡½æ•°æ¥å£"></a>1.å‡½æ•°æ¥å£</h3><p>å‡½æ•°æ¥å£ï¼ˆ<code>@FunctionalInterface</code>ï¼‰éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ul><li>ç±»å‹æ˜¯æ¥å£</li><li>æœ‰ä¸”åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•</li></ul><p>ä¾‹å¦‚ï¼šRunnableæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Runnable</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…¶å®è¿™ä¹Ÿæ˜¯è¦æ±‚æˆ‘ä»¬æ¥å£çš„è®¾è®¡å°½é‡å°ï¼Œç¬¦åˆå•ä¸€è´£ä»»åˆ¶ï¼Œä¸€ä¸ªæ¥å£åªåšä¸€ä¸ªäº‹ï¼Œè¿™æ ·ä½¿ç”¨lambdaå°±ä¼šæ¯”è¾ƒæ–¹ä¾¿ã€‚</p><h3 id="2-lambdaè¡¨è¾¾å¼æ˜¯ä¸ªå•¥ï¼Ÿ"><a href="#2-lambdaè¡¨è¾¾å¼æ˜¯ä¸ªå•¥ï¼Ÿ" class="headerlink" title="2. lambdaè¡¨è¾¾å¼æ˜¯ä¸ªå•¥ï¼Ÿ"></a>2. lambdaè¡¨è¾¾å¼æ˜¯ä¸ªå•¥ï¼Ÿ</h3><p><strong>lambdaè¡¨è¾¾å¼</strong>æ˜¯<strong>Java8</strong>çš„æ–°ç‰¹æ€§ï¼Œå®ƒå°±æ˜¯å°±æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œç®­å¤´å·¦è¾¹æ˜¯å‡½æ•°çš„å‚æ•°ï¼Œå³è¾¹æ˜¯å‡½æ•°çš„æ‰§è¡Œä½“ã€‚</p><span id="more"></span><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>      <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> Runnable() &#123;<br>          <span class="hljs-meta">@Override</span><br>          <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>              System.out.println(<span class="hljs-string">&quot;æ­£å¸¸åˆ›å»ºä¸€ä¸ªçº¿ç¨‹&quot;</span>);<br>          &#125;<br>      &#125;).start();<br>      # å®é™…ä¸Šæ˜¯è¿”å›äº†ä¸€ä¸ªå®ç°äº†Runnableçš„å®ä¾‹ï¼Œç®­å¤´å·¦è¾¹æ˜¯å‚æ•°ï¼Œå³è¾¹æ˜¯æ–¹æ³•ä½“<br>      <span class="hljs-keyword">new</span> Thread(()-&gt; System.out.println(<span class="hljs-string">&quot;Lambdaåˆ›å»ºä¸€ä¸ªçº¿ç¨‹&quot;</span>)).start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šé¢çš„ä»£ç ä¸ºä¾‹ï¼ŒRunnableæ¥å£ä»…æœ‰ä¸€ä¸ªrunæ–¹æ³•ï¼Œå¹¶ä¸”è¯¥æ–¹æ³•æ²¡æœ‰å‚æ•°ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨å¯ä»¥è‡ªåŠ¨æ¨æ–­å‡ºç®­å¤´åçš„å†…å®¹ä¸ºrunæ–¹æ³•çš„æ–¹æ³•ä½“ã€‚</p><p>å¦‚æœRunnableæ¥å£ä¸­å«æœ‰å¤šä¸ªæ–¹æ³•ï¼Œç¼–è¯‘å™¨å°†æ— æ³•ç¼–è¯‘lambdaè¡¨è¾¾å¼ï¼Œå¯ä»¥çœ‹å‡ºï¼Œlambdaè¡¨è¾¾å¼æ˜¯æ ¹æ®ç¼–è¯‘å™¨çš„éšå¼æ¨æ–­æ¥ç®€åŒ–ä»£ç çš„ã€‚æ‰€ä»¥ï¼Œ<strong>lambdaè¡¨è¾¾å¼éœ€è¦å‡½æ•°å¼æ¥å£çš„æ”¯æŒã€‚</strong></p><p><strong>å®ä¾‹:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">MoneyFormat</span></span>&#123;<br>    <span class="hljs-function">String <span class="hljs-title">format</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span></span>;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MoneyDemo</span> </span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> money;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MoneyDemo</span><span class="hljs-params">(<span class="hljs-keyword">int</span> money)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.money = money;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">printMoney</span><span class="hljs-params">(MoneyFormat moneyFormat)</span></span>&#123;<br>        System.out.println(String.format(<span class="hljs-string">&quot;é‡‘é¢æ•°ä¸ºï¼š&quot;</span> + moneyFormat.format(<span class="hljs-keyword">this</span>.money)));<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        MoneyDemo moneyDemo = <span class="hljs-keyword">new</span> MoneyDemo(<span class="hljs-number">999</span>);<br>        moneyDemo.printMoney(i -&gt; <span class="hljs-keyword">new</span> DecimalFormat(<span class="hljs-string">&quot;#,##&quot;</span>).format(i));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”±ä¸Šå¯è§ï¼Œæˆ‘ä»¬ä¸å…³å¿ƒæ¥å£çš„åå­—æ˜¯ä»€ä¹ˆï¼Œåªå…³å¿ƒè¾“å…¥æ˜¯intï¼Œè¾“å‡º æ˜¯stringï¼Œå› æ­¤ä¸Šé¢ä»£ç å¯ä¼˜åŒ–ä¸ºï¼š</p><p>åˆ é™¤interface MoneyFormatï¼Œä½¿ç”¨jdk8å¸¦çš„å‡½æ•°æ¥å£Function&lt;Integer,String&gt;æ›¿ä»£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MoneyDemo</span> </span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> money;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MoneyDemo</span><span class="hljs-params">(<span class="hljs-keyword">int</span> money)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.money = money;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">printMoney</span><span class="hljs-params">(Function&lt;Integer,String&gt; moneyFormat)</span></span>&#123;<br>        System.out.println(String.format(<span class="hljs-string">&quot;é‡‘é¢æ•°ä¸ºï¼š&quot;</span> + moneyFormat.apply(<span class="hljs-keyword">this</span>.money)));<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        MoneyDemo moneyDemo = <span class="hljs-keyword">new</span> MoneyDemo(<span class="hljs-number">999</span>);<br>        moneyDemo.printMoney(i -&gt; <span class="hljs-keyword">new</span> DecimalFormat(<span class="hljs-string">&quot;#,##&quot;</span>).format(i));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h2 id="3-lambdaè¡¨è¾¾å¼å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£"><a href="#3-lambdaè¡¨è¾¾å¼å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£" class="headerlink" title="3. lambdaè¡¨è¾¾å¼å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£"></a>3. lambdaè¡¨è¾¾å¼å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£</h2><p>ä¸»è¦æ˜¯åˆ†å¸ƒåœ¨java.util.functionåŒ…ä¸­ï¼Œä¸‹é¢åªç®€å•åˆ—ä¸¾2ç§ï¼š</p><h4 id="2-1-Supplieræ¥å£"><a href="#2-1-Supplieræ¥å£" class="headerlink" title="2.1 Supplieræ¥å£"></a>2.1 Supplieræ¥å£</h4><ul><li><code>java.util.function.Supplier&lt;T&gt;</code> æ¥å£ä»…å«æœ‰ä¸€ä¸ªæ— å‚æ–¹æ³•,<code>T get()</code></li><li><code>Supplier&lt;T&gt;</code> æ¥å£æ˜¯ç”Ÿäº§å‹æ¥å£,æ¥å£æ³›å‹æŒ‡å®šä»€ä¹ˆç±»å‹,å°±è¿”å›ä»€ä¹ˆæ³›å‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.function.Supplier;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SupplierDemo</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">supplyName</span><span class="hljs-params">(Supplier&lt;String&gt; supplier)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> supplier.get();<br>    &#125;<br>  <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SupplierDemo supplierDemo = <span class="hljs-keyword">new</span> SupplierDemo();<br>        String name = supplierDemo.supplyName(() -&gt; <span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>);<br>        System.out.println(name);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-2-Consumeræ¥å£"><a href="#3-2-Consumeræ¥å£" class="headerlink" title="3.2 Consumeræ¥å£"></a>3.2 Consumeræ¥å£</h3><ul><li><code>java.util.function.Consumeræ¥å£&lt;T&gt;</code> æ¥å£ä»…å«æœ‰ä¸€ä¸ªæœ‰å‚æ–¹æ³•,<code>void accept(T t)</code></li><li><code>Consumeræ¥å£&lt;T&gt;</code> æ¥å£æ˜¯æ¶ˆè´¹å‹æ¥å£,æ¥å£æ³›å‹åˆ¶å®šä»€ä¹ˆç±»å‹,å°±æ¥å—ä»€ä¹ˆæ³›å‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.function.Consumer;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConsumerDemo</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">printName</span><span class="hljs-params">(String name, Consumer&lt;String&gt; consumer)</span> </span>&#123;<br>        consumer.accept(name);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ConsumerDemo consumerDemo = <span class="hljs-keyword">new</span> ConsumerDemo();<br>        consumerDemo.printName(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>, (String name) -&gt; System.out.println(<span class="hljs-string">&quot;å§“åä¸º : &quot;</span> + name));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lambdaè¡¨è¾¾å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java8çš„æ–°ç‰¹æ€§ä¹‹æ–¹æ³•å¼•ç”¨</title>
    <link href="/Java8%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8B%E6%96%B9%E6%B3%95%E5%BC%95%E7%94%A8/"/>
    <url>/Java8%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8B%E6%96%B9%E6%B3%95%E5%BC%95%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h3 id="1-æ–¹æ³•å¼•ç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-æ–¹æ³•å¼•ç”¨æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.æ–¹æ³•å¼•ç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.æ–¹æ³•å¼•ç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h3><blockquote><p>Java8çš„æ–°ç‰¹æ€§ä¹‹äºŒï¼šæ–¹æ³•å¼•ç”¨ã€‚æ–¹æ³•å¼•ç”¨å…¶å®ä¹Ÿç¦»ä¸å¼€Lambdaè¡¨è¾¾å¼ã€‚</p></blockquote><ul><li><p>æ–¹æ³•å¼•ç”¨é€šè¿‡æ–¹æ³•çš„åå­—æ¥æŒ‡å‘ä¸€ä¸ªæ–¹æ³•ã€‚</p></li><li><p>æ–¹æ³•å¼•ç”¨å¯ä»¥ä½¿è¯­è¨€çš„æ„é€ æ›´ç´§å‡‘ç®€æ´ï¼Œå‡å°‘å†—ä½™ä»£ç ã€‚</p></li><li><p>æ–¹æ³•å¼•ç”¨ä½¿ç”¨ä¸€å¯¹å†’å· <strong>::</strong> ã€‚</p></li></ul><h2 id="2ã€æ–¹æ³•å¼•ç”¨çš„åˆ†ç±»"><a href="#2ã€æ–¹æ³•å¼•ç”¨çš„åˆ†ç±»" class="headerlink" title="2ã€æ–¹æ³•å¼•ç”¨çš„åˆ†ç±»"></a>2ã€æ–¹æ³•å¼•ç”¨çš„åˆ†ç±»</h2><p>ä¸‹é¢ï¼Œæˆ‘ä»¬åœ¨ Car ç±»ä¸­å®šä¹‰äº† 4 ä¸ªæ–¹æ³•ä½œä¸ºä¾‹å­æ¥åŒºåˆ† Java ä¸­ 4 ç§ä¸åŒæ–¹æ³•çš„å¼•ç”¨ã€‚</p><span id="more"></span><table><thead><tr><th align="center">ç±»å‹</th><th>è¯­æ³•</th><th>å¯¹åº”lambdaè¡¨è¾¾å¼</th></tr></thead><tbody><tr><td align="center">é™æ€æ–¹æ³•å¼•ç”¨</td><td>ç±»å::staticMethod</td><td>(args) -&gt; ç±»å.staticMethod(args)</td></tr><tr><td align="center">å®ä¾‹æ–¹æ³•å¼•ç”¨</td><td>instance::instance_Method</td><td>(args) -&gt; instance.instance_Method(args)</td></tr><tr><td align="center">å¯¹è±¡æ–¹æ³•å¼•ç”¨</td><td>ç±»å::instance_Method</td><td>(inst,args) -&gt; ç±»å.instance_Method(args)</td></tr><tr><td align="center">æ„å»ºæ–¹æ³•å¼•ç”¨</td><td>ç±»å::new</td><td>(args) -&gt; new ç±»å(args)</td></tr></tbody></table><h3 id="3ã€æ–¹æ³•å¼•ç”¨ä¸¾ä¾‹"><a href="#3ã€æ–¹æ³•å¼•ç”¨ä¸¾ä¾‹" class="headerlink" title="3ã€æ–¹æ³•å¼•ç”¨ä¸¾ä¾‹"></a>3ã€æ–¹æ³•å¼•ç”¨ä¸¾ä¾‹</h3><h4 id="3-1-é™æ€æ–¹æ³•å¼•ç”¨"><a href="#3-1-é™æ€æ–¹æ³•å¼•ç”¨" class="headerlink" title="3.1 é™æ€æ–¹æ³•å¼•ç”¨"></a>3.1 é™æ€æ–¹æ³•å¼•ç”¨</h4><ul><li><p>å®ä¾‹1:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>  <span class="hljs-comment">//Consumer&lt;String&gt; consumer = s -&gt; System.out.println(s); è¾“å‡ºçš„å‚æ•°å’Œè¾“å…¥çš„å‚æ•°ä¸€è‡´ï¼Œå¯ä»¥ç¼©å†™</span><br>    Consumer&lt;String&gt; consumer = System.out::println;<br>    consumer.accept(<span class="hljs-string">&quot;æ¥å—çš„æ•°æ®&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p> å®ä¾‹ä¸­æˆ‘ä»¬å°† System.out::println æ–¹æ³•ä½œä¸ºé™æ€æ–¹æ³•æ¥å¼•ç”¨ã€‚</p></li><li><p>å®ä¾‹2:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodReferenceDemo</span> </span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> String name = <span class="hljs-string">&quot;å•¸å¤©çŠ¬&quot;</span>;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">bark</span><span class="hljs-params">(Dog dog)</span> </span>&#123;<br>            System.out.println(dog + <span class="hljs-string">&quot;ç‹—å«äº†&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;<br>        &#125;<br>    &#125;<br>     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>       <span class="hljs-comment">//é™æ€æ–¹æ³•</span><br>        Dog dog = <span class="hljs-keyword">new</span> Dog();<br>        Consumer&lt;Dog&gt; consumer2 = Dog::bark;<br>        consumer2.accept(dog);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h4 id="3-2-å®ä¾‹æ–¹æ³•å¼•ç”¨"><a href="#3-2-å®ä¾‹æ–¹æ³•å¼•ç”¨" class="headerlink" title="3.2 å®ä¾‹æ–¹æ³•å¼•ç”¨"></a>3.2 å®ä¾‹æ–¹æ³•å¼•ç”¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.function.Function;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodReferenceDemo</span> </span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> food_weight = <span class="hljs-number">10</span>;<br>        <br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">eat</span><span class="hljs-params">(<span class="hljs-keyword">int</span> weight)</span> </span>&#123;<br>            System.out.println(<span class="hljs-string">&quot;å°ç‹—åƒäº†&quot;</span> + weight + <span class="hljs-string">&quot;æ–¤ç‹—ç²®&quot;</span>);<br>            <span class="hljs-keyword">this</span>.food_weight -= weight;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.food_weight;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Dog dog = <span class="hljs-keyword">new</span> Dog();<br>        <span class="hljs-comment">// Function&lt;Integer, Integer&gt; function = dog::eat;</span><br>        <span class="hljs-comment">// UnaryOperator&lt;Integer&gt; function = dog::eat;</span><br>        <span class="hljs-comment">// int weight = function.apply(3);</span><br>        IntUnaryOperator function = dog::eat;<br>        <span class="hljs-keyword">int</span> weight = function.applyAsInt(<span class="hljs-number">3</span>);<br>        System.out.println(<span class="hljs-string">&quot;è¿˜å‰©ä½™&quot;</span> + weight + <span class="hljs-string">&quot;æ–¤ç‹—ç²®&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„eatæ–¹æ³•ï¼Œé¡µå¯æ”¹å†™ä¸º<code>public int eat(Dog this, int weight) </code>ç¼–è¯‘ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚å› æ­¤&#x3D;ã€‹</p><blockquote><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">JDkä¼šé»˜è®¤æŠŠå½“å‰å®ä¾‹ä¼ å…¥åˆ°éé™æ€æ–¹æ³•ï¼Œå‚æ•°åä¸º<span class="hljs-keyword">this</span>ï¼Œä½ç½®æ˜¯ç¬¬ä¸€ä¸ª<br></code></pre></td></tr></table></figure></blockquote><h4 id="3-3-æ„å»ºæ–¹æ³•å¼•ç”¨"><a href="#3-3-æ„å»ºæ–¹æ³•å¼•ç”¨" class="headerlink" title="3.3 æ„å»ºæ–¹æ³•å¼•ç”¨"></a>3.3 æ„å»ºæ–¹æ³•å¼•ç”¨</h4><ul><li>æ— å‚æ•°çš„æ„é€ æ–¹æ³•å¼•ç”¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.function.Supplier;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodReferenceDemo</span> </span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> String name = <span class="hljs-string">&quot;å•¸å¤©çŠ¬&quot;</span>;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Supplier&lt;Dog&gt; supplier = Dog::<span class="hljs-keyword">new</span>;<br>        System.out.println(supplier.get());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•çš„å¼•ç”¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.function.Function;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodReferenceDemo</span> </span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> String name = <span class="hljs-string">&quot;å•¸å¤©çŠ¬&quot;</span>;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Dog</span><span class="hljs-params">(String name)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.name = name;<br>        &#125;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Function&lt;String,Dog&gt; function2 =  Dog::<span class="hljs-keyword">new</span>;;<br>        System.out.println(function2.apply(<span class="hljs-string">&quot;å°æ‚æ¯›&quot;</span>));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–¹æ³•å¼•ç”¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ElasticSearchç®€ä»‹</title>
    <link href="/ElasticSearch%E7%AE%80%E4%BB%8B/"/>
    <url>/ElasticSearch%E7%AE%80%E4%BB%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="ElasticSearchç®€ä»‹"><a href="#ElasticSearchç®€ä»‹" class="headerlink" title="ElasticSearchç®€ä»‹"></a>ElasticSearchç®€ä»‹</h1><h2 id="Esæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Esæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Esæ˜¯ä»€ä¹ˆï¼Ÿ"></a>Esæ˜¯ä»€ä¹ˆï¼Ÿ</h2><ul><li>Elasticsearchæ˜¯ç”¨Javaå¼€å‘å¹¶ä¸”æ˜¯å½“å‰æœ€æµè¡Œçš„å¼€æºçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚</li><li>èƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚</li><li>å®¢æˆ·ç«¯æ”¯æŒJavaã€.NETï¼ˆC#ï¼‰ã€PHPã€Pythonã€Rubyç­‰å¤šç§è¯­è¨€ã€‚</li></ul><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p>å…³é”®è¯æœç´¢ã€‚</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224603261.png" alt="image-20230228224603261"></p><blockquote><p>ä»ä¸Šé¢çš„æœç´¢ç»“æœï¼Œå¯ä»¥çœ‹å‡ºä¸æ˜¯æ ¹æ®æ¨¡ç³ŠåŒ¹é…å»è¿›è¡Œæœç´¢çš„</p></blockquote><h2 id="ElasticSearchä¸Luceneçš„å…³ç³»"><a href="#ElasticSearchä¸Luceneçš„å…³ç³»" class="headerlink" title="ElasticSearchä¸Luceneçš„å…³ç³»"></a>ElasticSearchä¸Luceneçš„å…³ç³»</h2><ul><li>Luceneå¯ä»¥è¢«è®¤ä¸ºæ˜¯è¿„ä»Šä¸ºæ­¢æœ€å…ˆè¿›ã€æ€§èƒ½æœ€å¥½çš„ã€åŠŸèƒ½æœ€å…¨çš„æœç´¢å¼•æ“åº“ï¼ˆæ¡†æ¶ï¼‰</li></ul><h3 id="Luceneç¼ºç‚¹ï¼š"><a href="#Luceneç¼ºç‚¹ï¼š" class="headerlink" title="Luceneç¼ºç‚¹ï¼š"></a>Luceneç¼ºç‚¹ï¼š</h3><ul><li>æƒ³è¦ä½¿ç”¨Luceneï¼Œå¿…é¡»ä½¿ç”¨Javaæ¥ä½œä¸ºå¼€å‘è¯­è¨€å¹¶å°†å…¶ç›´æ¥é›†æˆåˆ°ä½ çš„åº”ç”¨ä¸­ã€‚</li><li>Luceneçš„é…ç½®åŠä½¿ç”¨éå¸¸å¤æ‚ï¼Œä½ éœ€è¦æ·±å…¥äº†è§£æ£€ç´¢çš„ç›¸å…³çŸ¥è¯†æ¥ç†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</li><li>ä½¿ç”¨éå¸¸å¤æ‚-åˆ›å»ºç´¢å¼•å’Œæœç´¢ç´¢å¼•ä»£ç ç¹æ‚ã€‚</li><li>ä¸æ”¯æŒé›†ç¾¤ç¯å¢ƒ-ç´¢å¼•æ•°æ®ä¸åŒæ­¥ï¼ˆä¸æ”¯æŒå¤§å‹é¡¹ç›®ï¼‰</li><li>ç´¢å¼•æ•°æ®å¦‚æœå¤ªå¤šå°±ä¸è¡Œï¼Œç´¢å¼•åº“å’Œåº”ç”¨æ‰€åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨,å…±åŒå ç”¨ç¡¬ç›˜.å…±ç”¨ç©ºé—´å°‘.</li></ul><p><strong>ä¸Šè¿°Luceneæ¡†æ¶ä¸­çš„ç¼ºç‚¹,ESå…¨éƒ¨éƒ½èƒ½è§£å†³.</strong></p><h2 id="å“ªäº›å…¬å¸åœ¨ä½¿ç”¨Elasticsearch"><a href="#å“ªäº›å…¬å¸åœ¨ä½¿ç”¨Elasticsearch" class="headerlink" title="å“ªäº›å…¬å¸åœ¨ä½¿ç”¨Elasticsearch"></a>å“ªäº›å…¬å¸åœ¨ä½¿ç”¨Elasticsearch</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224612979.png" alt="image-20230228224612979"></p><h2 id="ES-vs-Solræ¯”è¾ƒ"><a href="#ES-vs-Solræ¯”è¾ƒ" class="headerlink" title="ES vs Solræ¯”è¾ƒ"></a>ES vs Solræ¯”è¾ƒ</h2><ul><li>å½“å•çº¯çš„å¯¹å·²æœ‰æ•°æ®è¿›è¡Œæœç´¢æ—¶ï¼ŒSolræ›´å¿«ã€‚</li><li>å½“å®æ—¶å»ºç«‹ç´¢å¼•æ—¶,Solrä¼šäº§ç”Ÿioé˜»å¡ï¼ŒæŸ¥è¯¢æ€§èƒ½è¾ƒå·®,Elasticsearchå…·æœ‰æ˜æ˜¾çš„ä¼˜åŠ¿ã€‚</li><li>Solråˆ©ç”¨Zookeeperè¿›è¡Œåˆ†å¸ƒå¼ç®¡ç†ï¼Œè€ŒElasticsearchè‡ªèº«å¸¦æœ‰åˆ†å¸ƒå¼åè°ƒç®¡ç†åŠŸèƒ½ã€‚</li><li>Solræ”¯æŒæ›´å¤šæ ¼å¼çš„æ•°æ®ï¼Œæ¯”å¦‚JSONã€XMLã€CSVï¼Œè€ŒElasticsearchä»…æ”¯æŒjsonæ–‡ä»¶æ ¼å¼ã€‚</li><li>Solråœ¨ä¼ ç»Ÿçš„æœç´¢åº”ç”¨ä¸­è¡¨ç°å¥½äºElasticsearchï¼Œä½†åœ¨å¤„ç†å®æ—¶æœç´¢åº”ç”¨æ—¶æ•ˆç‡æ˜æ˜¾ä½äºElasticsearchã€‚</li><li>Solræ˜¯ä¼ ç»Ÿæœç´¢åº”ç”¨çš„æœ‰åŠ›è§£å†³æ–¹æ¡ˆï¼Œä½†Elasticsearchæ›´é€‚ç”¨äºæ–°å…´çš„å®æ—¶æœç´¢åº”ç”¨ã€‚</li></ul><h2 id="ESvså…³ç³»å‹æ•°æ®åº“"><a href="#ESvså…³ç³»å‹æ•°æ®åº“" class="headerlink" title="ESvså…³ç³»å‹æ•°æ®åº“"></a>ESvså…³ç³»å‹æ•°æ®åº“</h2><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224621969.png" alt="image-20230228224621969"></p><h2 id="Luceneå…¨æ–‡æ£€ç´¢æ¡†æ¶"><a href="#Luceneå…¨æ–‡æ£€ç´¢æ¡†æ¶" class="headerlink" title="Luceneå…¨æ–‡æ£€ç´¢æ¡†æ¶"></a>Luceneå…¨æ–‡æ£€ç´¢æ¡†æ¶</h2><h3 id="ä»€ä¹ˆæ˜¯å…¨æ–‡æ£€ç´¢"><a href="#ä»€ä¹ˆæ˜¯å…¨æ–‡æ£€ç´¢" class="headerlink" title="ä»€ä¹ˆæ˜¯å…¨æ–‡æ£€ç´¢"></a>ä»€ä¹ˆæ˜¯å…¨æ–‡æ£€ç´¢</h3><ul><li>å…¨æ–‡æ£€ç´¢æ˜¯æŒ‡ï¼šé€šè¿‡ä¸€ä¸ªç¨‹åºæ‰«ææ–‡æœ¬ä¸­çš„æ¯ä¸€ä¸ªå•è¯ï¼Œé’ˆå¯¹å•è¯å»ºç«‹ç´¢å¼•ï¼Œå¹¶ä¿å­˜è¯¥å•è¯åœ¨æ–‡æœ¬ä¸­çš„ä½ç½®ã€ä»¥åŠå‡ºç°çš„æ¬¡æ•°ã€‚</li><li>ç”¨æˆ·æŸ¥è¯¢æ—¶ï¼Œé€šè¿‡ä¹‹å‰å»ºç«‹å¥½çš„ç´¢å¼•æ¥æŸ¥è¯¢ï¼Œå°†ç´¢å¼•ä¸­å•è¯å¯¹åº”çš„æ–‡æœ¬ä½ç½®ã€å‡ºç°çš„æ¬¡æ•°è¿”å›ç»™ç”¨æˆ·ï¼Œå› ä¸ºæœ‰äº†å…·ä½“æ–‡æœ¬çš„ä½ç½®ï¼Œæ‰€ä»¥å°±å¯ä»¥å°†å…·ä½“å†…å®¹è¯»å–å‡ºæ¥äº†</li></ul><h3 id="è¯åŸç†ä¹‹å€’æ’ç´¢å¼•"><a href="#è¯åŸç†ä¹‹å€’æ’ç´¢å¼•" class="headerlink" title="è¯åŸç†ä¹‹å€’æ’ç´¢å¼•"></a>è¯åŸç†ä¹‹å€’æ’ç´¢å¼•</h3><p>å¯¹äºå…³ç³»å‹æ•°æ®åº“mysqlæ¥è¯´ï¼Œ<strong>æ™®é€šçš„ç´¢å¼•ç»“æ„å°±æ˜¯â€œid-&gt;é¢˜ç›®-&gt;å†…å®¹â€ï¼Œ</strong>åœ¨æˆ‘ä»¬æœç´¢çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“idæˆ–è€…é¢˜ç›®<strong>ï¼Œé‚£ä¹ˆæ£€ç´¢æ•ˆç‡æ˜¯å¾ˆé«˜æ•ˆçš„ï¼Œå› ä¸ºâ€œidâ€ã€â€œé¢˜ç›®â€æ˜¯å¾ˆæ–¹ä¾¿åˆ›å»ºç´¢å¼•çš„ã€‚</strong></p><p>é‚£ä¹ˆ<strong>å€’æ’åºç´¢å¼•</strong>çš„ç»“æ„æ˜¯æ€æ ·çš„å‘¢ï¼Ÿç®€å•æ¥è®²<strong>å°±æ˜¯â€œä»¥å†…å®¹çš„å…³é”®è¯â€å»ºç«‹ç´¢å¼•ï¼Œ</strong>æ˜ å°„å…³ç³»ä¸º<strong>â€œå†…å®¹çš„å…³é”®è¯-&gt;IDâ€ã€‚</strong>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨â€œå…³é”®è¯â€ä¸­è¿›è¡Œæ£€ç´¢</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228224640464.png" alt="image-20230228224640464"></p><blockquote><p>å¯¹äºä¸Šé¢çš„åœºæ™¯ï¼Œè¾“å…¥ä¸ºhelloï¼Œä¼šæ ¹æ®helloå®šä½åˆ°æ­¤æ—¶æ•°æ®çš„idä¸º1å’Œ2ï¼Œè¿›è€ŒæŸ¥å‡ºå¯¹åº”çš„æ•°æ®ã€‚</p></blockquote><h2 id="Elasticsearchä¸­çš„æ ¸å¿ƒæ¦‚å¿µ"><a href="#Elasticsearchä¸­çš„æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="Elasticsearchä¸­çš„æ ¸å¿ƒæ¦‚å¿µ"></a>Elasticsearchä¸­çš„æ ¸å¿ƒæ¦‚å¿µ</h2><h3 id="ç´¢å¼•index"><a href="#ç´¢å¼•index" class="headerlink" title="ç´¢å¼•index"></a>ç´¢å¼•index</h3><ul><li>ä¸€ä¸ªç´¢å¼•å°±æ˜¯ä¸€ä¸ªæ‹¥æœ‰å‡ åˆ†ç›¸ä¼¼ç‰¹å¾çš„æ–‡æ¡£çš„é›†åˆã€‚æ¯”å¦‚è¯´ï¼Œå¯ä»¥æœ‰ä¸€ä¸ªå®¢æˆ·æ•°æ®çš„ç´¢å¼•ï¼Œå¦ä¸€ä¸ªäº§å“ç›®å½•çš„ç´¢å¼•ï¼Œè¿˜æœ‰ä¸€ä¸ªè®¢å•æ•°æ®çš„ç´¢å¼•</li><li>ä¸€ä¸ªç´¢å¼•ç”±ä¸€ä¸ªåå­—æ¥æ ‡è¯†ï¼ˆå¿…é¡»å…¨éƒ¨æ˜¯å°å†™å­—æ¯çš„ï¼‰ï¼Œå¹¶ä¸”å½“æˆ‘ä»¬è¦å¯¹å¯¹åº”äºè¿™ä¸ªç´¢å¼•ä¸­çš„æ–‡æ¡£è¿›è¡Œç´¢å¼•ã€æœç´¢ã€æ›´æ–°å’Œåˆ é™¤çš„æ—¶å€™ï¼Œéƒ½è¦ä½¿ç”¨åˆ°è¿™ä¸ªåå­—</li></ul><h3 id="æ˜ å°„mapping"><a href="#æ˜ å°„mapping" class="headerlink" title="æ˜ å°„mapping"></a>æ˜ å°„mapping</h3><ul><li><p>ElasticSearchä¸­çš„æ˜ å°„ï¼ˆMappingï¼‰ç”¨æ¥å®šä¹‰ä¸€ä¸ªæ–‡æ¡£</p></li><li><p>mappingæ˜¯å¤„ç†æ•°æ®çš„æ–¹å¼å’Œè§„åˆ™æ–¹é¢åšä¸€äº›é™åˆ¶ï¼Œå¦‚æŸä¸ªå­—æ®µçš„æ•°æ®ç±»å‹ã€é»˜è®¤å€¼ã€åˆ†è¯å™¨ã€æ˜¯å¦è¢«ç´¢å¼•ç­‰ç­‰ï¼Œè¿™äº›éƒ½æ˜¯æ˜ å°„é‡Œé¢å¯ä»¥è®¾ç½®çš„</p></li></ul><h3 id="å­—æ®µField"><a href="#å­—æ®µField" class="headerlink" title="å­—æ®µField"></a>å­—æ®µField</h3><ul><li>ç›¸å½“äºæ˜¯æ•°æ®è¡¨çš„å­—æ®µ|åˆ—</li></ul><h3 id="å­—æ®µç±»å‹Type"><a href="#å­—æ®µç±»å‹Type" class="headerlink" title="å­—æ®µç±»å‹Type"></a>å­—æ®µç±»å‹Type</h3><p>æ¯ä¸€ä¸ªå­—æ®µéƒ½åº”è¯¥æœ‰ä¸€ä¸ªå¯¹åº”çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼šTextã€Keywordã€Byteç­‰</p><h3 id="æ–‡æ¡£document"><a href="#æ–‡æ¡£document" class="headerlink" title="æ–‡æ¡£document"></a>æ–‡æ¡£document</h3><p>ä¸€ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªå¯è¢«ç´¢å¼•çš„åŸºç¡€ä¿¡æ¯å•å…ƒï¼Œç±»ä¼¼ä¸€æ¡è®°å½•ã€‚æ–‡æ¡£ä»¥JSONï¼ˆJavascriptObjectNotationï¼‰æ ¼å¼æ¥è¡¨ç¤ºï¼›</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Oauth2</title>
    <link href="/oauth2/"/>
    <url>/oauth2/</url>
    
    <content type="html"><![CDATA[<hr><h1 id="oauth2-0"><a href="#oauth2-0" class="headerlink" title="oauth2.0"></a>oauth2.0</h1><h2 id="ä¸€-oauth2-0-äº§ç”Ÿ"><a href="#ä¸€-oauth2-0-äº§ç”Ÿ" class="headerlink" title="ä¸€. oauth2.0 äº§ç”Ÿ"></a>ä¸€. oauth2.0 äº§ç”Ÿ</h2><ol><li>ä¼ ç»Ÿæ–¹å¼ï¼šç”¨æˆ·å’Œç¬¬ä¸‰æ–¹å…±äº«å¯†ç <ul><li>ä¸å®‰å…¨ã€‚æœªæ¥å¯èƒ½ä¼šæŒä¹…è®¿é—®èµ„æºï¼Œç¬¬ä¸‰æ–¹å­˜å‚¨ç”¨æˆ·å¯†ç ä¸å®‰å…¨ï¼Œå› ä¸ºä»–å¯ä»¥è®¿é—®ç”¨æˆ·çš„æ‰€æœ‰èµ„æº</li><li>æ”¹å¯†ç çš„è¯ï¼Œç¬¬ä¸‰æ–¹ä¼šå¤±æ•ˆ</li></ul></li></ol><h2 id="äºŒ-oauth2-0æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#äºŒ-oauth2-0æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="äºŒ. oauth2.0æ˜¯ä»€ä¹ˆï¼Ÿ"></a>äºŒ. oauth2.0æ˜¯ä»€ä¹ˆï¼Ÿ</h2><blockquote><ul><li><p>oauth2.0 æ˜¯ä¸€ç§æˆæƒæ–¹å¼ï¼Œä½¿ç¬¬ä¸‰æ–¹å¯ä»¥è·å¾—å¯¹ç”¨æˆ·èµ„æºçš„è®¿é—®</p></li><li><p>ä»–çš„æ ¸å¿ƒå°±æ˜¯ï¼šå‘ç¬¬ä¸‰æ–¹åº”ç”¨é¢å‘ä»¤ç‰Œ</p></li><li><p>ä¸ç®¡å“ªä¸€ç§æˆæƒæ–¹å¼ï¼Œç¬¬ä¸‰æ–¹åº”ç”¨ç”³è¯·ä»¤ç‰Œä¹‹å‰ï¼Œéƒ½å¿…é¡»å…ˆåˆ°ç³»ç»Ÿå¤‡æ¡ˆï¼Œè¯´æ˜è‡ªå·±çš„èº«ä»½ï¼Œç„¶åä¼šæ‹¿åˆ°ä¸¤ä¸ªèº«ä»½è¯†åˆ«ç ï¼šå®¢æˆ·ç«¯ IDï¼ˆclient IDï¼‰å’Œå®¢æˆ·ç«¯å¯†é’¥ï¼ˆclient secretï¼‰</p></li></ul></blockquote><h2 id="ä¸‰-OAuth-2-0-è§„å®šäº†å››ç§è·å¾—ä»¤ç‰Œçš„æµç¨‹"><a href="#ä¸‰-OAuth-2-0-è§„å®šäº†å››ç§è·å¾—ä»¤ç‰Œçš„æµç¨‹" class="headerlink" title="ä¸‰.OAuth 2.0 è§„å®šäº†å››ç§è·å¾—ä»¤ç‰Œçš„æµç¨‹"></a>ä¸‰.OAuth 2.0 è§„å®šäº†å››ç§è·å¾—ä»¤ç‰Œçš„æµç¨‹</h2><span id="more"></span><h3 id="3-1-æˆæƒç æ¨¡å¼"><a href="#3-1-æˆæƒç æ¨¡å¼" class="headerlink" title="3.1 æˆæƒç æ¨¡å¼"></a>3.1 æˆæƒç æ¨¡å¼</h3><p><strong>ç¬¬ä¸‰æ–¹åº”ç”¨å…ˆç”³è¯·ä¸€ä¸ªæˆæƒç ï¼Œç„¶åå†ç”¨è¯¥ç è·å–ä»¤ç‰Œã€‚</strong></p><ol><li><p>ç¬¬ä¸€æ­¥ï¼ŒA ç½‘ç«™æä¾›ä¸€ä¸ªé“¾æ¥ï¼Œç”¨æˆ·ç‚¹å‡»åå°±ä¼šè·³è½¬åˆ° B ç½‘ç«™ï¼Œæˆæƒç”¨æˆ·æ•°æ®ç»™ A ç½‘ç«™ä½¿ç”¨ã€‚å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">https:<span class="hljs-comment">//b.com/oauth/authorize?</span><br>  response_type=code&amp;                        <br>  client_id=CLIENT_ID&amp;<br>  redirect_uri=CALLBACK_URL&amp;<br>  scope=read<br></code></pre></td></tr></table></figure><ul><li>response_typeè¡¨ç¤ºè¦æ±‚è¿”å›æˆæƒç </li><li>client_idè®©Bç½‘ç«™çŸ¥é“æ˜¯è°åœ¨è¯·æ±‚</li><li>redirect_uri æ˜¯Bç½‘ç«™æ¥å—æˆ–å¤„ç†åè·³è½¬çš„URL</li><li>scope è¡¨ç¤ºæˆæƒçš„èŒƒå›´ï¼Œè¿™é‡Œæ˜¯åªè¯»</li></ul></li><li><p>ç¬¬äºŒæ­¥ï¼Œæ­¤æ—¶Bç½‘ç«™ä¼šè¯¢é—®ç”¨æˆ·æ˜¯å¦ç»™äºˆAç½‘ç«™æˆæƒï¼Œç”¨æˆ·è¡¨ç¤ºåŒæ„ï¼Œè¿™æ—¶Bç½‘ç«™å°±ä¼šè·³è½¬åˆ°ä¸Šä¸€æ­¥<code>redirect_uri</code> ä¸­çš„åœ°å€ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„callbackåœ°å€ï¼‰ï¼ŒåŒæ—¶è¿”å›ä¸€ä¸ªæˆæƒç ï¼Œå¦‚ä¸‹é¢çš„åœ°å€ï¼Œå…¶ä¸­ï¼Œ<code>code</code>å‚æ•°å°±æ˜¯æˆæƒç </p></li></ol><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//a.com/callback?code=AUTHORIZATION_CODE</span><br></code></pre></td></tr></table></figure><ol start="3"><li>ç¬¬ä¸‰æ­¥ï¼ŒAç½‘ç«™æ‹¿åˆ°æˆæƒç åï¼Œå°±å¯ä»¥æ ¹æ®è¯¥æˆæƒç ï¼Œåœ¨åç«¯å‘Bç½‘ç«™è¯·æ±‚<strong>ä»¤ç‰Œ</strong></li></ol><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">https</span>:<span class="hljs-string">//b.com/oauth/token?</span><br> <span class="hljs-attr">client_id</span>=<span class="hljs-string">CLIENT_ID&amp;</span><br> <span class="hljs-attr">client_secret</span>=<span class="hljs-string">CLIENT_SECRET&amp;</span><br> <span class="hljs-attr">grant_type</span>=<span class="hljs-string">authorization_code&amp;</span><br> <span class="hljs-attr">code</span>=<span class="hljs-string">AUTHORIZATION_CODE&amp;</span><br> <span class="hljs-attr">redirect_uri</span>=<span class="hljs-string">CALLBACK_URL</span><br></code></pre></td></tr></table></figure><ul><li><p><code>client_id</code>å‚æ•°å’Œ<code>client_secret</code>å‚æ•°ç”¨æ¥è®© B ç¡®è®¤ A çš„èº«ä»½ï¼ˆ<code>client_secret</code>å‚æ•°æ˜¯ä¿å¯†çš„ï¼Œå› æ­¤åªèƒ½åœ¨åç«¯å‘è¯·æ±‚ï¼‰</p></li><li><p><code>grant_type</code>å‚æ•°çš„å€¼æ˜¯<code>AUTHORIZATION_CODE</code>ï¼Œè¡¨ç¤ºé‡‡ç”¨çš„æˆæƒæ–¹å¼æ˜¯æˆæƒç </p></li><li><p><code>code</code>å‚æ•°æ˜¯ä¸Šä¸€æ­¥æ‹¿åˆ°çš„æˆæƒç </p></li><li><p><code>redirect_uri</code>å‚æ•°æ˜¯ä»¤ç‰Œé¢å‘åçš„å›è°ƒç½‘å€ã€‚</p></li></ul><ol start="4"><li><p>ç¬¬å››æ­¥ï¼ŒB ç½‘ç«™æ”¶åˆ°è¯·æ±‚ä»¥åï¼Œå°±ä¼šé¢å‘ä»¤ç‰Œã€‚å…·ä½“åšæ³•æ˜¯å‘<code>redirect_uri</code>æŒ‡å®šçš„ç½‘å€ï¼Œå‘é€ä¸€æ®µ JSON æ•°æ®ã€‚</p><figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs nim">&#123;    <br>  <span class="hljs-string">&quot;access_token&quot;</span>:<span class="hljs-string">&quot;ACCESS_TOKEN&quot;</span>,<br>  <span class="hljs-string">&quot;token_type&quot;</span>:<span class="hljs-string">&quot;bearer&quot;</span>,<br>  <span class="hljs-string">&quot;expires_in&quot;</span>:<span class="hljs-number">2592000</span>,<br>  <span class="hljs-string">&quot;refresh_token&quot;</span>:<span class="hljs-string">&quot;REFRESH_TOKEN&quot;</span>,<br>  <span class="hljs-string">&quot;scope&quot;</span>:<span class="hljs-string">&quot;read&quot;</span>,<br>  <span class="hljs-string">&quot;uid&quot;</span>:<span class="hljs-number">100101</span>,<br>  <span class="hljs-string">&quot;info&quot;</span>:<span class="hljs-meta">&#123;...&#125;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢ JSON æ•°æ®ä¸­ï¼Œ<code>access_token</code>å­—æ®µå°±æ˜¯ä»¤ç‰Œï¼ŒA ç½‘ç«™åœ¨åç«¯æ‹¿åˆ°äº†ã€‚</p></li></ol><h4 id="3-2-éšè—å¼æ¨¡å¼ï¼ˆé€‚åˆæ²¡æœ‰åå°çš„ç¬¬ä¸‰æ–¹ï¼‰"><a href="#3-2-éšè—å¼æ¨¡å¼ï¼ˆé€‚åˆæ²¡æœ‰åå°çš„ç¬¬ä¸‰æ–¹ï¼‰" class="headerlink" title="3.2 éšè—å¼æ¨¡å¼ï¼ˆé€‚åˆæ²¡æœ‰åå°çš„ç¬¬ä¸‰æ–¹ï¼‰"></a>3.2 éšè—å¼æ¨¡å¼ï¼ˆé€‚åˆæ²¡æœ‰åå°çš„ç¬¬ä¸‰æ–¹ï¼‰</h4><p>ç¬¬ä¸€æ­¥ï¼ŒA ç½‘ç«™æä¾›ä¸€ä¸ªé“¾æ¥ï¼Œè¦æ±‚ç”¨æˆ·è·³è½¬åˆ° B ç½‘ç«™ï¼Œæˆæƒç”¨æˆ·æ•°æ®ç»™ A ç½‘ç«™ä½¿ç”¨ã€‚</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">https</span>:<span class="hljs-string">//b.com/oauth/authorize?</span><br>  <span class="hljs-attr">response_type</span>=<span class="hljs-string">token&amp;</span><br>  <span class="hljs-attr">client_id</span>=<span class="hljs-string">CLIENT_ID&amp;</span><br>  <span class="hljs-attr">redirect_uri</span>=<span class="hljs-string">CALLBACK_URL&amp;</span><br>  <span class="hljs-attr">scope</span>=<span class="hljs-string">read</span><br></code></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼Œç”¨æˆ·è·³è½¬åˆ° B ç½‘ç«™ï¼Œç™»å½•ååŒæ„ç»™äºˆ A ç½‘ç«™æˆæƒã€‚è¿™æ—¶ï¼ŒB ç½‘ç«™å°±ä¼šè·³å›<code>redirect_uri</code>å‚æ•°æŒ‡å®šçš„è·³è½¬ç½‘å€ï¼Œå¹¶ä¸”æŠŠä»¤ç‰Œä½œä¸º URL å‚æ•°ï¼Œä¼ ç»™ A ç½‘ç«™ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>a.com/callback<span class="hljs-comment">#token=ACCESS_TOKEN</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢ URL ä¸­ï¼Œ<code>token</code>å‚æ•°å°±æ˜¯ä»¤ç‰Œï¼ŒA ç½‘ç«™å› æ­¤ç›´æ¥åœ¨å‰ç«¯æ‹¿åˆ°ä»¤ç‰Œã€‚</p><ol><li>ç‚¹å‡»é“¾æ¥ï¼Œè·³è½¬è‡³ç¬¬ä¸‰æ–¹</li><li>ç¬¬ä¸‰æ–¹ç›´æ¥æŠŠä»¤ç‰Œç»™å®¢æˆ·ç«¯</li></ol><p>æ³¨æ„ï¼Œä»¤ç‰Œçš„ä½ç½®æ˜¯ URL é”šç‚¹ï¼ˆfragmentï¼‰ï¼Œè€Œä¸æ˜¯æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆquerystringï¼‰ï¼Œè¿™æ˜¯å› ä¸º OAuth 2.0 å…è®¸è·³è½¬ç½‘å€æ˜¯ HTTP åè®®ï¼Œå› æ­¤å­˜åœ¨â€ä¸­é—´äººæ”»å‡»â€çš„é£é™©ï¼Œè€Œæµè§ˆå™¨è·³è½¬æ—¶ï¼Œé”šç‚¹ä¸ä¼šå‘åˆ°æœåŠ¡å™¨ï¼Œå°±å‡å°‘äº†æ³„æ¼ä»¤ç‰Œçš„é£é™©ã€‚</p><p>è¿™ç§æ–¹å¼æŠŠä»¤ç‰Œç›´æ¥ä¼ ç»™å‰ç«¯ï¼Œæ˜¯å¾ˆä¸å®‰å…¨çš„ã€‚å› æ­¤ï¼Œåªèƒ½ç”¨äºä¸€äº›å®‰å…¨è¦æ±‚ä¸é«˜çš„åœºæ™¯ï¼Œå¹¶ä¸”ä»¤ç‰Œçš„æœ‰æ•ˆæœŸå¿…é¡»éå¸¸çŸ­ï¼Œé€šå¸¸å°±æ˜¯ä¼šè¯æœŸé—´ï¼ˆsessionï¼‰æœ‰æ•ˆï¼Œæµè§ˆå™¨å…³æ‰ï¼Œä»¤ç‰Œå°±å¤±æ•ˆäº†ã€‚</p><h4 id="3-3-å¯†ç æ¨¡å¼ï¼ˆé£é™©æå¤§ï¼Œé€‚åˆäºç”¨æˆ·æå…¶ä¿¡ä»»ç¬¬ä¸‰æ–¹ï¼‰"><a href="#3-3-å¯†ç æ¨¡å¼ï¼ˆé£é™©æå¤§ï¼Œé€‚åˆäºç”¨æˆ·æå…¶ä¿¡ä»»ç¬¬ä¸‰æ–¹ï¼‰" class="headerlink" title="3.3 å¯†ç æ¨¡å¼ï¼ˆé£é™©æå¤§ï¼Œé€‚åˆäºç”¨æˆ·æå…¶ä¿¡ä»»ç¬¬ä¸‰æ–¹ï¼‰"></a>3.3 å¯†ç æ¨¡å¼ï¼ˆé£é™©æå¤§ï¼Œé€‚åˆäºç”¨æˆ·æå…¶ä¿¡ä»»ç¬¬ä¸‰æ–¹ï¼‰</h4><p><strong>å¦‚æœä½ é«˜åº¦ä¿¡ä»»æŸä¸ªåº”ç”¨ï¼ŒRFC 6749 ä¹Ÿå…è®¸ç”¨æˆ·æŠŠç”¨æˆ·åå’Œå¯†ç ï¼Œç›´æ¥å‘Šè¯‰è¯¥åº”ç”¨ã€‚è¯¥åº”ç”¨å°±ä½¿ç”¨ä½ çš„å¯†ç ï¼Œç”³è¯·ä»¤ç‰Œ</strong></p><ol><li>ç¬¬ä¸€æ­¥ï¼ŒA ç½‘ç«™è¦æ±‚ç”¨æˆ·æä¾› B ç½‘ç«™çš„ç”¨æˆ·åå’Œå¯†ç ã€‚æ‹¿åˆ°ä»¥åï¼ŒA å°±ç›´æ¥å‘ B è¯·æ±‚ä»¤ç‰Œã€‚ã€</li></ol><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">https</span>:<span class="hljs-string">//oauth.b.com/token?</span><br>  <span class="hljs-attr">grant_type</span>=<span class="hljs-string">password&amp;</span><br>  <span class="hljs-attr">username</span>=<span class="hljs-string">USERNAME&amp;</span><br>  <span class="hljs-attr">password</span>=<span class="hljs-string">PASSWORD&amp;</span><br>  <span class="hljs-attr">client_id</span>=<span class="hljs-string">CLIENT_ID</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢ URL ä¸­ï¼Œ<code>grant_type</code>å‚æ•°æ˜¯æˆæƒæ–¹å¼ï¼Œè¿™é‡Œçš„<code>password</code>è¡¨ç¤ºâ€å¯†ç å¼â€ï¼Œ<code>username</code>å’Œ<code>password</code>æ˜¯ B çš„ç”¨æˆ·åå’Œå¯†ç ã€‚</p><ol start="2"><li>ç¬¬äºŒæ­¥ï¼ŒB ç½‘ç«™éªŒè¯èº«ä»½é€šè¿‡åï¼Œç›´æ¥ç»™å‡ºä»¤ç‰Œã€‚æ³¨æ„ï¼Œè¿™æ—¶ä¸éœ€è¦è·³è½¬ï¼Œè€Œæ˜¯æŠŠä»¤ç‰Œæ”¾åœ¨ JSON æ•°æ®é‡Œé¢ï¼Œä½œä¸º HTTP å›åº”ï¼ŒA å› æ­¤æ‹¿åˆ°ä»¤ç‰Œã€‚</li></ol><h4 id="3-4-å‡­è¯å¼æ¨¡å¼ï¼ˆé€‚åˆæ²¡æœ‰å‰ç«¯çš„ç¬¬ä¸‰æ–¹ï¼‰"><a href="#3-4-å‡­è¯å¼æ¨¡å¼ï¼ˆé€‚åˆæ²¡æœ‰å‰ç«¯çš„ç¬¬ä¸‰æ–¹ï¼‰" class="headerlink" title="3.4 å‡­è¯å¼æ¨¡å¼ï¼ˆé€‚åˆæ²¡æœ‰å‰ç«¯çš„ç¬¬ä¸‰æ–¹ï¼‰"></a>3.4 å‡­è¯å¼æ¨¡å¼ï¼ˆé€‚åˆæ²¡æœ‰å‰ç«¯çš„ç¬¬ä¸‰æ–¹ï¼‰</h4><p><strong>å‘½ä»¤è¡Œä¸‹è¯·æ±‚ä»¤ç‰Œã€‚</strong>è¿™ç§æ–¹å¼ç»™å‡ºçš„ä»¤ç‰Œï¼Œæ˜¯é’ˆå¯¹ç¬¬ä¸‰æ–¹åº”ç”¨çš„ï¼Œè€Œä¸æ˜¯é’ˆå¯¹ç”¨æˆ·çš„ï¼Œå³æœ‰å¯èƒ½å¤šä¸ªç”¨æˆ·å…±äº«åŒä¸€ä¸ªä»¤ç‰Œã€‚</p><ol><li>ç¬¬ä¸€æ­¥ï¼ŒA åº”ç”¨åœ¨å‘½ä»¤è¡Œå‘ B å‘å‡ºè¯·æ±‚ã€‚</li></ol><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">https</span>:<span class="hljs-string">//oauth.b.com/token?</span><br>  <span class="hljs-attr">grant_type</span>=<span class="hljs-string">client_credentials&amp;</span><br>  <span class="hljs-attr">client_id</span>=<span class="hljs-string">CLIENT_ID&amp;</span><br>  <span class="hljs-attr">client_secret</span>=<span class="hljs-string">CLIENT_SECRET</span><br></code></pre></td></tr></table></figure><ul><li><p><code>grant_type</code>å‚æ•°ç­‰äº<code>client_credentials</code>è¡¨ç¤ºé‡‡ç”¨å‡­è¯å¼</p></li><li><p><code>client_id</code>å’Œ<code>client_secret</code>ç”¨æ¥è®© B ç¡®è®¤ A çš„èº«ä»½ã€‚</p></li></ul><ol start="2"><li>ç¬¬äºŒæ­¥ï¼ŒB ç½‘ç«™éªŒè¯é€šè¿‡ä»¥åï¼Œç›´æ¥è¿”å›ä»¤ç‰Œã€‚</li></ol><p>é€‚åˆåœºæ™¯ï¼šå‘è¯¥å¹³å°æ‰€æœ‰ç”¨æˆ·å‘é€æ¶ˆæ¯æé†’</p><h2 id="å››ã€ä»¤ç‰Œçš„ä½¿ç”¨"><a href="#å››ã€ä»¤ç‰Œçš„ä½¿ç”¨" class="headerlink" title="å››ã€ä»¤ç‰Œçš„ä½¿ç”¨"></a>å››ã€ä»¤ç‰Œçš„ä½¿ç”¨</h2><p>A ç½‘ç«™æ‹¿åˆ°ä»¤ç‰Œä»¥åï¼Œå°±å¯ä»¥å‘ B ç½‘ç«™çš„ API è¯·æ±‚æ•°æ®äº†ã€‚</p><p>æ­¤æ—¶ï¼Œæ¯ä¸ªå‘åˆ° API çš„è¯·æ±‚ï¼Œéƒ½å¿…é¡»å¸¦æœ‰ä»¤ç‰Œã€‚å…·ä½“åšæ³•æ˜¯åœ¨è¯·æ±‚çš„å¤´ä¿¡æ¯ï¼ŒåŠ ä¸Šä¸€ä¸ª<code>Authorization</code>å­—æ®µï¼Œä»¤ç‰Œå°±æ”¾åœ¨è¿™ä¸ªå­—æ®µé‡Œé¢ã€‚</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livescript">curl -H <span class="hljs-string">&quot;Authorization: Bearer ACCESS_TOKEN&quot;</span> <span class="hljs-string">\</span><br><span class="hljs-string">&quot;https://api.b.com&quot;</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢å‘½ä»¤ä¸­ï¼Œ<code>ACCESS_TOKEN</code>å°±æ˜¯æ‹¿åˆ°çš„ä»¤ç‰Œã€‚</p><h2 id="äº”ã€æ›´æ–°ä»¤ç‰Œ"><a href="#äº”ã€æ›´æ–°ä»¤ç‰Œ" class="headerlink" title="äº”ã€æ›´æ–°ä»¤ç‰Œ"></a>äº”ã€æ›´æ–°ä»¤ç‰Œ</h2><p>ä»¤ç‰Œçš„æœ‰æ•ˆæœŸåˆ°äº†ï¼Œå¦‚æœè®©ç”¨æˆ·é‡æ–°èµ°ä¸€éä¸Šé¢çš„æµç¨‹ï¼Œå†ç”³è¯·ä¸€ä¸ªæ–°çš„ä»¤ç‰Œï¼Œå¾ˆå¯èƒ½ä½“éªŒä¸å¥½ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰å¿…è¦ã€‚OAuth 2.0 å…è®¸ç”¨æˆ·è‡ªåŠ¨æ›´æ–°ä»¤ç‰Œã€‚</p><p>å…·ä½“æ–¹æ³•æ˜¯ï¼ŒB ç½‘ç«™é¢å‘ä»¤ç‰Œçš„æ—¶å€™ï¼Œä¸€æ¬¡æ€§é¢å‘ä¸¤ä¸ªä»¤ç‰Œï¼Œä¸€ä¸ªç”¨äºè·å–æ•°æ®ï¼Œå¦ä¸€ä¸ªç”¨äºè·å–æ–°çš„ä»¤ç‰Œï¼ˆrefresh token å­—æ®µï¼‰ã€‚ä»¤ç‰Œåˆ°æœŸå‰ï¼Œç”¨æˆ·ä½¿ç”¨ refresh token å‘ä¸€ä¸ªè¯·æ±‚ï¼Œå»æ›´æ–°ä»¤ç‰Œã€‚</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">https</span>:<span class="hljs-string">//b.com/oauth/token?</span><br>  <span class="hljs-attr">grant_type</span>=<span class="hljs-string">refresh_token&amp;</span><br>  <span class="hljs-attr">client_id</span>=<span class="hljs-string">CLIENT_ID&amp;</span><br>  <span class="hljs-attr">client_secret</span>=<span class="hljs-string">CLIENT_SECRET&amp;</span><br>  <span class="hljs-attr">refresh_token</span>=<span class="hljs-string">REFRESH_TOKEN</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢ URL ä¸­ï¼Œ<code>grant_type</code>å‚æ•°ä¸º<code>refresh_token</code>è¡¨ç¤ºè¦æ±‚æ›´æ–°ä»¤ç‰Œï¼Œ<code>client_id</code>å‚æ•°å’Œ<code>client_secret</code>å‚æ•°ç”¨äºç¡®è®¤èº«ä»½ï¼Œ<code>refresh_token</code>å‚æ•°å°±æ˜¯ç”¨äºæ›´æ–°ä»¤ç‰Œçš„ä»¤ç‰Œã€‚</p><p>B ç½‘ç«™éªŒè¯é€šè¿‡ä»¥åï¼Œå°±ä¼šé¢å‘æ–°çš„ä»¤ç‰Œã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Oauth2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Oauth2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>zookeeperé›†ç¾¤ç‰¹æ€§</title>
    <link href="/zookeeper%E9%9B%86%E7%BE%A4%E7%89%B9%E6%80%A7/"/>
    <url>/zookeeper%E9%9B%86%E7%BE%A4%E7%89%B9%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<hr><h2 id="1-é›†ç¾¤çš„ç›®çš„"><a href="#1-é›†ç¾¤çš„ç›®çš„" class="headerlink" title="1 é›†ç¾¤çš„ç›®çš„"></a>1 é›†ç¾¤çš„ç›®çš„</h2><p>zookeeperé›†ç¾¤æ˜¯ä¸ºäº†ä¿è¯ç³»ç»Ÿçš„æ€§èƒ½ï¼Œèƒ½å¤Ÿæ‰¿è½½æ›´å¤šçš„å®¢æˆ·ç«¯è¿æ¥ã€‚é€šè¿‡é›†ç¾¤(ä¸»ä»æ¨¡å¼å¯ä»¥å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>è¯»å†™åˆ†ç¦»ï¼šæé«˜æ‰¿è½½ï¼Œä¸ºæ›´å¤šçš„å®¢æˆ·ç«¯æä¾›è¿æ¥ï¼Œå¹¶ä¿éšœæ€§èƒ½ã€‚</li><li>ä¸»ä»è‡ªåŠ¨åˆ‡æ¢ï¼šæé«˜æœåŠ¡å®¹é”™æ€§ï¼Œéƒ¨åˆ†èŠ‚ç‚¹æ•…éšœä¸ä¼šå½±å“æ•´ä¸ªæœåŠ¡é›†ç¾¤ã€‚</li></ul><h2 id="2-åŠæ•°ä»¥ä¸Šè¿è¡Œæœºåˆ¶è¯´æ˜"><a href="#2-åŠæ•°ä»¥ä¸Šè¿è¡Œæœºåˆ¶è¯´æ˜" class="headerlink" title="2 åŠæ•°ä»¥ä¸Šè¿è¡Œæœºåˆ¶è¯´æ˜"></a>2 åŠæ•°ä»¥ä¸Šè¿è¡Œæœºåˆ¶è¯´æ˜</h2><p>é›†ç¾¤è‡³å°‘éœ€è¦ä¸‰å°æœåŠ¡å™¨ï¼Œå¹¶ä¸”å¼ºçƒˆå»ºè®®ä½¿ç”¨å¥‡æ•°ä¸ªæœåŠ¡å™¨ã€‚</p><p>å› ä¸ºzookeeper é€šè¿‡åˆ¤æ–­å¤§å¤šæ•°èŠ‚ç‚¹çš„å­˜æ´»æ¥åˆ¤æ–­æ•´ä¸ªæœåŠ¡æ˜¯å¦å¯ç”¨ã€‚æ¯”å¦‚3ä¸ªèŠ‚ç‚¹ï¼ŒæŒ‚æ‰äº†2ä¸ªè¡¨ç¤ºæ•´ä¸ªé›†ç¾¤æŒ‚æ‰ï¼Œè€Œç”¨å¶æ•°4ä¸ªï¼ŒæŒ‚æ‰äº†2ä¸ªä¹Ÿè¡¨ç¤ºå…¶å¹¶ä¸æ˜¯å¤§éƒ¨åˆ†å­˜æ´»ï¼Œå› æ­¤ä¹Ÿä¼šæŒ‚æ‰ã€‚</p><h2 id="3-é›†ç¾¤éƒ¨ç½²"><a href="#3-é›†ç¾¤éƒ¨ç½²" class="headerlink" title="3 é›†ç¾¤éƒ¨ç½²"></a>3 é›†ç¾¤éƒ¨ç½²</h2><h3 id="é…ç½®è¯­æ³•ï¼š"><a href="#é…ç½®è¯­æ³•ï¼š" class="headerlink" title="é…ç½®è¯­æ³•ï¼š"></a>é…ç½®è¯­æ³•ï¼š</h3><p><code>server.&lt;èŠ‚ç‚¹ID&gt;=&lt;ip&gt;:&lt;æ•°æ®åŒæ­¥ç«¯å£&gt;:&lt;é€‰ä¸¾ç«¯å£&gt;</code></p><ul><li>èŠ‚ç‚¹IDï¼šæœåŠ¡idæ‰‹åŠ¨æŒ‡å®š1è‡³125ä¹‹é—´çš„æ•°å­—ï¼Œå¹¶å†™åˆ°å¯¹åº”æœåŠ¡èŠ‚ç‚¹çš„ {dataDir}&#x2F;myid æ–‡ä»¶ä¸­ã€‚</li><li>IPåœ°å€ï¼šèŠ‚ç‚¹çš„è¿œç¨‹IPåœ°å€ï¼Œå¯ä»¥ç›¸åŒã€‚ä½†ç”Ÿäº§ç¯å¢ƒå°±ä¸èƒ½è¿™ä¹ˆåšäº†ï¼Œå› ä¸ºåœ¨åŒä¸€å°æœºå™¨å°±æ— æ³•è¾¾åˆ°å®¹é”™çš„ç›®çš„ã€‚æ‰€ä»¥è¿™ç§ç§°ä½œä¸ºä¼ªé›†ç¾¤ã€‚</li><li>æ•°æ®åŒæ­¥ç«¯å£ï¼šä¸»ä»åŒæ—¶æ•°æ®å¤åˆ¶ç«¯å£ï¼Œï¼ˆåšä¼ªé›†ç¾¤æ—¶ç«¯å£å·ä¸èƒ½é‡å¤ï¼‰ã€‚</li><li>è¿œä¸¾ç«¯å£ï¼šä¸»ä»èŠ‚ç‚¹é€‰ä¸¾ç«¯å£ï¼Œï¼ˆåšä¼ªé›†ç¾¤æ—¶ç«¯å£å·ä¸èƒ½é‡å¤ï¼‰ã€‚</li></ul><p><strong>é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼š</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tickTime</span>=<span class="hljs-number">2000</span><br><span class="hljs-attribute">dataDir</span>=/var/lib/zookeeper/<br><span class="hljs-attribute">clientPort</span>=<span class="hljs-number">2181</span><br><span class="hljs-attribute">initLimit</span>=<span class="hljs-number">5</span><br><span class="hljs-attribute">syncLimit</span>=<span class="hljs-number">2</span><br><span class="hljs-comment">#ä»¥ä¸‹ä¸ºé›†ç¾¤é…ç½®ï¼Œå¿…é¡»é…ç½®åœ¨æ‰€æœ‰èŠ‚ç‚¹çš„zoo.cfgæ–‡ä»¶ä¸­</span><br><span class="hljs-attribute">server</span>.<span class="hljs-number">1</span>=zoo<span class="hljs-number">1</span>:<span class="hljs-number">2888</span>:<span class="hljs-number">3888</span><br><span class="hljs-attribute">server</span>.<span class="hljs-number">2</span>=zoo<span class="hljs-number">2</span>:<span class="hljs-number">2888</span>:<span class="hljs-number">3888</span><br><span class="hljs-attribute">server</span>.<span class="hljs-number">3</span>=zoo<span class="hljs-number">3</span>:<span class="hljs-number">2888</span>:<span class="hljs-number">3888</span><br></code></pre></td></tr></table></figure><h3 id="é›†ç¾¤é…ç½®æµç¨‹ï¼š"><a href="#é›†ç¾¤é…ç½®æµç¨‹ï¼š" class="headerlink" title="é›†ç¾¤é…ç½®æµç¨‹ï¼š"></a>é›†ç¾¤é…ç½®æµç¨‹ï¼š</h3><ol><li>åˆ†åˆ«åˆ›å»º3ä¸ªdataç›®å½•ç”¨äºå­˜å‚¨å„èŠ‚ç‚¹æ•°æ®</li></ol><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-title">mkdir</span> <span class="hljs-class"><span class="hljs-keyword">data</span></span><br><span class="hljs-title">mkdir</span> <span class="hljs-class"><span class="hljs-keyword">data</span>/1</span><br><span class="hljs-title">mkdir</span> <span class="hljs-class"><span class="hljs-keyword">data</span>/3</span><br><span class="hljs-title">mkdir</span> <span class="hljs-class"><span class="hljs-keyword">data</span>/3</span><br></code></pre></td></tr></table></figure><ol start="2"><li>ç¼–å†™myidæ–‡ä»¶</li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">echo</span> <span class="hljs-number">1</span> &gt; data/<span class="hljs-number">1</span>/myid<br><span class="hljs-attribute">echo</span> <span class="hljs-number">3</span> &gt; data/<span class="hljs-number">3</span>/myid<br><span class="hljs-attribute">echo</span> <span class="hljs-number">2</span> &gt; data/<span class="hljs-number">2</span>/myid<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">ls -R data<br><span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span><br><br>data/<span class="hljs-number">1</span>:<br>myid<br><br>data/<span class="hljs-number">2</span>:<br>myid<br><br>data/<span class="hljs-number">3</span>:<br>myid<br></code></pre></td></tr></table></figure><p>3ã€ç¼–å†™é…ç½®æ–‡ä»¶</p><ul><li><code>vim conf/zoo1.cfg</code></li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">tickTime</span>=<span class="hljs-number">2000</span><br><span class="hljs-attr">initLimit</span>=<span class="hljs-number">10</span><br><span class="hljs-attr">syncLimit</span>=<span class="hljs-number">5</span><br><span class="hljs-attr">dataDir</span>=data/<span class="hljs-number">1</span><br><span class="hljs-attr">clientPort</span>=<span class="hljs-number">2181</span><br><span class="hljs-comment">#é›†ç¾¤é…ç½®</span><br><span class="hljs-attr">server.1</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">2887</span>:<span class="hljs-number">3887</span><br><span class="hljs-attr">server.2</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">2888</span>:<span class="hljs-number">3888</span><br><span class="hljs-attr">server.3</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">2889</span>:<span class="hljs-number">3889</span><br></code></pre></td></tr></table></figure><ul><li><code>vim conf/zoo2.cfg</code></li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">tickTime</span>=<span class="hljs-number">2000</span><br><span class="hljs-attr">initLimit</span>=<span class="hljs-number">10</span><br><span class="hljs-attr">syncLimit</span>=<span class="hljs-number">5</span><br><span class="hljs-attr">dataDir</span>=data/<span class="hljs-number">2</span><br><span class="hljs-attr">clientPort</span>=<span class="hljs-number">2182</span><br><span class="hljs-comment">#é›†ç¾¤é…ç½®</span><br><span class="hljs-attr">server.1</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">2887</span>:<span class="hljs-number">3887</span><br><span class="hljs-attr">server.2</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">2888</span>:<span class="hljs-number">3888</span><br><span class="hljs-attr">server.3</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">2889</span>:<span class="hljs-number">3889</span><br></code></pre></td></tr></table></figure><ul><li><code>vim conf/zoo3.cfg</code></li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">tickTime</span>=<span class="hljs-number">2000</span><br><span class="hljs-attr">initLimit</span>=<span class="hljs-number">10</span><br><span class="hljs-attr">syncLimit</span>=<span class="hljs-number">5</span><br><span class="hljs-attr">dataDir</span>=data/<span class="hljs-number">3</span><br><span class="hljs-attr">clientPort</span>=<span class="hljs-number">2183</span><br><span class="hljs-comment">#é›†ç¾¤é…ç½®</span><br><span class="hljs-attr">server.1</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">2887</span>:<span class="hljs-number">3887</span><br><span class="hljs-attr">server.2</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">2888</span>:<span class="hljs-number">3888</span><br><span class="hljs-attr">server.3</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">2889</span>:<span class="hljs-number">3889</span><br></code></pre></td></tr></table></figure><p>4.åˆ†åˆ«å¯åŠ¨</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">.<span class="hljs-regexp">/bin/</span>zkServer.sh start conf/zoo1.cfg<br>.<span class="hljs-regexp">/bin/</span>zkServer.sh start conf/zoo2.cfg<br>.<span class="hljs-regexp">/bin/</span>zkServer.sh start conf/zoo3.cfg<br></code></pre></td></tr></table></figure><p>5.åˆ†åˆ«æŸ¥çœ‹çŠ¶æ€</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">.<span class="hljs-regexp">/bin/</span>zkServer.sh status conf/zoo1.cfg<br>Mode: follower<br>.<span class="hljs-regexp">/bin/</span>zkServer.sh status conf/zoo2.cfg<br>Mode: follower<br>.<span class="hljs-regexp">/bin/</span>zkServer.sh status conf/zoo3.cfg<br>Mode: leader<br></code></pre></td></tr></table></figure><ol start="6"><li>è¿›å…¥å®¢æˆ·ç«¯ï¼Œåœ¨server1ä¸­åˆ›å»ºèŠ‚ç‚¹ï¼Œserver 3æŸ¥çœ‹èŠ‚ç‚¹æ˜¯å¦åŒæ­¥</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">.<span class="hljs-operator">/</span>bin<span class="hljs-operator">/</span>zkCli.sh <span class="hljs-operator">-</span>server <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2181</span>,<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2182</span><br><br>[zk: <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2181</span>,<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2182</span>(CONNECTED) <span class="hljs-number">0</span>] ls <span class="hljs-operator">/</span><br>[zookeeper]<br>[zk: <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2181</span>,<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2182</span>(CONNECTED) <span class="hljs-number">1</span>] <span class="hljs-keyword">create</span> <span class="hljs-operator">-</span>e <span class="hljs-operator">-</span>s <span class="hljs-operator">/</span>tt<br>Created <span class="hljs-operator">/</span>tt0000000001<br>[zk: <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2181</span>,<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2182</span>(CONNECTED) <span class="hljs-number">2</span>] ls <span class="hljs-operator">/</span><br>[tt0000000001, zookeeper]<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">.<span class="hljs-operator">/</span>bin<span class="hljs-operator">/</span>zkCli.sh <span class="hljs-operator">-</span>server <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2183</span><br><br>[zk: <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2183</span>(CONNECTED) <span class="hljs-number">1</span>] ls <span class="hljs-operator">/</span><br>[tt0000000001, zookeeper]<br></code></pre></td></tr></table></figure><h2 id="4-é›†ç¾¤è§’è‰²è¯´æ˜"><a href="#4-é›†ç¾¤è§’è‰²è¯´æ˜" class="headerlink" title="4 é›†ç¾¤è§’è‰²è¯´æ˜"></a>4 é›†ç¾¤è§’è‰²è¯´æ˜</h2><p>zookeeper é›†ç¾¤ä¸­æ€»å…±æœ‰ä¸‰ç§è§’è‰²ï¼Œåˆ†åˆ«æ˜¯leaderï¼ˆä¸»èŠ‚ç‚¹ï¼‰follower(å­èŠ‚ç‚¹) observerï¼ˆæ¬¡çº§å­èŠ‚ç‚¹ï¼‰</p><table><thead><tr><th align="left">è§’è‰²</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><strong>leader</strong></td><td align="left">ä¸»èŠ‚ç‚¹ï¼Œåˆåé¢†å¯¼è€…ã€‚ç”¨äºå†™å…¥æ•°æ®ï¼Œé€šè¿‡é€‰ä¸¾äº§ç”Ÿï¼Œå¦‚æœå®•æœºå°†ä¼šé€‰ä¸¾æ–°çš„ä¸»èŠ‚ç‚¹ã€‚</td></tr><tr><td align="left"><strong>follower</strong></td><td align="left">å­èŠ‚ç‚¹ï¼Œåˆåè¿½éšè€…ã€‚ç”¨äºå®ç°æ•°æ®çš„è¯»å–ã€‚åŒæ—¶ä»–ä¹Ÿæ˜¯ä¸»èŠ‚ç‚¹çš„å¤‡é€‰èŠ‚ç‚¹ï¼Œå¹¶ç”¨æ‹¥æœ‰æŠ•ç¥¨æƒã€‚</td></tr><tr><td align="left"><strong>observer</strong></td><td align="left">æ¬¡çº§å­èŠ‚ç‚¹ï¼Œåˆåè§‚å¯Ÿè€…ã€‚ç”¨äºè¯»å–æ•°æ®ï¼Œä¸flloweråŒºåˆ«åœ¨äºæ²¡æœ‰æŠ•ç¥¨æƒï¼Œä¸èƒ½é€‰ä¸ºä¸»èŠ‚ç‚¹ã€‚å¹¶ä¸”åœ¨è®¡ç®—é›†ç¾¤å¯ç”¨çŠ¶æ€æ—¶ä¸ä¼šå°†observerè®¡ç®—å…¥å†…ã€‚</td></tr></tbody></table><p><strong>observeré…ç½®ï¼š</strong><br>åªè¦åœ¨é›†ç¾¤é…ç½®ä¸­åŠ ä¸Šobserveråç¼€å³å¯ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">server</span>.<span class="hljs-number">3</span>=<span class="hljs-number">127.0.0.1:2889</span>:<span class="hljs-number">3889</span>:observer<br></code></pre></td></tr></table></figure><h2 id="5-é›†ç¾¤é€‰ä¸¾æœºåˆ¶"><a href="#5-é›†ç¾¤é€‰ä¸¾æœºåˆ¶" class="headerlink" title="5 é›†ç¾¤é€‰ä¸¾æœºåˆ¶"></a>5 é›†ç¾¤é€‰ä¸¾æœºåˆ¶</h2><p>é€šè¿‡ .&#x2F;bin&#x2F;zkServer.sh status &lt;zooé…ç½®æ–‡ä»¶&gt; å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°èŠ‚ç‚¹çŠ¶æ€ï¼Œå¯ä»¥å‘ç°ä¸­é—´çš„2182 æ˜¯leaderçŠ¶æ€</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">.<span class="hljs-regexp">/bin/</span>zkServer.sh status conf/zoo1.cfg<br>Mode: follower<br>.<span class="hljs-regexp">/bin/</span>zkServer.sh status conf/zoo2.cfg<br>Mode: leader<br>.<span class="hljs-regexp">/bin/</span>zkServer.sh status conf/zoo3.cfg<br>Mode: follower<br></code></pre></td></tr></table></figure><h2 id="5-1-æŠ•ç¥¨æœºåˆ¶è¯´æ˜"><a href="#5-1-æŠ•ç¥¨æœºåˆ¶è¯´æ˜" class="headerlink" title="5.1 æŠ•ç¥¨æœºåˆ¶è¯´æ˜"></a>5.1 æŠ•ç¥¨æœºåˆ¶è¯´æ˜</h2><ol><li><p>ç¬¬ä¸€è½®æŠ•ç¥¨å…¨éƒ¨æŠ•ç»™è‡ªå·±</p></li><li><p>ç¬¬äºŒè½®æŠ•ç¥¨ç»™myidæ¯”è‡ªå·±å¤§çš„ç›¸é‚»èŠ‚ç‚¹ï¼Œ</p></li><li><p>å¦‚æœå¾—ç¥¨è¶…è¿‡åŠæ•°ï¼Œé€‰ä¸¾ç»“æŸã€‚</p></li></ol><p>å…¶é€‰ä¸¾æœºåˆ¶å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223714485.png" alt="image-20230228223714485"></p><h2 id="5-2-é€‰ä¸¾è§¦å‘ï¼š"><a href="#5-2-é€‰ä¸¾è§¦å‘ï¼š" class="headerlink" title="5.2 é€‰ä¸¾è§¦å‘ï¼š"></a>5.2 <strong>é€‰ä¸¾è§¦å‘ï¼š</strong></h2><p>å½“é›†ç¾¤ä¸­çš„æœåŠ¡å™¨å‡ºç°å·²ä¸‹ä¸¤ç§æƒ…å†µæ—¶ä¼šè¿›è¡ŒLeaderçš„é€‰ä¸¾</p><ol><li>æœåŠ¡èŠ‚ç‚¹åˆå§‹åŒ–å¯åŠ¨ã€‚å½“èŠ‚ç‚¹åˆå§‹èµ·åŠ¨æ—¶ä¼šåœ¨é›†ç¾¤ä¸­å¯»æ‰¾LeaderèŠ‚ç‚¹ï¼Œå¦‚æœæ‰¾åˆ°åˆ™ä¸Leaderå»ºç«‹è¿æ¥ï¼Œå…¶è‡ªèº«çŠ¶æ€å˜åŒ–<strong>follower</strong>æˆ–<strong>observerã€‚</strong>å¦‚æœæ²¡æœ‰æ‰¾åˆ°Leaderï¼Œå½“å‰èŠ‚ç‚¹çŠ¶æ€å°†å˜åŒ–LOOKINGï¼Œè¿›å…¥é€‰ä¸¾æµç¨‹ã€‚</li><li>åŠæ•°ä»¥ä¸Šçš„èŠ‚ç‚¹æ— æ³•å’ŒLeaderå»ºç«‹è¿æ¥ã€‚åœ¨é›†ç¾¤è¿è¡Œå…¶é—´å¦‚æœæœ‰followeræˆ–observerèŠ‚ç‚¹å®•æœºåªè¦ä¸è¶…è¿‡åŠæ•°å¹¶ä¸ä¼šå½±å“æ•´ä¸ªé›†ç¾¤æœåŠ¡çš„æ­£å¸¸è¿è¡Œã€‚ä½†å¦‚æœleaderå®•æœºï¼Œå°†æš‚åœå¯¹å¤–æœåŠ¡ï¼Œæ‰€æœ‰followerå°†è¿›å…¥LOOKING çŠ¶æ€ï¼Œè¿›å…¥é€‰ä¸¾æµç¨‹ã€‚</li></ol><h2 id="5-3-æ•°æ®åŒæ­¥æœºåˆ¶"><a href="#5-3-æ•°æ®åŒæ­¥æœºåˆ¶" class="headerlink" title="5.3 æ•°æ®åŒæ­¥æœºåˆ¶"></a>5.3 æ•°æ®åŒæ­¥æœºåˆ¶</h2><p>zookeeper çš„æ•°æ®åŒæ­¥æ˜¯ä¸ºäº†ä¿è¯å„èŠ‚ç‚¹ä¸­æ•°æ®çš„ä¸€è‡³æ€§ï¼ŒåŒæ­¥æ—¶æ¶‰åŠä¸¤ä¸ªæµç¨‹ï¼Œä¸€ä¸ªæ˜¯æ­£å¸¸çš„å®¢æˆ·ç«¯æ•°æ®æäº¤ï¼Œå¦ä¸€ä¸ªæ˜¯é›†ç¾¤æŸä¸ªèŠ‚ç‚¹å®•æœºåœ¨æ¢å¤åçš„æ•°æ®åŒæ­¥ã€‚</p><h2 id="5-3-1-å®¢æˆ·ç«¯å†™å…¥è¯·æ±‚"><a href="#5-3-1-å®¢æˆ·ç«¯å†™å…¥è¯·æ±‚" class="headerlink" title="5.3.1 å®¢æˆ·ç«¯å†™å…¥è¯·æ±‚"></a>5.3.1 å®¢æˆ·ç«¯å†™å…¥è¯·æ±‚</h2><p>å½“æˆ‘ä»¬ä½¿ç”¨zookeeperå®¢æˆ·ç«¯å‘Zookeeper é›†ç¾¤çš„æŸä¸€ä¸ª Server å‘é€äº‹åŠ¡è¯·æ±‚æ—¶ï¼Œä¹Ÿå°±æ˜¯å¯¹ Znode èŠ‚ç‚¹çš„å¢åˆ æ”¹æ“ä½œæ—¶ã€‚</p><ol><li>å¦‚æœè¯¥serverä¸æ˜¯leaderï¼Œåˆ™ä¼šå°†è¯¥å†™è¯·æ±‚è½¬å‘ç»™leader serverï¼Œleaderå°†è¯·æ±‚äº‹åŠ¡ä»¥proposalï¼ˆå»ºè®®ï¼‰å½¢å¼åˆ†å‘ç»™followerï¼›</li><li>å½“followeræ”¶åˆ°æ”¶åˆ°leaderçš„proposalæ—¶ï¼Œæ ¹æ®æ¥æ”¶çš„å…ˆåé¡ºåºå¤„ç†proposalï¼›</li><li>å½“Leaderæ”¶åˆ°followeré’ˆå¯¹æŸä¸ªproposalè¿‡åŠçš„ackåï¼Œï¼ˆå³followerè¿‡åŠéƒ½å·²ç»åŒæ­¥å®Œæˆï¼‰åˆ™å‘èµ·äº‹åŠ¡æäº¤ï¼Œé‡æ–°å‘èµ·ä¸€ä¸ªcommitçš„proposal</li><li>Followeræ”¶åˆ°commitçš„proposalåï¼Œè®°å½•äº‹åŠ¡æäº¤ï¼Œå¹¶æŠŠæ•°æ®æ›´æ–°åˆ°å†…å­˜æ•°æ®åº“ï¼›</li><li>å½“å†™æˆåŠŸåï¼Œåé¦ˆç»™clientã€‚</li></ol><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223852985.png" alt="image-20230228223852985"></p><h2 id="5-3-2-æœåŠ¡èŠ‚ç‚¹åˆå§‹åŒ–åŒæ­¥"><a href="#5-3-2-æœåŠ¡èŠ‚ç‚¹åˆå§‹åŒ–åŒæ­¥" class="headerlink" title="5.3.2 æœåŠ¡èŠ‚ç‚¹åˆå§‹åŒ–åŒæ­¥"></a>5.3.2 æœåŠ¡èŠ‚ç‚¹åˆå§‹åŒ–åŒæ­¥</h2><ul><li><p>åœ¨é›†ç¾¤è¿è¡Œè¿‡ç¨‹å½“ä¸­å¦‚æœæœ‰ä¸€ä¸ªfollowerèŠ‚ç‚¹å®•æœºï¼Œç”±äºå®•æœºèŠ‚ç‚¹æ²¡è¿‡åŠï¼Œé›†ç¾¤ä»ç„¶èƒ½æ­£å¸¸æœåŠ¡ã€‚</p></li><li><p>å½“leader æ”¶åˆ°æ–°çš„å®¢æˆ·ç«¯è¯·æ±‚ï¼Œæ­¤æ—¶æ— æ³•åŒæ­¥ç»™å®•æœºçš„èŠ‚ç‚¹ã€‚é€ æˆæ•°æ®ä¸ä¸€è‡´ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå½“èŠ‚ç‚¹å¯åŠ¨æ—¶ï¼Œç¬¬ä¸€ä»¶äº‹æƒ…å°±æ˜¯æ‰¾å½“å‰çš„Leaderï¼Œæ¯”å¯¹æ•°æ®æ˜¯å¦ä¸€è‡´ã€‚ä¸ä¸€è‡´åˆ™å¼€å§‹åŒæ­¥,åŒæ­¥å®Œæˆä¹‹ååœ¨è¿›è¡Œå¯¹å¤–æä¾›æœåŠ¡ã€‚æ•…åœ¨èŠ‚ç‚¹åŒæ­¥æ•°æ®æœŸé—´ï¼Œè¯¥èŠ‚ç‚¹ä¸ä¼šå¯¹å¤–æä¾›æœåŠ¡ã€‚</p></li><li><p>LeaderæŒ‚äº†åï¼Œé€‰ä¸¾leaderçš„è¿‡ç¨‹ä¸­ï¼Œé›†ç¾¤ä¸å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ã€‚</p></li></ul><h1 id="6-å››å­—è¿ç»´å‘½ä»¤"><a href="#6-å››å­—è¿ç»´å‘½ä»¤" class="headerlink" title="6 å››å­—è¿ç»´å‘½ä»¤"></a>6 å››å­—è¿ç»´å‘½ä»¤</h1><p>ZooKeeperå“åº”å°‘é‡å‘½ä»¤ã€‚æ¯ä¸ªå‘½ä»¤ç”±å››ä¸ªå­—æ¯ç»„æˆã€‚å¯é€šè¿‡telnetæˆ–ncå‘ZooKeeperå‘å‡ºå‘½ä»¤ã€‚<br>è¿™äº›å‘½ä»¤é»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦é…ç½®4lw.commands.whitelistæ¥æ‰“å¼€ï¼Œå¯æ‰“å¼€éƒ¨åˆ†æˆ–å…¨éƒ¨ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment">#æ‰“å¼€æŒ‡å®šå‘½ä»¤</span><br>4lw.commands.<span class="hljs-attribute">whitelist</span>=stat, ruok, conf, isro<br><span class="hljs-comment">#æ‰“å¼€å…¨éƒ¨</span><br>4lw.commands.<span class="hljs-attribute">whitelist</span>=*<br><span class="hljs-comment">#æŸ¥çœ‹æœåŠ¡å™¨åŠå®¢æˆ·ç«¯è¿æ¥çŠ¶æ€</span><br>echo stat | nc localhost 2181<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><br>âœ  apache-zookeeper-<span class="hljs-number">3.7</span><span class="hljs-number">.0</span>-bin echo stat | nc localhost <span class="hljs-number">2181</span><br>stat is not executed because it is not in the whitelist.<br><br>## æ‰“å¼€å…¨éƒ¨ncå‘½ä»¤<br>âœ  apache-zookeeper-<span class="hljs-number">3.7</span><span class="hljs-number">.0</span>-bin echo <span class="hljs-string">&quot;4lw.commands.whitelist=*&quot;</span> &gt;&gt; conf/zoo1.cfg<br>âœ  apache-zookeeper-<span class="hljs-number">3.7</span><span class="hljs-number">.0</span>-bin echo <span class="hljs-string">&quot;4lw.commands.whitelist=*&quot;</span> &gt;&gt; conf/zoo2.cfg<br>âœ  apache-zookeeper-<span class="hljs-number">3.7</span><span class="hljs-number">.0</span>-bin echo <span class="hljs-string">&quot;4lw.commands.whitelist=*&quot;</span> &gt;&gt; conf/zoo3.cfg<br><br>## é‡å¯æœåŠ¡<br>âœ  apache-zookeeper-<span class="hljs-number">3.7</span><span class="hljs-number">.0</span>-bin ./bin/zkServer.sh restart conf/zoo1.cfg<br>âœ  apache-zookeeper-<span class="hljs-number">3.7</span><span class="hljs-number">.0</span>-bin ./bin/zkServer.sh restart conf/zoo2.cfg<br>âœ  apache-zookeeper-<span class="hljs-number">3.7</span><span class="hljs-number">.0</span>-bin ./bin/zkServer.sh restart conf/zoo3.cfg<br></code></pre></td></tr></table></figure><h3 id="ZXIDè¯´æ˜"><a href="#ZXIDè¯´æ˜" class="headerlink" title="ZXIDè¯´æ˜"></a>ZXIDè¯´æ˜</h3><blockquote><p>å¦‚ä½•æ¯”å¯¹Leaderçš„æ•°æ®ç‰ˆæœ¬å‘¢ï¼Œè¿™é‡Œé€šè¿‡ZXIDäº‹ç‰©IDæ¥ç¡®è®¤ã€‚æ¯”Leaderå°å°±éœ€è¦åŒæ­¥ã€‚</p></blockquote><ul><li><p>ZXIDæ˜¯ä¸€ä¸ªé•¿åº¦64ä½çš„æ•°å­—ï¼Œå…¶ä¸­ä½32ä½æ˜¯æŒ‰ç…§æ•°å­—é€’å¢ï¼Œä»»ä½•æ•°æ®çš„å˜æ›´éƒ½ä¼šå¯¼è‡´ä½32ä½çš„æ•°å­—åŠ 1ã€‚</p></li><li><p>é«˜32ä½æ˜¯leaderå‘¨æœŸç¼–å·ï¼Œæ¯å½“é€‰ä¸¾å‡ºä¸€ä¸ªæ–°çš„leaderæ—¶ï¼Œæ–°çš„leaderå°±ä»æœ¬åœ°äº‹ç‰©æ—¥å¿—ä¸­å–å‡ºZXID,ç„¶åè§£æå‡ºé«˜32ä½çš„å‘¨æœŸç¼–å·ï¼Œè¿›è¡ŒåŠ 1ï¼Œå†å°†ä½32ä½çš„å…¨éƒ¨è®¾ç½®ä¸º0ã€‚è¿™æ ·å°±ä¿è¯äº†æ¯æ¬¡æ–°é€‰ä¸¾çš„leaderåï¼Œä¿è¯äº†ZXIDçš„å”¯ä¸€æ€§è€Œä¸”æ˜¯ä¿è¯é€’å¢çš„ã€‚</p></li></ul><p>Â </p><p>eg1: èŠ‚ç‚¹æ•°æ®çš„å˜æ›´</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223906822.png" alt="image-20230228223906822"></p><p>Eg2: æŸä¸ªèŠ‚ç‚¹æŒ‚æ‰é‡æ–°é€‰ä¸¾</p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223916530.png" alt="image-20230228223916530"></p><p><img src="https://panyuro.oss-cn-beijing.aliyuncs.com/image-20230228223927521.png" alt="image-20230228223927521"></p><p><strong>æ€è€ƒé¢˜ï¼š</strong><br>å¦‚æœleader èŠ‚ç‚¹å®•æœºï¼Œåœ¨æ¢å¤åå®ƒè¿˜èƒ½è¢«é€‰ä¸ºleaderå—ï¼Ÿ</p><p>ä¸ä¼šï¼Œå› ä¸ºå®ƒçš„æ•°æ®ä¸æ˜¯æœ€æ–°çš„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Zookeeper</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>zookeeperå®¢æˆ·ç«¯ä½¿ç”¨</title>
    <link href="/zookeeper%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BD%BF%E7%94%A8/"/>
    <url>/zookeeper%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="å®¢æˆ·ç«¯APIå¸¸è§„åº”ç”¨"><a href="#å®¢æˆ·ç«¯APIå¸¸è§„åº”ç”¨" class="headerlink" title="å®¢æˆ·ç«¯APIå¸¸è§„åº”ç”¨"></a>å®¢æˆ·ç«¯APIå¸¸è§„åº”ç”¨</h2><hr><p>zookeeper æä¾›äº†javaä¸Cä¸¤ç§è¯­è¨€çš„å®¢æˆ·ç«¯ã€‚æˆ‘ä»¬è¦å­¦ä¹ çš„å°±æ˜¯javaå®¢æˆ·ç«¯ã€‚å¼•å…¥æœ€æ–°çš„mavenä¾èµ–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>  &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt;<br>  &lt;artifactId&gt;zookeeper&lt;/artifactId&gt;<br>  &lt;version&gt;<span class="hljs-number">3.6</span><span class="hljs-number">.2</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><h2 id="åˆå§‹è¿æ¥"><a href="#åˆå§‹è¿æ¥" class="headerlink" title="åˆå§‹è¿æ¥"></a>åˆå§‹è¿æ¥</h2><p>å¸¸è§„çš„å®¢æˆ·ç«¯ç±»æ˜¯ org.apache.zookeeper.ZooKeeperï¼Œå®ä¾‹åŒ–è¯¥ç±»ä¹‹åå°†ä¼šè‡ªåŠ¨ä¸é›†ç¾¤å»ºç«‹è¿æ¥ã€‚</p><ul><li>connectString    è¿æ¥ä¸²ï¼ŒåŒ…æ‹¬ip+ç«¯å£ ,é›†ç¾¤æ¨¡å¼ä¸‹ç”¨é€—å·éš”å¼€</li><li>sessionTimeout  ä¼šè¯è¶…æ—¶æ—¶é—´ï¼Œè¯¥å€¼ä¸èƒ½è¶…è¿‡æœåŠ¡ç«¯æ‰€è®¾ç½®çš„ minSessionTimeout å’ŒmaxSessionTimeout</li><li>watcher ä¼šè¯ç›‘å¬å™¨ï¼ŒæœåŠ¡ç«¯äº‹ä»¶å°†ä¼šè§¦è¯¥ç›‘å¬</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">zooKeeper = <span class="hljs-keyword">new</span> ZooKeeper(<span class="hljs-string">&quot;192.168.2.103:2181&quot;</span>, <span class="hljs-number">4000</span>, <span class="hljs-keyword">new</span> Watcher() &#123;<br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">(WatchedEvent watchedEvent)</span> </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;init:&quot;</span>+watchedEvent.getPath());<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><h2 id="åˆ›å»ºã€æŸ¥çœ‹èŠ‚ç‚¹"><a href="#åˆ›å»ºã€æŸ¥çœ‹èŠ‚ç‚¹" class="headerlink" title="åˆ›å»ºã€æŸ¥çœ‹èŠ‚ç‚¹"></a>åˆ›å»ºã€æŸ¥çœ‹èŠ‚ç‚¹</h2><h3 id="åˆ›å»ºèŠ‚ç‚¹"><a href="#åˆ›å»ºèŠ‚ç‚¹" class="headerlink" title="åˆ›å»ºèŠ‚ç‚¹"></a>åˆ›å»ºèŠ‚ç‚¹</h3><p>é€šè¿‡org.apache.zookeeper.ZooKeeper#create()å³å¯åˆ›å»ºèŠ‚ç‚¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">createData</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException, KeeperException </span>&#123;<br>  List&lt;ACL&gt; aclList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>  <span class="hljs-keyword">int</span> perm = ZooDefs.Perms.ADMIN | ZooDefs.Perms.READ;<br>  <br>  <span class="hljs-comment">// perms å¯¹åº”æƒé™ä½permission</span><br>  <span class="hljs-comment">// id å¯¹åº”æƒé™æ¨¡å¼scheme + id</span><br>  ACL acl1 = <span class="hljs-keyword">new</span> ACL(perm, <span class="hljs-keyword">new</span> Id(<span class="hljs-string">&quot;world&quot;</span>,<span class="hljs-string">&quot;anyone&quot;</span>));<br>  ACL acl2 = <span class="hljs-keyword">new</span> ACL(perm, <span class="hljs-keyword">new</span> Id(<span class="hljs-string">&quot;ip&quot;</span>,<span class="hljs-string">&quot;192.168.2.103&quot;</span>));<br>  ACL acl3 = <span class="hljs-keyword">new</span> ACL(perm, <span class="hljs-keyword">new</span> Id(<span class="hljs-string">&quot;ip&quot;</span>,<span class="hljs-string">&quot;127.0.0.1&quot;</span>));<br><br>  aclList.add(acl1);<br>  aclList.add(acl2);<br>  aclList.add(acl3);<br>  zooKeeper.create(<span class="hljs-string">&quot;/hello&quot;</span>, <span class="hljs-string">&quot;hello word!&quot;</span>.getBytes(), aclList, CreateMode.PERSISTENT);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œå®Œæˆåï¼Œåœ¨zookeeperè¿›è¡ŒæŸ¥çœ‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">[zk: <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">64</span>] getAcl /hello<br><span class="hljs-string">&#x27;world,&#x27;</span>anyone<br>: ra<br><span class="hljs-string">&#x27;ip,&#x27;</span><span class="hljs-number">192.168</span><span class="hljs-number">.2</span><span class="hljs-number">.103</span><br>: ra<br><span class="hljs-string">&#x27;ip,&#x27;</span><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br>: ra<br>[zk: <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">2181</span>(CONNECTED) <span class="hljs-number">65</span>] get /hello<br>hello word<br></code></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹èŠ‚ç‚¹"><a href="#æŸ¥çœ‹èŠ‚ç‚¹" class="headerlink" title="æŸ¥çœ‹èŠ‚ç‚¹"></a>æŸ¥çœ‹èŠ‚ç‚¹</h3><h4 id="æŸ¥çœ‹å½“å‰èŠ‚ç‚¹"><a href="#æŸ¥çœ‹å½“å‰èŠ‚ç‚¹" class="headerlink" title="æŸ¥çœ‹å½“å‰èŠ‚ç‚¹"></a>æŸ¥çœ‹å½“å‰èŠ‚ç‚¹</h4><p>é€šè¿‡org.apache.zookeeper.ZooKeeper#getData()å³å¯æŸ¥çœ‹èŠ‚ç‚¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testData</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException, KeeperException </span>&#123;<br>  <span class="hljs-keyword">final</span> <span class="hljs-keyword">byte</span>[] keeperData = zooKeeper.getData(<span class="hljs-string">&quot;/pyr&quot;</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">null</span>);<br>  System.out.println(<span class="hljs-string">&quot;testData:&quot;</span> + <span class="hljs-keyword">new</span> String(keeperData));<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹å­èŠ‚ç‚¹"><a href="#æŸ¥çœ‹å­èŠ‚ç‚¹" class="headerlink" title="æŸ¥çœ‹å­èŠ‚ç‚¹"></a>æŸ¥çœ‹å­èŠ‚ç‚¹</h4><p>é€šè¿‡org.apache.zookeeper.ZooKeeper#getChildren()å³å¯è·å–å­èŠ‚ç‚¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testGetChildrenWithoutWatch</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException, KeeperException </span>&#123;<br>  <span class="hljs-keyword">final</span> List&lt;String&gt; children = zooKeeper.getChildren(<span class="hljs-string">&quot;/pyr&quot;</span>, <span class="hljs-keyword">false</span>);<br>  children.stream().forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç›‘å¬èŠ‚ç‚¹"><a href="#ç›‘å¬èŠ‚ç‚¹" class="headerlink" title="ç›‘å¬èŠ‚ç‚¹"></a>ç›‘å¬èŠ‚ç‚¹</h2><ul><li><p>åœ¨getData() ä¸getChildren()ä¸¤ä¸ªæ–¹æ³•ä¸­å¯åˆ†åˆ«è®¾ç½®ç›‘å¬æ•°æ®å˜åŒ–å’Œå­èŠ‚ç‚¹å˜åŒ–ã€‚</p></li><li><p>é€šè¿‡è®¾ç½®watchä¸ºtrueï¼Œå½“å‰äº‹ä»¶è§¦å‘æ—¶ä¼šè°ƒç”¨zookeeper()æ„å»ºå‡½æ•°ä¸­Watcher.process()æ–¹æ³•ã€‚ä¹Ÿå¯ä»¥æ·»åŠ watcherå‚æ•°æ¥å®ç°è‡ªå®šä¹‰ç›‘å¬ã€‚ä¸€èˆ¬é‡‡ç”¨åè€…ã€‚</p></li><li><p>æ‰€æœ‰çš„ç›‘å¬éƒ½æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œå¦‚æœè¦æŒç»­ç›‘å¬éœ€è¦è§¦å‘ååœ¨æ·»åŠ ä¸€æ¬¡ç›‘å¬ã€‚</p></li></ul><p><strong>ä½¿ç”¨é»˜è®¤ç›‘å¬</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testGetDataWithWatcher</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException, KeeperException </span>&#123;<br>  <span class="hljs-keyword">final</span> <span class="hljs-keyword">byte</span>[] keeperData = zooKeeper.getData(<span class="hljs-string">&quot;/pyr&quot;</span>, <span class="hljs-keyword">true</span>, <span class="hljs-keyword">null</span>);<br>  System.out.println(<span class="hljs-string">&quot;testGetDataWithWatcher:&quot;</span> + <span class="hljs-keyword">new</span> String(keeperData));<br>  Thread.sleep(Long.MAX_VALUE);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>è‡ªå®šä¹‰ç›‘å¬</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testGetDataWithCustomWatcher</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException, KeeperException </span>&#123;<br>  <span class="hljs-keyword">final</span> <span class="hljs-keyword">byte</span>[] keeperData = zooKeeper.getData(<span class="hljs-string">&quot;/pyr&quot;</span>, <span class="hljs-keyword">new</span> Watcher() &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">(WatchedEvent watchedEvent)</span> </span>&#123;<br>      <span class="hljs-keyword">try</span> &#123;<br>        zooKeeper.getData(<span class="hljs-string">&quot;/temp&quot;</span>, <span class="hljs-keyword">this</span>, <span class="hljs-keyword">null</span>);<br>      &#125; <span class="hljs-keyword">catch</span> (KeeperException | InterruptedException e) &#123;<br>        e.printStackTrace();<br>      &#125;<br>      System.out.println(<span class="hljs-string">&quot;testGetDataWithCustomWatcher:&quot;</span> + watchedEvent.getPath());<br><br>    &#125;<br>  &#125;, <span class="hljs-keyword">null</span>);<br>  Thread.sleep(Long.MAX_VALUE);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ZkClient"><a href="#ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ZkClient" class="headerlink" title="ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ZkClient"></a>ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ZkClient</h2><p>zkClient æ˜¯åœ¨zookeeperå®¢æˆ·ç«¯åŸºç¡€ä¹‹ä¸Šå°è£…çš„ï¼Œä½¿ç”¨ä¸Šæ›´åŠ å‹å¥½ã€‚ä¸»è¦å˜åŒ–å¦‚ä¸‹ï¼š</p><ul><li>å¯ä»¥è®¾ç½®æŒä¹…ç›‘å¬ï¼Œæˆ–åˆ é™¤æŸä¸ªç›‘å¬</li><li>å¯ä»¥æ’å…¥JAVAå¯¹è±¡ï¼Œè‡ªåŠ¨è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–</li><li>ç®€åŒ–äº†åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥æ“ä½œã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>Zookeeper</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼æ¡†æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
